<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd"><article xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Source Code Biol Med</journal-id><journal-title>Source Code for Biology and Medicine</journal-title><issn pub-type="epub">1751-0473</issn><publisher><publisher-name>BioMed Central</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">19087314</article-id><article-id pub-id-type="pmc">2633005</article-id><article-id pub-id-type="publisher-id">1751-0473-3-17</article-id><article-id pub-id-type="doi">10.1186/1751-0473-3-17</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research</subject></subj-group></article-categories><title-group><article-title>Purposeful selection of variables in logistic regression</article-title></title-group><contrib-group><contrib id="A1" corresp="yes" contrib-type="author"><name><surname>Bursac</surname><given-names>Zoran</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>zbursac@uams.edu</email></contrib><contrib id="A2" contrib-type="author"><name><surname>Gauss</surname><given-names>C Heath</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>gaussclintonh@uams.edu</email></contrib><contrib id="A3" contrib-type="author"><name><surname>Williams</surname><given-names>David Keith</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>williamsdavidk@uams.edu</email></contrib><contrib id="A4" contrib-type="author"><name><surname>Hosmer</surname><given-names>David W</given-names></name><xref ref-type="aff" rid="I2">2</xref><email>hosmer@schoolph.umass.edu</email></contrib></contrib-group><aff id="I1"><label>1</label>Biostatistics, University of Arkansas for Medical Sciences, Little Rock, AR 72205, USA</aff><aff id="I2"><label>2</label>Biostatistics, University of Massachusetts, Amherst, MA 01003, USA</aff><pub-date pub-type="collection"><year>2008</year></pub-date><pub-date pub-type="epub"><day>16</day><month>12</month><year>2008</year></pub-date><volume>3</volume><fpage>17</fpage><lpage>17</lpage><ext-link ext-link-type="uri" xlink:href="http://www.scfbm.org/content/3/1/17"/><history><date date-type="received"><day>22</day><month>8</month><year>2008</year></date><date date-type="accepted"><day>16</day><month>12</month><year>2008</year></date></history><permissions><copyright-statement>Copyright &#x000a9; 2008 Bursac et al; licensee BioMed Central Ltd.</copyright-statement><copyright-year>2008</copyright-year><copyright-holder>Bursac et al; licensee BioMed Central Ltd.</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0"><p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p><!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>               Bursac               Zoran                              zbursac@uams.edu            </dc:author><dc:title>            Purposeful selection of variables in logistic regression         </dc:title><dc:date>2008</dc:date><dcterms:bibliographicCitation>Source Code for Biology and Medicine 3(1): 17-. (2008)</dcterms:bibliographicCitation><dc:identifier type="sici">1751-0473(2008)3:1&#x0003c;17&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1751-0473</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>--></license></permissions><abstract><sec><title>Background</title><p>The main problem in many model-building situations is to choose from a large set of covariates those that should be included in the "best" model. A decision to keep a variable in the model might be based on the clinical or statistical significance. There are several variable selection algorithms in existence. Those methods are mechanical and as such carry some limitations. Hosmer and Lemeshow describe a purposeful selection of covariates within which an analyst makes a variable selection decision at each step of the modeling process.</p></sec><sec sec-type="methods"><title>Methods</title><p>In this paper we introduce an algorithm which automates that process. We conduct a simulation study to compare the performance of this algorithm with three well documented variable selection procedures in SAS PROC LOGISTIC: FORWARD, BACKWARD, and STEPWISE.</p></sec><sec><title>Results</title><p>We show that the advantage of this approach is when the analyst is interested in risk factor modeling and not just prediction. In addition to significant covariates, this variable selection procedure has the capability of retaining important confounding variables, resulting potentially in a slightly richer model. Application of the macro is further illustrated with the Hosmer and Lemeshow Worchester Heart Attack Study (WHAS) data.</p></sec><sec><title>Conclusion</title><p>If an analyst is in need of an algorithm that will help guide the retention of significant covariates as well as confounding ones they should consider this macro as an alternative tool.</p></sec></abstract></article-meta></front><body><sec><title>Background</title><p>The criteria for inclusion of a variable in the model vary between problems and disciplines. The common approach to statistical model building is minimization of variables until the most parsimonious model that describes the data is found which also results in numerical stability and generalizability of the results. Some methodologists suggest inclusion of all clinical and other relevant variables in the model regardless of their significance in order to control for confounding. This approach, however, can lead to numerically unstable estimates and large standard errors. This paper is based on the purposeful selection of variables in regression methods (with specific focus on logistic regression in this paper) as proposed by Hosmer and Lemeshow [<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B2">2</xref>].</p><p>It is important to mention that with the rapid computing and information evolution there has been a growth in the field of feature selection methods and algorithms. Some examples include hill-climbing, greedy algorithms, recursive feature elimination, univariate association filtering, and backward/forward wrapping, to name a few. These methods have been used in bioinformatics, clinical diagnostics, and some are universal to multiple applications. Hill-climbing and greedy algorithms are mathematical optimization techniques used in artificial intelligence, which work well on certain problems, but they fail to produce optimal solutions for many others [<xref ref-type="bibr" rid="B3">3</xref>-<xref ref-type="bibr" rid="B6">6</xref>]. Filtering, wrapping, and recursive feature elimination methods have been used in areas like text processing or gene expression array analysis. While these are powerful selection methods that have improved the performance of predictors, they are often computationally intensive. They are used on large data sets often with thousands of variables, introducing the problem of dimensionality and like some other multivariate methods have potential to overfit the data [<xref ref-type="bibr" rid="B7">7</xref>].</p><p>Several variable selection methods are available in commercial software packages. Commonly used methods, which are the ones of focus in this paper, are forward selection, backward elimination, and stepwise selection.</p><p>In forward selection, the score chi-square statistic is computed for each effect not in the model and examines the largest of these statistics. If it is significant at some entry level, the corresponding effect is added to the model. Once an effect is entered in the model, it is never removed from the model. The process is repeated until none of the remaining effects meet the specified level for entry.</p><p>In backward elimination, the results of the Wald test for individual parameters are examined. The least significant effect that does not meet the level for staying in the model is removed. Once an effect is removed from the model, it remains excluded. The process is repeated until no other effect in the model meets the specified level for removal.</p><p>The stepwise selection is similar to the forward selection except that effects already in the model do not necessarily remain. Effects are entered into and removed from the model in such a way that each forward selection step may be followed by one or more backward elimination steps. The stepwise selection process terminates if no further effect can be added to the model or if the effect just entered into the model is the only effect removed in the subsequent backward elimination</p><p>The purposeful selection algorithm (PS) follows a slightly different logic as proposed by Hosmer and Lemeshow [<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B2">2</xref>]. This variable selection method has not been studied or compared in a systematic way to other statistical selection methods, with the exception of a few numerical examples.</p><p>An important part of this study was the development and validation of a SAS macro that automates the purposeful selection process. Details on the macro and the link to macro itself are provided in the appendix. Since the macro was written in SAS, we compare its performance with SAS PROC LOGISTIC variable selection procedures, namely FORWARD (FS), BACKWARD (BS), and STEPWISE (SS) [<xref ref-type="bibr" rid="B8">8</xref>].</p><p>The objectives of this paper are 1) to evaluate the purposeful selection algorithm systematically in a simulation study by comparing it to the above mentioned variable selection procedures, and 2) to show the application of it on the motivating data set.</p><sec><title>Purposeful selection of covariates</title><p>The purposeful selection process begins by a univariate analysis of each variable. Any variable having a significant univariate test at some arbitrary level is selected as a candidate for the multivariate analysis. We base this on the Wald test from logistic regression and p-value cut-off point of 0.25. More traditional levels such as 0.05 can fail in identifying variables known to be important [<xref ref-type="bibr" rid="B9">9</xref>,<xref ref-type="bibr" rid="B10">10</xref>]. In the iterative process of variable selection, covariates are removed from the model if they are non-significant and not a confounder. Significance is evaluated at the 0.1 alpha level and confounding as a change in any remaining parameter estimate greater than, say, 15% or 20% as compared to the full model. A change in a parameter estimate above the specified level indicates that the excluded variable was important in the sense of providing a needed adjustment for one or more of the variables remaining in the model. At the end of this iterative process of deleting, refitting, and verifying, the model contains significant covariates and confounders. At this point any variable not selected for the original multivariate model is added back one at a time, with significant covariates and confounders retained earlier. This step can be helpful in identifying variables that, by themselves, are not significantly related to the outcome but make an important contribution in the presence of other variables. Any that are significant at the 0.1 or 0.15 level are put in the model, and the model is iteratively reduced as before but only for the variables that were additionally added. At the end of this final step, the analyst is left with the preliminary main effects model. For more details on the purposeful selection process, refer to Hosmer and Lemeshow [<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B2">2</xref>].</p></sec><sec><title>Simulations</title><p>We conducted two simulation studies to evaluate the performance of the purposeful selection algorithm. In the first simulation we started with the assumption that we have 6 equally important covariates <italic>(X</italic><sub>1</sub>, ..., <italic>X</italic><sub>6 </sub>such that <italic>X</italic><sub><italic>j</italic></sub>~<italic>U</italic>(-6, 6) for <italic>j </italic>= 1, ..., 6), three of which were significant and three that were not. We set <italic>&#x003b2;</italic><sub>0 </sub>= -0.6, <italic>&#x003b2;</italic><sub>1 </sub>= <italic>&#x003b2;</italic><sub>2 </sub>= <italic>&#x003b2;</italic><sub>3 </sub>= 0.122, and <italic>&#x003b2;</italic><sub>4 </sub>= <italic>&#x003b2;</italic><sub>5 </sub>= <italic>&#x003b2;</italic><sub>6 </sub>= 0. Therefore, the true logit we sampled from was</p><p><disp-formula><italic>logit </italic>= -0.6 + 0.122<italic>X</italic><sub>1 </sub>+ 0.122<italic>X</italic><sub>2 </sub>+ 0.122<italic>X</italic><sub>3 </sub>+ 0<italic>X</italic><sub>4 </sub>+ 0<italic>X</italic><sub>5 </sub>+ 0<italic>X</italic><sub>6</sub>.</disp-formula></p><p>We conducted 1000 simulation runs for each of the 6 conditions in which we varied the sample size (n = 60, 120, 240, 360, 480, and 600). The summary measure of the algorithm performance was the percent of times each variable selection procedure retained only <italic>X</italic><sub>1</sub>, <italic>X</italic><sub>2</sub>, and <italic>X</italic><sub>3 </sub>in the final model. (For PS selection, confounding was set to 20% and non-candidate inclusion to 0.1, even though confounding was not simulated in this portion of the study.)</p><p>Table <xref ref-type="table" rid="T1">1</xref> shows the percent of times that the correct model was obtained for four selection procedures under various sample sizes. Correct retention increases with sample size, and it is almost identical for PS, SS, and BS. FS selection does not perform as well as the other three with the exception of lower sample size levels.</p><table-wrap position="float" id="T1"><label>Table 1</label><caption><p>Simulation results.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="center">n</td><td align="center">Purposeful</td><td align="center">Stepwise</td><td align="center">Backward</td><td align="center">Forward</td></tr></thead><tbody><tr><td align="center">60</td><td align="center">5.1</td><td align="center">4.5</td><td align="center">4.9</td><td align="center">9</td></tr><tr><td align="center">120</td><td align="center">24.2</td><td align="center">22.4</td><td align="center">22.8</td><td align="center">24.2</td></tr><tr><td align="center">240</td><td align="center">52.6</td><td align="center">52.6</td><td align="center">52.5</td><td align="center">36</td></tr><tr><td align="center">360</td><td align="center">69.8</td><td align="center">69.8</td><td align="center">69.8</td><td align="center">42.5</td></tr><tr><td align="center">480</td><td align="center">71.1</td><td align="center">71.2</td><td align="center">71.1</td><td align="center">44.2</td></tr><tr><td align="center">600</td><td align="center">70.5</td><td align="center">70.6</td><td align="center">70.5</td><td align="center">40.4</td></tr></tbody></table><table-wrap-foot><p>Retention of the correct model for purposeful, stepwise, backward, and forward selection methods, with no confounding present.</p></table-wrap-foot></table-wrap><p>In the second simulation, we started with the same assumption, that the 6 covariates were equally important, two of which were significant, one that was a confounder, and three that were not significant. We assumed that <italic>X</italic><sub>1 </sub>= Bernoulli (0.5), the confounder <italic>X</italic><sub>2</sub>~<italic>U</italic>(-6, 3) if <italic>X</italic><sub>1 </sub>= 1 and <italic>X</italic><sub>2</sub>~<italic>U</italic>(-3, 6) if <italic>X</italic><sub>1 </sub>= 0, and <italic>X</italic><sub>3 </sub>- <italic>X</italic><sub>6</sub>~<italic>U</italic>(-6, 6). We created the confounder <italic>X</italic><sub>2 </sub>by making the distribution of that variable dependent on <italic>X</italic><sub>1</sub>. We set <italic>&#x003b2;</italic><sub>0 </sub>= -0.6, <italic>&#x003b2;</italic><sub>1 </sub>= 1.2, <italic>&#x003b2;</italic><sub>2 </sub>= 0.1, <italic>&#x003b2;</italic><sub>3 </sub>= 0.122, and <italic>&#x003b2;</italic><sub>4 </sub>= <italic>&#x003b2;</italic><sub>5 </sub>= <italic>&#x003b2;</italic><sub>6 </sub>= 0. Therefore, the true logit we sampled from was</p><p><disp-formula><italic>logit </italic>= -0.6 + 1.2<italic>X</italic><sub>1 </sub>+ 0.1<italic>X</italic><sub>2 </sub>+ 0.122<italic>X</italic><sub>3 </sub>+ 0<italic>X</italic><sub>4 </sub>+ 0<italic>X</italic><sub>5 </sub>+ 0<italic>X</italic><sub>6</sub>.</disp-formula></p><p>We conducted 1000 simulation runs for each of the 24 conditions in which we varied the sample size (n = 60, 120, 240, 360, 480, and 600), confounding (15% and 20%), and non-candidate inclusion (0.1 and 0.15). Similarly, the summary measure of the algorithm performance was the percent of times each variable selection procedure retained only <italic>X</italic><sub>1</sub>, <italic>X</italic><sub>2</sub>, and X<sub>3 </sub>in the final model.</p><p>Table <xref ref-type="table" rid="T2">2</xref> shows the percent of times that the correct model was obtained for four selection procedures under 24 simulated conditions.</p><table-wrap position="float" id="T2"><label>Table 2</label><caption><p>Simulation results</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="center">Confounding</td><td align="center">Non-candidate Inclusion</td><td align="center">n</td><td align="center">Purposeful</td><td align="center">Stepwise</td><td align="center">Backward</td><td align="center">Forward</td></tr></thead><tbody><tr><td align="center">20</td><td align="center">0.1</td><td align="center">60</td><td align="center">5</td><td align="center">3.6</td><td align="center">6.3</td><td align="center">9.1</td></tr><tr><td></td><td></td><td align="center">120</td><td align="center">17.3</td><td align="center">15.6</td><td align="center">18.2</td><td align="center">18.8</td></tr><tr><td></td><td></td><td align="center">240</td><td align="center">39.7</td><td align="center">39.6</td><td align="center">40.1</td><td align="center">30.3</td></tr><tr><td></td><td></td><td align="center">360</td><td align="center">55.2</td><td align="center">54.4</td><td align="center">54.4</td><td align="center">36.6</td></tr><tr><td></td><td></td><td align="center">480</td><td align="center">64.3</td><td align="center">64.3</td><td align="center">64.3</td><td align="center">37.5</td></tr><tr><td></td><td></td><td align="center">600</td><td align="center">65.8</td><td align="center">65.7</td><td align="center">65.7</td><td align="center">41.3</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td align="center">20</td><td align="center">0.15</td><td align="center">60</td><td align="center">9.2</td><td align="center">4.6</td><td align="center">6.4</td><td align="center">8.1</td></tr><tr><td></td><td></td><td align="center">120</td><td align="center">18.7</td><td align="center">14.8</td><td align="center">17.2</td><td align="center">18.5</td></tr><tr><td></td><td></td><td align="center">240</td><td align="center">43.1</td><td align="center">37.1</td><td align="center">38.2</td><td align="center">30.5</td></tr><tr><td></td><td></td><td align="center">360</td><td align="center">56.5</td><td align="center">53.7</td><td align="center">53.9</td><td align="center">37</td></tr><tr><td></td><td></td><td align="center">480</td><td align="center">63.6</td><td align="center">62.6</td><td align="center">62</td><td align="center">43</td></tr><tr><td></td><td></td><td align="center">600</td><td align="center">70.3</td><td align="center">69</td><td align="center">68.7</td><td align="center">41</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td align="center">15</td><td align="center">0.1</td><td align="center">60</td><td align="center">6.6</td><td align="center">4.1</td><td align="center">6.1</td><td align="center">9.6</td></tr><tr><td></td><td></td><td align="center">120</td><td align="center">17.8</td><td align="center">15.6</td><td align="center">18.6</td><td align="center">19.2</td></tr><tr><td></td><td></td><td align="center">240</td><td align="center">39.7</td><td align="center">36.6</td><td align="center">37.6</td><td align="center">29.8</td></tr><tr><td></td><td></td><td align="center">360</td><td align="center">53.3</td><td align="center">52.2</td><td align="center">52.6</td><td align="center">38.3</td></tr><tr><td></td><td></td><td align="center">480</td><td align="center">62.4</td><td align="center">62.1</td><td align="center">62.1</td><td align="center">40.1</td></tr><tr><td></td><td></td><td align="center">600</td><td align="center">68.5</td><td align="center">67.9</td><td align="center">68</td><td align="center">40.2</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td align="center">15</td><td align="center">0.15</td><td align="center">60</td><td align="center">9.7</td><td align="center">4.4</td><td align="center">6.7</td><td align="center">9</td></tr><tr><td></td><td></td><td align="center">120</td><td align="center">21.9</td><td align="center">16.8</td><td align="center">21.3</td><td align="center">19.6</td></tr><tr><td></td><td></td><td align="center">240</td><td align="center">46.6</td><td align="center">40.2</td><td align="center">41.4</td><td align="center">32.3</td></tr><tr><td></td><td></td><td align="center">360</td><td align="center">57.7</td><td align="center">52.5</td><td align="center">52.5</td><td align="center">35.3</td></tr><tr><td></td><td></td><td align="center">480</td><td align="center">64</td><td align="center">63.1</td><td align="center">63.1</td><td align="center">39.3</td></tr><tr><td></td><td></td><td align="center">600</td><td align="center">70.4</td><td align="center">69.6</td><td align="center">69.6</td><td align="center">41.4</td></tr></tbody></table><table-wrap-foot><p>Retention of the correct model for purposeful, stepwise, backward, and forward selection methods, under 24 simulated conditions that vary confounding, non-candidate inclusion, and sample size levels.</p></table-wrap-foot></table-wrap><p>Again, the proportion of correctly retained models increases with sample size for all selection methods. At the lower sample size levels no procedure performs very well. FS does the best with the exceptions when the non-candidate inclusion is set to 0.15, where PS performs better. With the larger samples like 480 and 600, PS, SS, and BS converge toward a close proportion of correct model retention while FS does notably worse. With confounding present, PS retains a larger proportion of correct models for all six sample sizes when confounding is set to either 15% or 20% and non-candidate inclusion to 0.15 as compared to the other three methods. Under the other scenarios, PS retains a slightly larger proportion of correct models than the other variable selection procedures, mainly for samples in the range 240&#x02013;360.</p><p>In addition to the mentioned simulation conditions, we tampered with the coefficient of the confounding variable <italic>X</italic><sub>2</sub>, by making it more significant at 0.13, and less significant at 0.07. We show the results for both scenarios with confounding set to 15% and non-candidate inclusion at 0.15.</p><p>When <italic>&#x003b2;</italic><sub>2 </sub>= 0.13, Table <xref ref-type="table" rid="T3">3</xref> shows that PS, BS, and as sample size gets larger, SS perform comparably, retaining a similar proportion of correct models. This is primarily due to the fact that <italic>X</italic><sub>2 </sub>becomes significant in a larger proportion of simulations and is retained by those procedures because of its significance and not confounding effect. FS again mostly does worse than the three previously mentioned selection procedures.</p><table-wrap position="float" id="T3"><label>Table 3</label><caption><p>Simulation results.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="center"><italic>&#x003b2;</italic><sub>2</sub></td><td align="center">n</td><td align="center">Purposeful</td><td align="center">Stepwise</td><td align="center">Backward</td><td align="center">Forward</td></tr></thead><tbody><tr><td align="center">0.13</td><td align="center">60</td><td align="center">9.7</td><td align="center">6.3</td><td align="center">10.3</td><td align="center">10.8</td></tr><tr><td></td><td align="center">120</td><td align="center">25.8</td><td align="center">19.8</td><td align="center">24.9</td><td align="center">23</td></tr><tr><td></td><td align="center">240</td><td align="center">55.5</td><td align="center">52</td><td align="center">54.9</td><td align="center">37.4</td></tr><tr><td></td><td align="center">360</td><td align="center">66.4</td><td align="center">65.5</td><td align="center">65.8</td><td align="center">38.7</td></tr><tr><td></td><td align="center">480</td><td align="center">72.5</td><td align="center">72.7</td><td align="center">72.8</td><td align="center">41.1</td></tr><tr><td></td><td align="center">600</td><td align="center">71.4</td><td align="center">72.9</td><td align="center">72.9</td><td align="center">42.9</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td align="center">0.07</td><td align="center">60</td><td align="center">7.5</td><td align="center">3.1</td><td align="center">4.4</td><td align="center">6.7</td></tr><tr><td></td><td align="center">120</td><td align="center">18.6</td><td align="center">11.3</td><td align="center">12.2</td><td align="center">15.8</td></tr><tr><td></td><td align="center">240</td><td align="center">32.2</td><td align="center">22.5</td><td align="center">22.9</td><td align="center">21.4</td></tr><tr><td></td><td align="center">360</td><td align="center">41.5</td><td align="center">35.5</td><td align="center">35.5</td><td align="center">26.9</td></tr><tr><td></td><td align="center">480</td><td align="center">47.9</td><td align="center">44.5</td><td align="center">44.5</td><td align="center">34.6</td></tr><tr><td></td><td align="center">600</td><td align="center">52</td><td align="center">50.5</td><td align="center">50.5</td><td align="center">35.5</td></tr></tbody></table><table-wrap-foot><p>Retention of the correct model for purposeful, stepwise, backward, and forward selection methods, for two values of <italic>&#x003b2;</italic><sub>2 </sub>while specifying confounding at 15% and non-candidate inclusion at 0.15.</p></table-wrap-foot></table-wrap><p>When <italic>&#x003b2;</italic><sub>2 </sub>= 0.07, Table <xref ref-type="table" rid="T3">3</xref> shows that PS performs better across all sample sizes than other variable selection procedures; however, the proportion of correctly retained models is lower for all procedures. This is a result of the fact that <italic>X</italic><sub>2 </sub>becomes non-significant in more simulations and is not retained. Table <xref ref-type="table" rid="T3">3</xref> also shows how <italic>X</italic><sub>2 </sub>is picked up by PS due to its confounding effect which is still present.</p></sec></sec><sec><title>Application</title><p>A subset of observations (N = 307) and variables from the Worchester Heart Attack Study (WHAS) data set [<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B11">11</xref>,<xref ref-type="bibr" rid="B12">12</xref>] were used to compare the results of variable selections between the purposeful selection method and each of the three methods available in SAS PROC LOGISTIC as described above. Variable inclusion and exclusion criteria for existing selection procedures in SAS PROC LOGISTIC were set to comparable levels with the purposeful selection parameters. Specifically, the variable entry criterion was set to 0.25 and the variable retention criterion to 0.1 to minimize the discrepancies as a result of non-comparable parameters.</p><p>The main outcome of interest was vital status at the last follow-up, dead (FSTAT = 1) versus alive (FSTAT = 0). The eleven covariates listed in Table <xref ref-type="table" rid="T4">4</xref> were treated as equally important. The macro calls used to invoke purposeful selection of variables from the WHAS data set under different confounding and non-candidate inclusion settings are given in the appendix.</p><table-wrap position="float" id="T4"><label>Table 4</label><caption><p>WHAS data set variables.</p></caption><table frame="hsides" rules="groups"><tbody><tr><td align="left">FSTAT</td><td align="left">Status as of last follow-up (0 = Alive, 1 = Dead)</td></tr><tr><td align="left">AGE</td><td align="left">Age at hospital admission (Years)</td></tr><tr><td align="left">SEX</td><td align="left">Gender (0 = Male, 1 = Female)</td></tr><tr><td align="left">HR</td><td align="left">Initial heart rate (Beats per minute)</td></tr><tr><td align="left">BMI</td><td align="left">Body mass index (kg/m<sup>2</sup>)</td></tr><tr><td align="left">CVD</td><td align="left">History of cardiovascular disease (0 = No, 1 = Yes)</td></tr><tr><td align="left">AFB</td><td align="left">Atrial fibrillation (0 = No, 1 = Yes)</td></tr><tr><td align="left">SHO</td><td align="left">Cardiogenic shock (0 = No, 1 = Yes)</td></tr><tr><td align="left">CHF</td><td align="left">Congestive heart complications (0 = No, 1 = Yes)</td></tr><tr><td align="left">AV3</td><td align="left">Complete heart block (0 = No, 1 = Yes)</td></tr><tr><td align="left">MIORD</td><td align="left">MI order (0 = First, 1 = Recurrent)</td></tr><tr><td align="left">MITYPE</td><td align="left">MI type (0 = non - Q-wave, 1 = Q-wave)</td></tr></tbody></table></table-wrap><p>Table <xref ref-type="table" rid="T5">5</xref> shows the results of variable retention from our macro and PROC LOGISTIC selection procedures. The univariate analysis identified 9 covariates initially as potential candidates for the multivariate model at the 0.25 alpha level based on the Wald chi-square statistic. Those included AGE, SEX, HR, BMI, CVD, AFB, SHO, CHF, and MIORD. During the iterative multivariate fitting, four of them (SEX, CVD, AFB, and CHF) were eliminated one at a time because they were not significant in the multivariate model at the alpha level of 0.1, and when taken out, did not change any remaining parameter estimates by more than 20%. The variable BMI was also not significant at the 0.1 alpha level but changed the parameter estimate for the MIORD covariate by more than 20% when taken out; therefore, it remained in the model as a confounder. The maximum p-value of the remaining variables AGE, SHO, HR, and MIORD was less than 0.1, at which point the variables originally set aside were reconsidered.</p><table-wrap position="float" id="T5"><label>Table 5</label><caption><p>WHAS data set variables retained in the final models for purposeful selection method under two different settings.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="center"><italic>Purposeful Selection</italic><break/><italic>(20%, 0.1)</italic></td><td align="center"><italic>p-value</italic></td><td align="center"><italic>Purposeful Selection</italic><break/><italic>(15%, 0.15)</italic></td><td align="center"><italic>p-value</italic></td><td align="center"><italic>Forward, Backward, Stepwise</italic></td><td align="center"><italic>p-value</italic></td></tr></thead><tbody><tr><td align="center">AGE</td><td align="center">&#x0003c;0.0001</td><td align="center">AGE</td><td align="center">&#x0003c;0.0001</td><td align="center">AGE</td><td align="center">&#x0003c;0.0001</td></tr><tr><td align="center">SHO</td><td align="center">0.0018</td><td align="center">SHO</td><td align="center">0.0029</td><td align="center">SHO</td><td align="center">0.0039</td></tr><tr><td align="center">HR</td><td align="center">0.0025</td><td align="center">HR</td><td align="center">0.0019</td><td align="center">HR</td><td align="center">0.0011</td></tr><tr><td align="center">MITYPE</td><td align="center">0.091</td><td align="center">MITYPE</td><td align="center">0.0586</td><td align="center">MITYPE</td><td align="center">0.0149</td></tr><tr><td align="center">MIORD</td><td align="center">0.1087</td><td align="center">AV3</td><td align="center">0.0760</td><td align="center">AV3</td><td align="center">0.0672</td></tr><tr><td align="center">BMI</td><td align="center">0.2035</td><td align="center">MIORD</td><td align="center">0.1285</td><td></td><td></td></tr><tr><td></td><td></td><td align="center">BMI</td><td align="center">0.2107</td><td></td><td></td></tr></tbody></table><table-wrap-foot><p>SAS PROC LOGISTIC forward, backward, and stepwise selection methods.</p></table-wrap-foot></table-wrap><p>Out of the remaining two variables set aside initially because they were not significant at the 0.25 level (AV3 and MITYPE), MITYPE made it back in the model when tested (one at a time) with the five retained covariates because it was significant at the 0.1 alpha level. The addition of MITYPE confounded the relationship between MIORD and FSTAT, hence the change in the MIORD p-value from 0.0324 to 0.1087.</p><p>All three selection procedures available in SAS PROC LOGISTIC resulted in the same model (Table <xref ref-type="table" rid="T5">5</xref>). While the resulting model contains only significant covariates, it did not retain the confounder BMI or the variable MIORD which were retained by the purposeful selection method. On the other hand, the variable AV3 was retained.</p><p>Changing the value of confounding to 15% and non-candidate inclusion to 0.15 resulted in the addition of the variable AV3, which was a non-candidate originally but made it in the model at the higher non-candidate inclusion level since its significance was 0.1173. This particular specification resulted in the exact variables that were retained by available selection procedures in SAS PROC LOGISTIC with the addition of one confounding variable (BMI) and another potentially important covariate (MIORD).</p></sec><sec><title>Discussion</title><p>The human modeling process still remains an effective one. We can attempt to control for as many situations as possible through automated computer algorithms, but that is still not an adequate replacement for a skilled analyst making decisions at each step of the modeling process.</p><p>The advantage of the purposeful selection method comes when the analyst is interested in risk factor modeling and not just mere prediction. The algorithm is written in such a way that, in addition to significant covariates, it retains important confounding variables, resulting in a possibly slightly richer model.</p><p>The simulation study demonstrates that the purposeful selection algorithm identifies and retains confounders correctly at a larger rate than other selection procedures, particularly in instances where the significance level of a confounder is between 0.1 and 0.15, when the other algorithms would not retain it.</p><p>We realize that many studies have samples much larger than 600. We tested larger sample sizes, 1000 for instance, and the simulation results suggest that all selection methods except FS converge toward the same proportion of correctly retained models. As the sample gets larger, the variability of even borderline significant confounders gets smaller, and they get retained as significant variables, hence diminishing the retention differences between the selection methods. It is evident from the simulation results that PS works well for the samples in the range of 240&#x02013;600, a common number of participants in epidemiologic and behavioral research studies.</p><sec><title>Limitations</title><p>There are a few limitations to this algorithm. First, variables not selected initially for the multivariate model are tested later on with the selected set of covariates one at a time. This is a possible limitation because any of these variables that would be significant when put in the model jointly will be missed. However, being significant jointly may indicate multicollinearity, in which case the analyst may choose to use only one of those as a proxy or not at all. Also if there is some multicollinearity between significant variables they would likely be retained by all selection procedures as a result of their significant effect. Second, if two non-significant covariates confound each other, they are going to be retained as confounders since all covariates are assumed to be equally important. In a situation where that happens, the analyst should probably consider retaining the two covariates if they are significant at the 0.25 level, indicating some reasonable association with the outcome. Otherwise, the analyst should probably exclude both from the model as meaningless confounders. Additionally, if there is some multicollinearity between non-significant variables, they would likely be retained by PS as a result of confounding effect on each other, and missed by other three selection procedures as a result of their non-significant effect. Third, this algorithm was not designed to force all dummy variables in the model (for instance, one that has three nominal levels which corresponds to two dummy variables that need to be considered as a unit in model inclusion), if one is significant. Other selection procedures have this limitation as well, unless you force dummy variables in the model. However, it is not possible to know a priori whether one of the dummy variables will be significant. If one of the dummy variables is retained as significant, the analyst can manually insert the rest of them in the model. Finally, multi-class problems were not explored in this paper; therefore, the results do not support the robustness of PS over a range of model selection applications and problems.</p></sec></sec><sec><title>Conclusion</title><p>If an analyst is in need of an algorithm that will help guide the retention of significant covariates as well as confounding ones, this macro will provide that. In order to improve the chances of retaining meaningful confounders, we recommend setting the confounding level to 15% and the non-candidate inclusion level to 0.15. Analysts should use this macro as a tool that helps with decisions about the final model, not as a definite answer. One should always carefully examine the model provided by this macro and determine why the covariates were retained before proceeding.</p></sec><sec><title>Appendix</title><sec><title><italic>%PurposefulSelection </italic>SAS Macro Description</title><p>The main <italic>%PurposefulSelection </italic>(PS) macro consists of three calls to sub-macros, <italic>%ScanVar</italic>, <italic>%UniFit</italic>, and <italic>%MVFit</italic>. The <italic>%ScanVar </italic>sub-macro scans the submitted covariates and prepares them for the univariate analysis. The <italic>%UniFit </italic>sub-macro fits all univariate models and creates a data set with the candidate variables for the multivariate analysis. The <italic>%MVFit </italic>sub-macro iteratively fits multivariate models while evaluating the significance and confounding effect of each candidate variable as well as those that were not originally selected. A flowchart of the macro is presented in Figure <xref ref-type="fig" rid="F1">1</xref>.</p><fig position="float" id="F1"><label>Figure 1</label><caption><p><italic><bold>%PurposefulSelection </bold></italic><bold>macro flow chart.</bold></p></caption><graphic xlink:href="1751-0473-3-17-1"/></fig><p>The user must define several macro variables as shown in Table <xref ref-type="table" rid="T6">6</xref>. The macro variable <italic>DATASET </italic>corresponds to the data set to be analyzed. Macro variable <italic>OUTCOME </italic>is the main outcome of interest and should be a binary variable (also known as the dependent variable). The macro uses the <italic>DESCENDING </italic>option by default to model the probability of <italic>OUTCOME </italic>= 1. The macro variable <italic>COVARIATES </italic>represents a set of predictor variables which can all be continuous, binary, or a mix of the two. In the case of a polytomous covariate, dummy variables must be created before invoking the macro and specified as separate variables. All covariates specified here are assumed to be of equal importance. The macro variable <italic>PVALUEI </italic>defines the alpha level for the univariate model at which a covariate will be considered as a candidate for the multivariable analysis. The macro variable <italic>PVALUER </italic>defines the retention criterion for the multivariate model at which a variable will remain in the model. The macro variable <italic>CHBETA </italic>represents the percent change in a parameter estimate (beta) above which a covariate that is removed from the model as non-significant will be considered a confounder and placed back in the model. Even though we recommend inclusion and retention criteria to be set at 0.25 and 0.1, respectively, and confounding at 15% change, these parameters can be directly controlled by the analyst, since they are coded as macro variables. Finally, the macro variable <italic>PVALUENC </italic>defines the inclusion criterion for any non-candidate variables, allowing them to make it back into the model. We recommend this value be set at 0.15 for reasons discussed in the simulation study and application sections. [See additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Purposeful Selection Macro v Beta1_1.txt]</p><table-wrap position="float" id="T6"><label>Table 6</label><caption><p><italic>%PurposefulSelection </italic>macro variables.</p></caption><table frame="hsides" rules="groups"><tbody><tr><td align="left">DATASET</td><td align="left">Input data set</td></tr><tr><td align="left">OUTCOME</td><td align="left">Main outcome (Y)</td></tr><tr><td align="left">COVARIATES</td><td align="left">All covariates (X<sub>1</sub>...X<sub><italic>j</italic></sub>)</td></tr><tr><td align="left">PVALUEI</td><td align="left">Inclusion criteria for multivariate model</td></tr><tr><td align="left">PVALUER</td><td align="left">Retention criteria for multivariate model</td></tr><tr><td align="left">CHBETA</td><td align="left">% change in parameter estimate indicating confounding</td></tr><tr><td align="left">PVALUENC</td><td align="left">Inclusion criteria for non-candidate</td></tr></tbody></table></table-wrap></sec><sec><title><italic>%PurposefulSelection </italic>SAS Macro Code</title><p>Link to SAS macro code: <ext-link ext-link-type="uri" xlink:href="http://www.uams.edu/biostat/bursac/PSMacro.htm"/></p><p>Two macro calls used to analyze WHAS data set described in the application section:</p><p>%<bold><italic>PurposefulSelection </italic></bold>(whas, fstat, age sex hr bmi cvd afb sho chf av3 miord mitype, <bold>0.25</bold>, <bold>0.1</bold>, <bold>20, 0.1</bold>);</p><p>%<bold><italic>PurposefulSelection </italic></bold>(whas, fstat, age sex hr bmi cvd afb sho chf av3 miord mitype, <bold>0.25</bold>, <bold>0.1</bold>, <bold>15, 0.15</bold>);</p></sec></sec><sec><title>Competing interests</title><p>The authors declare that they have no competing interests.</p></sec><sec><title>Authors' contributions</title><p>ZB coded and tested the macro and wrote the manuscript. CHG coded and tested the macro and worked on revisions of the paper. DKW helped with conceptual design of the idea for the algorithm and worked on the revisions of the manuscript. DWH conceptualized the idea for the macro and worked on the revisions of the paper.</p></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="S1"><caption><title>Additional file 1</title><p><bold>Purposeful Selection Macro v Beta1_1.txt</bold></p></caption><media xlink:href="1751-0473-3-17-S1.txt" mimetype="text" mime-subtype="plain"><caption><p>Click here for file</p></caption></media></supplementary-material></sec></body><back><ref-list><ref id="B1"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Hosmer</surname><given-names>DW</given-names></name><name><surname>Lemeshow</surname><given-names>S</given-names></name></person-group><source>Applied Logistic Regression</source><year>2000</year><publisher-name>New York: Wiley</publisher-name></citation></ref><ref id="B2"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Hosmer</surname><given-names>DW</given-names></name><name><surname>Lemeshow</surname><given-names>S</given-names></name></person-group><source>Applied Survival Analysis: Regression Modeling of Time to Event Data</source><year>1999</year><publisher-name>New York: Wiley</publisher-name></citation></ref><ref id="B3"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Russell</surname><given-names>SJ</given-names></name><name><surname>Norvig</surname><given-names>P</given-names></name></person-group><source>Artificial Intelligence: A Modern Approach</source><year>2003</year><publisher-name>New Jersey: Prentice Hall</publisher-name></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Gutin</surname><given-names>G</given-names></name><name><surname>Yeo</surname><given-names>A</given-names></name><name><surname>Zverovich</surname><given-names>A</given-names></name></person-group><article-title>Traveling salesman should not be greedy: domination analysis of greedy-type heuristics for the TSP</article-title><source>Discrete Applied Mathematics</source><year>2002</year><volume>117</volume><fpage>81</fpage><lpage>86</lpage><pub-id pub-id-type="doi">10.1016/S0166-218X(01)00195-0</pub-id></citation></ref><ref id="B5"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Bang-Jensen</surname><given-names>J</given-names></name><name><surname>Gutin</surname><given-names>G</given-names></name><name><surname>Yeo</surname><given-names>A</given-names></name></person-group><article-title>When the greedy algorithm fails</article-title><source>Discrete Optimization</source><year>2004</year><volume>1</volume><fpage>121</fpage><lpage>127</lpage><pub-id pub-id-type="doi">10.1016/j.disopt.2004.03.007</pub-id></citation></ref><ref id="B6"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Bendall</surname><given-names>G</given-names></name><name><surname>Margot</surname><given-names>F</given-names></name></person-group><article-title>Greedy Type Resistance of Combinatorial Problems</article-title><source>Discrete Optimization</source><year>2006</year><volume>3</volume><fpage>288</fpage><lpage>298</lpage><pub-id pub-id-type="doi">10.1016/j.disopt.2006.03.001</pub-id></citation></ref><ref id="B7"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Guyon</surname><given-names>I</given-names></name><name><surname>Elisseeff</surname><given-names>A</given-names></name></person-group><article-title>An introduction to variable and feature selection</article-title><source>Journal of Machine Learning Research</source><year>2003</year><volume>3</volume><fpage>1157</fpage><lpage>1182</lpage><pub-id pub-id-type="doi">10.1162/153244303322753616</pub-id></citation></ref><ref id="B8"><citation citation-type="book"><person-group person-group-type="author"><collab>SAS Institute Inc</collab></person-group><source>SAS/STAT User's Guide, Version 9.1</source><year>2004</year><publisher-name>Cary, NC: SAS Institute Inc</publisher-name></citation></ref><ref id="B9"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Bendel</surname><given-names>RB</given-names></name><name><surname>Afifi</surname><given-names>AA</given-names></name></person-group><article-title>Comparison of stopping rules in forward regression</article-title><source>Journal of the American Statistical Association</source><year>1977</year><volume>72</volume><fpage>46</fpage><lpage>53</lpage><pub-id pub-id-type="doi">10.2307/2286904</pub-id></citation></ref><ref id="B10"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Mickey</surname><given-names>J</given-names></name><name><surname>Greenland</surname><given-names>S</given-names></name></person-group><article-title>A study of the impact of confounder-selection criteria on effect estimation</article-title><source>American Journal of Epidemiology</source><year>1989</year><volume>129</volume><fpage>125</fpage><lpage>137</lpage><pub-id pub-id-type="pmid">2910056</pub-id></citation></ref><ref id="B11"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Goldberg</surname><given-names>RJ</given-names></name><name><surname>Gore</surname><given-names>JM</given-names></name><name><surname>Alpert</surname><given-names>JS</given-names></name><name><surname>Dalen</surname><given-names>JE</given-names></name></person-group><article-title>Recent changes in the heart attack rates and survival of acute myocardial infarction (1975&#x02013;1981): The Worcester Heart Attack study</article-title><source>Journal of the American Medical Association</source><year>1986</year><volume>255</volume><fpage>2774</fpage><lpage>2779</lpage><pub-id pub-id-type="pmid">3701991</pub-id><pub-id pub-id-type="doi">10.1001/jama.255.20.2774</pub-id></citation></ref><ref id="B12"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Goldberg</surname><given-names>RJ</given-names></name><name><surname>Gorak</surname><given-names>EJ</given-names></name><name><surname>Yarzebski</surname><given-names>J</given-names></name><name><surname>Hosmer</surname><given-names>DW</given-names></name><name><surname>Dalen</surname><given-names>P</given-names></name><name><surname>Gore</surname><given-names>JM</given-names></name><name><surname>Dalen</surname><given-names>JE</given-names></name></person-group><article-title>A community-wide perspective of gender differences and temporal trends in the incidence and survival rates following acute myocardial infarction and out-of-hospital deaths due to coronary heart disease</article-title><source>Circulation</source><year>1993</year><volume>87</volume><fpage>1997</fpage><lpage>1953</lpage></citation></ref></ref-list></back></article>