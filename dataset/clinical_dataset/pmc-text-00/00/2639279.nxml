<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd"><article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article" xml:lang="EN"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id><journal-id journal-id-type="publisher-id">bioinformatics</journal-id><journal-id journal-id-type="hwp">bioinfo</journal-id><journal-title>Bioinformatics</journal-title><issn pub-type="ppub">1367-4803</issn><issn pub-type="epub">1460-2059</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">18852176</article-id><article-id pub-id-type="pmc">2639279</article-id><article-id pub-id-type="doi">10.1093/bioinformatics/btn526</article-id><article-id pub-id-type="publisher-id">btn526</article-id><article-categories><subj-group subj-group-type="heading"><subject>Original Papers</subject><subj-group><subject>Sequence Analysis</subject></subj-group></subj-group></article-categories><title-group><article-title>Position-dependent motif characterization using non-negative matrix factorization</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Hutchins</surname><given-names>Lucie N.</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Murphy</surname><given-names>Sean M.</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Singh</surname><given-names>Priyam</given-names></name><xref ref-type="aff" rid="AFF1"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Graber</surname><given-names>Joel H.</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref><xref ref-type="aff" rid="AFF1"><sup>2</sup></xref><xref ref-type="corresp" rid="COR1">*</xref></contrib></contrib-group><aff id="AFF1"><sup>1</sup>Center for Genome Dynamics, The Jackson Laboratory, Bar Harbor, ME 04609 and <sup>2</sup>Bioinformatics Program, Boston University, Boston, MA 02215, USA</aff><author-notes><corresp id="COR1">*To whom correspondence should be addressed.</corresp><fn><p>Associate Editor: Limsoon Wong</p></fn></author-notes><pub-date pub-type="ppub"><day>1</day><month>12</month><year>2008</year></pub-date><pub-date pub-type="epub"><day>13</day><month>10</month><year>2008</year></pub-date><pub-date pub-type="pmc-release"><day>13</day><month>10</month><year>2008</year></pub-date><volume>24</volume><issue>23</issue><fpage>2684</fpage><lpage>2690</lpage><history><date date-type="received"><day>16</day><month>5</month><year>2008</year></date><date date-type="rev-recd"><day>12</day><month>9</month><year>2008</year></date><date date-type="accepted"><day>6</day><month>10</month><year>2008</year></date></history><permissions><copyright-statement>&#x000a9; 2008 The Author(s)</copyright-statement><copyright-year>2008</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/"><p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">http://creativecommons.org/licenses/by-nc/2.0/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</p></license></permissions><abstract><p><bold>Motivation:</bold> <italic>Cis</italic>-acting regulatory elements are frequently constrained by both sequence content and positioning relative to a functional site, such as a splice or polyadenylation site. We describe an approach to regulatory motif analysis based on non-negative matrix factorization (NMF). Whereas existing pattern recognition algorithms commonly focus primarily on sequence content, our method simultaneously characterizes both positioning and sequence content of putative motifs.</p><p><bold>Results:</bold> Tests on artificially generated sequences show that NMF can faithfully reproduce both positioning and content of test motifs. We show how the variation of the residual sum of squares can be used to give a robust estimate of the number of motifs or patterns in a sequence set. Our analysis distinguishes multiple motifs with significant overlap in sequence content and/or positioning. Finally, we demonstrate the use of the NMF approach through characterization of biologically interesting datasets. Specifically, an analysis of mRNA 3&#x02032;-processing (cleavage and polyadenylation) sites from a broad range of higher eukaryotes reveals a conserved core pattern of three elements.</p><p><bold>Contact:</bold> <email>joel.graber@jax.org</email></p><p><bold>Supplementary information:</bold> <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn526/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p></abstract></article-meta></front><body><sec sec-type="intro" id="SEC1"><title>1 INTRODUCTION</title><p>Regulatory sequence identification and characterization remains an important and challenging problem. Many classes of functional sequences, for instance those involved in processing of precursor mRNA (pre-mRNA), are constrained both by sequence content and positioning with respect to a functional site. Standard pattern recognition tools for sequence analysis typically either ignore positioning effects altogether, or else force the positioning to fit a predefined model, such as a Gaussian distribution (Ao <italic>et al.</italic>, <xref ref-type="bibr" rid="B1">2004</xref>). Recent reviews of computational approaches to pattern recognition have pointed out that positioning preference remains an underutilized means of specifying motifs (Li and Tompa, <xref ref-type="bibr" rid="B19">2006</xref>; Tompa <italic>et al.</italic>, <xref ref-type="bibr" rid="B31">2005</xref>). Specific positioning of motifs, especially relative positioning, can be evolutionarily conserved (Vardhanabhuti <italic>et al.</italic>, <xref ref-type="bibr" rid="B33">2007</xref>). Characterization of positioning dependencies have most commonly been approached in variants of positional word counting (PWC) (Fairbrother <italic>et al.</italic>, <xref ref-type="bibr" rid="B7">2004</xref>; Hu <italic>et al.</italic>, <xref ref-type="bibr" rid="B13">2005</xref>; Salisbury <italic>et al.</italic>, <xref ref-type="bibr" rid="B28">2006</xref>), tracking both occurrence and relative position of all of the sequence words of a given size <italic>k</italic> (<italic>k</italic>-mers). PWC results in a two-dimensional matrix (<underline><italic>V</italic></underline>), in which rows are indexed by <italic>k</italic>-mer and columns are indexed by position relative to a functional site. The rows of such a matrix can be interpreted as unnormalized conditional probability distributions, reflecting the probability of observing the specific <italic>k</italic>-mer at a given position relative to the functional site (and conditional on its presence).</p><p>Previous analysis based on PWC relied on standard clustering approaches, such as hierarchical or <italic>k</italic>-means, identifying groups of <italic>k</italic>-mers with similar positioning probabilities near functional sites (Hu <italic>et al.</italic>, <xref ref-type="bibr" rid="B13">2005</xref>; Loke <italic>et al.</italic>, <xref ref-type="bibr" rid="B20">2005</xref>). Several approaches have been developed to merge the clusters of related <italic>k</italic>-mers into a single representative positional weight matrix (PWM) (Hu <italic>et al.</italic>, <xref ref-type="bibr" rid="B13">2005</xref>; Loke <italic>et al.</italic>, <xref ref-type="bibr" rid="B20">2005</xref>). These approaches produce reasonable results in the instance of independent, non-overlapping motifs, however, functional motifs often overlap significantly in positioning and/or sequence content. A particularly relevant case can be found in the UG- and U-rich elements that occur downstream of vertebrate 3&#x02032;-processing sites. These elements are quite degenerate in sequence content (Hu <italic>et al.</italic>, <xref ref-type="bibr" rid="B13">2005</xref>; Salisbury <italic>et al.</italic>, <xref ref-type="bibr" rid="B28">2006</xref>; Zhao <italic>et al.</italic>, <xref ref-type="bibr" rid="B35">1999</xref>, and have overlapping but distinct positioning distributions (Salisbury <italic>et al.</italic>, <xref ref-type="bibr" rid="B28">2006</xref>), conditions that result in a number of U-rich <italic>k</italic>-mers with multi-modal positioning distributions, reflecting the likelihood that the <italic>k</italic>-mer can appear as a part of either the U- or UG-rich motif (e.g. <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn526/DC1">Supplementary Fig. 1</ext-link>).<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>Variation of the RSS with the number of elements (<italic>r</italic>) provides a robust estimate of the proper number of vectors. (<bold>a</bold>) Test matrices, with (black triangles) and without (green crosses) inserted patterns. Line plots represent a least squares linear fit of the last five points in each series. (<bold>b</bold>) <italic>RSS</italic> versus <italic>r</italic> plots for random sequences (open boxes), sequences with six inserted patterns (red squares) and human 3&#x02032;-processing site flanking sequences (blue diamonds).</p></caption><graphic xlink:href="btn526f1"/></fig></p><p>This defines the challenge to be addressed: given the set of positioning distributions for all <italic>k</italic>-mers (as defined in the PWC matrix), derive the underlying motifs that are most likely to have generated it. To solve this problem, we adapted the non-negative matrix factorization (NMF) algorithm, a dimension reduction technique first developed for image processing (Lee and Seung, <xref ref-type="bibr" rid="B17">1999</xref>) that has subsequently gained popularity in processing high-dimensional biological data, such as microarrays (Carmona-Saez <italic>et al.</italic>, <xref ref-type="bibr" rid="B4">2006</xref>; Kim and Tidor, <xref ref-type="bibr" rid="B14">2003</xref>; Pascual-Montano <italic>et al.</italic>, <xref ref-type="bibr" rid="B24">2006b</xref>). NMF, similar to principal components analysis, generates &#x000d2;basis vectors&#x000d3; (referred to here as &#x02018;elements&#x02019;) to reduce the dimensionality of large datasets. The original authors found that the non-negativity constraint resulted in elements that reflected distinct components of the underlying data, for instance eyes or a nose in facial images. In our analysis, this is analogous to elements representing specific sequence patterns or putative regulatory motifs.</p><p>We first define terminology: in the abstract analysis of NMF, we refer to a set of features that are measured in samples. In tangible examples, we have pixels measured in images, gene probesets measured in microarray experiments, or sequence words (<italic>k</italic>-mers) counted in positions or windows. The successful application of NMF relies on the validity of the following assumptions: (1) the measurement of feature <italic>i</italic> in sample <italic>j</italic> can be approximated as a linear superposition of <italic>r</italic> patterns [equation (<xref ref-type="disp-formula" rid="M1">1</xref>)]; (2) the <italic>m</italic>-th term in the sum is the product of two probabilities: the probability of observing feature <italic>i</italic> in pattern <italic>m</italic> and the probability of observing pattern <italic>m</italic> in sample <italic>j</italic> and (3) the relative probabilities of observing each feature in the <italic>m</italic>-th pattern are constant across all samples.<disp-formula id="M1"><label>(1)</label><graphic xlink:href="btn526m1.jpg" position="float"/></disp-formula></p><p>In this article, we investigate the parameters of the NMF method, specifically investigating the robustness of the solutions with variation in the analysis parameters. We demonstrate the use of the NMF algorithm for the detection and characterization of sequence motifs that include constrained positioning, producing models of both sequence content and positioning. We show how variation in the residual sum of squares (RSS) of the approximated data matrix provides a robust estimate of the appropriate number of elements, while simultaneously revealing whether or not an NMF analysis is appropriate for the dataset. Analysis of synthetic datasets demonstrates that NMF can accurately describe both positioning and sequence characteristics of implanted patterns, and that NMF finds patterns that are missed by other approaches to pattern recognition. Finally, we apply the NMF approach to two interesting biological datasets: 3&#x02032;-processing sites from a phylogenetically broad sampling of eukaryotic organisms and transcription start sites from the fruit fly, <italic>Drosophila melanogaster</italic> (available in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn526/DC1">Supplementary Materials</ext-link>).</p></sec><sec sec-type="materials" id="SEC2"><title>2 MATERIALS AND METHODS</title><sec id="SEC2.1"><title>2.1 Synthetic test matrices and sequences</title><p>To test the theoretical basis for the use of the RSS to establish the number of elements <italic>r</italic>, we generated two artificial matrices. The first matrix was generated from pseudo-random draws from a Gaussian distribution. The second matrix was generated to precisely match the conditions that NMF models. Starting with a random background, patterns to be added were generated by pseudo-random draws that assigned (1) the probability of each feature occurring in each pattern (corresponding to the <underline><italic>W</italic></underline> matrix, defined below), and (2) the probability of each pattern occurring in each measurement (the <underline><italic>H</italic></underline> matrix defined below).</p><p>To test the complete motif characterization procedure, we generated randomized sequences (based on fixed known dinucleotide frequencies) seeded with known motifs (<xref ref-type="table" rid="T1">Table 1</xref>). In most tests, motifs were inserted into 95% of the test sequences, however, we also explicitly also generated sets of size <italic>T</italic> = 300 in which all motifs were put into 50% and 25% of the sequences, respectively. In order to better mimic true conditions, we used sequences with length 400 nt, defining the center point as position 0, and used distinct dinucleotide frequencies for the negative and positive portions of the sequences. To test the performance with changes in number of sequences, we generated independent training sets with sizes <italic>T</italic> = 30, 100, 300, 1000, 3000 and 10 000, respectively. Motifs were placed within these sequences according to independent pseudo-random draws from a positioning distribution and a sequence content PWM. All sequence files used in this analysis are available at <ext-link ext-link-type="uri" xlink:href="http://harlequin.jax.org/nmf/">http://harlequin.jax.org/nmf/</ext-link>.<table-wrap id="T1" position="float"><label>Table 1.</label><caption><p>Summary of the six motifs used in artificial sequence sets</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Motif</th><th rowspan="1" colspan="1">Consensus</th><th rowspan="1" colspan="1"><italic>bits/base</italic><xref ref-type="table-fn" rid="TF1"><sup>a</sup></xref></th><th rowspan="1" colspan="1"><xref ref-type="table-fn" rid="TF2"><sup>b</sup></xref><italic>X</italic><sup>2</sup></th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">CCCCCC</td><td rowspan="1" colspan="1">0.64</td><td rowspan="1" colspan="1">2.9</td></tr><tr><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">GGTGGG</td><td rowspan="1" colspan="1">1.5</td><td rowspan="1" colspan="1">7.1</td></tr><tr><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1">AATAAA</td><td rowspan="1" colspan="1">1.5</td><td rowspan="1" colspan="1">23.2</td></tr><tr><td rowspan="1" colspan="1">4</td><td rowspan="1" colspan="1">ACAC</td><td rowspan="1" colspan="1">0.82</td><td rowspan="1" colspan="1">51.1</td></tr><tr><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">TGTGTG</td><td rowspan="1" colspan="1">0.82</td><td rowspan="1" colspan="1">18.2</td></tr><tr><td rowspan="1" colspan="1">6</td><td rowspan="1" colspan="1">GCGCGCGC</td><td rowspan="1" colspan="1">0.82</td><td rowspan="1" colspan="1">1.9</td></tr></tbody></table><table-wrap-foot><fn id="TF1"><p><sup>a</sup><italic>bits/base</italic> is the summed information context across the motif, divided by the length of the motif.</p></fn><fn id="TF2"><p><sup>b</sup><italic>X</italic><sup>2</sup> is a &#x003c7;<sup>2</sup> measure of the divergence of the motif positioning from a uniform distribution.</p></fn></table-wrap-foot></table-wrap></p></sec><sec id="SEC2.2"><title>2.2 Biological training sequences</title><p>We obtained putative 3&#x02032;-processing sites from our database PACdb, which uses EST-to-genome alignments to assign probable sites as described previously (Brockman <italic>et al.</italic>, <xref ref-type="bibr" rid="B2">2005</xref>). Putative transcription start sites and surrounding sequences for <italic>D.melanogaster</italic> were obtained from the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn526/DC1">Supplementary Material</ext-link> from Gershenzon <italic>et al.</italic> (<xref ref-type="bibr" rid="B9">2006</xref>).</p></sec><sec id="SEC2.3"><title>2.3 NMF decomposition</title><p>Starting with a set of training sequences all containing, and aligned on, a common functional site, we generate the PWC matrix <underline><italic>V</italic></underline>, a two-dimensional matrix of counts that is indexed by <italic>k</italic>-mer and relative position, respectively. In practice, <italic>k</italic>-mers are counted in contiguous windows of size <italic>w</italic>, where each <italic>k</italic>-mer is assigned to the window in which it begins. As such, <italic>k</italic>-mers can span the boundary between adjacent windows, but will only be assigned to one. In the case of small datasets (less than a few hundred training sequences), we find it advantageous to smooth each row of <underline><italic>V</italic></underline> independently, maintaining the total counts across the entire row (for real or artificial data). Pseudocounts are also an available option to compensate for small datasets, however they have not explicitly been investigated in this study. Using the same update and objective function as the original NMF publication (Lee and Seung, <xref ref-type="bibr" rid="B17">1999</xref>), we decompose the PWC matrix <underline><italic>V</italic></underline> according to Equation (<xref ref-type="disp-formula" rid="M2">2</xref>), where <italic>V</italic><sub><italic>ij</italic></sub> = count of the <italic>i</italic>-th sequence word in the <italic>j</italic>-th position window, <italic>W</italic><sub><italic>im</italic></sub> = the weight of the <italic>i</italic>-th <italic>k</italic>-mer in the <italic>m</italic>-th element, <italic>H</italic><sub><italic>mj</italic></sub> = activity of the <italic>m</italic>-th element in the <italic>j</italic>-th position window, <italic>M</italic> is the number of <italic>k</italic>-mers considered, <italic>N</italic> is the number of positioning windows, and <italic>r</italic> is the number of elements created.<disp-formula id="M2"><label>(2)</label><graphic xlink:href="btn526m2.jpg" position="float"/></disp-formula>We interpret the <italic>r</italic> basis vectors as representing distinct patterns of sequence content and positioning (Graber <italic>et al.</italic>, <xref ref-type="bibr" rid="B11">2007</xref>), including both specific sequence elements representing functional components, along with specific changes in sequence composition such as found at the junction between UTR and intergenic sequence. In practice, we typically view the positioning data (<underline>H</underline>) in its raw form and also in a normalized form, in which each column of <underline>H</underline> is scaled to a common area under its curve. The raw data view enables comparison of the relative activity between elements, whereas the normalized view emphasizes the specificity of positioning for each element. All plots in this article are normalized.</p><p>A critical issue in any dimensional reduction analysis is the selection of the reduced number of dimensions (<italic>r</italic>). Previous attempts to optimize selection of <italic>r</italic> in NMF analysis have focused primarily on the cophenetic correlation coefficient (CCC) (Brunet <italic>et al.</italic>, <xref ref-type="bibr" rid="B3">2004</xref>; Pascual-Montano <italic>et al.</italic>, <xref ref-type="bibr" rid="B23">2006a</xref>). We find that variation in the RSS between the data matrix (<underline><italic>V</italic></underline>) and the NMF-estimated matrix (<underline><italic>WH</italic></underline>) provides a natural means for estimation of <italic>r</italic>, in as much as this plot shows an inflection when <italic>r</italic> matches the proper number of dimensions. In practice, while an optimal NMF solution requires several hundred random restarts, the determination of <italic>r</italic> can be made with a significantly smaller number of solutions, typically 20&#x02013;30 for tested each value of <italic>r</italic> (data not shown).</p><p>We first investigated variation of RSS with variation of <italic>r</italic> in two artificial datasets, with and without patterns inserted. The RSS of the purely random matrix shows a roughly linear decrease with increased number of elements (<xref ref-type="fig" rid="F1">Fig. 1</xref>a), whereas the matrix with inserted patterns shows a clear inflection point where <italic>r</italic> equals the number of patterns. Our interpretation of this result is that while <italic>r</italic> is less than the number of patterns, there is excess variance in the data that cannot be adequately approximated by the NMF matrix. In contrast, as <italic>r</italic> equals and surpasses the true number of patterns, the additional reduction of the RSS is minor, since the variation captured by the additional elements is likely only random noise.</p><p>Further confirmation of this phenomenon was obtained through NMF analysis of three sequence sets, artificial sequences with and without inserted patterns and 8500 sequences with length 400 nt centered on putative human 3&#x02032;-processing sites (Salisbury <italic>et al.</italic>, <xref ref-type="bibr" rid="B28">2006</xref>). PWC matrices were generated from each sequence set, then subsequently analyzed via NMF, largely reproducing the results of the artificial matrices (<xref ref-type="fig" rid="F1">Fig. 1</xref>b). The first set, with no patterns inserted, shows a roughly constant and linear decrease in RSS with increasing <italic>r</italic>. In contrast, the set with known motifs inserted shows an inflection point at approximately the number of inserted patterns. Finally, the analysis of putative 3&#x02032;-processing sites also displays a disjoint pattern, with an inflection point at approximately <italic>r</italic> = 9. For all analysis in this article, we use the optimal value of <italic>r</italic> determined in this manner.</p><p>The complete NMF analysis requires the selection of a number of free parameters. Of particular note are the selection of window size (<italic>w</italic>) and <italic>k</italic>-mers size (<italic>k</italic>). Larger windows give increased statistical robustness afforded by aggregation but at the cost of less specific positioning. Longer words enable better characterization of long patterns, but at the cost of increased execution time as well as an increased number of sequences needed for training. In the ideal case of a large number of training sequences, <italic>k</italic> would be at least as long as the smallest expected motif, and <italic>w</italic> = 1, counting each position individually. However, datasets are finite and can number only a few tens to hundreds. Previous studies have provided estimates of the minimum number of sequences required for reasonable estimation of <italic>k</italic>-mer probabilities (Fairbrother <italic>et al.</italic>, <xref ref-type="bibr" rid="B6">2002</xref>). In practice, we typically select <italic>w</italic> and <italic>k</italic> jointly such that the product <italic>wT</italic> is at least five times greater than 4<sup><italic>k</italic></sup>, the number of <italic>k</italic>-mers under consideration.</p></sec><sec id="SEC2.4"><title>2.4 Converting NMF word lists (<italic>W</italic><sub>.<italic>j</italic></sub>) to motifs</title><p>As we reported previously (Graber <italic>et al.</italic>, <xref ref-type="bibr" rid="B11">2007</xref>), we assume that the weighted list of <italic>k</italic>-mers for each element can be interpreted as the expected distribution of <italic>k</italic>-mer counts for each element. The optimal motif is inferred as the motif with the maximum multinomial probability of observing the expected distribution. The specifics of the probability calculation were described previously (Graber <italic>et al.</italic>, <xref ref-type="bibr" rid="B11">2007</xref>). Briefly, the probability of observing any specific <italic>k</italic>-mer within a motif is the sum of the probabilities of observing the motif at all positions within the motif, including those that span the boundaries between the motif and the background. This summation specifically enables characterization of motifs of nearly arbitrary size regardless of the choice of <italic>k</italic>. To optimize the search of potential motifs, we use a Markov Chain Monte Carlo (MCMC) approach (Gelman <italic>et al.</italic>, <xref ref-type="bibr" rid="B8">1995</xref>). The length of the motif is first sampled from a user-specified range and then nucleotide probabilities at each position are filled randomly. The multinomial distribution for the initial motif is scored against the expected distribution, and then the following procedure is used to update the motif. A specific <italic>k</italic>-mer (<italic>w</italic><sub><italic>i</italic></sub>) is sampled according to the distribution returned by the NMF analysis. Then a position <italic>j</italic> within the current motif is sampled according to the match of the <italic>k</italic>-mer within the motif. Finally, the motif is either made more or less similar to the <italic>k</italic>-mer at motif positions <italic>j</italic> to <italic>j</italic>+<italic>k</italic> &#x02212; 1, depending upon whether or not <italic>w</italic><sub><italic>i</italic></sub> is over- or underrepresented in the current model compared with the expected distribution. Following a standard MCMC approach, updated motifs are automatically accepted if the multinomial probability increases, and randomly accepted according to a Boltzmann distribution if the multinomial probability decreases (Gelman <italic>et al.</italic>, <xref ref-type="bibr" rid="B8">1995</xref>). This process iterates until no improvement is observed for a user-specified number of iterations.</p><p>In the current implementation of the NMF pattern finder, we have made no attempt to optimize performance. A full analysis, including PWC creation, NMF decomposition and motif construction typically lasts tens to hundreds of minutes, depending on values of <italic>T</italic>, <italic>k</italic>, <italic>w</italic> and <italic>r</italic>. Preliminary tests incorporating the web-based bioNMF resource (Mejia-Roa <italic>et al.</italic>, <xref ref-type="bibr" rid="B21">2008</xref>) showed significant time savings, while also confirming the analysis results.</p></sec><sec id="SEC2.5"><title>2.5 Comparison with other pattern-finding approaches</title><p>NMF pattern identification was compared with several other approaches, including the Gibbs Sampler (Lawrence <italic>et al.</italic>, <xref ref-type="bibr" rid="B16">1993</xref>), the Improbizer (Ao <italic>et al.</italic>, <xref ref-type="bibr" rid="B1">2004</xref>), YMF (Sinha and Tompa, <xref ref-type="bibr" rid="B30">2003</xref>), Weeder (Pavesi <italic>et al.</italic>, <xref ref-type="bibr" rid="B25">2004</xref>) and oligo-analysis tools (van Helden, <xref ref-type="bibr" rid="B32">2003</xref>). As with previous studies of pattern identification tools (Li and Tompa, <xref ref-type="bibr" rid="B19">2006</xref>; Tompa <italic>et al.</italic>, <xref ref-type="bibr" rid="B31">2005</xref>), an artificial dataset (<italic>T</italic> = 300) was used as the basis for comparison, specifically to remove uncertainty of the exact patterns present in the test sequence set. The Gibbs sampler and the Improbizer were set to find six nucleic acid motifs, searching on single strand only. The Gibbs sampler was allowed to vary motif size between 5 nt and 8 nt. The Improbizer automatically determines optimal motif size. Background frequency estimates (required for YMF, Weeder and oligo-analysis) were generated through analysis of the randomized sequences with no motifs inserted. Hexamers were counted for YMF and oligo-analysis, and the &#x02018;SMALL&#x02019; setting was used in Weeder. All other settings were left as defaults.</p></sec></sec><sec sec-type="results" id="SEC3"><title>3 RESULTS AND DISCUSSION</title><sec id="SEC3.1"><title>3.1 Characterizing the method and exploring parameters with artificial sequence sets</title><p>We previously used the NMF method to characterize sequences involved in controlling 3&#x02032;-processing and <italic>trans</italic>-splicing in the nematode, <italic>Caenorhabditis elegans</italic> (Graber <italic>et al.</italic>, <xref ref-type="bibr" rid="B11">2007</xref>). As described in that work, the complete NMF method is dependent upon several free parameters, including but not limited to, the size of the <italic>k</italic>-mers in the initial count (<italic>k</italic>), the position window size (<italic>w</italic>), the number of elements (<italic>r</italic>) and the number of training sequences available (<italic>T</italic>).</p><p>To investigate the effects of these parameters and specifically to test the robustness of the results with variation in the parameters, we generated an artificial dataset in which motifs with defined sequence content and positioning were inserted into sequences generated from a defined dinucleotide background. Six different motifs were created with varying levels of specificity in both positioning and sequence (<xref ref-type="table" rid="T1">Table 1</xref>). To reduce computational complexity, we varied only one parameter at a time, while holding all others fixed. <xref ref-type="fig" rid="F2">Figure 2</xref> shows an example analysis, comparing the actual and NMF-derived motifs for the <italic>T</italic> = 300 test set.<fig id="F2" position="float"><label>Fig. 2.</label><caption><p>An example comparing NMF analysis with the actual motifs used to generate the <italic>T</italic> = 300 test set. All sequence logos (Schneider and Stephens, <xref ref-type="bibr" rid="B29">1990</xref>) in this and subsequent figures have a vertical scale of 2 bits and were generated with WebLogo (Crooks <italic>et al.</italic>, <xref ref-type="bibr" rid="B5">2004</xref>). In this and subsequent figures, the colors of line plots and logo frames are matched in corresponding pairs for each element. Patterns that are interpreted as changes in background composition are not shown as sequence logos.</p></caption><graphic xlink:href="btn526f2"/></fig></p><sec id="SEC3.1.1"><title>3.1.1 Variation in training set size (<italic>T</italic>)</title><p>The number of training sequences (<italic>T</italic>) is of critical importance, since it is often out of the researcher's control, yet explicitly determines the statistical power to discern subtle signals. Training sets were generated of varying sizes (<italic>T</italic> = 30, 100, 300, 1000, 3000 and 10 000) and NMF analysis was performed with parameters fixed at <italic>w</italic> = 3, <italic>k</italic> = 4 (tetramers) and <italic>r</italic> = 8. Note that while six motifs were inserted, the best results are obtained with <italic>r</italic> = 8. As noted previously (Graber <italic>et al.</italic>, <xref ref-type="bibr" rid="B11">2007</xref>), the NMF analysis identifies both specific motifs and changes in background composition along the length of the sequences. The additional two elements in the NMF decomposition compensate for the change in background at the center point of the test sequences.</p><p>The use of an artificial dataset allows explicit comparison of NMF-derived patterns with the motif models. The rows of the <underline><italic>W</italic></underline> matrix, which represent the frequency of occurrence for each <italic>k</italic>-mer in each motif, were compared with an exact count of the tetramers that were inserted as part of each motif (including those that span the motif-background boundary) using a Pearson's correlation. The best match of each NMF motif to an inserted motif is reported in <xref ref-type="table" rid="T2">Table 2</xref>(Panel A). Similarly, the columns of the <underline><italic>H</italic></underline> matrix were compared with the exact distribution of starting positions for each motif by Pearson's correlation, with the best match reported in <xref ref-type="table" rid="T2">Table 2</xref>(Panel B). The NMF approach successfully identifies the positioning for all motifs in the sets with <italic>T</italic> &#x02265; 300 (<italic>r</italic> &#x02265; 0.80), with nearly perfect reproduction for <italic>T</italic> &#x02265; 3000 (<italic>r</italic> &#x02265; 0.88). Even in the smallest datasets, the worst match (motif 4, <italic>r</italic> = 0.31) is still statistically significant. The sequence content determination varies in a similar fashion. The strongest motif, with consensus AATAAA, is unambiguously matched in all datasets (<italic>r</italic> &#x02265; 0.9). As with positioning, the tetramer content of all motifs are well-matched for all sets with <italic>T</italic> &#x02265; 300 (<italic>r</italic> &#x02265; 0.62). It is interesting to note that motif 2, which has identical sequence information content to motif 3, but a less specific positioning distribution, is less well identified, indicating that both the sequence and positioning specificity can affect our ability to successfully characterize motifs. Full output from these analyses are available in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn526/DC1">Supplementary Figure 2</ext-link>.<table-wrap id="T2" position="float"><label>Table 2.</label><caption><p>Improving performance of NMF pattern detection with increase in number of test sequences (<italic>T</italic>)</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1"/><th colspan="6" align="left" rowspan="1">Number of training sequences (<italic>T</italic>)<hr/></th></tr><tr><th rowspan="1" colspan="1">Motif</th><th rowspan="1" colspan="1">30</th><th rowspan="1" colspan="1">100</th><th rowspan="1" colspan="1">300</th><th rowspan="1" colspan="1">1000</th><th rowspan="1" colspan="1">3000</th><th rowspan="1" colspan="1">10 000</th></tr></thead><tbody align="left"><tr><td colspan="7" align="left" rowspan="1"><bold>Panel A</bold> Pattern sequence content</td></tr><tr><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">0.14</td><td rowspan="1" colspan="1">0.23</td><td rowspan="1" colspan="1">0.62</td><td rowspan="1" colspan="1">0.90</td><td rowspan="1" colspan="1">0.90</td><td rowspan="1" colspan="1">0.96</td></tr><tr><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">0.55</td><td rowspan="1" colspan="1">0.67</td><td rowspan="1" colspan="1">0.88</td><td rowspan="1" colspan="1">0.96</td><td rowspan="1" colspan="1">0.98</td><td rowspan="1" colspan="1">0.98</td></tr><tr><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1">0.91</td><td rowspan="1" colspan="1">0.97</td><td rowspan="1" colspan="1">0.99</td><td rowspan="1" colspan="1">0.99</td><td rowspan="1" colspan="1">0.99</td><td rowspan="1" colspan="1">0.99</td></tr><tr><td rowspan="1" colspan="1">4</td><td rowspan="1" colspan="1">0.37</td><td rowspan="1" colspan="1">0.82</td><td rowspan="1" colspan="1">0.93</td><td rowspan="1" colspan="1">0.95</td><td rowspan="1" colspan="1">0.98</td><td rowspan="1" colspan="1">0.97</td></tr><tr><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">0.77</td><td rowspan="1" colspan="1">0.85</td><td rowspan="1" colspan="1">0.94</td><td rowspan="1" colspan="1">0.97</td><td rowspan="1" colspan="1">0.98</td><td rowspan="1" colspan="1">0.96</td></tr><tr><td rowspan="1" colspan="1">6</td><td rowspan="1" colspan="1">0.35</td><td rowspan="1" colspan="1">0.50</td><td rowspan="1" colspan="1">0.70</td><td rowspan="1" colspan="1">0.73</td><td rowspan="1" colspan="1">0.89</td><td rowspan="1" colspan="1">0.91</td></tr><tr><td colspan="7" align="left" rowspan="1"><bold>Panel B</bold> Pattern positioning probability</td></tr><tr><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">0.75</td><td rowspan="1" colspan="1">0.67</td><td rowspan="1" colspan="1">0.93</td><td rowspan="1" colspan="1">0.97</td><td rowspan="1" colspan="1">0.99</td><td rowspan="1" colspan="1">0.97</td></tr><tr><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">0.60</td><td rowspan="1" colspan="1">0.96</td><td rowspan="1" colspan="1">0.98</td><td rowspan="1" colspan="1">0.98</td><td rowspan="1" colspan="1">0.97</td><td rowspan="1" colspan="1">0.98</td></tr><tr><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1">0.76</td><td rowspan="1" colspan="1">0.89</td><td rowspan="1" colspan="1">0.91</td><td rowspan="1" colspan="1">0.92</td><td rowspan="1" colspan="1">0.91</td><td rowspan="1" colspan="1">0.89</td></tr><tr><td rowspan="1" colspan="1">4</td><td rowspan="1" colspan="1">0.31</td><td rowspan="1" colspan="1">0.71</td><td rowspan="1" colspan="1">0.80</td><td rowspan="1" colspan="1">0.85</td><td rowspan="1" colspan="1">0.88</td><td rowspan="1" colspan="1">0.86</td></tr><tr><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">0.64</td><td rowspan="1" colspan="1">0.90</td><td rowspan="1" colspan="1">0.94</td><td rowspan="1" colspan="1">0.97</td><td rowspan="1" colspan="1">0.97</td><td rowspan="1" colspan="1">0.96</td></tr><tr><td rowspan="1" colspan="1">6</td><td rowspan="1" colspan="1">0.60</td><td rowspan="1" colspan="1">0.77</td><td rowspan="1" colspan="1">0.95</td><td rowspan="1" colspan="1">0.95</td><td rowspan="1" colspan="1">0.93</td><td rowspan="1" colspan="1">0.94</td></tr></tbody></table><table-wrap-foot><fn><p>Table entries list the best-match Pearson's correlations between (Panel A) the exact <italic>k</italic>-mer counts generated by insertion of the patterns and rows of the NMF <underline><italic>W</italic></underline> matrix; and (Panel B) the positioning distribution used for pattern insertion and columns of the <underline><italic>H</italic></underline> matrix.</p></fn></table-wrap-foot></table-wrap></p></sec><sec id="SEC3.1.2"><title>3.1.2 Variation in other parameters and conditions</title><p>As described in <xref ref-type="sec" rid="SEC2">Section 2</xref>, the choice of word size (<italic>k</italic>) and window size (<italic>w</italic>) are compromises between conflicting needs. Tests on the <italic>T</italic> = 300 dataset with variations of <italic>w</italic> and <italic>k</italic> show that the identified motifs are robust with parameter variation. Separate analyses were also performed on datasets with patterns inserted into either half or a quarter of the sequences in the training set. Motifs 3&#x02013;5 (<xref ref-type="table" rid="T1">Table 1</xref>) were clearly identified in both sets, motif 2 was identified the 50% set, while the weakest patterns (1 and 6) were poorly matched at best in both sets. Details of these tests are available in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn526/DC1">Supplementary Figures 3&#x02013;5</ext-link>.<fig id="F3" position="float"><label>Fig. 3.</label><caption><p>NMF analysis of the sequence elements that specify 3&#x02032;-processing sites for a variety of eukaryotic organisms reveals a common arrangement of signals. Plots are shown for mouse (<italic>M.musculus</italic>), fugu (<italic>T.rubripes</italic>), mosquito (<italic>A.gambiae</italic>) and rice (<italic>O.sativa</italic>). NMF patterns that are interpreted as changes in background composition are not shown as sequence logos.</p></caption><graphic xlink:href="btn526f3"/></fig></p></sec><sec id="SEC3.1.3"><title>3.1.3 Comparison with existing tools</title><p>To further assess the utility of the NMF approach, we compared it with a number of popular pattern recognition tools, focusing on the <italic>T</italic> = 300 test set. The disparate nature of the results returned from these tools complicates comparison of the specific results, therefore we present a summary (<xref ref-type="table" rid="T3">Table 3</xref>) that focuses primarily on whether or not a reasonable match to each pattern was found. For tools that produce a PWM representation, the match is reported as the sum of the Euclidean distances between columns in the known and inferred motifs (seq <italic>d</italic> in <xref ref-type="table" rid="T3">Table 3</xref>) (Gupta <italic>et al.</italic>, <xref ref-type="bibr" rid="B12">2007</xref>), aligned as to produce the minimum distance. For tools that produce positioning data or models, the match is reported as the Pearson's correlation between the actual and inferred positioning distributions. Best match consensus patterns are reported for pattern-based tools. The NMF approach identifies significant matches in both positioning and sequence content for all six inserted motifs in our test set. The best alternative method was the oligo analysis tools, which return patterns that reasonably match the consensus patterns of all six inserted motifs, however, only consensus sequences are returned, with no distinct positioning information. No other tool produces matches to more than four of the inserted motifs. Further comparisons are available in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn526/DC1">Supplementary Materials</ext-link>.<table-wrap id="T3" position="float"><label>Table 3.</label><caption><p>Comparison of NMF with other pattern finders on the six motif, <italic>T</italic> = 300 sequence set</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1"/><th colspan="3" align="center" rowspan="1">NMF best match<hr/></th><th colspan="3" align="center" rowspan="1">Gibbs sampler<hr/></th><th colspan="3" align="center" rowspan="1">The improbizer<hr/></th><th colspan="2" align="center" rowspan="1">Weeder<hr/></th><th colspan="2" align="center" rowspan="1">Oligo analysis<hr/></th><th colspan="2" align="center" rowspan="1">YMF<hr/></th></tr><tr><th rowspan="1" colspan="1">Motif</th><th rowspan="1" colspan="1"><italic>L</italic></th><th rowspan="1" colspan="1">seq <italic>d</italic></th><th rowspan="1" colspan="1">pos <italic>r</italic></th><th rowspan="1" colspan="1"><italic>L</italic></th><th rowspan="1" colspan="1">seq <italic>d</italic></th><th rowspan="1" colspan="1">pos <italic>r</italic></th><th rowspan="1" colspan="1"><italic>L</italic></th><th rowspan="1" colspan="1">seq <italic>d</italic></th><th rowspan="1" colspan="1">pos <italic>r</italic></th><th rowspan="1" colspan="1"><italic>L</italic></th><th rowspan="1" colspan="1">seq <italic>d</italic></th><th rowspan="1" colspan="1"><italic>L</italic></th><th rowspan="1" colspan="1">consensus</th><th rowspan="1" colspan="1"><italic>L</italic></th><th rowspan="1" colspan="1">consensus</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">8</td><td rowspan="1" colspan="1">1.37</td><td rowspan="1" colspan="1">0.94</td><td rowspan="1" colspan="1">6</td><td rowspan="1" colspan="1">0.69</td><td rowspan="1" colspan="1">0.91</td><td rowspan="1" colspan="1">28</td><td rowspan="1" colspan="1">0.94</td><td rowspan="1" colspan="1">0.62</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">6</td><td rowspan="1" colspan="1">CCCCCC</td><td rowspan="1" colspan="1">6</td><td rowspan="1" colspan="1">CCCCCC</td></tr><tr><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">8</td><td rowspan="1" colspan="1">1.1</td><td rowspan="1" colspan="1">0.98</td><td rowspan="1" colspan="1">6</td><td rowspan="1" colspan="1">0.4</td><td rowspan="1" colspan="1">0.96</td><td rowspan="1" colspan="1">49</td><td rowspan="1" colspan="1">0.17</td><td rowspan="1" colspan="1">0.8</td><td rowspan="1" colspan="1">6</td><td rowspan="1" colspan="1">0.24</td><td rowspan="1" colspan="1">10</td><td rowspan="1" colspan="1">TGGTGGGTAA</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1">8</td><td rowspan="1" colspan="1">0.3</td><td rowspan="1" colspan="1">0.95</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">8</td><td rowspan="1" colspan="1">AATAAACA</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1">4</td><td rowspan="1" colspan="1">8</td><td rowspan="1" colspan="1">0.37</td><td rowspan="1" colspan="1">0.79</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">6</td><td rowspan="1" colspan="1">CATACC</td><td rowspan="1" colspan="1">6</td><td rowspan="1" colspan="1">CACASA</td></tr><tr><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">8</td><td rowspan="1" colspan="1">0.86</td><td rowspan="1" colspan="1">0.94</td><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">1.09</td><td rowspan="1" colspan="1">0.83</td><td rowspan="1" colspan="1">8</td><td rowspan="1" colspan="1">0.48</td><td rowspan="1" colspan="1">0.81</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">8</td><td rowspan="1" colspan="1">ATGTGCTA</td><td rowspan="1" colspan="1">6</td><td rowspan="1" colspan="1">CGYGYG</td></tr><tr><td rowspan="1" colspan="1">6</td><td rowspan="1" colspan="1">8</td><td rowspan="1" colspan="1">2.86</td><td rowspan="1" colspan="1">0.94</td><td rowspan="1" colspan="1">6</td><td rowspan="1" colspan="1">0.73</td><td rowspan="1" colspan="1">0.95</td><td rowspan="1" colspan="1">18</td><td rowspan="1" colspan="1">0.57</td><td rowspan="1" colspan="1">0.89</td><td rowspan="1" colspan="1">8</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">7</td><td rowspan="1" colspan="1">CGCGCGC</td><td rowspan="1" colspan="1">6</td><td rowspan="1" colspan="1">GCGCGC</td></tr></tbody></table></table-wrap></p><p>The principal benefits of the NMF approach come from the focus on specific positioning of motifs relative to functional site. Nearly all pattern recognition tools focus on the identification of patterns that occur more frequently than expected according to a background model that is generated either from the input sequences themselves, or from a known background (typically putative promoter regions reflecting the bias of these studies towards transcription factor binding site identification). The test sequences used here were generated from a relatively AT-rich background. Motifs 3 and 4 (<xref ref-type="table" rid="T1">Table 1</xref>) do not differ significantly from this background. This is reflected in the poor rate at which these motifs were identified by the alternative tools tested here (<xref ref-type="table" rid="T3">Table 3</xref>). From these results, we conclude that, for the specific problem of identifying signals with positioning constraint, NMF outperforms alternative approaches.</p></sec></sec><sec id="SEC3.2"><title>3.2 Analysis of biologically interesting sequence sets</title><sec id="SEC3.2.1"><title>3.2.1 3&#x02032;-processing (cleavage and polyadenylation) sites</title><p>Thirty years of study have demonstrated that the sequences that control 3&#x02032;-processing in eukaryotic organisms show very distinct positioning about the 3&#x02032;-processing site. One recent study postulated up to 15 functional elements in the human 3&#x02032;-processing signal (Hu <italic>et al.</italic>, <xref ref-type="bibr" rid="B13">2005</xref>). Based on our analysis of mouse (<xref ref-type="fig" rid="F3">Fig. 3</xref>), and several other mammals (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn526/DC1">Supplementary Fig. 7</ext-link>), we find five or possibly six distinct elements based on positioning specificity. We observe clear evidence for two upstream elements: the UGUA-like element and the canonical AAUAAA-like hexamer, shown as mouse elements 2 and 3, respectively in <xref ref-type="fig" rid="F3">Figure 3</xref>. Downstream, we find three elements that can be described as UG-rich (element 5), U-rich (element 6) and G-rich (element 7). In addition, as with previous studies, we find some evidence for a putative upstream U-rich element, evidenced by elements 4 and 6. Elements 1 and 8 are representative of changes in the background composition in the transition from CDS to UTR to intergenic region.</p><p>Previous comparative studies of 3&#x02032;-processing sites have shown both common and distinct features (Lee <italic>et al.</italic>, <xref ref-type="bibr" rid="B18">2007</xref>; Salisbury <italic>et al.</italic>, <xref ref-type="bibr" rid="B28">2006</xref>) between organisms. We closely examined a number of organisms, and show the results for a phylogenetically broad sampling here (<xref ref-type="fig" rid="F3">Fig. 3</xref>), including mouse, fugu, mosquito and rice. (Analyses of several additional organisms are available in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn526/DC1">Supplementary Fig. 7</ext-link>). Somewhat strikingly, our inclusion of detailed analysis of positioning constraints reveals a conserved core pattern in essentially all higher eukaryotes, consisting of the upstream UGUA (Venkataraman <italic>et al.</italic>, <xref ref-type="bibr" rid="B34">2005</xref>), polyadenylation signal, with canonical consensus AAUAAA (Proudfoot and Brownlee, <xref ref-type="bibr" rid="B26">1976</xref>), and downstream U-rich elements (Gil and Proudfoot, <xref ref-type="bibr" rid="B10">1987</xref>). While it seems apparent that the balance in importance (and conservation) between these elements has varied, the basic pattern of these elements remains largely the same in both sequence content and positioning (<xref ref-type="fig" rid="F3">Fig. 3</xref>).</p><p>We can also use our analysis to highlight where the 3&#x02032;-processing control sequences diverge. As we previously reported (Salisbury <italic>et al.</italic>, <xref ref-type="bibr" rid="B28">2006</xref>), the downstream UG-rich element is specific to metazoans other than nematode. The organisms that have incorporated a UG-rich element also appear to have a corresponding shift in the positioning of the downstream U-rich element. The downstream G-rich element (mouse element 8 in <xref ref-type="fig" rid="F3">Fig. 3</xref>) appears to be specific to amniotes (Salisbury <italic>et al.</italic>, <xref ref-type="bibr" rid="B28">2006</xref>). Our analysis of invertebrate genomic sequences (mosquito, fruit fly and nematode) indicates the presence of an additional downstream A-rich element (<xref ref-type="fig" rid="F3">Fig. 3</xref>, mosquito element 7) with positioning similar to the mammalian G-rich sequences.</p><p>Finally, it is informative to contrast our results with the previous large-scale analysis of human 3&#x02032;-processing sites (Hu <italic>et al.</italic>, <xref ref-type="bibr" rid="B13">2005</xref>). As stated above, the authors of that study identified 15 distinct motifs determining 3&#x02032;-processing site placement, whereas we find five or six. The previous study used a less specific positioning classification than ours, initially identifying putative functional sequence words on the basis of their overrepresentation in one of four positioning regions, spanning positions &#x02212;100 to &#x02212;40, &#x02212;40 to 0, 0 to +40 and +40 to +100 relative to the 3&#x02032;-processing site. These words were then subsequently clustered on the basis of sequence similarity, and positional weight matrix representations were generated from the clusters. A number of their final elements, however, show similar positioning distributions, and sequence patterns that are arguably close enough to represent variants of a single, more general, pattern [e.g. Fig. 4 in Hu <italic>et al.</italic> (<xref ref-type="bibr" rid="B13">2005</xref>)]. In contrast, our approach first groups sequence words based on the similarity of positioning at a significantly finer resolution (typically windows of 3&#x02013;5 nt). In addition, we benefit from the &#x02018;fuzzy clustering&#x02019; nature of NMF, specifically in that each sequence word can contribute to the modeling of multiple elements in a weighted manner. Based on these differences, we believe that our analysis generates a more general, inclusive picture of the constraints of the elements of the 3&#x02032;-processing site control sequence. We nonetheless leave open the possibility that the subdivision of these elements, such as generated previously (Hu <italic>et al.</italic>, <xref ref-type="bibr" rid="B13">2005</xref>), may represent valid subclassifications of elements.</p></sec><sec id="SEC3.2.2"><title>3.2.2 Fruitfly transcription start sites</title><p>The elements that comprise the core promoter in the fruit fly (<italic>D.melanogaster</italic>) have been the subject of several recent studies (Gershenzon <italic>et al.</italic>, <xref ref-type="bibr" rid="B9">2006</xref>; Ohler <italic>et al.</italic>, <xref ref-type="bibr" rid="B22">2002</xref>). Many of the identified elements displayed positioning specificity, indicating an appropriate problem for NMF. We analyzed 2561 core promoter sequences (Gershenzon <italic>et al.</italic>, <xref ref-type="bibr" rid="B9">2006</xref>) extending from 250-nt upstream to 100-nt downstream of the transcription start site. Our analysis (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn526/DC1">Supplementary Fig. 8</ext-link>) identifies a number of patterns that are consistent with the previous studies, while also highlighting possible antagonistic relationships.</p></sec></sec></sec><sec sec-type="conclusions" id="SEC4"><title>4 CONCLUSIONS AND FUTURE DIRECTIONS</title><p>We have described here a novel approach to the characterization of putative regulatory motifs, using NMF to simultaneously determine both positioning and sequence content. In contrast with other dimension reduction algorithms, the NMF decomposition produces component matrices with direct intuitive interpretations, reflecting the positioning and sequence content of the resulting elements. We also demonstrated that variation of the RSS between the actual and reduced data provides a means of estimating the proper number of elements. Finally, in contrast with other pattern detection algorithms, our analysis is explicitly geared to the detection of motifs with constrained positioning, and consequently outperforms these algorithms for this specific problem.</p><p>The motifs generated by the NMF approach are well suited for inclusion in probabilistic predictive models, such as those for transcription start site, splice site, 3&#x02032;-processing site, or full gene prediction. To this end, we are working to cast the NMF output into a form that can directly be incorporated with the open-source Genie software (Kulp <italic>et al.</italic>, <xref ref-type="bibr" rid="B15">1997</xref>; Reese <italic>et al.</italic>, <xref ref-type="bibr" rid="B27">1997</xref>). We discuss a number of potential improvements to the NMF in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn526/DC1">Supplementary Materials</ext-link>.</p><p>The NMF approach provides a robust and novel approach to characterization of putative regulatory elements with positioning specificity. Given the importance of this additional constraint, our approach will provide benefits to analyses beyond the few examples presented here.</p></sec><sec><title>Funding</title><p>NSF 2010 Project (grant DBI-0331497); <grant-sponsor>NIH/NCRR INBRE</grant-sponsor><!-- oupReleaseDelayRemoved from OA Article (12|0) --> Maine (grant <grant-num>2 P20 RR16463</grant-num>); <grant-sponsor>NIH/NIGMS</grant-sponsor> (grant <grant-num>1R01GM072706</grant-num>).</p><p><italic>Conflict of Interest</italic>: none declared.</p></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material id="PMC_1" content-type="local-data"><caption><title>[Supplementary Data]</title></caption><media mimetype="text" mime-subtype="html" xlink:href="btn526_index.html"/><media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="btn526_1.pdf"/></supplementary-material></sec></body><back><ack><title>ACKNOWLEDGEMENTS</title><p>The authors thank Yong Woo, Gary Churchill, Elissa Chesler and members of the Graber Group for helpful comments and critiques. The authors thank Michael Brockman, Carol Bult, Hyuna Yang and Joel Richardson for critical review of the paper.</p></ack><ref-list><title>REFERENCES</title><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ao</surname><given-names>W</given-names></name><etal/></person-group><article-title>Environmentally induced foregut remodeling by pha-4/foxa and daf-12/nhr</article-title><source>Science</source><year>2004</year><volume>305</volume><fpage>1743</fpage><lpage>1746</lpage><pub-id pub-id-type="pmid">15375261</pub-id></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Brockman</surname><given-names>JM</given-names></name><etal/></person-group><article-title>Pacdb: polya cleavage site and 3&#x02032;-utr database</article-title><source>Bioinformatics</source><year>2005</year><volume>21</volume><fpage>3691</fpage><lpage>3693</lpage><pub-id pub-id-type="pmid">16030070</pub-id></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Brunet</surname><given-names>JP</given-names></name><etal/></person-group><article-title>Metagenes and molecular pattern discovery using matrix factorization</article-title><source>Proc. Natl Acad. Sci. USA</source><year>2004</year><volume>101</volume><fpage>4164</fpage><lpage>4169</lpage><pub-id pub-id-type="pmid">15016911</pub-id></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Carmona-Saez</surname><given-names>P</given-names></name><etal/></person-group><article-title>Biclustering of gene expression data by non-smooth non-negative matrix factorization</article-title><source>BMC Bioinformatics</source><year>2006</year><volume>7</volume><fpage>78</fpage><pub-id pub-id-type="pmid">16503973</pub-id></citation></ref><ref id="B5"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Crooks</surname><given-names>GE</given-names></name><etal/></person-group><article-title>Weblogo: a sequence logo generator</article-title><source>Genome Res.</source><year>2004</year><volume>14</volume><fpage>1188</fpage><lpage>1190</lpage><pub-id pub-id-type="pmid">15173120</pub-id></citation></ref><ref id="B6"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Fairbrother</surname><given-names>WG</given-names></name><etal/></person-group><article-title>Predictive identification of exonic splicing enhancers in human genes</article-title><source>Science</source><year>2002</year><volume>297</volume><fpage>1007</fpage><lpage>1013</lpage><pub-id pub-id-type="pmid">12114529</pub-id></citation></ref><ref id="B7"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Fairbrother</surname><given-names>WG</given-names></name><etal/></person-group><article-title>Rescue-ese identifies candidate exonic splicing enhancers in vertebrate exons</article-title><source>Nucleic Acids Res.</source><year>2004</year><volume>32</volume><fpage>W187</fpage><lpage>W190</lpage><pub-id pub-id-type="pmid">15215377</pub-id></citation></ref><ref id="B8"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Gelman</surname><given-names>A</given-names></name><etal/></person-group><source>Bayesian Data Analysis. Texts in Statistical Science.</source><year>1995</year><publisher-name>Chapman &#x00026; Hall/CRC</publisher-name></citation></ref><ref id="B9"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Gershenzon</surname><given-names>NI</given-names></name><etal/></person-group><article-title>The features of drosophila core promoters revealed by statistical analysis</article-title><source>BMC Genomics</source><year>2006</year><volume>7</volume><fpage>161</fpage><pub-id pub-id-type="pmid">16790048</pub-id></citation></ref><ref id="B10"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Gil</surname><given-names>A</given-names></name><name><surname>Proudfoot</surname><given-names>N</given-names></name></person-group><article-title>Position-dependent sequence elements downstream of aauaaa are required for efficient rabbit b-globin mnra 3 end formation</article-title><source>Cell</source><year>1987</year><volume>49</volume><fpage>399</fpage><lpage>406</lpage><pub-id pub-id-type="pmid">3568131</pub-id></citation></ref><ref id="B11"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Graber</surname><given-names>JH</given-names></name><etal/></person-group><article-title>C. elegans sequences that control trans-splicing and operon pre-mrna processing</article-title><source>Rna</source><year>2007</year><volume>13</volume><fpage>1409</fpage><lpage>1426</lpage><pub-id pub-id-type="pmid">17630324</pub-id></citation></ref><ref id="B12"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Gupta</surname><given-names>S</given-names></name><etal/></person-group><article-title>Quantifying similarity between motifs</article-title><source>Genome Biol.</source><year>2007</year><volume>8</volume><fpage>R24</fpage><pub-id pub-id-type="pmid">17324271</pub-id></citation></ref><ref id="B13"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hu</surname><given-names>J</given-names></name><etal/></person-group><article-title>Bioinformatic identification of candidate cis-regulatory elements involved in human mRNA polyadenylation</article-title><source>Rna</source><year>2005</year><volume>11</volume><fpage>1485</fpage><lpage>1493</lpage><pub-id pub-id-type="pmid">16131587</pub-id></citation></ref><ref id="B14"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>PM</given-names></name><name><surname>Tidor</surname><given-names>B</given-names></name></person-group><article-title>Subsystem identification through dimensionality reduction of large-scale gene expression data</article-title><source>Genome Res.</source><year>2003</year><volume>13</volume><fpage>1706</fpage><lpage>1718</lpage><pub-id pub-id-type="pmid">12840046</pub-id></citation></ref><ref id="B15"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kulp</surname><given-names>D</given-names></name><etal/></person-group><article-title>Integrating database homology in a probabilistic gene structure model</article-title><source>Pac. Symp. Biocomput.</source><year>1997</year><fpage>232</fpage><lpage>244</lpage><pub-id pub-id-type="pmid">9390295</pub-id></citation></ref><ref id="B16"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lawrence</surname><given-names>CE</given-names></name><etal/></person-group><article-title>Detecting subtle sequence signals: a gibbs sampling strategy for multiple alignment</article-title><source>Science</source><year>1993</year><volume>262</volume><fpage>208</fpage><lpage>214</lpage><pub-id pub-id-type="pmid">8211139</pub-id></citation></ref><ref id="B17"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>DD</given-names></name><name><surname>Seung</surname><given-names>HS</given-names></name></person-group><article-title>Learning the parts of objects by non-negative matrix factorization</article-title><source>Nature</source><year>1999</year><volume>401</volume><fpage>788</fpage><lpage>791</lpage><pub-id pub-id-type="pmid">10548103</pub-id></citation></ref><ref id="B18"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>JY</given-names></name><etal/></person-group><article-title>Polya db 2: mRNA polyadenylation sites in vertebrate genes</article-title><source>Nucleic Acids Res.</source><year>2007</year><volume>35</volume><fpage>D165</fpage><lpage>D168</lpage><pub-id pub-id-type="pmid">17202160</pub-id></citation></ref><ref id="B19"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>N</given-names></name><name><surname>Tompa</surname><given-names>M</given-names></name></person-group><article-title>Analysis of computational approaches for motif discovery</article-title><source>Algorithms Mol. Biol.</source><year>2006</year><volume>1</volume><fpage>8</fpage><pub-id pub-id-type="pmid">16722558</pub-id></citation></ref><ref id="B20"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Loke</surname><given-names>JC</given-names></name><etal/></person-group><article-title>Compilation of mRNA polyadenylation signals in Arabidopsis revealed a new signal element and potential secondary structures</article-title><source>Plant Physiol.</source><year>2005</year><volume>138</volume><fpage>1457</fpage><lpage>1468</lpage><pub-id pub-id-type="pmid">15965016</pub-id></citation></ref><ref id="B21"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Mejia-Roa</surname><given-names>E</given-names></name><etal/></person-group><article-title>Bionmf: a web-based tool for nonnegative matrix factorization in biology</article-title><source>Nucleic Acids Res.</source><year>2008</year><volume>36</volume><fpage>W523</fpage><lpage>W528</lpage><pub-id pub-id-type="pmid">18515346</pub-id></citation></ref><ref id="B22"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ohler</surname><given-names>U</given-names></name><etal/></person-group><article-title>Computational analysis of core promoters in the Drosophila genome</article-title><source>Genome Biol.</source><year>2002</year><volume>3</volume><comment>RESEARCH0087</comment></citation></ref><ref id="B23"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Pascual-Montano</surname><given-names>A</given-names></name><etal/></person-group><article-title>Bionmf: a versatile tool for non-negative matrix factorization in biology</article-title><source>BMC Bioinformatics</source><year>2006a</year><volume>7</volume><fpage>366</fpage><pub-id pub-id-type="pmid">16875499</pub-id></citation></ref><ref id="B24"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Pascual-Montano</surname><given-names>A</given-names></name><etal/></person-group><article-title>Nonsmooth nonnegative matrix factorization (nsnmf)</article-title><source>IEEE Trans. Pattern Anal. Mach. Intell.</source><year>2006b</year><volume>28</volume><fpage>403</fpage><lpage>415</lpage><pub-id pub-id-type="pmid">16526426</pub-id></citation></ref><ref id="B25"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Pavesi</surname><given-names>G</given-names></name><etal/></person-group><article-title>Weeder web: discovery of transcription factor binding sites in a set of sequences from co-regulated genes</article-title><source>Nucleic Acids Res.</source><year>2004</year><volume>32</volume><fpage>W199</fpage><lpage>W203</lpage><pub-id pub-id-type="pmid">15215380</pub-id></citation></ref><ref id="B26"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Proudfoot</surname><given-names>N</given-names></name><name><surname>Brownlee</surname><given-names>G</given-names></name></person-group><article-title>3&#x02032; non-coding region sequences in eukaryotic messenger RNA</article-title><source>Nature</source><year>1976</year><volume>263</volume><fpage>211</fpage><lpage>314</lpage><pub-id pub-id-type="pmid">822353</pub-id></citation></ref><ref id="B27"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Reese</surname><given-names>MG</given-names></name><etal/></person-group><article-title>Improved splice site detection in genie</article-title><source>J. Comput. Biol.</source><year>1997</year><volume>4</volume><fpage>311</fpage><lpage>323</lpage><pub-id pub-id-type="pmid">9278062</pub-id></citation></ref><ref id="B28"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Salisbury</surname><given-names>J</given-names></name><etal/></person-group><article-title>A multispecies comparison of the metazoan 3&#x02032;-processing downstream elements and the cstf-64 RNA recognition motif</article-title><source>BMC Genomics</source><year>2006</year><volume>7</volume><fpage>55</fpage><pub-id pub-id-type="pmid">16542450</pub-id></citation></ref><ref id="B29"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Schneider</surname><given-names>TD</given-names></name><name><surname>Stephens</surname><given-names>RM</given-names></name></person-group><article-title>Sequence logos: a new way to display consensus sequences</article-title><source>Nucleic Acids Res.</source><year>1990</year><volume>18</volume><fpage>6097</fpage><lpage>6100</lpage><pub-id pub-id-type="pmid">2172928</pub-id></citation></ref><ref id="B30"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Sinha</surname><given-names>S</given-names></name><name><surname>Tompa</surname><given-names>M</given-names></name></person-group><article-title>Ymf: a program for discovery of novel transcription factor binding sites by statistical overrepresentation</article-title><source>Nucleic Acids Res.</source><year>2003</year><volume>31</volume><fpage>3586</fpage><lpage>3588</lpage><pub-id pub-id-type="pmid">12824371</pub-id></citation></ref><ref id="B31"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Tompa</surname><given-names>M</given-names></name><etal/></person-group><article-title>Assessing computational tools for the discovery of transcription factor binding sites</article-title><source>Nat. Biotechnol.</source><year>2005</year><volume>23</volume><fpage>137</fpage><lpage>144</lpage><pub-id pub-id-type="pmid">15637633</pub-id></citation></ref><ref id="B32"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>van Helden</surname><given-names>J</given-names></name></person-group><article-title>Regulatory sequence analysis tools</article-title><source>Nucleic Acids Res.</source><year>2003</year><volume>31</volume><fpage>3593</fpage><lpage>3596</lpage><pub-id pub-id-type="pmid">12824373</pub-id></citation></ref><ref id="B33"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Vardhanabhuti</surname><given-names>S</given-names></name><etal/></person-group><article-title>Position and distance specificity are important determinants of cis-regulatory motifs in addition to evolutionary conservation</article-title><source>Nucleic Acids Res.</source><year>2007</year><volume>35</volume><fpage>3203</fpage><lpage>3213</lpage><pub-id pub-id-type="pmid">17452354</pub-id></citation></ref><ref id="B34"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Venkataraman</surname><given-names>K</given-names></name><etal/></person-group><article-title>Analysis of a noncanonical poly(a) site reveals a tripartite mechanism for vertebrate poly(a) site recognition</article-title><source>Genes Dev.</source><year>2005</year><volume>19</volume><fpage>1315</fpage><lpage>1327</lpage><pub-id pub-id-type="pmid">15937220</pub-id></citation></ref><ref id="B35"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>J</given-names></name><etal/></person-group><article-title>Formation of mRNA 3&#x02032; ends in eukaryotes: mechanism, regulation, and interrelationships with other steps in mrna synthesis</article-title><source>Microbiol. Mol. Biol. Rev.</source><year>1999</year><volume>63</volume><fpage>405</fpage><lpage>445</lpage><pub-id pub-id-type="pmid">10357856</pub-id></citation></ref></ref-list></back></article>