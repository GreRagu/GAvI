<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd"><article xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id><journal-title>BMC Bioinformatics</journal-title><issn pub-type="epub">1471-2105</issn><publisher><publisher-name>BioMed Central</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">19134174</article-id><article-id pub-id-type="pmc">2640360</article-id><article-id pub-id-type="publisher-id">1471-2105-10-12</article-id><article-id pub-id-type="doi">10.1186/1471-2105-10-12</article-id><article-categories><subj-group subj-group-type="heading"><subject>Methodology Article</subject></subj-group></article-categories><title-group><article-title>Estimation of tumor heterogeneity using CGH array data</article-title></title-group><contrib-group><contrib id="A1" contrib-type="author"><name><surname>Wang</surname><given-names>Kai</given-names></name><xref ref-type="aff" rid="I1">1</xref><xref ref-type="aff" rid="I2">2</xref><email>wangk@humgen.au.dk</email></contrib><contrib id="A2" contrib-type="author"><name><surname>Li</surname><given-names>Jian</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>jianlij@gmail.com</email></contrib><contrib id="A3" contrib-type="author"><name><surname>Li</surname><given-names>Shengting</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>lishengting@gmail.com</email></contrib><contrib id="A4" contrib-type="author"><name><surname>Bolund</surname><given-names>Lars</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>lars@humgen.au.dk</email></contrib><contrib id="A5" corresp="yes" contrib-type="author"><name><surname>Wiuf</surname><given-names>Carsten</given-names></name><xref ref-type="aff" rid="I2">2</xref><email>wiuf@birc.au.dk</email></contrib></contrib-group><aff id="I1"><label>1</label>Institute of Human Genetics, University of Aarhus, Aarhus, Denmark</aff><aff id="I2"><label>2</label>BiRC &#x02013; Bioinformatics Research Center, University of Aarhus, Aarhus, Denmark</aff><pub-date pub-type="collection"><year>2009</year></pub-date><pub-date pub-type="epub"><day>9</day><month>1</month><year>2009</year></pub-date><volume>10</volume><fpage>12</fpage><lpage>12</lpage><ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/10/12"/><history><date date-type="received"><day>30</day><month>7</month><year>2008</year></date><date date-type="accepted"><day>9</day><month>1</month><year>2009</year></date></history><permissions><copyright-statement>Copyright &#x000a9; 2009 Wang et al; licensee BioMed Central Ltd.</copyright-statement><copyright-year>2009</copyright-year><copyright-holder>Wang et al; licensee BioMed Central Ltd.</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0"><p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p><!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>               Wang               Kai                                             wangk@humgen.au.dk            </dc:author><dc:title>            Estimation of tumor heterogeneity using CGH array data         </dc:title><dc:date>2009</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 10(1): 12-. (2009)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2009)10:1&#x0003c;12&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>--></license></permissions><abstract><sec><title>Background</title><p>Array-based comparative genomic hybridization (CGH) is a commonly-used approach to detect DNA copy number variation in whole genome-wide screens. Several statistical methods have been proposed to define genomic segments with different copy numbers in cancer tumors. However, most tumors are heterogeneous and show variation in DNA copy numbers across tumor cells. The challenge is to reveal the copy number profiles of the subpopulations in a tumor and to estimate the percentage of each subpopulation.</p></sec><sec><title>Results</title><p>We describe a relation between experimental data and exact DNA copy number and develop a statistical method to reveal the heterogeneity of tumors containing a mixture of different-stage cells. Furthermore, we validate the method on simulated data and apply the method to 29 pairs of breast primary tumors and their matched lymph node metastases.</p></sec><sec><title>Conclusion</title><p>We demonstrate a new method for CGH array analysis that allows a tumor sample to be classified according to its heterogeneity. The method gives an interpretable series of copy number profiles, one for each major subpopulation in a tumor. The profiles facilitate identification of copy number alterations in cancer development.</p></sec></abstract></article-meta></front><body><sec><title>Background</title><p>Heterogeneity is an important characteristic of most cancers. It manifests itself in various different ways, for example as heterogeneity in gene expression, protein abundance and/or genomic DNA copy number [<xref ref-type="bibr" rid="B1">1</xref>-<xref ref-type="bibr" rid="B3">3</xref>]. In this paper we focus exclusively on heterogeneity in genomic DNA copy number. Genomic DNA copy number variation in a tumor reflects concomitant or successive development of various foci and indicates that malignant transformation of cells is a dynamic evolutionary process. Numerous studies have demonstrated that the development of tumors involves accumulation of various genetic alterations [<xref ref-type="bibr" rid="B4">4</xref>-<xref ref-type="bibr" rid="B8">8</xref>]. Comparative genomic hybridization (CGH), matrix-based BAC/oligo array CGH, or oligonucleotide-based arrays are techniques that frequently are applied to elucidate <italic>intertumor </italic>heterogeneity across cancers, patients or stages; the genomic profile of a tumor is presented at a fixed time point and averaged across different cells in the tumor.</p><p>In contrast, <italic>intratumor </italic>heterogeneity is rarely reported [<xref ref-type="bibr" rid="B9">9</xref>]. Laser-capture micro-dissection is a powerful tool to select few phenotypically homogeneous tumor cells, and thus a way circumvent the problem of averaging across many potentially inhomogeneous tumor cells. Methods for whole genome amplification enable researchers to obtain sufficient DNA for CGH analysis even from few cells [<xref ref-type="bibr" rid="B10">10</xref>]. In this way the genomic profile of a small (homogeneous) region in the tumor can be studied, whereas the heterogeneity of the tumor might be elucidated by investigating several different regions across the tumor. Naturally, the latter is time-consuming and labor intensive, and to our knowledge, has not been reported.</p><p>With the above in mind, we have developed a statistical method to study tumor heterogeneity. It takes CGH array data from individual tumors as input; one tumor sample is represented by one array and contains DNA from a potentially heterogeneous cell population. Our method estimates the number of dominant tumor subpopulations, the percentages of the subpopulations in the sample, and the copy number profiles of the dominant subpopulations. Also, the method estimates the percentage of normal cells. Normal cells are diploid (two copies of all genomic DNA) and typically consist of nonmalignant epithelium, fibroblast and/or penetrated lymphocytes. To validate the method we have simulated data according to a model derived from real CGH data. Additionally, we have mixed some real tumor samples to obtain samples with partially known profiles. Subsequently, we applied our method to 29 paired primary and lymph node metastasis breast cancer samples.</p><p>Our method can be considered a classifier in the sense that it assigns a number of subpopulations to a given tumor sample. Alternatively the method might be considered as a model selection procedure over an extensive number of models: We seek the model that explains the data best, optimizing over the number of subpopulations and the copy number profile for each subpopulation.</p></sec><sec><title>Results and discussion</title><sec><title>Calibration experiment</title><p>A series of calibration experiments were conducted to test the array CGH platform in our laboratory. The majority of samples were from normal males and females (diploid samples), but some samples were from patients with genomic abnormalities, e.g. trisomies and monosomies. Importantly, all these samples are assumed to be homogeneous, i.e. all cells in a sample have the same copy number alteration(s). We fit a linear model to describe the relationship between log-copy number and log-intensity; as described in <bold>Methods (The copy number model)</bold>. The parameters of the linear model, <italic>y </italic>= <italic>&#x003b1;x </italic>+ <italic>&#x003b2;</italic>, are estimated to <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" name="1471-2105-10-12-i1" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>&#x003b1;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula> = 0.6049, 95% CI: (0.5542,0.6556), and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2" name="1471-2105-10-12-i2" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>&#x003b2;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula> = -0.039, 95% CI (-0.085,0.0067), respectively. The observed and fitted values show high correlation; Pearson's regression coefficient <italic>R</italic><sup>2 </sup>is greater than 0.98. The observed values and the regression line are shown [see Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>].</p></sec><sec><title>Heterogeneity in real tumors</title><p>We applied the procedure described in <bold>Methods (Classification of samples) </bold>to estimate the level of genomic heterogeneity in 29 pairs of primary tumor and lymph node metastasis.</p><p>The method allows us to estimate the number of dominant subpopulations, the copy number profile and the percentage of cells in each subpopulation. Our method assumes a model of sequential tumor evolution where each subpopulation is evolved from the previous population by introducing new aberrations, or by making aberrations in the previous population more extreme, i.e. by increasing copy numbers or decreasing copy numbers, see <bold>Methods (Mixture modeling of tumor samples) </bold>for details.</p><p>The results from the analysis of the primary tumor and lymph node metastasis are shown in details [see Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>] and summarized in Table <xref ref-type="table" rid="T1">1</xref>. To estimate the complexity of a tumor, we introduce the following measure called the Aberration Index (AI),</p><table-wrap position="float" id="T1"><label>Table 1</label><caption><p>Subpopulation summary of the 29 pairs of primary and metastasis samples</p></caption><table frame="hsides" rules="groups"><thead><tr><td></td><td align="center">#</td><td align="center"><italic>P</italic><sub>1</sub></td><td align="center"><italic>P</italic><sub>2</sub></td><td align="center"><italic>P</italic><sub>3</sub></td><td align="center"><italic>AI</italic><sub>1</sub></td><td align="center"><italic>AI</italic><sub>2</sub></td><td align="center"><italic>AI</italic><sub>3</sub></td><td align="center">Total</td><td align="center">Pure</td></tr></thead><tbody><tr><td align="center">T-2</td><td align="center">15</td><td align="center">25.3 (8.8)</td><td align="center">-</td><td align="center">-</td><td align="center">1.13 (0.76)</td><td align="center">-</td><td align="center">-</td><td align="center">0.25 (0.13)</td><td align="center">1.13 (0.76)</td></tr><tr><td align="center">T-3</td><td align="center">13</td><td align="center">33.4 (9.4)</td><td align="center">14.2 (5.1)</td><td align="center">-</td><td align="center">0.34 (0.13)</td><td align="center">1.18 (0.26)</td><td align="center">-</td><td align="center">0.28 (0.10)</td><td align="center">0.59 (0.20)</td></tr><tr><td align="center">T-4</td><td align="center">1</td><td align="center">23 (-)</td><td align="center">34 (-)</td><td align="center">8 (-)</td><td align="center">0.25 (-)</td><td align="center">0.53 (-)</td><td align="center">1.40 (-)</td><td align="center">0.35 (-)</td><td align="center">0.54 (-)</td></tr><tr><td align="center">M-2</td><td align="center">16</td><td align="center">24.8 (8.3)</td><td align="center">-</td><td align="center">-</td><td align="center">1.07 (1.00)</td><td align="center">-</td><td align="center">-</td><td align="center">0.21 (0.11)</td><td align="center">1.07 (1.00)</td></tr><tr><td align="center">M-3</td><td align="center">10</td><td align="center">32.5 (8.7)</td><td align="center">15.1 (6.1)</td><td align="center">-</td><td align="center">0.45 (0.23)</td><td align="center">1.33 (0.41)</td><td align="center">-</td><td align="center">0.33 (0.12)</td><td align="center">0.71 (0.30)</td></tr><tr><td align="center">M-4</td><td align="center">3</td><td align="center">16.7 (3.1)</td><td align="center">31 (6)</td><td align="center">8.7 (2.1)</td><td align="center">0.18 (0.04)</td><td align="center">0.48 (0.11)</td><td align="center">1.33 (0.17)</td><td align="center">0.29 (0.05)</td><td align="center">0.52 (0.09)</td></tr></tbody></table><table-wrap-foot><p>The table summarizes the analysis done on the 29 pairs of samples [see Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>]. Shown are mean values with standard deviation in parenthesis. T-<italic>i</italic>: Primary tumor with <italic>i </italic>subpopulations, M-<italic>i</italic>: Metastasis with <italic>i </italic>subpopulations, #: Number of samples, <italic>p</italic><sub><italic>k</italic></sub>: Percentage of (abnormal) subpopulation <italic>k </italic>&#x02265; 1, <italic>AI</italic><sub><italic>k</italic></sub>: Aberration Index for subpopulation <italic>k</italic>, Total: Weighted sum of <italic>AI</italic><sub><italic>k</italic></sub>, &#x003a3;<sub><italic>k</italic></sub><italic>p</italic><sub><italic>k</italic></sub><italic>AI</italic><sub><italic>k</italic></sub>, Pure: <italic>AI</italic><sub>&#x02022;</sub>, normalized weighted sum of <italic>AI</italic><sub><italic>k</italic></sub>, <italic>cf</italic>. equation (2).</p></table-wrap-foot></table-wrap><p><disp-formula id="bmcM1"><label>(1)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M3" name="1471-2105-10-12-i3" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:mi>A</mml:mi>                           <mml:msub>                              <mml:mi>I</mml:mi>                              <mml:mi>k</mml:mi>                           </mml:msub>                           <mml:mo>=</mml:mo>                           <mml:mfrac>                              <mml:mrow>                                 <mml:mstyle displaystyle="true">                                    <mml:msub>                                       <mml:mo>&#x02211;</mml:mo>                                       <mml:mi>i</mml:mi>                                    </mml:msub>                                    <mml:mrow>                                       <mml:msub>                                          <mml:mi>m</mml:mi>                                          <mml:mi>i</mml:mi>                                       </mml:msub>                                       <mml:mo>|</mml:mo>                                       <mml:msub>                                          <mml:mi>C</mml:mi>                                          <mml:mrow>                                             <mml:mi>i</mml:mi>                                             <mml:mi>k</mml:mi>                                          </mml:mrow>                                       </mml:msub>                                       <mml:mo>&#x02212;</mml:mo>                                       <mml:mn>2</mml:mn>                                       <mml:mo>|</mml:mo>                                    </mml:mrow>                                 </mml:mstyle>                              </mml:mrow>                              <mml:mrow>                                 <mml:mstyle displaystyle="true">                                    <mml:msub>                                       <mml:mo>&#x02211;</mml:mo>                                       <mml:mi>i</mml:mi>                                    </mml:msub>                                    <mml:mrow>                                       <mml:msub>                                          <mml:mi>m</mml:mi>                                          <mml:mi>i</mml:mi>                                       </mml:msub>                                    </mml:mrow>                                 </mml:mstyle>                              </mml:mrow>                           </mml:mfrac>                           <mml:mo>,</mml:mo>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>where <italic>m</italic><sub><italic>i </italic></sub>is the number of clones in segment <italic>i</italic>, <italic>C</italic><sub><italic>ik </italic></sub>the copy number of segment <italic>i </italic>in subpopulation <italic>k</italic>, and |<italic>x</italic>| denotes the absolute value of <italic>x</italic>. Here we assume clones are uniformly spaced across the genome; if this is not the case the contribution from each clone can be weighted by its distance to neighbor clones. The estimated subpopulations are named P0, P1, P2, ..., and ordered according to increasing AI. P0 consists of normal cells only and has <italic>AI</italic><sub>0 </sub>= 0.</p><p>Tumors with only one abnormal subpopulation have higher average AI than tumors with many abnormal subpopulations; see Table <xref ref-type="table" rid="T1">1</xref>. Also, the average complexity of all abnormal subpopulations in a tumor,</p><p><disp-formula id="bmcM2"><label>(2)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M4" name="1471-2105-10-12-i4" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:mi>A</mml:mi>                           <mml:msub>                              <mml:mi>I</mml:mi>                              <mml:mo>&#x02022;</mml:mo>                           </mml:msub>                           <mml:mo>=</mml:mo>                           <mml:mstyle displaystyle="true">                              <mml:munder>                                 <mml:mo>&#x02211;</mml:mo>                                 <mml:mrow>                                    <mml:mi>k</mml:mi>                                    <mml:mo>&#x0003e;</mml:mo>                                    <mml:mn>0</mml:mn>                                 </mml:mrow>                              </mml:munder>                              <mml:mrow>                                 <mml:mfrac>                                    <mml:mrow>                                       <mml:msub>                                          <mml:mi>p</mml:mi>                                          <mml:mi>k</mml:mi>                                       </mml:msub>                                       <mml:mi>A</mml:mi>                                       <mml:msub>                                          <mml:mi>I</mml:mi>                                          <mml:mi>k</mml:mi>                                       </mml:msub>                                    </mml:mrow>                                    <mml:mrow>                                       <mml:mn>1</mml:mn>                                       <mml:mo>&#x02212;</mml:mo>                                       <mml:msub>                                          <mml:mi>p</mml:mi>                                          <mml:mn>0</mml:mn>                                       </mml:msub>                                    </mml:mrow>                                 </mml:mfrac>                              </mml:mrow>                           </mml:mstyle>                           <mml:mo>,</mml:mo>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>("Pure" in Table <xref ref-type="table" rid="T1">1</xref>) where <italic>p</italic><sub><italic>k </italic></sub>denotes the percentage of subpopulation <italic>k</italic>, is decreasing with the number of subpopulations. This is re ecting that the percentage of the most complex subpopulation is generally not very high, whereas the percentage of the least complex is relatively much higher.</p><p>We clustered all subpopulation profiles, rather than just the overall profiles of the samples. The result, shown in Figure <xref ref-type="fig" rid="F1">1</xref>, presents the similarity among all subpopulations across the 29 tumor pairs. In 16 cases (out of 29) all primary and metastasis subpopulations cluster together (shown in blue in the figure), i.e. the subpopulations of the metastasis are more similar to the subpopulations of the primary tumor than to subpopulations of other samples. The high similarity between the primary tumor and the lymph node metastasis from the same patient indicates that biological characteristics of the primary tumor are maintained in the lymph node metastasis. In other samples the primary tumor and the metastasis show much less similarity, and even within a sample, the subpopulations can be very dissimilar. The yellow cluster in Figure <xref ref-type="fig" rid="F1">1</xref> consists mainly of subpopulations with low AI, i.e. few genomic aberrations.</p><fig position="float" id="F1"><label>Figure 1</label><caption><p><bold>Cluster diagram of the 29 pairs of tumors</bold>. The 29 pairs of primary and metastasis samples were divided into 89 subpopulations using the method described in the paper. For two leaves with the same ID (e.g. T53), P1 refers to the abnormal subpopulation with the least aberration, P2 (if it exists) refers to the subpopulation with more aberrations than P1, and P3 (if it exists) the one with most aberrations. The percentage of each subpopulation is also included. The cluster diagram was generated using average linkage clustering based on the estimated copy numbers for all 3340 clones. Reducing the number of clones produces very similar results.</p></caption><graphic xlink:href="1471-2105-10-12-1"/></fig><p>Table <xref ref-type="table" rid="T2">2</xref> shows the relationship between the estimated number of subpopulations in the primary tumor and in the corresponding metastasis. There is not a clear relationship between the two numbers with only 14 pairs out of 29 showing the same subpopulation number. Of the 16 tumor pairs that clustered together in Figure <xref ref-type="fig" rid="F1">1</xref> (see above paragraph), 10 pairs have the same subpopulation number while in 4 cases the metastasis shows a lower number than the primary tumor.</p><table-wrap position="float" id="T2"><label>Table 2</label><caption><p>Primary tumor <italic>vs. metastasis</italic></p></caption><table frame="hsides" rules="groups"><thead><tr><td></td><td align="center" colspan="3">Metastasis</td></tr><tr><td align="center">Primary</td><td align="center">2</td><td align="center">3</td><td align="center">4</td></tr></thead><tbody><tr><td align="center">2</td><td align="center">9</td><td align="center">4</td><td align="center">2</td></tr><tr><td align="center">3</td><td align="center">7</td><td align="center">5</td><td align="center">1</td></tr><tr><td align="center">4</td><td align="center">0</td><td align="center">1</td><td align="center">0</td></tr></tbody></table><table-wrap-foot><p>Shown is the estimated number of subpopulations in the primary tumor and the corresponding lymph node metastasis.</p></table-wrap-foot></table-wrap><p>The average percentage of the normal cell subpopulation in a tumor is around 60%, which is higher than we expected. According to the pathologists involved in removing the tumors by surgery, the samples contain at least 70% malignant cells. However, this percentage is judged by eye and represents how big a fraction of the tumor that appears to consist of normal cells. This is likely to be an overestimate because malignant cells generally are bigger than normal cells [<xref ref-type="bibr" rid="B11">11</xref>]. Also, some normal cells are typically removed before the samples are subjected to array analysis.</p><p>Finally, based on our results, we can make some predictions about possible subpopulation developments in paired tumor samples (Figure <xref ref-type="fig" rid="F2">2</xref>). For example, the P1 (P2) subpopulations from the samples T51 and M51 cluster together and they are likely immigrated from the primary tumor to the lymph node as a whole. Whereas, for example the subpopulations of M84 do not cluster together with T84-P1, which might indicate that the metastasis has arisen from the T84-P2 in the primary tumor.</p><fig position="float" id="F2"><label>Figure 2</label><caption><p><bold>Subpopulation development</bold>. Here we show possible subpopulation development in two paired tumor samples. The dashed lines connect the subpopulations from same sample. The solid and dashed lines represent the most likely and the least likely development path, respectively. From the top-down, the subpopulation contains more and more genomic aberrations.</p></caption><graphic xlink:href="1471-2105-10-12-2"/></fig></sec><sec><title>Simulation results</title><p>We simulated samples based on the 29 pairs of real samples (in total 58 samples), as described in the <bold>Methods (Simulation)</bold>. For each real sample we fit copy number profiles assuming 2, 3 or 4 subpopulations and use these profiles as templates for simulation of artificial log-intensities. For example, for a real sample with an estimated 2 subpopulations, we fit 2, 3 and 4 subpopulations and simulate log-intensities based on these profiles. In this case, the profiles of the four subpopulations are very similar because the real sample is best explained by two subpopulations. Subsequently, we applied our method to the simulated samples; the results are summarized in Tables <xref ref-type="table" rid="T2">2</xref> and <xref ref-type="table" rid="T3">3</xref>.</p><table-wrap position="float" id="T3"><label>Table 3</label><caption><p>Prediction accuracy for simulated samples</p></caption><table frame="hsides" rules="groups"><thead><tr><td></td><td align="center">Simulated</td><td align="center" colspan="3">Predicted as</td><td align="center">Correct</td></tr><tr><td align="center">Real</td><td></td><td align="center">2</td><td align="center">3</td><td align="center">4</td><td align="center">(in %)</td></tr></thead><tbody><tr><td align="center">2</td><td align="center">2</td><td align="center">115</td><td align="center">9</td><td align="center">0</td><td align="center">0.93</td></tr><tr><td></td><td align="center">3</td><td align="center">61</td><td align="center">59</td><td align="center">4</td><td align="center">0.48</td></tr><tr><td></td><td align="center">4</td><td align="center">57</td><td align="center">48</td><td align="center">19</td><td align="center">0.15</td></tr><tr><td colspan="6"><hr></hr></td></tr><tr><td align="center">3</td><td align="center">2</td><td align="center">80</td><td align="center">11</td><td align="center">1</td><td align="center">0.87</td></tr><tr><td></td><td align="center">3</td><td align="center">8</td><td align="center">78</td><td align="center">6</td><td align="center">0.85</td></tr><tr><td></td><td align="center">4</td><td align="center">6</td><td align="center">60</td><td align="center">26</td><td align="center">0.28</td></tr><tr><td colspan="6"><hr></hr></td></tr><tr><td align="center">4</td><td align="center">2</td><td align="center">15</td><td align="center">1</td><td align="center">0</td><td align="center">0.94</td></tr><tr><td></td><td align="center">3</td><td align="center">0</td><td align="center">13</td><td align="center">3</td><td align="center">0.81</td></tr><tr><td></td><td align="center">4</td><td align="center">0</td><td align="center">1</td><td align="center">15</td><td align="center">0.94</td></tr></tbody></table><table-wrap-foot><p>For each real sample four simulated samples were created; in total 174 samples. The real sample was used as template for the simulated samples. In the table, the simulation results are shown according to the estimated number of subpopulations in the real samples. Real: Estimated number of subpopulations in the real sample, Simulated: The number of subpopulations in the simulated sample, Predicted: The predicted number of subpopulations in the simulated sample.</p></table-wrap-foot></table-wrap><p>We learn several things from the simulations (Table <xref ref-type="table" rid="T3">3</xref>). Generally, it is possible to predict the number of subpopulations under the chosen simulation model. However, samples with 3 or 4 similar subpopulations (Table <xref ref-type="table" rid="T3">3</xref>: Real = 2, Simulated = 3 or 4) are difficult to predict correctly (48% and 15%, respectively), whereas samples with few less similar subpopulations are much easier to predict; in Table <xref ref-type="table" rid="T3">3</xref> simulated samples with 2 subpopulations achieve a prediction accuracy above 87%.</p><p>Next, we estimated the accuracy of the predicted subpopulation percentages and the corresponding profiles (Table <xref ref-type="table" rid="T4">4</xref>). When the subpopulation number was predicted correctly, the estimated subpopulation percentages and copy number profiles were compared to the values used in the simulation. Table <xref ref-type="table" rid="T4">4</xref> shows that the copy numbers of the abnormal subpopulations are predicted correctly for more than 80% of the clones, with higher accuracy obtained when there are few subpopulations than many.</p><table-wrap position="float" id="T4"><label>Table 4</label><caption><p>Accuracy of copy numbers and percentages</p></caption><table frame="hsides" rules="groups"><thead><tr><td></td><td align="center" colspan="3">#Subpopulations</td></tr><tr><td></td><td align="center">2</td><td align="center">3</td><td align="center">4</td></tr></thead><tbody><tr><td align="center">A (in %)</td><td align="center">2.05 (2.26)</td><td align="center">2.76 (2.50)</td><td align="center">4.78 (4.01)</td></tr><tr><td align="center">B (in %)</td><td align="center">89.5 (13.6)</td><td align="center">82.8 (10.0)</td><td align="center">80.5 (9.0)</td></tr></tbody></table><table-wrap-foot><p>The table shows accuracy of the estimated copy numbers and subpopulation percentages when the number of subpopulations is correctly predicted. A) The average absolute difference between the estimated and true percentages in the simulated samples, B) The average number of times the copy number was predicted correctly, excluding the normal subpopulation. Standard deviations in parenthesis.</p></table-wrap-foot></table-wrap><p>Our method of estimation assumes a model of sequential tumor evolution. To test the method's robustness to violations of the model we did the following; see <bold>Methods (Simulation) </bold>for details. First we simulated a sample according to the model. Then, for each segment we modified the copy numbers by adding/subtracting a Poisson number of copies. The results are shown in Table <xref ref-type="table" rid="T5">5</xref>. Even when the percentage of segments violating the model is high, we predict the correct subpopulation number in the majority of the cases.</p><table-wrap position="float" id="T5"><label>Table 5</label><caption><p>Robustness of the method</p></caption><table frame="hsides" rules="groups"><thead><tr><td></td><td align="center" colspan="3">3 subpopulations</td><td align="center" colspan="3">4 subpopulations</td></tr><tr><td align="left"><italic>&#x003bb;</italic></td><td align="center">1</td><td align="center">0.5</td><td align="center">0.25</td><td align="center">1</td><td align="center">0.5</td><td align="center">0.25</td></tr></thead><tbody><tr><td align="left">Correct</td><td align="center">27</td><td align="center">27</td><td align="center">33</td><td align="center">27</td><td align="center">21</td><td align="center">28</td></tr><tr><td align="left">Incorrect</td><td align="center">19</td><td align="center">19</td><td align="center">13</td><td align="center">13</td><td align="center">19</td><td align="center">12</td></tr><tr><td align="left">A (in %)</td><td align="center">4.74 (4.68)</td><td align="center">4.15 (3.62)</td><td align="center">3.52 (3.70)</td><td align="center">7.70 (7.95)</td><td align="center">5.43 (4.23)</td><td align="center">5.59 (5.03)</td></tr><tr><td align="left">B (in %)</td><td align="center">5.37 (6.89)</td><td align="center">5.59 (6.19)</td><td align="center">5.43 (7.13)</td><td align="center">7.43 (9.64)</td><td align="center">5.65 (5.35)</td><td align="center">6.93 (6.98)</td></tr><tr><td align="left">Segments (in %)</td><td align="center">37.0</td><td align="center">24.4</td><td align="center">11.5</td><td align="center">65.1</td><td align="center">45.1</td><td align="center">25.6</td></tr></tbody></table><table-wrap-foot><p>The table shows results for simulated data not fulfilling the assumption of sequential tumor evolution. With increasing &#x003bb;, an increasing number of samples are incorrectly classified. A) The average absolute difference between the estimated and true percentages in the simulated samples when the number of subpopulations are predicted correctly, B) The average absolute difference between the estimated and true percentages of the normal subpopulation. Standard deviations in parenthesis. 'Segments' is the number of segments violating the model of sequential tumor evolution.</p></table-wrap-foot></table-wrap></sec><sec><title>Validation experiment</title><p>The method was also validated using experimental data. We performed a series of hybridization experiments with different combinations of malignant and normal DNA as follows: 1) The tumor DNA is hybridized with normal DNA (pooled female healthy population). 2) A combination of 85% tumor DNA and 15% normal DNA is hybridized with normal DNA (pooled female healthy population). 3) A combination of 70% tumor DNA and 30% normal DNA is hybridized with normal DNA (pooled female healthy population). The hybridizations were performed using two different tumor DNA samples. For each of the hybridizations we estimated the number of subpopulations and percentages (Table <xref ref-type="table" rid="T6">6</xref>). Since we do not know the composition of the tumor DNA, we do not know the true number of subpopulations and percentages, but based on our estimates we can predict what the estimated number of subpopulations and percentages should be in the mixed samples.</p><table-wrap position="float" id="T6"><label>Table 6</label><caption><p>Validation experiment</p></caption><table frame="hsides" rules="groups"><thead><tr><td></td><td></td><td align="center" colspan="3">Estimated based on (X = S1, S2)</td></tr><tr><td></td><td align="center">Experiment</td><td align="center">X</td><td align="center">X with 15%</td><td align="center">X with 30%</td></tr></thead><tbody><tr><td align="left">S1</td><td align="center">76,24</td><td align="center">-</td><td align="center">79,21</td><td align="center">77,23</td></tr><tr><td align="left">S1 with 15%</td><td align="center">82,18</td><td align="center">80,20</td><td align="center">-</td><td align="center">81,19</td></tr><tr><td align="left">S1 with 30%</td><td align="center">84,16</td><td align="center">83,17</td><td align="center">85,15</td><td align="center">-</td></tr><tr><td align="left">S1</td><td align="center">60,29,11</td><td align="center">-</td><td align="center">72,20,8</td><td align="center">70,21,9</td></tr><tr><td align="left">S1 with 15%</td><td align="center">76,17,7</td><td align="center">66,25,9</td><td align="center">-</td><td align="center">75,18,7</td></tr><tr><td align="left">S1 with 30%</td><td align="center">79,15,6</td><td align="center">72,20,8</td><td align="center">80,14,6</td><td align="center">-</td></tr><tr><td align="left">S2</td><td align="center">62,24,14</td><td align="center">-</td><td align="center">49,33,18</td><td align="center">50,31,19</td></tr><tr><td align="left">S2 with 15%</td><td align="center">57,28,15</td><td align="center">68,20,12</td><td align="center">-</td><td align="center">57,27,16</td></tr><tr><td align="left">S2 with 30%</td><td align="center">65,22,13</td><td align="center">73,17,10</td><td align="center">65,23,12</td><td align="center">-</td></tr></tbody></table><table-wrap-foot><p>In the "Experiment" column, the estimated subpopulation percentages from the 6 experiments are shown: Two pure tumor samples (S1 and S2), and four samples with tumor mixed with 15 or 30% normal cells. The best fit for S1 is three subpopulations, whereas it is two for "S1 with 15%" and "S1 with 30%"; therefore we show results for both two and three subpopulations to facilitate comparison. The remaining three columns contain percentages estimated from the Experiment column; e.g. to estimate the percentages of the sample with 85% malignant cells and 15% normal cells ("S2 with 15%") from the sample S2 do (0.62&#x000b7;85 + 15, 0.24&#x000b7;85, 0.14&#x000b7;85) = (68, 20, 12).</p></table-wrap-foot></table-wrap><p>Table <xref ref-type="table" rid="T6">6</xref> shows that the predictions generally are in accordance with our expectations. All discrepancies between experimental and estimated percentages fall within the error bounds reported in Table <xref ref-type="table" rid="T4">4</xref>. However, one of the tumor samples is best explained by three subpopulations (S1 in Table <xref ref-type="table" rid="T6">6</xref>), whereas the two mixed samples ("S1 with 15%" and "S1 with 30%") are best explained by two subpopulations. By adding normal cells the signal from aberrant clones become diluted and it becomes more difficult to distinguish different abnormal subpopulations.</p></sec></sec><sec><title>Conclusion</title><p>Tumor heterogeneity is an important aspect of tumor evolution and progression. However, this aspect has, to the best of our knowledge, largely been ignored in analysis of CGH and SNP array data [<xref ref-type="bibr" rid="B12">12</xref>,<xref ref-type="bibr" rid="B13">13</xref>]. In Refs. [<xref ref-type="bibr" rid="B12">12</xref>,<xref ref-type="bibr" rid="B13">13</xref>], a fraction of the tumor is assumed to contain normal cells which weaken the signal from the aberrated cells. Only Ref. [<xref ref-type="bibr" rid="B13">13</xref>] estimates the fraction of normal cells directly, but we cannot compare this method to ours since it is developed to SNP array data. The method described in Ref. [<xref ref-type="bibr" rid="B12">12</xref>] does not output the frequency of normal cells. We have introduced a novel algorithm to estimate tumor heterogeneity and evaluated its performance on simulated and real tumor data. The method adds to our understanding of the genomic aberration profile, the quantification of genomic instability in the tumor, and the heterogeneity of the tumor.</p><p>One of the main difficulties of developing quantitative methods for array CGH data is the lack of knowledge about how tumors evolve and differentiate. Better and more accurate models could be developed if more were known about tumor evolution. Therefore, it might be difficult to make decisions on a strict mathematical basis only, because the underlying hypotheses might be difficult test or validate with current data sets. The appropriateness of the novel methodology can only be evaluated in a long run in which the conclusions demonstrate utility for improving biological understanding and clinical decisions. Our approach is one possible algorithm to interpret the biology of the tumor genomic profile.</p><p>In CGH array analysis copy number changes are measured relatively to a reference level. Generally, the reference level is not known and the median (or mean) log-intensity is typically assumed to correspond to two copies; loss and amplifications are then measured relatively to the median log-intensity level. Our method makes the same assumption. This implies that a tumor sample consisting of e.g. two subpopulations, one diploid and one <italic>n</italic>-ploid, would be identified as purely diploid. Each clone will have a log-intensity value that reflects the mixture of the two subpopulations and will, erroneously, be equated with two copies. However, if the two subpopulations are not euploid, our method might be able to disentangle the two subpopulations. This situation is not unlike traditional CGH array analysis where the tumor sample will be identified as one homogeneous population. Only if additional information is available, e.g. from karyotyping, can the reference level be properly adjusted.</p><p>We anticipate various lines of improvement, both in the chosen statistical methodology (e.g. to adopt a Bayesian framework to control the vast number of copy number parameters) as well in the mathematical modelling of tumor progression. These advances should be developed in tandem with richer and larger data set that are likely to occur with improved genomic technology. Our method (and improvements) can also be applied to SNP array data. Recent methods for SNP array analysis, e.g. [<xref ref-type="bibr" rid="B13">13</xref>,<xref ref-type="bibr" rid="B14">14</xref>], distingusih the two possible alleles; this might be useful for providing more accurate inference on copy numbers and the copy number level of the reference population, because each SNP carries two observations and not just one as for CGH arrays.</p></sec><sec sec-type="methods"><title>Methods</title><sec sec-type="materials"><title>Materials</title><p>Cell lines with known copy number gains and losses were used to establish a copy number model. Here, we applied several cell lines including trisomy13, trisomy18, trisomy21 and 49, XXXXX. Normal male and female DNA were also used.</p><p>Twenty-nine pairs of primary breast tumors and their matched lymph node metastasis were provided by Copenhagen University Hospital. The project was approved by the Scientific and Ethical Committee of the Copenhagen and Frederiksberg Municipalities.</p><p>Arrays covering the whole genome with elements produced from bacterial artificial chromosome (BAC) clones were obtained from the Wellcome Trust Sanger Institute. The human DNA fragments of the 3340 BAC clones are spaced at approximately 1 Mb intervals across each chromosome arm. The experimental process is explained in details in [<xref ref-type="bibr" rid="B15">15</xref>]. Briefly, each clone is spotted on slides in a neighboring triplicate pattern. Annotations of the clones are based on the 1-Mb clone information published by the Wellcome Trust Sanger Institute and updated using the 38_36 version of the 1-Mb clone information released by Ensembl.</p></sec><sec><title>Normalization of arrays</title><p>The intensities of Cy3 (tumor sample) and Cy5 (reference) were extracted respectively from 16 bit TIF files using the Tracker (Applied Precision) software. Subsequently data were subjected to quality assessment and a filtering process to remove the clones with poor quality.</p><p>Clones were removed from the subsequent analysis if one of the following conditions is fulfilled: a) The spot is labeled "Undetected" by Tracker, b) The Sanger annotation of a clone is inconsistent with the Ensemble annotation (see above), c) The spot's Cy5 (reference) intensity is less than two times the standard deviation (SD) of its background intensity, d) Only one spot out of the three replicates is left after the above procedure, e) The CV of the intensity ratios Cy3/Cy5 for one clone exceeds 0.08, and f) The clone maps to chromosome Y.</p><p>Finally, the ratios of Cy3/Cy5 intensities are calculated and log transformed. Subsequently, the median of the log-ratios from the whole array is subtracted from each log-ratio to normalize all spots.</p></sec><sec><title>The copy number model</title><p>We modeled the Cy3/Cy5 intensity ratios in the following way. Assume that the test sample is homogeneous, i.e. a given clone has the same copy number in all cells in the sample, and that the clones are divided into distinct segments such that all clones in a segment have the same copy number.</p><p>Let <italic>x</italic><sub><italic>ij </italic></sub>be the ratio of clone <italic>j </italic>in segment <italic>i</italic>, and let <italic>C</italic><sub>0<italic>i </italic></sub>and <italic>C</italic><sub>1<italic>i </italic></sub>be the copy numbers of the reference sample and the test sample, respectively. We assume</p><p><disp-formula id="bmcM3"><label>(3)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M5" name="1471-2105-10-12-i5" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:msub>                              <mml:mi>x</mml:mi>                              <mml:mrow>                                 <mml:mi>i</mml:mi>                                 <mml:mi>j</mml:mi>                              </mml:mrow>                           </mml:msub>                           <mml:mo>=</mml:mo>                           <mml:mi>&#x003b3;</mml:mi>                           <mml:msup>                              <mml:mrow>                                 <mml:mrow>                                    <mml:mo>(</mml:mo>                                    <mml:mrow>                                       <mml:mfrac>                                          <mml:mrow>                                             <mml:msub>                                                <mml:mi>C</mml:mi>                                                <mml:mrow>                                                   <mml:mn>1</mml:mn>                                                   <mml:mi>i</mml:mi>                                                </mml:mrow>                                             </mml:msub>                                          </mml:mrow>                                          <mml:mrow>                                             <mml:msub>                                                <mml:mi>C</mml:mi>                                                <mml:mrow>                                                   <mml:mn>0</mml:mn>                                                   <mml:mi>i</mml:mi>                                                </mml:mrow>                                             </mml:msub>                                          </mml:mrow>                                       </mml:mfrac>                                    </mml:mrow>                                    <mml:mo>)</mml:mo>                                 </mml:mrow>                              </mml:mrow>                              <mml:mi>&#x003b1;</mml:mi>                           </mml:msup>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mn>1</mml:mn>                           <mml:mo>+</mml:mo>                           <mml:msub>                              <mml:mi>&#x003f5;</mml:mi>                              <mml:mrow>                                 <mml:mi>i</mml:mi>                                 <mml:mi>j</mml:mi>                              </mml:mrow>                           </mml:msub>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo>,</mml:mo>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>where <italic>&#x003b3; </italic>is a constant depending on the quality of the DNA in the tube, amplification, scanning and other hybridization and experimental conditions. The error term <italic>&#x003b5;</italic><sub><italic>ij </italic></sub>is assumed to have mean zero and common variance, and <italic>&#x003b1; </italic>is a constant that is justified from calibration experiments [see Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>] and appears to be sample independent (but likely platform specific). The model assumes the variance is proportional to the true ratio of copy numbers in the test and reference samples.</p><p>Let <italic>x</italic><sub><italic>R </italic></sub>be the median over all intensity ratios (over all segments). Then</p><p><disp-formula id="bmcM4"><label>(4)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M6" name="1471-2105-10-12-i6" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:msub>                              <mml:mi>z</mml:mi>                              <mml:mrow>                                 <mml:mi>i</mml:mi>                                 <mml:mi>j</mml:mi>                              </mml:mrow>                           </mml:msub>                           <mml:mo>=</mml:mo>                           <mml:mfrac>                              <mml:mrow>                                 <mml:msub>                                    <mml:mi>x</mml:mi>                                    <mml:mrow>                                       <mml:mi>i</mml:mi>                                       <mml:mi>j</mml:mi>                                    </mml:mrow>                                 </mml:msub>                              </mml:mrow>                              <mml:mrow>                                 <mml:msub>                                    <mml:mi>x</mml:mi>                                    <mml:mi>R</mml:mi>                                 </mml:msub>                              </mml:mrow>                           </mml:mfrac>                           <mml:mo>=</mml:mo>                           <mml:msup>                              <mml:mrow>                                 <mml:mrow>                                    <mml:mo>(</mml:mo>                                    <mml:mrow>                                       <mml:mfrac>                                          <mml:mrow>                                             <mml:msub>                                                <mml:mi>C</mml:mi>                                                <mml:mrow>                                                   <mml:mn>1</mml:mn>                                                   <mml:mi>i</mml:mi>                                                </mml:mrow>                                             </mml:msub>                                             <mml:msub>                                                <mml:mi>C</mml:mi>                                                <mml:mrow>                                                   <mml:mn>0</mml:mn>                                                   <mml:mi>R</mml:mi>                                                </mml:mrow>                                             </mml:msub>                                          </mml:mrow>                                          <mml:mrow>                                             <mml:msub>                                                <mml:mi>C</mml:mi>                                                <mml:mrow>                                                   <mml:mn>1</mml:mn>                                                   <mml:mi>R</mml:mi>                                                </mml:mrow>                                             </mml:msub>                                             <mml:msub>                                                <mml:mi>C</mml:mi>                                                <mml:mrow>                                                   <mml:mn>0</mml:mn>                                                   <mml:mi>i</mml:mi>                                                </mml:mrow>                                             </mml:msub>                                          </mml:mrow>                                       </mml:mfrac>                                    </mml:mrow>                                    <mml:mo>)</mml:mo>                                 </mml:mrow>                              </mml:mrow>                              <mml:mi>&#x003b1;</mml:mi>                           </mml:msup>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mn>1</mml:mn>                           <mml:mo>+</mml:mo>                           <mml:msub>                              <mml:msup>                                 <mml:mi>&#x003f5;</mml:mi>                                 <mml:mo>&#x02032;</mml:mo>                              </mml:msup>                              <mml:mrow>                                 <mml:mi>i</mml:mi>                                 <mml:mi>j</mml:mi>                              </mml:mrow>                           </mml:msub>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo>,</mml:mo>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>where <italic>C</italic><sub>1<italic>R </italic></sub>(<italic>C</italic><sub>0<italic>R</italic></sub>) is the copy number of the test (reference) sample corresponding to <italic>x</italic><sub><italic>R </italic></sub>and <italic>&#x003b5;' </italic>is an error term (not equal to <italic>&#x003b5;</italic>). The error term is defined such that (1 + <italic>&#x003b5;</italic><sub><italic>ij</italic></sub>)/(1 + <italic>&#x003b5;</italic><sub><italic>R</italic></sub>) = 1 + <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M7" name="1471-2105-10-12-i7" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:msup><mml:mi>&#x003f5;</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>. Typically, the majority of clones in a tumor sample have copy number two and we assume <italic>C</italic><sub>1<italic>R </italic></sub>= 2. In general, <italic>C</italic><sub>0<italic>i</italic></sub>/<italic>C</italic><sub>0<italic>R </italic></sub>= 1 in the reference sample, unless the reference sample has only one chromosome X and <italic>C</italic><sub>0<italic>i</italic></sub>/<italic>C</italic><sub>0<italic>R </italic></sub>= 1/2 for chromosome X clones.</p><p>Put <italic>C</italic><sub><italic>i </italic></sub>= <italic>C</italic><sub>1<italic>i</italic></sub>/<italic>C</italic><sub>1<italic>R</italic></sub>, <italic>C</italic><sub><italic>i </italic></sub>&#x02208; {0, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M8" name="1471-2105-10-12-i8" overflow="scroll"><mml:semantics><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:semantics></mml:math></inline-formula>, 1, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M9" name="1471-2105-10-12-i9" overflow="scroll"><mml:semantics><mml:mrow><mml:mfrac><mml:mn>3</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:semantics></mml:math></inline-formula>, ...}, then <italic>z</italic><sub><italic>ij </italic></sub>= <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M10" name="1471-2105-10-12-i10" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mi>C</mml:mi><mml:mi>i</mml:mi><mml:mi>&#x003b1;</mml:mi></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula>(1 + <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M11" name="1471-2105-10-12-i7" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:msup><mml:mi>&#x003f5;</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>). We refer to <italic>z</italic><sub><italic>ij </italic></sub>as the normalized (intensity) ratio. With this notation we have</p><p><disp-formula id="bmcM5"><label>(5)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M12" name="1471-2105-10-12-i11" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:mtable columnalign="left">                              <mml:mtr columnalign="left">                                 <mml:mtd columnalign="left">                                    <mml:mrow>                                       <mml:mi>log</mml:mi>                                       <mml:mo>&#x02061;</mml:mo>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:msub>                                          <mml:mi>z</mml:mi>                                          <mml:mrow>                                             <mml:mi>i</mml:mi>                                             <mml:mi>j</mml:mi>                                          </mml:mrow>                                       </mml:msub>                                       <mml:mo stretchy="false">)</mml:mo>                                    </mml:mrow>                                 </mml:mtd>                                 <mml:mtd columnalign="left">                                    <mml:mo>=</mml:mo>                                 </mml:mtd>                                 <mml:mtd columnalign="left">                                    <mml:mrow>                                       <mml:mi>&#x003b1;</mml:mi>                                       <mml:mi>log</mml:mi>                                       <mml:mo>&#x02061;</mml:mo>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:msub>                                          <mml:mi>C</mml:mi>                                          <mml:mi>i</mml:mi>                                       </mml:msub>                                       <mml:mo stretchy="false">)</mml:mo>                                       <mml:mo>+</mml:mo>                                       <mml:mi>log</mml:mi>                                       <mml:mo>&#x02061;</mml:mo>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:mn>1</mml:mn>                                       <mml:mo>+</mml:mo>                                       <mml:msub>                                          <mml:msup>                                             <mml:mi>&#x003f5;</mml:mi>                                             <mml:mo>&#x02032;</mml:mo>                                          </mml:msup>                                          <mml:mrow>                                             <mml:mi>i</mml:mi>                                             <mml:mi>j</mml:mi>                                          </mml:mrow>                                       </mml:msub>                                       <mml:mo stretchy="false">)</mml:mo>                                    </mml:mrow>                                 </mml:mtd>                              </mml:mtr>                              <mml:mtr columnalign="left">                                 <mml:mtd columnalign="left">                                    <mml:mrow/>                                 </mml:mtd>                                 <mml:mtd columnalign="left">                                    <mml:mo>&#x02248;</mml:mo>                                 </mml:mtd>                                 <mml:mtd columnalign="left">                                    <mml:mrow>                                       <mml:mi>&#x003b1;</mml:mi>                                       <mml:mi>log</mml:mi>                                       <mml:mo>&#x02061;</mml:mo>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:msub>                                          <mml:mi>C</mml:mi>                                          <mml:mi>i</mml:mi>                                       </mml:msub>                                       <mml:mo stretchy="false">)</mml:mo>                                       <mml:mo>+</mml:mo>                                       <mml:msub>                                          <mml:msup>                                             <mml:mi>&#x003f5;</mml:mi>                                             <mml:mo>&#x02032;</mml:mo>                                          </mml:msup>                                          <mml:mrow>                                             <mml:mi>i</mml:mi>                                             <mml:mi>j</mml:mi>                                          </mml:mrow>                                       </mml:msub>                                       <mml:mo>.</mml:mo>                                    </mml:mrow>                                 </mml:mtd>                              </mml:mtr>                           </mml:mtable>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>Further, assume</p><p><disp-formula id="bmcM6"><label>(6)</label>log(<italic>z</italic><sub><italic>ij</italic></sub>) ~ <italic>N</italic>(<italic>&#x003b1;</italic>log(<italic>C</italic><sub><italic>i</italic></sub>) + <italic>&#x003b2;</italic>, <italic>&#x003c3;</italic><sup>2</sup>),</disp-formula></p><p>where <italic>&#x003b2; </italic>is the mean of <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M13" name="1471-2105-10-12-i7" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:msup><mml:mi>&#x003f5;</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> and <italic>&#x003c3;</italic><sup>2 </sup>the variance. Equation (3) ensures the variance is independent of the copy number. If a series of experiments with known copy numbers are available, the parameters in equation (6) can be estimated using linear regression.</p><p>In order to determine <italic>&#x003b1; </italic>and <italic>&#x003b2; </italic>in equation (6), we used the normal references and the samples with known copy number aberrations. We have data corresponding to the following ratios: 0.5 (46, XY versus 46, XX), 1.5 (47, XX+13 versus the normal reference, and 47, XX+18 versus the normal reference), 2 (chr X, the normal females versus the normal males), and 2.5 (49, XXXXX versus 46, XX).</p></sec><sec><title>Mixture modeling of tumor samples</title><p>The intensity ratios in a tumor sample is modeled using a mixture model approach. Specifically, the log-ratio log(<italic>z</italic><sub><italic>ij</italic></sub>) has intensity given by</p><p><disp-formula id="bmcM7"><label>(7)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M14" name="1471-2105-10-12-i12" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:mi>log</mml:mi>                           <mml:mo>&#x02061;</mml:mo>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:msub>                              <mml:mi>z</mml:mi>                              <mml:mrow>                                 <mml:mi>i</mml:mi>                                 <mml:mi>j</mml:mi>                              </mml:mrow>                           </mml:msub>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo>~</mml:mo>                           <mml:mi>N</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>&#x003b1;</mml:mi>                           <mml:mi>log</mml:mi>                           <mml:mo>&#x02061;</mml:mo>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:msub>                              <mml:mover accent="true">                                 <mml:mi>C</mml:mi>                                 <mml:mo>&#x000af;</mml:mo>                              </mml:mover>                              <mml:mi>i</mml:mi>                           </mml:msub>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo>+</mml:mo>                           <mml:mi>&#x003b2;</mml:mi>                           <mml:mo>,</mml:mo>                           <mml:msup>                              <mml:mi>&#x003c3;</mml:mi>                              <mml:mn>2</mml:mn>                           </mml:msup>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo>,</mml:mo>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>where</p><p><disp-formula id="bmcM8"><label>(8)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M15" name="1471-2105-10-12-i13" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:msub>                              <mml:mover accent="true">                                 <mml:mi>C</mml:mi>                                 <mml:mo>&#x000af;</mml:mo>                              </mml:mover>                              <mml:mi>i</mml:mi>                           </mml:msub>                           <mml:mo>=</mml:mo>                           <mml:mstyle displaystyle="true">                              <mml:munderover>                                 <mml:mo>&#x02211;</mml:mo>                                 <mml:mrow>                                    <mml:mi>k</mml:mi>                                    <mml:mo>=</mml:mo>                                    <mml:mn>0</mml:mn>                                 </mml:mrow>                                 <mml:mi>K</mml:mi>                              </mml:munderover>                              <mml:mrow>                                 <mml:msub>                                    <mml:mi>p</mml:mi>                                    <mml:mi>k</mml:mi>                                 </mml:msub>                                 <mml:msub>                                    <mml:mi>C</mml:mi>                                    <mml:mrow>                                       <mml:mi>i</mml:mi>                                       <mml:mi>k</mml:mi>                                    </mml:mrow>                                 </mml:msub>                              </mml:mrow>                           </mml:mstyle>                           <mml:mo>,</mml:mo>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p><italic>K </italic>is the number of subpopulations, <italic>p</italic><sub><italic>k </italic></sub>is the percentage of the <italic>k</italic>th subpopulation, &#x003a3;<sub><italic>k</italic></sub><italic>p</italic><sub><italic>k </italic></sub>= 1, and <italic>C</italic><sub><italic>ik </italic></sub>&#x02265; 0 is the copy number in the <italic>k</italic>th subpopulation relative to the copy number of the test sample. Normally, the same region in different subpopulations will not experience both gains and losses [<xref ref-type="bibr" rid="B16">16</xref>].</p><p>Therefore, we restrict our model parameters in the following way. The first subpopulation, with percentage <italic>p</italic><sub>0</sub>, is assumed to be normal; i.e. <italic>C</italic><sub><italic>i</italic>0 </sub>= 1 for all clones in this subpopulation. We assume the other subpopulations are derived from each other, such that either</p><p><disp-formula id="bmcM9"><label>(9)</label>1 = <italic>C</italic><sub><italic>i</italic>0 </sub>&#x02264; <italic>C</italic><sub><italic>ik </italic></sub>&#x02264; <italic>C</italic><sub><italic>i</italic>,<italic>k</italic>+1</sub></disp-formula></p><p>or</p><p><disp-formula id="bmcM10"><label>(10)</label>1 = <italic>C</italic><sub><italic>i</italic>0 </sub>&#x02265; <italic>C</italic><sub><italic>ik </italic></sub>&#x02265; <italic>C</italic><sub><italic>i</italic>,<italic>k</italic>+1</sub>.</disp-formula></p><p>That is, we consider subpopulation <italic>k </italic>+ 1 to be derived from subpopulation <italic>k </italic>by either A) introducing a new copy number aberration (<italic>C</italic><sub><italic>ik </italic></sub>= 1, but <italic>C</italic><sub><italic>i</italic>,<italic>k</italic>+1 </sub>&#x02260; 1), B) increasing an existing copy number gain, or C) increasing an existing copy number loss.</p></sec><sec><title>Estimation of copy numbers and percentages</title><p>To estimate the copy numbers and the percentages of the subpopulations, we first divide the clones into segments, such that all clones in a segment have the same copy number profile. To segment the clones, we used DNAcopy [<xref ref-type="bibr" rid="B17">17</xref>] implemented in R. A comparison study of several segmentation approaches have been done recently [<xref ref-type="bibr" rid="B18">18</xref>], and DNAcopy came out best.</p><p>After segmentation, all clones in one segment are assigned the same value, namely the mean of the intensity values in that particular segment. Missing clone values mapping within a segment are given the same value as the segment, while missing clone values located between segments have values imputed using the minimum absolute value of the two flanking segments. The copy number level closest to zero is declared unchanged ("normal level") and corresponds to two copies. In the final step, all segments are normalized by subtracting the value of the normal level.</p><p>Denote by <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M16" name="1471-2105-10-12-i14" overflow="scroll"><mml:semantics><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>&#x003c3;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:semantics></mml:math></inline-formula> the residual error</p><p><disp-formula id="bmcM11"><label>(11)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M17" name="1471-2105-10-12-i15" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:msup>                              <mml:mover accent="true">                                 <mml:mi>&#x003c3;</mml:mi>                                 <mml:mo>^</mml:mo>                              </mml:mover>                              <mml:mn>2</mml:mn>                           </mml:msup>                           <mml:mo>=</mml:mo>                           <mml:mfrac>                              <mml:mn>1</mml:mn>                              <mml:mi>M</mml:mi>                           </mml:mfrac>                           <mml:mstyle displaystyle="true">                              <mml:munder>                                 <mml:mo>&#x02211;</mml:mo>                                 <mml:mrow>                                    <mml:mi>i</mml:mi>                                    <mml:mi>j</mml:mi>                                 </mml:mrow>                              </mml:munder>                              <mml:mrow>                                 <mml:msup>                                    <mml:mrow>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:mi>log</mml:mi>                                       <mml:mo>&#x02061;</mml:mo>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:msub>                                          <mml:mi>z</mml:mi>                                          <mml:mrow>                                             <mml:mi>i</mml:mi>                                             <mml:mi>j</mml:mi>                                          </mml:mrow>                                       </mml:msub>                                       <mml:mo stretchy="false">)</mml:mo>                                       <mml:mo>&#x02212;</mml:mo>                                       <mml:msub>                                          <mml:mover accent="true">                                             <mml:mi>&#x003bc;</mml:mi>                                             <mml:mo>^</mml:mo>                                          </mml:mover>                                          <mml:mi>j</mml:mi>                                       </mml:msub>                                       <mml:mo stretchy="false">)</mml:mo>                                    </mml:mrow>                                    <mml:mn>2</mml:mn>                                 </mml:msup>                              </mml:mrow>                           </mml:mstyle>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>where <italic>M </italic>is the total number of clones, <italic>m</italic><sub><italic>i </italic></sub>the number of clones in segment <italic>i</italic>, and</p><p><disp-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M18" name="1471-2105-10-12-i16" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:msub>                              <mml:mover accent="true">                                 <mml:mi>&#x003bc;</mml:mi>                                 <mml:mo>^</mml:mo>                              </mml:mover>                              <mml:mi>i</mml:mi>                           </mml:msub>                           <mml:mo>=</mml:mo>                           <mml:mfrac>                              <mml:mn>1</mml:mn>                              <mml:mrow>                                 <mml:msub>                                    <mml:mi>m</mml:mi>                                    <mml:mi>i</mml:mi>                                 </mml:msub>                              </mml:mrow>                           </mml:mfrac>                           <mml:mstyle displaystyle="true">                              <mml:munder>                                 <mml:mo>&#x02211;</mml:mo>                                 <mml:mi>j</mml:mi>                              </mml:munder>                              <mml:mrow>                                 <mml:mi>log</mml:mi>                                 <mml:mo>&#x02061;</mml:mo>                                 <mml:mo stretchy="false">(</mml:mo>                                 <mml:msub>                                    <mml:mi>z</mml:mi>                                    <mml:mrow>                                       <mml:mi>i</mml:mi>                                       <mml:mi>j</mml:mi>                                    </mml:mrow>                                 </mml:msub>                                 <mml:mo stretchy="false">)</mml:mo>                              </mml:mrow>                           </mml:mstyle>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>the mean intensity of segment <italic>i</italic>.</p><p>For a given number of subpopulations, <italic>K </italic>= 2, 3, or 4, we use least square to fit the parameters (copy numbers, percentages); i.e. for each <italic>K </italic>we minimize</p><p><disp-formula id="bmcM12"><label>(12)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M19" name="1471-2105-10-12-i17" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:mi>L</mml:mi>                           <mml:mi>S</mml:mi>                           <mml:mo>=</mml:mo>                           <mml:mstyle displaystyle="true">                              <mml:munder>                                 <mml:mo>&#x02211;</mml:mo>                                 <mml:mrow>                                    <mml:mi>i</mml:mi>                                    <mml:mo>,</mml:mo>                                    <mml:mi>j</mml:mi>                                 </mml:mrow>                              </mml:munder>                              <mml:mrow>                                 <mml:msup>                                    <mml:mrow>                                       <mml:mrow>                                          <mml:mo>(</mml:mo>                                          <mml:mrow>                                             <mml:mi>log</mml:mi>                                             <mml:mo>&#x02061;</mml:mo>                                             <mml:mo stretchy="false">(</mml:mo>                                             <mml:msub>                                                <mml:mi>z</mml:mi>                                                <mml:mrow>                                                   <mml:mi>i</mml:mi>                                                   <mml:mi>j</mml:mi>                                                </mml:mrow>                                             </mml:msub>                                             <mml:mo stretchy="false">)</mml:mo>                                             <mml:mo>&#x02212;</mml:mo>                                             <mml:mover accent="true">                                                <mml:mi>&#x003b1;</mml:mi>                                                <mml:mo>^</mml:mo>                                             </mml:mover>                                             <mml:mi>log</mml:mi>                                             <mml:mo>&#x02061;</mml:mo>                                             <mml:mo stretchy="false">(</mml:mo>                                             <mml:msub>                                                <mml:mover accent="true">                                                   <mml:mi>C</mml:mi>                                                   <mml:mo>&#x000af;</mml:mo>                                                </mml:mover>                                                <mml:mi>i</mml:mi>                                             </mml:msub>                                             <mml:mo stretchy="false">)</mml:mo>                                             <mml:mo>&#x02212;</mml:mo>                                             <mml:mover accent="true">                                                <mml:mi>&#x003b2;</mml:mi>                                                <mml:mo>^</mml:mo>                                             </mml:mover>                                          </mml:mrow>                                          <mml:mo>)</mml:mo>                                       </mml:mrow>                                    </mml:mrow>                                    <mml:mn>2</mml:mn>                                 </mml:msup>                              </mml:mrow>                           </mml:mstyle>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>over <italic>p</italic><sub><italic>k</italic></sub>, <italic>k </italic>= 0, ..., <italic>K </italic>and <italic>C</italic><sub><italic>ik </italic></sub>with the constraints given in equations (9) and (10). Here (<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M20" name="1471-2105-10-12-i1" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>&#x003b1;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M21" name="1471-2105-10-12-i2" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>&#x003b2;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula>) is obtained from the samples with known copy number alterations and assumed to be known in equation (12).</p><p>Alternatively, one can minimize</p><p><disp-formula id="bmcM13"><label>(13)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M22" name="1471-2105-10-12-i18" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:mi>L</mml:mi>                           <mml:msup>                              <mml:mi>S</mml:mi>                              <mml:mo>&#x02032;</mml:mo>                           </mml:msup>                           <mml:mo>=</mml:mo>                           <mml:mstyle displaystyle="true">                              <mml:munder>                                 <mml:mo>&#x02211;</mml:mo>                                 <mml:mi>i</mml:mi>                              </mml:munder>                              <mml:mrow>                                 <mml:msub>                                    <mml:mi>m</mml:mi>                                    <mml:mi>i</mml:mi>                                 </mml:msub>                                 <mml:msup>                                    <mml:mrow>                                       <mml:mrow>                                          <mml:mo>(</mml:mo>                                          <mml:mrow>                                             <mml:msub>                                                <mml:mover accent="true">                                                   <mml:mi>&#x003bc;</mml:mi>                                                   <mml:mo>^</mml:mo>                                                </mml:mover>                                                <mml:mi>i</mml:mi>                                             </mml:msub>                                             <mml:mo>&#x02212;</mml:mo>                                             <mml:mover accent="true">                                                <mml:mi>&#x003b1;</mml:mi>                                                <mml:mo>^</mml:mo>                                             </mml:mover>                                             <mml:mi>log</mml:mi>                                             <mml:mo>&#x02061;</mml:mo>                                             <mml:mo stretchy="false">(</mml:mo>                                             <mml:msub>                                                <mml:mover accent="true">                                                   <mml:mi>C</mml:mi>                                                   <mml:mo>&#x000af;</mml:mo>                                                </mml:mover>                                                <mml:mi>i</mml:mi>                                             </mml:msub>                                             <mml:mo stretchy="false">)</mml:mo>                                             <mml:mo>&#x02212;</mml:mo>                                             <mml:mover accent="true">                                                <mml:mi>&#x003b2;</mml:mi>                                                <mml:mo>^</mml:mo>                                             </mml:mover>                                          </mml:mrow>                                          <mml:mo>)</mml:mo>                                       </mml:mrow>                                    </mml:mrow>                                    <mml:mn>2</mml:mn>                                 </mml:msup>                              </mml:mrow>                           </mml:mstyle>                           <mml:mo>,</mml:mo>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>where <italic>m</italic><sub><italic>i </italic></sub>is the number of clones in segment <italic>i</italic>. Equation (13) involves summation over fewer terms than equation (12) and might thus be preferred. For fixed <italic>K</italic>, there are <italic>K </italic>- 1 percentage parameters and <italic>K </italic>- 1 copy numbers for each segment; in total (<italic>K </italic>- 1) + <italic>n</italic>(<italic>K </italic>- 1) = (<italic>n </italic>+ 1)(<italic>K </italic>- 1) parameters, where <italic>n </italic>is the number of segments. The number of parameters scales with the number of clones; however, since the copy numbers assume integer values we do not obtain a perfect fit to the log-intensities in equation (12) or (13). To facilitate comparison between different experiments, we use the normalized quantity <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M23" name="1471-2105-10-12-i19" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>N</mml:mi><mml:mi>L</mml:mi><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mi>L</mml:mi><mml:msup><mml:mi>S</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>/</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:semantics></mml:math></inline-formula>, where <italic>n </italic>is the number of segments in one experiment.</p></sec><sec><title>Classification of samples</title><p>To classify a sample we go through the following steps. The estimation procedure outlined in the previous section is applied.</p><sec><title>Estimation of subpopulation number and parameters</title><p>1) Apply DNACopy to obtain a list of segments.</p><p>2) Fit <italic>K </italic>subpopulations to obtain <italic>NLS</italic><sub><italic>K</italic></sub>, <italic>K </italic>= 2, 3, 4, with corresponding percentages (<italic>p</italic><sub>0</sub>, <italic>p</italic><sub>1</sub>, ..., <italic>p</italic><sub><italic>K</italic></sub>) and copy number profiles (<italic>C</italic><sub><italic>i</italic>1</sub>, ..., <italic>C</italic><sub><italic>iK</italic></sub>). The first subpopulation is supposed to consist of pure normal cells.</p></sec><sec><title>Simulation of bootstrap samples</title><p>To simulate bootstrap samples the estimated copy number profiles are applied. Noise are added to the profiles to obtain log-intensity values.</p><p>3) Choose <italic>&#x003b1; </italic>and <italic>&#x003b2; </italic>according to the estimated normal distributions obtained by linear regression. The distributions are restricted to the 95% CI to avoid extreme values.</p><p>4) For fixed <italic>K</italic>, simulate log-intensity values for each estimated copy number profile, <italic>k </italic>= 1, ..., <italic>K</italic>, by adding noise: For a clone with copy number <italic>C</italic>, compute the mean log-intensity <italic>&#x003b2; </italic>+ <italic>&#x003b1;C </italic>and add noise according to a normal distribution <italic>N</italic>(0, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M24" name="1471-2105-10-12-i15" overflow="scroll"><mml:semantics><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>&#x003c3;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>M</mml:mi></mml:mfrac><mml:mstyle displaystyle="true"><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>log</mml:mi><mml:mo>&#x02061;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>&#x003bc;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mstyle></mml:mrow></mml:semantics></mml:math></inline-formula>).</p><p>5) Repeat the previous step <italic>B </italic>times for each sample and each value of <italic>K </italic>to obtain simulated samples with <italic>K </italic>= 2, 3 or 4 subpopulations. For each simulated sample fit 2, 3 and 4 subpopulations according to step 1 and 2, and calculate the corresponding <italic>NLS</italic><sub><italic>bKC</italic></sub>. Here <italic>b </italic>denotes the <italic>b</italic>th simulated/bootstrapped sample with <italic>K </italic>subpopulations, fitted to <italic>C </italic>subpopulations, <italic>C </italic>= 2, 3, 4.</p></sec><sec><title>Evaluation of NLS<sub>K </sub>from real samples</title><p>In the final step the <italic>NLS</italic><sub><italic>K</italic></sub>, <italic>K </italic>= 2, 3, 4, from a real sample is compared to the bootstrapped samples to find the optimal number of subpopulations for the real sample.</p><p>6) If <italic>NLS</italic><sub>2 </sub>is below the 95 percentile of the empirical distribution of <italic>NLS</italic><sub><italic>b</italic>22</sub>, accept the sample as two populations, otherwise</p><p>7) If <italic>NLS</italic><sub>3 </sub>is below the 95 percentile of the empirical distribution of <italic>NLS</italic><sub><italic>b</italic>33</sub>, accept the sample as three populations, otherwise</p><p>8) Accept the sample as 4 subpopulations.</p><p>The part described in steps 6&#x02013;8 is illustrated in Figure <xref ref-type="fig" rid="F3">3</xref>. The whole procedure is a bootstrap procedure; for a real sample the fitted profiles (one for each subpopulation) are compared to simulated samples with the same profiles as the fitted. For a (supposedly) normal sample, one can start with a single population, <italic>K </italic>= 1 (only normal cells).</p><fig position="float" id="F3"><label>Figure 3</label><caption><p><bold>Classifier</bold>. Here we show three examples of classification of real samples. From top to bottom, the three samples are classified as 2, 3, and 4 subpopulations, respectively. Each subplot shows two empirical distributions and a blue line representing the <italic>NLS</italic><sub><italic>K </italic></sub>of the query sample. In the first column, the black curve is the smoothed empirical distribution (SED) of <italic>NLS</italic><sub><italic>b</italic>22 </sub>(simulated as two subpopulations and fitted as two) and the red curve is the SED of <italic>NLS</italic><sub><italic>b</italic>32 </sub>(simulated as three and fitted as two). In the second column, the red curve is the SED of <italic>NLS</italic><sub><italic>b</italic>33 </sub>(simulated as three and fitted as three) and the green curve is the SED of <italic>NLS</italic><sub><italic>b</italic>43 </sub>(simulated as four and fitted as three). Finally, in the last column, the green curve is the SED of <italic>NLS</italic><sub><italic>b</italic>44 </sub>(simulated as four and fitted as four) and the yellow curve is the SED of <italic>NLS</italic><sub><italic>b</italic>54 </sub>(simulated as five and fitted as four). The number in the subplots shows how many samples (in %) in the left distribution that obtain a value greater than the value indicated by the blue line.</p></caption><graphic xlink:href="1471-2105-10-12-3"/></fig></sec></sec><sec><title>Simulation</title><p>To test the classifier we choose some of the simulated samples and used these as input to the bootstrap procedure described above. For each real sample we choose four simulated samples as input and compared the result to the known input.</p><p>We also tested how robust the classifier is to deviations from the assumption of sequential tumor evolution. This we did by adding or subtracting a Poisson number of copies to the original copy number. For each segment, <italic>S</italic><sub><italic>i</italic></sub><italic>X</italic><sub><italic>i </italic></sub>copies were added to the original copy number in subpopulation <italic>i</italic>. Here, <italic>P</italic>(<italic>S</italic><sub><italic>i </italic></sub>= 1) = <italic>P</italic>(<italic>S</italic><sub><italic>i </italic></sub>= 1) = 0.5 and <italic>X</italic><sub><italic>i </italic></sub>is Poisson(<italic>&#x003bb;</italic>). If the copy number fell below 0, it was put to zero. The parameter <italic>&#x003bb; </italic>was varied over <italic>&#x003bb; </italic>= 0.25, 0.5 and 1. For each real sample with <italic>K </italic>= 3 estimated subpopulations we simulated 2 samples (in total 2&#x000b7;23 = 46 simulated samples) in this way, and for each real sample with <italic>K </italic>= 4 we simulated 4 samples (in total 4&#x000b7;10 = 40 simulated samples).</p></sec></sec><sec><title>Authors' contributions</title><p>KW and CW developed the method with input from the other authors, KW and SL implemented the method, KW and JL carried out the data analysis, and KW and CW wrote the manuscript with input from JL and LB; JL performed all experiments. All authors read and approved the final manuscript.</p></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="S1"><caption><title>Additional file 1</title><p><bold>Regression analysis.</bold> The figure shows the the observed averaged intensity values from clones with known copy number changes (e.g. trisomies) and the linear regression fit to the observed values. The x-axis represents the known log<sub>2 </sub>copy number ratio (copy number divided by 2) and the y-axis represents the observed log<sub>2 </sub>intensity ratio. The blue spots represent the observed averaged intensities and red spots show the predicted values.</p></caption><media xlink:href="1471-2105-10-12-S1.pdf" mimetype="application" mime-subtype="pdf"><caption><p>Click here for file</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="S2"><caption><title>Additional file 2</title><p><bold>Detailed results for the 29 pairs of primary tumors and lymph node metastasis.</bold> The table shows results for the 29 pairs of tumors organized in two times eight columns. ID: Name of sample, Pops: Estimated number of subpopulations, %: Subpopulation percentages, <italic>AI</italic><sub><italic>k</italic></sub>: Aberration Index for subpopulation <italic>k</italic>, excluding the normal subpopulation, Total: Weighted sum of <italic>AI</italic><sub><italic>k</italic></sub>, &#x003a3;<sub><italic>k</italic></sub><italic>p</italic><sub><italic>k</italic></sub><italic>AI</italic><sub><italic>k</italic></sub>, Pure: <italic>AI</italic><sub>&#x02022;</sub>, normalized weighted sum of <italic>AI</italic><sub><italic>k</italic></sub>, &#x003a3;<sub><italic>k</italic></sub><italic>p</italic><sub><italic>k</italic></sub><italic>AI</italic><sub><italic>k</italic></sub>/(1 - <italic>p</italic><sub>0</sub>).</p></caption><media xlink:href="1471-2105-10-12-S2.pdf" mimetype="application" mime-subtype="pdf"><caption><p>Click here for file</p></caption></media></supplementary-material></sec></body><back><ack><sec><title>Acknowledgements</title><p>KW has been supported by the PhD-school for Industrial-related Molecular Biology at Aarhus University. CW is supported by the Danish Cancer Society. The work has been financed by the Danish Platform for Integrative Biology of the National Research Foundation, the will of Edith Stern and the "Race Against Breast Cancer".</p></sec></ack><ref-list><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Dexter</surname><given-names>D</given-names></name><name><surname>Leith</surname><given-names>J</given-names></name></person-group><article-title>Tumour heterogeneity and drug resistance</article-title><source>J Clin Oncol</source><year>1986</year><volume>4</volume><fpage>244</fpage><lpage>257</lpage><pub-id pub-id-type="pmid">3944607</pub-id></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Heppner</surname><given-names>G</given-names></name><name><surname>Yamashina</surname><given-names>K</given-names></name><name><surname>Miller</surname><given-names>B</given-names></name><name><surname>Miller</surname><given-names>F</given-names></name></person-group><article-title>Tumour heterogeneity in metastasis</article-title><source>Prog Clin Biol Res</source><year>1986</year><volume>212</volume><fpage>45</fpage><lpage>59</lpage><pub-id pub-id-type="pmid">3714732</pub-id></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Heppner</surname><given-names>G</given-names></name></person-group><article-title>Tumour heterogeneity</article-title><source>Cancer Res</source><year>1984</year><volume>44</volume><fpage>2259</fpage><lpage>2265</lpage><pub-id pub-id-type="pmid">6372991</pub-id></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Black</surname><given-names>D</given-names></name></person-group><article-title>The genetics of breast cancer</article-title><source>Eur J Cancer</source><year>1994</year><volume>30A</volume><fpage>1957</fpage><lpage>1961</lpage><pub-id pub-id-type="pmid">7734207</pub-id><pub-id pub-id-type="doi">10.1016/0959-8049(94)00386-J</pub-id></citation></ref><ref id="B5"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Devilee</surname><given-names>P</given-names></name><name><surname>Cornelisse</surname><given-names>C</given-names></name></person-group><article-title>Somatic genetic changes in human breast cancer</article-title><source>Biochim Biophys Acta</source><year>1994</year><volume>1198</volume><fpage>113</fpage><lpage>130</lpage><pub-id pub-id-type="pmid">7819270</pub-id></citation></ref><ref id="B6"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>el Ashry</surname><given-names>D</given-names></name><name><surname>Lippman</surname><given-names>M</given-names></name></person-group><article-title>Molecular biology of breast carcinoma</article-title><source>World J Surg</source><year>1994</year><volume>18</volume><fpage>12</fpage><lpage>20</lpage><pub-id pub-id-type="pmid">8197767</pub-id><pub-id pub-id-type="doi">10.1007/BF00348187</pub-id></citation></ref><ref id="B7"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ford</surname><given-names>D</given-names></name><name><surname>Easton</surname><given-names>D</given-names></name></person-group><article-title>The genetics of breast and ovarian cancer</article-title><source>Br J Cancer</source><year>1995</year><volume>72</volume><fpage>805</fpage><lpage>812</lpage><pub-id pub-id-type="pmid">7547224</pub-id></citation></ref><ref id="B8"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>O'Connell</surname><given-names>P</given-names></name><name><surname>Pekkel</surname><given-names>V</given-names></name><name><surname>Fuqua</surname><given-names>S</given-names></name><name><surname>Osborne</surname><given-names>C</given-names></name><name><surname>Allred</surname><given-names>D</given-names></name></person-group><article-title>Molecular genetic studies of early breast cancer evolution</article-title><source>Breast Cancer Res Treat</source><year>1994</year><volume>32</volume><fpage>5</fpage><lpage>12</lpage><pub-id pub-id-type="pmid">7819586</pub-id><pub-id pub-id-type="doi">10.1007/BF00666201</pub-id></citation></ref><ref id="B9"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Andersen</surname><given-names>CL</given-names></name><name><surname>Wiuf</surname><given-names>C</given-names></name><name><surname>Kruhoffer</surname><given-names>M</given-names></name><name><surname>Korsgaard</surname><given-names>M</given-names></name><name><surname>Laurberg</surname><given-names>S</given-names></name><name><surname>Orntoft</surname><given-names>TF</given-names></name></person-group><article-title>Frequent occurrence of uniparental disomy in colorectal cancer</article-title><source>Carcinogenesis</source><year>2007</year><volume>28</volume><fpage>38</fpage><lpage>48</lpage><pub-id pub-id-type="pmid">16774939</pub-id><pub-id pub-id-type="doi">10.1093/carcin/bgl086</pub-id></citation></ref><ref id="B10"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Aubele</surname><given-names>M</given-names></name><name><surname>Mattis</surname><given-names>A</given-names></name><name><surname>Zitzelsberger</surname><given-names>H</given-names></name><name><surname>Walch</surname><given-names>A</given-names></name><name><surname>Kremer</surname><given-names>M</given-names></name><name><surname>Hutzler</surname><given-names>P</given-names></name><name><surname>Hofler</surname><given-names>H</given-names></name><name><surname>Werner</surname><given-names>M</given-names></name></person-group><article-title>Intratumoural heterogeneity in breast carcinoma revealed by laser-microdissection and comparative genomic hybridization</article-title><source>Cancer Genet Cytogenet</source><year>1999</year><volume>110</volume><fpage>94</fpage><lpage>102</lpage><pub-id pub-id-type="pmid">10214356</pub-id><pub-id pub-id-type="doi">10.1016/S0165-4608(98)00205-2</pub-id></citation></ref><ref id="B11"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Khan</surname><given-names>MZ</given-names></name><name><surname>Haleem</surname><given-names>A</given-names></name><name><surname>Hassani</surname><given-names>HA</given-names></name><name><surname>Kfoury</surname><given-names>H</given-names></name></person-group><article-title>Cytopathological grading, as a predictor of histopathological grade, in ductal carcinoma (NOS) of breast, on air-dried Diff-Quik smears</article-title><source>Diagn Cytopathol</source><year>2003</year><volume>29</volume><fpage>185</fpage><lpage>93</lpage><pub-id pub-id-type="pmid">14506669</pub-id><pub-id pub-id-type="doi">10.1002/dc.10285</pub-id></citation></ref><ref id="B12"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Fridlyand</surname><given-names>J</given-names></name><name><surname>Snijders</surname><given-names>AM</given-names></name><name><surname>Pinkel</surname><given-names>D</given-names></name><name><surname>Albertson</surname><given-names>DG</given-names></name><name><surname>Jain</surname><given-names>ANAN</given-names></name></person-group><article-title>Hidden Markov models approach to the analysis of array CGH data</article-title><source>Journal of Multivariate Analysis</source><year>2004</year><volume>90</volume><fpage>132</fpage><lpage>153</lpage><pub-id pub-id-type="doi">10.1016/j.jmva.2004.02.008</pub-id></citation></ref><ref id="B13"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lamy</surname><given-names>P</given-names></name><name><surname>Andersen</surname><given-names>C</given-names></name><name><surname>Dyrskjot</surname><given-names>L</given-names></name><name><surname>Torring</surname><given-names>N</given-names></name><name><surname>Wiuf</surname><given-names>C</given-names></name></person-group><article-title>A Hidden Markov Model to estimate population mixture and allelic copy-numbers in cancers using Affymetrix SNP arrays</article-title><source>BMC Bioinformatics</source><year>2007</year><pub-id pub-id-type="pmid">17996079</pub-id></citation></ref><ref id="B14"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>LaFramboise</surname><given-names>T</given-names></name><name><surname>Weir</surname><given-names>BA</given-names></name><name><surname>Zhao</surname><given-names>X</given-names></name><name><surname>Beroukhim</surname><given-names>R</given-names></name><name><surname>Li</surname><given-names>C</given-names></name><name><surname>Harrington</surname><given-names>D</given-names></name><name><surname>Sellers</surname><given-names>WR</given-names></name><name><surname>Meyerson</surname><given-names>M</given-names></name></person-group><article-title>Allele-specific amplification in cancer revealed by SNP array analysis</article-title><source>PLoS Comput Biol</source><year>2005</year><volume>1</volume><fpage>e65</fpage><pub-id pub-id-type="pmid">16322765</pub-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.0010065</pub-id></citation></ref><ref id="B15"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>J</given-names></name><name><surname>Gromov</surname><given-names>P</given-names></name><name><surname>Gromova</surname><given-names>I</given-names></name><name><surname>Moreira</surname><given-names>J</given-names></name><name><surname>Timmermans-Wielenga</surname><given-names>V</given-names></name><name><surname>Rank</surname><given-names>F</given-names></name><name><surname>Wang</surname><given-names>K</given-names></name><name><surname>Li</surname><given-names>S</given-names></name><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Wiuf</surname><given-names>C</given-names></name><name><surname>Yang</surname><given-names>H</given-names></name><name><surname>Zhang</surname><given-names>X</given-names></name><name><surname>Bolund</surname><given-names>L</given-names></name><name><surname>Celis</surname><given-names>J</given-names></name></person-group><article-title>Omics-based profiling of carcinoma of the breast and matched regional lymph node metastasis</article-title><source>Proteomics</source><year>2008</year><volume>8</volume><fpage>5038</fpage><lpage>5052</lpage><pub-id pub-id-type="pmid">19003862</pub-id><pub-id pub-id-type="doi">10.1002/pmic.200800303</pub-id></citation></ref><ref id="B16"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lips</surname><given-names>EH</given-names></name><name><surname>van Eijk</surname><given-names>R</given-names></name><name><surname>de Graaf</surname><given-names>EJR</given-names></name><name><surname>Doornebosch</surname><given-names>PG</given-names></name><name><surname>de Miranda</surname><given-names>NFCC</given-names></name><name><surname>Oosting</surname><given-names>J</given-names></name><name><surname>Karsten</surname><given-names>T</given-names></name><name><surname>Eilers</surname><given-names>PHC</given-names></name><name><surname>Tollenaar</surname><given-names>RAEM</given-names></name><name><surname>van Wezel</surname><given-names>T</given-names></name><name><surname>Morreau</surname><given-names>H</given-names></name></person-group><article-title>Progression and tumor heterogeneity analysis in early rectal cancer</article-title><source>Clin Cancer Res</source><year>2008</year><volume>14</volume><fpage>772</fpage><lpage>81</lpage><pub-id pub-id-type="pmid">18245538</pub-id><pub-id pub-id-type="doi">10.1158/1078-0432.CCR-07-2052</pub-id></citation></ref><ref id="B17"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Olshen</surname><given-names>AB</given-names></name><name><surname>Venkatraman</surname><given-names>ES</given-names></name></person-group><article-title>Circular binary segmentation for the analysis of array-based DNA copy number data</article-title><source>Biostatistics</source><year>2004</year><volume>5</volume><fpage>557</fpage><lpage>572</lpage><pub-id pub-id-type="pmid">15475419</pub-id><pub-id pub-id-type="doi">10.1093/biostatistics/kxh008</pub-id></citation></ref><ref id="B18"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Willenbrock</surname><given-names>H</given-names></name><name><surname>Fridlyand</surname><given-names>J</given-names></name></person-group><article-title>A Comparison Study: Applying Segmentation to Array CGH Data for Downstream Analyses</article-title><source>Bioinformatics</source><year>2005</year><volume>21</volume><fpage>4084</fpage><lpage>4091</lpage><pub-id pub-id-type="pmid">16159913</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/bti677</pub-id></citation></ref></ref-list></back></article>