<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.0 20120330//EN" "JATS-archivearticle1.dtd"><article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Med Inform Decis Mak</journal-id><journal-title-group><journal-title>BMC Medical Informatics and Decision Making</journal-title></journal-title-group><issn pub-type="epub">1472-6947</issn><publisher><publisher-name>BioMed Central</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">19149886</article-id><article-id pub-id-type="pmc">2639573</article-id><article-id pub-id-type="publisher-id">1472-6947-9-4</article-id><article-id pub-id-type="doi">10.1186/1472-6947-9-4</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group></article-categories><title-group><article-title>Recursive least squares background prediction of univariate syndromic surveillance data</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="A1"><name><surname>Najmi</surname><given-names>Amir-Homayoon</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>najmi@jhuapl.edu</email></contrib><contrib contrib-type="author" id="A2"><name><surname>Burkom</surname><given-names>Howard</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>Howard.Burkom@jhuapl.edu</email></contrib></contrib-group><aff id="I1"><label>1</label>National Security Technology Department, The Johns Hopkins University Applied Physics Laboratory, Laurel, MD 20723-6099, USA</aff><pub-date pub-type="collection"><year>2009</year></pub-date><pub-date pub-type="epub"><day>16</day><month>1</month><year>2009</year></pub-date><volume>9</volume><fpage>4</fpage><lpage>4</lpage><history><date date-type="received"><day>27</day><month>6</month><year>2008</year></date><date date-type="accepted"><day>16</day><month>1</month><year>2009</year></date></history><permissions><copyright-statement>Copyright &#x000a9;2009 Najmi and Burkom; licensee BioMed Central Ltd.</copyright-statement><copyright-year>2009</copyright-year><copyright-holder>Najmi and Burkom; licensee BioMed Central Ltd.</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0"><license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p></license></permissions><self-uri xlink:href="http://www.biomedcentral.com/1472-6947/9/4"/><abstract><sec><title>Background</title><p>Surveillance of univariate syndromic data as a means of potential indicator of developing public health conditions has been used extensively. This paper aims to improve the performance of detecting outbreaks by using a background forecasting algorithm based on the adaptive recursive least squares method combined with a novel treatment of the Day of the Week effect.</p></sec><sec><title>Methods</title><p>Previous work by the first author has suggested that univariate recursive least squares analysis of syndromic data can be used to characterize the background upon which a prediction and detection component of a biosurvellance system may be built. An adaptive implementation is used to deal with data non-stationarity. In this paper we develop and implement the RLS method for background estimation of univariate data. The distinctly dissimilar distribution of data for different days of the week, however, can affect filter implementations adversely, and so a novel procedure based on linear transformations of the sorted values of the daily counts is introduced. Seven-days ahead daily predicted counts are used as background estimates. A signal injection procedure is used to examine the integrated algorithm's ability to detect synthetic anomalies in real syndromic time series. We compare the method to a baseline CDC forecasting algorithm known as the W2 method.</p></sec><sec><title>Results</title><p>We present detection results in the form of Receiver Operating Characteristic curve values for four different injected signal to noise ratios using 16 sets of syndromic data. We find improvements in the false alarm probabilities when compared to the baseline W2 background forecasts.</p></sec><sec><title>Conclusion</title><p>The current paper introduces a prediction approach for city-level biosurveillance data streams such as time series of outpatient clinic visits and sales of over-the-counter remedies. This approach uses RLS filters modified by a correction for the weekly patterns often seen in these data series, and a threshold detection algorithm from the residuals of the RLS forecasts. We compare the detection performance of this algorithm to the W2 method recently implemented at CDC. The modified RLS method gives consistently better sensitivity at multiple background alert rates, and we recommend that it should be considered for routine application in bio-surveillance systems.</p></sec></abstract></article-meta></front><body><sec><title>Background</title><p>Timely detection of an outbreak is a major goal of surveillance of public health data. Many techniques in the last several years have been developed to address anomaly detection in univariate time series. For instance, the CDC's current methods for time series aberration detection are based on Xbar and CUSUM control charts [<xref ref-type="bibr" rid="B1">1</xref>]. Others have used Auto-Regressive Integrated Moving Average (ARIMA) models [<xref ref-type="bibr" rid="B2">2</xref>], regression based models [<xref ref-type="bibr" rid="B3">3</xref>], and control charts based on Holt and Winters forecasting [<xref ref-type="bibr" rid="B5">5</xref>] with generalized exponential smoothing. We have selected the more recent CDC method known as the W2. The W2 method uses a fixed number of days (usually a multiple of 7) as a sliding window and tracks the mean value of the weekdays and weekends separately, with a 2 day buffer between the baseline and test data. [<xref ref-type="bibr" rid="B6">6</xref>].</p><p>Multistream (multivariate) anomaly detection has also received some attention in the hope that a major outbreak could have early indications in some streams. For example, over the counter medication sales as a potential early indicator of developing public health conditions, in particular in cases of interest to biosurvellance, has been suggested in the literature [<xref ref-type="bibr" rid="B7">7</xref>]. In such cases, and using multi stream data that have been shown to have correlations with the syndromic data of interest, a several-steps ahead forecast of the syndromic data is made using all available streams, and in most instances a threshold detector is used to indicate an outbreak. The reason for forecasting several steps ahead is that a next-step predictior has the risk of training on early signal effects, so that later and stronger signal effects will be within expected limits.</p><p>In a previous publication [<xref ref-type="bibr" rid="B8">8</xref>] we presented a prediction and detection method based on an adaptive recursive least squares filter applied to time series derived from emergency department (ED) and OTC data. We compared those predictions and detections with similar predictions that use the same method applied to the clinical data alone without referencing any other data streams. We found that when we used the past values of the syndromic time series alone to predict its future values, the prediction errors were consistently at least as low (in the sense of minmum squared error) as predictions using the reference (OTC) time series. Consequently we suggested that the univariate method can be a useful background predictor, which is the subject of the present paper. The method could be summarized as follows. A single syndromic time series is used for many-steps ahead predictions of itself. These predictions are used as estimates of the "normal" background behaviour of the syndromic data. A comparison between the estimated background value and the actual daily count (on a given day) is then used to declare the presence or the absence of an anomaly on that day.</p><p>The finite impulse response implementation of the background predictor is, however, adversely affected by several issues. Many syndromic time series have low counts, and in these cases any potential advantages over simpler methods are lost. So we limit our study to those syndromic series that have mean and median daily counts of more than 100. Seasonal fluctuations are sufficiently long in period that our adaptive methods are quite capable of handling. However, a strong Day of the Week effect (DOW) has too short a period, and we illustrate the DOW problem using the respiratory-1 syndromic data from military outpatient clinics of a major metropolitan area in the United States. We use a definition of Respiratory illness that can be defined as acute infection of the upper and/or lower respiratory tract, excluding chronic conditions such as chronic bronchitis, asthma, and sinusitis [<xref ref-type="bibr" rid="B4">4</xref>].</p><p>Figure <xref ref-type="fig" rid="F1">1</xref> shows the daily counts for a 3-year period 1994&#x02013;1997. The DOW effect is seen as the extreme drop in daily counts for Saturdays and Sundays. Another illustration of this effect is shown in figure <xref ref-type="fig" rid="F2">2</xref> which depicts the sorted values of the daily counts for each day of the week.</p><fig id="F1" position="float"><label>Figure 1</label><caption><p><bold>Respiratory 1 syndromic data</bold>.</p></caption><graphic xlink:href="1472-6947-9-4-1"/></fig><fig id="F2" position="float"><label>Figure 2</label><caption><p><bold>Respiratory 1 sorted syndromic data for different days of the week</bold>.</p></caption><graphic xlink:href="1472-6947-9-4-2"/></fig><p>Figure <xref ref-type="fig" rid="F2">2</xref> is constructed in the following way. Let <italic>d</italic><sub><italic>j </italic></sub>[<italic>n</italic>] denote the daily counts for day number <italic>j</italic>, <italic>j </italic>= 1,..., 7. With this notation, the 1<sup><italic>st </italic></sup>week's data would be <italic>d</italic><sub>1 </sub>[1], <italic>d</italic><sub>2 </sub>[1],..., <italic>d</italic><sub>7 </sub>[1]. Now we sort each {<italic>d</italic><sub><italic>j </italic></sub>[<italic>n</italic>], <italic>n </italic>= 1, 2,...} by their values, which are now depicted in figure <xref ref-type="fig" rid="F2">2</xref>. Note that a cumulative distribution function can be computed using these curves. For instance, if the number of days that daily counts of a given day number have not exceeded a given level, i.e. days for which <italic>d</italic><sub><italic>j </italic></sub>&#x02264; <italic>D</italic><sub><italic>j</italic></sub>, is denoted by <inline-formula><mml:math id="M1" name="1472-6947-9-4-i1" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>, then <inline-formula><mml:math id="M2" name="1472-6947-9-4-i2" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>p</mml:mi><mml:mo>{</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>&#x02264;</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>}</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mi>N</mml:mi></mml:mfrac></mml:mrow></mml:semantics></mml:math></inline-formula> where <italic>N </italic>is the the number of occurences of day of week <italic>j </italic>in the baseline. Denoting the syndromic time series on day number <italic>n </italic>by <italic>y</italic>[<italic>n</italic>] the k-step ahead prediction problem is to estimate future values of the clinical data <inline-formula><mml:math id="M3" name="1472-6947-9-4-i3" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula>[<italic>n </italic>+<italic>k</italic>], <italic>k </italic>&#x0003e; 0, using past days' values of the same clinical data. In the next section, we apply the individual day-of-week distribution functions above to enable recursive least squares (RLS) k-step ahead predictions for this estimate. The RLS method too is described in the next section [see additional file <xref ref-type="supplementary-material" rid="S1">1</xref>].</p></sec><sec sec-type="methods"><title>Methods</title><p>As indicated in the previous section we deal exclusively with syndromic time series whose mean and median daily counts are greater than 100 [e.g., see Table <xref ref-type="table" rid="T1">1</xref>]. The first step of our analysis is to normalize the data for the DOW effect. We use the first 30% of the time series to begin the process.</p><table-wrap id="T1" position="float"><label>Table 1</label><caption><p>Time series data from military clinics &#x02013; means and standard deviations</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Data Descriptor</th><th align="left">Mean</th><th align="left">SDev</th></tr></thead><tbody><tr><td align="left"><bold>Resp 1</bold></td><td align="left">335</td><td align="left">196</td></tr><tr><td colspan="3"><hr/></td></tr><tr><td align="left"><bold>Resp-City A-Military Prescriptions</bold></td><td align="left">829</td><td align="left">449</td></tr><tr><td colspan="3"><hr/></td></tr><tr><td align="left"><bold>Resp-City B-Civilian Office Visit</bold></td><td align="left">682</td><td align="left">277</td></tr><tr><td colspan="3"><hr/></td></tr><tr><td align="left"><bold>Resp-City C-Civilian Office Visit</bold></td><td align="left">448</td><td align="left">239</td></tr><tr><td colspan="3"><hr/></td></tr><tr><td align="left"><bold>Resp-City A-Civilian Office Visit</bold></td><td align="left">393</td><td align="left">242</td></tr><tr><td colspan="3"><hr/></td></tr><tr><td align="left"><bold>GI-City A-Military Prescriptions</bold></td><td align="left">373</td><td align="left">167</td></tr><tr><td colspan="3"><hr/></td></tr><tr><td align="left"><bold>Resp-City C-Military Prescriptions</bold></td><td align="left">368</td><td align="left">208</td></tr><tr><td colspan="3"><hr/></td></tr><tr><td align="left"><bold>Resp-City D-Military Prescriptions</bold></td><td align="left">359</td><td align="left">225</td></tr><tr><td colspan="3"><hr/></td></tr><tr><td align="left"><bold>Resp-City A-Military Outpatient Visit</bold></td><td align="left">352</td><td align="left">177</td></tr><tr><td colspan="3"><hr/></td></tr><tr><td align="left"><bold>Resp-City E-Civilian Office Visit</bold></td><td align="left">250</td><td align="left">196</td></tr><tr><td colspan="3"><hr/></td></tr><tr><td align="left"><bold>Resp-City C-Military Outpatient Visit</bold></td><td align="left">247</td><td align="left">131</td></tr><tr><td colspan="3"><hr/></td></tr><tr><td align="left"><bold>GI-City D-Military Prescriptions</bold></td><td align="left">247</td><td align="left">126</td></tr><tr><td colspan="3"><hr/></td></tr><tr><td align="left"><bold>Resp-City D-Civilian Office Visit</bold></td><td align="left">227</td><td align="left">138</td></tr><tr><td colspan="3"><hr/></td></tr><tr><td align="left"><bold>Resp-City E-Military Prescriptions</bold></td><td align="left">215</td><td align="left">122</td></tr><tr><td colspan="3"><hr/></td></tr><tr><td align="left"><bold>GI-City C-Military Prescriptions</bold></td><td align="left">214</td><td align="left">110</td></tr><tr><td colspan="3"><hr/></td></tr><tr><td align="left"><bold>Resp-City B-Military Prescriptions</bold></td><td align="left">186</td><td align="left">90</td></tr></tbody></table></table-wrap><p>The normalization method is based on the sorted data values shown in figure <xref ref-type="fig" rid="F2">2</xref>, and it is adaptive, in the sense that at each step new data enters the baseline and only the counts that are available are actually used. Figure <xref ref-type="fig" rid="F3">3</xref> shows only the first 365 days of the data used in this study. The middle 50%, is chosen and fit with a straight line. Figure <xref ref-type="fig" rid="F4">4</xref> is an example of this procedure, depicted for Thursdays. This process is performed for each day of the week and so 7 linear segments are found and stored. A median line is then determined by the respective medians of the 7 start points and the 7 end points. If the 7 lines are denoted by <italic>l</italic><sub><italic>j </italic></sub>[<italic>m</italic>], and the median line is denoted by <italic>L</italic>[<italic>m</italic>], then at each index <italic>m</italic>, a set of ratios are derived from</p><fig id="F3" position="float"><label>Figure 3</label><caption><p><bold>First year respiratory 1 sorted syndromic data for different days of the week</bold>.</p></caption><graphic xlink:href="1472-6947-9-4-3"/></fig><fig id="F4" position="float"><label>Figure 4</label><caption><p><bold>Correction method applied to Thursdays [1 year of data]</bold>.</p></caption><graphic xlink:href="1472-6947-9-4-4"/></fig><p><disp-formula id="bmcM1"><label>(1)</label><mml:math id="M4" name="1472-6947-9-4-i4" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>and applied to the sorted data values to obtain the normalized data with the day of the week effect removed:</p><p><disp-formula id="bmcM2"><label>(2)</label><mml:math id="M5" name="1472-6947-9-4-i5" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mi>d</mml:mi><mml:mi>j</mml:mi><mml:mi>c</mml:mi></mml:msubsup><mml:mo stretchy="false">[</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>Normalized data <inline-formula><mml:math id="M6" name="1472-6947-9-4-i6" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mi>d</mml:mi><mml:mi>j</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula>[<italic>m</italic>] are then sorted back to the original day index. Figure <xref ref-type="fig" rid="F5">5</xref> shows the normalized data, for separate days of the week, for the entire 3 years prior to resorting to the original dates. Figure <xref ref-type="fig" rid="F6">6</xref> shows the recombined data that have now been normalized for the day of the week effect and resorted to original dates.</p><fig id="F5" position="float"><label>Figure 5</label><caption><p><bold>Corrected respiratory 1 data prior to resorting [3 years of data]</bold>.</p></caption><graphic xlink:href="1472-6947-9-4-5"/></fig><fig id="F6" position="float"><label>Figure 6</label><caption><p><bold>Corrected respiratory 1 data resorted to original dates [3 years of data]</bold>.</p></caption><graphic xlink:href="1472-6947-9-4-6"/></fig><p>The process described above is performed on successive days and the output is used to make background predictions based on the recursive least squares method that we describe now. Denoting the clinical data time series on day number <italic>n </italic>by <italic>y</italic>[<italic>n</italic>] the N-step ahead prediction problem is to estimate future values of the clinical data <inline-formula><mml:math id="M7" name="1472-6947-9-4-i3" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula>[<italic>n </italic>+<italic>N</italic>], <italic>N </italic>&#x0003e; 0, using a linear prediction equation</p><p><disp-formula id="bmcM3"><label>(3)</label><mml:math id="M8" name="1472-6947-9-4-i7" overflow="scroll"><mml:semantics><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo stretchy="false">[</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mi>h</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>n</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>N</mml:mi><mml:mo>&#x0003e;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>and the recursive least squares method to compute the filter coefficients adaptively. The filter coefficients <italic>h</italic>[<italic>m</italic>] at day <italic>n </italic>are chosen by minimizing the following weighted sum of error terms (the performance index),</p><p><disp-formula id="bmcM4"><label>(4)</label><mml:math id="M9" name="1472-6947-9-4-i8" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>&#x003b5;</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msup><mml:mi>&#x003bb;</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mo>|</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo>|</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mstyle></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>includes a forgetting factor &#x003bb; (see the appendix) equivalent to a 4-week effective memory length <italic>n</italic><sub>&#x003bb;</sub>,</p><p><disp-formula id="bmcM5"><label>(5)</label><mml:math id="M10" name="1472-6947-9-4-i9" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>&#x003bb;</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mi>&#x003bb;</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mi>&#x003bb;</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>which corresponds to &#x003bb; = 0.9655 See the appendix for a description of the updating procedure. The RLS recursive solution, using finite impulse response (FIR) filters and described in detail in the appendix, is then used in the following algorithm: For a k-step ahead prediction of the background we compute multiple predictions for each day as follows. Denote the current step by <italic>n</italic>. Then using the available data we make the following predictions:</p><p><disp-formula id="bmcM6"><label>(6)</label><mml:math id="M11" name="1472-6947-9-4-i10" overflow="scroll"><mml:semantics><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>...</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo><mml:mo>&#x02192;</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>...</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>Thus in our method each day is predicted multiple times. Among the multiplicity of the error terms to be fed back into the recursive algorithm update equations, we have obtained better background estimates by using the error with the smallest magnitude.</p></sec><sec><title>Results and discussion</title><p>We have applied the methods of the previous section to several univariate data streams. The first data set is respiratory 1 syndromic data (defined earlier) from military outpatient clinics of a major metropolitan area in the United States. In figure <xref ref-type="fig" rid="F7">7</xref> the daily counts for a 3-year period 1994&#x02013;1997 are shown in red. The green plot is the output of a 7-days ahead background prediction using our weekday-corrected, recursive least squares prediction method, using a 1 year training period for the day of the week correction. The blue plot is the result of the CDC prediction method W2 with a baseline of 4 weeks and a gap of 1 week. Although it appears that the RLS predictions have started much earlier than those of the W2 method, these predictions are based on using the first year of data to make the day of the week corrections and so we exclude them in making comparisons with other methods. Consequently we begin the W2 background predictions and show those values after 1 calendar year. The RLS predictions are consistently better than the W2 specially during the periods when the data are rising. When the time series are falling, the predictions are very close to each other.</p><fig id="F7" position="float"><label>Figure 7</label><caption><p><bold>Respiratory 1 data prediction results</bold>.</p></caption><graphic xlink:href="1472-6947-9-4-7"/></fig><p>In order to better quantify the differences in the context of a biosurveillance alerting system, we performed an analysis of the detection performance of our method and compared them to one using the W2 predictions. This analysis was based on the injection of a log-normal signal into authentic time series of clinical visit counts. The signal type follows the observation of Sartwell [<xref ref-type="bibr" rid="B9">9</xref>] that the distribution of incubation periods of a point-source, common vehicle disease outbreak is approximately log-normal. The signal in this analysis was proportional to the deterministic form <inline-formula><mml:math id="M12" name="1472-6947-9-4-i11" overflow="scroll"><mml:semantics><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>log</mml:mi><mml:mo>&#x02061;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>/</mml:mo><mml:mn>10</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msup></mml:mrow></mml:semantics></mml:math></inline-formula>. This signal, depicted in figure <xref ref-type="fig" rid="F8">8</xref>, has a rise time of 3 days and a gradual fall time. The injection of the signal was multiplicative, with the resultant series computed as <italic>y</italic>(<italic>t</italic>){1 + &#x003b1;<italic>s</italic>(<italic>t</italic>)}. Our detector design is based on the multiplicative signal model. If the signal is present on day <italic>t</italic>, the daily count is <italic>y</italic>(<italic>t</italic>)(1 + &#x003b1;<italic>s</italic>), whereas when the signal is absent it is <italic>y</italic>(<italic>t</italic>). The test statistic is then the ratio of the two counts, which under ideal conditions is either 1 (signal absent) or 1 + &#x003b1; (signal present). The parameter &#x003b1; indicates the maximum signal level. Values of 0.25, 0.50, 0.75 and 1, corresponding to percent increases in counts of 25, 50, 75 and 100 were used.</p><fig id="F8" position="float"><label>Figure 8</label><caption><p><bold>Multiplicative signal</bold>.</p></caption><graphic xlink:href="1472-6947-9-4-8"/></fig><p>We chose the Respiratory-1 data consisting of 1402 consecutive authentic daily visit counts as our background time series. For each given day, the estimated (predicted) background was used to normalize the actual daily count for that day (a simple division), and the result thresholded at different levels. Note that the day under consideration matches the maximum signal level, in the sense that if day <italic>n </italic>is being tested for the presence or absence of the signal, then the signal injection would have been such that</p><p><disp-formula id="bmcM7"><label>(7)</label>data[<italic>n </italic>- <italic>T</italic><sub><italic>rise</italic></sub>: <italic>n </italic>+ <italic>T</italic><sub><italic>Fall</italic></sub>] = backgrond[<italic>n </italic>- <italic>T</italic><sub><italic>rise</italic></sub>: <italic>n </italic>+ <italic>T</italic><sub><italic>Fall</italic></sub>] &#x000d7; (1 + &#x003b1;<italic>s</italic>[*])</disp-formula></p><p>where <italic>T</italic><sub><italic>Rise </italic></sub>and <italic>T</italic><sub><italic>Fall </italic></sub>indicate the rise time and the fall time of the signal and the index <italic>n </italic>matches the index at which the signal <italic>s</italic>(<italic>t</italic>) is at its maximum value of 1.</p><p>A detection was recorded each time a threshold was exceeded. We found the probability of detection by dividing the total number of detections by the total number of available days, when the signal was actually present on the given day. Similarly, in the absence of the signal, a probability of false alarm was computed. The false alarm rate per number of days of interest was computed by multiplying the false alarm probability by the number of days of interest, e.g. the false alarm rate per week was found by multiplying the false alarm probability by 7.</p><p>Figure <xref ref-type="fig" rid="F9">9</xref>, shows 4 ROC (Receiver Operating Characteristic) curves [<xref ref-type="bibr" rid="B10">10</xref>] for the 4 different maximum signal values represented by the parameter &#x003b1;. The ROC curve relating to the RLS method is shown in red and that relating to the W2 method is shown in blue. Improvement at low false alarm probabilities are obtained with the RLS method described in this paper. The RLS results are exceptionally better than the baseline W2 method for the low signal maximum values (weak signals).</p><fig id="F9" position="float"><label>Figure 9</label><caption><p><bold>Respiratory 1 &#x02013; ROC curve &#x02013; RLS (red) vs W2 (blue)</bold>. The X-axis represents the number of false alarms every 28 days. Note that the Y-axis ranges are different for each plot.</p></caption><graphic xlink:href="1472-6947-9-4-9"/></fig><p>Next set of data consists of aggregated counts of syndromic surveillance data from the BioALIRT (Bio-Event Advanced Leading Indicator Recognition Technology) program that was conducted by DARPA [<xref ref-type="bibr" rid="B11">11</xref>]. This program was implemented during 2001&#x02013;2004 with the objective to develop technologies and prototypes for monitoring nontraditional data sources (e.g., animal sentinels, human behavioural indicators, and non-diagnostic medical data) that might enable public health authorities to detect terrorist release of a pathogen or toxin.</p><p>Data comprises three types of daily syndromic counts from ten large metropolitan areas: diagnoses from military clinics, filled military prescriptions, and civilian physician office visits. Out of the available 30 time series we selected 15 of them with the largest mean values, and they represent daily visit counts classified in Respiratory (Resp) and Gastrointestinal (GI) syndrome groups. These data together with their means and standard deviations are listed in Table <xref ref-type="table" rid="T1">1</xref>. The first row of Table <xref ref-type="table" rid="T1">1</xref> lists the values for the Respiratory 1 data of the first data set; rows 2 through 16 are the remaining 15 time series from the BioALIRT program. Same signal injections were performed, and ROC curves were computed. Figure <xref ref-type="fig" rid="F10">10</xref> shows the probabilities of detection for a fixed false alarm rate of one per week, for four different injection parameter values a. Better results, specially at the low values of a, over all 15 data sets are obtained using the RLS method.</p><fig id="F10" position="float"><label>Figure 10</label><caption><p><bold>Probabilities of detection for fixed false alarm rate of 1 per week, and &#x003b1; = 0.25, 0.5, 0.75 and 1, corresponding to maximum count increases of 25, 50, 75 and 100 percent &#x02013; RLS (red) vs W2 (blue) &#x02013; X-axis represents all 15 data sets (rows 2 through 16 of Table </bold><xref ref-type="table" rid="T1">1</xref><bold>)</bold>. [Note that the Y-axes have different ranges.].</p></caption><graphic xlink:href="1472-6947-9-4-10"/></fig></sec><sec><title>Conclusion</title><p>The current paper introduces a prediction approach for city-level biosurveillance data streams such as time series of outpatient clinic visits and over-the-counter remedy sales. This approach uses recursive-least-squares filters modified by a correction for the weekly patterns often seen in these data series. Unlike regression methods, these filters have the ability to adapt quickly to short-term trends, and this ability is essential for sensitivity to anomalies on a daily basis. Unlike some other adaptive methods based on autoregressive error modeling, this approach is applicable to many data types without detailed analysis. This flexibility is essential in surveillance applications.</p><p>For the study presented above, we formed a threshold detection algorithm from the residuals of these RLS forecasts. We compared the detection performance of this algorithm to the W2 method recently implemented at CDC. Like the day-of-week normalization above, the W2 method is a modification of the standard C2 aberration detector for improved handling of day-of-week effects. These 2 detectors were compared for power to detect realistic, simulated signals injected into each of a set of 16 actual datasets. These datasets were drawn from several sources, and the modified RLS-based method gave consistently better sensitivity at multiple background alert rates. Thus, this forecast technique should be further considered for routine application in biosurveillance systems.</p><p>Limitations of this modified RLS forecast method are the scale of time series required for application of the weekly pattern correction and the amount of data history required for useful filter coefficients. Regarding the necessary data scale, this forecaster gave improvements for time series with mean values as low as 30 counts per day, but informal tests have suggested that the method is applicable for lower scales as long as weekend counts do not drop off to zero. For the training data issue, 25% of the 700 days of the BioALIRT data-about a 6-month warmup-was used for the RLS forecasts in the simulation comparisons. The effective extent of these limitations and possible enhancements to overcome them are subjects for further research.</p><p>The RLS adaptation presented here should also be considered for multivariate forecasts. The adaptive modeling of cross-correlation effects combined with the ability to capture trends on a short time scale suggest a possible detection advantage over multivariate statistical process control charts. The increasing availability of multiple data sources emphasizes the need for tools that can effectively combine various types of statistical evidence.</p></sec><sec><title>Abbreviations</title><p>OTC: over the counter (medications); BioALIRT: Bio-Event Advanced Leading Indicator Recognition Technology; RLS: Recursive Least Squares.</p></sec><sec><title>Competing interests</title><p>The authors declare that they have no competing interests.</p></sec><sec><title>Authors' contributions</title><p>The idea of predicting clinical data using recursive least squares with feedback of minimum error among multiple looks, and the associated computer programs were developed by AHN. Data was provided by HB, who also wrote most of the conclusion, and contributed to the responses to the referees.</p></sec><sec><title>Pre-publication history</title><p>The pre-publication history for this paper can be accessed here:</p><p><ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1472-6947/9/4/prepub">http://www.biomedcentral.com/1472-6947/9/4/prepub</ext-link></p></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="S1"><caption><title>Additional file 1</title><p><bold>Recursive least squares prediction.</bold> Mathematical description of the algorithm for background prediction presented in this paper.</p></caption><media xlink:href="1472-6947-9-4-S1.pdf" mimetype="application" mime-subtype="pdf"><caption><p>Click here for file</p></caption></media></supplementary-material></sec></body><back><sec><title>Acknowledgements</title><p>This journal article was supported by Grant 1-R01-PH000024-01 from CDC. Its contents are solely the responsibility of the authors and do not necessarily represent the official views of CDC.</p></sec><ref-list><ref id="B1"><mixed-citation publication-type="journal"><name><surname>Hutwagner</surname><given-names>L</given-names></name><name><surname>Brown</surname><given-names>T</given-names></name><name><surname>Seeman</surname><given-names>GM</given-names></name><name><surname>Fleischauer</surname><given-names>AT</given-names></name><article-title>Comparing aberration detection methods with simulated data</article-title><source>Emerg Infect Dis</source><year>2005</year><volume>11</volume><issue>2</issue><fpage>314</fpage><lpage>316</lpage><pub-id pub-id-type="pmid">15752454</pub-id></mixed-citation></ref><ref id="B2"><mixed-citation publication-type="journal"><name><surname>Reis</surname><given-names>BY</given-names></name><name><surname>Mandl</surname><given-names>KD</given-names></name><article-title>Time series modelling for syndromic surveillance</article-title><source>BMC Med Inform Decis Mak</source><year>2003</year><volume>3</volume><issue>2</issue><pub-id pub-id-type="pmid">12542838</pub-id></mixed-citation></ref><ref id="B3"><mixed-citation publication-type="journal"><name><surname>Brillman</surname><given-names>JC</given-names></name><name><surname>Burr</surname><given-names>T</given-names></name><name><surname>Forslund</surname><given-names>D</given-names></name><name><surname>Joyce</surname><given-names>E</given-names></name><name><surname>Picard</surname><given-names>R</given-names></name><name><surname>Umland</surname><given-names>E</given-names></name><article-title>Modeling emergency department visit patterns for infectious disease complaints: results and application to disease surveillance</article-title><source>BMC Med Inform Decis Mak</source><year>2005</year><volume>5</volume><issue>4</issue><pub-id pub-id-type="pmid">15743535</pub-id></mixed-citation></ref><ref id="B4"><mixed-citation publication-type="other"><article-title>CDC Website</article-title><ext-link ext-link-type="uri" xlink:href="http://www.bt.cdc.gov/surveillance/syndromedef/word/syndromedefinitions.doc">http://www.bt.cdc.gov/surveillance/syndromedef/word/syndromedefinitions.doc</ext-link></mixed-citation></ref><ref id="B5"><mixed-citation publication-type="journal"><name><surname>Burkom</surname><given-names>HS</given-names></name><name><surname>Murphy</surname><given-names>SP</given-names></name><name><surname>Shmueli</surname><given-names>G</given-names></name><article-title>Automated time series forecasting for biosurveillance</article-title><source>Stat Med</source><year>2007</year><volume>26</volume><fpage>4204</fpage><lpage>4218</lpage><pub-id pub-id-type="doi">10.1002/sim.2835</pub-id></mixed-citation></ref><ref id="B6"><mixed-citation publication-type="other"><name><surname>Tokars</surname><given-names>J</given-names></name><name><surname>Burkom</surname><given-names>H</given-names></name><name><surname>Xing</surname><given-names>J</given-names></name><name><surname>English</surname><given-names>R</given-names></name><name><surname>Bloom</surname><given-names>S</given-names></name><name><surname>Hutwagner</surname><given-names>L</given-names></name><name><surname>Cox</surname><given-names>K</given-names></name><name><surname>Pavlin</surname><given-names>J</given-names></name><article-title>Enhancing time series monitoring algorithms for automated biosurveillance</article-title><source>Emerg Infect Dis</source><year>2008</year><comment> in press </comment></mixed-citation></ref><ref id="B7"><mixed-citation publication-type="journal"><name><surname>Najmi</surname><given-names>AH</given-names></name><name><surname>Magruder</surname><given-names>SF</given-names></name><article-title>Estimation of hospital emergency room data using otc pharmaceutical sales and least mean square filters</article-title><source>BMC Med Inform Decis Mak</source><year>2004</year><volume>4</volume><issue>5</issue><pub-id pub-id-type="pmid">15113417</pub-id></mixed-citation></ref><ref id="B8"><mixed-citation publication-type="journal"><name><surname>Najmi</surname><given-names>AH</given-names></name><name><surname>Magruder</surname><given-names>SF</given-names></name><article-title>An adaptive prediction and detection algorithm for multistream syndromic surveillance</article-title><source>BMC Med Inform Decis Mak</source><year>2005</year><volume>5</volume><issue>33</issue><pub-id pub-id-type="pmid">16221308</pub-id></mixed-citation></ref><ref id="B9"><mixed-citation publication-type="journal"><name><surname>Sartwell</surname><given-names>PE</given-names></name><article-title>The distribution of incubation periods of infectious disease</article-title><source>Am J Hyg</source><year>1950</year><volume>51</volume><fpage>310</fpage><lpage>318</lpage><pub-id pub-id-type="pmid">15413610</pub-id></mixed-citation></ref><ref id="B10"><mixed-citation publication-type="book"><name><surname>McDonogh</surname><given-names>RN</given-names></name><name><surname>Whalen</surname><given-names>AD</given-names></name><source>Detection of Signals in Noise</source><year>1995</year><edition>2</edition><publisher-name>New York: Academic Press</publisher-name></mixed-citation></ref><ref id="B11"><mixed-citation publication-type="journal"><name><surname>Siegrist</surname><given-names>D</given-names></name><name><surname>Pavlin</surname><given-names>J</given-names></name><article-title>Bio-ALIRT biosurveillance detection algorithm evaluation</article-title><source>MMWR Morb Mortal Wkly Rep</source><year>2004</year><volume>53</volume><issue>Suppl</issue><fpage>152</fpage><lpage>158</lpage><pub-id pub-id-type="pmid">15714645</pub-id></mixed-citation></ref></ref-list></back></article>