<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd"><article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article" xml:lang="EN"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id><journal-id journal-id-type="publisher-id">bioinformatics</journal-id><journal-id journal-id-type="hwp">bioinfo</journal-id><journal-title>Bioinformatics</journal-title><issn pub-type="ppub">1367-4803</issn><issn pub-type="epub">1460-2059</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">18974172</article-id><article-id pub-id-type="pmc">2639297</article-id><article-id pub-id-type="doi">10.1093/bioinformatics/btn562</article-id><article-id pub-id-type="publisher-id">btn562</article-id><article-categories><subj-group subj-group-type="heading"><subject>Original Papers</subject><subj-group><subject>Systems Biology</subject></subj-group></subj-group></article-categories><title-group><article-title>Reconstruction of transcriptional dynamics from gene reporter data using differential equations</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Finkenst&#x000e4;dt</surname><given-names>B&#x000e4;rbel</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref><xref ref-type="corresp" rid="COR1">*</xref></contrib><contrib contrib-type="author"><name><surname>Heron</surname><given-names>Elizabeth A.</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref><xref ref-type="aff" rid="AFF1"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Komorowski</surname><given-names>Michal</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref><xref ref-type="aff" rid="AFF1"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Edwards</surname><given-names>Kieron</given-names></name><xref ref-type="aff" rid="AFF1"><sup>3</sup></xref></contrib><contrib contrib-type="author"><name><surname>Tang</surname><given-names>Sanyi</given-names></name><xref ref-type="aff" rid="AFF1"><sup>2</sup></xref><xref ref-type="author-notes" rid="FN1"><sup>&#x02020;</sup></xref></contrib><contrib contrib-type="author"><name><surname>Harper</surname><given-names>Claire V.</given-names></name><xref ref-type="aff" rid="AFF1"><sup>4</sup></xref></contrib><contrib contrib-type="author"><name><surname>Davis</surname><given-names>Julian R. E.</given-names></name><xref ref-type="aff" rid="AFF1"><sup>5</sup></xref></contrib><contrib contrib-type="author"><name><surname>White</surname><given-names>Michael R. H.</given-names></name><xref ref-type="aff" rid="AFF1"><sup>4</sup></xref></contrib><contrib contrib-type="author"><name><surname>Millar</surname><given-names>Andrew J.</given-names></name><xref ref-type="aff" rid="AFF1"><sup>3</sup></xref></contrib><contrib contrib-type="author"><name><surname>Rand</surname><given-names>David A.</given-names></name><xref ref-type="aff" rid="AFF1"><sup>2</sup></xref></contrib></contrib-group><aff id="AFF1"><sup>1</sup>Department of Statistics, University of Warwick, Coventry, CV4 7AL, <sup>2</sup>Systems Biology Centre, University of Warwick, Coventry, CV4 7AL, <sup>3</sup>Institute for Molecular Plant Sciences, University of Edinburgh, Edinburgh EH9 3JH, <sup>4</sup>Department of Biology, University of Liverpool and <sup>5</sup>School of Medicine, University of Manchester, Liverpool, Manchester</aff><author-notes><corresp id="COR1">*To whom correspondence should be addressed.</corresp><fn id="FN1"><p><sup>&#x02020;</sup>Present address: College of Mathematical and Information Science, Shaanxi Normal University, Xi'an 710062, P.R. China.</p></fn><fn><p>Associate Editor: Jonathan Wren</p></fn></author-notes><pub-date pub-type="ppub"><day>15</day><month>12</month><year>2008</year></pub-date><pub-date pub-type="epub"><day>30</day><month>10</month><year>2008</year></pub-date><pub-date pub-type="pmc-release"><day>30</day><month>10</month><year>2008</year></pub-date><volume>24</volume><issue>24</issue><fpage>2901</fpage><lpage>2907</lpage><history><date date-type="received"><day>24</day><month>7</month><year>2008</year></date><date date-type="rev-recd"><day>1</day><month>10</month><year>2008</year></date><date date-type="accepted"><day>25</day><month>10</month><year>2008</year></date></history><permissions><copyright-statement>&#x000a9; 2008 The Author(s)</copyright-statement><copyright-year>2008</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/"><p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">http://creativecommons.org/licenses/by-nc/2.0/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</p></license></permissions><abstract><p><bold>Motivation:</bold> Promoter-driven reporter genes, notably luciferase and green fluorescent protein, provide a tool for the generation of a vast array of time-course data sets from living cells and organisms. The aim of this study is to introduce a modeling framework based on stochastic differential equations (SDEs) and ordinary differential equations (ODEs) that addresses the problem of reconstructing transcription time-course profiles and associated degradation rates. The dynamical model is embedded into a Bayesian framework and inference is performed using Markov chain Monte Carlo algorithms.</p><p><bold>Results:</bold> We present three case studies where the methodology is used to reconstruct unobserved transcription profiles and to estimate associated degradation rates. We discuss advantages and limits of fitting either SDEs ODEs and address the problem of parameter identifiability when model variables are unobserved. We also suggest functional forms, such as on/off switches and stimulus response functions to model transcriptional dynamics and present results of fitting these to experimental data.</p><p><bold>Contact:</bold> <email>b.f.finkenstadt@warwick.ac.uk</email></p><p><bold>Supplementary Information:</bold> <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn562/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p></abstract></article-meta></front><body><sec sec-type="intro" id="SEC1"><title>1 INTRODUCTION</title><p>Imaging data from luciferase (LUC) and green fluorescent protein (GFP) reporters combined with fluorescent tagging of protein can provide very high quality data with good temporal resolution (Millar <italic>et al.</italic>, <xref ref-type="bibr" rid="B15">1995</xref>; Nelson <italic>et al.</italic>, <xref ref-type="bibr" rid="B17">2004</xref>). In this case the actual imaging time series is approximately proportional to the abundance of an artificial protein. The underlying transcriptional dynamics are unobserved and are masked by two degradation processes, namely of reporter mRNA and reporter protein. In this study, we address the problem of back-calculating from the observed protein activity to the hidden transcriptional dynamics where it is of interest to estimate the associated rates of degradation as part of the analysis. We formulate a probability model based on (stochastic) differential equations which provides the mechanistic rules for the back-calculation. In practise heterogeneous datasets may be available from different experiments which contain information about the transcription process and model parameters. Data sources may be of different quality and time resolution, as well as from single cells or an aggregated population of cells. Longitudinal measurements are discrete in time and can be irregularly spaced or on different time scales for different variables. Other realistic shortcomings of the data are that time-course measurements may not correspond to the same biological sample, or data on different variables may not be matched in time which would be preferable for fitting a multivariate dynamical model. As the quality and quantity of such datasets supports more or less complex modeling approaches, we consider both stochastic differential equations (SDEs) and ordinary differential equations (ODEs) with measurement noise. Information on rate constants may be incorporated through prior distributions in a Bayesian approach. We first describe the models and the statistical methods used for its inference. Then, we present three case studies each with the aim of reconstructing transcription and inferring any identifiable degradation rates from reporter gene data using available heterogeneous sources of data. These case studies serve to demonstrate the adaption of the methodology to different experimental scenarios.</p></sec><sec id="SEC2"><title>2 MODELS AND INFERENCE</title><p>It is now well understood that, because of the stochastic nature of reaction events and the presence of internal noise due to the fluctuations in the molecular environment of the cell, regulatory and signalling systems are intrinsically stochastic. To develop a stochastic model one can attempt to model the individual stochastic events involved, such as binding of the transcription factors, the assembly and initiation of the polymerase and transcription. Although an exact simulation algorithm of the corresponding stochastic processes is provided by Gillespie (<xref ref-type="bibr" rid="B5">1977</xref>, <xref ref-type="bibr" rid="B6">1992</xref>) such models are too detailed for there to be any hope of fitting to current data with its limitations. SDEs provide a good approximation of molecular population systems when one can assume that there is a macroscopic time scale for which (i) the event rates can be regarded as constant and (ii) there are many events of each type. An example of formulating and fitting an autoregulatory feedback system with transcriptional delay as a system of SDEs can be found in Heron <italic>et al.</italic> (<xref ref-type="bibr" rid="B9">2007</xref>). However, if the data are too sparsely sampled in time to reveal information about the volatility process, or if measurements are not realizations of the same continuous stochastic process in a cell, then the assumption of SDEs can be problematic in estimation. Simpler modeling approaches based on ODEs to represent the mean process with an additional stochastic error may provide a useful vehicle for estimation purposes at least in systems that have relatively regular and stable dynamics. The formulation of ODEs to model the dynamics of molecular population processes has become a widespread tool in systems biology [see, for example, systems studied in Goldbeter (<xref ref-type="bibr" rid="B7">2002</xref>), Jensen <italic>et al.</italic> (<xref ref-type="bibr" rid="B10">2003</xref>) and (Locke <italic>et al.</italic>, <xref ref-type="bibr" rid="B13">2005a</xref>, <xref ref-type="bibr" rid="B14">2005b</xref>)], and early statistically less rigorous attempts in obtaining kinetic parameters from GFP reporter data can be found in Ronen <italic>et al.</italic> (<xref ref-type="bibr" rid="B18">2002</xref>) and Kalir and Alon (<xref ref-type="bibr" rid="B11">2004</xref>).</p><p>Here, we consider the following dynamic model as the mechanistic backbone for the reconstruction of transcription profiles from reporter protein data<disp-formula id="M1"><label>(1)</label><graphic xlink:href="btn562m1.jpg" position="float"/></disp-formula>where <italic>M</italic> denotes the abundance of mRNA molecules and <italic>P</italic> denotes the abundance of the corresponding protein. The first equation describes the dynamics of mRNA molecules where transcription is given by a non-negative function &#x003c4;(<italic>t</italic>). The second equation states that the protein is synthesized at a rate proportional to the abundance of mRNA. The mRNA and the protein are degraded (or leave their molecular compartment otherwise) at time scales with mean 1/&#x003b4;<sub><italic>m</italic></sub> and 1/&#x003b4;<sub><italic>p</italic></sub>, respectively. The aim is to infer the transcription function &#x003c4;(<italic>t</italic>) and possibly other rate constants of the system given time-series data proportional to one or both variables of the system. Suppose that we measure <italic>M</italic>,<italic>P</italic> proportionally to their population size, <italic>s</italic><sub><italic>M</italic></sub><italic>M</italic>(<italic>t</italic>) for the mRNA and <italic>s</italic><sub><italic>P</italic></sub><italic>P</italic>(<italic>t</italic>) for the reporter protein. Reparameterizing (<xref ref-type="disp-formula" rid="M1">1</xref>) gives a scaled model which is identical to (<xref ref-type="disp-formula" rid="M1">1</xref>) with scaled terms for &#x003b1; and &#x003c4; (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn562/DC1">Supplementary Material</ext-link>). However, degradation rates are not affected by scaling. Let <bold>Y</bold>={<italic>y</italic><sub><italic>i</italic></sub>}<sub><italic>i</italic>=1</sub><sup><italic>T</italic></sup>={<italic>M</italic>(<italic>t</italic><sub><italic>i</italic></sub>), <italic>P</italic>(<italic>t</italic><sub><italic>i</italic></sub>)}<sub><italic>i</italic>=1</sub><sup><italic>T</italic></sup> denote experimental time-series data observed at discrete time points. In order to obtain a likelihood function that incorporates the mechanistic rules in (<xref ref-type="disp-formula" rid="M1">1</xref>) we consider two approaches. One is the SDE approach where (<xref ref-type="disp-formula" rid="M1">1</xref>) is formulated as an appropriate system of SDEs. This approach is rigorously modeling the volatility of the stochastic dynamics of the kinetic processes provided that the assumptions of the SDE approximation itself are valid. It is very challenging to incorporate additional measurement error unless its variance is known or assumed. The second is the mean ODE approach where we assume that a solution path to (<xref ref-type="disp-formula" rid="M1">1</xref>) represents the mean of a stochastic process whilst the modeler makes assumptions about the probability distribution of the residual process. This approach is less exact than the SDE approach in modeling the volatility of the underlying stochastic interaction between molecules. On the other hand, it naturally deals with measurement error and might also be useful for fitting to datasets which do not comply with the SDE assumption, for example, if data points are averages over replicates, come from different samples and/or represent a population of cells. We now introduce the two approaches and their likelihood derivation in more detail.</p><p><italic>SDE approach</italic>: here, <italic>M</italic> and <italic>P</italic> are random variables of molecular population sizes and the rates of increase and decrease in model (<xref ref-type="disp-formula" rid="M1">1</xref>) are event probabilities of birth and death processes at the individual molecular level. One can derive the following It&#x000f4; SDEs (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn562/DC1">Supplementary Material</ext-link>)<disp-formula id="M2"><label>(2)</label><graphic xlink:href="btn562m2.jpg" position="float"/></disp-formula>where &#x003b6;<sub><italic>M</italic></sub>(<italic>t</italic>, &#x003b8;)=&#x003c4;(<italic>t</italic>)&#x02212;&#x003b4;<sub><italic>m</italic></sub><italic>M</italic>(<italic>t</italic>), &#x003b6;<sub><italic>P</italic></sub>(<italic>t</italic>, &#x003b8;)=&#x003b1;<italic>M</italic>(<italic>t</italic>)&#x02212;&#x003b4;<sub><italic>P</italic></sub><italic>P</italic>(<italic>t</italic>), and &#x003c3;<sub><italic>M</italic></sub>(<italic>t</italic>)=<italic>s</italic><sub><italic>M</italic></sub><sup>1/2</sup> (&#x003c4;(<italic>t</italic>)+&#x003b4;<sub><italic>m</italic></sub><italic>M</italic>(<italic>t</italic>))<sup>1/2</sup>, &#x003c3;<sub><italic>P</italic></sub>(<italic>t</italic>)=<italic>s</italic><sub><italic>P</italic></sub><sup>1/2</sup> (&#x003b1;<italic>M</italic>(<italic>t</italic>)+&#x003b4;<sub><italic>P</italic></sub><italic>P</italic>(<italic>t</italic>))<sup>1/2</sup> are drift and volatility functions, respectively, and <italic>W</italic><sub><italic>M</italic></sub> and <italic>W</italic><sub><italic>P</italic></sub> are independent Wiener processes.<xref ref-type="fn" rid="FN2"><sup>1</sup></xref> Here and throughout the article, &#x003b8; is used to denote a vector of model parameters. If <italic>M</italic> and <italic>P</italic> are indirect measurements of molecular populations in the sense that they are proportional to molecular abundance with factors <italic>s</italic><sub><italic>M</italic></sub>, <italic>s</italic><sub><italic>P</italic></sub> then these factors arise as additional parameters in the volatility functions and their estimation will be extremely useful allowing us to calibrate the model to the population level. Given data <bold>Y</bold> the likelihood function for the diffusion process is<disp-formula id="M3"><label>(3)</label><graphic xlink:href="btn562m3.jpg" position="float"/></disp-formula>where <italic>f</italic>(<italic>y</italic><sub><italic>i</italic>+1</sub>&#x02223;<italic>y</italic><sub><italic>i</italic></sub>;&#x003b8;) denotes the transition density of <italic>y</italic><sub><italic>i</italic>+1</sub> given y<sub><italic>i</italic></sub>, that is the joint probability distribution of <italic>M</italic>(<italic>t</italic><sub><italic>i</italic>+1</sub>) and <italic>P</italic>(<italic>t</italic><sub><italic>i</italic>+1</sub>) given present values, under parameter vector &#x003b8;. The exact transition density function for solutions of SDEs is rarely available in analytical form and usually approximations have to be considered. If the time-step &#x00394; <italic>t</italic><sub><italic>i</italic></sub>=<italic>t</italic><sub><italic>i</italic>+1</sub>&#x02212;<italic>t</italic><sub><italic>i</italic></sub> is small then a good approximation is given by assuming that, conditional on past values,<disp-quote><p>(*) Increments <bold>y</bold>(<italic>t</italic><sub><italic>i</italic>+1</sub>)&#x02212;<bold>y</bold>(<italic>t</italic><sub><italic>i</italic></sub>) are bivariate normal with mean vector &#x003b6;(<italic>t</italic><sub><italic>i</italic></sub>)&#x00394; <italic>t</italic><sub><italic>i</italic></sub> and variance matrix &#x003a3;(<italic>t</italic><sub><italic>i</italic></sub>)&#x00394;<italic>t</italic><sub><italic>i</italic></sub> where &#x003b6;(<italic>t</italic><sub><italic>i</italic></sub>)=(&#x003b6;<sub><italic>M</italic></sub>(<italic>t</italic><sub><italic>i</italic></sub>), &#x003b6;<sub><italic>P</italic></sub>(<italic>t</italic><sub><italic>i</italic></sub>)), &#x003a3;(<italic>t</italic><sub><italic>i</italic></sub>)=diag(&#x003c3;<sub><italic>M</italic></sub><sup>2</sup>(<italic>t</italic><sub><italic>i</italic></sub>), &#x003c3;<sub><italic>P</italic></sub><sup>2</sup>(<italic>t</italic><sub><italic>i</italic></sub>)) are the drift and volatility functions as defined above.</p></disp-quote>Thus, for sufficiently small sampling intervals &#x00394;<italic>t</italic><sub><italic>i</italic></sub> the likelihood function can be approximated by a product of the form<disp-formula id="M4"><label>(4)</label><graphic xlink:href="btn562m4.jpg" position="float"/></disp-formula>where &#x003a6;(<italic>x</italic>; &#x003bc;, &#x003a3;) denotes the bivariate normal density function with mean vector &#x003bc; and variance matrix &#x003a3;. Justifications for this approximation are given in Kloeden and Platen (<xref ref-type="bibr" rid="B12">1999</xref>).</p><p><italic>Mean ODE approach</italic>: suppose there is a solution path &#x003bc;(<italic>t</italic>; &#x003b8;)=(<italic>M</italic>(<italic>t</italic>), <italic>P</italic>(<italic>t</italic>); &#x003b8;) to the system in (<xref ref-type="disp-formula" rid="M1">1</xref>) from unknown initial conditions (<italic>M</italic><sub>0</sub>, <italic>P</italic><sub>0</sub>). Then a natural probabilistic model is to assume that <bold>Y</bold> has a joint distribution with mean function &#x003bc;(<italic>t</italic>; &#x003b8;) and a variance function &#x003c3;<sup>2</sup>(<italic>t</italic>; &#x003b8;). The distribution function and variance are specified according to assumptions that the modeler makes about the residual process and measurement error. If the error process is assumed independent then the likelihood in the mean ODE approach is<disp-formula id="M5"><label>(5)</label><graphic xlink:href="btn562m5.jpg" position="float"/></disp-formula>where &#x003b8; now incorporates initial conditions (<italic>M</italic><sub>0</sub>, <italic>P</italic><sub>0</sub>) and <italic>g</italic> is a suitably chosen probability distribution.</p><p><italic>Inference</italic>: by Bayes' theorem the posterior distribution is<disp-formula id="M6"><label>(6)</label><graphic xlink:href="btn562m6.jpg" position="float"/></disp-formula>where <italic>L</italic> is the likelihood function, derived for either the ODE or SDE approach, and &#x003c0;(&#x003b8;) are prior densities of model parameters. Sampling from the posterior distribution is usually achieved using Markov chain Monte Carlo (MCMC), where each element of &#x003b8; is updated by using an appropriately constructed Metropolis&#x02013;Hastings acceptance/rejection scheme based on either random walk or independence proposals (Gamerman and Lopes, <xref ref-type="bibr" rid="B4">2006</xref>). The reason for choosing a Bayesian approach combined with a MCMC algorithm is 2-fold: first, the Bayesian methodology is flexible allowing for portability of inference results between different experimental studies in a well-defined way and this is highly relevant to studies in systems biology. Second, the probabilistic imputation of missing data and/or unobserved variables can be implemented in a straightforward way as part of an MCMC sampler.</p><p><italic>Discrete data and unobserved variables</italic>: molecular time-series data are discretely measured and it cannot be guaranteed that the sampling interval is small enough for the approximation (*) to work well. A remedy suggested in econometric applications of SDEs (Durham and Gallant, <xref ref-type="bibr" rid="B2">2002</xref>; Elerian <italic>et al.</italic>, <xref ref-type="bibr" rid="B3">2001</xref>) is to augment the observed data by introducing a number of latent or unobserved data points, called a <italic>bridge</italic>, in-between the measurements with the aim of creating a virtual fine discrete time grid for which the assumption in (*) is valid. The bridges are treated as missing or latent data. Let <italic>Y</italic>* denote the collection of all latent data. We wish to sample from the joint posterior <italic>f</italic>(&#x003b8;, <italic>Y</italic>*&#x02223;<italic>Y</italic>) of the parameters &#x003b8; and the latent variables <italic>Y</italic>* given the data <italic>Y</italic>, using the fact that, by Bayes' theorem,<disp-formula id="M7"><label>(7)</label><graphic xlink:href="btn562m7.jpg" position="float"/></disp-formula>where <italic>L</italic>(<italic>Y</italic>*, <italic>Y</italic>&#x02223;&#x003b8;) is the approximated augmented likelihood. This is achieved by sampling in turn from the full-conditional densities of &#x003b8;&#x02223;<italic>Y</italic>*, <italic>Y</italic> and <italic>Y</italic>*&#x02223;&#x003b8;, <italic>Y</italic> (Tanner and Wong, <xref ref-type="bibr" rid="B19">1987</xref>). Thus, in the framework of an MCMC, one can generate proposal bridge processes and accept these with an appropriately constructed acceptance probability. In practise, we have used (Heron <italic>et al.</italic>, <xref ref-type="bibr" rid="B9">2007</xref>) a bridging method based on an independence sampler suggested by Elerian <italic>et al.</italic> (<xref ref-type="bibr" rid="B3">2001</xref>) (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn562/DC1">Supplementary Material</ext-link>). The treatment of other forms of missing data, such as unobserved variables as part of the inference algorithm is theoretically the same. In practise, this is challenging as the dimension of the posterior density in (<xref ref-type="disp-formula" rid="M7">7</xref>) can become very large. We present applications of bridge building and stochastic reconstruction of unobserved processes in our case studies. One also needs to decide upon the size of a virtual sampling interval for which one can safely assume that (*) holds. Since there are no analytical results we base our choice on Monte Carlo studies of simulated systems.</p></sec><sec id="SEC3"><title>3 CASE STUDIES</title><sec id="SEC3.1"><title>3.1 Case study 1: red light pulse experiment</title><p>The <italic>Arabidopsis thaliana</italic> gene Chlorophyll A/B binding Protein 2 <italic>CAB2</italic> is regulated by light and the circadian clock (Millar and Kay, <xref ref-type="bibr" rid="B16">1996</xref>). The aim here is to estimate degradation rate of <italic>CAB2</italic> mRNA and to reconstruct the transcriptional dynamics of the <italic>CAB2:LUC</italic> reporter gene as a result of a 20 min red-light induction. At subjective dawn on the 6th day of the experiment (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn562/DC1">Supplementary Material</ext-link> for a description of experiment), the grown <italic>Arabidopsis</italic> seedlings were given a 20 min red light pulse to induce <italic>CAB2</italic> expression. Samples were harvested at the indicated time points and total RNA and total protein was extracted. Steady-state levels of <italic>LUC</italic> mRNA were measured by quantitative PCR (Q-PCR) and an <italic>in vitro</italic> LUC assay was used to measure LUC activity in the protein samples. Concurrently, red light-pulsed seedlings were also imaged for LUC activity using light sensitive cameras (Millar <italic>et al.</italic>, <xref ref-type="bibr" rid="B15">1995</xref>). This allows the measurement of LUC activity within the same seedlings throughout the entire experiment, whereas the <italic>in vitro</italic> LUC assays and Q-PCR experiments necessarily sacrificed different samples for each time point. All data are probes from whole leaves (plots of all time series in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn562/DC1">Supplementary Material</ext-link>) representing cell populations and the activity of the clock gene can be assumed to be synchronized between cells by the light pulse. There are three replicates of each measurement variable sampled every half hour for a length of 7 h. Matching control replicates that have not been subject to light induction were sampled for the same time length albeit more sparsely for the Q-PCR and <italic>in vitro</italic> assay data.</p><p>Assuming that molecular populations all scale differently with the Q-PCR, <italic>in vitro</italic> and <italic>in vivo</italic> imaging data, we use (<xref ref-type="disp-formula" rid="M1">1</xref>) to describe the dynamics of mRNA and imaged LUC protein and add a third equation<disp-formula id="M8"><label>(8)</label><graphic xlink:href="btn562m8.jpg" position="float"/></disp-formula>which represents the protein dynamics measured by the <italic>in vitro</italic> LUC protein assays (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn562/DC1">Supplementary Material</ext-link> for full model statement). The two protein equations are identical except for differently scaled translation rates &#x003b1;<sub><italic>P</italic></sub> and &#x003b1;<sub><italic>P</italic><sub><italic>v</italic></sub></sub>. Furthermore, a constant <italic>c</italic><sub><italic>P</italic></sub> is added to the imaging data to represent some threshold level at which the camera is able to detect a signal. To specify a form for the transcription &#x003c4;(<italic>t</italic>) consider an indicator function <italic>L</italic>(<italic>t</italic>)=1 for the time of the red light pulse, and <italic>L</italic>(<italic>t</italic>)=0 otherwise [<italic>L</italic>(<italic>t</italic>)=0 for all control experiments]. The response of mRNA transcription to the stimulus can then be modeled as a convolution of <italic>L</italic>(<italic>t</italic>) and <italic>d</italic>(<italic>u</italic>) which is a probability density for the waiting time <italic>u</italic> between the pulse and the initiation of transcription, i.e.<disp-formula id="M9"><label>(9)</label><graphic xlink:href="btn562m9.jpg" position="float"/></disp-formula>where <inline-formula><inline-graphic xlink:href="btn562i1.jpg"/></inline-formula> represents a baseline transcription. We take <italic>d</italic>(<italic>u</italic>) to be a Gamma density with mean &#x003bc;<sub>&#x00393;</sub> and SD &#x003c3;<sub>&#x00393;</sub> to be estimated. The specification in (<xref ref-type="disp-formula" rid="M9">9</xref>) is motivated by the fact that it successfully reproduced the qualitative features observed in the data in preliminary model simulations and because <italic>d</italic> is flexible. Since data are from aggregated cell populations, the imaged protein data are very smooth and successive data points of the Q-PCR and <italic>in vitro</italic> time series come from different samples of cell populations, we choose to fit the model using the mean ODE approach with independent error. To ensure all variables are strictly non-negative, we used an independent Gamma distribution for <italic>g</italic> in the likelihood (<xref ref-type="disp-formula" rid="M9">9</xref>) for each of the three variables where parameters were specified to have mean process equal to an ODE solution and time constant variance &#x003c3;<sub><italic>M</italic></sub><sup>2</sup>, &#x003c3;<sub><italic>P</italic></sub><sup>2</sup>, &#x003c3;<sub><italic>Pv</italic></sub><sup>2</sup>. Applying (<xref ref-type="disp-formula" rid="M5">5</xref>) the likelihood of replicate <italic>r</italic>=1,2,3 is<disp-formula id="M10"><label>(10)</label><graphic xlink:href="btn562m10.jpg" position="float"/></disp-formula>where <italic>y</italic><sub><italic>i</italic></sub><sup><italic>r</italic>,<italic>R</italic></sup> is the vector of observed data points <italic>i</italic>=1,&#x02026;,<italic>T</italic><sup><italic>R</italic></sup> for variables <italic>M</italic>, <italic>P</italic>, <italic>P</italic><sub><italic>v</italic></sub> for replicate <italic>r</italic> under the red light experiment, <italic>y</italic><sub><italic>j</italic></sub><sup><italic>r</italic>,<italic>C</italic></sup> denotes observed data points <italic>j</italic>=1,&#x02026;,<italic>T</italic><sup><italic>C</italic></sup> for the corresponding control experiment and <italic>g</italic> is a product of Gamma densities. The ODE model was fitted to each of the replicates <italic>r</italic>=1,2,3 and to the average of the replicates where prior distributions for all parameters were chosen to be uninformative. Results of posterior estimates are summarized in <xref ref-type="table" rid="T1">Table 1</xref> and the model fit can be seen in <xref ref-type="fig" rid="F1">Figure 1</xref>. The mean delay time between light induction and transcription is about 2 h with almost all transcription happening between 0.8 h and 3.2 h after the pulse. Convergence of the Markov chains for parameters associated with the Gamma delay is relatively quick and precise. Chains for &#x003b1;<sub><italic>M</italic></sub> and &#x003b4;<sub><italic>M</italic></sub> are correlated and convergence for these is slower. The half life of <italic>LUC</italic> mRNA is estimated to be around 0.5 h with some small variation between replicates. In contrast, the chains for &#x003b4;<sub><italic>L</italic></sub> converged quickly due to the abundance and smoothness of the imaging data. Protein half life was estimated to be around 2&#x02013;2.5 h. Although the control data do not seem very dynamic they are useful in inferring the base rates of transcription and translation. If the control series are omitted from the analysis these rates were estimated with considerably less precision and slower convergence due to correlations.<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>This figure shows mean ODE fit for average data (data points given by big dots) of red light pulse experiment. <italic>LUC</italic> mRNA (top left), LUC activity <italic>in vitro</italic> (bottom left) and imaging the luminescence from LUC protein (top right) under two experimental conditions: with and without red light pulse. Solid lines give the mean ODE fit using mean posterior estimates for the parameters. The 95% credible intervals (dashed lines) are shown for the control experiments. The reconstructed transcription profile &#x003c4;(<italic>t</italic>) is shown in the bottom right panel (the area between dashed lines gives 95% central values of the transcription profile for 10 000 iterations of the Markov chain).</p></caption><graphic xlink:href="btn562f1"/></fig><table-wrap id="T1" position="float"><label>Table 1.</label><caption><p>Case 1: posterior results for selected parameters</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Parameter</th><th rowspan="1" colspan="1">Average</th><th rowspan="1" colspan="1">r1</th><th rowspan="1" colspan="1">r2</th><th rowspan="1" colspan="1">r3</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">&#x003b4;<sub><italic>M</italic></sub></td><td rowspan="1" colspan="1">1.542 (0.019)</td><td rowspan="1" colspan="1">1.726 (0.044)</td><td rowspan="1" colspan="1">1.417 (0.121)</td><td rowspan="1" colspan="1">3.526 (0.315)</td></tr><tr><td rowspan="1" colspan="1">half-life</td><td rowspan="1" colspan="1">0.45 h</td><td rowspan="1" colspan="1">0.4 h</td><td rowspan="1" colspan="1">0.49 h</td><td rowspan="1" colspan="1">0.2 h</td></tr><tr><td rowspan="1" colspan="1">&#x003bc;<sub>&#x00393;</sub></td><td rowspan="1" colspan="1">2.008 (0.011)</td><td rowspan="1" colspan="1">2.101 (0.014)</td><td rowspan="1" colspan="1">1.902 (0.045)</td><td rowspan="1" colspan="1">2.362 (0.0289)</td></tr><tr><td rowspan="1" colspan="1">&#x003c3;<sub>&#x00393;</sub></td><td rowspan="1" colspan="1">0.631 (0.013)</td><td rowspan="1" colspan="1">0.692 (0.014)</td><td rowspan="1" colspan="1">0.686 (0.039)</td><td rowspan="1" colspan="1">0.723 (0.0217)</td></tr><tr><td rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btn562i2.jpg"/></inline-formula></td><td rowspan="1" colspan="1">0.012 (0.001)</td><td rowspan="1" colspan="1">0.014 (0.001)</td><td rowspan="1" colspan="1">0.014 (0.002)</td><td rowspan="1" colspan="1">0.013 (0.002)</td></tr><tr><td rowspan="1" colspan="1">&#x003b4;<sub><italic>P</italic></sub></td><td rowspan="1" colspan="1">0.305 (0.0045)</td><td rowspan="1" colspan="1">0.286 (0.0040)</td><td rowspan="1" colspan="1">0.272 (0.010)</td><td rowspan="1" colspan="1">0.365 (0.0093)</td></tr><tr><td rowspan="1" colspan="1">half-life</td><td rowspan="1" colspan="1">2.27 h</td><td rowspan="1" colspan="1">2.42 h</td><td rowspan="1" colspan="1">2.5 h</td><td rowspan="1" colspan="1">1.9 h</td></tr></tbody></table><table-wrap-foot><fn><p>Posterior means and SDs of selected estimated parameters (See <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn562/DC1">Supplementary Material</ext-link> for all parameters), where the red light pulse model was fitted to average data and to single replicate datasets denoted by r1, r2, r3. Estimated rates are per hour. Degradation rates are translated into half-lives as follows: half-life (in hours)=ln(2)/degradation rate (per hour).</p></fn></table-wrap-foot></table-wrap></p></sec><sec id="SEC3.2"><title>3.2 Case study 2: a switch model for CCA1</title><p>The Circadian Clock associated 1 (CCA1) gene in <italic>A.thaliana</italic> has been identified as one of the core genes of the circadian clock (Wang and Tobin, <xref ref-type="bibr" rid="B20">1998</xref>). In this case study, we show results for the reconstruction of an ON/OFF switching transcription profile from the following two experimental datasets:<list list-type="order"><list-item><p>Native mRNA Q-PCR data: Q-PCR measurements were taken at 2 h intervals over 72 h on CCA1 mRNA entrained under a photoperiod of 18 h before being released into constant light. The data used are an average of concentrations relative to the start of two biological replicates.</p></list-item><list-item><p>Protein imaging: high resolution imaging data for a different experiment with identical conditions as for data (1) were sampled at 1.5 h intervals over a length of 91.5 h on LUC protein activity resulting from <italic>LUC</italic> reporter constructs fused to the CCA1 promoter. Similar to case study 1, all data come from whole leaves and thus represent a population of cells where the activity of the clock gene is synchronized between cells during the exposure to dark, light cycles during the entrainment period (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn562/DC1">Supplementary Material</ext-link> for further details of experiment). The data used are an average of concentrations relative to the start of 20 replicates.<xref ref-type="fn" rid="FN3"><sup>2</sup></xref></p></list-item></list>No data were available for the <italic>CCA1:LUC</italic> mRNA. However, if we assume that <italic>CCA1:LUC</italic> and <italic>CCA1</italic> mRNA have the same transcriptional dynamics, then the available two time series are connected in a dynamic model with three variables where <italic>LUC</italic> mRNA and LUC protein dynamics are described by (<xref ref-type="disp-formula" rid="M1">1</xref>) and a further equation<disp-formula id="M11"><label>(11)</label><graphic xlink:href="btn562m11.jpg" position="float"/></disp-formula>is added for the native <italic>CCA1</italic> mRNA. We assume that observed variables are proportional to <italic>M</italic><sub><italic>g</italic></sub> and <italic>P</italic> populations with scaling factors <italic>s</italic><sub><italic>M</italic><sub><italic>g</italic></sub></sub> and <italic>s</italic><sub><italic>P</italic></sub>, while <italic>M</italic> is unobserved. To describe the oscillatory nature of the data, we consider an ON/OFF switching function for the transcription &#x003c4;(<italic>t</italic>)=&#x003c4;<sub>on</sub> if transcription is active at time <italic>t</italic>, and &#x003c4;(<italic>t</italic>)=&#x003c4;<sub>off</sub> if transcription is inactive. This function has the advantage of being interpretable and parsimonious. If it produces realistic oscillations then its simple structure makes it an interesting ingredient to models of larger networks. Let <italic>Sw</italic>=(<italic>s</italic><sub>1</sub>,&#x02026;,<italic>s</italic><sub><italic>R</italic></sub>) where <italic>s</italic><sub>1</sub> &#x0003c; <italic>s</italic><sub>2</sub> &#x0003c; &#x000b7;&#x000b7;&#x000b7; &#x0003c; <italic>s</italic><sub><italic>R</italic></sub> are the times at which a switching between an ON and OFF state occurs. They are estimated as part of the MCMC algorithm where we assume that the number of switches and the initial state are known.<xref ref-type="fn" rid="FN4"><sup>3</sup></xref> To set the phase of the clock both the data series experienced a light&#x02013;dark (LD) cycle of 18 h of L and 6 h of D at the beginning of the sampling period and this seems to generate a higher amplitude. We allow for this by setting the transcription on-rate to <italic>p</italic><sub><italic>d</italic></sub>&#x003c4;<sub>on</sub> during the first 35 h (allowing also for some delayed effect of the dark period). For purpose of estimation, the mean ODE approach will be appropriate for similar reasons as case study 1. However, an SDE approach is a superior theoretical model that should be considered even if data do not (yet) strictly comply with its underlying assumptions. We use this case study to show the application of both approaches.</p><p><italic>SDE approach</italic>: consider a system of SDEs formulated analogously to (<xref ref-type="disp-formula" rid="M2">2</xref>). Since <italic>M</italic> is unobserved it can be imputed stochastically as realizations of the SDE but the cost of computation is high. Simulation studies suggested that the more practicable way of imputing <italic>M</italic> as solution to an ODE from an initial condition <italic>M</italic><sub>0</sub> to be estimated had no discernable impact on our inference results here. In order to fit an SDE model to discrete data points for <italic>M</italic><sub><italic>g</italic></sub> and <italic>P</italic>, we augment the coarse grid to a virtually fine grid [for which assumption (*) is valid] by imputing auxiliary data in the form of bridges. Let &#x003b8;=(<italic>Sw</italic>, &#x003c4;<sub><italic>on</italic></sub>, &#x003c4;<sub><italic>off</italic></sub>, &#x003b4;<sub><italic>M</italic><sub><italic>g</italic></sub></sub>, <italic>M</italic><sub>0</sub>, &#x003b4;<sub><italic>M</italic></sub>, <italic>S</italic><sub><italic>M</italic><sub><italic>g</italic></sub></sub>, &#x003b1;, &#x003b4;<sub><italic>P</italic></sub>, <italic>S</italic><sub><italic>P</italic></sub>) denote the vector of unknown parameters and let <italic>M</italic><sub><italic>g</italic></sub><sup>*</sup> and <italic>P</italic>* be the auxiliary data for <italic>M</italic><sub><italic>g</italic></sub> and <italic>P</italic>, respectively. Then according to (<xref ref-type="disp-formula" rid="M7">7</xref>) the posterior distribution for the unknown (&#x00398;, <italic>M</italic><sub><italic>g</italic></sub><sup>*</sup>, <italic>P</italic>* is given by<disp-formula><graphic xlink:href="btn562um1.jpg" position="float"/></disp-formula>where we approximate <italic>L</italic>(<italic>M</italic><sub><italic>g</italic></sub>, <italic>P</italic>, <italic>M</italic><sub><italic>g</italic></sub><sup>*</sup>, <italic>P</italic>*&#x02223;&#x003b8;) with the augmented likelihood in (<xref ref-type="disp-formula" rid="M4">4</xref>) for small sampling intervals for all observed and auxiliary data, i.e. <bold>y</bold>=(<italic>M</italic><sub><italic>g</italic></sub>, <italic>P</italic>, <italic>M</italic><sub><italic>g</italic></sub><sup>*</sup>, <italic>P</italic>*). More details of the SDE inference algorithm are provided in the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn562/DC1">Supplementary Material</ext-link>.</p><p><italic>Mean ODE approach</italic>: here the likelihood is given by (<xref ref-type="disp-formula" rid="M5">5</xref>) where the unobserved variable <italic>M</italic> is reconstructed as a solution of an ODE from an initial condition <italic>M</italic><sub>0</sub> to be estimated. The density <italic>g</italic> was specified to be the product of two independent normal distributions with mean equal to the joint ODE solutions for <italic>M</italic><sub><italic>g</italic></sub> and <italic>P</italic> and with variance parameters &#x003c3;<sub><italic>M</italic><italic>g</italic></sub><sup>2</sup> and &#x003c3;<sub><italic>P</italic></sub><sup>2</sup>. We have set &#x003c4;<sub>off</sub>=0 for the off-time as initial estimations showed that it was not different from zero.<xref ref-type="fn" rid="FN5"><sup>4</sup></xref> As the variables are concentrations relative to initial conditions the ODE solutions are assumed to start at one. Thus, the parameter vector for the mean ODE approach is &#x003b8;=(<italic>Sw</italic>, &#x003c4;<sub>on</sub>, &#x003c4;<sub>off</sub>, &#x003b4;<sub><italic>M</italic><sub><italic>g</italic></sub></sub>, <italic>M</italic><sub>0</sub>, &#x003b4;<sub><italic>M</italic></sub>, &#x003b1;, &#x003b4;<sub><italic>P</italic></sub>, &#x003c3;<sub><italic>M</italic><sub><italic>g</italic></sub></sub>, &#x003c3;<sub><italic>P</italic></sub>).</p><p>To ensure identifiability in both estimation approaches the prior distribution for <italic>CCA1:LUC</italic> mRNA degradation &#x003b4;<sub><italic>M</italic></sub> has to be informative. We hence used a Gamma distribution with mean 1.542 and SD 0.019, corresponding to the results in <xref ref-type="table" rid="T1">Table 1</xref>. All other priors were taken independently uniform in an attempt to estimate all remaining parameters only from the experimental data at hand. Posterior estimates are given in <xref ref-type="table" rid="T2">Table 2</xref>. <xref ref-type="fig" rid="F2">Figure 2</xref> shows the transcription profiles and model fits for both approaches. The plots suggest that the switch model is remarkably able at reproducing the observed oscillations. The main feature of the reconstructed profiles is that the inactive times (around 15&#x02013;18 h) are at least twice as long as the active times (around 7 h) and this produces the pronounced asymmetric cycles in the protein and mRNA time series. The estimates also suggest that there is a shorter but larger burst of transcription during the dark period. Both approaches deliver similar posterior rates for degradation. Our results for <italic>CCA1</italic> mRNA degradation are in remarkable agreement with the analysis in Yakir <italic>et al.</italic> (<xref ref-type="bibr" rid="B21">2007</xref>) whose estimates correspond to 0.23 in darkness to 0.46 in light for &#x003b4;<sub><italic>M</italic><sub><italic>g</italic></sub></sub>. Both approaches reliably estimate the half-life of the LUC protein to be around 9.5 h. This is surprisingly long and is probably due to a lack in provision of luciferin. The most notable difference between the two approaches lies in the variance estimation. The SDE approach has to deal with the estimation of the two scaling parameters, <italic>s</italic><sub><italic>P</italic></sub> and <italic>s</italic><sub><italic>M</italic><sub><italic>g</italic></sub></sub>. We find that their identification from the experimental data is problematic as convergence could not achieved although this did not affect convergence of all other parameters. The two scaling parameters were thus sampled within some chosen bounded region of parameter space. In particular, in order for the bridge sampling to remain numerically stable for low values of the mRNA series, the sampling of <italic>s</italic><sub><italic>M</italic><sub><italic>g</italic></sub></sub> had to be bounded to artificially low values. The identifiability problem of the scaling parameters leads to problems in realistically quantifying the volatility. The estimated intervals in <xref ref-type="fig" rid="F2">Figure 2</xref> illustrate this for the mRNA series. For the mean ODE approach variability is measured by the posterior standard error of the fit similar to a regression and the graph shows that predictions can be made more precisely about the protein dynamics than about the native mRNA. This is reflecting the fact that the protein data are more aggregated and smoother time series than the mRNA series.<fig id="F2" position="float"><label>Fig. 2.</label><caption><p>Results of fitting SDEs (left) and ODEs (right) in case study 2. Top panel shows the mean reconstructed transcription profile &#x003c4;(<italic>t</italic>) using the switch approximation. Middle panel shows results for <italic>M</italic><sub><italic>g</italic></sub>. Bottom panel gives results for <italic>P</italic>. Big dots are experimental data for <italic>M</italic><sub><italic>g</italic></sub> (middle panel) and <italic>P</italic> (bottom panel). The variation is shown as follows: for SDE approach (left): solid lines in middle and bottom panel give the 5%, mean and 95% values computed from 10 000 simulations of the SDE (using mean posterior parameter estimates). For ODE approach (right): solid lines corresponds to the mean ODE fit (using mean posterior parameter estimates) plus/minus twice the mean posterior standard error.</p></caption><graphic xlink:href="btn562f2"/></fig><table-wrap id="T2" position="float"><label>Table 2.</label><caption><p>Case 2: posterior results for selected parameters</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">(&#x003b4;<sub><italic>M</italic><sub><italic>g</italic></sub></sub>)</th><th rowspan="1" colspan="1">(&#x003b4;<sub><italic>M</italic></sub>)</th><th rowspan="1" colspan="1">(&#x003b4;<sub><italic>P</italic></sub>)</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">SDE</td><td rowspan="1" colspan="1">0.426 (0.0043)</td><td rowspan="1" colspan="1">1.54 (0.019)</td><td rowspan="1" colspan="1">0.072 (0.0057)</td></tr><tr><td rowspan="1" colspan="1">ODE</td><td rowspan="1" colspan="1">0.313 (0.0273)</td><td rowspan="1" colspan="1">1.42 (0.101)</td><td rowspan="1" colspan="1">0.075 (0.0018)</td></tr></tbody></table><table-wrap-foot><fn><p>Posterior mean and standard error estimates of selected parameters of model in case 2 using the SDE and mean ODE approach. All rates are per hour. Estimates for all parameters and switch times are provided in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn562/DC1">Supplementary Material</ext-link>.</p></fn></table-wrap-foot></table-wrap></p></sec><sec id="SEC3.3"><title>3.3 Case study 3: Stochastic transcription for single cell data</title><p>In this experiment protein activity was imaged from GH3 rat pituitary cells stably transfected with a construct comprising a 5 kb human prolactin gene promoter fragment linked to a destabilized EGFP reporter gene (hPRL-d2EGFP) (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn562/DC1">Supplementary Material</ext-link> for details of experiment). Images were taken 108 times in 15 min intervals giving a total of 27 h of data for a single cell (<xref ref-type="fig" rid="F3">Fig. 3</xref>). We assume that the dynamics are described by the SDE model in (<xref ref-type="disp-formula" rid="M2">2</xref>). Since <italic>M</italic> is not observed we cannot identify the degradation rates (&#x003b4;<sub><italic>M</italic></sub>, &#x003b4;<sub><italic>P</italic></sub>) and a strongly informative prior density is needed. Here, we assume that each of them have an independent Gamma distribution with mean 0.4 for &#x003b4;<sub><italic>M</italic></sub> and 0.5 for &#x003b4;<sub><italic>P</italic></sub>.<xref ref-type="fn" rid="FN6"><sup>5</sup></xref> The prior variance was arbitrarily chosen to be small at 0.02 for both parameters. Since <italic>M</italic> is unobserved we can arbitrarily fix <italic>s</italic><sub><italic>M</italic></sub>=1. Given the particular form of an experiment, where transcription is induced and afterwards comes back to its initial level, we have specified &#x003c4;(<italic>t</italic>) as follows<disp-formula id="M12"><label>(12)</label><graphic xlink:href="btn562m12.jpg" position="float"/></disp-formula>where the parameters <italic>b</italic><sub><italic>i</italic></sub> are to be estimated. Priors for parameters different than degradation rates were intended to be uninformative. Here, we used exponential priors with means given in <xref ref-type="table" rid="T3">Table 3</xref>. The challenge for inference here is to integrate over a fully unobserved process <italic>M</italic> whilst sampling bridges to augment the discretely observed <italic>P</italic>. Let <italic>P</italic>* denote the vector of bridges augmenting the <italic>P</italic> process and <italic>M</italic>* denote the latent <italic>M</italic> variable [we chose a grid size of 1 min for which we assume that (*) holds]. The vector of unknown parameters is &#x003b8;=(&#x003b4;<sub><italic>M</italic></sub>, &#x003b4;<sub><italic>P</italic></sub>, &#x003b1;, <italic>s</italic><sub><italic>P</italic></sub>, <italic>b</italic><sub>0</sub>, <italic>b</italic><sub>1</sub>, <italic>b</italic><sub>2</sub>, <italic>b</italic><sub>3</sub>, <italic>b</italic><sub>4</sub>). The posterior distribution takes the form<disp-formula id="M13"><label>(13)</label><graphic xlink:href="btn562m13.jpg" position="float"/></disp-formula>where we approximate <italic>L</italic>(<italic>M</italic>*, <italic>P</italic>*, <italic>P</italic>&#x02223;&#x00398;) with the likelihood (<xref ref-type="disp-formula" rid="M4">4</xref>) for the augmented data case, i.e. <bold>y</bold>=(<italic>M</italic>*, <italic>P</italic>*, <italic>P</italic>). In practise, this is a challenging sampling problem as the dimension of the posterior is very large and traces were highly autocorrelated. Faster convergence is achieved by reparameterizing the model (details of this and the algorithm are given in the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn562/DC1">Supplementary Material</ext-link>). The algorithm was first tested on simulated data from the SDE model with chosen parameters (<xref ref-type="table" rid="T3">Table 3</xref>). Artificial data are simulated on a fine scale of 15/51 min and coarse data are extracted for <italic>P</italic> at 15 min intervals. The simulated and observed time series, and the reconstructed &#x003c4;(<italic>t</italic>) are shown in <xref ref-type="fig" rid="F3">Figure 3</xref>. Posterior inference results are given in <xref ref-type="table" rid="T3">Table 3</xref>. Note that since <italic>M</italic> is not scaled the transcription profile corresponds to molecular population sizes which here are about 150 mRNA molecules per hour. This case study demonstrates that for high frequency single cell data the SDE approach can be extremely powerful as it allows estimation of absolute transcription rates in terms of molecule numbers and since <italic>s</italic><sub><italic>P</italic></sub> can be estimated it is possible to calculate back to molecular levels of protein and translation rate. The need for precise prior information about degradation rates is irrespective of either SDE or ODE approach. The problem of non-identifiability of these parameters is due to not observing <italic>M</italic> as one can infer both degradation rates in either approach if both <italic>M</italic> and <italic>P</italic> are observed.<table-wrap id="T3" position="float"><label>Table 3.</label><caption><p>Case 3: posterior inference results</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">Value</th><th rowspan="1" colspan="1">Prior</th><th rowspan="1" colspan="1">Simulation</th><th rowspan="1" colspan="1">Experiment</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">&#x003b4;<sub><italic>M</italic></sub></td><td rowspan="1" colspan="1">0.44</td><td rowspan="1" colspan="1">&#x00393;(0.44,0.02)</td><td rowspan="1" colspan="1">0.56 (0.36&#x02013;0.92)</td><td rowspan="1" colspan="1">0.45 (0.26&#x02013;0.82)</td></tr><tr><td rowspan="1" colspan="1">&#x003b4;<sub><italic>P</italic></sub></td><td rowspan="1" colspan="1">0.52</td><td rowspan="1" colspan="1">&#x00393;(0.52,0.02)</td><td rowspan="1" colspan="1">0.59 (0.38&#x02013;0.89)</td><td rowspan="1" colspan="1">0.71 (0.45&#x02013;1.09)</td></tr><tr><td rowspan="1" colspan="1">&#x003b1;</td><td rowspan="1" colspan="1">20</td><td rowspan="1" colspan="1">Exp(100)</td><td rowspan="1" colspan="1">16.97 (6.54&#x02013;78.98)</td><td rowspan="1" colspan="1">0.46 (0.14&#x02013;1.51)</td></tr><tr><td rowspan="1" colspan="1"><italic>s</italic><sub><italic>P</italic></sub></td><td rowspan="1" colspan="1">0.2</td><td rowspan="1" colspan="1">Exp(1)</td><td rowspan="1" colspan="1">0.17 (0.09&#x02013;0.3)</td><td rowspan="1" colspan="1">2.11 (1.24&#x02013;3.56)</td></tr></tbody></table><table-wrap-foot><fn><p>Priors, posterior medians and 95% credibility intervals inferred from both simulated and experimental data. Rates are per hour. &#x00393;(&#x003bc;, &#x003c3;<sup>2</sup>) denotes Gamma distribution with mean &#x003bc; and variance &#x003c3;<sup>2</sup>. Full list of all parameter estimates is provided in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn562/DC1">Supplementary Material</ext-link>.</p></fn></table-wrap-foot></table-wrap><fig id="F3" position="float"><label>Fig. 3.</label><caption><p>Left: Time series of fluorescence intensity used in case study 3. Solid and dashed lines represent experimental and simulated data, respectively. The variation of the SDE fit to the real data is shown by the 5% and 95% values computed from 1000 simulations of the SDE (using mean posterior parameter estimates). Right: Box-plot representing transcription profile in molecules per hour inferred from experimental data presented in the top figure. Each box represents 50% credibility interval and median of posterior distribution of the reconstructed transcription rate at particular time point.</p></caption><graphic xlink:href="btn562f3"/></fig></p></sec></sec><sec sec-type="discussion" id="SEC4"><title>4 DISCUSSION</title><p>In this study, we suggest a dynamical model relating protein and corresponding mRNA dynamics via transcription and translation and suggest methods for model fitting. The applications here were motivated by the availability of gene reporter data but the model and methodology apply to many other scenarios where it is of interest to link protein and mRNA dynamics. While a stochastic model, such as (<xref ref-type="disp-formula" rid="M2">2</xref>) applies to single cell data, caution needs to be exercised in formulating an ODE model, such as (<xref ref-type="disp-formula" rid="M1">1</xref>) for multi-cell data. In order to reasonably assume such a joint mechanistic model it is essential that the individual cell activities are synchronized with respect to the gene of interest. Rate constants associated with processes of degradation, transcription and translation arise as model parameters and it is an important question whether these can be identified. In addition to a functional kind of non-identifiability of parameters in complex dynamic models as considered in Hengl <italic>et al.</italic> (<xref ref-type="bibr" rid="B8">2007</xref>) here, we find that practical or statistical non-identifiability of model parameters may result from unobserved variables. Case study 1 demonstrates that one can estimate all rate constants in systems of equations of the type given in (<xref ref-type="disp-formula" rid="M1">1</xref>) if all model variables&#x02014;albeit coarse&#x02014;are observed over time. Inference precision increases with the frequency at which the processes are sampled. In contrast, Cases 2 and 3 have latent variables and model inference is only feasible with informative prior knowledge of some parameters. Simulation studies of the model (using artificial parameters) help in identifying which sets of parameters need to be informed from other experiments. In case 3, prior knowledge of both degradation rates was needed as with <italic>M</italic> unobserved, parameters can trade-off giving rise to protein dynamics that is virtually indistinguishable via likelihood from the observed protein process. The specification of the functional form for the transcription profile also plays a role in practical identification. Even if <italic>M</italic> is observed the parameter estimates associated with transcription and degradation are correlated for obvious reasons. Such correlations affect precision of estimates and convergence of the Markov chain but can be alleviated by sampling more frequently, choosing a parsimonious functional form for transcription, and by technical aids such as the construction of independence samplers and reparameterization of the model. We believe that the functional specifications for &#x003c4;(<italic>t</italic>) suggested in our case studies are useful in conjunction with gene transcription. A theoretical application of the switch function in clock modeling can be found in Aase and Ruoff (<xref ref-type="bibr" rid="B1">2008</xref>). Although the estimation of the switch model seems too high dimensional for datasets with many switches, this could be overcome by assigning probability distributions to the on- and off-times in the framework of a Bayesian hierarchical model.</p><p>Our results demonstrate that MCMC methods for ODEs and SDEs provide practical algorithms for reconstruction transcription profiles whilst estimating some of the rate parameters involved. As the real population dynamics are naturally stochastic SDEs provide the superior theoretical model. However, the mean ODE approach can be useful as a vehicle for estimation when the data are not fully compatible with the SDE assumptions. Whilst they usually describe the same model in the mean, their difference lies in the specification of the variance. The SDE model provides a rigid description of the volatility process which is rigorously derived for the stochastic dynamics of the molecular processes. In theory, it is straightforward to allow for additive measurement error [see Heron <italic>et al.</italic> (<xref ref-type="bibr" rid="B9">2007</xref>) for estimation of SDEs with measurement error]. However, identification of an unknown measurement error variance is difficult and&#x02014;to our knowledge&#x02014;is not possible when the data are coarse and indirectly measured with unknown scaling factors. The variance process of the mean ODE approach is not rigorously derived and can be specified by the modeler in an attempt to capture anything known about the residual process and measurement error. Estimation algorithms for the mean ODE approach are straightforward to implement although for higher dimensional or less stable systems more difficulties may occur. The algorithm for SDE estimation can be challenging to implement due to bridge sampling and is computationally expensive. Case 2 shows a problem that we have also encountered in Heron <italic>et al.</italic> (<xref ref-type="bibr" rid="B9">2007</xref>), namely if molecular populations are measured indirectly then the estimation of unknown scaling parameters can be difficult in practise. This may happen as a consequence of observing data that are too coarse, in the sense that too little information about the volatility process is revealed, or that are otherwise not directly compatible with the SDE assumption. However, drawbacks of the SDE approach are associated with the current quality, quantity and availability of the data. Case study 3 exemplifies that SDE estimation constitutes a very informative approach in calibrating all processes back to the molecular population levels as the scaling parameters can be identified. Under suitable assumptions the SDE model provides a theoretically well-founded modeling approach for describing the dynamics of molecular populations in a single cell. Estimation of SDEs is well studied and feasible and is highly informative when relatively frequent and clean (i.e. with little measurement error) single cell data are available on all model variables.</p><p><italic>Funding</italic>: This research was funded by BBSRC and EPSRC (Inter-disciplinary Programme for Cellular Regulation GR/S29256/01) and EU (BIOSIM Network Contract 005137). The Millar group's work (K.E. and A.J.M.) was funded by BBSRC via award E015263 and CSBE (Centre for Integrative and Systems Biology funded by BBSRC and EPSRC). D.A.R. is funded by EPSRC Senior Research Fellowship EP/C544587/1 and M.K. by studentship, Department of Statistics, University of Warwick. C.V.H. was funded by Wellcome Trust Programme Grant (067252, to J.R.E.D. and M.R.H.W.) and now is recipient of The Prof. John Glover Memorial Postdoctoral Fellowship.</p><p><italic>Conflict of Interest</italic>: none declared.</p></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material id="PMC_1" content-type="local-data"><caption><title>[Supplementary Data]</title></caption><media mimetype="text" mime-subtype="html" xlink:href="btn562_index.html"/><media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="btn562_1.pdf"/></supplementary-material></sec></body><back><fn-group><fn id="FN2"><p><sup>1</sup>The Wiener process, or Brownian motion, is a continuous time stochastic process that has independent normally distributed increments.</p></fn><fn id="FN3"><p><sup>2</sup>For computational precision, we amplified the mRNA concentrations by factor 10<sup>5</sup> and the protein concentrations by 10<sup>4</sup>.</p></fn><fn id="FN4"><p><sup>3</sup>The number of switches and initial state are fairly obvious here. The inference algorithm can, however, be generalized to allow for an arbitrary number of switches and where the initial state is estimated. We will describe work on this elsewhere.</p></fn><fn id="FN5"><p><sup>4</sup>We could not set &#x003c4;<sub>off</sub>=0 in the SDE case for the practical problem that the bridge building algorithm becomes numerically unstable for values of the mRNA too close to zero.</p></fn><fn id="FN6"><p><sup>5</sup>These rates were motivated by preliminary estimation using a small dataset from other experiments. They are used here only to demonstrate the case as their estimates may change if more data were available.</p></fn></fn-group><ref-list><title>REFERENCES</title><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Aase</surname><given-names>SO</given-names></name><name><surname>Ruoff</surname><given-names>P</given-names></name></person-group><article-title>Semi-algebraic optimization of temperature compensation in a general switch-type negative feedback model of circadian clocks</article-title><source>J. Math. Biol.</source><year>2008</year><volume>56</volume><fpage>279</fpage><lpage>292</lpage><pub-id pub-id-type="pmid">17704919</pub-id></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Durham</surname><given-names>GB</given-names></name><name><surname>Gallant</surname><given-names>AR</given-names></name></person-group><source>J. Bus. Econ. Stat</source><year>2002</year><volume>20</volume><fpage>297</fpage><lpage>316</lpage></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Elerian</surname><given-names>O</given-names></name><etal/></person-group><article-title>Likelihood inference for discretely observed non-linear diffusions</article-title><source>Econometrica</source><year>2001</year><volume>69</volume><fpage>959</fpage><lpage>993</lpage></citation></ref><ref id="B4"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Gamerman</surname><given-names>D</given-names></name><name><surname>Lopes</surname><given-names>HF</given-names></name></person-group><source>Markov Chain Monte Carlo Stochastic Simulation for Bayesian Inference.</source><year>2006</year><edition>2nd edn</edition><publisher-loc>Boca Raton, London, New York</publisher-loc><publisher-name>Chapman &#x00026; Hall/CRC</publisher-name></citation></ref><ref id="B5"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Gillespie</surname><given-names>DT</given-names></name></person-group><article-title>Exact stochastic simulation of coupled chemical reactions</article-title><source>J. Phys. Chem.</source><year>1977</year><volume>81</volume><fpage>2340</fpage><lpage>2361</lpage></citation></ref><ref id="B6"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Gillespie</surname><given-names>DT</given-names></name></person-group><article-title>A rigorous derivation of the chemical master equation</article-title><source>Physica A</source><year>1992</year><volume>188</volume><fpage>404</fpage><lpage>425</lpage></citation></ref><ref id="B7"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Goldbeter</surname><given-names>A</given-names></name></person-group><article-title>Computational approaches to cellular rhythms</article-title><source>Nature</source><year>2002</year><volume>420</volume><fpage>238</fpage><lpage>245</lpage><pub-id pub-id-type="pmid">12432409</pub-id></citation></ref><ref id="B8"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hengl</surname><given-names>S</given-names></name><etal/></person-group><article-title>Data-based identifiability analysis of non-linear dynamical models</article-title><source>Bioinformatics</source><year>2007</year><volume>23</volume><fpage>2612</fpage><lpage>2618</lpage><pub-id pub-id-type="pmid">17660526</pub-id></citation></ref><ref id="B9"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Heron</surname><given-names>EA</given-names></name><etal/></person-group><article-title>Bayesian inference for dynamic transcriptional regulation; the hes1 system as a case study</article-title><source>Bioinformatics</source><year>2007</year><volume>23</volume><fpage>2589</fpage><lpage>2595</lpage><pub-id pub-id-type="pmid">17872915</pub-id></citation></ref><ref id="B10"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Jensen</surname><given-names>MH</given-names></name><etal/></person-group><article-title>Sustained oscillations and time delays in gene expression of protein<italic>Hes1</italic></article-title><source>Febs Lett.</source><year>2003</year><volume>541</volume><fpage>176</fpage><lpage>177</lpage><pub-id pub-id-type="pmid">12706840</pub-id></citation></ref><ref id="B11"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kalir</surname><given-names>S</given-names></name><name><surname>Alon</surname><given-names>U</given-names></name></person-group><article-title>Using a quantitative blueprint to reprogram the dynamics of the flagella gene network</article-title><source>Cell</source><year>2004</year><volume>117</volume><fpage>713</fpage><lpage>720</lpage><pub-id pub-id-type="pmid">15186773</pub-id></citation></ref><ref id="B12"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Kloeden</surname><given-names>PE</given-names></name><name><surname>Platen</surname><given-names>E</given-names></name></person-group><source>Numerical Solution of Stochastic Differential Equations.</source><year>1999</year><edition>3rd edn</edition><publisher-loc>Berlin, New York</publisher-loc><publisher-name>Springer-Verlag</publisher-name></citation></ref><ref id="B13"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Locke</surname><given-names>JCW</given-names></name><etal/></person-group><article-title>Modelling genetic networks with noisy and varied experimental data: the circadian clock in Arabidopsis thaliana</article-title><source>J. Theor. Biol.</source><year>2005a</year><volume>234</volume><fpage>383</fpage><lpage>393</lpage><pub-id pub-id-type="pmid">15784272</pub-id></citation></ref><ref id="B14"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Locke</surname><given-names>JCW</given-names></name><etal/></person-group><article-title>Extension of a genetic network model by iterative experimentation and mathematical analysis</article-title><source>Mol. Syst. Biol</source><year>2005b</year><volume>1</volume><fpage>E1</fpage><lpage>E9</lpage></citation></ref><ref id="B15"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Millar</surname><given-names>AJ</given-names></name><etal/></person-group><article-title>Circadian clock mutants in Arabidopsis identified by luciferase imaging</article-title><source>Science</source><year>1995</year><volume>267</volume><fpage>1161</fpage><lpage>1163</lpage><pub-id pub-id-type="pmid">7855595</pub-id></citation></ref><ref id="B16"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Millar</surname><given-names>AJ</given-names></name><name><surname>Kay</surname><given-names>SA</given-names></name></person-group><article-title>Integration of circadian and phototransduction pathways in the network controlling cab gene transcription in Arabidopsis</article-title><source>Proc. Natl Acad. Sci. USA</source><year>1996</year><volume>93</volume><fpage>15491</fpage><lpage>15496</lpage><pub-id pub-id-type="pmid">8986839</pub-id></citation></ref><ref id="B17"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Nelson</surname><given-names>DE</given-names></name><etal/></person-group><article-title>Oscillations in protect NF-kappa B signaling control the dynamics of gene expression</article-title><source>Science</source><year>2004</year><volume>306</volume><fpage>704</fpage><lpage>708</lpage><pub-id pub-id-type="pmid">15499023</pub-id></citation></ref><ref id="B18"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ronen</surname><given-names>M</given-names></name><etal/></person-group><article-title>Assigning numbers to the arrows: parameterizing a gene regulatory network by using accurate expression kinetics</article-title><source>Proc. Natl Acad. Sci. USA</source><year>2002</year><volume>99</volume><fpage>10555</fpage><lpage>10560</lpage><pub-id pub-id-type="pmid">12145321</pub-id></citation></ref><ref id="B19"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Tanner</surname><given-names>MA</given-names></name><name><surname>Wong</surname><given-names>WH</given-names></name></person-group><article-title>The calculation of posterior distributions by data augmentation</article-title><source>J. Am. Stat. Assoc. USA</source><year>1987</year><volume>82</volume><fpage>528</fpage><lpage>540</lpage></citation></ref><ref id="B20"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Z</given-names></name><name><surname>Tobin</surname><given-names>EM</given-names></name></person-group><article-title>Constitutive expression of the circadian clock associated 1 (cca1) gene disrupts circadian rhythms and suppresses its own expression</article-title><source>Cell</source><year>1998</year><volume>93</volume><fpage>1207</fpage><lpage>1217</lpage><pub-id pub-id-type="pmid">9657153</pub-id></citation></ref><ref id="B21"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Yakir</surname><given-names>E</given-names></name><etal/></person-group><article-title>Circadian clock associated1 transcript stability and the entrainment of the circadian clock in arabidopsis</article-title><source>Plant Physiol.</source><year>2007</year><volume>145</volume><fpage>925</fpage><lpage>932</lpage><pub-id pub-id-type="pmid">17873091</pub-id></citation></ref></ref-list></back></article>