<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd"><article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article" xml:lang="EN"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id><journal-id journal-id-type="publisher-id">bioinformatics</journal-id><journal-id journal-id-type="hwp">bioinfo</journal-id><journal-title>Bioinformatics</journal-title><issn pub-type="ppub">1367-4803</issn><issn pub-type="epub">1460-2059</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">19244390</article-id><article-id pub-id-type="pmc">2647828</article-id><article-id pub-id-type="doi">10.1093/bioinformatics/btn662</article-id><article-id pub-id-type="publisher-id">btn662</article-id><article-categories><subj-group subj-group-type="heading"><subject>Original Papers</subject><subj-group><subject>Data and Text Mining</subject></subj-group></subj-group></article-categories><title-group><article-title>Biomarker discovery in MALDI-TOF serum protein profiles using discrete wavelet transformation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Alexandrov</surname><given-names>Theodore</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref><xref ref-type="corresp" rid="COR1">*</xref></contrib><contrib contrib-type="author"><name><surname>Decker</surname><given-names>Jens</given-names></name><xref ref-type="aff" rid="AFF1"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Mertens</surname><given-names>Bart</given-names></name><xref ref-type="aff" rid="AFF1"><sup>3</sup></xref></contrib><contrib contrib-type="author"><name><surname>Deelder</surname><given-names>Andre M.</given-names></name><xref ref-type="aff" rid="AFF1"><sup>4</sup></xref></contrib><contrib contrib-type="author"><name><surname>Tollenaar</surname><given-names>Rob A. E. M.</given-names></name><xref ref-type="aff" rid="AFF1"><sup>5</sup></xref></contrib><contrib contrib-type="author"><name><surname>Maass</surname><given-names>Peter</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Thiele</surname><given-names>Herbert</given-names></name><xref ref-type="aff" rid="AFF1"><sup>2</sup></xref></contrib></contrib-group><aff id="AFF1"><sup>1</sup>Center for Industrial Mathematics, University of Bremen, D-28334 Bremen, <sup>2</sup>Bruker Daltonik GmbH, D-28359 Bremen, Germany, <sup>3</sup>Department of Medical Statistics and Bioinformatics, Leiden University Medical Center (LUMC), 2300 RC Leiden, The Netherlands, <sup>4</sup>Department of Parasitology and <sup>5</sup>Department of Surgery, Leiden University Medical Center, 2300 RC Leiden, The Netherlands</aff><author-notes><corresp id="COR1">*To whom correspondence should be addressed.</corresp><fn><p>Associate Editor: Burkhard Rost</p></fn></author-notes><pub-date pub-type="ppub"><day>1</day><month>3</month><year>2009</year></pub-date><pub-date pub-type="epub"><day>6</day><month>1</month><year>2009</year></pub-date><pub-date pub-type="pmc-release"><day>6</day><month>1</month><year>2009</year></pub-date><volume>25</volume><issue>5</issue><fpage>643</fpage><lpage>649</lpage><history><date date-type="received"><day>1</day><month>7</month><year>2008</year></date><date date-type="rev-recd"><day>22</day><month>12</month><year>2008</year></date><date date-type="accepted"><day>23</day><month>12</month><year>2008</year></date></history><permissions><copyright-statement>&#x000a9; 2009 The Author(s)</copyright-statement><copyright-year>2009</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/"><p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">http://creativecommons.org/licenses/by-nc/2.0/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</p></license></permissions><abstract><p><bold>Motivation:</bold> Automatic classification of high-resolution mass spectrometry proteomic data has increasing potential in the early diagnosis of cancer. We propose a new procedure of biomarker discovery in serum protein profiles based on: (i) discrete wavelet transformation of the spectra; (ii) selection of discriminative wavelet coefficients by a statistical test and (iii) building and evaluating a support vector machine classifier by double cross-validation with attention to the generalizability of the results. In addition to the evaluation results (total recognition rate, sensitivity and specificity), the procedure provides the biomarker patterns, i.e. the parts of spectra which discriminate cancer and control individuals. The evaluation was performed on matrix-assisted laser desorption ionization time-of-flight (MALDI-TOF) serum protein profiles of 66 colorectal cancer patients and 50 controls.</p><p><bold>Results:</bold> Our procedure provided a high recognition rate (97.3%), sensitivity (98.4%) and specificity (95.8%). The extracted biomarker patterns mostly represent the peaks expressing mean differences between the cancer and control spectra. However, we showed that the discriminative power of a peak is not simply expressed by its mean height and cannot be derived by comparison of the mean spectra. The obtained classifiers have high generalization power as measured by the number of support vectors. This prevents overfitting and contributes to the reproducibility of the results, which is required to find biomarkers differentiating cancer patients from healthy individuals.</p><p><bold>Availability:</bold> The data and scripts used in this study are available at <ext-link ext-link-type="uri" xlink:href="http://www.math.uni-bremen.de/~theodore/MALDIDWT">http://www.math.uni-bremen.de/~theodore/MALDIDWT</ext-link>.</p><p><bold>Contact:</bold> <email>theodore@math.uni-bremen.de</email></p><p><bold>Supplementary information:</bold> <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn662/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p></abstract></article-meta></front><body><sec sec-type="intro" id="SEC1"><title>1 INTRODUCTION</title><p>Colorectal cancer (CRC) is one of the most common malignancies and remains a principal cause of cancer-related morbidity and mortality. The early detection of cancer is essential for a successful treatment. Currently, the colonoscopy is used to detect early stage lesions, but this is an invasive and relatively expensive method. Therefore, a different method would be desirable relaying on easily accessible body fluids, like serum. A sensitive blood test might not only detect early stage malignancies, but also premalignant lesions (not part of this study), thereby increasing the chance of survival considerably.</p><p>The use of mass spectrometry for searching serum biomarkers in cancer diagnostics was suggested by Petricoin <italic>et al.</italic> (<xref ref-type="bibr" rid="B11">2002</xref>) but was factually flawed. Second-generation studies discovered the importance of avoiding bias and overfitting as well as the need of validation (Ransohoff, <xref ref-type="bibr" rid="B12">2004</xref>). Here a procedure is presented for biomarker extraction from matrix-assisted laser desorption ionization time-of-flight (MALDI-TOF) serum protein profiles constructed with attention to generalizability of the achieved results.</p><p>Recently, de Noo <italic>et al.</italic> (<xref ref-type="bibr" rid="B4">2006</xref>) demonstrated the feasibility of mass spectrometry based protein profiling for the discrimination of CRC patients from healthy individuals, using quite simple classification methods. This motivated us to develop an advanced procedure of biomarker extraction using the ideas proposed in Schleif <italic>et al.</italic> (<xref ref-type="bibr" rid="B13">2007</xref>): (i) discrete wavelet transformation (DWT) of the spectra, (ii) features (wavelet coefficients) selection by statistical testing and (iii) support vector machine (SVM) classification, see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn662/DC1">Supplementary Figure 1</ext-link> for an overall scheme.<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>Mean spectra for the cancer and control group (inverted, gray spectrum) after low-level processing.</p></caption><graphic xlink:href="btn662f1"/></fig></p><p>Our new procedure presented in this article goes significantly beyond that of Schleif <italic>et al.</italic> (<xref ref-type="bibr" rid="B13">2007</xref>): (i) The actual approach does not only give a classification of spectra, but also supports the location and scoring of spectral features which are putative biomarkers. For this goal, we propose additional wavelet reconstructions to visualize the results; (ii) The classifier assessment is now using a double cross validation scheme to avoid a possible bias of the results; (iii) The feature selection is also included within the double cross validation to avoid potential biases of the performance estimation and (iv) Finally, we investigated the role of the statistical testing and compared different tests and adjustments. In addition to the Kolmogorov&#x02013;Smirnov (KS) test we also used a Mann&#x02013;Whitney (MW) test for feature selection and also applied a Benjamini&#x02013;Yekutieli (BY) multiple test adjustment to get more confidence about the influence of the feature selection techniques. Finally, we added a detailed analysis of the robustness of the classification as a function of the number of selected features and the number of resulting support vectors. This is helpful to estimate the generalizability of the resulting classification model.</p><p>Our procedure was evaluated on new publicly available datasets obtained according to the randomized block design, which helps to minimize impact of potential confounding factors on the experimental side and, thus also to avoid bias.</p><p>Being aware of the problem of non-reproducibility of promising results in high-throughput mass spectrometry (Check, <xref ref-type="bibr" rid="B2">2004</xref>; Coombes <italic>et al.</italic> <xref ref-type="bibr" rid="B3">2005</xref>; Ransohoff, <xref ref-type="bibr" rid="B12">2004</xref>), we assessed the general-ization power of the constructed classifiers as follows.</p><p>For different types of the feature selection, the conservativeness was investigated as considering fewer features reduces the risk of overfitting. Moreover, we thoroughly analyzed the generalization error of the classifiers measured as the number of support vectors used for the classification (Bartlett and Shawe-Taylor, <xref ref-type="bibr" rid="B1">1999</xref>).</p></sec><sec sec-type="methods" id="SEC2"><title>2 METHODS</title><sec id="SEC2.1"><title>2.1 Serum protein profiling</title><p>Serum samples were obtained from a total of 66 CRC patients one day before surgery and 50 healthy volunteers (<xref ref-type="table" rid="T1">Table 1</xref>). All stages of disease were present in the patient group in comparable proportions. The Tumor-Nodes-Metastases (TNM) stages are I-IIIc according to the AJCC Cancer Staging Manual (6th edn). Moreover, patients without invasive carcinoma but no premalignant cases were included. Informed consent was obtained from all patients and the Medical Ethical Committee approved the study. Blood was collected in a 10 cc serum separator vacutainer tube and centrifuged 30 min later at 3000 r.p.m. for 10 min. Serum samples were distributed into 0.5 ml aliquots and stored at &#x02212;70<sup>&#x000b0;</sup>C until the experiment. The isolation of peptides from serum was performed using the magnetic beads based hydrophobic interaction chromatography (MB-HIC) kit from Bruker Daltonics (Bremen, Germany), according to the manufacturers protocol. &#x003b1;-Cyano-4-hydroxycinnamic acid (0.3 g/l in ethanol:acetone 2:1) was used as matrix. All sample preparation steps were performed on a 8-channel Hamilton STAR pipetting robot (Hamilton, Martinsried, Germany). Using a randomized block design, correcting for demographic and pathological variables, all samples were spotted in quadruple on 3 plates (<xref ref-type="table" rid="T1">Table 1</xref>). The plates were measured on three consecutive days, Tuesday to Thursday. MALDI-TOF mass spectrometry measurements were performed using an Ultraflex TOF/TOF instrument (Bruker Daltonics), equipped with a SCOUT ion source and measured in linear mode. All unprocessed spectra were exported in standard 8-bit ASCII format. They consisted of approximately 65 400 mass-to-charge ratio (<italic>m</italic>/<italic>z</italic>)-values, covering a domain of 960&#x02013;11 170 Da. For more information, see de Noo <italic>et al.</italic> (<xref ref-type="bibr" rid="B4">2006</xref>).<table-wrap id="T1" position="float"><label>Table 1.</label><caption><p>Patient characteristics and distribution across plates</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">Patients</th><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">Controls</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">Number</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">64</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">48</td></tr><tr><td rowspan="1" colspan="1">Mean age (range)</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">67.2 (37&#x02013;89)</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">52.2 (29&#x02013;78)</td></tr><tr><td rowspan="1" colspan="1">Male/female ratio</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">35/29</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">21/27</td></tr><tr><td rowspan="1" colspan="1">Number on plate 1/2/3</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">25/22/17</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">17/16/15</td></tr></tbody></table></table-wrap></p></sec><sec id="SEC2.2"><title>2.2 Low-level analysis</title><p>The data have been exported using ClinProTools (CPT) software (version 2.2, Bruker Daltonics) where we performed recalibration, top-hat baseline correction (all with default parameters), outlier detection, and as in the reference paper, data reduction with factor 4. We found two additional outliers in the control group compared with the reference paper, but included one more cancer spectrum in the dataset for classification. The interpolation of all cancer and control spectra on one grid has been done using Matlab. At the end, we had 64 cancer and 48 control spectra of length 16 331 covering a domain of 960&#x02013;11 163 Da. The mean spectra both for the cancer and control groups are depicted in <xref ref-type="fig" rid="F1">Figure 1</xref>.</p></sec><sec id="SEC2.3"><title>2.3 Discrete Wavelet Transformation</title><p>DWT is an important tool in signal processing, in particular for its superior properties of denoising and compression. The central idea of DWT is to find a lossless multi-scale representation of data by means of wavelet coefficients. Informally speaking, each coefficient represents a contribution for some scale and position. A vast literature on DWT is available, covering both theoretical and applied issues, see e.g. Mallat (<xref ref-type="bibr" rid="B7">1999</xref>). DWT has been useful for MS data processing for many years, see a review of Leung <italic>et al.</italic> (<xref ref-type="bibr" rid="B6">1998</xref>) for early references.</p><p>Given a spectrum, the DWT was applied to produce a set of wavelet coefficients which are further used for feature selection and classification. We evaluated two approaches of calculating wavelet coefficients. First, as usual in DWT, we computed detail coefficients of each level together with the approximation coefficients of the maximum level. Second, we considered the approximation coefficients of all levels, instead of the detail coefficients (<xref ref-type="fig" rid="F2">Figure 2</xref>). We denote these approaches CONVDWT and APPDWT, respectively. APPDWT is better suited for biomarker visualization and peak detection since being reconstructed, each approximation coefficient produces the scaling function (a narrow bump) but not the wavelet (an oscillating function) obtained for a detail coefficient (<xref ref-type="fig" rid="F2">Figure 2</xref>). The numbers of calculated detail/approximation DWT coefficients at each level (level number in brackets) are: 8173 (1), 4094 (2), 2054 (3), 1034 (4), 524 (5), 269 (6), 142 (7), 78 (8), 46 (9), 30 (10). This accounts for a total of 16 444 coefficients.<fig id="F2" position="float"><label>Fig. 2.</label><caption><p>Scheme of calculation of APPDWT and CONVDWT coefficients, the <italic>bior3.7</italic> wavelet and its scaling function. <italic>A</italic><sub><italic>i</italic></sub>(<italic>D</italic><sub><italic>i</italic></sub>) denote approximation (detail) coefficients of the <italic>i</italic>-th level, <italic>n</italic> is the maximum level (10 in our case). Note that <italic>A</italic><sub><italic>n</italic></sub> belongs to both the APPDWT and CONVDWT coefficients.</p></caption><graphic xlink:href="btn662f2"/></fig></p><p>The bi-orthogonal <italic>bior3.7</italic> wavelet was used, because the shape of its scaling function closely matches the peak pattern of MALDI-TOF spectra (Schleif <italic>et al.</italic>, <xref ref-type="bibr" rid="B13">2007</xref>). This is a favorable property of the selected wavelet, since for such a wavelet large values of DWT coefficients can be associated with peaks and a peak is represented by only a few dominant coefficients.</p><p>Using wavelet coefficients for classification has the following advantages. First, DWT provides automatic denoising as it separates noise contribution (generating coefficients of the first-scale levels) and signal contribution. Even if we do not carry out the denoising explicitly, this property of DWT helps the statistical feature selection (introduced below) to find significant differences between the two classes. In case of overlapping peaks, the peak picking process becomes complicated and it is usually required to specify a typical <italic>a priori</italic> peak width. The DWT approach does not require such a specification. However, if there is information available about the <italic>m</italic>/<italic>z</italic> range and the expected width of the peaks this can improve the performance significantly.</p></sec><sec id="SEC2.4"><title>2.4 Statistical feature selection</title><p>In order to find those wavelet coefficients which differentiate between cancer and control spectra, we used non-parametric statistical testing of the null hypothesis <italic>H</italic><sub><italic>i</italic></sub> that no distinction between cancer and control groups is expressed by the <italic>i</italic>-th coefficient. Only the coefficients significantly rejecting the hypothesis are used for classification. Note that the applied test of difference is aimed not at extraction of peaks but at extraction of discriminative features. The statistical testing significantly reduces the number of coefficients.</p><p>For the statistical feature selection we evaluated the KS and MW tests (significance level 0.05), which are both non-parametric and distribution free tests for assessing whether two samples of observations come from the same distribution or not. Since we compare thousands of coefficients simultaneously, the so-called &#x02018;multiple testing&#x02019; adjustment of <italic>p</italic>-values has to be applied. The aim of the adjustment is to control the type I error rate defined with respect to the multiple testing approach. Among the most popular adjustments are the Bonferroni (Bonf) and the Benjamini&#x02013;Hochberg (BH) adjustment.</p><p>Bonf is perhaps the best known adjustment procedure in multiple testing. It strongly controls the family-wise error rate (FWER) which is the probability of at least one false positive within the set of tests. BH strongly controls the false discovery rate (FDR) for independent test statistics. The FDR is the expected proportion of type I errors among the rejected hypotheses. In addition to the Bonf and BH, we evaluated the BY adjustment which strongly controls the FDR for an arbitrary dependence structure. We considered BY presupposing dependence between DWT coefficients. As discussed, the shape of the chosen wavelet matches a typical peak shape quite well but is still not perfect. Hence, a large peak commonly generates not only one large wavelet coefficient, but several ones positioned close to the peak maximum.</p><p>Under the condition of complete null hypotheses (all coefficients do not distinguish cancer and control groups) the FDR would be equivalent to the FWER. Obviously, this is not expected. In this case, the procedures controlling FWER (Bonf) are more conservative than those controlling FDR (BH, BY), because FWER-controlling procedures suppress false positives. FDR-controlling procedures tolerate a few false positives provided that their number is small compared to the number of all rejected hypotheses. For further discussion on multiple testing approaches, see Dudoit <italic>et al.</italic> (<xref ref-type="bibr" rid="B5">2003</xref>).</p></sec><sec id="SEC2.5"><title>2.5 SVMs</title><p>The selected discriminative DWT coefficients are used as input data for the classification. For the classification, we used a SVM of type C-SVM with a gaussian kernel. SVM is a powerful and popular machine learning technique, widely used for classification and extensively applied in biology (Noble, <xref ref-type="bibr" rid="B9">2004</xref>). The SVM theory and algorithms are described in many papers and books. For a short introduction to SVM from the biological viewpoint, see Noble (<xref ref-type="bibr" rid="B10">2006</xref>).</p><p>The main idea of SVM is to establish a maximum margin classifier. Linear in its basic formulation, SVM classifiers become non-linear with respect to the given data by exploiting a kernel function or, simply, a kernel. The most often used types of kernels are linear, polynomial and the gaussian kernels. We exploited the gaussian kernel as advised by Schleif <italic>et al.</italic> (<xref ref-type="bibr" rid="B13">2007</xref>) (the linear kernel has also been used, but gave lower recognition rates, results not shown).</p><p>The C-SVM classifier we used, has a parameter <italic>C</italic>, which is a trade-off between maximization of the classifier capacity and minimization of the number of misclassified examples. Together with the width parameter &#x003b3; of the gaussian kernel they represent the so-called SVM hyperparameters which should be optimized for classification. A variety of implementations of SVM are available; we used the Bioinformatics Toolbox 2.5 of Matlab 7.4 (R2007a).</p><p>SVM was selected for classification because of: (i) the small number of hyperparameters and their interpretability, (ii) theoretically substantiated good generalization properties of SVM classifiers, (iii) sparse nature of SVM classifiers, i.e. the classifier is built only on a representative part of the data. The data vectors used (in our case each one contains the wavelet coefficients calculated for a spectrum) are called the support vectors and the other vectors are not taken into account for classification. A disadvantage of SVM is the required runtime to optimize the hyperparameters. For routine classifier generation more efficient alternatives than a simple grid search might be required. The classification of additional spectra is not a performance issue.</p></sec><sec id="SEC2.6"><title>2.6 Double cross-validation</title><p>For the choice of SVM hyperparameters <italic>C</italic> and &#x003b3; we used the double cross-validation (CV) paradigm according to Mertens <italic>et al.</italic> (<xref ref-type="bibr" rid="B8">2006</xref>). Double CV is a bias-reducing scheme of simultaneous parameters estimation and assessment of the classifier. Although double CV dates back to 1974 (Stone, <xref ref-type="bibr" rid="B14">1974</xref>), this approach is still rather new in the field of mass spectrometry. In this field, to our knowledge double CV was first introduced by Mertens <italic>et al.</italic> (<xref ref-type="bibr" rid="B8">2006</xref>) (see this reference for a historical review on double CV) as well as by de Noo <italic>et al.</italic> (<xref ref-type="bibr" rid="B4">2006</xref>) and these references are followed in the essential points.</p><p>The double CV scheme consists of an outer validation loop and an inner training loop. We used leave-one-out CV for the outer loop and 5-fold CV for the inner loop. In this setting, the <italic>i</italic>-th step of the double CV scheme consists of two stages: (i) for the <italic>i</italic>-th element of the data the choice of hyperparameters is done using 5-fold CV on the leftover part (with the feature selection performed within the inner loop), then (ii) the feature selection is done on the leftover part. Finally a classifier is trained with the optimized hyperparameters using all but the <italic>i</italic>-th spectrum. This classifier is applied for classification of the excluded <italic>i</italic>-th spectrum. The total recognition rate (TRR, the fraction of correctly classified spectra), sensitivity and specificity are calculated in the outer validation loop. The scheme of the <italic>i</italic>-th step of the double CV is shown in <xref ref-type="fig" rid="F3">Figure 3</xref>.<fig id="F3" position="float"><label>Fig. 3.</label><caption><p>The <italic>i</italic>-th step of double CV used for simultaneous parameters estimation and prediction assessment, <italic>i</italic> goes through all the given spectra.</p></caption><graphic xlink:href="btn662f3"/></fig></p><p>As usual for SVM, given a train set and a test set, the hyperparameters <italic>C</italic> and &#x003b3; are optimized by grid search. The TRR is used as the minimization criterion. At the <italic>i</italic>-th step of the outer loop, the TRR on all but the <italic>i</italic>-th spectrum is estimated using 5-fold CV and the hyperparameters minimizing this value are selected. Recall that the final double CV TRR (presented in <xref ref-type="table" rid="T2">Table 2</xref>) is calculated in the outer loop.<table-wrap id="T2" position="float"><label>Table 2.</label><caption><p>Double CV classification results for the detection of cancer using the proposed procedure</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">DWT type</th><th rowspan="1" colspan="1">Test</th><th colspan="3" rowspan="1">TRR<hr/></th><th rowspan="1" colspan="1"/><th colspan="3" rowspan="1">Sensitivity<hr/></th><th rowspan="1" colspan="1"/><th colspan="3" rowspan="1">Specificity<hr/></th><th rowspan="1" colspan="1"/><th colspan="3" rowspan="1">Number of coefficients<hr/></th><th rowspan="1" colspan="1"/><th colspan="3" rowspan="1">Mean number of SV<hr/></th><th rowspan="1" colspan="1"/></tr><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">BH</th><th rowspan="1" colspan="1">Bonf</th><th rowspan="1" colspan="1">BY</th><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">BH</th><th rowspan="1" colspan="1">Bonf</th><th rowspan="1" colspan="1">BY</th><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">BH</th><th rowspan="1" colspan="1">Bonf</th><th rowspan="1" colspan="1">BY</th><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">BH</th><th rowspan="1" colspan="1">Bonf</th><th rowspan="1" colspan="1">BY</th><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">BH</th><th rowspan="1" colspan="1">Bonf</th><th rowspan="1" colspan="1">BY</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">APPDWT</td><td rowspan="1" colspan="1">KS</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">96.4</td><td rowspan="1" colspan="1">96.4</td><td rowspan="1" colspan="1">96.4</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">96.9</td><td rowspan="1" colspan="1">98.4</td><td rowspan="1" colspan="1">98.4</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">95.8</td><td rowspan="1" colspan="1">93.8</td><td rowspan="1" colspan="1">93.8</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">6219</td><td rowspan="1" colspan="1">1545</td><td rowspan="1" colspan="1">3392</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">55</td><td rowspan="1" colspan="1">44</td><td rowspan="1" colspan="1">49</td></tr><tr><td rowspan="1" colspan="1">APPDWT</td><td rowspan="1" colspan="1">MW</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">96.4</td><td rowspan="1" colspan="1">97.3</td><td rowspan="1" colspan="1">97.3</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">96.9</td><td rowspan="1" colspan="1">98.4</td><td rowspan="1" colspan="1">96.9</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">95.8</td><td rowspan="1" colspan="1">95.8</td><td rowspan="1" colspan="1">95.8</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">7068</td><td rowspan="1" colspan="1">1784</td><td rowspan="1" colspan="1">3920</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">56</td><td rowspan="1" colspan="1">43</td><td rowspan="1" colspan="1">52</td></tr><tr><td rowspan="1" colspan="1">CONVDWT</td><td rowspan="1" colspan="1">KS</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">95.5</td><td rowspan="1" colspan="1">95.5</td><td rowspan="1" colspan="1">96.4</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">96.9</td><td rowspan="1" colspan="1">96.9</td><td rowspan="1" colspan="1">96.9</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">93.8</td><td rowspan="1" colspan="1">93.8</td><td rowspan="1" colspan="1">95.8</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">603</td><td rowspan="1" colspan="1">299</td><td rowspan="1" colspan="1">419</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">66</td><td rowspan="1" colspan="1">54</td><td rowspan="1" colspan="1">49</td></tr><tr><td rowspan="1" colspan="1">CONVDWT</td><td rowspan="1" colspan="1">MW</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">94.6</td><td rowspan="1" colspan="1">94.6</td><td rowspan="1" colspan="1">96.4</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">95.3</td><td rowspan="1" colspan="1">96.9</td><td rowspan="1" colspan="1">96.9</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">93.8</td><td rowspan="1" colspan="1">91.7</td><td rowspan="1" colspan="1">95.8</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">613</td><td rowspan="1" colspan="1">303</td><td rowspan="1" colspan="1">438</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">81</td><td rowspan="1" colspan="1">61</td><td rowspan="1" colspan="1">55</td></tr></tbody></table><table-wrap-foot><fn><p>APPDWT and CONVDWT specify the ways of wavelet coefficients calculation. Column &#x02018;Number of coefficients&#x02019; contains the number of discriminative coefficients selected. Column &#x02018;Mean number of SV&#x02019; shows mean number of support vectors describing the generalizability of the classifier: a large number indicates overfitting.</p></fn></table-wrap-foot></table-wrap></p><p>Note that a step of the double CV with leave-one-out CV in the outer loop and 5-fold CV in the inner loop simulates clinical diagnosis with 5-fold CV used for training. In double CV, this step is repeated for each spectrum thus providing the TRR and other characteristics of the considered prediction procedure. After method evaluation, having a training dataset and a new patient sample coming in, we (i) optimize <italic>C</italic> and &#x003b3; using 5-fold CV on the training data, (ii) select discriminative coefficients of the training dataset, (iii) apply the classifier with the best parameters to the extracted features of the new sample spectrum.</p></sec><sec id="SEC2.7"><title>2.7 Biomarkers</title><p>Having obtained the classification results, we are interested to interpret the wavelet coefficients used in the classification and to identify putatitive biomarkers. For this purpose, we calculated the parts of the spectra represented by the selected wavelet coefficients. Given the selected wavelet coefficients for each spectrum, we reconstructed the <italic>m</italic>/<italic>z</italic> ranges represented by these coefficients. Then we computed the class-discriminating <italic>m/z</italic> ranges by averaging the resulting spectral components of all spectra within each class. For CONVDWT coefficients, the reconstruction is done using inverse wavelet transformation. Unfortunately, an inverse wavelet transformation is not possible for APPDWT coefficients. Therefore, for each level of the DWT we reconstructed the one-level signal from the selected approximation coefficients. From the produced one-level signals we took the maximum value for each <italic>m</italic>/<italic>z</italic>-value.</p><p>Moreover, in order to find the most class-discriminative features of the spectra, we studied the parts of the spectra which correspond to a prespecified number of the most significant wavelet coefficients, i.e. the coefficients having the lowest <italic>P</italic>-values of the statistical test.</p></sec></sec><sec sec-type="results" id="SEC3"><title>3 RESULTS</title><sec id="SEC3.1"><title>3.1 Classification results</title><p>The results of applying the double CV simultaneous parameters choice and classifier assessment scheme together with the introduced wavelet-based approach are given in <xref ref-type="table" rid="T2">Table 2</xref>. The achieved TRR, sensitivity and specificity for all tests and adjustments are higher than those reported by de Noo <italic>et al.</italic> (<xref ref-type="bibr" rid="B4">2006</xref>) which are 92.6%, 95.2% and 90.0%, respectively (even taking into account that we excluded one additional outlier). The one cancer sample misclassified by all the classifiers has late TNM stage (IIIc). Using APPDWT gave better recognition rates than CONVDWT and the combination of MW and Bonf (or BY) for APPDWT provided the best results (97.3% TRR). Note that the achieved sensitivity is higher than the specificity as also reported by de Noo <italic>et al.</italic> (<xref ref-type="bibr" rid="B4">2006</xref>). The runtimes (15+9 grid points, 112&#x000d7;(5+1) train-test runs for each grid point) on an Intel 2.66 GHz PC were &#x0223c;9 h (KS, Bonf), 17 h (KS, BH/BY), 22 h (MW, Bonf) and 30 h (MW, BH/BY). We also compared our procedure with CPT v.2.2. Since double CV is not included in CPT yet, we used the leave-one-out CV evaluation both in CPT and our procedure. Moreover, the technical replicates have not been averaged (that is not implemented in CPT) resulting in 438 spectra. Other preprocessing steps (<xref ref-type="sec" rid="SEC2.2">Section 2.2</xref>) were the same. The calculated TRR values are 98.63% produced by our procedure (APPDWT, MW, Bonf) versus, at best, 98.46% for CPT (SVM, automatic number of peaks, KNN3). This number is only slightly smaller than the one obtained with our procedure and the difference can not be considered to be significant. However, note that the peak picking which depends on all spectra is not included in the leave-one-out CV of CPT. The high-recognition accuracies demonstrate the effectiveness of the classifier in revealing the difference between cancer and control spectra.</p></sec><sec id="SEC3.2"><title>3.2 Generalization properties</title><p>As shown, our classification procedure provides an improved accuracy for cancer detection, and the TRR is several percent better than those originally reported for the same data by de Noo <italic>et al.</italic> (<xref ref-type="bibr" rid="B4">2006</xref>). However, the most important problem in proteomic profiling today is not to gain several percent advance but to find reproducible biomarkers. As Ransohoff (<xref ref-type="bibr" rid="B12">2004</xref>) concluded, it is crucial to assess reproducibility of results in some direct way.</p><p>Being aware of this problem, we used double CV with disjoint datasets for optimization and validation. The whole procedure (DWT, feature selection, classification) is evaluated in the inner loop of the double CV. This helps to avoid possible bias in results and to make them reproducible. Furthermore, we investigated the generalizability of the derived classifiers as follows.</p><p>First, we compared the conservativeness of the statistical test used, in other words, the fraction of wavelet coefficients which are not rejected by the test. This question is related to the &#x02018;overfitting&#x02019; problem, because in general a smaller dimension of the data used for the classification results in a reduced risk of overfitting. <xref ref-type="table" rid="T2">Table 2</xref> shows the number of selected coefficients for all the tests and adjustments both for CONVDWT and APPDWT. Despite the same TRR provided, MW with Bonf is better than MW with BY since the former combination selects significantly fewer coefficients.</p><p>Investigating the conservativeness of the statistical tests is an opportunity to study the generalization properties of the provided classifiers beyond the set of training spectra. An important characteristic of any SVM classifier is the use of only a part of the given vectorial data, the so-called support vectors. If fewer support vectors are used, the classifier is more likely to give good results for an extended set of samples and it is less likely be overfit (Bartlett and Shawe-Taylor, <xref ref-type="bibr" rid="B1">1999</xref>). <xref ref-type="table" rid="T2">Table 2</xref> shows the mean number of support spectra used in the outer loop of the double CV.</p><p>For the combination (MW, Bonf) the number of support vectors is 43 on average, whilst the training dataset is of size 111. Therefore the classification procedure is able to represent the information discriminating between cancer and control groups with one third of the training spectra.</p><p>Also, the generalizability was estimated in the following empirical way. In the outer loop of a double CV we classified spectra with additional normal distributed noise that simulates classification of new data with models trained on the original data. The noise standard deviation was 0.31 which is twice the real noise estimated in the <italic>m</italic>/<italic>z</italic>-interval [1200,2400]. For the achieved classification results see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn662/DC1">Supplementary Table 1</ext-link>. Bonf-classifiers are more general than others as their TRR is only slightly diminished [96.4% for (MW, Bonf) versus 66.1% and 86.6% for (MW, BH) and (MW, BY), using APPDWT coefficients].</p><p>Finally, we investigated the stability of the feature selection procedure using double CV. Therefore, we compared the features extracted at each outer iteration of the double CV (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn662/DC1">Supplementary Figure 2</ext-link>). Except for tiny variations, the feature extraction is very stable. Moreover, we ran the whole classification procedure with the feature selection performed in advance outside of the double CV. The provided classification results were very similar to those presented in <xref ref-type="table" rid="T2">Table 2</xref> which indirectly confirms the stability of the feature selection procedure.</p></sec><sec id="SEC3.3"><title>3.3 Biomarkers</title><p>The class-discriminating parts of the cancer and control spectra, computed as described in <xref ref-type="sec" rid="SEC2.7">Section 2.7</xref> for the MW test and the Bonf adjustment using APPDWT coefficients are shown in <xref ref-type="fig" rid="F4">Figure 4</xref>a. Even though the scale of the wavelet coefficients was not specified, the discriminating parts consist of peaks which are all positioned in the <italic>m</italic>/<italic>z</italic>-interval 1000&#x02013;3300 Da (mostly inside 1200&#x02013;2050 Da).<fig id="F4" position="float"><label>Fig. 4.</label><caption><p>(<bold>a</bold>) The class-discriminating parts of spectra (MW, Bonf, APPDWT) against the mean spectra (control data are shifted in intensity for better viewing) in the interval 960&#x02013;3500 Da (no discriminative peaks above 3500 Da). (<bold>b</bold>) Difference between these parts in the interval 1100&#x02013;2100 Da. Positive (negative) peaks relate to the cancer (control) spectra.</p></caption><graphic xlink:href="btn662f4"/></fig></p><p>The fact that discriminative coefficients represent peaks demon-strates the ability of DWT to extract biologically relevant features.</p><p>In <xref ref-type="fig" rid="F4">Figure 4</xref>b, the difference between the class-discriminating parts of the spectra (cancer minus control) is presented and the eight peaks with the largest difference are marked: 1208, 1265, 1352, 1467 Da for control spectra and 1692, 1780, 1867, 2024 Da corresponding to cancer spectra, respectively. The difference pattern is very similar to the difference of the mean spectra and to the correlation coefficients presented by de Noo <italic>et al.</italic> (<xref ref-type="bibr" rid="B4">2006</xref>), <xref ref-type="fig" rid="F3">Figure 3</xref>, although our pattern is more detailed. In the results of de Noo <italic>et al.</italic> (<xref ref-type="bibr" rid="B4">2006</xref>), the control peak at 1619 Da (difference in intensity -2.6) is overlooked, the cancer peak at 1692 Da is almost unnoticeable, and the large peak at 2024 Da is not separated from the tiny neighbor peak at 2013 Da.</p><p>In the remainder of this section we consider the most discriminative parts of the extracted biomarker patterns. Based on the results of the statistical feature selection, we define the discriminative power (the measure of difference) between cancer and control spectra at some <italic>m</italic>/<italic>z</italic>-value through <italic>P</italic>-values as follows: in DWT several scales are considered (we used 10 scales, the first represents the finest details of the spectra) and for each scale the wavelet coefficients at all possible positions (<italic>m</italic>/<italic>z</italic>-values) are calculated. Then for each wavelet coefficient (corresponding to some position and some scale) the statistical difference between its values for the cancer and control data is calculated by means of the statistical test of difference. Thus, the discrimination power at some position and on some scale is expressed by a <italic>P</italic>-value. As usual, the smaller the <italic>P</italic>-value, the more discriminative is the position on this scale.</p><p><xref ref-type="fig" rid="F5">Figure 5</xref>a depicts the mean spectra difference and the <italic>P</italic>-values (using a log<sub>10</sub>-scale) calculated for the APPDWT coefficients (MW, Bonf) in the interval 1100&#x02013;2460 Da. In this diagram, each cell corresponds to a <italic>P</italic>-value and the width of the cell depends on the scale. The cells are colored according to their <italic>P</italic>-values (log<sub>10</sub>-scale). Darker cells indicate more discriminative wavelet coefficients. One can clearly see the correspondence between the large peaks expressing the mean spectra difference and the <italic>p</italic>&#x0003c;10<sup>&#x02212;10</sup> (dark cells in <xref ref-type="fig" rid="F5">Figure 5</xref>a), especially on the first levels where wavelets provide sufficiently fine resolution. This illustrates that our statistical feature selection does not miss the large mean difference between the cancer and control data. Moreover, these results correlate with the biomarker patterns presented in <xref ref-type="fig" rid="F4">Figure 4</xref>b which mostly represent these peaks.<fig id="F5" position="float"><label>Fig. 5.</label><caption><p>The <italic>P</italic>-values (MW, Bonf) for APPDWT coefficients plotted in log<sub>10</sub>-scale against the difference of the mean spectra for the wavelet scales L1&#x02013;L9. (<bold>a</bold>) All <italic>P</italic>-values. (<bold>b</bold>) Only the 100 smallest <italic>P</italic>-values showing the most discriminative parts of the biomarker patterns.</p></caption><graphic xlink:href="btn662f5"/></fig></p><p>Thus, the <italic>P</italic>-values of the wavelet coefficients give an estimate of the discriminative power of features at different scales and positions.</p><p>Considering the most discriminative parts of the biomarker patterns (<xref ref-type="fig" rid="F5">Figure 5</xref>b depicts only the 100 smallest <italic>P</italic>-values), the discriminative power of the peak is not simply expressed by its height. For example, the high intensity difference of the peak at 1867 Da is not found among the most discriminative features obtained. To provide more information for this observation, we did a further evaluation. For different numbers of the coefficients with the smallest <italic>P</italic>-values we plotted the diagram as in <xref ref-type="fig" rid="F5">Figure 5</xref>b and checked whether the dark cells (discriminative coefficients) correspond to the peaks of largest intensity difference. This compares step-by-step the discriminative power of these peaks. <xref ref-type="table" rid="T3">Table 3</xref> shows whether the considered peaks are present in the most discriminative parts of the biomarkers corresponding to different quantities of the smallest <italic>P</italic>-values or not. It turns out that the most discriminative (the most significant one, significance order 1) peak is at 1265 Da.<table-wrap id="T3" position="float"><label>Table 3.</label><caption><p>Indication of whether the peaks (denoted by their <italic>m</italic>/<italic>z</italic>-values, in Da) are reconstructed by the most significant APPDWT coefficients</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1"><italic>P</italic>-values</th><th rowspan="1" colspan="1">1208</th><th rowspan="1" colspan="1">1265</th><th rowspan="1" colspan="1">1352</th><th rowspan="1" colspan="1">1467</th><th rowspan="1" colspan="1">1692</th><th rowspan="1" colspan="1">1780</th><th rowspan="1" colspan="1">1867</th><th rowspan="1" colspan="1">2024</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">&#x02713;</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1">10</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">&#x02713;</td><td rowspan="1" colspan="1">&#x02713;</td><td rowspan="1" colspan="1">&#x02713;</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1">20</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">&#x02713;</td><td rowspan="1" colspan="1">&#x02713;</td><td rowspan="1" colspan="1">&#x02713;</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">&#x02713;</td></tr><tr><td rowspan="1" colspan="1">50</td><td rowspan="1" colspan="1">&#x02713;</td><td rowspan="1" colspan="1">&#x02713;</td><td rowspan="1" colspan="1">&#x02713;</td><td rowspan="1" colspan="1">&#x02713;</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">&#x02713;</td></tr><tr><td rowspan="1" colspan="1">150</td><td rowspan="1" colspan="1">&#x02713;</td><td rowspan="1" colspan="1">&#x02713;</td><td rowspan="1" colspan="1">&#x02713;</td><td rowspan="1" colspan="1">&#x02713;</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">&#x02713;</td><td rowspan="1" colspan="1">&#x02713;</td><td rowspan="1" colspan="1">&#x02713;</td></tr><tr><td rowspan="1" colspan="1">300</td><td rowspan="1" colspan="1">&#x02713;</td><td rowspan="1" colspan="1">&#x02713;</td><td rowspan="1" colspan="1">&#x02713;</td><td rowspan="1" colspan="1">&#x02713;</td><td rowspan="1" colspan="1">&#x02713;</td><td rowspan="1" colspan="1">&#x02713;</td><td rowspan="1" colspan="1">&#x02713;</td><td rowspan="1" colspan="1">&#x02713;</td></tr><tr><td colspan="9" rowspan="1"><hr/></td></tr><tr><td rowspan="1" colspan="1">Significance order</td><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">2.5</td><td rowspan="1" colspan="1">2.5</td><td rowspan="1" colspan="1">8</td><td rowspan="1" colspan="1">6.5</td><td rowspan="1" colspan="1">6.5</td><td rowspan="1" colspan="1">4</td></tr><tr><td rowspan="1" colspan="1">CPT significance order</td><td rowspan="1" colspan="1">4</td><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">9</td><td rowspan="1" colspan="1">7</td><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">15</td></tr></tbody></table><table-wrap-foot><fn><p>The MW test is used. The sign &#x02018;&#x02713;&#x02019; indicates the presence of the peak in the corresponding features. This table shows in particular that the largest peaks are not the most statistically significant (discriminative) ones. The significance order summarizes the table. The &#x02018;CPT significance order&#x02019; is calculated by the CPT software.</p></fn></table-wrap-foot></table-wrap></p><p>We compared these results also with the most significant peaks produced by CPT 2.2 which uses a <italic>t</italic>-test based on the peaks areas, see <xref ref-type="table" rid="T3">Table 3</xref>, row &#x02018;CPT signifance order&#x02019; (for more CPT results see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn662/DC1">Supplementary Table 2</ext-link>). CPT finds a similar set of peaks (the group of the first three peaks is the same) though there are variations in their order. Unfortunately, TRR cannot be compared as CPT 2.2 does not implement double CV.</p><p>Finally the TRR and the generalization properties of classifiers which use only a limited number of the most discriminative wavelet coefficients (<xref ref-type="table" rid="T4">Table 4</xref>) have been analyzed. As before, the generalizability of a SVM-classifier is estimated by the number of support vectors. It may be unexpected to discover that the TRR provided by a very small number and by thousands of coefficients are comparable. Nevertheless, the classifiers constructed using only a few coefficients need many support vectors. As an extreme example, the most discriminative coefficient on its own provides a recognition rate of 95.5%, but the classifier built on it is not general at all, as 88 spectra (almost 4/5 of the dataset) are used as (in this case one dimensional) SVM support vectors. The large number of support vectors used (compared with 43 for Bonf) most probably indicates overfitting.<table-wrap id="T4" position="float"><label>Table 4.</label><caption><p>Generalization properties of the most discriminative APPDWT coefficients considering the number of support vectors</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Number of coefficients</th><th rowspan="1" colspan="1">TRR</th><th rowspan="1" colspan="1">Mean number of SV</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">1784 (Bonf)</td><td rowspan="1" colspan="1">97.3</td><td rowspan="1" colspan="1">43.4</td></tr><tr><td rowspan="1" colspan="1">100</td><td rowspan="1" colspan="1">95.5</td><td rowspan="1" colspan="1">39.5</td></tr><tr><td rowspan="1" colspan="1">50</td><td rowspan="1" colspan="1">94.6</td><td rowspan="1" colspan="1">49.5</td></tr><tr><td rowspan="1" colspan="1">20</td><td rowspan="1" colspan="1">94.6</td><td rowspan="1" colspan="1">62.8</td></tr><tr><td rowspan="1" colspan="1">10</td><td rowspan="1" colspan="1">95.5</td><td rowspan="1" colspan="1">66.8</td></tr><tr><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">95.5</td><td rowspan="1" colspan="1">70.0</td></tr><tr><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">95.5</td><td rowspan="1" colspan="1">88.2</td></tr></tbody></table><table-wrap-foot><fn><p>The MW test is used to calculate the <italic>P</italic>-values and to rank the coefficients. For abbreviations, see <xref ref-type="table" rid="T2">Table 2</xref>.</p></fn></table-wrap-foot></table-wrap></p></sec><sec id="SEC3.4"><title>3.4 Possible modifications</title><p>The whole model building and validation procedure needs much computation time. This is mainly due to the two-level grid search and leave-one-out cross validation used in the outer loop. Time could be saved by preselecting the <italic>m/z</italic>-intervals based on the mean spectra difference, e.g. by taking only coefficients from the intervals with an absolute difference larger than a fraction <italic>M</italic> (0&#x0003c;<italic>M</italic>&#x0003c;1) of the maximum absolute difference value. For <italic>M</italic>=0.05 the intervals constitute 1.6% of all <italic>m</italic>/<italic>z</italic>-values but include all the most significant peaks presented in <xref ref-type="table" rid="T3">Table 3</xref>.</p><p>Another way to reduce computation time is to use only selected levels of the DWT. In our dataset the typical peak width is &#x0223c;30 Da (empirically estimated). On the 5-th DWT level the width of scaling function is &#x0223c;32 Da (15 and 65 Da for 4-th and 6-th levels). Thus the scaling function of the 5-th level is a good approximation for peak. This was confirmed by tests (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn662/DC1">Supplementary Table 3</ext-link>). Among the test runs with individual levels the best results were obtained for level 5 with the KS test and Bonf adjustment (97.32% TRR and a mean of 43 support vectors).</p></sec></sec><sec sec-type="conclusions" id="SEC4"><title>4 CONCLUSIONS</title><p>We evaluated an automatic procedure of CRC detection using MALDI-TOF spectra based on: (i) discrete wavelet transformation; (ii) selection of discriminative wavelet coefficients using the non-parametric difference tests with multiplicity adjustment; (iii) SVM classification. Our procedure is based on the ideas published in Schleif <italic>et al.</italic> (<xref ref-type="bibr" rid="B13">2007</xref>), but was significantly extended as it was summarized in the introduction.</p><p>Especially, we evaluated the feature selection here together with the classification using an up-to-date double CV scheme to reduce potential bias. Moreover, we proposed a visualization of the biomarker patterns used for classification.</p><p>The presented procedure has been applied to a collection of MALDI-TOF serum protein profiles from 66 CRC patients and 50 controls (de Noo <italic>et al.</italic>, <xref ref-type="bibr" rid="B4">2006</xref>). Compared with (de Noo <italic>et al.</italic>, <xref ref-type="bibr" rid="B4">2006</xref>), a higher TRR, sensitivity and specificity for the detection of cancer are achieved. Examining the properties of SVM classifiers with a different number of wavelet coefficients reveals that the number of required support vectors goes up significantly if too few coefficients are used. Even if such a small subset gives good classification results it indicates an overfitting to the given spectra and might indicate a lack of generalizability of the model considering experimental variability.</p><p>The biomarker patterns provided are similar to those of de Noo <italic>et al.</italic> (<xref ref-type="bibr" rid="B4">2006</xref>) but have a higher resolution that in principle allows to find minor discriminating peaks close to other neighboring peaks. The investigation of the found peaks showed that those of them which intensity-wise differ the most between cancer and control spectra are not the most discriminative ones in terms of the statistical feature selection procedure.</p><p>We expect that applying our DWT-based classification approach with attention to generalization properties of classifiers, helps to obtain high recognition rates for the detection of cancer and to find biologically valuable and interpretable biomarkers. The molecular identification of the peaks and multi-laboratory validation of the experimental methods and the classification model is beyond the scope of this article. Based on the <italic>m</italic>/<italic>z</italic>-values of linear TOF spectra an identification is not possible and further biochemical and MS/MS experiments are required.</p></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material id="PMC_1" content-type="local-data"><caption><title>[Supplementary Data]</title></caption><media mimetype="text" mime-subtype="html" xlink:href="btn662_index.html"/><media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="btn662_1.pdf"/><media xlink:role="associated-file" mimetype="text" mime-subtype="plain" xlink:href="btn662_bioinf-2008-1033-File016.tex"/></supplementary-material></sec></body><back><ack><title>ACKNOWLEDGEMENTS</title><p>We thank Martijn van der Werff for contribution to an initial variant of the article, Marc Gerhard for help with ClinProTools software and Jens Fuchser for proofreading of the article.</p><p><italic>Conflict of Interest</italic>: none declared.</p></ack><ref-list><title>REFERENCES</title><ref id="B1"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Bartlett</surname><given-names>P</given-names></name><name><surname>Shawe-Taylor</surname><given-names>J</given-names></name></person-group><person-group person-group-type="editor"><name><surname>Sch&#x000f6;lkopf</surname><given-names>B</given-names></name></person-group><article-title>Generalization performance of support vector machines and other pattern classifiers</article-title><source>Advances in kernel methods: SV learning.</source><year>1999</year><publisher-loc>Cambridge, MA, USA</publisher-loc><publisher-name>MIT Press</publisher-name><fpage>43</fpage><lpage>54</lpage></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Check</surname><given-names>E</given-names></name></person-group><article-title>Proteomics and cancer: Running before we can walk?</article-title><source>Nature</source><year>2004</year><volume>429</volume><fpage>496</fpage><lpage>497</lpage><pub-id pub-id-type="pmid">15175721</pub-id></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Coombes</surname><given-names>KR</given-names></name><etal/></person-group><article-title>Serum proteomics profiling &#x02013; a young technology begins to mature</article-title><source>Nat. Biotechnol.</source><year>2005</year><volume>23</volume><fpage>291</fpage><lpage>292</lpage><pub-id pub-id-type="pmid">15765078</pub-id></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>de Noo</surname><given-names>M</given-names></name><etal/></person-group><article-title>Detection of colorectal cancer using MALDI-TOF serum protein profiling</article-title><source>Eur. J. Cancer</source><year>2006</year><volume>42</volume><fpage>1068</fpage><lpage>1076</lpage><pub-id pub-id-type="pmid">16603345</pub-id></citation></ref><ref id="B5"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Dudoit</surname><given-names>S</given-names></name><etal/></person-group><article-title>Multiple hypothesis testing in microarray experiments</article-title><source>Stat. Sci.</source><year>2003</year><volume>18</volume><fpage>71</fpage><lpage>103</lpage></citation></ref><ref id="B6"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Leung</surname><given-names>AK</given-names></name><etal/></person-group><article-title>A review on applications of wavelet transform techniques in chemical analysis: 1989&#x02013;1997</article-title><source>Chemometr. Intell. Lab.</source><year>1998</year><volume>43</volume><fpage>165</fpage><lpage>184</lpage></citation></ref><ref id="B7"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Mallat</surname><given-names>S</given-names></name></person-group><source>A wavelet tour of signal processing.</source><year>1999</year><publisher-loc>San Diego, CA, USA</publisher-loc><publisher-name>Acad. Press</publisher-name></citation></ref><ref id="B8"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Mertens</surname><given-names>BJ</given-names></name><etal/></person-group><article-title>Mass spectrometry proteomic diagnosis: enacting the double cross-validatory paradigm</article-title><source>J. Comput. Biol.</source><year>2006</year><volume>13</volume><fpage>1591</fpage><lpage>1605</lpage><pub-id pub-id-type="pmid">17147482</pub-id></citation></ref><ref id="B9"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Noble</surname><given-names>WS</given-names></name></person-group><person-group person-group-type="editor"><name><surname>Sch&#x000f6;lkopf</surname><given-names>B</given-names></name><etal/></person-group><article-title>Support vector machine applications in computational biology</article-title><source>Kernel Methods in Computational Biology.</source><year>2004</year><publisher-loc>Cambridge, MA</publisher-loc><publisher-name>MIT Press</publisher-name><fpage>71</fpage><lpage>92</lpage></citation></ref><ref id="B10"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Noble</surname><given-names>WS</given-names></name></person-group><article-title>What is a support vector machine?</article-title><source>Nat. Biotechnol.</source><year>2006</year><volume>24</volume><fpage>1565</fpage><lpage>1567</lpage><pub-id pub-id-type="pmid">17160063</pub-id></citation></ref><ref id="B11"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Petricoin</surname><given-names>EF</given-names></name><etal/></person-group><article-title>Use of proteomic patterns in serum to identify ovarian cancer</article-title><source>Lancet</source><year>2002</year><volume>359</volume><fpage>572</fpage><lpage>527</lpage><pub-id pub-id-type="pmid">11867112</pub-id></citation></ref><ref id="B12"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ransohoff</surname><given-names>DF</given-names></name></person-group><article-title>Rules of evidence for cancer molecular-marker discovery and validation</article-title><source>Nat. Rev. Cancer</source><year>2004</year><volume>4</volume><fpage>309</fpage><lpage>314</lpage><pub-id pub-id-type="pmid">15057290</pub-id></citation></ref><ref id="B13"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Schleif</surname><given-names>F-M</given-names></name><etal/></person-group><article-title>Support vector classification of proteomic profile spectra based on feature extraction with the bi-orthogonal discrete wavelet transform</article-title><source>Comput. Visual. Sci.</source><year>2007</year><comment>[Epub ahead of print, doi:10.1007/s00791-008-0087-z, March 7, 2008]</comment></citation></ref><ref id="B14"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Stone</surname><given-names>M</given-names></name></person-group><article-title>Cross-validatory choice and assessment of statistical predictions</article-title><source>J. Roy. Stat. Soc. B Met.</source><year>1974</year><volume>36</volume><fpage>111</fpage><lpage>147</lpage></citation></ref></ref-list></back></article>