<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd"><article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article" xml:lang="EN"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id><journal-id journal-id-type="publisher-id">bioinformatics</journal-id><journal-id journal-id-type="hwp">bioinfo</journal-id><journal-title>Bioinformatics</journal-title><issn pub-type="ppub">1367-4803</issn><issn pub-type="epub">1460-2059</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">18953044</article-id><article-id pub-id-type="pmc">2639304</article-id><article-id pub-id-type="doi">10.1093/bioinformatics/btn557</article-id><article-id pub-id-type="publisher-id">btn557</article-id><article-categories><subj-group subj-group-type="heading"><subject>Applications Note</subject><subj-group><subject>Genome Analysis</subject></subj-group></subj-group></article-categories><title-group><article-title>BASH: a tool for managing BeadArray spatial artefacts</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Cairns</surname><given-names>J. M.</given-names></name></contrib><contrib contrib-type="author"><name><surname>Dunning</surname><given-names>M. J.</given-names></name></contrib><contrib contrib-type="author"><name><surname>Ritchie</surname><given-names>M. E.</given-names></name></contrib><contrib contrib-type="author"><name><surname>Russell</surname><given-names>R.</given-names></name></contrib><contrib contrib-type="author"><name><surname>Lynch</surname><given-names>A. G.</given-names></name><xref ref-type="corresp" rid="COR1">*</xref></contrib></contrib-group><aff>Cancer Research UK, Cambridge Research Institute, Li Ka Shing Centre, Robinson Way, Cambridge, CB2 0RE, UK</aff><author-notes><corresp id="COR1">*To whom correspondence should be addressed.</corresp><fn><p>Associate Editor: Martin Bishop</p></fn></author-notes><pub-date pub-type="ppub"><day>15</day><month>12</month><year>2008</year></pub-date><pub-date pub-type="epub"><day>25</day><month>10</month><year>2008</year></pub-date><pub-date pub-type="pmc-release"><day>25</day><month>10</month><year>2008</year></pub-date><volume>24</volume><issue>24</issue><fpage>2921</fpage><lpage>2922</lpage><history><date date-type="received"><day>17</day><month>9</month><year>2008</year></date><date date-type="rev-recd"><day>23</day><month>10</month><year>2008</year></date><date date-type="accepted"><day>23</day><month>10</month><year>2008</year></date></history><permissions><copyright-statement>&#x000a9; 2008 The Author(s)</copyright-statement><copyright-year>2008</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/"><p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">http://creativecommons.org/licenses/by-nc/2.0/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</p></license></permissions><abstract><p><bold>Summary:</bold> With their many replicates and their random layouts, Illumina BeadArrays provide greater scope fordetecting spatial artefacts than do other microarray technologies. They are also robust to artefact exclusion, yet there is a lack of tools that can perform these tasks for Illumina. We present BASH, a tool for this purpose. BASH adopts the concepts of Harshlight, but implements them in a manner that utilizes the unique characteristics of the Illumina technology. Using bead-level data, spatial artefacts of various kinds can thus be identified and excluded from further analyses.</p><p><bold>Availability:</bold> The <italic>beadarray</italic> Bioconductor package (version 1.10 onwards), <ext-link ext-link-type="uri" xlink:href="www.bioconductor.org">www.bioconductor.org</ext-link></p><p><bold>Contact:</bold> <email>andy.lynch@cancer.org.uk</email></p><p><bold>Supplementary information:</bold> Additional information and a vignette are included in the <italic>beadarray</italic> package.</p></abstract></article-meta></front><body><sec sec-type="intro" id="SEC1"><title>1 INTRODUCTION</title><p>The existence of spatial artefacts in microarray imaging, and steps to identify, correct or remove them is an area of much research. Some methods are applied directly to intensity measurements using loess surfaces (Neuvial <italic>et al.</italic>, <xref ref-type="bibr" rid="B5">2006</xref>) or sliding windows (Song <italic>et al.</italic>, <xref ref-type="bibr" rid="B7">2007</xref>), while others work with deviations from average intensities calculated from replicate arrays (Reimersand Weinstein, <xref ref-type="bibr" rid="B6">2005</xref>; Stokes <italic>et al.</italic>, <xref ref-type="bibr" rid="B8">2007a</xref>; Su&#x000e1;rez-Fari&#x000f1;as <italic>et al.</italic>, <xref ref-type="bibr" rid="B10">2005</xref>; Upton and Lloyd, <xref ref-type="bibr" rid="B11">2005</xref>), mismatch probes (Li and Wong, <xref ref-type="bibr" rid="B4">2001</xref>) or replicate probes (Yuan and Irizarry, <xref ref-type="bibr" rid="B12">2006</xref>). Opinions differ over whether to adjust affected probes by a bias correction step, to replace affected probes by imputed values or to simply exclude such probes.</p><p>Illumina microarrays consist of a random arrangement of beads, where each bead type (i.e. beads carrying the same probe) occurs on the array many times (typically approximately 30 times). The benefit of bead-level data for the detection of spatial artefacts on Illumina arrays has been known for some time (Dunning <italic>et al.</italic>, <xref ref-type="bibr" rid="B1">2006</xref>, <xref ref-type="bibr" rid="B2">2007</xref>), however for Illumina microarrays there has been little work performed in this area. Illumina do remove &#x02018;outliers&#x02019;, but there is no spatial element to this step. Stokes <italic>et al.</italic> (<xref ref-type="bibr" rid="B9">2007b</xref>) have adapted their earlier work to address Illumina BeadArrays, but do not provide a tool for easy utilization.</p><p>Our preference is to adapt the Harshlight (Su&#x000e1;rez-Fari&#x000f1;as <italic>et al.</italic>, <xref ref-type="bibr" rid="B10">2005</xref>) concept to Illumina data, and to this end we present BASH &#x02018;BeadArray Subversion of Harshlight&#x02019; which forms part of the <italic>beadarray</italic> (Dunning <italic>et al.</italic>, <xref ref-type="bibr" rid="B2">2007</xref>) Bioconductor package.</p></sec><sec sec-type="methods" id="SEC2"><title>2 METHODS</title><p>Harshlight, as applied to Affymetrix data, constructs an &#x02018;Error Image&#x02019; for each array using the median values from replicate arrays. Three types of defect are then identified: &#x02018;Compact&#x02019; defects where large numbers of outlying values form a connected cluster, &#x02018;Diffuse&#x02019; defects where regions contain more outliers than would be anticipated by chance and &#x02018;Extended&#x02019; defects that reflect a chip-wide instability (perhaps a severe gradient across the microarray). With BASH we seek to perform a similar function for Illumina BeadArrays, but taking both account and advantage of the unique characteristics of Illumina BeadArray technologies.</p><p>Illumina arrays use a hexagonal (not rectangular) grid, with concave edges and missing observations, and we must first identify this grid. BASH requires knowledge of the direct neighbours of a bead, and the identities of other &#x02018;nearby&#x02019; beads. To avoid computationally intensive calculations at each step, the network of neighbours is fitted just once, and all later steps of BASH use this network to define their neighbourhoods. A bead's neighbours are defined as the <italic>n</italic> closest beads (3&#x02264;n&#x02264;6) for the largest <italic>n</italic> where the distance of the <italic>n</italic>-th farthest neighbour is less than <inline-formula><inline-graphic xlink:href="btn557i1.jpg"/></inline-formula> times the distance to the (<italic>n</italic>&#x02212;1)-th farthest. This network generation routine is useful for many purposes and we provide direct access to it as a separate function.</p><p>Compact defects are identified much as in Harshlight: outliers are identified, connected clusters of size greater than a specified minimum are labelled as compact defects and then an expansion and contraction step fills in any gaps. BASH differs from Harshlight in the compact defect step in three important ways: (i) the outliers are calculated within an array from the replicate beads, rather than from replicate arrays; (ii) the minimum size is specified rather than being estimated from simulated data; and (iii) the compact defect step is iterated rather than being performed once.</p><p>We do not estimate the minimum size from simulated data because content and layout varies between BeadArrays. To simulate data for each array would impose an unnecessary computational burden when, due to the redundancy built in to the Illumina platform, we can be conservative with our choice. BASH's iterative compact step is desirable because outliers are defined within an array using a threshold (by default Illumina's three median absolute deviations, MADs, from the median rule) rather than calling a fixed percentage of the beads as outliers based on errors calculated between arrays. Removing compact defects with BASH changes the rest of the &#x02018;error&#x02019; values on the array, since estimated medians and MADs will change. Also, since we do not force a percentage of points on the array to be called as outliers, then we can be confident that the iterative process will terminate in reasonable time (although a maximum number of iterations can be specified). This approach allows for the detection of less-obvious compact defects that would otherwise have been overshadowed by more prominent defects.</p><p>The error images that we generate for use in BASH are all calculated within an array. The default BASH error image returns, on the log<sub>2</sub> scale, the residual intensities after subtracting the median intensity for the appropriate bead-type. However, other filters can be applied to the error image including a local median subtraction, a local mean subtraction and a local MAD scaling. The appropriateness of these filters varies between technologies. In particular they have not proved useful for the arrays on a Sentrix Array Matrix, as these are too small to observe large gradients. Such filters are, though, useful for the larger BeadArrays, where low-frequency trends are observed, and in particular for the diffuse defect step.</p><p>Diffuse defects are areas containing unexpected numbers of (not necessarily connected) outliers. Compact defects should always be removed before running this step, and not subject to a contiguity test as performed in Harshlight, as BASH's within array calculation allows prominent compact defects to overshadow diffuse defects. The extended defect score is calculated much as Harshlight's, save for the use of our own definition of neighbourhood and error, but with BASH it can be used as a guide for manual intervention rather than automatically discarding the array. Large compact defects may drive such scores, or a spatial normalization may help to rectify the problem (perhaps manually removing the edges of the array where spatial normalization would be less robust). Alternatively, if the trend is approximately linear across the array, then we may simply observe increased variance in our estimates but little or no bias. Such an array can be down-weighted in an analysis (Dunning <italic>et al.</italic>, <xref ref-type="bibr" rid="B3">2008</xref>) rather than discarded.</p><p>BASH has been coded in R and C and is implemented in <italic>beadarray</italic>. Typically it takes less than 5 min per strip, and runs in &#x0003c;2.5 GB of RAM. A GUI for the manual drawing/editing of masks is also provided, for those occasions where the results of BASH are deemed undesirable. The BASH process returns, for each array, a list indicating beads that should be masked in all future summary and analysis steps. Due to the generally high levels of redundancy within the Illumina platform, we choose not to impute or correct observations within artefacts, but discard them knowing that we should still be able to estimate most of the properties that we desire. The representation of data in <italic>beadarray</italic> now allows for such information and the functions in <italic>beadarray</italic> will ignore beads that are so masked.</p><p><xref ref-type="fig" rid="F1">Figure 1</xref> presents BASH's results for one strip of an Illumina HumanWG-6 V3.0 BeadArray. Illumina's approach identifies 81 166 (of 1 042 243) beads as outliers, while BASHmasks 272 440, picking up many beads that Illumina missed in the affected regions. Of the many outliers outside of the artefacts, some may still be excluded in our analysis, but only if they are still outliers after artefact removal. All strips on this array have technical replicates, and forthis example BASH reduces the squared differences between the twin strips, summed over bead typeswith a RefSeq match, by 36%.<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>Outlier detection in a HumanWG 6 microarray and the areas masked for removal by BASH (the segmental structure of the strip is visible).</p></caption><graphic xlink:href="btn557f1"/></fig></p></sec><sec sec-type="discussion" id="SEC3"><title>3 DISCUSSION</title><p>BASH can be applied in a number of ways: as part of an automated preprocessing pipeline, to process arrays with apparent spatial artefacts, or merely to identify suspect arrays. BASH may require some initial tuning when dealing with a new technology or new laboratory, but has many adjustable parameters for doing so. There is scope for future improvement of BASH, such as incorporating transformations other than log<sub>2</sub>, or explicitly incorporating prior beliefs about the locations, sizes and shapes of defects. Additionally, questions such as &#x02018;what is the best way to identify defects on two-colour Illumina platforms?&#x02019; remain to be answered, although BASH allows for flexibility in this regard.</p><p>Spatial defects in Illumina arrays have not been widely reported because the majority of Illumina data are examined only at the summary level. Our example shows the value of doing more than just accepting Illumina's outliers and provides an additional incentive to work at the bead level, which brings with it many additional benefits. BASH requires at least a list of bead locations, identities and intensities, and users may have to adjust their scanner settings to obtain this information. BASH does not need to be perfect to be useful. Removing some defects is better than not removing any, and removing some &#x02018;good&#x02019; beads should not be catastrophic due to the redundancy on the platform.</p></sec></body><back><ack><title>ACKNOWLEDGEMENTS</title><p>We thank colleagues at the CRI for access to motivating data sets.</p><p><italic>Funding</italic>: The University of Cambridge, Cancer Research UK; Hutchison Whampoa Limited.</p><p><italic>Conflict of Interest</italic>: none declared.</p></ack><ref-list><title>REFERENCES</title><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Dunning</surname><given-names>M</given-names></name><etal/></person-group><article-title>Quality control and low-level statistical analysis of Illumina BeadArrays</article-title><source>REVSTAT</source><year>2006</year><volume>4</volume><fpage>1</fpage><lpage>30</lpage></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Dunning</surname><given-names>MJ</given-names></name><etal/></person-group><article-title>Beadarray: R classes and methods for Illumina bead-based data</article-title><source>Bioinformatics</source><year>2007</year><volume>23</volume><fpage>2183</fpage><lpage>2184</lpage><pub-id pub-id-type="pmid">17586828</pub-id></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Dunning</surname><given-names>MJ</given-names></name><etal/></person-group><article-title>Statistical issues in the analysis of Illumina data</article-title><source>BMC Bioinformatics</source><year>2008</year><volume>9</volume><fpage>85</fpage><pub-id pub-id-type="pmid">18254947</pub-id></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>C</given-names></name><name><surname>Wong</surname><given-names>WH</given-names></name></person-group><article-title>Model-based analysis of oligonucleotide arrays: expression index computation and outlier detection</article-title><source>Proc. Natl Acad. Sci. USA</source><year>2001</year><volume>98</volume><fpage>31</fpage><lpage>36</lpage><pub-id pub-id-type="pmid">11134512</pub-id></citation></ref><ref id="B5"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Neuvial</surname><given-names>P</given-names></name><etal/></person-group><article-title>Spatial normalization of array-CGH data</article-title><source>BMC Bioinformatics</source><year>2006</year><volume>7</volume><fpage>264</fpage><pub-id pub-id-type="pmid">16716215</pub-id></citation></ref><ref id="B6"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Reimers</surname><given-names>M</given-names></name><name><surname>Weinstein</surname><given-names>JN</given-names></name></person-group><article-title>Quality assessment of microarrays: visualization of spatial artifacts and quantitation of regional biases</article-title><source>BMC Bioinformatics</source><year>2005</year><volume>6</volume><fpage>166</fpage><pub-id pub-id-type="pmid">15992406</pub-id></citation></ref><ref id="B7"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Song</surname><given-names>JS</given-names></name><etal/></person-group><article-title>Microarray blob-defect removal improves array analysis</article-title><source>Bioinformatics</source><year>2007</year><volume>23</volume><fpage>966</fpage><lpage>971</lpage><pub-id pub-id-type="pmid">17332024</pub-id></citation></ref><ref id="B8"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Stokes</surname><given-names>TH</given-names></name><etal/></person-group><article-title>chip artifact CORRECTion (caCORRECT): a bioinformatics system for quality assurance of genomics and proteomics array data</article-title><source>Ann. Biomed. Eng.</source><year>2007a</year><volume>35</volume><fpage>1068</fpage><lpage>1080</lpage><pub-id pub-id-type="pmid">17458699</pub-id></citation></ref><ref id="B9"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Stokes</surname><given-names>TH</given-names></name><etal/></person-group><article-title>Extending microarray quality control and analysis algorithms to Illumina chip platform</article-title><source>Conf. Proc. IEEE Eng. Med. Biol. Soc.</source><year>2007b</year><volume>2007</volume><fpage>4637</fpage><lpage>4640</lpage><pub-id pub-id-type="pmid">18003039</pub-id></citation></ref><ref id="B10"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Su&#x000e1;rez-Fari&#x000f1;as</surname><given-names>M</given-names></name><etal/></person-group><article-title>&#x02018;Harshlighting&#x02019; small blemishes on microarrays</article-title><source>BMC Bioinformatics</source><year>2005</year><volume>6</volume><fpage>65</fpage><pub-id pub-id-type="pmid">15784152</pub-id></citation></ref><ref id="B11"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Upton</surname><given-names>GJG</given-names></name><name><surname>Lloyd</surname><given-names>JC</given-names></name></person-group><article-title>Oligonucleotide arrays: information from replication and spatial structure</article-title><source>Bioinformatics</source><year>2005</year><volume>21</volume><fpage>4162</fpage><lpage>4168</lpage><pub-id pub-id-type="pmid">16159921</pub-id></citation></ref><ref id="B12"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Yuan</surname><given-names>DS</given-names></name><name><surname>Irizarry</surname><given-names>RA</given-names></name></person-group><article-title>High-resolution spatial normalization for microarrays containing embedded technical replicates</article-title><source>Bioinformatics</source><year>2006</year><volume>22</volume><fpage>3054</fpage><lpage>3060</lpage><pub-id pub-id-type="pmid">17060357</pub-id></citation></ref></ref-list></back></article>