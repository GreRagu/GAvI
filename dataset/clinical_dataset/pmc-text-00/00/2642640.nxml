<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd"><article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article" xml:lang="EN"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id><journal-id journal-id-type="publisher-id">bioinformatics</journal-id><journal-id journal-id-type="hwp">bioinfo</journal-id><journal-title>Bioinformatics</journal-title><issn pub-type="ppub">1367-4803</issn><issn pub-type="epub">1460-2059</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">19074506</article-id><article-id pub-id-type="pmc">2642640</article-id><article-id pub-id-type="doi">10.1093/bioinformatics/btn638</article-id><article-id pub-id-type="publisher-id">btn638</article-id><article-categories><subj-group subj-group-type="heading"><subject>Original Papers</subject><subj-group><subject>Structural Bioinformatics</subject></subj-group></subj-group></article-categories><title-group><article-title>NOE<italic>net</italic>&#x02013;Use of NOE networks for NMR resonance assignment of proteins with known 3D structure</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Stratmann</surname><given-names>Dirk</given-names></name></contrib><contrib contrib-type="author"><name><surname>van Heijenoort</surname><given-names>Carine</given-names></name><xref ref-type="corresp" rid="COR1">*</xref></contrib><contrib contrib-type="author"><name><surname>Guittet</surname><given-names>Eric</given-names></name><xref ref-type="corresp" rid="COR1">*</xref></contrib></contrib-group><aff>Laboratoire de Chimie et Biologie Structurales, ICSN-CNRS, Gif-sur-Yvette, France</aff><author-notes><corresp id="COR1">*To whom correspondence should be addressed.</corresp><fn><p>Associate Editor: Anna Tramontano</p></fn></author-notes><pub-date pub-type="ppub"><day>15</day><month>2</month><year>2009</year></pub-date><pub-date pub-type="epub"><day>12</day><month>12</month><year>2008</year></pub-date><pub-date pub-type="pmc-release"><day>12</day><month>12</month><year>2008</year></pub-date><volume>25</volume><issue>4</issue><fpage>474</fpage><lpage>481</lpage><history><date date-type="received"><day>11</day><month>9</month><year>2008</year></date><date date-type="rev-recd"><day>18</day><month>11</month><year>2008</year></date><date date-type="accepted"><day>9</day><month>12</month><year>2008</year></date></history><permissions><copyright-statement>&#x000a9; 2008 The Author(s)</copyright-statement><copyright-year>2008</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/"><p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">http://creativecommons.org/licenses/by-nc/2.0/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</p></license></permissions><abstract><p><bold>Motivation:</bold> A prerequisite for any protein study by NMR is the assignment of the resonances from the <sup>15</sup><italic>N</italic>&#x02212;<sup>1</sup><italic>H</italic> HSQC spectrum to their corresponding atoms of the protein backbone. Usually, this assignment is obtained by analyzing triple resonance NMR experiments. An alternative assignment strategy exploits the information given by an already available 3D structure of the same or a homologous protein. Up to now, the algorithms that have been developed around the structure-based assignment strategy have the important drawbacks that they cannot guarantee a high assignment accuracy near to 100%.</p><p><bold>Results:</bold> We propose here a new program, called NOE<italic>net</italic>, implementing an efficient complete search algorithm that ensures the correctness of the assignment results. NOE<italic>net</italic> exploits the network character of unambiguous NOE constraints to realize an exhaustive search of all matching possibilities of the NOE network onto the structural one. NOE<italic>net</italic> has been successfully tested on EIN, a large protein of 28 kDa, using only NOE data. The complete search of NOE<italic>net</italic> finds all possible assignments compatible with experimental data that can be defined as an <italic>assignment ensemble</italic>. We show that multiple assignment possibilities of large NOE networks are restricted to a small <italic>spatial assignment range (SAR)</italic>, so that assignment ensembles, obtained from accessible experimental data, are precise enough to be used for functional proteins studies, like protein&#x02013;ligand interaction or protein dynamics studies. We believe that NOE<italic>net</italic> can become a major tool for the structure-based backbone resonance assignment strategy in NMR.</p><p><bold>Availability:</bold> The NOE<italic>net</italic> program will be available under: <ext-link ext-link-type="uri" xlink:href="http://www.icsn.cnrs-gif.fr/download/nmr">http://www.icsn.cnrs-gif.fr/download/nmr</ext-link></p><p><bold>Contact:</bold> <email>carine@icsn.cnrs-gif.fr</email>; <email>eric.guittet@icsn.cnrs-gif.fr</email></p><p><bold>Supplementary Information:</bold> <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn638/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p></abstract></article-meta></front><body><sec sec-type="intro" id="SEC1"><title>1 INTRODUCTION</title><p>In order to resolve the molecular mechanism of proteins function, the structural biology community has made huge efforts to determine 3D structures of proteins at atomic resolution. Proteins function is not solely inferred from the tridimensional structure of the protein, but also from its interactions with other partners and from its dynamical and energetic properties. Consequently, even if the tridimensional structure of the free protein is known, it is necessary to study protein&#x02013;ligand or protein&#x02013;protein interactions and protein dynamics. Solution nuclear magnetic resonance (NMR) is a method of choice for those studies, through its unique ability to probe local dynamics and local environment changes. However, to obtain information at atomic resolution, NMR resonances first have to be assigned to their corresponding atoms in the protein.</p><p>With the availability of 3D structures for a large number of proteins, <italic>structure-based</italic> assignment strategies have been proposed. Several types of experimental NMR data can be correlated with the 3D structure. NOESY cross peaks (NOEs) between resonances correspond to spatially neighbouring atoms. Residual dipolar couplings (RDCs) measured in weakly aligning media are correlated with the orientation of the inter-atomic vector with respect to the magnetic field. Chemical shifts (CS) are nowadays more and more accurately predicted from the knowledge of the 3D structure (Neal <italic>et al.</italic>, <xref ref-type="bibr" rid="B18">2003</xref>; Shen and Bax, <xref ref-type="bibr" rid="B24">2007</xref>). The comparison of these experimental data with the 3D structure yields the assignment constraints. This exploitation of the data cannot be done manually due to the important combinatorics to accomplish.</p><p>The existing structure-based assignment strategies require several different NMR data sources. For example, the <italic>nuclear vector replacement</italic> (NVR) algorithm (Apaydin <italic>et al.</italic>, <xref ref-type="bibr" rid="B1">2008</xref>; Langmead and Donald, <xref ref-type="bibr" rid="B13">2004</xref>; Langmead <italic>et al.</italic>, <xref ref-type="bibr" rid="B14">2004</xref>) uses unambiguous <sup>1</sup><italic>H</italic><sup><italic>N</italic></sup>&#x02212;<sup>1</sup><italic>H</italic><sup><italic>N</italic></sup> NOE-connectivity information, <sup>15</sup><italic>N</italic>&#x02212;<sup>1</sup><italic>H</italic><sup><italic>N</italic></sup> RDCs obtained in two different alignment media, <sup>15</sup><italic>N</italic> and <sup>1</sup><italic>H</italic><sup><italic>N</italic></sup> chemical shifts and results from H-D exchange experiment. It has been tested on two small proteins and one moderate size protein (lysozyme, 129 amino acids). Another approach (Xiong <italic>et al.</italic>, <xref ref-type="bibr" rid="B28">2008</xref>), called <italic>contact replacement</italic>, is not based on RDCs but on <sup>1</sup><italic>H</italic><sup><italic>N</italic></sup>&#x02212;<sup>1</sup><italic>H</italic><sup><italic>N</italic></sup> and <sup>1</sup><italic>H</italic><sup><italic>N</italic></sup>&#x02212;<sup>1</sup><italic>H</italic><sup>&#x003b1;</sup> NOEs for the identification of the secondary structures. It also requires a TOCSY experiment for the estimation of the amino acid class of each <sup>15</sup><italic>N</italic>&#x02212;<sup>1</sup><italic>H</italic> HSQC peak. The TOCSY data are analyzed by the program RESCUE (Pons and Delsuc, <xref ref-type="bibr" rid="B20">1999</xref>) that classifies each <sup>15</sup><italic>N</italic>&#x02212;<sup>1</sup><italic>H</italic> HSQC peak in one of 10 amino acid classes with an accuracy higher than 88%. The contact replacement approach has been tested on three moderate size proteins (up to 166 amino acids) with experimental data. The overall assignment accuracy varied from 60% to 80%, which is not sufficient in our opinion, as a typical NMR user will only trust automated assignment strategies, if they yield accuracies near to 100%. The low accuracy of the contact replacement approach is probably due to the use of highly ambiguous NOE data obtained from a 3D NOESY experiment, as well as to the translation of the RESCUE output into hard constraints.</p><p>Both approaches, the NVR and the contact replacement, will be difficult to apply to large proteins, the first because of increased ambiguity of RDC assignment constraints and the second because of the increased overlap in TOCSY spectra. The PEPMORPH approach (Erdmann and Rule, <xref ref-type="bibr" rid="B7">2002</xref>) has been tested on synthetic datasets of proteins with a size up to 414 amino acids. It combines NOE and RDC data, it relies on unambiguous <sup>1</sup><italic>H</italic><sup><italic>N</italic></sup>&#x02212;<sup>1</sup><italic>H</italic><sup><italic>N</italic></sup> NOEs and two RDCs per residue of the spin pairs <sup>15</sup><italic>N</italic>&#x02212;<sup>13</sup><italic>C</italic>&#x02032;, <sup>15</sup><italic>N</italic>&#x02212;<sup>13</sup><italic>C</italic><sup>&#x003b1;</sup>. The authors represent the NOE data and the 3D structure as mathematical graphs and the algorithm matches the NOE graph onto the 3D structure graph to obtain the assignment. Unfortunately, the PEPMORPH approach has only been tested on synthetic datasets that were highly idealized in comparison to realistic experimental datasets.</p><p>The complete list of structure-based assignment strategies is to our knowledge given by the following references: Dobson <italic>et al.</italic> (<xref ref-type="bibr" rid="B6">1984</xref>), Bartels <italic>et al.</italic> (<xref ref-type="bibr" rid="B4">1996</xref>), Gronwald <italic>et al.</italic> (<xref ref-type="bibr" rid="B10">1998</xref>), Bailey-Kellogg <italic>et al.</italic> (<xref ref-type="bibr" rid="B2">2000</xref>), Pristovsek <italic>et al.</italic> (<xref ref-type="bibr" rid="B22">2002</xref>), Pristovsek and Franzoni (<xref ref-type="bibr" rid="B21">2006</xref>), Hus <italic>et al.</italic> (<xref ref-type="bibr" rid="B11">2002</xref>), Erdmann and Rule, (<xref ref-type="bibr" rid="B7">2002</xref>), Pintacuda <italic>et al.</italic> (<xref ref-type="bibr" rid="B19">2004</xref>), Langmead <italic>et al.</italic> (<xref ref-type="bibr" rid="B14">2004</xref>), Langmead and Donald (<xref ref-type="bibr" rid="B13">2004</xref>), Apaydin <italic>et al.</italic> (<xref ref-type="bibr" rid="B1">2008</xref>), Xiong and Bailey-Kellogg (<xref ref-type="bibr" rid="B27">2007</xref>) and Xiong <italic>et al.</italic> (<xref ref-type="bibr" rid="B28">2008</xref>). Despite the long list, we failed to find an approach that is applicable to large proteins and that always yields high accuracies near to 100%. The structure-based assignment problem can be translated into either a constrained bipartite matching problem (like for NVR) or a subgraph matching problem (like for contact replacement or PEPMORPH). Both problems are non-polynomial (NP)-hard, so that exact complete search algorithms solving the structure-based assignment problem can require a runtime increasing exponentially with the protein size. Because of this fact, the majority of structure-based assignment strategies use incomplete optimization algorithms giving a limited number of solutions (often only one global assignment), with the drawback that their accuracy is difficult to assess. As it is crucial to guarantee high accuracies near to 100%, we decided to explore the feasibility of an exact complete search algorithm for the structure-based assignment of large proteins.</p><p>We present here a new structure-based NMR assignment program, called NOE<italic>net</italic> that exploits the network feature of the NOE-connectivities of unambiguous <sup>1</sup><italic>H</italic><sup><italic>N</italic></sup>&#x02212;<sup>1</sup><italic>H</italic><sup><italic>N</italic></sup> NOEs and the 3D structure of the protein. Instead of searching for a unique global assignment, whose accuracy is difficult to assess, our goal was to determine an <italic>assignment ensemble</italic>, containing all possible assignments compatible with the available NMR data. The complete search algorithm of NOE<italic>net</italic> ensures that the correct assignment is always part of the obtained assignment ensemble, if no erroneous constraint is introduced along the search process. Multiple assignment possibilities are spatially restricted by the assignment constraints. We thus introduce a quality factor for multiple assignments through the concept of <italic>SAR</italic>. We demonstrate here that restrained multiple assignments can be exploited for numerous NMR applications, like protein&#x02013;ligand or protein&#x02013;protein interaction.</p></sec><sec sec-type="methods" id="SEC2"><title>2 METHODS</title><p><bold><italic>The assignment problem</italic>:</bold> the <sup>15</sup><italic>N</italic>-HSQC <italic>assignment problem</italic> consists in finding the assignment of the set of <italic>N</italic><sub><italic>P</italic></sub> (<sup>15</sup><italic>N</italic>, <sup>1</sup><italic>H</italic>) <italic>resonances</italic> (also called <italic>peaks</italic>) <italic>P</italic>={<italic>p</italic><sub>1</sub>, <italic>p</italic><sub>2</sub>,&#x02026;,<italic>p</italic><italic>N</italic><sub><italic>P</italic></sub>} to the corresponding amino acid <italic>R</italic>={<italic>r</italic><sub>1</sub>,<italic>r</italic><sub>2</sub>,&#x02026;,<italic>r</italic><italic>N</italic><sub><italic>R</italic></sub>} in the protein sequence. A <italic>peak assignment</italic> defines the assignment of a single peak <italic>p</italic><sub><italic>k</italic></sub>: <italic>p</italic><sub><italic>k</italic></sub>&#x02192;<italic>r</italic><sub><italic>i</italic></sub> or, in a simplified notation, <italic>k</italic>&#x02192;<italic>i</italic>. The set of <italic>peak assignment possibilities</italic> for a peak <italic>p</italic><sub><italic>k</italic></sub> is <italic>k</italic>&#x02192;<italic>i</italic><sub>1</sub>,<italic>i</italic><sub>2</sub>,&#x02026;,<italic>i</italic><sub><italic>n</italic><italic>k</italic></sub> with <italic>n</italic><sub><italic>k</italic></sub> being the number of <italic>assignment possibilities</italic> for the peak <italic>p</italic><sub><italic>k</italic></sub>. The <italic>list of peak assignment possibilities</italic> contains the peak assignment possibilities for all peaks: <italic>k</italic>&#x02192;<italic>i</italic><sub>1</sub>,<italic>i</italic><sub>2</sub>,&#x02026;,<italic>i</italic><sub><italic>n</italic><sub><italic>k</italic></sub></sub> for <italic>k</italic>=1,&#x02026;,<italic>N</italic><sub><italic>P</italic></sub>. Two peaks <italic>k</italic> and <italic>l</italic> can share the same assignment possibility <italic>i</italic><sub><italic>k</italic></sub>=<italic>i</italic><sub><italic>l</italic></sub> in the list of peak assignment possibilities. A <italic>global assignment</italic> defines an assignment of all peaks <italic>p</italic><sub><italic>k</italic></sub>&#x02192;<italic>r</italic><sub><italic>i</italic><sub><italic>k</italic></sub></sub> for <italic>k</italic>=1,&#x02026;,<italic>N</italic><sub><italic>P</italic></sub> with <italic>i</italic><sub><italic>k</italic></sub>&#x02208;{1,&#x02026;,<italic>N</italic><sub><italic>R</italic></sub>} and <italic>i</italic><sub><italic>k</italic></sub>&#x02260;<italic>i</italic><sub><italic>l</italic></sub>&#x02200;<italic>k</italic>&#x02260;<italic>l</italic>. As the number of global assignments increases exponentially with the number of multiple peak assignments, it is in general impossible to give the full list of global assignments, especially for sparse data. Only the list of peak assignment possibilities can always be obtained. It characterizes the <italic>assignment ensemble</italic> that should comprise all global assignments compatible with the data. Only one of the compatible global assignments is the <italic>correct global assignment</italic> or <italic>correct assignment</italic>. Using sparse data, it is in general impossible to reliably find only the correct assignment. It is nevertheless possible to obtain an <italic>accuracy</italic> of 100%, meaning that the assignment ensemble contains among other compatible assignments also the correct assignment. The accuracy is defined in this context as 1&#x02212;<italic>N</italic><sub><italic>e</italic></sub>/<italic>N</italic><sub><italic>P</italic></sub> with <italic>N</italic><sub><italic>e</italic></sub> the number of peaks that do not have the correct assignment in their list of assignment possibilities and <italic>N</italic><sub><italic>P</italic></sub> the number of peaks. The quality of an assignment ensemble is not only given by its accuracy, but also by its <italic>completeness</italic>. We define two types of completeness: first the unicity completeness describing the ratio of the number of uniquely and correctly assigned peaks to the total number of peaks: <italic>C</italic><sub>1</sub>=<italic>N</italic><sub><italic>unique</italic></sub>/<italic>N</italic><sub><italic>P</italic></sub>. The peaks with multiple assignment possibilities can be classified by a quality factor obtained with the available 3D structure of the protein. To obtain this quality factor, we calculate the inter-residue spatial <sup>1</sup><italic>H</italic><sup><italic>N</italic></sup>&#x02212;<sup>1</sup><italic>H</italic><sup><italic>N</italic></sup> distances for all residue pairs taken from the peak assignment possibilities for a specific peak <italic>p</italic><sub><italic>k</italic></sub>. We define the <italic>SAR</italic> as the maximum of those distances and calculate it for each peak. This allows us to define a second type of completeness: the ratio between the number of peaks with a SAR-value below a given threshold (typically 10 &#x000c5;) to the total number of peaks: <italic>C</italic><sub>2</sub>(&#x0003c;10&#x000c5;)=<italic>N</italic><sub><italic>SAR</italic>&#x0003c;10<italic>A</italic></sub>/<italic>N</italic><sub><italic>P</italic></sub>. The uniquely assigned peaks are given a SAR-value of zero.</p><p><bold><italic>Input NMR data</italic>:</bold> the minimal input for NOE<italic>net</italic> is a list of unambiguous <sup>1</sup><italic>H</italic><sup><italic>N</italic></sup>&#x02212;<sup>1</sup><italic>H</italic><sup><italic>N</italic></sup> NOEs and the 3D structure in the Protein Data Bank (PDB) file format. Unambiguous NOEs means that each NOE cross peak can be related to exactly two unambiguous resonances of the <sup>15</sup><italic>N</italic>&#x02212;<sup>1</sup><italic>H</italic> HSQC spectrum.</p><p>Beside the peaks of the (<sup>15</sup><italic>N</italic>,<sup>1</sup><italic>H</italic>) atom-pairs of the protein backbone, some peaks correspond to the (<sup>15</sup><italic>N</italic>,<sup>1</sup><italic>H</italic>) atom-pairs of side-chains. Especially, the tryptophan (TRP) side-chains generate (<sup>15</sup><italic>N</italic>,<sup>1</sup><italic>H</italic>) peaks that are not distinguishable from the peaks corresponding to the backbone of the protein. We included the TRP side-chains as additional pseudo-residues. The peak doublets corresponding to <italic>NH</italic><sub>2</sub> groups of side-chains are assumed to be identified by their identical <sup>15</sup><italic>N</italic> frequency, and were not included as assignment possibility.</p><p><bold><italic>The conceptual bases of NOEnet</italic></bold>: the main idea of NOE<italic>net</italic> is to sample all possible matches of the whole NOE network onto the connectivity network of the 3D structure. In terms of graph theory, the algorithmic problem is to find all possible <italic>subgraph monomorphisms</italic> or <italic>graph matchings</italic>; it belongs to the class of NP-hard problems. No polynomial-time algorithm has been found for NP-hard problems. Previously used algorithms for structure-based assignment are mostly incomplete search algorithms that yield a solution in polynomial time, but do not guarantee the correctness of this solution. NOE<italic>net</italic> employs a complete search algorithm, giving no guarantee for a limited runtime, but ensuring the correctness of the obtained assignment ensemble. In opposition to algorithms that search one or several assignment solutions, NOE<italic>net</italic> searches iteratively the assignment impossibilities, while ensuring that the correct assignment is not removed. At the beginning of the search, all peak assignments are in the (<italic>n</italic><sub><italic>peaks</italic></sub>&#x000d7;<italic>n</italic><sub><italic>residues</italic></sub>) <italic>assignment table A</italic>. During the search, impossible peak assignments are removed from <italic>A</italic>. NOE<italic>net</italic> makes several refinement cycles, returning each time an assignment ensemble in form of the assignment table <italic>A</italic> that will have less assignment possibilities on each cycle. This approach allows the exploitation of the current result, even if the complete search is still not finished. In general, the first cycle will return rapidly an assignment ensemble almost as good as the final assignment ensemble. The complete search is limited by different types of <italic>thresholds</italic>, whose optimal values depend on the data source and its quality. The first threshold is the <sup>1</sup><italic>H</italic><sup><italic>N</italic></sup>&#x02212;<sup>1</sup><italic>H</italic><sup><italic>N</italic></sup> <italic>theoretical distance threshold d</italic><sub><italic>max</italic></sub><sup><italic>theo</italic></sup> that is used to generate the connectivity network of the 3D structure. The complexity of the connectivity network and of the complete search increases with this threshold. As long as each NOE has its corresponding <sup>1</sup><italic>H</italic><sup><italic>N</italic></sup>&#x02212;<sup>1</sup><italic>H</italic><sup><italic>N</italic></sup> distance satisfied under the correct assignment, the complete search ensures the correct assignment to be included in the assignment ensemble. The accuracy will always be of 100% in those cases. If one or several NOEs do not have their correct <sup>1</sup><italic>H</italic><sup><italic>N</italic></sup>&#x02212;<sup>1</sup><italic>H</italic><sup><italic>N</italic></sup> distance in the structure, the correct assignment is likely to be excluded from the assignment ensemble, whose accuracy will drop below 100%. As NOE<italic>net</italic> treats the NOE network globally, erroneous NOEs will create inconsistencies for the graph matching that can be detected by the occurrence of <italic>holes</italic> in the assignment list, meaning that some peaks have no assignment possibility left.</p><p><bold><italic>Graph Representation</italic>:</bold> the NOE network is represented by the <italic>experimental NOE interaction graph G</italic><sup><italic>exp</italic></sup>={<italic>V</italic><sup><italic>exp</italic></sup>,<italic>E</italic><sup><italic>exp</italic></sup>}. Its nodes <inline-formula><inline-graphic xlink:href="btn638i1.jpg"/></inline-formula> are the resonances from the <sup>15</sup><italic>N</italic>&#x02212;<sup>1</sup><italic>H</italic> HSQC. Its edges <inline-formula><inline-graphic xlink:href="btn638i2.jpg"/></inline-formula> are the <italic>N</italic><sub><italic>NOEs</italic></sub> unambiguous NOESY cross peaks. The 3D structure of the protein is represented by the <italic>theoretical contact graph G</italic><sup><italic>theo</italic></sup>={<italic>V</italic><sup><italic>theo</italic></sup>,<italic>E</italic><sup><italic>theo</italic></sup>}. Its nodes <inline-formula><inline-graphic xlink:href="btn638i3.jpg"/></inline-formula> are the <sup>1</sup><italic>H</italic><sup><italic>N</italic></sup> atoms of the protein backbone and tryptophan side chains. Its edges <inline-formula><inline-graphic xlink:href="btn638i4.jpg"/></inline-formula> connect all pairs of nodes whose associated amide protons <sup>1</sup><italic>H</italic><sup><italic>N</italic></sup> are within a specified <italic>distance threshold d</italic><sub><italic>max</italic></sub><sup><italic>theo</italic></sup>. Each contact in the 3D structure is a possible partner for a NOE-constraint. Before the graph matching step, <italic>G</italic><sup><italic>exp</italic></sup> and <italic>G</italic><sup><italic>theo</italic></sup> are first preprocessed to optimize the matching procedure by searching for high-level structures called simplices and polytopes (<xref ref-type="fig" rid="F1">Fig. 1</xref>a). A <italic>n-dimensional simplex</italic> or <italic>n-simplex</italic> is a set of <italic>n</italic>+1 nodes <italic>S</italic><sub><italic>n</italic></sub>={<italic>v</italic><sub>1</sub>,&#x02026;,<italic>v</italic><sub><italic>n</italic>+1</sub>}, where each node of <italic>S</italic><sub><italic>n</italic></sub> has an edge to each other node of <italic>S</italic><sub><italic>n</italic></sub>. In geometry, a 0-simplex is a point, a 1-simplex is a line segment, a 2-simplex is a triangle and a 3-simplex is a tetrahedron. <italic>n</italic>-dimensional simplices can then be grouped into <italic>n</italic>-Dimensional <italic>polytopes</italic>, by a specific adjacency relation: two <italic>n</italic>-simplices of the same dimension <italic>n</italic> are adjacent, if the number of nodes they have in common is equal to <italic>n</italic>. We will call the nodes shared by two simplices the <italic>simplex interface</italic>, that is, a lower dimensional simplex. We define adjacent simplices as <italic>neighbours</italic> and the adjacency relation as <italic>neighbourship relation</italic>. A polytope is <italic>perfect</italic> or <italic>simple</italic> (as used in PEPMORPH (Erdmann and Rule, <xref ref-type="bibr" rid="B7">2002</xref>)), if there is only one neighbour per simplex interface, i.e. if each interface belongs to exactly two simplices. Otherwise, more than two simplices [multiple neighbours (<xref ref-type="fig" rid="F1">Fig. 1</xref>b)] share the same interface. PEPMORPH (Erdmann and Rule, <xref ref-type="bibr" rid="B7">2002</xref>) only matches perfect polytopes, whereas our approach can use every possible network configuration by the full combinatorial treatment of multiple neighbours. In order to represent all possible networks with simplices, the neighbourship definition was relaxed to a <italic>general neighbourship</italic> concept: for two simplices to be identified as neighbours, it is sufficient that they share at least one node (<xref ref-type="fig" rid="F1">Fig. 1</xref>c). Contrary to the PEPMORPH algorithm that considers only matches between perfect polytopes, the two extensions&#x02014;multiple neighbours and general neighbourship&#x02014;enable the use of the whole available NOE network as constraint, without any decomposition into perfect polytopes, for the full exploitation of the experimental data. Additionally, we also extended the matching possibilities: a <italic>n</italic>-simplex can be matched on all simplices with a dimension <italic>d</italic>&#x02265;<italic>n</italic>. The restriction of the matching possibilities to polytopes with the same dimension can indeed induce errors, due to the lower density of the experimental NOE network compared with the 3D structure network.<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>(<bold>a</bold>) Simplices and (simple) polytopes; (<bold>b</bold>) multiple neighbours; (<bold>c</bold>) generalized polytope.</p></caption><graphic xlink:href="btn638f1"/></fig></p><p><bold><italic>Graph matching</italic>:</bold> the assignment problem is solved by identifying all peak assignment possibilities that are compatible with the assignment constraints. Therefore, NOE<italic>net</italic> tries to find all possible graph matches of <italic>G</italic><sup><italic>exp</italic></sup> onto <italic>G</italic><sup><italic>theo</italic></sup> (<xref ref-type="fig" rid="F2">Fig. 2</xref>a). The graph <italic>G</italic><sup><italic>exp</italic></sup> is in general composed of several disconnected <italic>fragments</italic>. A <italic>fragment F</italic><sub><italic>i</italic></sub><sup><italic>exp</italic></sup>={<italic>V</italic><sub><italic>i</italic></sub><sup><italic>exp</italic></sup>,<italic>E</italic><sub><italic>i</italic></sub><sup><italic>exp</italic></sup>} is a connected subgraph from <italic>G</italic><sup><italic>exp</italic></sup>. The matching process is done sequentially for each fragment <italic>F</italic><sub><italic>i</italic></sub><sup><italic>exp</italic></sup>, beginning with the largest fragment <italic>F</italic><sub><italic>max</italic></sub><sup><italic>exp</italic></sup>. The intermediate assignment table <italic>A</italic> (<xref ref-type="fig" rid="F2">Fig. 2</xref>b) is then used as a constraint for the matching processes of the next smaller fragments <italic>F</italic><sub><italic>i</italic>&#x02212;1</sub><sup><italic>exp</italic></sup>.<fig id="F2" position="float"><label>Fig. 2.</label><caption><p>(<bold>a</bold>) Simple example of polytope matching possibilities: the experimental NOE-network (in blue) is matched onto the theoretical distance-network (in green) in different ways. (<bold>b</bold>) Example of an assignment table.</p></caption><graphic xlink:href="btn638f2"/></fig></p><p><bold><italic>Fragment matching</italic>:</bold> the fragment matching is done by a backtracking algorithm (Dechter, <xref ref-type="bibr" rid="B5">2003</xref>). A <italic>startsimplex S</italic><sub><italic>i</italic>1</sub><sup><italic>exp</italic></sup> is chosen randomly among the simplices of the current fragment <italic>F</italic><sub><italic>i</italic></sub><sup><italic>exp</italic></sup>. Every simplex of <italic>F</italic><sub><italic>i</italic></sub><sup><italic>exp</italic></sup> becomes one time the <italic>startsimplex</italic>, as explained at the end of this subsection. Before each backtracking search, a variable ordering is determined, the variables being the simplices <italic>S</italic><sub><italic>ij</italic></sub><sup><italic>exp</italic></sup> of <italic>F</italic><sub><italic>i</italic></sub><sup><italic>exp</italic></sup>. Beginning at the <italic>startsimplex S</italic><sub><italic>i</italic>1</sub><sup><italic>exp</italic></sup>,the next simplices <italic>S</italic><sub><italic>i</italic>2</sub><sup><italic>exp</italic></sup>,<italic>S</italic><sub><italic>i</italic>3</sub><sup><italic>exp</italic></sup>,&#x02026;,<italic>S</italic><sub><italic>iN</italic></sub><sup><italic>exp</italic></sup> are determined by a breadth first search (BFS) (Sedgewick, <xref ref-type="bibr" rid="B23">2002</xref>) on the <italic>graph of simplices G</italic><sup><italic>expSimp</italic></sup>={<italic>V</italic><sup><italic>expSimp</italic></sup>,<italic>E</italic><sup><italic>expSimp</italic></sup>}. <italic>G</italic><sup><italic>exp</italic></sup> is the graph of the peaks connected by NOEs, whereas <italic>G</italic><sup><italic>expSimp</italic></sup> is the graph of the simplices connected by the general neighbourship definition. The obtained variable ordering remains fixed during the whole fragment matching for the specific startsimplex <italic>S</italic><sub><italic>i</italic>1</sub><sup><italic>exp</italic></sup>. We also tested a variable ordering obtained by a depth first search (DFS) (Sedgewick, <xref ref-type="bibr" rid="B23">2002</xref>), but found that the ordering obtained by a breadth first search resulted in a much better performance on average.</p><p>The goal of the fragment matching is to find all possible matches of the startsimplex <italic>S</italic><sub><italic>i</italic>1</sub><sup><italic>exp</italic></sup> on the graph of theoretical simplices <italic>G</italic><sup><italic>theoSimp</italic></sup>={<italic>V</italic><sup><italic>theoSimp</italic></sup>,<italic>E</italic><sup><italic>theoSimp</italic></sup>}. One possible matching is found in the following way: first, the <italic>n-dimensional simplex S</italic><sub><italic>i</italic>1</sub><sup><italic>exp</italic></sup> is matched to any <italic>S</italic><sub><italic>k</italic></sub><sup><italic>theo</italic></sup> with the same or higher dimension. For each simplex to simplex matching all possible permutations on the nodes level are tested [(<italic>n</italic>+1)! node permutations for the <italic>n</italic>-Dimensional startsimplex]. A particular match <italic>m</italic><sub>1</sub> of the startsimplex <italic>S</italic><sub><italic>i</italic>1</sub><sup><italic>exp</italic></sup> is the assignment of the nodes of <italic>S</italic><sub><italic>i</italic>1</sub><sup><italic>exp</italic></sup> to the nodes of <italic>S</italic><sub><italic>k</italic></sub><sup><italic>theo</italic></sup> with a specific permutation on the nodes level. <italic>m</italic><sub>1</sub> is validated, if all other simplices of fragment <italic>F</italic><sub><italic>i</italic></sub><sup><italic>exp</italic></sup> can be matched onto <italic>G</italic><sup><italic>theoSimp</italic></sup> without overlapping and under the constraint of the initial matching <italic>m</italic><sub>1</sub> of <italic>S</italic><sub><italic>i</italic>1</sub><sup><italic>exp</italic></sup>. Therefore, <italic>m</italic><sub>1</sub> is extended with the predefined variable ordering of the simplices <italic>S</italic><sub><italic>i</italic>2</sub><sup><italic>exp</italic></sup>,<italic>S</italic><sub><italic>i</italic>3</sub><sup><italic>exp</italic></sup>,&#x02026;,<italic>S</italic><sub><italic>iN</italic></sub><sup><italic>exp</italic></sup> by a backtracking algorithm. If <italic>m</italic><sub>1</sub> can be validated, the found fragment match <italic>M</italic>={<italic>m</italic><sub>1</sub>,<italic>m</italic><sub>2</sub>,&#x02026;,<italic>m</italic><sub><italic>N</italic></sub>} is registered as possible and is reused in further iterations to reduce the runtime. The corresponding peak to residues assignments are also registered as possible in the <italic>assignment table A</italic>. If <italic>m</italic><sub>1</sub> cannot be validated, <italic>m</italic><sub>1</sub> is registered as impossible but not the corresponding peak to residues assignments. Only the simultaneous assignment of all nodes of <italic>S</italic><sub><italic>i</italic>1</sub><sup><italic>exp</italic></sup> defined by <italic>m</italic><sub>1</sub> can be excluded and not the independent assignment at the peak-level. A change of the assignment of only one peak of <italic>S</italic><sub><italic>i</italic>1</sub><sup><italic>exp</italic></sup> can indeed generate a possible matching <italic>m</italic><sub>1</sub><sup>*</sup>&#x02260;<italic>m</italic><sub>1</sub>.</p><p>Once a fragment match <italic>M</italic>={<italic>m</italic><sub>1</sub>,<italic>m</italic><sub>2</sub>,&#x02026;,<italic>m</italic><sub><italic>N</italic></sub>} is found, NOE<italic>net</italic> backtracks directly to the first variable, the startsimplex <italic>S</italic><sub><italic>i</italic>1</sub><sup><italic>exp</italic></sup>, as it is practically impossible to sample all possible matches <italic>M</italic> with <italic>m</italic><sub>1</sub> fixed. As not all possible matches of the other simplices <italic>S</italic><sub><italic>i</italic>2</sub><sup><italic>exp</italic></sup>,<italic>S</italic><sub><italic>i</italic>3</sub><sup><italic>exp</italic></sup>,&#x02026;,<italic>S</italic><sub><italic>iN</italic></sub><sup><italic>exp</italic></sup> are sampled, each simplex <italic>S</italic><sub><italic>ij</italic></sub><sup><italic>exp</italic></sup> of <italic>F</italic><sub><italic>i</italic></sub><sup><italic>exp</italic></sup> must become the root&#x02014;the <italic>startsimplex</italic> of the search one time.</p><p><bold><italic>Overlap check</italic>:</bold> an <italic>overlap check</italic> can be done optionally for each match <italic>M</italic> of <italic>F</italic><sub><italic>k</italic></sub><sup><italic>exp</italic></sup> by testing its compatibility with the other fragments <italic>F</italic><sub><italic>j</italic></sub><sup><italic>exp</italic></sup><italic>j</italic>&#x02260;<italic>k</italic>. In case of an incompatibility, the match <italic>M</italic> is rejected. The overlap check can reduce the number of final peak assignment possibilities, but will increase the runtime.</p><p><bold><italic>Iterative growth of the NOE-network</italic>:</bold> in order to prevent combinatorial explosion, the fragment matching is implemented as an iterative search. The search begins with a subset fragment <italic>f</italic><sub><italic>i</italic>,<italic>n</italic></sub><sup><italic>exp</italic></sup> containing only <italic>n</italic> nodes of the whole fragment <italic>F</italic><sub><italic>i</italic></sub><sup><italic>exp</italic></sup>. The size <italic>n</italic> of <italic>f</italic><sub><italic>i</italic>,<italic>n</italic></sub><sup><italic>exp</italic></sup> is grown iteratively from <italic>n</italic><sub><italic>Min</italic></sub> to <italic>N</italic><sub><italic>i</italic></sub>, the number of nodes of fragment <italic>F</italic><sub><italic>i</italic></sub><sup><italic>exp</italic></sup>. A complete run of the fragment matching algorithm described above is performed for each value of <italic>n</italic> on the subset fragment <italic>f</italic><sub><italic>i</italic>,<italic>n</italic></sub><sup><italic>exp</italic></sup>. The iterative growth permits a progressive search for matching impossibilities of <italic>F</italic><sub><italic>i</italic></sub><sup><italic>exp</italic></sup>: first the easily detectable matching impossibilities are found with the smaller subset fragments. As the subset fragments are growing, more matching impossibilities are detected. Therefore, the assignment possibilities of every simplex of <italic>f</italic><sub><italic>i</italic>,<italic>n</italic></sub><sup><italic>exp</italic></sup> are retested again for each value of <italic>n</italic>. On the other hand, the already excluded assignment possibilities are not retested.</p><p><bold><italic>Stop search</italic>:</bold> NOE<italic>net</italic> limits further the runtime by stopping temporarily the current search after a certain number of trials. For each initial matching <italic>M</italic><sub>1</sub> of the startsimplex <italic>S</italic><sub>1</sub><sup><italic>exp</italic></sup> to an arbitrary <italic>S</italic><sub><italic>k</italic></sub><sup><italic>theo</italic></sup>,the number of trials (<italic>singleTrials</italic>) to validate <italic>M</italic><sub>1</sub> is limited by the threshold <italic>maxSingleTrials</italic> (set to one million by default). If the backtracking search for the extension of <italic>M</italic><sub>1</sub> has been stopped, the corresponding peak assignments of <italic>M</italic><sub>1</sub> are marked as <italic>stopped possibilities</italic> in the assignment table <italic>A</italic>. Stopped possibilities are neither impossible assignments nor confirmed possible assignments. They are retested again each time the subset fragment <italic>f</italic><sub><italic>i</italic>,<italic>n</italic></sub><sup><italic>exp</italic></sup> has grown to a number of simplices <italic>n</italic> equal to a multiple of 10. If stopped possibilities remain in the assignment table at the end of the matching of all fragments <italic>F</italic><sub><italic>i</italic></sub><sup><italic>exp</italic></sup>, all matchings are redone with a higher <italic>maxSingleTrials</italic> threshold (by default a factor of 10 larger). This procedure allows a first result to be obtained rapidly. It is refined automatically during the following iterations.</p><p><bold><italic>Pseudocode</italic>:</bold> the pseudocode of NOE<italic>net</italic> with its most important subfunctions is shown in the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn638/DC1">Supplementary Material</ext-link> (Fig. S5). It gives a simplified overview of the more complicated NOE<italic>net</italic> source code of about 20.000 lines written in C++.</p><p><bold><italic>NOE classes</italic>:</bold> the relation between the intensity of a NOESY cross-peak and the distance between the corresponding residues depends on numerous parameters that can be difficult to evaluate precisely (local dynamics, mixing time of the experiment and proton density). NOESY cross-peaks intensities are thus usually grouped into three distance classes for protein structure determination (W&#x000fc;thrich, <xref ref-type="bibr" rid="B26">1986</xref>): strong, medium and weak that are associated with short, medium and long range upper distances, respectively. NOE<italic>net</italic> can exploit this classification by using a different theoretical upper distance bound <italic>d</italic><sub><italic>max</italic></sub><sup><italic>theo</italic></sup>=(<italic>d</italic><sub><italic>max, short</italic></sub><sup><italic>theo</italic></sup>,<italic>d</italic><sub><italic>max, medium</italic></sub><sup><italic>theo</italic></sup>,<italic>d</italic><sub><italic>max, long</italic></sub><sup><italic>theo</italic></sup>) for each class of NOEs. The NOE classes are actually taken into account through additional filters on the current assignments, obtained by the matching of <italic>G</italic><sup><italic>exp</italic></sup> to <italic>G</italic><sup><italic>theo</italic></sup>. <italic>G</italic><sup><italic>exp</italic></sup> and <italic>G</italic><sup><italic>theo</italic></sup> comprise all NOEs and contacts, respectively. The edges of <italic>G</italic><sup><italic>exp</italic></sup> are labelled with NOESY cross-peak intensity class [label <italic>L</italic><sub><italic>NOE</italic></sub>=0(weak),1(medium),2(strong)] and the edges of <italic>G</italic><sup><italic>theo</italic></sup> are labelled according to the three distance classes [label <italic>L</italic><sub><italic>dist</italic></sub>=0 (long),1 (medium),2 (strong)].For each matching the relationship <italic>L</italic><sub><italic>dist</italic></sub>&#x02265;<italic>L</italic><sub><italic>NOE</italic></sub> is checked.</p><p><bold><italic>NOE outliers</italic>:</bold> NOEs of a certain intensity class correspond to different distance values in the 3D structure. These distances are not equally distributed over the interval of allowed distance values [0,<italic>d</italic><sub><italic>max</italic></sub><sup><italic>theo</italic></sup>], as the upper distance bound <italic>d</italic><sub><italic>max</italic></sub><sup><italic>theo</italic></sup> should include all NOEs. Only a few NOEs correspond to the higher distances [<italic>d</italic><sub><italic>max</italic></sub><sup><italic>theo</italic></sup>&#x02212;&#x00394;<italic>d</italic>,<italic>d</italic><sub><italic>max</italic></sub><sup><italic>theo</italic></sup>] and can thus be considered as <italic>outliers</italic> of the distance distribution. The <italic>outlier range</italic> is defined by &#x00394;<italic>d</italic>. In order to reflect this feature of the distance distribution associated to NOEs, NOE<italic>net</italic> can apply a NOE <italic>outlier filter</italic> during the search. For example, instead of allowing a 7 &#x000c5; threshold for all NOE to distance matchings, all NOEs matched to the upper range between 6 &#x000c5; and 7 &#x000c5; are considered as outliers. During the fragment matching, the current assignment is rejected if the number of NOE outliers is above a chosen threshold <italic>T</italic><sub><italic>NOE</italic></sub>.</p><p><bold><italic>Detection of erroneous constraints</italic>:</bold> erroneous constraints yield incompatibilities in the constraint framework. If the constraint framework is dense enough, an incompatibility can leave some strongly constrained peaks with no assignment possibility. This generates <italic>holes</italic> in the list of peak assignment possibilities. The occurrence of a <italic>hole</italic> along the matching process indicates that there must be one or more erroneous constraints in the dataset. Inversely, if every peak has at least one assignment possibility at the end of the matching process, it is highly improbable to have an error in this result. Erroneous constraints can be caused by all data sources. Under the correct peak <italic>v</italic><sup><italic>exp</italic></sup> to residue <italic>v</italic><sup><italic>theo</italic></sup> assignment, every NOE constraint <italic>e</italic><sub><italic>i</italic></sub><sup><italic>exp</italic></sup>=(<italic>v</italic><sub><italic>j</italic></sub><sup><italic>exp</italic></sup>,<italic>v</italic><sub><italic>k</italic></sub><sup><italic>exp</italic></sup>) in <italic>G</italic><sup><italic>exp</italic></sup> must have a corresponding contact <italic>e</italic><sub><italic>a</italic></sub><sup><italic>theo</italic></sup>=(<italic>v</italic><sub><italic>b</italic></sub><sup><italic>theo</italic></sup>,<italic>v</italic><sub><italic>c</italic></sub><sup><italic>theo</italic></sup>) in <italic>G</italic><sup><italic>theo</italic></sup>. Otherwise assignment errors will occur during the matchings of <italic>G</italic><sup><italic>exp</italic></sup> onto <italic>G</italic><sup><italic>theo</italic></sup>. Erroneous NOEs can be caused by too small <italic>distance thresholds</italic> for building <italic>G</italic><sup><italic>theo</italic></sup>, artefacts from the NOESY spectra or large differences between the reference tridimensional structure and the structure of the protein in solution.</p></sec><sec sec-type="materials" id="SEC3"><title>3 MATERIALS</title><p>Experimental data for EIN: the structure of the 28 kDa protein EIN has been determined by X-ray crystallography [PDB 1ZYM (Liao <italic>et al.</italic>, <xref ref-type="bibr" rid="B15">1996</xref>)] and NMR [PDB 1EZA (Garrett <italic>et al.</italic>, <xref ref-type="bibr" rid="B9">1997b</xref>)]. The RMSD of the heavy backbone atoms between 1ZYM and 1EZA is equal to 1.55 &#x000c5;. A large number of NMR experiments have been recorded on EIN (Garrett <italic>et al.</italic>, <xref ref-type="bibr" rid="B9">1997b</xref>), especially a 4D <sup>15</sup><italic>N</italic>/<sup>15</sup><italic>N</italic>-separated NOESY experiment on perdeuterated EIN with a mixing time of 170 ms (Garrett <italic>et al.</italic>, <xref ref-type="bibr" rid="B9">1997b</xref>) and a 3D <sup>15</sup><italic>N</italic>-separated NOESY with a mixing time of 100 ms (Garrett <italic>et al.</italic>, <xref ref-type="bibr" rid="B9">1997b</xref>). The two experiments permitted the extraction of 555 <italic>H</italic><sup><italic>N</italic></sup>&#x02212;<italic>H</italic><sup><italic>N</italic></sup> NOE-constraints (PDB 1EZA). Since the X-ray structure is truncated at the C-terminal end by 10 residues, we removed by hand the NOE-constraints involving residues 250&#x02013;259, which left 535 out of the 555 <italic>H</italic><sup><italic>N</italic></sup>&#x02212;<italic>H</italic><sup><italic>N</italic></sup> NOE-constraints. We assumed that the NOE dataset could have been obtained by a single 4D NOESY experiment. We thus removed from the NOE dataset all NOEs that involve an ambiguous [<sup>15</sup><italic>N</italic>,<sup>1</sup><italic>H</italic><sup><italic>N</italic></sup>] HSQC peak, defined by the tolerance distances [<italic>tolN</italic>, <italic>tolH</italic>] equal to [0.2 p.p.m., 0.02 p.p.m.]. Removal of ambiguous NOEs reduced the number of NOEs from 535 to 407. The average number of NOEs per residue is then <italic>r</italic>=407/250=1.6 for EIN.</p><p>NOE constraints were classified in three classes (strong, medium and weak). Cross-peaks that appear only in the 4D NOESY with a long mixing time of 170 ms and that have an intensity below 11% of <italic>I</italic><sub><italic>max</italic></sub>(4D) were classified as weak. All cross-peaks from the 3D NOESY with a mixing time of 100 ms were classified as strong, if their intensity was&#x0003e;14% of <italic>I</italic><sub><italic>max</italic></sub>(3D). All other cross-peaks were classified as medium. The 407 experimental NOEs are thus divided into 36 strong, 208 medium and 163 weak NOEs.</p><p><bold><italic>Calculations</italic>:</bold> the runtimes indicated in the results section correspond to the use of a single core of a Intel Xenon Woodcrest CPU at 2.66 GHz with 1 GB of RAM. While several cores or CPUs allows the user to test several parameters in parallel, the runtime of a single trial with NOE<italic>net</italic> is not reduced, as NOE<italic>net</italic> is not programmed in a parallel manner.</p><p>Figures: the figures of protein structures in this article were prepared with the program MOLMOL (Koradi <italic>et al.</italic>, <xref ref-type="bibr" rid="B12">1996</xref>).</p></sec><sec sec-type="results" id="SEC4"><title>4 RESULTS</title><p><bold><italic>Introduction</italic>:</bold> the results of using NOE<italic>net</italic> on the BMRB dataset of EIN, a large protein of 28 kDa, are shown in <xref ref-type="fig" rid="F3">Figures 3</xref> and <xref ref-type="fig" rid="F4">4</xref>, as well as in <xref ref-type="table" rid="T1">Table 1</xref>. The assignment precision is given by SAR values. A SAR value is defined for each HSQC peak as the maximum <sup>1</sup><italic>H</italic><sup><italic>N</italic></sup>&#x02212;<sup>1</sup><italic>H</italic><sup><italic>N</italic></sup> distance in the ensemble of possible assignments for the peak (see <xref ref-type="sec" rid="SEC2">Section 2</xref>). The idea behind our SAR concept is that studies that do not require an exact positioning in the 3D structure, as for example, chemical shift perturbation studies for protein&#x02013;protein interactions, can also exploit the peaks that are not uniquely assigned (SAR=0&#x000c5;),but that have a small SAR value. Typically, the assignment ensemble of a peak, whose SAR value is lower than 30 &#x000c5;, remains quite well spatially restrained. This concept is illustrated for three peaks of EIN HSQC in Figure S1.<table-wrap id="T1" position="float"><label>Table 1.</label><caption><p>Tested <italic>T</italic><sub><italic>NOE</italic></sub> values on EIN using only NOE data</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">No.</th><th rowspan="1" colspan="1"><italic>T</italic><sub><italic>NOE</italic></sub></th><th rowspan="1" colspan="1">&#x00394;<italic>d</italic>[&#x000c5;]</th><th rowspan="1" colspan="1">Check overlap</th><th rowspan="1" colspan="1">Runtime</th><th rowspan="1" colspan="1">Status</th><th rowspan="1" colspan="1">Errors</th><th rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btn638i5.jpg"/></inline-formula> (%)</th><th rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="btn638i6.jpg"/></inline-formula> (%)</th><th rowspan="1" colspan="1">Accuracy</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">No</td><td rowspan="1" colspan="1">4 days</td><td rowspan="1" colspan="1">Not finished</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">24</td><td rowspan="1" colspan="1">100</td></tr><tr><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">4</td><td rowspan="1" colspan="1">"</td><td rowspan="1" colspan="1">No</td><td rowspan="1" colspan="1">2.5 days</td><td rowspan="1" colspan="1">Not finished</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">8</td><td rowspan="1" colspan="1">30</td><td rowspan="1" colspan="1">100</td></tr><tr><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1">"</td><td rowspan="1" colspan="1">No</td><td rowspan="1" colspan="1">6 days</td><td rowspan="1" colspan="1">Not finished</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">11</td><td rowspan="1" colspan="1">32</td><td rowspan="1" colspan="1">100</td></tr><tr><td rowspan="1" colspan="1">4*</td><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">"</td><td rowspan="1" colspan="1">No</td><td rowspan="1" colspan="1">18 h</td><td rowspan="1" colspan="1">Finished</td><td rowspan="1" colspan="1">One swap:207&#x02194;208</td><td rowspan="1" colspan="1">28</td><td rowspan="1" colspan="1">53</td><td rowspan="1" colspan="1">99.2</td></tr><tr><td rowspan="1" colspan="1">5</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">"</td><td rowspan="1" colspan="1">No</td><td rowspan="1" colspan="1">1 h</td><td rowspan="1" colspan="1">Hole</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1">6</td><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">"</td><td rowspan="1" colspan="1">Yes</td><td rowspan="1" colspan="1">44 h</td><td rowspan="1" colspan="1">Finished</td><td rowspan="1" colspan="1">One swap:207&#x02194;208</td><td rowspan="1" colspan="1">28</td><td rowspan="1" colspan="1">69</td><td rowspan="1" colspan="1">99.2</td></tr></tbody></table><table-wrap-foot><fn><p>The optimization of the <italic>T</italic><sub><italic>NOE</italic></sub> parameter (see <italic>NOE outliers</italic>-part in <xref ref-type="sec" rid="SEC2">Section 2</xref>) using only NOE data for EIN is shown in this table. The theoretical distance thresholds for the three NOE classes are here <italic>d</italic><sub><italic>max</italic></sub><sup><italic>theo</italic></sup>=(4.5 &#x000c5;,6 &#x000c5;, 7.5 &#x000c5;, yielding <italic>N</italic><sub><italic>dist</italic></sub>=(391, 320, 323) distances in each class (short, medium, long) using the X-ray structure 1ZYM. The number of experimental NOEs is here <italic>N</italic><sub><italic>NOEs</italic></sub>=(36, 208, 163) for strong, medium and weak NOEs, respectively. The number of HSQC peaks is here <italic>N</italic><sub><italic>peaks</italic></sub>=243. Columns: <italic>T</italic><sub><italic>NOE</italic></sub>: maximum number of permitted NOE outliers for an arbitrary matching. &#x00394; <italic>d</italic>: the theoretical distance range [<italic>d</italic><sub><italic>max</italic></sub><sup><italic>theo</italic></sup>&#x02212;&#x00394;<italic>d</italic>, <italic>d</italic><sub><italic>max</italic></sub><sup><italic>theo</italic></sup>] in &#x000c5;ngstrom for which a NOE is considered as outlier. Check overlap: indicates whether the overlap between the disconnected fragments is tested during the search. Runtime: the calculation time required for the presented result. Status: &#x02018;hole&#x02019; indicates the presence of peaks that have no assignment possibility left in the assignment table; &#x02018;finished&#x02019; and &#x02018;not finished&#x02019; indicates whether the run converged or not for the given runtime. <italic>N</italic><sub><italic>unique</italic></sub>, number of uniquely assigned peaks. <italic>N</italic><sub><italic>SAR</italic>&#x0003c;10<italic>A</italic></sub>, number of peaks having a SAR-value below 10 &#x000c5; including the uniquely assigned peaks. The optimized <italic>T</italic><sub><italic>NOE</italic></sub> parameter that has been retained is marked by a asterisk.</p></fn></table-wrap-foot></table-wrap></p><p><bold><italic>Optimization of the T</italic><sub><italic>NOE</italic></sub><italic>parameter</italic>:</bold> in order to restrict the assignment possibilities in the best possible way, the parameter <italic>T</italic><sub><italic>NOE</italic></sub> has to be optimized (see <italic>NOE outliers</italic>-part in <xref ref-type="sec" rid="SEC2">Section 2</xref>). We performed five runs in parallel with different <italic>T</italic><sub><italic>NOE</italic></sub> values (<xref ref-type="table" rid="T1">Table 1</xref>). Large <italic>T</italic><sub><italic>NOE</italic></sub> values allow more assignment possibilities than low <italic>T</italic><sub><italic>NOE</italic></sub> values. The optimal <italic>T</italic><sub><italic>NOE</italic></sub> value is the smallest possible <italic>T</italic><sub><italic>NOE</italic></sub> value that does not introduce a high number of assignment errors. Assignment errors can be detected by the appearance of <italic>holes</italic> in the assignment table (<xref ref-type="sec" rid="SEC2">Section 2</xref>). For the dataset of EIN, holes appear for <italic>T</italic><sub><italic>NOE</italic></sub>=1, so that <italic>T</italic><sub><italic>NOE</italic></sub>=2 has been chosen as the optimal value. In the absence of holes, a limited number of assignment errors can still be present. For <italic>T</italic><sub><italic>NOE</italic></sub>=2,the correct assignment was not established for two peaks (a swap of assignment possibilities: residue 207&#x02194;208) without being detected. For <italic>T</italic><sub><italic>NOE</italic></sub> values higher than two, no correct assignment has been removed, but the assignment ensemble is less well restricted.<fig id="F3" position="float"><label>Fig. 3.</label><caption><p>Quality of the assignment represented by the SAR for all HSQC peaks of EIN. The peaks are ordered by increasing SARs. The crosses correspond to case 4 in <xref ref-type="table" rid="T1">Table 1</xref>. The overlap check (see <xref ref-type="sec" rid="SEC2">Section 2</xref>) has been deactivated for this case, so that the runtime remained reasonable (18 h). The results of case 4 are also represented in <xref ref-type="fig" rid="F4">Figures 4</xref> and <xref ref-type="fig" rid="F5">5</xref>. The circles correspond to case 6 in <xref ref-type="table" rid="T1">Table 1</xref>. The activated overlap check resulted in a higher number of peaks with a low SAR value at the expense of a longer runtime (44 h).</p></caption><graphic xlink:href="btn638f3"/></fig><fig id="F4" position="float"><label>Fig. 4.</label><caption><p>Assignment results on EIN. (<bold>a</bold>, <bold>b</bold>) The SAR values are mapped on the NMR structure using the correct assignment and the indicated color code. Unique assignments are shown in black [NMR structure 1EZA (Garrett <italic>et al.</italic>, <xref ref-type="bibr" rid="B9">1997b</xref>)]. (<bold>a</bold>) Without overlap check (case 4 in <xref ref-type="table" rid="T1">Table 1</xref> and crosses in <xref ref-type="fig" rid="F3">Fig. 3</xref>) (<bold>b</bold>) With overlap check (case 6 in <xref ref-type="table" rid="T1">Table 1</xref> and circles in <xref ref-type="fig" rid="F3">Fig. 3</xref>). Thanks to the overlap check, the SAR values of the peaks corresponding to the longest helix of EIN are reduced significantly. The NOE fragment of the longest helix is disconnected from the two largest fragments shown in (<bold>c</bold>). (<bold>c</bold>) The two largest disconnected NOE fragments (NMR structure 1EZA is shown). All assignment possibilities of one fragment are colored by the color of the fragment. (<bold>d</bold>) Theoretical contact graph. The 1034 theoretical contacts are represented on the X-ray structure 1ZYM (Liao <italic>et al.</italic>, <xref ref-type="bibr" rid="B15">1996</xref>) by blue, green and red lines corresponding to the three distance classes, short (<italic>d</italic>&#x0003c;4.5 &#x000c5;), medium (<italic>d</italic>&#x0003c;6 &#x000c5;) and long (<italic>d</italic>&#x0003c;7.5 &#x000c5;), respectively. The NOE connectivities are represented by black lines in (a&#x02013;c).</p></caption><graphic xlink:href="btn638f4"/></fig></p><p><bold><italic>Results for the protein EIN</italic>:</bold> <xref ref-type="fig" rid="F3">Figure 3</xref> shows the SAR curves of the two runs (case 4 and 6 in <xref ref-type="table" rid="T1">Table 1</xref>) with the optimal NOE outlier threshold, here <italic>T</italic><sub><italic>NOE</italic></sub>=2. The first run (case 4 in <xref ref-type="table" rid="T1">Table 1</xref>, crosses in <xref ref-type="fig" rid="F3">Fig. 3</xref>) do not use the overlap check, described in <xref ref-type="sec" rid="SEC2">Section 2</xref>, while the second run does (case 6 in <xref ref-type="table" rid="T1">Table 1</xref>, circles in <xref ref-type="fig" rid="F3">Fig 3</xref>). The overlap check does not increase here the number of unique assignments (SAR-value=0), but it increases significantly the number of peaks having a SAR value below 10 &#x000c5;. The comparison of <xref ref-type="fig" rid="F4">Figure 4</xref>a with <xref ref-type="fig" rid="F4">Figure 4</xref>b shows that mainly the peaks corresponding to the longest helix of EIN see their assignment possibilities reduced thanks to the overlap check. Due to the calculation overhead caused by the overlap check, the runtime yielding full convergence increased from 18 h without overlap check to 44 h with overlap check.</p><p>The size of EIN (28 kDa) is still quite challenging for a complete search algorithm: the sampling of all possible graph matches of a NOE network with 407 edges (<xref ref-type="fig" rid="F4">Fig. 4</xref>a) onto the 3D structure with 1034 edges (<xref ref-type="fig" rid="F4">Fig. 4</xref>d) and 243 nodes is not a trivial problem. Even without the overlap check, full convergence is only obtained after 18 h of calculation time (case 4, <xref ref-type="table" rid="T1">Table 1</xref>). Despite the sparseness of the input data, 53% of the peaks have a SAR value below 10 &#x000c5; (<xref ref-type="fig" rid="F4">Fig. 4</xref>a and <xref ref-type="table" rid="T1">Table 1</xref>). This is a sufficiently good result for the use in protein&#x02013;protein interaction studies, for example, as shown in <xref ref-type="fig" rid="F5">Figure 5</xref>. In <xref ref-type="fig" rid="F4">Figure 4</xref>c, the two largest NOE network fragments of EIN are shown. The NOE network fragment of the &#x003b2;-sheets of EIN constrains the assignment possibilities of the &#x003b2;-sheet backbone resonances very well (<xref ref-type="fig" rid="F4">Fig. 4</xref>a). The NOE fragments of the &#x003b1;-helices constrains less than the fragments of the &#x003b2;-sheets the assignment possibilities of their peaks: the number of unique assignments is lower, but the SAR values are still small (<xref ref-type="fig" rid="F4">Fig. 4</xref>a). The accuracy for EIN is below 100% (99.2%), because of two assignment errors: residues 207 and 208 are interchanged for their corresponding uniquely assigned peaks. This small assignment error remained undetected as no <italic>hole</italic> occurred in the assignment list.<fig id="F5" position="float"><label>Fig. 5.</label><caption><p>EIN-Hpr interaction site. Only the X-ray structure 1ZYM (Liao <italic>et al.</italic>, <xref ref-type="bibr" rid="B15">1996</xref>) of EIN is shown here. (<bold>a</bold>) In red are shown the residues corresponding to the peaks with a significant chemical shift perturbation (CSP) due to the interaction EIN-Hpr (Garrett <italic>et al.</italic>, <xref ref-type="bibr" rid="B9">1997b</xref>). This plot require the knowledge of the correct assignment possibility for each peak. In comparison, the plot (<bold>b</bold>) is using the assignment ensemble shown in <xref ref-type="fig" rid="F4">Figure 4</xref>a (case 4 in <xref ref-type="table" rid="T1">Table 1</xref>, without overlap check). The assignment possibilities of the same perturbed peaks as in (a) are plotted in (b). The unique assignments are plotted in black, while the assignment possibilities of all perturbed peaks with a SAR value below 30 &#x000c5; are plotted in red.</p></caption><graphic xlink:href="btn638f5"/></fig></p></sec><sec sec-type="discussion" id="SEC5"><title>5 DISCUSSION</title><p><bold><italic>Philosophy of NOEnet</italic>:</bold> the design goal of NOE<italic>net</italic> was to find all assignments compatible with the input NMR data and a 3D structure. We implemented therefore a <italic>complete search</italic> algorithm specifically developed and highly optimized for this purpose. NOE<italic>net</italic> sets at the beginning all peak assignments as possible and removes step by step assignment impossibilities. This approach ensures to obtain always a fully accurate <italic>assignment ensemble</italic> at each step of the complete search. We found that the use of sparse or poorly constraining NMR data for the structure-based assignment cannot lead to a unique assignment of all peaks. Fortunately, the ambiguous assignments can also be exploited. We introduced a quality factor for multiple assignment possibilities by a <italic>SAR</italic> value. The peaks that belong to large NOE networks have in general a low SAR value below 10 &#x000c5; using NOE<italic>net</italic>. Even if the number of uniquely assigned peaks is quite low in the shown case, the total number of uniquely assigned and low SAR peaks is the important number for applications that do not need an exact localization for all peaks. Beside the reference protein 3D structure, NOE<italic>net</italic> requires only one data source: unambiguous <sup>1</sup><italic>H</italic><sup><italic>N</italic></sup>&#x02212;<sup>1</sup>H<sup><italic>N</italic></sup> NOEs. It uses the local and global structural properties of the entire NOE network in comparison to the available tridimensional protein structure, to obtain assignment constraints. The graph matching procedure of NOE<italic>net</italic> can handle efficiently large NOE graphs, as shown on the 28 kDa protein EIN, requiring only 1 day of calculation time.</p><p><bold><italic>Input NMR data</italic>:</bold> as NOE<italic>net</italic> requires unambiguous NOEs, peaks with degenerated [<sup>15</sup><italic>N</italic>,<sup>1</sup><italic>H</italic><sup><italic>N</italic></sup>] chemical shifts have to be identified in advance (thanks to pH, salt or temperature variations) and removed from the set of peaks to assign. The NOE cross-peaks that can be related to more than two of the remaining HSQC peaks also have to be excluded. To reduce the number of those ambiguous NOEs, modern 4D <sup>15</sup><italic>N</italic>/<sup>15</sup><italic>N</italic>-separated NOESY experiments should be employed, in general, for NOE<italic>net</italic>, although the 3D version could be sufficient for small proteins. The spectrometer time for the NOESY experiment can be reduced by the implementation of recent advances in projection methods, like GFT (Shen <italic>et al.</italic>, <xref ref-type="bibr" rid="B25">2005</xref>), or simply the choice of asymmetric digital resolutions for the classical 4D NOESY (Morshauser and Zuiderweg, <xref ref-type="bibr" rid="B16">1999</xref>). As only the amide protons are needed, partially or completely perdeuterated proteins can be used for NOE<italic>net</italic>. The perdeuteration will lead to an increase in resolution for large proteins and reduce the effects of spin diffusion, allowing longer mixing times for the generation of larger fragments inside the NOE network.</p><p><sup>1</sup><italic>H</italic><sup><italic>N</italic></sup>&#x02212;<sup>1</sup><italic>H</italic><sup><italic>N</italic></sup> NOESY are much less crowded than <sup>1</sup><italic>H</italic>&#x02212;<sup>1</sup><italic>H</italic> NOESY. Although superpositions certainly becomes a drawback for large proteins, amide chemical shifts of well-structured proteins exhibit usually better dispersion than carbonyl or &#x003b1; carbons. This dispersion is actually used for triple resonance experiments, since these experiments all use the (<sup>1</sup><italic>H</italic>,<sup>15</sup><italic>N</italic>) plane as a basis for the assignment procedure. The density of peaks in 3D cubes extracted from 4D <sup>15</sup><italic>N</italic>/<sup>15</sup><italic>N</italic> separated NOESY experiments is actually expected to be comparable with that of a 3D-HNCACB experiment used for sequential backbone assignment, and prior sample optimizations performed to minimize (<sup>1</sup><italic>H</italic><sup><italic>N</italic></sup>, <sup>15</sup><italic>N</italic>) overlaps are thus expected to be similar in both strategies.</p><p><bold><italic>Comparison of structure-based and triple resonance sequential assignment procedures</italic>:</bold> backbone assignment of proteins is usually performed using triple resonance experiments. In ideal cases, this procedure can be automated and yields a unique assignment for each backbone atom of the protein (see, Baran <italic>et al.</italic>, <xref ref-type="bibr" rid="B3">2004</xref>; Moseley and Montelione, <xref ref-type="bibr" rid="B17">1999</xref> for review). However, for many cases, it still needs manual intervention and may require several weeks of analysis, possibly with experimental condition or even protein optimization. The key differences between the structure-based and the triple resonance assignment procedures rely on the one hand on the parameters that determine sensitivity of the experiments performed and on the other hand on the type of constraints used. The triple resonance assignment is based on polarization transfer through bonds (relying on J-couplings), whose efficiency decreases with increasing transverse relaxation rates <italic>R</italic><sub>2</sub>. Especially, HNCA and HNCACB, which are key experiments for sequential assignment, are based on polarization transfer between <sup>15</sup><italic>N</italic> of residue <italic>i</italic> and <italic>C</italic><sub>&#x003b1;</sub> of residues <italic>i</italic> and (<italic>i</italic>&#x02013;;1). The coupling constants between these two nuclei are relatively weak (7&#x02013;12 Hz). The balance between the delay needed to transfer the polarization, governed by the inverse of the coupling constants, and the NMR signal lifetime, governed by the transverse relaxation becomes here a critical issue. Increased <italic>R</italic><sub>2</sub> can come from larger size, but also from local dynamic processes or local unfavourable geometry. This can hinder some magnetization transfer processes, and thus break up the assignment course which is in this strategy sequential.</p><p>Compared with this, our structure-based assignment approach relies on a network of amide protons spatial proximities, revealed by NOE data. NOE cross-peak intensities depend on longitudinal relaxation rate constants <italic>R</italic><sub>1</sub> which are not sensitive to the same dynamic processes as <italic>R</italic><sub>2</sub>. Furthermore, in the special case of NOE<italic>net</italic>, only one NOESY experiment is required. This eliminates the problems of correspondence and adjustments between experiments that are often critical in the triple resonance strategy. Finally, if the continuous gain in spectrometer sensitivity will hold, our method could even be applied using <sup>15</sup><italic>N</italic> natural abundance and would allow the analysis of proteins with no heterologous expression.</p><p>As a conclusion, the two approaches use completely orthogonal data, and the combination of both sources of information should help to fill assignment gaps, occurring if only one of both sources is available. Especially the assignment of large or difficult proteins will clearly benefit from the combination of both approaches.</p><p><bold><italic>Assignment ensembles for functional NMR studies</italic>:</bold> peaks with low SAR values can be exploited for the localization of dynamical zones or the localization of interaction interfaces, as shown with the assignment ensemble obtained on EIN (<xref ref-type="fig" rid="F5">Fig. 5</xref>). Despite the low percentage of unique assignments (30%) for EIN, the SAR concept leads to useful results for the localization of the interaction site with Hpr (<xref ref-type="fig" rid="F5">Fig. 5</xref>). The comparison of the <xref ref-type="fig" rid="F5">Figure 5</xref>a with <xref ref-type="fig" rid="F5">Figure 5</xref>b shows that it is possible to correctly define the interaction site, even if the number of unique assignments is quite low among the peaks with chemical shift perturbation. In order to test the generality of this result, we first looked if the quality of the assignment ensemble obtained for EIN allowed the characterization of other potential interactions sites of the protein. The results obtained show that even the assignment ensemble obtained without overlap check indeed allows the localization of almost any interaction site on EIN (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn638/DC1">Supplementary Figs S2&#x02013;S4</ext-link>).</p><p>More generally, a critical parameter for the obtaining of good results is the fragmentation of the NOE network: larger fragments have a lower number of possible matches in the 3D structure. EIN is a good test case as it is composed of two sub-domains connected by loops, one containing only &#x003b1;-helices and the other one mainly &#x003b2;-sheets. Instead of a large connected fragment spanning the whole protein, the resulting NOE network is composed of two disconnected fragments&#x02014;one for each sub-domain (<xref ref-type="fig" rid="F4">Fig. 4</xref>c). Despite this fragmentation of the NOE network, the assignment ensemble obtained by NOE<italic>net</italic> is sufficiently well restrained to allow the localization of interaction sites. A lower fragmentation of the NOE network can be expected for more globular and thus more compact proteins, yielding even better restrained assignment ensembles than for the case of EIN. We thus think that the result we obtain with the protein EIN is quite general and that at least equally good results should be obtained on globular proteins of smaller or similar size than EIN and with NOE data of comparable quality.</p></sec><sec sec-type="conclusions" id="SEC6"><title>6 CONCLUSION AND PERSPECTIVES</title><p>The availability of the tridimensional structures of a large number of proteins, obtained mainly by X-ray crystallography, can be of help for the assignment of the <sup>15</sup>N-<sup>1</sup><italic>H</italic> NMR spectra. We show here that a network of <sup>1</sup><italic>H</italic><sup><italic>N</italic></sup>&#x02212;<sup>1</sup><italic>H</italic><sup><italic>N</italic></sup> NOEs is a highly valuable NMR data source for the structure-based assignment, up to the point that additional data sources are not mandatory. The complete search algorithm implemented in the program NOE<italic>net</italic> ensures to always obtain a high assignment accuracy, even with very sparse input data. The unambiguous NOEs alone yield already an important constraint for structure-based assignment. While our approach does not allow to reduce the measurement time in comparison to the classical approach using triple resonance experiments, it uses completely orthogonal NMR data, based on the NOE and not the J-coupling. Our approach is not meant to replace the classical triple resonance approach, but it demonstrates the power of NOE-networks for the structure-based assignment problem. As J-couplings revealed by triple resonance experiments are highly complementary to NOEs, the combination of both data sources will yield an even more robust assignment approach. NOE<italic>net</italic> is a first step towards a highly robust automated assignment approach, integrating triple resonance data with NOE data. Further developments of NOE<italic>net</italic> will focus on the possibility to include more diverse data sources. The inclusion of methyl-methyl NOEs can help for the assignment of large perdeuterated, methyl protonated proteins. The capability of NOE<italic>net</italic> to use homology models as the reference 3D structure will also be evaluated.</p><p>A growing number of NMR studies focus on other aspects than structure determination, like protein interactions or dynamics. We show that they will clearly benefit from the introduced facilitation of the resonance assignment stage, even in cases where it is not unique.</p></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material id="PMC_1" content-type="local-data"><caption><title>[Supplementary Data]</title></caption><media mimetype="text" mime-subtype="html" xlink:href="btn638_index.html"/><media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="btn638_1.pdf"/></supplementary-material></sec></body><back><ack><title>Acknowledgements</title><p>We thank Ewen Lescop and Fran&#x000e7;ois Bontems for a critical reading of the article. We thank Olivier Serve and Guillaume Loire for the realization of the calculation cluster project in our lab.</p><p><italic>Funding</italic>: CNRS; fellowship from the Minist&#x000e8;re de l'Enseignement Sup&#x000e9;rieur et de la Recherche (to D.S.).</p></ack><ref-list><title>REFERENCES</title><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Apayd&#x000ed;n</surname><given-names>M</given-names></name><etal/></person-group><article-title>Structure-based protein NMR assignments using native structural ensembles</article-title><source>J. Biomol. NMR</source><year>2008</year><volume>40</volume><fpage>263</fpage><lpage>276</lpage><pub-id pub-id-type="pmid">18365752</pub-id></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Bailey-Kellogg</surname><given-names>C</given-names></name><etal/></person-group><article-title>The NOESY jigsaw: automated protein secondary structure and main-chain assignment from sparse, unassigned NMR data</article-title><source>J. Comput. Biol.</source><year>2000</year><volume>7</volume><fpage>537</fpage><lpage>558</lpage><pub-id pub-id-type="pmid">11108478</pub-id></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Baran</surname><given-names>M</given-names></name><etal/></person-group><article-title>Automated analysis of protein NMR assignments and structures</article-title><source>Chem. Rev.</source><year>2004</year><volume>104</volume><fpage>3541</fpage><lpage>3556</lpage><pub-id pub-id-type="pmid">15303826</pub-id></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Bartels</surname><given-names>C</given-names></name><etal/></person-group><article-title>Automated sequence-specific NMR assignment of homologous proteins using the program garant</article-title><source>J. Biomol. NMR</source><year>1996</year><volume>7</volume><fpage>207</fpage><lpage>213</lpage></citation></ref><ref id="B5"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Dechter</surname><given-names>R</given-names></name></person-group><source>Constraint Processing.</source><year>2003</year><edition>1st edn</edition><publisher-loc>San Franciso, CA</publisher-loc><publisher-name>Morgan Kaufmann</publisher-name></citation></ref><ref id="B6"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Dobson</surname><given-names>CM</given-names></name><etal/></person-group><article-title>Nuclear overhauser effects and the assignment of the proton NMR spectra of proteins</article-title><source>FEBS Lett.</source><year>1984</year><volume>176</volume><fpage>307</fpage><lpage>312</lpage></citation></ref><ref id="B7"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Erdmann</surname><given-names>MA</given-names></name><name><surname>Rule</surname><given-names>GS</given-names></name></person-group><article-title>Rapid protein structure detection and assignment using residual dipolar couplings</article-title><source>Technical Report CMU-CS-02-195.</source><year>2002</year><publisher-loc>Pittsburgh, PA</publisher-loc><publisher-name>School of Computer Science, Carnegie Mellon University</publisher-name></citation></ref><ref id="B8"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Garrett</surname><given-names>DS</given-names></name><etal/></person-group><article-title>Identification by NMR of the binding surface for the histidine-containing phosphocarrier protein hpr on the N-terminal domain of enzyme I of the Escherichia coli phosphotransferase system</article-title><source>Biochemistry</source><year>1997a</year><volume>36</volume><fpage>4393</fpage><lpage>4398</lpage><pub-id pub-id-type="pmid">9109646</pub-id></citation></ref><ref id="B9"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Garrett</surname><given-names>DS</given-names></name><etal/></person-group><article-title>Solution structure of the 30 kDa N-terminal domain of enzyme I of the Escherichia coli phosphoenolpyruvate:sugar phosphotransferase system by multidimensional NMR</article-title><source>Biochemistry</source><year>1997b</year><volume>36</volume><fpage>2517</fpage><lpage>2530</lpage><pub-id pub-id-type="pmid">9054557</pub-id></citation></ref><ref id="B10"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Gronwald</surname><given-names>W</given-names></name><etal/></person-group><article-title>Camra: chemical shift based computer aided protein NMR assignments</article-title><source>J. Biomol. NMR</source><year>1998</year><volume>12</volume><fpage>395</fpage><lpage>405</lpage><pub-id pub-id-type="pmid">9835047</pub-id></citation></ref><ref id="B11"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hus</surname><given-names>J-C</given-names></name><etal/></person-group><article-title>Assignment strategy for proteins with known structure</article-title><source>J. Magn. Reson.</source><year>2002</year><volume>157</volume><fpage>119</fpage><lpage>123</lpage><pub-id pub-id-type="pmid">12202140</pub-id></citation></ref><ref id="B12"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Koradi</surname><given-names>R</given-names></name><etal/></person-group><article-title>Molmol: a program for display and analysis of macromolecular structures</article-title><source>J. Mol. Graph.</source><year>1996</year><volume>14</volume><issue>51&#x02013;5</issue><fpage>29</fpage><lpage>32</lpage></citation></ref><ref id="B13"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Langmead</surname><given-names>CJ</given-names></name><name><surname>Donald</surname><given-names>BR</given-names></name></person-group><article-title>An expectation/maximization nuclear vector replacement algorithm for automated NMR resonance assignments</article-title><source>J. Biomol. NMR</source><year>2004</year><volume>29</volume><fpage>111</fpage><lpage>138</lpage><pub-id pub-id-type="pmid">15014227</pub-id></citation></ref><ref id="B14"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Langmead</surname><given-names>CJ</given-names></name><etal/></person-group><article-title>A polynomial-time nuclear vector replacement algorithm for automated NMR resonance assignments</article-title><source>J. Comput. Biol.</source><year>2004</year><volume>11</volume><fpage>277</fpage><lpage>298</lpage><pub-id pub-id-type="pmid">15285893</pub-id></citation></ref><ref id="B15"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Liao</surname><given-names>DI</given-names></name><etal/></person-group><article-title>The first step in sugar transport: crystal structure of the amino terminal domain of enzyme I of the E. coli PEP: sugar phosphotransferase system and a model of the phosphotransfer complex with Hpr</article-title><source>Structure</source><year>1996</year><volume>4</volume><fpage>861</fpage><lpage>872</lpage><pub-id pub-id-type="pmid">8805571</pub-id></citation></ref><ref id="B16"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Morshauser</surname><given-names>RC</given-names></name><name><surname>Zuiderweg</surname><given-names>ER</given-names></name></person-group><article-title>High-resolution four-dimensional HMQC-NOESY-HSQC spectroscopy</article-title><source>J. Magn. Reson.</source><year>1999</year><volume>139</volume><fpage>232</fpage><lpage>239</lpage><pub-id pub-id-type="pmid">10423360</pub-id></citation></ref><ref id="B17"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Moseley</surname><given-names>HN</given-names></name><name><surname>Montelione</surname><given-names>GT</given-names></name></person-group><article-title>Automated analysis of NMR assignments and structures for proteins</article-title><source>Curr. Opin. in Struct. Biol.</source><year>1999</year><volume>9</volume><fpage>635</fpage><lpage>642</lpage><pub-id pub-id-type="pmid">10508776</pub-id></citation></ref><ref id="B18"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Neal</surname><given-names>S</given-names></name><etal/></person-group><article-title>Rapid and accurate calculation of protein 1H, 13C and 15N chemical shifts</article-title><source>J. Biomol. NMR</source><year>2003</year><volume>26</volume><fpage>215</fpage><lpage>240</lpage><pub-id pub-id-type="pmid">12766419</pub-id></citation></ref><ref id="B19"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Pintacuda</surname><given-names>G</given-names></name><etal/></person-group><article-title>Fast structure-based assignment of 15N HSQC spectra of selectively 15n-labeled paramagnetic proteins</article-title><source>J. Am. Chem. Soc.</source><year>2004</year><volume>126</volume><fpage>2963</fpage><lpage>2970</lpage><pub-id pub-id-type="pmid">14995214</pub-id></citation></ref><ref id="B20"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Pons</surname><given-names>JL</given-names></name><name><surname>Delsuc</surname><given-names>MA</given-names></name></person-group><article-title>Rescue: an artificial neural network tool for the NMR spectral assignment of proteins</article-title><source>J. Biomol. NMR</source><year>1999</year><volume>15</volume><fpage>15</fpage><lpage>26</lpage><pub-id pub-id-type="pmid">10549132</pub-id></citation></ref><ref id="B21"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Pristovsek</surname><given-names>P</given-names></name><name><surname>Franzoni</surname><given-names>L</given-names></name></person-group><article-title>Stereospecific assignments of protein NMR resonances based on the tertiary structure and 2D/3D NOE data</article-title><source>J. Comput. Chem.</source><year>2006</year><volume>27</volume><fpage>791</fpage><lpage>797</lpage><pub-id pub-id-type="pmid">16526035</pub-id></citation></ref><ref id="B22"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Pristovsek</surname><given-names>P</given-names></name><etal/></person-group><article-title>Semiautomatic sequence-specific assignment of proteins based on the tertiary structure&#x02013;the program st2nmr</article-title><source>J. Comput. Chem.</source><year>2002</year><volume>23</volume><fpage>335</fpage><lpage>340</lpage><pub-id pub-id-type="pmid">11908496</pub-id></citation></ref><ref id="B23"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Sedgewick</surname><given-names>R</given-names></name></person-group><source>Algorithms in C++ Part 5: Graph Algorithms.</source><year>2002</year><edition>3rd edn</edition><publisher-loc>San Francisco, CA</publisher-loc><publisher-name>Addison-Wesley Professional</publisher-name></citation></ref><ref id="B24"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Shen</surname><given-names>Y</given-names></name><name><surname>Bax</surname><given-names>A</given-names></name></person-group><article-title>Protein backbone chemical shifts predicted from searching a database for torsion angle and sequence homology</article-title><source>J. Biomol. NMR</source><year>2007</year><volume>38</volume><fpage>289</fpage><lpage>302</lpage><pub-id pub-id-type="pmid">17610132</pub-id></citation></ref><ref id="B25"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Shen</surname><given-names>Y</given-names></name><etal/></person-group><article-title>G-matrix fourier transform noesy-based protocol for high-quality protein structure determination</article-title><source>J. Am. Chem. Soc.</source><year>2005</year><volume>127</volume><fpage>9085</fpage><lpage>9099</lpage><pub-id pub-id-type="pmid">15969587</pub-id></citation></ref><ref id="B26"><citation citation-type="book"><person-group person-group-type="author"><name><surname>W&#x000fc;thrich</surname><given-names>K</given-names></name></person-group><source>NMR of Proteins and Nucleic Acids.</source><year>1986</year><edition>1st edn</edition><publisher-loc>New York, NY</publisher-loc><publisher-name>Wiley-Interscience</publisher-name></citation></ref><ref id="B27"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Xiong</surname><given-names>F</given-names></name><name><surname>Bailey-Kellogg</surname><given-names>C</given-names></name></person-group><article-title>A hierarchical grow-and-match algorithm for backbone resonance assignments given 3D structure</article-title><source>Proceedings of the 7th IEEE International Conference on Bioinformatics and Bioengineering, 2007, BIBE 2007.</source><year>2007</year><publisher-loc>Boston, MA</publisher-loc><fpage>403</fpage><lpage>410</lpage></citation></ref><ref id="B28"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Xiong</surname><given-names>F</given-names></name><etal/></person-group><article-title>Contact replacement for NMR resonance assignment</article-title><source>Bioinformatics</source><year>2008</year><volume>24</volume><fpage>i205</fpage><lpage>i213</lpage><pub-id pub-id-type="pmid">18586716</pub-id></citation></ref></ref-list></back></article>