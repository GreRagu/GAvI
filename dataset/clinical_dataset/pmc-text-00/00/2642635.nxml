<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd"><article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article" xml:lang="EN"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id><journal-id journal-id-type="publisher-id">bioinformatics</journal-id><journal-id journal-id-type="hwp">bioinfo</journal-id><journal-title>Bioinformatics</journal-title><issn pub-type="ppub">1367-4803</issn><issn pub-type="epub">1460-2059</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">19098030</article-id><article-id pub-id-type="pmc">2642635</article-id><article-id pub-id-type="doi">10.1093/bioinformatics/btn655</article-id><article-id pub-id-type="publisher-id">btn655</article-id><article-categories><subj-group subj-group-type="heading"><subject>Applications Note</subject><subj-group><subject>Gene Expression</subject></subj-group></subj-group></article-categories><title-group><article-title>SAFEGUI: resampling-based tests of categorical significance in gene expression data made easy</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Gatti</surname><given-names>Daniel M.</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref><xref ref-type="corresp" rid="COR1">*</xref></contrib><contrib contrib-type="author"><name><surname>Sypa</surname><given-names>Myroslav</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Rusyn</surname><given-names>Ivan</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Wright</surname><given-names>Fred A.</given-names></name><xref ref-type="aff" rid="AFF1"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Barry</surname><given-names>William T.</given-names></name><xref ref-type="aff" rid="AFF1"><sup>3</sup></xref></contrib></contrib-group><aff id="AFF1"><sup>1</sup>Department of Environmental Sciences &#x00026; Engineering, <sup>2</sup>Department of Biostatistics, University of North Carolina, Chapel Hill, NC 27599 and <sup>3</sup>Department of Biostatistics &#x00026; Bioinformatics, Duke University, Durham, NC 27705, USA</aff><author-notes><corresp id="COR1">*To whom correspondence should be addressed.</corresp><fn><p>Associate Editor: David Rocke</p></fn></author-notes><pub-date pub-type="ppub"><day>15</day><month>2</month><year>2009</year></pub-date><pub-date pub-type="epub"><day>19</day><month>12</month><year>2008</year></pub-date><pub-date pub-type="pmc-release"><day>19</day><month>12</month><year>2008</year></pub-date><volume>25</volume><issue>4</issue><fpage>541</fpage><lpage>542</lpage><history><date date-type="received"><day>19</day><month>11</month><year>2008</year></date><date date-type="rev-recd"><day>19</day><month>11</month><year>2008</year></date><date date-type="accepted"><day>16</day><month>12</month><year>2008</year></date></history><permissions><copyright-statement>&#x000a9; 2008 The Author(s)</copyright-statement><copyright-year>2008</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/"><p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">http://creativecommons.org/licenses/by-nc/2.0/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</p></license></permissions><abstract><p><bold>Summary:</bold> A large number of websites and applications perform significance testing for gene categories/pathways in microarray data. Many of these packages fail to account for expression correlation between transcripts, with a resultant inflation in Type I error. Array permutation and other resampling-based approaches have been proposed as solutions to this problem. SAFEGUI provides a user-friendly graphical interface for the assessment of categorical significance in microarray studies, while properly accounting for the effects of correlations among genes. SAFEGUI incorporates both permutation and more recently proposed bootstrap algorithms that are demonstrated to be more powerful in detecting differential expression across categories of genes.</p><p><bold>Availability:</bold> <ext-link ext-link-type="uri" xlink:href="http://cebc.unc.edu/software/">http://cebc.unc.edu/software/</ext-link></p><p><bold>Contact:</bold> <email>fwright@bios.unc.edu</email>; <email>dmgatti@email.unc.edu</email></p></abstract></article-meta></front><body><sec sec-type="intro" id="SEC1"><title>1 INTRODUCTION</title><p>The computational pipeline for gene expression studies has improved in recent years with a degree of consensus surrounding pre-processing and normalization, analysis of differential expression and biological interpretation of the findings (Allison <italic>et al.</italic>, <xref ref-type="bibr" rid="B1">2006</xref>). A typical experiment involves a set of microarrays from one or more treatment groups, where series of gene-specific statistical tests are carried out to produce a list of differentially expressed genes of interest to the investigator. This list is then passed to software which tests for enrichment of biological categories among significant genes, aiding in biological interpretation and generating new leads for followup. Several software packages and websites exist to carry out this type of analysis (Khatri and Draghici, <xref ref-type="bibr" rid="B9">2005</xref>).</p><p>As recently noted, software of this type has one property in common; they employ an enrichment score that assumes independence between genes, a property which does not apply in microarray studies (Goeman and Buhlmann, <xref ref-type="bibr" rid="B8">2007</xref>; Rhee <italic>et al.</italic>, <xref ref-type="bibr" rid="B12">2008</xref>). The violation of this assumption leads to inflated <italic>P</italic>-values (Barry <italic>et al.</italic>, <xref ref-type="bibr" rid="B4">2008</xref>), even for categories that are moderately correlated, and may lead to seriously biased conclusions.</p><p>Array permutation, in which the arrays are randomly assigned to treatment groups, produces an empirical null distribution for enrichment statistics, and has been shown to reduce the Type I error associated with overrepresentation analysis (ORA) methods (Barry <italic>et al.</italic>, <xref ref-type="bibr" rid="B3">2005</xref>; Goeman and Buhlmann, <xref ref-type="bibr" rid="B8">2007</xref>). Several packages exist to perform permutation-based significance testing (Breslin <italic>et al.</italic>, <xref ref-type="bibr" rid="B6">2004</xref>; Subramanian <italic>et al.</italic>, <xref ref-type="bibr" rid="B13">2005</xref>). More recently, bootstrapping has been implemented as an alternative and more powerful resampling scheme to test for functional category enrichment (Barry <italic>et al.</italic>, <xref ref-type="bibr" rid="B4">2008</xref>). One stumbling block for biologists is that some of these packages require scripting or the use of a command-line interface. SAFEGUI introduces a graphical interface to R code, for loading gene expression datasets and performing resampling-based significance testing of user-specified gene sets, Gene Ontology (GO) categories, Kyoto Encyclopedia of Gene and Genomes (KEGG) pathways or PFAM families.</p></sec><sec id="SEC2"><title>2 SAFEGUI</title><p>SAFEGUI is written in Java in order to provide cross-platform compatibility, and relies upon the Significance Analysis of Function and Expression (SAFE) package (Barry <italic>et al.</italic>, <xref ref-type="bibr" rid="B3">2005</xref>) written in R (R Development Core Team, <xref ref-type="bibr" rid="B11">2006</xref>). The release of SAFE 2.0 coincides with the release of SAFEGUI, and adds several new features, including new statistics for differential expression and pathway enrichment, as well as new procedures for error control and resampling. SAFE provides a highly generalized environment for category testing, with a greater variety of options than other resampling category enrichment procedures.</p><p>When SAFEGUI starts, the user is presented with the main window. The user selects a data file which consists of a row of sample group labels, followed by gene expression measurements. The user selects the appropriate microarray platform and SAFEGUI automatically retrieves the corresponding annotation data from Bioconductor (Gentleman <italic>et al.</italic>, <xref ref-type="bibr" rid="B7">2004</xref>). The user selects a gene-specific &#x02018;local&#x02019; statistic to test for differential expression (e.g. an <italic>F</italic>-statistic in a one-way ANOVA for a multi-class experimental design). Finally, the user can select from several options to test category enrichment correct for multiple testing of categories/pathways. These &#x02018;global&#x02019; enrichment statistics can be categorical, such as Fisher's Exact Test of category membership versus statistical significance of the genes, thus providing a resampling version of common genelist enrichment tests (Khatri and Draghici, <xref ref-type="bibr" rid="B9">2005</xref>). Other global statistics can directly use the full continuous range of the local statistics. Examples include the Wilcoxon rank sum or Kolmogorov&#x02013;Smirnov statistics. SAFEGUI enables permutation and bootstrap resampling of arrays, and both methods preserve the correlation structure of the expression measurements. Using existing Bioconductor annotation, SAFEGUI enables testing of GO categories (Ashburner <italic>et al.</italic>, <xref ref-type="bibr" rid="B2">2000</xref>), KEGG pathways (Ogata <italic>et al.</italic>, <xref ref-type="bibr" rid="B10">1999</xref>) and PFAM motifs (Bateman <italic>et al.</italic>, <xref ref-type="bibr" rid="B5">2000</xref>).</p><p>Once the options are selected, SAFEGUI performs the analysis and presents the output in results window (<xref ref-type="fig" rid="F1">Fig. 1</xref>a). The table on the left shows the significant categories/pathways sorted by nominal or corrected <italic>P</italic>-value. Upon selecting a category, several tabs appear on the right: the first shows lists of up- and downregulated genes (for two-condition experiments). The second tab shows the <italic>safeplot</italic> (Barry <italic>et al.</italic>, <xref ref-type="bibr" rid="B3">2005</xref>), a cumulative distribution of ranked local statistics. The third tab shows a GO graph (if applicable) in which each category is colored according to its statistical significance (<xref ref-type="fig" rid="F1">Fig. 1</xref>b). All tabular and graphical results can be written to output for further analysis.<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>Results window showing significant GO categories on the left and (<bold>a</bold>) a safe plot for the selected GO category and (<bold>b</bold>) the GO tree with significant categories highlighted.</p></caption><graphic xlink:href="btn655f1"/></fig></p><p>SAFE 2.0 and SAFEGUI also allow the user to select the univariate Cox proportional hazards model to relate gene expression to censored survival data for category testing. The use of a Cox model on the expression of gene categories has been shown to be more predictive of survival than the use of individual genes, and may provide greater biological insight (Barry <italic>et al.</italic>, <xref ref-type="bibr" rid="B3">2005</xref>).</p><sec id="SEC2.1"><title>2.1 Bootstrap resampling</title><p>The release of the Bioconductor package SAFE 2.0 adds several bootstrap resampling methods for testing gene categories, which have been shown to control Type I error while providing more power than permutation methods (Barry <italic>et al.</italic>, <xref ref-type="bibr" rid="B4">2008</xref>). Empirical category <italic>P</italic>-values are calculated using two standard approaches. (i) The argument method=&#x02018;bootstrap.t&#x02019; invokes pivot tests for the exclusion of a null value from Gaussian confidence interval, using on resampled estimates of the mean and variance of the global statistic; (ii) method=&#x02018;bootstrap.q&#x02019; invokes tests based on the exclusion of a null value from the alpha-quantile interval of the resampled global statistic. For both the bootstrap-based tests, a null value for the global statistic must be specified that is insensitive to expression correlation, and bootstrapping is thus limited to the use of the Pearson, Wilcoxon and <italic>T</italic>-tests.</p></sec></sec><sec sec-type="conclusions" id="SEC3"><title>3 CONCLUSIONS</title><p>SAFEGUI introduces a user-friendly graphical user interface to a powerful statistical package for the analysis of category or pathway significance from microarray data.</p></sec></body><back><ack><title>ACKNOWLEDGEMENTS</title><p>The research described in this article has not been subjected to the Agency's peer review and policy review and therefore does not necessarily reflect the views of the Agency and no official endorsement should be inferred.</p><p><italic>Funding</italic>: United States Environmental Protection Agency (RD832720, RD833825 and F08D20579, in part). However, the research described in this article has not been subjected to the Agency's peer review and policy review and therefore does not necessarily reflect the views of the Agency and no official endorsement should be inferred. UNC Environmental Sciences &#x00026; Engineering Interdisciplinary Fellowship (to D.M.G.).</p><p><italic>Conflict of Interest</italic>: none declared.</p></ack><ref-list><title>REFERENCES</title><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Allison</surname><given-names>DB</given-names></name><etal/></person-group><article-title>Microarray data analysis: from disarray to consolidation and consensus</article-title><source>Nat. Rev. Genet.</source><year>2006</year><volume>7</volume><fpage>55</fpage><lpage>65</lpage><pub-id pub-id-type="pmid">16369572</pub-id></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ashburner</surname><given-names>M</given-names></name><etal/></person-group><article-title>Gene ontology: tool for the unification of biology. The Gene Ontology Consortium</article-title><source>Nat. Genet.</source><year>2000</year><volume>25</volume><fpage>25</fpage><lpage>29</lpage><pub-id pub-id-type="pmid">10802651</pub-id></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Barry</surname><given-names>WT</given-names></name><etal/></person-group><article-title>Significance analysis of functional categories in gene expression studies: a structured permutation approach</article-title><source>Bioinformatics</source><year>2005</year><volume>21</volume><fpage>1943</fpage><lpage>1949</lpage><pub-id pub-id-type="pmid">15647293</pub-id></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Barry</surname><given-names>WT</given-names></name><etal/></person-group><article-title>A statistical framework for testing functional categories in microarray data</article-title><source>Ann. Appl. Stat.</source><year>2008</year><volume>2</volume><fpage>286</fpage><lpage>315</lpage></citation></ref><ref id="B5"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Bateman</surname><given-names>A</given-names></name><etal/></person-group><article-title>The Pfam protein families database</article-title><source>Nucleic Acids Res</source><year>2000</year><volume>28</volume><fpage>263</fpage><lpage>266</lpage><pub-id pub-id-type="pmid">10592242</pub-id></citation></ref><ref id="B6"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Breslin</surname><given-names>T</given-names></name><etal/></person-group><article-title>Comparing functional annotation analyses with Catmap</article-title><source>BMC Bioinformatics</source><year>2004</year><volume>5</volume><fpage>193</fpage><pub-id pub-id-type="pmid">15588298</pub-id></citation></ref><ref id="B7"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Gentleman</surname><given-names>RC</given-names></name><etal/></person-group><article-title>Bioconductor: open software development for computational biology and bioinformatics</article-title><source>Genome Biol.</source><year>2004</year><volume>5</volume><fpage>R80</fpage><pub-id pub-id-type="pmid">15461798</pub-id></citation></ref><ref id="B8"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Goeman</surname><given-names>JJ</given-names></name><name><surname>Buhlmann</surname><given-names>P</given-names></name></person-group><article-title>Analyzing gene expression data in terms of gene sets: methodological issues</article-title><source>Bioinformatics</source><year>2007</year><volume>23</volume><fpage>980</fpage><lpage>987</lpage><pub-id pub-id-type="pmid">17303618</pub-id></citation></ref><ref id="B9"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Khatri</surname><given-names>P</given-names></name><name><surname>Draghici</surname><given-names>S</given-names></name></person-group><article-title>Ontological analysis of gene expression data: current tools, limitations, and open problems</article-title><source>Bioinformatics</source><year>2005</year><volume>21</volume><fpage>3587</fpage><lpage>3595</lpage><pub-id pub-id-type="pmid">15994189</pub-id></citation></ref><ref id="B10"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ogata</surname><given-names>H</given-names></name><etal/></person-group><article-title>KEGG: Kyoto Encyclopedia of Genes and Genomes</article-title><source>Nucleic Acids Res</source><year>1999</year><volume>27</volume><fpage>29</fpage><lpage>34</lpage><pub-id pub-id-type="pmid">9847135</pub-id></citation></ref><ref id="B11"><citation citation-type="book"><collab>R Development Core Team</collab><source>R: a Language and Environment for Statistical Computing.</source><year>2006</year><publisher-loc>Vienna, Austria</publisher-loc><comment>available at <ext-link ext-link-type="uri" xlink:href="http://www.R-project.org">http://www.R-project.org</ext-link></comment></citation></ref><ref id="B12"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Rhee</surname></name><etal/></person-group><article-title>Use and misuse of the gene ontology annotations</article-title><source>Nat. Rev. Genet.</source><year>2008</year><volume>7</volume><fpage>509</fpage><lpage>515</lpage><pub-id pub-id-type="pmid">18475267</pub-id></citation></ref><ref id="B13"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Subramanian</surname><given-names>A</given-names></name><etal/></person-group><article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title><source>Proc. Natl Acad. Sci. USA</source><year>2005</year><volume>102</volume><fpage>15545</fpage><lpage>15550</lpage><pub-id pub-id-type="pmid">16199517</pub-id></citation></ref></ref-list></back></article>