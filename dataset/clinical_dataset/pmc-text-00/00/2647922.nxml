<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd"><article xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Algorithms Mol Biol</journal-id><journal-title>Algorithms for Molecular Biology : AMB</journal-title><issn pub-type="epub">1748-7188</issn><publisher><publisher-name>BioMed Central</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">19146671</article-id><article-id pub-id-type="pmc">2647922</article-id><article-id pub-id-type="publisher-id">1748-7188-4-2</article-id><article-id pub-id-type="doi">10.1186/1748-7188-4-2</article-id><article-categories><subj-group subj-group-type="heading"><subject>Software Article</subject></subj-group></article-categories><title-group><article-title>CHSMiner: a GUI tool to identify chromosomal homologous segments</article-title></title-group><contrib-group><contrib id="A1" contrib-type="author"><name><surname>Wang</surname><given-names>Zhen</given-names></name><xref ref-type="aff" rid="I1">1</xref><xref ref-type="aff" rid="I2">2</xref><email>zwang01@sibs.ac.cn</email></contrib><contrib id="A2" contrib-type="author"><name><surname>Ding</surname><given-names>Guohui</given-names></name><xref ref-type="aff" rid="I1">1</xref><xref ref-type="aff" rid="I2">2</xref><email>gwding@sibs.ac.cn</email></contrib><contrib id="A3" contrib-type="author"><name><surname>Yu</surname><given-names>Zhonghao</given-names></name><xref ref-type="aff" rid="I3">3</xref><email>yuzhonghao@gmail.com</email></contrib><contrib id="A4" corresp="yes" contrib-type="author"><name><surname>Liu</surname><given-names>Lei</given-names></name><xref ref-type="aff" rid="I1">1</xref><xref ref-type="aff" rid="I4">4</xref><email>leiliu@sibs.ac.cn</email></contrib><contrib id="A5" corresp="yes" contrib-type="author"><name><surname>Li</surname><given-names>Yixue</given-names></name><xref ref-type="aff" rid="I1">1</xref><xref ref-type="aff" rid="I3">3</xref><xref ref-type="aff" rid="I4">4</xref><email>yxli@sibs.ac.cn</email></contrib></contrib-group><aff id="I1"><label>1</label>Key Lab of Systems Biology, Shanghai Institutes for Biological Sciences, Chinese Academy of Sciences, 320 Yueyang Road, Shanghai 200031, PR China</aff><aff id="I2"><label>2</label>Graduate School of the Chinese Academy of Sciences, Shanghai 200031, PR China</aff><aff id="I3"><label>3</label>College of Life Science &#x00026; Biotechnology, Shanghai Jiao Tong University, Shanghai 200240, PR China</aff><aff id="I4"><label>4</label>Shanghai Centre for Bioinformation Technology, 100 Qinzhou Road, Shanghai 200235, PR China</aff><pub-date pub-type="collection"><year>2009</year></pub-date><pub-date pub-type="epub"><day>15</day><month>1</month><year>2009</year></pub-date><volume>4</volume><fpage>2</fpage><lpage>2</lpage><ext-link ext-link-type="uri" xlink:href="http://www.almob.org/content/4/1/2"/><history><date date-type="received"><day>21</day><month>9</month><year>2008</year></date><date date-type="accepted"><day>15</day><month>1</month><year>2009</year></date></history><permissions><copyright-statement>Copyright &#x000a9; 2009 Wang et al; licensee BioMed Central Ltd.</copyright-statement><copyright-year>2009</copyright-year><copyright-holder>Wang et al; licensee BioMed Central Ltd.</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0"><p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p><!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>               Wang               Zhen                                             zwang01@sibs.ac.cn            </dc:author><dc:title>            CHSMiner: a GUI tool to identify chromosomal homologous segments         </dc:title><dc:date>2009</dc:date><dcterms:bibliographicCitation>Algorithms for Molecular Biology 4(1): 2-. (2009)</dcterms:bibliographicCitation><dc:identifier type="sici">1748-7188(2009)4:1&#x0003c;2&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1748-7188</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>--></license></permissions><abstract><sec><title>Background</title><p>The identification of chromosomal homologous segments (CHS) within and between genomes is essential for comparative genomics. Various processes including insertion/deletion and inversion could cause the degeneration of CHSs.</p></sec><sec><title>Results</title><p>Here we present a Java software CHSMiner that detects CHSs based on shared gene content alone. It implements fast greedy search algorithm and rigorous statistical validation, and its friendly graphical interface allows interactive visualization of the results. We tested the software on both simulated and biological realistic data and compared its performance with similar existing software and data source.</p></sec><sec><title>Conclusion</title><p>CHSMiner is characterized by its integrated workflow, fast speed and convenient usage. It will be useful for both experimentalists and bioinformaticians interested in the structure and evolution of genomes.</p></sec></abstract></article-meta></front><body><sec><title>Background</title><p>The identification of chromosomal homologous segments (CHSs) within and between genomes (known as paralogons and syntenies, respectively) is essential for comparative genomics. It can not only help evolutionary biologists to study genome evolution, such as genome duplication and rearrangement [<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B2">2</xref>], but also help experimental biologists to transfer gene function information from one genome to another. Although extensive gene mutation, deletion, and insertion have made them not always obvious from primary sequences, chromosomal homology can still be revealed by a pair of segments sharing a group of homologous genes [<xref ref-type="bibr" rid="B3">3</xref>]. Most existing programs, including ADHoRe [<xref ref-type="bibr" rid="B4">4</xref>], FISH [<xref ref-type="bibr" rid="B5">5</xref>] and LineUp [<xref ref-type="bibr" rid="B6">6</xref>], look for CHSs based on the conservation of both gene content and order (colinearity). While the approach was sensitive enough for moderate divergence, it has been pointed out conserved gene order may be too strict for more ancient divergence [<xref ref-type="bibr" rid="B3">3</xref>], as inversion is another dominant force for the degeneration of CHSs. For example, the whole genome duplication in early vertebrate evolution can only be inferred by discarding gene order and considering gene content alone [<xref ref-type="bibr" rid="B7">7</xref>]. A pioneering implementation of this strategy was CloseUp [<xref ref-type="bibr" rid="B8">8</xref>], but some limitations still exist, especially with the rapid increase of genomic data. First, it used Monte Carlo simulation to estimate the statistical significance of identified CHSs, which might no longer be suitable for whole genome sequence analysis, as thousands of annotated genes would make it quite time-consuming. Second, previous tools were mainly developed for computational biologists, which restricted their wide use among experimental biologists.</p><p>In our recent project to build a paralog/paralogon database EPGD [<xref ref-type="bibr" rid="B9">9</xref>], we found it was very necessary to develop a new software that could overcome those weaknesses. Here, we publish it as a complete Java package named CHSMiner. Its core algorithm has been used to construct our database successfully and several improvements were added later as well. In short, it can not only fast identify and evaluate CHSs from whole genome comparison, but also provide a convenient graphical interface for end users to visualize the results.</p></sec><sec><title>Implementation</title><sec><title>Fast greedy search algorithm</title><p>CHSMiner defines CHSs based on shared gene content alone in order to fully exploit potential homology (Figure <xref ref-type="fig" rid="F1">1</xref>). Two major types of algorithms have been developed for the purpose in previous studies. One is based on the idea of bottom-up merging of smaller clusters (e.g. CloseUp [<xref ref-type="bibr" rid="B8">8</xref>]), and the other is based on top-down breaking the genomes (e.g. HomologyTeams [<xref ref-type="bibr" rid="B10">10</xref>]). We adopted the first strategy in CHSMiner because it was more widely used in relevant studies such as revealing ancient genome duplications [<xref ref-type="bibr" rid="B7">7</xref>]. Its procedure is also easier to understand: starting from two homologous genes, each at a different location, it looks for two other homologous genes that are each located within a prespecified distance from the former two ones. This process is iterated until no more additional pairs could be found [<xref ref-type="bibr" rid="B2">2</xref>,<xref ref-type="bibr" rid="B3">3</xref>]. The only important parameter that should be predefined is the maximal gap size (number of unmatched genes) allowed between two adjacent matched genes (Figure <xref ref-type="fig" rid="F1">1</xref>). Another advantage of the algorithm is that the greedy search has a fast computational speed because only a linear scan along a chromosome is needed.</p><fig position="float" id="F1"><label>Figure 1</label><caption><p><bold>Definition of CHS</bold>. In this application, CHS is defined as two genomic regions that share a set of homologous (matched) genes, regardless of gene order and orientation. A limited number of unmatched genes can be allowed between two adjacent matched genes, but are restricted to be no more than a predefined constant, i.e. the maximal gap size.</p></caption><graphic xlink:href="1748-7188-4-2-1"/></fig></sec><sec><title>Formal statistical evaluation</title><p>Statistical test is necessary to reduce the false positive segments identified by the search algorithm. A null model commonly used for this purpose is based on randomization of gene order in the original genome [<xref ref-type="bibr" rid="B7">7</xref>]. If the CHS identified is impossible to form in the random genome, we can confirm gene associations within the segment. Previous programmes simulate the null model through permuting the genome repeatedly, but it is a time-consuming procedure. Fortunately, Hoberman et al. [<xref ref-type="bibr" rid="B11">11</xref>] have presented a mathematical treatment for max-gap gene clusters. On the basis of their conclusion, CHSMiner performs analytical test that can greatly reduce the computational burden. Specifically, we consider a set of <italic>m </italic>marked genes forms a cluster with maximal <italic>g </italic>insertions allowed between two adjacent genes. First, if we assume every family contains only one gene, the exact probability of observing the cluster in a random genome of <italic>n </italic>genes is [<xref ref-type="bibr" rid="B11">11</xref>]</p><p><disp-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" name="1748-7188-4-2-i1" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>g</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>n</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>m</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>Next, we consider the general case that a family contains more than one gene. We denote <italic>F </italic>= {<italic>f</italic><sub>1</sub>, <italic>f</italic><sub>2</sub>, ... <italic>f</italic><sub><italic>m</italic></sub>}, where <italic>f</italic><sub><italic>j </italic></sub>is the number of genes of the same family with gene <italic>j </italic>in the cluster. Then the probability above can be corrected as:</p><p><disp-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2" name="1748-7188-4-2-i2" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>Finally, we multiply the probabilities that the cluster is observed in both genomes for comparison, each with parameters (<italic>n</italic><sub>1</sub>, <italic>F</italic><sub>1</sub>) and (<italic>n</italic><sub>2</sub>, <italic>F</italic><sub>2</sub>):</p><p><disp-formula><italic>Q</italic>(<italic>n</italic><sub>1</sub>, <italic>m</italic>, <italic>g</italic>, <italic>F</italic><sub>1</sub>)<italic>Q</italic>(<italic>n</italic><sub>2</sub>, <italic>m</italic>, <italic>g</italic>, <italic>F</italic><sub>2</sub>)</disp-formula></p><p>The value reflects the probability that a given CHS with maximal gap size <italic>g </italic>or smaller is observed in two independently and randomly ordered genomes. When the size of the CHS <italic>m </italic>is fixed, the smaller the maximal gap size is, the harder it can be observed. Therefore, the value can be treated as the <italic>p</italic>-value for the CHS. As a lot of CHSs should be assessed in whole genome comparison, we recommend an extra multiple test correction (e.g. Bonferroni correction) to the raw <italic>p</italic>-values in order to control false positive results.</p></sec><sec><title>Java package and GUI for visualization</title><p>CHSMiner is characterized by its graphical interface (Figure <xref ref-type="fig" rid="F2">2A</xref>) and several convenient features for end users include:</p><fig position="float" id="F2"><label>Figure 2</label><caption><p><bold>Graphical display of CHS</bold>. (A) CHSMiner organizes all identified CHSs as a table. It can generate two types of images for them. (B) Visualization of individual selected CHS, where homologous genes linked in the CHS are matched and labelled. (C) Visualization of a whole chromosomal pattern, where all homologous regions in a given chromosome are marked. The image is interactive and users can zoom in on a specific region.</p></caption><graphic xlink:href="1748-7188-4-2-2"/></fig><p>i. Automatic data download from Ensembl database [<xref ref-type="bibr" rid="B12">12</xref>] for well assembled genomes.</p><p>ii. Interactive operations and flexible parameter settings.</p><p>iii. Visual display of CHSs from an individual one to the whole genome pattern (Figure <xref ref-type="fig" rid="F2">2B, C</xref>).</p><p>iv. Useful graphic functions. The image can be saved as vector graph format for further edit.</p><p>The application was entirely written in Java and distributed as an executable jar package. It could run on any platform supporting Java Runtime Environment (1.5 or higher). Full source code and documents are also provided at our web site, and users can access them under GNU General Public License v2.0.</p></sec></sec><sec><title>Results and discussion</title><sec><title>Comparison on simulated data</title><p>We used simulated data to compare CHSMiner with similar existing software as we can easily observe their performance by adjusting the extent of degeneration. We adopted the methods developed by Hampson et al. [<xref ref-type="bibr" rid="B8">8</xref>] to simulate two artificial chromosomes that contained a predefined CHS (see Methods). The fraction of conserved genes between the CHS was specified as 30%, which was approximate to biological realistic parameters [<xref ref-type="bibr" rid="B8">8</xref>]. Another two parameters were changed to adjust the noise against the CHS recognition: (1) background similarity <italic>R</italic>, and (2) the number of inversions <italic>F</italic>. Background similarity reflects extensive duplications and transpositions of individual genes [<xref ref-type="bibr" rid="B13">13</xref>]. In this analysis, <italic>R </italic>= 0.2 and 0.3 were chosen and <italic>F </italic>was varied between 1 and 10<sup>5 </sup>to rearrange the gene order sufficiently. We compared CHSMiner with three other typical programmes for CHS detection, i.e. LineUp [<xref ref-type="bibr" rid="B6">6</xref>], CloseUp [<xref ref-type="bibr" rid="B8">8</xref>] and HomologyTeams [<xref ref-type="bibr" rid="B10">10</xref>] (Table <xref ref-type="table" rid="T1">1</xref>). They were run on the simulated data set with the same parameter settings (see Methods). Both sensitivity and specificity were calculated for the results to evaluate the performance of the four programmes (Figure <xref ref-type="fig" rid="F3">3</xref>).</p><fig position="float" id="F3"><label>Figure 3</label><caption><p><bold>Performance comparison on simulated data</bold>. The extent of noise was controlled by the background similarity <italic>R </italic>and the number of inversions <italic>F</italic>. For each combination of <italic>R </italic>and <italic>F</italic>, 10 samples were simulated. Both sensitivity and specificity were calculated for the result of each sample (see Methods). The data point and error bar represent the mean value and the standard error of every percentage.</p></caption><graphic xlink:href="1748-7188-4-2-3"/></fig><table-wrap position="float" id="T1"><label>Table 1</label><caption><p>Summary of the four programmes for comparison</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="center">Programme</td><td align="center">CHS definition</td><td align="center">Search algorithm</td><td align="center">Statistical evaluation</td></tr></thead><tbody><tr><td align="center">CHSMiner</td><td align="center">Gene content</td><td align="center">Bottom-up</td><td align="center">Analytical calculation</td></tr><tr><td align="center">LineUp</td><td align="center">Gene colinearity</td><td align="center">Bottom-up</td><td align="center">Monte Carlo simulation</td></tr><tr><td align="center">CloseUp</td><td align="center">Gene content</td><td align="center">Bottom-up</td><td align="center">Monte Carlo simulation</td></tr><tr><td align="center">HomologyTeams</td><td align="center">Gene content</td><td align="center">Top-down</td><td align="center">Not available</td></tr></tbody></table></table-wrap><p>It is clear that the sensitivity of the algorithm based on colinearity will become gradually poor with the increase of inversions, whereas the algorithms based on gene content alone are quite robust to the disorders. HomologyTeams has the advantage of finding nonnested regions [<xref ref-type="bibr" rid="B14">14</xref>], but its gain of sensitivity is not evident until inversions are extremely frequent (&#x0003e;10<sup>5</sup>). In addition, as statistical validation is not implemented in HomologyTeams, its specificity will become quite lower when the background similarity is increased. CHSMiner and CloseUp can always have similar and satisfactory sensitivity and specificity for different <italic>R </italic>and <italic>F</italic>, suggesting that the analytical method of CHSMiner works as well as Monte Carlo simulation on empirical data. Nonetheless, CHSMiner is much faster than CloseUp. On a single Pentium processor CloseUp required more than one hour to run the simulated data set (1000 permutations for each CHS to get a reliable assessment), whereas CHSMiner took less than one minute. According to our experience, time is an important factor in genome comparison as we usually need to adjust parameters for the program. Thus, our tool greatly improves the efficiency and usability.</p></sec><sec><title>Comparison on human-mouse synteny map</title><p>In order to show its performance on real biological data, we used CHSMiner to construct the synteny map for human and mouse. We downloaded homolog information from Ensembl database [<xref ref-type="bibr" rid="B12">12</xref>] and run the program with different maximal gap size. Each synteny detected was evaluated by corrected <italic>p</italic>-value (Bonferroni method) and only those smaller than 0.05 were preserved. The results were compared with the synteny map provided by Ensembl (release 47), which was generated from primary DNA sequence alignments [<xref ref-type="bibr" rid="B15">15</xref>].</p><p>We find our result is highly consistent with Ensembl map when the maximal gap size is equal to one gene (Table <xref ref-type="table" rid="T2">2</xref>). There are 18753 orthologs present in Ensembl map, where 85% (15866) are found in our result. There are 3518 orthologs absent in Ensembl map, where 87% (3071) are not found in our result either. Furthermore, CHSMiner took only less than one minute to accomplish the analysis. Thus, our software has adequate power in both accuracy and efficiency to carry on large genome comparison.</p><table-wrap position="float" id="T2"><label>Table 2</label><caption><p>Number of orthologs covered by Ensembl synteny map and CHSMiner result</p></caption><table frame="hsides" rules="groups"><thead><tr><td></td><td></td><td align="center" colspan="4">CHSMiner result (by maximal gap size)</td><td></td></tr><tr><td></td><td></td><td colspan="4"><hr></hr></td><td></td></tr><tr><td></td><td></td><td align="center" colspan="2">One gene</td><td align="center" colspan="2">Five genes</td><td align="center">Total</td></tr><tr><td></td><td></td><td colspan="4"><hr></hr></td><td></td></tr><tr><td></td><td></td><td align="center">Present</td><td align="center">Absent</td><td align="center">Present</td><td align="center">Absent</td><td></td></tr></thead><tbody><tr><td align="center">Ensembl synteny map</td><td align="center">Present</td><td align="center">15866</td><td align="center">2887</td><td align="center">18135</td><td align="center">618</td><td align="center">18753</td></tr><tr><td></td><td colspan="6"><hr></hr></td></tr><tr><td></td><td align="center">Absent</td><td align="center">447</td><td align="center">3071</td><td align="center">1209</td><td align="center">2309</td><td align="center">3518</td></tr><tr><td colspan="7"><hr></hr></td></tr><tr><td align="center" colspan="2">Total</td><td align="center">16313</td><td align="center">5958</td><td align="center">19344</td><td align="center">2927</td><td></td></tr></tbody></table></table-wrap><p>When we increase the maximal gap size to five genes, the coverage of detected syntenies will become larger (Table <xref ref-type="table" rid="T2">2</xref>). Not only nearly all orthologs present in Ensembl map (18135 in 18753, 97%), but also an amount of ones absent in it (1209 in 3518, 34%) can now be discovered. The result does not change too much when the gap size is increased more (up to 30, data not shown). Since a strict statistical criterion has been applied for filtering, the newly obtained CHSs are less likely to be false positives. The reasonable interpretation is that those degraded CHSs can not be recognized from the primary sequence by the strategy of Ensembl. Therefore, CHSMiner is more flexible and can reveal more complete CHSs by selecting proper parameters.</p></sec></sec><sec><title>Conclusion</title><p>CHSMiner is designed to identify chromosomal homologous segments based on gene content alone, which enables it to discover highly degenerated homology. Compared with previous tools, it has at least three significant advantages: (1) it has comprised search algorithm, statistical validation and result display in a uniform platform; (2) it has improved both accuracy and efficiency; (3) its graphical and interactive interface allows it easy to use. We hope it will be helpful for biologists who are interested in the structure and evolution of genomes.</p></sec><sec sec-type="methods"><title>Methods</title><sec><title>CHS simulation</title><p>First, two artificial chromosomes were created, each containing 1000 genes. The background similarity was simulated by assigning a gene to be the homolog of some other gene with probability <italic>R</italic>, regardless of their locations. Then the middle 20% of the two chromosomes were specified as a known CHS. Within the region, a gene in one chromosome would have a corresponding homolog in the other chromosome with probability 0.3. Finally, the inversions were simulated by exchanging two randomly chosen neighbouring gene pairs.</p></sec><sec><title>Software comparison</title><p>All the four software packages were tested on the simulated data set with the same parameter settings, i.e. the gap size should be less than 20 genes and each CHS should have at least 3 matched genes. LineUp was run with inversions forbidden. If statistical test was available, each CHS detected was further assessed by corrected <italic>p</italic>-value (Bonferroni method) and only those smaller than 0.05 were preserved. The sensitivity was calculated as <italic>P</italic>/<italic>TP</italic>, where <italic>TP </italic>was the number of genes in the predefined CHS (<italic>TP </italic>= 200) and <italic>P </italic>was the number detected among them. The specificity was calculated as <italic>N</italic>/<italic>TN</italic>, where <italic>TN </italic>was the number of genes not in the predefined CHS (<italic>TN </italic>= 800) and <italic>N </italic>was the number remaining undetected in <italic>TN</italic>.</p></sec></sec><sec><title>Availability and requirements</title><p>Project name: CHSMiner</p><p>Project home page: <ext-link ext-link-type="uri" xlink:href="http://www.biosino.org/papers/CHSMiner/"/></p><p>Operating system(s): Platform independent</p><p>Programming language: Java</p><p>Other requirements: JRE 1.5 or higher</p><p>License: GNU GPL</p></sec><sec><title>Competing interests</title><p>The authors declare that they have no competing interests.</p></sec><sec><title>Authors' contributions</title><p>ZW designed the software, implemented the algorithm and drafted the manuscript. GD conceived of the software, and participated in its design. ZY participated in the discussion of biological significances. LL and YL revised the manuscript. All authors read and approved the final manuscript.</p></sec></body><back><ack><sec><title>Acknowledgements</title><p>This research was supported by grants from National High-Tech R&#x00026;D Program (863): 2006AA02Z334, State key basic research program (973): 2006CB910705, 2003CB715901, and Research Program of CAS (KSCX2-YW-R-112).</p></sec></ack><ref-list><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Murphy</surname><given-names>WJ</given-names></name><name><surname>Larkin</surname><given-names>DM</given-names></name><name><surname>Wind</surname><given-names>A Everts-van der</given-names></name><name><surname>Bourque</surname><given-names>G</given-names></name><name><surname>Tesler</surname><given-names>G</given-names></name><name><surname>Auvil</surname><given-names>L</given-names></name><name><surname>Beever</surname><given-names>JE</given-names></name><name><surname>Chowdhary</surname><given-names>BP</given-names></name><name><surname>Galibert</surname><given-names>F</given-names></name><name><surname>Gatzke</surname><given-names>L</given-names></name><etal></etal></person-group><article-title>Dynamics of mammalian chromosome evolution inferred from multispecies comparative maps</article-title><source>Science</source><year>2005</year><volume>309</volume><fpage>613</fpage><lpage>617</lpage><pub-id pub-id-type="pmid">16040707</pub-id><pub-id pub-id-type="doi">10.1126/science.1111387</pub-id></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Peer</surname><given-names>Y Van de</given-names></name></person-group><article-title>Computational approaches to unveiling ancient genome duplications</article-title><source>Nat Rev Genet</source><year>2004</year><volume>5</volume><fpage>752</fpage><lpage>763</lpage><pub-id pub-id-type="pmid">15510166</pub-id><pub-id pub-id-type="doi">10.1038/nrg1449</pub-id></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Simillion</surname><given-names>C</given-names></name><name><surname>Vandepoele</surname><given-names>K</given-names></name><name><surname>Peer</surname><given-names>Y Van de</given-names></name></person-group><article-title>Recent developments in computational approaches for uncovering genomic homology</article-title><source>Bioessays</source><year>2004</year><volume>26</volume><fpage>1225</fpage><lpage>1235</lpage><pub-id pub-id-type="pmid">15499578</pub-id><pub-id pub-id-type="doi">10.1002/bies.20127</pub-id></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Vandepoele</surname><given-names>K</given-names></name><name><surname>Saeys</surname><given-names>Y</given-names></name><name><surname>Simillion</surname><given-names>C</given-names></name><name><surname>Raes</surname><given-names>J</given-names></name><name><surname>Peer</surname><given-names>Y Van De</given-names></name></person-group><article-title>The automatic detection of homologous regions (ADHoRe) and its application to microcolinearity between Arabidopsis and rice</article-title><source>Genome Res</source><year>2002</year><volume>12</volume><fpage>1792</fpage><lpage>1801</lpage><pub-id pub-id-type="pmid">12421767</pub-id><pub-id pub-id-type="doi">10.1101/gr.400202</pub-id></citation></ref><ref id="B5"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Calabrese</surname><given-names>PP</given-names></name><name><surname>Chakravarty</surname><given-names>S</given-names></name><name><surname>Vision</surname><given-names>TJ</given-names></name></person-group><article-title>Fast identification and statistical evaluation of segmental homologies in comparative maps</article-title><source>Bioinformatics</source><year>2003</year><volume>19</volume><fpage>i74</fpage><lpage>80</lpage><pub-id pub-id-type="pmid">12855440</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btg1008</pub-id></citation></ref><ref id="B6"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hampson</surname><given-names>S</given-names></name><name><surname>McLysaght</surname><given-names>A</given-names></name><name><surname>Gaut</surname><given-names>B</given-names></name><name><surname>Baldi</surname><given-names>P</given-names></name></person-group><article-title>LineUp: statistical detection of chromosomal homology with application to plant comparative genomics</article-title><source>Genome Res</source><year>2003</year><volume>13</volume><fpage>999</fpage><lpage>1010</lpage><pub-id pub-id-type="pmid">12695327</pub-id><pub-id pub-id-type="doi">10.1101/gr.814403</pub-id></citation></ref><ref id="B7"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>McLysaght</surname><given-names>A</given-names></name><name><surname>Hokamp</surname><given-names>K</given-names></name><name><surname>Wolfe</surname><given-names>KH</given-names></name></person-group><article-title>Extensive genomic duplication during early chordate evolution</article-title><source>Nat Genet</source><year>2002</year><volume>31</volume><fpage>200</fpage><lpage>204</lpage><pub-id pub-id-type="pmid">12032567</pub-id><pub-id pub-id-type="doi">10.1038/ng884</pub-id></citation></ref><ref id="B8"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hampson</surname><given-names>SE</given-names></name><name><surname>Gaut</surname><given-names>BS</given-names></name><name><surname>Baldi</surname><given-names>P</given-names></name></person-group><article-title>Statistical detection of chromosomal homology using shared-gene density alone</article-title><source>Bioinformatics</source><year>2005</year><volume>21</volume><fpage>1339</fpage><lpage>1348</lpage><pub-id pub-id-type="pmid">15585535</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/bti168</pub-id></citation></ref><ref id="B9"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ding</surname><given-names>G</given-names></name><name><surname>Sun</surname><given-names>Y</given-names></name><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Wang</surname><given-names>Z</given-names></name><name><surname>Fan</surname><given-names>H</given-names></name><name><surname>Wang</surname><given-names>C</given-names></name><name><surname>Yang</surname><given-names>D</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name></person-group><article-title>EPGD: a comprehensive web resource for integrating and displaying eukaryotic paralog/paralogon information</article-title><source>Nucleic Acids Res</source><year>2008</year><volume>36</volume><fpage>D255</fpage><lpage>262</lpage><pub-id pub-id-type="pmid">17984073</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkm924</pub-id></citation></ref><ref id="B10"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>He</surname><given-names>X</given-names></name><name><surname>Goldwasser</surname><given-names>MH</given-names></name></person-group><article-title>Identifying conserved gene clusters in the presence of homology families</article-title><source>J Comput Biol</source><year>2005</year><volume>12</volume><fpage>638</fpage><lpage>656</lpage><pub-id pub-id-type="pmid">16108708</pub-id><pub-id pub-id-type="doi">10.1089/cmb.2005.12.638</pub-id></citation></ref><ref id="B11"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hoberman</surname><given-names>R</given-names></name><name><surname>Sankoff</surname><given-names>D</given-names></name><name><surname>Durand</surname><given-names>D</given-names></name></person-group><article-title>The statistical analysis of spatially clustered genes under the maximum gap criterion</article-title><source>J Comput Biol</source><year>2005</year><volume>12</volume><fpage>1083</fpage><lpage>1102</lpage><pub-id pub-id-type="pmid">16241899</pub-id><pub-id pub-id-type="doi">10.1089/cmb.2005.12.1083</pub-id></citation></ref><ref id="B12"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hubbard</surname><given-names>TJ</given-names></name><name><surname>Aken</surname><given-names>BL</given-names></name><name><surname>Beal</surname><given-names>K</given-names></name><name><surname>Ballester</surname><given-names>B</given-names></name><name><surname>Caccamo</surname><given-names>M</given-names></name><name><surname>Chen</surname><given-names>Y</given-names></name><name><surname>Clarke</surname><given-names>L</given-names></name><name><surname>Coates</surname><given-names>G</given-names></name><name><surname>Cunningham</surname><given-names>F</given-names></name><name><surname>Cutts</surname><given-names>T</given-names></name><etal></etal></person-group><article-title>Ensembl 2007</article-title><source>Nucleic Acids Res</source><year>2007</year><volume>35</volume><fpage>D610</fpage><lpage>617</lpage><pub-id pub-id-type="pmid">17148474</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkl996</pub-id></citation></ref><ref id="B13"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Gu</surname><given-names>X</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Gu</surname><given-names>J</given-names></name></person-group><article-title>Age distribution of human gene families shows significant roles of both large- and small-scale duplications in vertebrate evolution</article-title><source>Nat Genet</source><year>2002</year><volume>31</volume><fpage>205</fpage><lpage>209</lpage><pub-id pub-id-type="pmid">12032571</pub-id><pub-id pub-id-type="doi">10.1038/ng902</pub-id></citation></ref><ref id="B14"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Durand</surname><given-names>D</given-names></name><name><surname>Hoberman</surname><given-names>R</given-names></name></person-group><article-title>Diagnosing duplications&#x02013;can it be done?</article-title><source>Trends Genet</source><year>2006</year><volume>22</volume><fpage>156</fpage><lpage>164</lpage><pub-id pub-id-type="pmid">16442663</pub-id><pub-id pub-id-type="doi">10.1016/j.tig.2006.01.002</pub-id></citation></ref><ref id="B15"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Clamp</surname><given-names>M</given-names></name><name><surname>Andrews</surname><given-names>D</given-names></name><name><surname>Barker</surname><given-names>D</given-names></name><name><surname>Bevan</surname><given-names>P</given-names></name><name><surname>Cameron</surname><given-names>G</given-names></name><name><surname>Chen</surname><given-names>Y</given-names></name><name><surname>Clark</surname><given-names>L</given-names></name><name><surname>Cox</surname><given-names>T</given-names></name><name><surname>Cuff</surname><given-names>J</given-names></name><name><surname>Curwen</surname><given-names>V</given-names></name><etal></etal></person-group><article-title>Ensembl 2002: accommodating comparative genomics</article-title><source>Nucleic Acids Res</source><year>2003</year><volume>31</volume><fpage>38</fpage><lpage>42</lpage><pub-id pub-id-type="pmid">12519943</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkg083</pub-id></citation></ref></ref-list></back></article>