<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.0 20120330//EN" "JATS-archivearticle1.dtd"><article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article" xml:lang="en"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Evol Biol</journal-id><journal-id journal-id-type="iso-abbrev">BMC Evol. Biol</journal-id><journal-title-group><journal-title>BMC Evolutionary Biology</journal-title></journal-title-group><issn pub-type="epub">1471-2148</issn><publisher><publisher-name>BioMed Central</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">18947398</article-id><article-id pub-id-type="pmc">2636790</article-id><article-id pub-id-type="publisher-id">1471-2148-8-289</article-id><article-id pub-id-type="doi">10.1186/1471-2148-8-289</article-id><article-categories><subj-group subj-group-type="heading"><subject>Methodology Article</subject></subj-group></article-categories><title-group><article-title>Bayesian inference of population size history from multiple loci</article-title></title-group><contrib-group><contrib contrib-type="author" id="A1"><name><surname>Heled</surname><given-names>Joseph</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>jheled@gmail.com</email></contrib><contrib contrib-type="author" corresp="yes" id="A2"><name><surname>Drummond</surname><given-names>Alexei J</given-names></name><xref ref-type="aff" rid="I1">1</xref><xref ref-type="aff" rid="I2">2</xref><email>alexei@cs.auckland.ac.nz</email></contrib></contrib-group><aff id="I1"><label>1</label>Department of Computer Science, University of Auckland, Auckland, New Zealand</aff><aff id="I2"><label>2</label>Bioinformatics Institute, University of Auckland, Auckland, New Zealand</aff><pub-date pub-type="collection"><year>2008</year></pub-date><pub-date pub-type="epub"><day>23</day><month>10</month><year>2008</year></pub-date><volume>8</volume><fpage>289</fpage><lpage>289</lpage><history><date date-type="received"><day>22</day><month>2</month><year>2008</year></date><date date-type="accepted"><day>23</day><month>10</month><year>2008</year></date></history><permissions><copyright-statement>Copyright &#x000a9;2008 Heled and Drummond; licensee BioMed Central Ltd.</copyright-statement><copyright-year>2008</copyright-year><copyright-holder>Heled and Drummond; licensee BioMed Central Ltd.</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0"><license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p></license></permissions><self-uri xlink:href="http://www.biomedcentral.com/1471-2148/8/289"/><abstract><sec><title>Background</title><p>Effective population size (<italic>N</italic><sub><italic>e</italic></sub>) is related to genetic variability and is a basic parameter in many models of population genetics. A number of methods for inferring current and past population sizes from genetic data have been developed since JFC Kingman introduced the n-coalescent in 1982. Here we present the Extended Bayesian Skyline Plot, a non-parametric Bayesian Markov chain Monte Carlo algorithm that extends a previous coalescent-based method in several ways, including the ability to analyze multiple loci.</p></sec><sec><title>Results</title><p>Through extensive simulations we show the accuracy and limitations of inferring population size as a function of the amount of data, including recovering information about evolutionary bottlenecks. We also analyzed two real data sets to demonstrate the behavior of the new method; a single gene Hepatitis C virus data set sampled from Egypt and a 10 locus <italic>Drosophila ananassae </italic>data set representing 16 different populations.</p></sec><sec><title>Conclusion</title><p>The results demonstrate the essential role of multiple loci in recovering population size dynamics. Multi-locus data from a small number of individuals can precisely recover past bottlenecks in population size which can not be characterized by analysis of a single locus. We also demonstrate that sequence data quality is important because even moderate levels of sequencing errors result in a considerable decrease in estimation accuracy for realistic levels of population genetic variability.</p></sec></abstract></article-meta></front><body><sec><title>Background</title><p>Coalescent theory has been described as "the most significant progress in theoretical population genetics in the past two decades of [last] century" [<xref ref-type="bibr" rid="B1">1</xref>]. Methods based on coalescent theory enable estimation of both current and past population sizes directly from genetic data. Effective population size (<italic>N</italic><sub><italic>e</italic></sub>) is linked to the rate of genetic drift and inbreeding, and is useful for example when investigating the possibility of interbreeding between Neanderthals and early humans [<xref ref-type="bibr" rid="B2">2</xref>], or when looking at patterns of genetic variation in human genes [<xref ref-type="bibr" rid="B3">3</xref>]. Even when population size history is of secondary interest the incorporation of models of population size may improve the genetic mapping of diseases and estimation of genetic traits [<xref ref-type="bibr" rid="B4">4</xref>].</p><sec><title>A concise introduction to the coalescent</title><p>The coalescent was formally introduced by Kingman in 1982 [<xref ref-type="bibr" rid="B5">5</xref>]. This was the culmination of eight years of developing the "circle of ideas known as the coalescent" [<xref ref-type="bibr" rid="B6">6</xref>] which brought into light the essence of the relation between population size and ancestry. Informally, the larger the population, the longer any two individuals have to trace their ancestry back in time until meeting their common ancestor (<italic>concestor </italic>[<xref ref-type="bibr" rid="B7">7</xref>]). The meeting of those two ancestral lineages is known as the <italic>coalescence event</italic>.</p><p>To formally develop the theory one has to assume the population is mixing perfectly so that all members of the same generation have equal probability of being the ancestor of any member in the next generation. Kingman introduces the idea using an idealized Wright-Fisher population but shows how the Moran model also has the coalescent as its diffusion limit (for a good summary of these models see [<xref ref-type="bibr" rid="B8">8</xref>]).</p><p>Consider two random members from a population of fixed size <italic>N</italic>. By perfect mixing, the probability they share a concestor in the previous generation is 1/<italic>N</italic>. The probability the concestor is <italic>g </italic>+ 1 generations back is <inline-formula><mml:math id="M1" name="1471-2148-8-289-i1" overflow="scroll"><mml:semantics><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>g</mml:mi></mml:msup></mml:mrow></mml:semantics></mml:math></inline-formula>. This elementary reasoning shows that <italic>g</italic>, as a random variable, has a geometric distribution with a success rate of <italic>&#x003bb; </italic>= 1/<italic>N</italic>, and so has mean <italic>N </italic>and variance of <italic>N</italic><sup>3</sup>/(<italic>N </italic>- 1).</p><p>With <italic>n </italic>lineages the time to the first coalescence is derived in the same way, only now there are <inline-formula><mml:math id="M2" name="1471-2148-8-289-i2" overflow="scroll"><mml:semantics><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>n</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:semantics></mml:math></inline-formula> possible pairs that may coalesce, resulting in a success rate of <inline-formula><mml:math id="M3" name="1471-2148-8-289-i3" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>&#x003bb;</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>n</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:semantics></mml:math></inline-formula> and mean time to coalescence of <inline-formula><mml:math id="M4" name="1471-2148-8-289-i4" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>N</mml:mi><mml:mo>/</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>n</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:semantics></mml:math></inline-formula>.</p><p>This assumes <italic>N </italic>is much larger than <italic>O</italic>(<italic>n</italic><sup>2</sup>). An interesting consequence is that the total number of generations required for <italic>n </italic>lineages to coalesce into one is <inline-formula><mml:math id="M5" name="1471-2148-8-289-i5" overflow="scroll"><mml:semantics><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:mi>N</mml:mi><mml:mo>/</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>i</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:semantics></mml:math></inline-formula>, which is always less than 2<italic>N </italic>regardless of <italic>n</italic>.</p><p>Kingman goes on to show that as <italic>N </italic>grows the coalescent process converges to a continuous time Markov chain. For the above <italic>&#x003bb; </italic>= 1/<italic>N </italic>is the instantaneous probability of coalescing, i.e. the probability of coalescing on a short time interval &#x00394;<italic>t </italic>is <italic>O</italic>(<italic>&#x003bb;</italic>&#x00394;<italic>t</italic>). Unsurprisingly the solution turns out to be the exponential distribution <italic>f</italic>(<italic>t</italic>) = <italic>&#x003bb;e</italic><sup>-<italic>&#x003bb;</italic>t</sup>, the continuous equivalent of the geometric distribution.</p><p>While Kingman mentions that population size does not have to be constant the details are not given. The generalization of the coalescent for the case where the population size changes over time, <italic>N </italic>= <italic>N</italic>(<italic>t</italic>) is given by Griffiths and Tavare [<xref ref-type="bibr" rid="B9">9</xref>]. They showed that the coalescent density for the first coalescence event being at time <italic>t </italic>in the past given <italic>n </italic>lineages is:</p><p><disp-formula id="bmcM1"><label>(1)</label><mml:math id="M6" name="1471-2148-8-289-i6" overflow="scroll"><mml:semantics><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mi>C</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mi>exp</mml:mi><mml:mo>&#x02061;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:munderover><mml:mo>&#x0222b;</mml:mo><mml:mn>0</mml:mn><mml:mi>t</mml:mi></mml:munderover><mml:mrow><mml:mfrac><mml:mi>C</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtext>where</mml:mtext></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>n</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>In the rest of the article we shall call <italic>N </italic>= <italic>N</italic>(<italic>t</italic>) the <italic>demographic function </italic>or sometimes just <italic>demographic </italic>when the context is clear. Note that while <italic>N</italic>(<italic>t</italic>) may take any form whose inverse can be integrated, the density is characterized by two numbers only, the intensity (average of population size inverse over the interval) and population size at the end of the interval.</p><p>All together, given a demographic function <italic>N</italic>(<italic>t</italic>) and a list of coalescence times <italic>T </italic>= (<italic>t</italic><sub><italic>n</italic>+1 </sub>= 0, <italic>t</italic><sub><italic>n</italic></sub>, <italic>t</italic><sub><italic>n</italic>-1</sub>,...<italic>t</italic><sub>2</sub>) where <italic>t</italic><sub><italic>n </italic></sub>is the time <italic>n </italic>lineages has coalesced into <italic>n </italic>- 1, the probability those times are the result of the coalescent process reducing <italic>n </italic>lineages into 1 is obtained by multiplying the (independent) probabilities for each coalescence event,</p><p><disp-formula id="bmcM2"><label>(2)</label><mml:math id="M7" name="1471-2148-8-289-i7" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo>|</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>i</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle><mml:mi>exp</mml:mi><mml:mo>&#x02061;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:munderover><mml:mo>&#x0222b;</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>i</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>One nice feature of coalescent theory is that demographic inference depends only on coalescent times and so can be coupled with any method which can estimate the genealogy in a statistically consistent manner. There are numerous examples of the coalescent theory being coupled with different data and estimation procedures for the coalescent times. Tavare <italic>et al </italic>estimated coalescent times from genetic data using only the number of segregating sites while assuming a known demographic function [<xref ref-type="bibr" rid="B10">10</xref>]. Coalescent theory has also been used within Markov chain Monte Carlo (MCMC) algorithms to estimate constant [<xref ref-type="bibr" rid="B11">11</xref>] and exponentially growing [<xref ref-type="bibr" rid="B12">12</xref>] population sizes using microsatellite data. More recently the Skyline Plot, a maximum likelihood estimator (MLE) of the demographic function for a known genealogy, was introduced [<xref ref-type="bibr" rid="B13">13</xref>]. This was further extended in the form of the Bayesian Skyline Plot (BSP) [<xref ref-type="bibr" rid="B14">14</xref>], a MCMC method that estimates the demographic function directly from sequence data and provides much needed credible intervals. This paper extends the BSP further by allowing the joint analysis of multiple loci and eliminating the requirement to pre-specify the model dimensionality. An alternative approach using reversible jump MCMC to dynamically change the dimensionality of the demographic model was previously introduced [<xref ref-type="bibr" rid="B15">15</xref>], but was implemented for a known genealogy only. More recently an alternative which uses Gaussian Markov random fields (GMRFs) to achieve temporal smoothing of the population sizes has been developed [<xref ref-type="bibr" rid="B16">16</xref>], but this method does not currently support multiple loci.</p></sec><sec><title>Inferring population size from coalescent times</title><p>Estimating changes in population size is a challenging task, especially when the magnitude of the change is small. Even if the exact coalescence times are known the space of demographic functions capable of generating them is large. In general the coalescent times are unknown and have to be estimated by phylogenetic reconstruction, thus increasing the set of plausible demographic functions further. In addition, the "observation window" is limited by the last coalescent which is on average 2<italic>N </italic>generations in the past. Moreover, under a constant population size it is expected that half of the time to the root of the tree is spanned by just one coalescent interval (one data point), so no dynamics can be inferred, just the average population size over that time span. Similarly (under constant size expectations) just two data points account for 2/3 of the tree, and so on. Thirdly evolutionary bottlenecks (periods with smaller population sizes) have shorter coalescence times, reducing the observation window further.</p><p>Faced with these problems, one might be tempted to increase the number of samples. However the returns from such an investment diminish quickly &#x02013; the additional coalescent events occur inside a small stretch of time. It is much better to add sequences from independent loci from the same population since all loci share the same demographic history. The assumption of independence requires loci from different chromosomes or sufficiently distant to one another to be considered unlinked by recombination. Doubling the number of (independent) loci doubles the amount of information over the whole "observation window". In this paper we introduce the Extended Bayesian Skyline Plot (EBSP), a new variable-dimension Bayesian method for inferring non-parametric population size changes through time from multiple loci. The EBSP builds on the Bayesian Skyline Plot (BSP) [<xref ref-type="bibr" rid="B14">14</xref>] in several ways:</p><p>&#x02022; Permits analysis of multiple loci. Any number of unlinked nuclear or mitochondrial loci from individuals in the population may be combined to infer the shared population size history. Each loci may have its own <italic>population factor </italic>which takes care of differences in ploidy and inheritance. For example, In many animals the population of alleles of a nuclear gene is four times greater than that of mtDNA since there are two copies of the nuclear gene in each individual and mtDNA is inherited exclusively maternally in most species. In that case the population factor can be set to 4 for nuclear genes and 1 for mtDNA if inference of mtDNA gene population size is desired, or to 2 for nuclear genes and 1/2 for mtDNA to infer the number of individual animals.</p><p>&#x02022; Uses Bayesian stochastic variable selection. The original BSP required the researcher to arbitrarily choose <italic>i </italic>the number of population size steps, or control points. The demographic function is then constrained to be a piecewise constant function with exactly <italic>i </italic>distinct levels. It is not obvious how to <italic>a priori </italic>choose <italic>i</italic>, and a poor choice may lead to larger credible bounds and in more extreme cases inhibit convergence. The EBSP, in a true Bayesian spirit, lets the data select the appropriate smoothness of the demographic function using Bayesian stochastic variable selection (BSVS) [<xref ref-type="bibr" rid="B17">17</xref>-<xref ref-type="bibr" rid="B19">19</xref>].</p><p>&#x02022; Supports piecewise linear demographic functions. Because real life population size dynamics tend to be continuous, a piecewise linear demographic function will generally be a more appropriate model than the piecewise constant function used by the BSP.</p></sec></sec><sec sec-type="methods"><title>Methods</title><p>Consider the most simple case of two lineages and constant population size <italic>N</italic>. Given that the time to coalesce was <italic>t</italic>, what can be said about <italic>N</italic>? The maximum likelihood estimate (i.e. the value which maximizes <italic>f</italic>(<italic>t</italic>|<italic>N</italic>)) is <italic>N </italic>= <italic>t </italic>[<xref ref-type="bibr" rid="B20">20</xref>]. While this is the best point estimate possible, the large variability inherent in a stochastic process driven by an exponential distribution makes a point estimate unsatisfactory. The Bayesian framework provides a way to quantify the uncertainty using Bayes rule, <inline-formula><mml:math id="M8" name="1471-2148-8-289-i8" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>|</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>|</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:semantics></mml:math></inline-formula>.</p><p>With the natural non informative prior for a scale variable <italic>f</italic>(<italic>N</italic>) = 1/<italic>N </italic>[<xref ref-type="bibr" rid="B21">21</xref>] the cumulative probability can be solved which enables us to obtain an explicit numerical solution for the credible interval. This turns out to be [0.093t, 19.504t], an order of magnitude at both sides of <italic>t</italic>. Point estimates from this distribution can also be computed. The mode is <inline-formula><mml:math id="M9" name="1471-2148-8-289-i9" overflow="scroll"><mml:semantics><mml:mrow><mml:msqrt><mml:mrow><mml:mi>t</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msqrt></mml:mrow></mml:semantics></mml:math></inline-formula>, median is <italic>t</italic>/ln(2) and the mean is infinite.</p><p>On the other hand, a genealogy with <italic>n </italic>lineages contains <italic>n </italic>- 1 independent observations via the time intervals between subsequent coalescence events, providing a much better estimate of <italic>N</italic>. However, it should be noted that point estimates from a Bayesian inference typically contain a built-in bias. For example the bias for the median in the two lineages case above is on average 44% (1/ln(2) - 1). The bias in real life data sets which contain multiple loci from several individual is naturally much reduced.</p><sec><title>The likelihood of genealogies from multiple loci</title><p>The likelihood of the EBSP is derived from <italic>m </italic>genealogies in the form of rooted trees, denoted <italic>G </italic>= {<italic>g</italic><sub>1</sub>, <italic>g</italic><sub>2</sub>...<italic>g</italic><sub><italic>m</italic></sub>}, were <italic>g</italic><sub><italic>k </italic></sub>is estimated from <italic>n</italic><sub><italic>k </italic></sub>contemporaneous sequences. The time scale for all genealogies should match that of the target population being estimated, but the substitution rate may vary among loci. For example, mtDNA is known to evolve at a much faster rate than nuclear DNA [<xref ref-type="bibr" rid="B22">22</xref>,<xref ref-type="bibr" rid="B23">23</xref>] so when combining both in one analysis the difference in substitution rate needs to be estimated. We designate the set of substitution rate parameters <italic>&#x003bc; </italic>to keep the notation from becoming overly confusing. In addition let <italic>P </italic>= <italic>p</italic><sub>1</sub>, <italic>p</italic><sub>2</sub>,...,<italic>p</italic><sub><italic>k </italic></sub>be the population size factor of <italic>g</italic><sub><italic>k</italic></sub>, which accounts for any differences in ploidy and/or mode of inheritance among loci. The internal nodes of each genealogy <italic>g</italic><sub><italic>k </italic></sub>define <italic>n</italic><sub><italic>k </italic></sub>- 1 coalescent event times <inline-formula><mml:math id="M10" name="1471-2148-8-289-i10" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>...</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>, where <italic>u</italic><sub><italic>k</italic>,<italic>j </italic></sub>is the time <italic>j </italic>lineages have coalesced into <italic>j </italic>- 1. The start point is fixed at zero, <inline-formula><mml:math id="M11" name="1471-2148-8-289-i11" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:semantics></mml:math></inline-formula>.</p><p>Now let <italic>T </italic>= {<italic>t</italic><sub>0 </sub>= 0, <italic>t</italic><sub>1</sub>, <italic>t</italic><sub>2</sub>,...,<italic>t</italic><sub><italic>n</italic></sub>} &#x02208; &#x0222a;<sub><italic>k </italic></sub><italic>u</italic><sub><italic>k </italic></sub>be the vector containing all <inline-formula><mml:math id="M12" name="1471-2148-8-289-i12" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mi>k</mml:mi></mml:munder><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:semantics></mml:math></inline-formula> coalescence times in sorted order. The demographic function is defined by the population size and <italic>indicator </italic>vectors, &#x00398; and &#x0039b;. &#x00398; = {<italic>&#x003b8;</italic><sub>0</sub>, <italic>&#x003b8;</italic><sub>1</sub>,...,<italic>&#x003b8;</italic><sub><italic>n</italic></sub>} where <italic>&#x003b8;</italic><sub><italic>j </italic></sub>is the effective population size at time <italic>t</italic><sub><italic>j</italic></sub>, and &#x0039b; = {<italic>&#x003bb;</italic><sub>0 </sub>= 1, <italic>&#x003bb;</italic><sub>1</sub>, <italic>&#x003bb;</italic><sub>2</sub>,...,<italic>&#x003bb;</italic><sub><italic>n</italic></sub>}, <italic>&#x003bb;</italic><sub><italic>j </italic></sub>&#x02208; {0, 1}. &#x00398; values whose indicator is <italic>off </italic>(zero) are inactive and do not contribute to the demographic function. One such construction is demonstrated in Figure <xref ref-type="fig" rid="F1">1</xref>.</p><fig id="F1" position="float"><label>Figure 1</label><caption><p><bold>Constructing a demographic function from population values and indicators</bold>. The demographic function (solid line) is a piecewise linear function whose X axis points (time) are a subset of the set of all coalescent times, and whose Y axis values (population size) are the value of the population parameter (<italic>&#x003b8;</italic>) at this point. Time starts at zero (the present) increases as we move further into the past. The indicator parameter (<italic>&#x003bb;</italic>) determines the subset to use for the X axis. In the instance shown above only three of the six population values are used. <italic>&#x003bb;</italic><sub>4 </sub>= <italic>&#x003bb;</italic><sub>5 </sub>= 1, <italic>&#x003bb;</italic><sub>1 </sub>= <italic>&#x003bb;</italic><sub>2 </sub>= <italic>&#x003bb;</italic><sub>3 </sub>= 0.</p></caption><graphic xlink:href="1471-2148-8-289-1"/></fig><p>Let <inline-formula><mml:math id="M13" name="1471-2148-8-289-i13" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>&#x003bb;</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:semantics></mml:math></inline-formula> be the total number of active indicators and define the list of active population size parameters <inline-formula><mml:math id="M14" name="1471-2148-8-289-i14" overflow="scroll"><mml:semantics><mml:mrow><mml:mover accent="true"><mml:mi>&#x00398;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>&#x003b8;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>&#x003b8;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mn>...</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>&#x003b8;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>,</p><p><disp-formula><mml:math id="M15" name="1471-2148-8-289-i15" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>&#x003b8;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtext>if&#x000a0;</mml:mtext><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtext>if&#x000a0;</mml:mtext><mml:msub><mml:mi>&#x003bb;</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtext>and</mml:mtext></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>&#x003bb;</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>The corresponding times as defined in a similar way,</p><p><disp-formula><mml:math id="M16" name="1471-2148-8-289-i16" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtext>if&#x000a0;</mml:mtext><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtext>if&#x000a0;</mml:mtext><mml:msub><mml:mi>&#x003bb;</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtext>and</mml:mtext></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>&#x003bb;</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>Now it is possible to define the resulting piecewise linear demographic function,</p><p><disp-formula id="bmcM3"><label>(3)</label><mml:math id="M17" name="1471-2148-8-289-i17" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>&#x003b8;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>&#x003b8;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>&#x003b8;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>&#x003b8;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if&#x000a0;</mml:mtext><mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>&#x02264;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02264;</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>&#x003b8;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if&#x000a0;</mml:mtext><mml:mi>r</mml:mi><mml:mo>&#x0003e;</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>The per-locus demographic function depends on the population size factor as well, <inline-formula><mml:math id="M18" name="1471-2148-8-289-i18" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>&#x003b8;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:semantics></mml:math></inline-formula>.</p><p>The use of the ranked coalescence times in the construction of the demographic function is natural since from equation 1 each interval contains the same amount of information. Associating one parameter with each "coalescent interval" (i.e. an interval where all lineages survive terminated by a coalescent event) helps to avoid over specifying the demographic function. This approach has been used in the BSP [<xref ref-type="bibr" rid="B14">14</xref>] and more recently in the Bayesian skyride method [<xref ref-type="bibr" rid="B16">16</xref>].</p><p>The likelihood calculation requires integrating <inline-formula><mml:math id="M19" name="1471-2148-8-289-i19" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>&#x003b8;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:semantics></mml:math></inline-formula> over one or more intervals <inline-formula><mml:math id="M20" name="1471-2148-8-289-i20" overflow="scroll"><mml:semantics><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:semantics></mml:math></inline-formula>. By definition the time points <inline-formula><mml:math id="M21" name="1471-2148-8-289-i21" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02208;</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:semantics></mml:math></inline-formula> partition the interval so that the demographic function is linear on each sub interval. The integral over the interval is then obtained by summing over those sub intervals using the easily derived integral of the inverse of <italic>y</italic>(<italic>x</italic>) = <italic>ax </italic>+ <italic>b </italic>over an arbitrary interval [<italic>v</italic><sub>0</sub>, <italic>v</italic><sub>1</sub>],</p><p><disp-formula id="bmcM4"><label>(4)</label><mml:math id="M22" name="1471-2148-8-289-i22" overflow="scroll"><mml:semantics><mml:mrow><mml:mstyle displaystyle="true"><mml:mrow><mml:munderover><mml:mo>&#x0222b;</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mi>d</mml:mi><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:mrow><mml:mi>ln</mml:mi><mml:mo>&#x02061;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mrow><mml:mi>y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:mstyle><mml:mo>.</mml:mo></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>The log likelihood of each genealogy is</p><p><disp-formula id="bmcM5"><label>(5)</label><mml:math id="M23" name="1471-2148-8-289-i23" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi>&#x00398;</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x0039b;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:munderover><mml:mrow><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>i</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>&#x003b8;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:munderover><mml:mo>&#x0222b;</mml:mo><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>i</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>&#x003b8;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:mstyle><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>The prior of &#x00398; is composed from individual priors on <italic>&#x003b8;</italic><sub><italic>j</italic></sub>, where each value is drawn from an exponential distribution with a mean of <italic>&#x003d5;</italic>.</p><p><disp-formula id="bmcM6"><label>(6)</label><mml:math id="M24" name="1471-2148-8-289-i24" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>&#x00398;</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x00398;</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x003d5;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>&#x003d5;</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003d5;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>&#x003d5;</mml:mi></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>&#x003d5;</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle><mml:mo>.</mml:mo></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>The priors on all of the <italic>&#x003b8;</italic>'s contribute to the posterior, but only active ones participate in the demographic function, and therefore the coalescent likelihood in equation 5. Therefore, when inactive, <italic>&#x003b8;</italic><sub><italic>j </italic></sub>follows just the prior distribution but when active it follows the posterior (prior and coalescent).</p><p>When an appropriate prior value for the mean population size is not known in advance <italic>&#x003d5; </italic>may be estimated in a hierarchical manner. A suitable prior distribution is selected and <italic>&#x003d5; </italic>is allowed to change under that prior. One may choose the scale-free reference prior (<italic>f</italic><sub><italic>&#x003d5;</italic></sub>(<italic>&#x003d5;</italic>) = 1/<italic>&#x003d5;</italic>) as the least informative option or a so-called "diffuse" prior such as a log-normal with high variance. Note that using the reference prior may lead to very slow mixing and so it may be advisable to follow a "empirical Bayes" approach as suggested in [<xref ref-type="bibr" rid="B15">15</xref>] and obtain an estimate from the data itself. It is important to remember that since <italic>&#x003d5; </italic>is the mean of an exponential distribution the choice of prior will make little difference unless the amount of data is small. However selecting a <italic>&#x003d5; </italic>(or a prior for it) which is smaller by two orders of magnitude or more than the truth may, in our experience, cause non convergence of the chain (data not shown). Selecting higher values may slow mixing but do not appear to impact convergence. In practice fixing <italic>&#x003d5; </italic>to a large enough value works very well (simulation results not given here).</p><p>Our simulation studies used a log-normal prior with a standard deviation in log-space of 2 and the mean (in real space) was randomly selected uniformly from the interval [0.5<inline-formula><mml:math id="M25" name="1471-2148-8-289-i25" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>&#x003d5;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula>, 3.5<inline-formula><mml:math id="M26" name="1471-2148-8-289-i25" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>&#x003d5;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula>] (<inline-formula><mml:math id="M27" name="1471-2148-8-289-i25" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>&#x003d5;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula> is the mean of the true demographic function averaged over the ages of the simulated trees).</p><p>The prior on &#x0039b; is chosen as if <italic>r </italic>= &#x02211;<sub><italic>i</italic></sub><italic>&#x003bb;</italic><sub><italic>i </italic></sub>is drawn from a (truncated) Poisson distribution with a mean of <inline-formula><mml:math id="M28" name="1471-2148-8-289-i26" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>&#x003bb;</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula> = ln(2), then uniformly from all binary vectors containing exactly <italic>r </italic>ones.</p><p><disp-formula id="bmcM7"><label>(7)</label><mml:math id="M29" name="1471-2148-8-289-i27" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>&#x0039b;</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x0039b;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x0221d;</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>n</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>r</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mfrac><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mover accent="true"><mml:mi>&#x003bb;</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:mrow></mml:msup><mml:msup><mml:mover accent="true"><mml:mi>&#x003bb;</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>r</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>The choice of <inline-formula><mml:math id="M30" name="1471-2148-8-289-i26" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>&#x003bb;</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula> = ln(2) gives a 50% prior weight to a constant population size and 50% to a non-constant one. This prior is used in all simulations and analyses unless specifically noted. The prior parameter <inline-formula><mml:math id="M31" name="1471-2148-8-289-i26" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>&#x003bb;</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula> may be increased to indicated stronger prior belief in a non-constant demographic. However data with some support for changes in population size will tend to overcome the prior and a prior that focuses probability on a small number of change-points will tend to result in narrower credible intervals.</p><p>The method works for serially sampled data as well, and has been implemented in the software package BEAST [<xref ref-type="bibr" rid="B24">24</xref>] for both contemporaneous and time-stamped data. The definitions above can be easily modified to accommodate genealogies containing non-zero tip times but the notation is even more cumbersome and therefore for clarity is not given here. For an example of BEAST XML input file of 32 loci [see Additional file 1].</p></sec><sec><title>MCMC Implementation</title><p>The posterior distribution to be sampled for the EBSP is</p><p><disp-formula><mml:math id="M32" name="1471-2148-8-289-i28" overflow="scroll"><mml:semantics><mml:mrow><mml:mtable columnalign="right"><mml:mtr columnalign="right"><mml:mtd columnalign="right"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x00398;</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x0039b;</mml:mi><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x003d5;</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x003bc;</mml:mi><mml:mo>|</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>Z</mml:mi></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mo>{</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>&#x003bc;</mml:mi><mml:mo>}</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi>&#x00398;</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x0039b;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="right"><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>&#x00398;</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x00398;</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x003d5;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>&#x0039b;</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x0039b;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>&#x003bc;</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003bc;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>The term <italic>f</italic><sub><italic>D</italic></sub>{<italic>D</italic><sub><italic>k </italic></sub>| <italic>g</italic><sub><italic>k</italic></sub>, <italic>&#x003bc;</italic>} is the genealogy likelihood calculated from the data and model parameters using standard methods [<xref ref-type="bibr" rid="B25">25</xref>]. The genealogy can be sampled by any of the published methods available in BEAST [<xref ref-type="bibr" rid="B24">24</xref>].</p><p>Inactive <italic>&#x003b8;</italic>'s can be drawn directly from the prior <italic>&#x003b8;</italic><sub><italic>i </italic></sub>~ <italic>Exp</italic>(<italic>&#x003d5;</italic>). The posterior distribution for active <italic>&#x003b8;</italic>'s has no closed form and is sampled by applying generic scale-parameter proposal schemes (the scale operator) available in BEAST to each parameter of population size.</p><p>The indicators are sampled by combination of a <italic>bit-flip </italic>operator and Poisson weighting. By itself the bit-flip generates samples with a stationary probability of <inline-formula><mml:math id="M33" name="1471-2148-8-289-i29" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x0039b;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>n</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>r</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:semantics></mml:math></inline-formula> taking care of the first term in equation 7, while the Poisson weighting accounts for the second half.</p><p>The bit-flip operator uniformly picks one bit of &#x0039b; and flips it. Since the transition probability for the move and the reverse move are equal to 1/<italic>n </italic>the Hastings ratio [<xref ref-type="bibr" rid="B26">26</xref>] for changing a 1 to a 0 is</p><p><disp-formula><mml:math id="M34" name="1471-2148-8-289-i30" overflow="scroll"><mml:semantics><mml:mrow><mml:mfrac><mml:mrow><mml:mi>&#x003c0;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003bb;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>&#x003bb;</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>|</mml:mo><mml:mi>&#x003bb;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>&#x003c0;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>&#x003bb;</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003bb;</mml:mi><mml:mo>|</mml:mo><mml:msup><mml:mi>&#x003bb;</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>&#x003c0;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003bb;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>&#x003c0;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>&#x003bb;</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>n</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>r</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>n</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>r</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>r</mml:mi></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>The Poisson weighting contributes an additional factor of r/<inline-formula><mml:math id="M35" name="1471-2148-8-289-i26" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>&#x003bb;</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula>.</p><p>The ratio for changing a 0 to 1 is derived in the same way and is equal to <inline-formula><mml:math id="M36" name="1471-2148-8-289-i31" overflow="scroll"><mml:semantics><mml:mrow><mml:mfrac><mml:mrow><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:mfrac><mml:mfrac><mml:mover accent="true"><mml:mi>&#x003bb;</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mrow><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:semantics></mml:math></inline-formula>.</p></sec></sec><sec><title>Results and Discussion</title><p>To demonstrate some of the features of EBSP and the inference of demographic functions in general, this section describes the results of simulations performed using an implementation of EBSP in BEAST [<xref ref-type="bibr" rid="B24">24</xref>] (The Beast-EBSP program is available from <ext-link ext-link-type="uri" xlink:href="http://beast-mcmc.googlecode.com/">http://beast-mcmc.googlecode.com/</ext-link> and an example XML input file is available as an additional file). Simulations are invaluable during the development of a new method and in addition may provide insight into the properties of the EBSP in particular and demographic inference in general. Having said this, the simulation results we present here are aimed to serve only as examples of the various issues that need to be considered, since only a small subset of parameter combinations can be feasibly explored.</p><p>Here are the steps taken to generate a simulated data set. First pick a demographic <italic>N</italic>(<italic>t</italic>), number of loci, ploidy and number of samples for each loci. Then, for each locus, a genealogical tree <italic>T </italic>is simulated under <italic>N</italic>(<italic>t</italic>) and the coalescent process. Then a set of sequences is simulated using <italic>T </italic>and a DNA substitution model (which has its own set of parameters). The sequences are then used as the raw data for an MCMC run, and posterior samples from the run are used to estimate the population size history (and other parameters of the model if required). Note that while the simulated data contains the complete set of loci for each "individual" this is not strictly necessary. Data sets containing only a subset of loci for some individuals can be used as well.</p><sec><title>Bayesian summary for functions</title><p>Summary statistics computed from posterior samples are the standard and straightforward way to present results of an MCMC run. When dealing with functions, however, there is no direct equivalent for single value statistics such as a median or Highest/Central Posterior Density (HPD/CPD [<xref ref-type="bibr" rid="B27">27</xref>]). For example there is no obvious way to pick one population size function out of the MCMC sample which represents a "middle" or a "center" in the same way a median does for single value statistics. However such statistics are highly useful for the purpose of visualization, quantification and comparison and are easily constructed from multiple estimates at specific grid points [<xref ref-type="bibr" rid="B28">28</xref>].</p><p>A piecewise linear function connecting the median population size estimated at specific time points is a natural choice for the median when posterior samples are piecewise linear functions. Since the demographic has a natural resolution limit <italic>n</italic>, the total number of coalescence events, we propose that the construction of the median demographic also use <italic>n </italic>points which are estimated by the mean times of the ordered coalescent events over all posterior trees. This is different from the approach currently taken by Tracer [<xref ref-type="bibr" rid="B29">29</xref>] which uses a fixed (say 100) evenly spaced points. This inappropriately ignores the natural spacing of coalescent events and lumps together information from several intervals at the beginning while half the points at past times are essentially based on the age of a single coalescent interval. It is of course possible to refine the time axis further by introducing more points between mean coalescent event but this adds only a small amount of information and we prefer to keep a visual clue about of the amount of data the estimate is based upon. It should be noted that these choices are relevant only for summarizing the posterior distribution. Specific hypothesis tests related to population size history should always be constructed directly from the posterior samples and not from any summary statistic.</p><p>The same procedure is used to build the mean, Central or Highest Posterior Density functions through time. Figure <xref ref-type="fig" rid="F2">2</xref> shows two snapshots from an interactive exploration of one recovered population size history. The figures depict a nested set of credible intervals. We shall denote the <italic>p</italic>-percentile of the posterior density of <italic>N</italic>(<italic>t</italic>) at time <italic>t </italic>as <italic>N'</italic><sub><italic>p</italic></sub>(<italic>t</italic>).</p><fig id="F2" position="float"><label>Figure 2</label><caption><p><bold>Posterior distribution of the recovered demographic function</bold>. The recovered demographic from a Bayesian analysis can be presented using gray-scale shading to represent CPD levels (quantiles). The dotted line shows the median. The solid line represents the "truth", i.e. the demographic function used to generate the simulated data.</p></caption><graphic xlink:href="1471-2148-8-289-2"/></fig><p>By comparing the median demographic <inline-formula><mml:math id="M37" name="1471-2148-8-289-i32" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:semantics></mml:math></inline-formula> to the true demographic <italic>N</italic>(<italic>t</italic>) using a function norm, from <italic>t </italic>= 0 to the median root height, <italic>t </italic>= <italic>&#x003c4;</italic>, we can define a relative recovery error:</p><p><inline-formula><mml:math id="M38" name="1471-2148-8-289-i33" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:msub><mml:mo>|</mml:mo><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mstyle displaystyle="true"><mml:mrow><mml:munderover><mml:mo>&#x0222b;</mml:mo><mml:mn>0</mml:mn><mml:mi>&#x003c4;</mml:mi></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:msqrt><mml:mo>.</mml:mo></mml:mrow></mml:semantics></mml:math></inline-formula></p><p>Note that while the word <italic>error </italic>above is used to describe the average distance between an estimate and the truth, this quantity contains a bias component which is to be expected of a Bayesian estimate of a scale parameter.</p><p>The size of the relative 95% credible interval is defined in a similar way:</p><p><disp-formula><mml:math id="M39" name="1471-2148-8-289-i34" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>z</mml:mi><mml:mi>e</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mn>97.5</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02212;</mml:mo><mml:msub><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mn>2.5</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>|</mml:mo><mml:msub><mml:mo>|</mml:mo><mml:mn>2</mml:mn></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>Another useful statistic is the frequentist coverage of the estimator, which measures the percentage of time the true value of the demographic was inside the 95% credible interval:</p><p><disp-formula><mml:math id="M40" name="1471-2148-8-289-i35" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>&#x003c4;</mml:mi></mml:mfrac><mml:mstyle displaystyle="true"><mml:mrow><mml:munderover><mml:mo>&#x0222b;</mml:mo><mml:mn>0</mml:mn><mml:mi>&#x003c4;</mml:mi></mml:munderover><mml:mrow><mml:mi>I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mn>2.5</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02264;</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02264;</mml:mo><mml:msub><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mn>97.5</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:mstyle><mml:mo>,</mml:mo></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>where <italic>I </italic>is the indicator function.</p></sec><sec><title>Estimation when population size is constant</title><p>The first set of simulations was set up to reflect a typical data set with current technology. We simulated three nuclear markers and one mtDNA gene from 12 individuals sampled from a constant-sized population of 50,000. Twenty-four recombination free sequences of length 1600 were generated for each nuclear marker but only 12 for the mtDNA, mimicking a situation where both alleles are sequenced from each nuclear locus. We used the HKY85 [<xref ref-type="bibr" rid="B30">30</xref>] substitution model to describe mutation within each locus with <italic>&#x003ba; </italic>= 2.5 for the nuclear loci and <italic>&#x003ba; </italic>= 15 for the mtDNA. The mtDNA locus substitution rate was set to 10<sup>-7</sup>, 20 times faster than that of the nuclear (5 &#x000d7; 10<sup>-9</sup>), producing a mtDNA tree with an average height of approximately 0.01 substitutions (2 &#x000d7; 5 &#x000d7; 10<sup>4 </sup>&#x000d7; 10<sup>-7</sup>). Note that although the MCMC runs try to mimic real life usage and estimate all unknown parameters (<italic>&#x003ba;</italic>, mtDNA <italic>&#x003bc; </italic>etc), only results for the demographic function are given below.</p><p>In this first set of simulations 100 independent data sets were generated and each was analyzed in three different ways: (a) with the EBSP, (b) under the assumption of a constant size coalescent model, and (c) under the assumption of a constant population size with the genealogy (i.e. coalescent times) fixed to the simulated values. This allows us to measure the relative contributions to the overall uncertainty in the demographic function estimate that arise from (i) model averaging, (ii) uncertainty in coalescent times and (iii) the intrinsic stochastic nature of the coalescent process. This approach is quite useful and is used again later. The results are summarized in Table <xref ref-type="table" rid="T1">1</xref>.</p><table-wrap id="T1" position="float"><label>Table 1</label><caption><p>Constant population size, N = 50,000</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">model</th><th align="left">% inside 95 HPD</th><th align="left">median relative error</th><th align="left">median relative bias</th><th align="left">HPD relative bounds</th></tr></thead><tbody><tr><td align="left">EBSP</td><td align="left">97.65%</td><td align="left">0.22</td><td align="left">0.053</td><td align="left">1.23</td></tr><tr><td colspan="5"><hr/></td></tr><tr><td align="left">constant population size</td><td align="left">96%</td><td align="left">0.17</td><td align="left">0.009</td><td align="left">0.9</td></tr><tr><td colspan="5"><hr/></td></tr><tr><td align="left">constant population size, fixed trees</td><td align="left">96%</td><td align="left">0.086</td><td align="left">0.006</td><td align="left">0.44</td></tr></tbody></table></table-wrap><p>This initial set of simulations demonstrates that even with four loci the credible interval has the same order of magnitude as the population size itself. Furthermore, the uncertainty that arises from estimating the coalescent times from the genetic data (about 40%) is comparable to the uncertainty arising from estimating the population size from the coalescent times. The remaining 20% is due to using the EBSP when the demographic function was in fact constant (this can be considered to be the price of model averaging).</p><p>Using longer sequences improves the estimates of coalescent times, and thus reduces that component of the uncertainty. This is demonstrated by a second set of simulations which use the same model parameters but with sequences of length 16000 bp. The results are shown in Table <xref ref-type="table" rid="T2">2</xref>.</p><table-wrap id="T2" position="float"><label>Table 2</label><caption><p>Constant population size, 10&#x000d7; more sites</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">model</th><th align="left">% inside 95 HPD</th><th align="left">median relative error</th><th align="left">median relative bias</th><th align="left">HPD relative bounds</th></tr></thead><tbody><tr><td align="left">EBSP (16000 bp)</td><td align="left">96.84%</td><td align="left">0.13</td><td align="left">0.034</td><td align="left">0.77</td></tr></tbody></table></table-wrap><p>Longer branch lengths, either through increased mutation rate or increased population size would also lead to less uncertainty in the estimates, so that short sequences would be sufficient provided the product of population size and mutation rate is much larger than in our first simulations. This is demonstrated by the results from 100 MCMC runs in which the population is ten times larger in size (Table <xref ref-type="table" rid="T3">3</xref>).</p><table-wrap id="T3" position="float"><label>Table 3</label><caption><p>Constant population size, 10&#x000d7; population size (N = 500,000)</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">model</th><th align="left">% inside 95 HPD</th><th align="left">median relative error</th><th align="left">median relative bias</th><th align="left">HPD relative bounds</th></tr></thead><tbody><tr><td align="left">EBSP</td><td align="left">98.94%</td><td align="left">0.12</td><td align="left">-0.008</td><td align="left">0.71</td></tr><tr><td colspan="5"><hr/></td></tr><tr><td align="left">constant population size</td><td align="left">99%</td><td align="left">0.1</td><td align="left">-0.024</td><td align="left">0.54</td></tr><tr><td colspan="5"><hr/></td></tr><tr><td align="left">constant population size, fixed trees</td><td align="left">99%</td><td align="left">0.079</td><td align="left">-0.005</td><td align="left">0.44</td></tr></tbody></table></table-wrap><p>The second and third sets of simulations show how longer sequences or a larger population effectively narrow the credible intervals by allowing better estimation of coalescent times. When studying smaller populations it is advisable to use longer sequences in order to ensure accurate estimates of the branch lengths. However we note that this is not necessarily possible with nuclear loci that experience large amounts of recombination.</p></sec><sec><title>Number of loci vs. error</title><p>While increasing sequence length improves the estimation of coalescent times, only additional loci can reduce the variability in estimating the population size function from those coalescent times. The next set of runs show the effect of increasing the number of loci. A single locus was simulated for 5 individuals, then a second one was added to make two, then two more to make four, doubling up to 32. For this analysis the simulated coalescent times were used directly, so that we could focus exclusively on the contribution of the variability in the coalescent process to the 95% HPD interval. The results of 100 such runs are shown in Figure <xref ref-type="fig" rid="F3">3</xref>.</p><fig id="F3" position="float"><label>Figure 3</label><caption><p><bold>Error in demographic recovery as a function of number of loci</bold>. The error (on log-log scale) reduces linearly as the number of loci increases (solid line). Using 4 times the number of loci halves the error. Likewise, the 95% HPD interval also reduces linearly on a log-log scale with increasing loci (dashed line), and also appears to reduce by a factor of 2 with a quadrupling of the number of loci.</p></caption><graphic xlink:href="1471-2148-8-289-3"/></fig><p>Empirically, both the error and 95% credible interval are reduced by a factor of <inline-formula><mml:math id="M41" name="1471-2148-8-289-i36" overflow="scroll"><mml:semantics><mml:mrow><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mrow></mml:semantics></mml:math></inline-formula> when doubling the number of loci. This suggests that the relation between median error/HPD interval size and the number of coalescent points (<italic>sample size</italic>) follows the pattern of simpler cases where doubling the sample size reduces the variance by half. A rigorous proof requires an analytical solution for the median and HPD and is a non trivial task beyond the scope of this paper.</p></sec><sec><title>Number of samples vs. error</title><p>Increasing the number of sampled individuals per locus also improves the estimates but the effect is much more modest. Figure <xref ref-type="fig" rid="F4">4</xref> shows the results of multiple runs with 16 loci but using 3 to 20 individuals. For each case 100 simulations were made with both a constant and a non-constant demographic function. The non-constant population size function linearly decreases from <italic>N </italic>to <italic>N</italic>/4 back in time on the interval [0, 0,375<italic>N</italic>] generations, and is constant at <italic>N</italic>/4 at earlier times. Again the raw data were the coalescent times rather than sequence data.</p><fig id="F4" position="float"><label>Figure 4</label><caption><p><bold>Error in demographic recovery as a function of number of samples</bold>. Error and credible intervals are shown as a function of the number of sampled individuals per loci for 16 independent loci. Both the error (solid line) and the HPD interval (dashed line) reduce with increasing number of sequences but both converge to a positive limit, that can only be improved on by sampling more loci. A best fitting line of the form <inline-formula><mml:math id="M42" name="1471-2148-8-289-i37" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:semantics></mml:math></inline-formula> is shown and serves only to highlight the general trend.</p></caption><graphic xlink:href="1471-2148-8-289-4"/></fig><p>The exact form of the errors is unclear but it does seem to fit an inverse relation with a positive limit. The lower bound depends on the nature of the demographic and on the number of loci as well. Unsurprisingly the bounds and error for the constant demographic are smaller than those for the non-constant case, but the total amount of reduction is approximately the same beyond 8 samples. For example using 16 samples instead of 8 gains an additional reduction of the HPD bounds by 16% and 14% respectively.</p></sec><sec><title>Detecting evolutionary bottlenecks</title><p>Evolutionary bottlenecks present a tough challenge for reconstruction of population size history. Periods of low population size increase the rate of coalescence and limits the number lineages that survive the bottleneck, therefore severely reducing the ability to detect changes in population size prior to the bottleneck time. Interest in the effect of evolutionary bottlenecks on genetics predates the coalescent. For example Nei and colleagues investigated the effect of a population bottleneck on the expected heterozygosity for a neutral locus [<xref ref-type="bibr" rid="B31">31</xref>]. A more recent study [<xref ref-type="bibr" rid="B32">32</xref>] demonstrates the difficulties in analyzing population structure from contemporary sequences using several methods.</p><p>Given enough data the EBSP can detect past population bottlenecks. Figure <xref ref-type="fig" rid="F5">5</xref> shows the result of running one locus from 480 individuals compared with 32 loci from 16 individuals for an identical demographic containing two bottlenecks in quick succession.</p><fig id="F5" position="float"><label>Figure 5</label><caption><p><bold>Multi-locus recovery of a demographic function with evolutionary bottlenecks</bold>. Using multi-locus data enables the detection and accurate recovery of population bottlenecks. The true demographic function is shown as solid line, while the dotted line indicates the posterior median.</p></caption><graphic xlink:href="1471-2148-8-289-5"/></fig><p>While there is an equal number of coalescent events in both cases, only the analysis of multiple loci is able to "see" past the first bottleneck and even past the second. It is important to stress that this is a carefully constructed example. Lowering the population size at the bottlenecks or changing the difference between the maximum and minimum population sizes will alter the number of loci required for a successful recovery.</p></sec><sec><title>Testing for a non constant demographic function</title><p>The EBSP lets the data itself select the correct dimensionality of the demographic function and so allows statistical inferences regarding the number of change points in the population size function <italic>N</italic>(<italic>t</italic>). This example examines the relation between the amount of data and the frequentist coverage for the most simple case involving a single change from a constant population size to linear growth. Going back in time, the target demographic is linearly decreasing from <italic>N </italic>to <italic>N</italic>/4 on [0, 3/8<italic>N</italic>] generations, and remains constant at earlier times. A hundred data sets were simulated for different numbers of loci between 2 and 32, each sampled from 8 individuals. For each data set the posterior estimate and credible set of the number of control points in the demographic function was recorded. The true demographic function had one change in population size at 3/8<italic>N </italic>time ago. Therefore, runs in which the HPD of the number of change points excluded 0 but contained 1 were recorded as a success since they rejected the null hypothesis of a constant population size. Runs in which the HPD contained 0 were counted as a miss. No run failed to include 1 change in the credible interval. The mean success rate as a function of numbers of loci is shown in Figure <xref ref-type="fig" rid="F6">6</xref>. With 16 loci the success rate was greater than 95%, while it is quite low at around 20% for 4 loci. It seems to follows a logistic-like shape, but the small number of points does not allow us to elucidate the relationship more precisely.</p><fig id="F6" position="float"><label>Figure 6</label><caption><p><bold>Testing statistically for the presence of demographic changes</bold>. The success rate of rejecting a constant demographic as a function of number of loci.</p></caption><graphic xlink:href="1471-2148-8-289-6"/></fig></sec><sec><title>Effect of DNA sequencing errors</title><p>DNA sequencing typically involves several stages and each may introduce errors, from replication during PCR [<xref ref-type="bibr" rid="B33">33</xref>] to incorrect base calling [<xref ref-type="bibr" rid="B34">34</xref>]. Realistically modeling the effects of such errors on sequence data is difficult, but even a simplistic approach may prove instructive in describing their impact on demographic inference. This example reuses the setting and sequence data of the first example in which the population size was constant, but randomly changing bases at some fixed rate. This degraded data is then reanalyzed in the same way as the first experiment. Table <xref ref-type="table" rid="T4">4</xref> shows the results of two runs at 0.01% and 0.1% error rates.</p><table-wrap id="T4" position="float"><label>Table 4</label><caption><p>The effect of DNA sequencing errors</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th align="left">% inside 95</th><th align="left">median relativeeerror</th><th align="left">median relative bias</th><th align="left">HPD relative bounds</th></tr></thead><tbody><tr><td align="left">Original data, no errors HPD</td><td align="left">97.65%</td><td align="left">0.22</td><td align="left">0.053</td><td align="left">1.23</td></tr><tr><td colspan="5"><hr/></td></tr><tr><td align="left">0.01% sequencing error</td><td align="left">96.05%</td><td align="left">0.53</td><td align="left">0.29</td><td align="left">1.95</td></tr><tr><td colspan="5"><hr/></td></tr><tr><td align="left">0.1% sequencing error</td><td align="left">73.97%</td><td align="left">29.54</td><td align="left">12.22</td><td align="left">65.28</td></tr></tbody></table></table-wrap><p>For this particular setting an error rate of 0.1% has a catastrophic effect. Even a rate of 0.01% was enough to double the size of the credible intervals. It is clear that data quality is an important prerequisite for a successful population genetic analysis.</p></sec><sec><title>Hepatitis C Virus in Egypt</title><p>The epidemic history of Hepatitis C virus in Egypt has been previously analyzed using both the BSP [<xref ref-type="bibr" rid="B14">14</xref>] and parametric Bayesian coalescent analysis [<xref ref-type="bibr" rid="B35">35</xref>]. We take another look at the data to examine the two non-parametric methods side by side and investigate the effects of prior and model choice.</p><p>The single locus data consists of an alignment of 63 partial gene sequences of length 411 bp [<xref ref-type="bibr" rid="B36">36</xref>]. The results of two MCMC runs, the first using piecewise-constant BSP with <italic>m </italic>= 24 and the second using the piecewise-linear EBSP (<inline-formula><mml:math id="M43" name="1471-2148-8-289-i26" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>&#x003bb;</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula> = ln(2)) are shown in Figure <xref ref-type="fig" rid="F7">7</xref>.</p><fig id="F7" position="float"><label>Figure 7</label><caption><p><bold>Hepatitis C virus data: comparison of BSP and EBSP</bold>. Comparison of a EBSP (blue) and BSP (gray) analysis of the Hepatitis C virus data. On the left side the Y axis is in log scale, and linear on the right. Both methods agree on the trend but differ due to model and prior choices. Credible intervals from the EBSP are smaller.</p></caption><graphic xlink:href="1471-2148-8-289-7"/></fig><p>Drummond <italic>et al </italic>[<xref ref-type="bibr" rid="B14">14</xref>] note that the sequences "contain ample phylogenetic information". Our simulation studies suggest that while 63 samples seem sufficient, a single loci can only detect general trends and not finer details. In this case both methods agree on a sharp decline (going back in time) at around 50&#x02013;60 years ago. However the BSP favours a constant demographic until that time, while the EBSP favours steady decline and constant demographic from 60 years ago backwards. We suggest this difference is an effect of model and prior choice and we present one run (out of several) which supports this view.</p><p>Figure <xref ref-type="fig" rid="F8">8</xref> shows the result of running the EBSP using the piecewise constant model and an expected prior average number of change points of 6. It is evident that making the priors more similar reduce the difference in the final estimates. The advantage of using the EBSP for a single loci is that it gives a Bayesian estimate of the number of changes actually present in the data. In this case the credible set was {1, 2} which strongly supports a non constant demographic, but a mean of 1.35 suggests that choosing <italic>m </italic>= 24 for the BSP is too high.</p><fig id="F8" position="float"><label>Figure 8</label><caption><p><bold>Hepatitis C: EBSP stepwise model and <italic>E</italic>(<inline-formula><mml:math id="M44" name="1471-2148-8-289-i26" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>&#x003bb;</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula>) = 6</bold>. Matching more closely the model and prior between the EBSP and BSP brings the results much closer. Note the negative effect of the prior choice <italic>E</italic>(<inline-formula><mml:math id="M45" name="1471-2148-8-289-i26" overflow="scroll"><mml:semantics><mml:mover accent="true"><mml:mi>&#x003bb;</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:semantics></mml:math></inline-formula>) = 6 on the size of credible bounds.</p></caption><graphic xlink:href="1471-2148-8-289-8"/></fig></sec><sec><title>The population size history of Drosophila ananassae</title><p>Aparup <italic>et al </italic>[<xref ref-type="bibr" rid="B37">37</xref>] investigated the demography and population structure of <italic>Drosophila ananassae</italic>. The authors collected samples from 160 individuals over 16 geographic locations and sequenced 10 fragments whose length ranges from 371 to 487, giving a total of 650 kb.</p><p>The result of an EBSP analysis for each of the 16 locations is shown in Figure <xref ref-type="fig" rid="F9">9</xref>. While the sequence length per loci is relatively short and there are just 529 SNPs in the data-set, our simulation studies suggest the combined power of 10 loci is likely to provide a good overview of the trends in population size changes through time.</p><fig id="F9" position="float"><label>Figure 9</label><caption><p><bold>16 EBSP runs on Drosophila ananassae</bold>. The estimated demographic history for each of the 16 locations. The abbreviated names of the sampling locations are given above each plot. An asterisk (*) is appended to locations whose demographics are non-constant according to the EBSP with 95% posterior probability. Locations with some support (i.e. where the Bayes factor <inline-formula><mml:math id="M46" name="1471-2148-8-289-i38" overflow="scroll"><mml:semantics><mml:mrow><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:mi>r</mml:mi><mml:mo>&#x02260;</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:semantics></mml:math></inline-formula> is greater than 3) are also indicated (PUR and KL).</p></caption><graphic xlink:href="1471-2148-8-289-9"/></fig><p>Our simulation study has already demonstrated how posterior probabilities of <italic>r </italic>(the number of change points) can be used to infer demographic change. Aparup <italic>et al </italic>found support for population expansion in 4 of the central populations &#x02013; BKK, BOG, KL, and MNL (Location names are abbreviated as in the original article). Our analysis finds strong evidence for population expansion in 5 of the 16 populations (BKK, BOG, CH, KK and MNL). In each of the five populations the posterior probability of a non-constant population was greater than 95%, i.e. <italic>Pr</italic>(<italic>r </italic>&#x0003e; 0) &#x0003e; 95%.</p><p>As a more lenient alternative one may use the Bayes factor <inline-formula><mml:math id="M47" name="1471-2148-8-289-i39" overflow="scroll"><mml:semantics><mml:mrow><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>D</mml:mi></mml:mstyle><mml:mo>|</mml:mo><mml:mi>r</mml:mi><mml:mo>&#x02260;</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>D</mml:mi></mml:mstyle><mml:mo>|</mml:mo><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:semantics></mml:math></inline-formula> to test for the presence of change [<xref ref-type="bibr" rid="B38">38</xref>]. The populations of KL and PUR with Bayes factors of 5.2 and 4.4 respectively show "substantial" support according to the suggested interpretation of Kass and Raftery, but whether those values are large enough is a matter of personal preference.</p><p>The expansion in the Indian CH and PUR populations started more recently than the expansion in the central areas. The Puri (PUR) population seem to experience a trend which is somewhere in between that of Chennai (CH) to its South-west which shows clear expansion and Bhubaneswar (BBS) to its North-east having no expansion.</p><p>The power of multiple loci in improving estimates has already been discussed so we would like to offer here a different visual view of the same effect. We choose the Puri (PUR) area which had the smallest support for population expansion. Figure <xref ref-type="fig" rid="F10">10</xref> details the results of running an EBSP analysis for each of the 10 fragments individually and the combined analysis. It is evident a human would find it quite hard to draw conclusions based on the 10 separate runs. The figure also seems to support our conjectured reduction of uncertainty by a factor of about 3 (i.e. about <inline-formula><mml:math id="M48" name="1471-2148-8-289-i40" overflow="scroll"><mml:semantics><mml:mrow><mml:msqrt><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msqrt></mml:mrow></mml:semantics></mml:math></inline-formula>).</p><fig id="F10" position="float"><label>Figure 10</label><caption><p><bold>A detailed look at the Puri Drosophila ananassae population size history</bold>. A detailed view of the Puri (PUR) demographic analyses. The median reconstruction for each of the 10 individual loci is shown, along with the union of the 95% HPD areas in light gray. The thick blue line shows the median for the combined analysis and the 95% HPD is given in darker gray.</p></caption><graphic xlink:href="1471-2148-8-289-10"/></fig></sec><sec><title>Performance and Mixing</title><p>We would like to briefly comment on the EBSP performance for the two real data sets presented above. The single locus Hepatitis C data was analyzed using both the EBSP and the BSP. In both cases the chain length was set to 100 m and sampled every 2000 states, leaving 49500 samples after removing 10% burn-in. The EBSP run took 2.6 hours on a Quad core Intel Xeon CPU at 2.66 GHz and the BSP took 3.6 hours. The effective sample size (ESS) for the posterior was 5200 for the EBSP and 630 for the BSP, giving a rate of approximately 2 seconds per EBSP effective sample and 20 seconds for the BSP. A closer look reveals that the component responsible for the slower mixing is the genealogy likelihood, i.e. likelihood of sequence data given the tree (<italic>f</italic><sub><italic>D </italic></sub>{<italic>D</italic><sub><italic>k </italic></sub>| <italic>g</italic><sub><italic>k</italic></sub>, <italic>&#x003bc;</italic>}). Since the coalescent acts as a prior for the tree it seems that the EBSP is allowing a faster mixing of the coalescent times in the tree by providing a demographic history <italic>N</italic>(<italic>t</italic>) with less variability.</p><p>For the <italic>Drosophila ananassae </italic>data set one MCMC chain was produced for each of the 16 locations. Each chain was run 2.75 &#x000d7; 10<sup>7 </sup>steps and sampled every 5000 steps, leaving 5000 samples after removing 10% burn-in. The ESS for the posterior ranged between 220 and 2957, with a mean of 1154. This wide range may be due to variations between populations in the amount of concordance in estimated population size history among loci. Populations which exhibit conflicting demographic signals among loci are expected to mix slower. However this conjecture is based only on visual inspection of results from the analysis of individuals genes. It is also possible that some improvement might come from allowing variation in mutation rate among loci.</p></sec></sec><sec sec-type="conclusions"><title>Conclusion</title><p>Multi-locus approaches are becoming more attractive with decreasing DNA sequencing costs and increasing computational power. Felsenstein has recently investigated the ideal combination of samples, sites and loci for a fixed cost under maximum likelihood settings [<xref ref-type="bibr" rid="B39">39</xref>]. He found that increasing the number of loci is the most cost effective way of improving accuracy, as well as determining that a small number of samples (around 8) is sufficient. Carling and colleagues find that 25 loci from 10 samples is sufficient to accurately estimate constant population size, again under MLE [<xref ref-type="bibr" rid="B40">40</xref>].</p><p>The EBSP provides a tool to investigate populations that change size through time, by directly inferring the population size as a function of time using sequence data from multiple loci. The EBSP estimates the dimensionality of the population size function automatically from the data, avoiding model over-specification and its associated noise. The Bayesian nature of the EBSP provide an explicit measure of modeling uncertainty. Since we need less individuals when using multiple loci, computational performance is typically not an issue. Running an EBSP for 10 loci and 10 individuals is approximately the same computational effort as running 1 locus for 90 individuals. Mixing, however, is always an issue with MCMC and is data dependent. The EBSP may take longer to mix when there is very little information in the data or there is some conflicting signal among the loci analyzed.</p><p>The power of the multi-locus approach in providing better estimates of population size under the stochastic coalescence process is clearly demonstrated by simulation results. However, the results show that taking care of other factors is important too: quality of sequence data, sufficient number of sites and enough samples all help to provide better estimation of coalescent times. Those improvements are reflected directly in the bias and credible intervals of the demographic function estimation.</p><p>The results emphasize the importance of support measures when inferring population size history. The inherent uncertainty in population size inference is still substantial even for the large data-sets being collected nowadays. Therefore, it is important to always provide credible intervals with any estimate of population size. From our investigations it appears that high-quality data sets of 16 unlinked loci or more should be used to accurately infer population size history. A relatively small number of individuals is sufficient, but more individuals still provide tangible benefits for data sets using less loci. We are currently working on an extension of this work to the estimation of a species tree from multiple gene trees.</p></sec><sec><title>Authors' contributions</title><p>AJD conceived the idea and supervised the development of the method and software. JH wrote the software code, performed all the simulations and data analysis. Both authors contributed to the writing of the article.</p></sec></body><back><sec><title>Acknowledgements</title><p>The authors would like to thank David Bryant for discussion and acknowledge the financial support of Marsden grant #UOA0502.</p></sec><ref-list><ref id="B1"><mixed-citation publication-type="journal"><name><surname>Fu</surname><given-names>YX</given-names></name><name><surname>Li</surname><given-names>WH</given-names></name><article-title>Coalescing into the 21st Century: An Overview and Prospects of Coalescent Theory</article-title><source>Theoretical Population Biology</source><year>1999</year><volume>56</volume><fpage>1</fpage><lpage>10</lpage><pub-id pub-id-type="doi">10.1006/tpbi.1999.1421</pub-id><pub-id pub-id-type="pmid">10438665</pub-id></mixed-citation></ref><ref id="B2"><mixed-citation publication-type="journal"><name><surname>Serre</surname><given-names>D</given-names></name><name><surname>Langaney</surname><given-names>A</given-names></name><name><surname>Chech</surname><given-names>M</given-names></name><name><surname>Teschler-Nicola</surname><given-names>M</given-names></name><name><surname>Paunovic</surname><given-names>M</given-names></name><name><surname>Mennecier</surname><given-names>P</given-names></name><name><surname>Hofreiter</surname><given-names>M</given-names></name><name><surname>Possnert</surname><given-names>G</given-names></name><name><surname>Paabo</surname><given-names>S</given-names></name><article-title>No evidence of Neandertal mtDNA contribution to early modern humans</article-title><source>PLoS Biol</source><year>2004</year><volume>2</volume><issue>3</issue><fpage>E57</fpage><pub-id pub-id-type="doi">10.1371/journal.pbio.0020057</pub-id><pub-id pub-id-type="pmid">15024415</pub-id></mixed-citation></ref><ref id="B3"><mixed-citation publication-type="journal"><name><surname>Akey</surname><given-names>JM</given-names></name><name><surname>Eberle</surname><given-names>MA</given-names></name><name><surname>Rieder</surname><given-names>MJ</given-names></name><name><surname>Carlson</surname><given-names>CS</given-names></name><name><surname>Shriver</surname><given-names>MD</given-names></name><name><surname>Nickerson</surname><given-names>DA</given-names></name><name><surname>Kruglyak</surname><given-names>L</given-names></name><article-title>Population history and natural selection shape patterns of genetic variation in 132 genes</article-title><source>PLoS Biol</source><year>2004</year><volume>2</volume><issue>10</issue><fpage>e286</fpage><pub-id pub-id-type="doi">10.1371/journal.pbio.0020286</pub-id><pub-id pub-id-type="pmid">15361935</pub-id></mixed-citation></ref><ref id="B4"><mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Rannala</surname><given-names>B</given-names></name><article-title>In silico analysis of disease-association mapping strategies using the coalescent process and incorporating ascertainment and selection</article-title><source>Am J Hum Genet</source><year>2005</year><volume>76</volume><issue>6</issue><fpage>1066</fpage><lpage>1073</lpage><pub-id pub-id-type="doi">10.1086/430472</pub-id><pub-id pub-id-type="pmid">15818531</pub-id></mixed-citation></ref><ref id="B5"><mixed-citation publication-type="journal"><name><surname>Kingman</surname><given-names>JFC</given-names></name><article-title>The coalescent</article-title><source>Stoch Proc Appl</source><year>1982</year><volume>13</volume><fpage>235</fpage><lpage>248</lpage><pub-id pub-id-type="doi">10.1016/0304-4149(82)90011-4</pub-id></mixed-citation></ref><ref id="B6"><mixed-citation publication-type="journal"><name><surname>Kingman</surname><given-names>JFC</given-names></name><article-title>Origins of the Coalescent: 1974&#x02013;1982</article-title><source>Genetics</source><year>2000</year><volume>156</volume><issue>4</issue><fpage>1461</fpage><lpage>1463</lpage><pub-id pub-id-type="pmid">11102348</pub-id></mixed-citation></ref><ref id="B7"><mixed-citation publication-type="book"><name><surname>Dawkins</surname><given-names>R</given-names></name><source>The ancestor's tale</source><year>2004</year><publisher-name>Phoenix</publisher-name></mixed-citation></ref><ref id="B8"><mixed-citation publication-type="journal"><name><surname>Blythe</surname><given-names>RA</given-names></name><name><surname>McKane</surname><given-names>AJ</given-names></name><article-title>Stochastic models of evolution in genetics, ecology and linguistics</article-title><source>Journal of Statistical Mechanics: Theory and Experiment</source><year>2007</year><volume>2007</volume><issue>07</issue><fpage>P07018</fpage><pub-id pub-id-type="doi">10.1088/1742-5468/2007/07/P07018</pub-id></mixed-citation></ref><ref id="B9"><mixed-citation publication-type="journal"><name><surname>Griffiths</surname><given-names>RC</given-names></name><name><surname>Tavare</surname><given-names>S</given-names></name><article-title>Sampling Theory for Neutral Alleles in a Varying Environment</article-title><source>Royal Society of London Philosophical Transactions Series B</source><year>1994</year><volume>344</volume><fpage>403</fpage><lpage>410</lpage><pub-id pub-id-type="doi">10.1098/rstb.1994.0079</pub-id></mixed-citation></ref><ref id="B10"><mixed-citation publication-type="journal"><name><surname>Tavare</surname><given-names>S</given-names></name><name><surname>Balding</surname><given-names>DJ</given-names></name><name><surname>Griffiths</surname><given-names>RC</given-names></name><name><surname>Donnelly</surname><given-names>P</given-names></name><article-title>Inferring Coalescence Times From DNA Sequence Data</article-title><source>Genetics</source><year>1997</year><volume>145</volume><issue>2</issue><fpage>505</fpage><lpage>518</lpage><pub-id pub-id-type="pmid">9071603</pub-id></mixed-citation></ref><ref id="B11"><mixed-citation publication-type="journal"><name><surname>Wilson</surname><given-names>IJ</given-names></name><name><surname>Balding</surname><given-names>DJ</given-names></name><article-title>Genealogical Inference From Microsatellite Data</article-title><source>Genetics</source><year>1998</year><volume>150</volume><fpage>499</fpage><lpage>510</lpage><pub-id pub-id-type="pmid">9725864</pub-id></mixed-citation></ref><ref id="B12"><mixed-citation publication-type="journal"><name><surname>Beaumont</surname><given-names>MA</given-names></name><article-title>Detecting Population Expansion and Decline Using Microsatellites</article-title><source>Genetics</source><year>1999</year><volume>153</volume><issue>4</issue><fpage>2013</fpage><lpage>2029</lpage><pub-id pub-id-type="pmid">10581303</pub-id></mixed-citation></ref><ref id="B13"><mixed-citation publication-type="journal"><name><surname>Pybus</surname><given-names>OG</given-names></name><name><surname>Rambaut</surname><given-names>A</given-names></name><name><surname>Harvey</surname><given-names>PH</given-names></name><article-title>An Integrated Framework for the Inference of Viral Population History From Reconstructed Genealogies</article-title><source>Genetics</source><year>2000</year><volume>155</volume><issue>3</issue><fpage>1429</fpage><lpage>1437</lpage><pub-id pub-id-type="pmid">10880500</pub-id></mixed-citation></ref><ref id="B14"><mixed-citation publication-type="journal"><name><surname>Drummond</surname><given-names>AJ</given-names></name><name><surname>Rambaut</surname><given-names>A</given-names></name><name><surname>Shapiro</surname><given-names>B</given-names></name><name><surname>Pybus</surname><given-names>OG</given-names></name><article-title>Bayesian Coalescent Inference of Past Population Dynamics from Molecular Sequences</article-title><source>Mol Biol Evol</source><year>2005</year><volume>22</volume><issue>5</issue><fpage>1185</fpage><lpage>1192</lpage><pub-id pub-id-type="doi">10.1093/molbev/msi103</pub-id><pub-id pub-id-type="pmid">15703244</pub-id></mixed-citation></ref><ref id="B15"><mixed-citation publication-type="journal"><name><surname>Opgen-Rhein</surname><given-names>R</given-names></name><name><surname>Fahrmeir</surname><given-names>L</given-names></name><name><surname>Strimmer</surname><given-names>K</given-names></name><article-title>Inference of demographic history from genealogical trees using reversible jump Markov chain Monte Carlo</article-title><source>BMC Evolutionary Biology</source><year>2005</year><volume>5</volume><fpage>6</fpage><pub-id pub-id-type="doi">10.1186/1471-2148-5-6</pub-id><pub-id pub-id-type="pmid">15663782</pub-id></mixed-citation></ref><ref id="B16"><mixed-citation publication-type="journal"><name><surname>Minin</surname><given-names>VN</given-names></name><name><surname>Bloomquist</surname><given-names>EW</given-names></name><name><surname>Suchard</surname><given-names>MA</given-names></name><article-title>Smooth skyride through a rough skyline: Bayesian coalescent-based inference of population dynamics</article-title><source>Mol Biol Evol</source><year>2008</year><volume>25</volume><issue>7</issue><fpage>1459</fpage><lpage>1471</lpage><pub-id pub-id-type="doi">10.1093/molbev/msn090</pub-id><pub-id pub-id-type="pmid">18408232</pub-id></mixed-citation></ref><ref id="B17"><mixed-citation publication-type="journal"><name><surname>George</surname><given-names>E</given-names></name><name><surname>McCulloch</surname><given-names>R</given-names></name><article-title>Variable selection via Gibbs sampling</article-title><source>Journal of the American Statistical Association</source><year>1993</year><volume>88</volume><fpage>881</fpage><lpage>889</lpage><pub-id pub-id-type="doi">10.2307/2290777</pub-id></mixed-citation></ref><ref id="B18"><mixed-citation publication-type="journal"><name><surname>Kuo</surname><given-names>L</given-names></name><name><surname>Mallick</surname><given-names>B</given-names></name><article-title>Variable selection for regression models</article-title><source>Sankhya B</source><year>1998</year><volume>60</volume><fpage>65</fpage><lpage>81</lpage></mixed-citation></ref><ref id="B19"><mixed-citation publication-type="journal"><name><surname>Chipman</surname><given-names>H</given-names></name><name><surname>George</surname><given-names>E</given-names></name><name><surname>McCulloch</surname><given-names>R</given-names></name><article-title>The practical implementation of Bayesian model selection</article-title><source>IMS Lecture Notes &#x02013; Monograph Series</source><year>2001</year><volume>38</volume><fpage>67</fpage><lpage>134</lpage></mixed-citation></ref><ref id="B20"><mixed-citation publication-type="book"><name><surname>Cowan</surname><given-names>G</given-names></name><source>Statistical Data Analysis</source><year>1998</year><publisher-name>Oxford University Press</publisher-name></mixed-citation></ref><ref id="B21"><mixed-citation publication-type="journal"><name><surname>Jeffreys</surname><given-names>H</given-names></name><article-title>An Invariant Form for the Prior Probability in Estimation Problems</article-title><source>Proceedings of the Royal Society of London. Series A, Mathematical and Physical Sciences</source><year>1946</year><volume>186</volume><issue>1007</issue><fpage>453</fpage><lpage>461</lpage><pub-id pub-id-type="doi">10.1098/rspa.1946.0056</pub-id></mixed-citation></ref><ref id="B22"><mixed-citation publication-type="other"><name><surname>Denver</surname><given-names>DR</given-names></name><name><surname>Morris</surname><given-names>K</given-names></name><name><surname>Lynch</surname><given-names>M</given-names></name><name><surname>Vassilieva</surname><given-names>LL</given-names></name><name><surname>Thomas</surname><given-names>WK</given-names></name><article-title>High direct estimate of the mutation rate in the mitochondrial genome of Caenorhabditis elegans</article-title><source>Science</source><volume>289</volume><issue>5488</issue><fpage>2342</fpage><lpage>2344</lpage><comment>2000 Sep 29</comment><pub-id pub-id-type="doi">10.1126/science.289.5488.2342</pub-id><pub-id pub-id-type="pmid">11009418</pub-id></mixed-citation></ref><ref id="B23"><mixed-citation publication-type="journal"><name><surname>Montooth</surname><given-names>K</given-names></name><name><surname>Rand</surname><given-names>D</given-names></name><article-title>The spectrum of mitochondrial mutation differs across species</article-title><source>PLoS Biol</source><year>2008</year><volume>6</volume><issue>8</issue><fpage>e213</fpage><pub-id pub-id-type="doi">10.1371/journal.pbio.0060213</pub-id><pub-id pub-id-type="pmid">18752353</pub-id></mixed-citation></ref><ref id="B24"><mixed-citation publication-type="journal"><name><surname>Drummond</surname><given-names>AJ</given-names></name><name><surname>Rambaut</surname><given-names>A</given-names></name><article-title>BEAST: Bayesian evolutionary analysis by sampling trees</article-title><source>BMC Evol Biol</source><year>2007</year><volume>7</volume><fpage>214</fpage><pub-id pub-id-type="doi">10.1186/1471-2148-7-214</pub-id><pub-id pub-id-type="pmid">17996036</pub-id></mixed-citation></ref><ref id="B25"><mixed-citation publication-type="journal"><name><surname>Felsenstein</surname><given-names>J</given-names></name><article-title>Evolutionary trees from DNA sequences: a maximum likelihood approach</article-title><source>Journal of Molecular Evolution</source><year>1981</year><volume>17</volume><fpage>368</fpage><lpage>376</lpage><pub-id pub-id-type="doi">10.1007/BF01734359</pub-id><pub-id pub-id-type="pmid">7288891</pub-id></mixed-citation></ref><ref id="B26"><mixed-citation publication-type="journal"><name><surname>Hastings</surname><given-names>W</given-names></name><article-title>Monte Carlo sampling methods using Markov chains and its applications</article-title><source>Biometrika</source><year>1970</year><volume>57</volume><fpage>97</fpage><lpage>109</lpage><pub-id pub-id-type="doi">10.1093/biomet/57.1.97</pub-id></mixed-citation></ref><ref id="B27"><mixed-citation publication-type="book"><name><surname>Knight</surname><given-names>K</given-names></name><source>Mathematical Statistics</source><year>2000</year><publisher-name>CRC Press</publisher-name></mixed-citation></ref><ref id="B28"><mixed-citation publication-type="journal"><name><surname>Thompson</surname><given-names>W</given-names></name><name><surname>Rosen</surname><given-names>O</given-names></name><article-title>A Bayesian Model for Sparse Functional Data</article-title><source>Biometrics</source><year>2007</year><volume>64</volume><fpage>54</fpage><lpage>63</lpage><pub-id pub-id-type="doi">10.1111/j.1541-0420.2007.00829.x</pub-id><pub-id pub-id-type="pmid">17573864</pub-id></mixed-citation></ref><ref id="B29"><mixed-citation publication-type="other"><name><surname>Rambaut</surname><given-names>A</given-names></name><name><surname>Drummond</surname><given-names>AJ</given-names></name><source>Tracer [computer program]</source><year>2003</year><ext-link ext-link-type="uri" xlink:href="http://beast.bio.ed.ac.uk/tracer">http://beast.bio.ed.ac.uk/tracer</ext-link></mixed-citation></ref><ref id="B30"><mixed-citation publication-type="journal"><name><surname>Hasegawa</surname><given-names>M</given-names></name><name><surname>Kishino</surname><given-names>H</given-names></name><name><surname>Yano</surname><given-names>T</given-names></name><article-title>Dating the human-ape splitting by a molecular clock of mitochondrial DNA</article-title><source>Journal of Molecular Evolution</source><year>1985</year><volume>22</volume><fpage>160</fpage><lpage>174</lpage><pub-id pub-id-type="doi">10.1007/BF02101694</pub-id><pub-id pub-id-type="pmid">3934395</pub-id></mixed-citation></ref><ref id="B31"><mixed-citation publication-type="journal"><name><surname>Nei</surname><given-names>M</given-names></name><name><surname>Maruyama</surname><given-names>T</given-names></name><name><surname>Chakraborty</surname><given-names>R</given-names></name><article-title>The Bottleneck Effect and Genetic Variability in Populations</article-title><source>Evolution</source><year>1975</year><volume>29</volume><fpage>1</fpage><lpage>10</lpage><pub-id pub-id-type="doi">10.2307/2407137</pub-id></mixed-citation></ref><ref id="B32"><mixed-citation publication-type="journal"><name><surname>Johnson</surname><given-names>J</given-names></name><name><surname>Dunn</surname><given-names>P</given-names></name><name><surname>Bouzat</surname><given-names>J</given-names></name><article-title>Effects of recent population bottlenecks on reconstructing the demographic history of prairie-chickens</article-title><source>Molecular Ecology</source><year>2007</year><volume>16</volume><issue>11</issue><fpage>2203</fpage><lpage>2222</lpage><pub-id pub-id-type="doi">10.1111/j.1365-294X.2007.03285.x</pub-id><pub-id pub-id-type="pmid">17561885</pub-id></mixed-citation></ref><ref id="B33"><mixed-citation publication-type="journal"><name><surname>Pienaar</surname><given-names>E</given-names></name><name><surname>Theron</surname><given-names>M</given-names></name><name><surname>Nelson</surname><given-names>M</given-names></name><name><surname>Viljoen</surname><given-names>H</given-names></name><article-title>A quantitative model of error accumulation during PCR amplification</article-title><source>Computational Biology and Chemistry</source><year>2006</year><volume>30</volume><issue>2</issue><fpage>102</fpage><lpage>111</lpage><pub-id pub-id-type="pmid">16412692</pub-id></mixed-citation></ref><ref id="B34"><mixed-citation publication-type="journal"><name><surname>Ewing</surname><given-names>B</given-names></name><name><surname>Green</surname><given-names>P</given-names></name><article-title>Base-Calling of Automated Sequencer Traces Using Phred. II. Error Probabilities</article-title><source>Genome Research</source><year>1998</year><volume>8</volume><issue>3</issue><fpage>186</fpage><pub-id pub-id-type="pmid">9521922</pub-id></mixed-citation></ref><ref id="B35"><mixed-citation publication-type="journal"><name><surname>Pybus</surname><given-names>O</given-names></name><name><surname>Drummond</surname><given-names>A</given-names></name><name><surname>Nakano</surname><given-names>T</given-names></name><name><surname>Robertson</surname><given-names>B</given-names></name><name><surname>Rambaut</surname><given-names>A</given-names></name><article-title>The Epidemiology and Iatrogenic Transmission of Hepatitis C Virus in Egypt: A Bayesian Coalescent Approach</article-title><source>Molecular Biology and Evolution</source><year>2003</year><volume>20</volume><issue>3</issue><fpage>381</fpage><lpage>387</lpage><pub-id pub-id-type="doi">10.1093/molbev/msg043</pub-id><pub-id pub-id-type="pmid">12644558</pub-id></mixed-citation></ref><ref id="B36"><mixed-citation publication-type="journal"><name><surname>Ray</surname><given-names>SC</given-names></name><name><surname>Arthur</surname><given-names>RR</given-names></name><name><surname>Carella</surname><given-names>A</given-names></name><name><surname>Bukh</surname><given-names>J</given-names></name><name><surname>Thomas</surname><given-names>DL</given-names></name><article-title>Genetic epidemiology of hepatitis C virus throughout egypt</article-title><source>J Infect Dis</source><year>2000</year><volume>182</volume><issue>3</issue><fpage>698</fpage><lpage>707</lpage><pub-id pub-id-type="doi">10.1086/315786</pub-id><pub-id pub-id-type="pmid">10950762</pub-id></mixed-citation></ref><ref id="B37"><mixed-citation publication-type="journal"><name><surname>Das</surname><given-names>A</given-names></name><name><surname>Mohanty</surname><given-names>S</given-names></name><name><surname>Stephan</surname><given-names>W</given-names></name><article-title>Inferring the Population Structure and Demography of Drosophila ananassae From Multilocus Data</article-title><source>Genetics</source><year>2004</year><volume>168</volume><issue>4</issue><fpage>1975</fpage><lpage>1985</lpage><pub-id pub-id-type="doi">10.1534/genetics.104.031567</pub-id><pub-id pub-id-type="pmid">15611168</pub-id></mixed-citation></ref><ref id="B38"><mixed-citation publication-type="journal"><name><surname>Kass</surname><given-names>R</given-names></name><name><surname>Raftery</surname><given-names>A</given-names></name><article-title>Bayes Factors</article-title><source>Journal of the American Statistical Association</source><year>1995</year><volume>90</volume><issue>430</issue></mixed-citation></ref><ref id="B39"><mixed-citation publication-type="journal"><name><surname>Felsenstein</surname><given-names>J</given-names></name><article-title>Accuracy of Coalescent Likelihood Estimates: Do We Need More Sites, More Sequences, or More Loci?</article-title><source>Mol Biol Evol</source><year>2006</year><volume>23</volume><issue>3</issue><fpage>691</fpage><lpage>700</lpage><pub-id pub-id-type="doi">10.1093/molbev/msj079</pub-id><pub-id pub-id-type="pmid">16364968</pub-id></mixed-citation></ref><ref id="B40"><mixed-citation publication-type="journal"><name><surname>Carling</surname><given-names>MD</given-names></name><name><surname>Brumfield</surname><given-names>RT</given-names></name><article-title>Gene Sampling Strategies for Multi-Locus Population Estimates of Genetic Diversity</article-title><source>PLoS ONE</source><year>2007</year><volume>2</volume><fpage>e160</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0000160</pub-id><pub-id pub-id-type="pmid">17225863</pub-id></mixed-citation></ref></ref-list></back></article>