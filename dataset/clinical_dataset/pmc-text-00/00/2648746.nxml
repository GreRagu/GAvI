<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd"><article xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id><journal-title>BMC Bioinformatics</journal-title><issn pub-type="epub">1471-2105</issn><publisher><publisher-name>BioMed Central</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">19208133</article-id><article-id pub-id-type="pmc">2648746</article-id><article-id pub-id-type="publisher-id">1471-2105-10-S1-S32</article-id><article-id pub-id-type="doi">10.1186/1471-2105-10-S1-S32</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research</subject></subj-group></article-categories><title-group><article-title>Predicting microRNA targets in time-series microarray experiments via functional data analysis</article-title></title-group><contrib-group><contrib id="A1" corresp="yes" contrib-type="author"><name><surname>Parker</surname><given-names>Brian J</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>bparker@binf.ku.dk</email></contrib><contrib id="A2" contrib-type="author"><name><surname>Wen</surname><given-names>Jiayu</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>jeanwen@binf.ku.dk</email></contrib></contrib-group><aff id="I1"><label>1</label>The Bioinformatics Centre, Department of Biology, University of Copenhagen, Ole Maaloes Vej 5, 2200 Copenhagen N, Denmark</aff><pub-date pub-type="collection"><year>2009</year></pub-date><pub-date pub-type="epub"><day>30</day><month>1</month><year>2009</year></pub-date><volume>10</volume><issue>Suppl 1</issue><supplement><named-content content-type="supplement-title">Selected papers from the Seventh Asia-Pacific Bioinformatics Conference (APBC 2009)</named-content><named-content content-type="supplement-editor">Michael Q Zhang, Michael S Waterman and Xuegong Zhang</named-content></supplement><fpage>S32</fpage><lpage>S32</lpage><ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/10/S1/S32"/><permissions><copyright-statement>Copyright &#x000a9; 2009 Parker and Wen; licensee BioMed Central Ltd.</copyright-statement><copyright-year>2009</copyright-year><copyright-holder>Parker and Wen; licensee BioMed Central Ltd.</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0"><p>This is an open access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p><!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>               Parker               J               Brian                              bparker@binf.ku.dk            </dc:author><dc:title>            Predicting microRNA targets in time-series microarray experiments via functional data analysis         </dc:title><dc:date>2009</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 10(Suppl 1): S32-. (2009)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2009)10:Suppl 1&#x0003c;S32&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>--></license></permissions><abstract><sec><title>Background</title><p>MicroRNA (miRNA) target prediction is an important component in understanding gene regulation. One approach is computational: searching nucleotide sequences for miRNA complementary base pairing. An alternative approach explored in this paper is the use of gene expression profiles from time-series microarray experiments to aid in miRNA target prediction. This requires distinguishing genuine targets from genes that are secondarily down-regulated as part of the same regulatory module. We use a functional data analytic (FDA) approach, FDA being a subfield of statistics that extends standard multivariate techniques to datasets with predictor and/or response variables that are functional.</p></sec><sec><title>Results</title><p>In a miR-124 transfection experiment spanning 120 hours, for genes with measurably down-regulated mRNA, exploratory functional data analysis showed differences in expression profiles over time between directly and indirectly down-regulated genes, such as response latency and biphasic response for direct miRNA targets. For prediction, an FDA approach was shown to effectively classify direct miR-124 targets from time-series microarray data (accuracy 88%; AUC 0.96), providing better performance than multivariate approaches.</p></sec><sec><title>Conclusion</title><p>Exploratory FDA analysis can reveal interesting aspects of dynamic microarray miRNA studies. Predictive FDA models can be applied where computational miRNA target predictors fail or are unreliable, e.g. when there is a lack of evolutionary conservation, and can provide posterior probabilities to provide additional confirmatory evidence to validate candidate miRNA targets computationally predicted using sequence information. This approach would be applicable to the investigation of other miRNAs and suggests that dynamic microarray studies at a higher time resolution could reveal further details on miRNA regulation.</p></sec></abstract><conference><conf-date>13&#x02013;16 January 2009</conf-date><conf-name>The Seventh Asia Pacific Bioinformatics Conference (APBC 2009)</conf-name><conf-loc>Beijing, China</conf-loc></conference></article-meta></front><body><sec><title>Background</title><p>MicroRNAs (miRNAs) are a class of small non-coding RNAs that are found in both plants and animals. They are known to play important roles in gene regulatory networks by post-transcriptionally regulating the expression of other genes. These miRNAs target other transcripts by forming near-perfect or imperfect base pairings. Such formations silence genes either by mRNA cleavage or translational repression [<xref ref-type="bibr" rid="B1">1</xref>].</p><p>Computational sequence-based methods have been developed to predict miRNA direct targets. As animal mRNAs have imperfect complementary base pairing to their targets and as they are short in length, most such approaches first search for a perfect 7-mer seed in the 5' end of miRNAs that match to their targets. Searching for such small motifs can lead to high false positive rates and so additional tests such as conservation filters are typically applied [<xref ref-type="bibr" rid="B2">2</xref>]. However, although many miRNA targets are conserved in related species, restricting the analysis only to recognizably conserved targets would exclude miRNAs that have recently diverged or changed rapidly. Also, only a small number of such predicted targets have been experimentally validated.</p><p>Although animal miRNAs were originally believed to primarily translationally suppress gene expression, they have also been found to lead to mRNA destabilization or degradation. MiRNA transfection microarray experiments capable of detecting such effects at the mRNA level of targets have shown that a large number of transcripts are down-regulated by over-expression of miRNAs [<xref ref-type="bibr" rid="B3">3</xref>]. Such high-throughput expression data provide a promising way to assist in miRNA target prediction.</p><p>The mRNA expression changes after miRNA transfection could be a result of miRNAs directly targeting these messages (<italic>direct targets </italic>in the sequel), or the mRNA of genes could also be indirectly down-regulated if they are a part of a miRNA-mediated regulatory module controlled by the direct miRNA targets (<italic>indirect targets </italic>in the sequel) [<xref ref-type="bibr" rid="B3">3</xref>]. In this case, these indirectly regulated genes' response is causally related to the directly regulated genes in the corresponding module. As such, indirect targets would be expected to respond with delayed expression changes over time relative to the direct targets.</p><p>Time-series microarray experiments that repeatedly measure gene expression simultaneously for multiple genes over a time period can capture temporal patterns and dependency of gene expression changes. A recent study by Wang and Wang [<xref ref-type="bibr" rid="B4">4</xref>] applied sequence-based target prediction to identify targets and then used a time-series miRNA transfection microarray analysis to experimentally validate the predictions. Another study used a gene set enrichment-like score to measure expression changes at different times [<xref ref-type="bibr" rid="B5">5</xref>]. However, these methods treated expression changes over time points as separate observations and therefore did not fully utilize the information on time dependency of gene expression changes. In this paper we aim to explore the differences between the expression profiles of genes that are direct miRNA targets and indirectly targeted genes, including classification of genes based on their profile. We use functional data analysis (FDA) to utilize the higher level structure due to the data being a set of finite samples from a continuous and presumably smooth curve.</p><p>Functional data analysis [<xref ref-type="bibr" rid="B6">6</xref>-<xref ref-type="bibr" rid="B9">9</xref>] is a subfield of statistics applicable when the predictor or response variable can be treated as a set of samples from a function, rather than simply as a feature vector. It is, in essence, the extension of standard multivariate analysis of finite dimensional vector spaces to infinite dimensional function spaces (e.g. reproducing kernel Hilbert spaces (RKHS)) using a functional analytic approach. FDA entails interpolating and smoothing the set of function samples using some appropriate set of basis functions (e.g. splines), kernel smoothing, or regularization. Multivariate procedures such as principal component, regression and classification analyses typically involve an inner product (or some form of metric) defined on the vector space: for the reconstructed continuous function, the conventional multivariate dot product, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" name="1471-2105-10-S1-S32-i1" overflow="scroll"><mml:semantics><mml:mrow><mml:mo>&#x02329;</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>&#x0232a;</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:semantics></mml:math></inline-formula>, can be replaced by the corresponding functional inner product, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2" name="1471-2105-10-S1-S32-i2" overflow="scroll"><mml:semantics><mml:mrow><mml:mo>&#x02329;</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>&#x0232a;</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>&#x0222b;</mml:mo><mml:mn>0</mml:mn><mml:mi>T</mml:mi></mml:msubsup><mml:mrow><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:semantics></mml:math></inline-formula>, for time interval <italic>T</italic>, in the corresponding multivariate analysis method. For example, standard PCA can be extended to functional PCA (FPCA) [<xref ref-type="bibr" rid="B6">6</xref>,<xref ref-type="bibr" rid="B10">10</xref>] as follows. Conventional multivariate PCA finds the axes of maximum variance in the data by solving the eigenequation <italic>V&#x003be; </italic>= <italic>&#x003bb;&#x003be; </italic>for variance &#x02013; covariance matrix <italic>V </italic>= <italic>n</italic><sup>-1 </sup><italic>X'X</italic>, where <italic>X </italic>is the (mean centred) <italic>n </italic>&#x000d7; <italic>p </italic>data matrix, with <italic>n </italic>samples and <italic>p </italic>features; and <italic>&#x003bb; </italic>and <italic>&#x003be; </italic>are the corresponding eigenvalue and eigenvector. In functional PCA, the equivalent eigenequation is generalized to <italic>V&#x003be; </italic>= <italic>&#x003bb;&#x003be; </italic>where <italic>&#x003be; </italic>is now an eigenfunction and <italic>V </italic>is the covariance operator defined by: <italic>Vx</italic>(<italic>s</italic>) = &#x0222b;<italic>v</italic>(<italic>s</italic>, <italic>t</italic>)<italic>x</italic>(<italic>t</italic>)<italic>dt </italic>= &#x027e8;(<italic>v</italic>(<italic>s</italic>, &#x000b7;), <italic>x</italic>&#x027e9;; where the variance-covariance function (the functional extension of the variance-covariance matrix) <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M3" name="1471-2105-10-S1-S32-i3" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:semantics></mml:math></inline-formula>. So, in summary, FPCA can be expressed as the eigenanalysis of the covariance operator <italic>V</italic>, defined by using the covariance function <italic>v </italic>as the kernel of an integral transform, and this formulation of the eigenequation in terms of inner products, &#x027e8;<italic>v</italic>(<italic>s</italic>, &#x000b7;), <italic>&#x003be;</italic>&#x027e9; = <italic>&#x003bb;&#x003be;</italic>, can be applied to either multivariate or functional data, with the respective definition of inner product, where <italic>s </italic>&#x02208; <italic>T </italic>for function domain <italic>T </italic>for the functional case, and index set <italic>T </italic>= 1,..., <italic>p </italic>in the multivariate case. In most cases, this expression can be computed quickly using only matrix expressions utilizing the sampled data points and a matrix of inner products between basis functions, avoiding estimation of the integral [<xref ref-type="bibr" rid="B10">10</xref>]. Similarly, most other standard multivariate data analyses such as canonical correlation, cluster, regression and classification analysis can be extended to functional versions.</p><p>In this paper, we use FPCA for initial exploratory analysis and a nonparametric functional data analysis (NPFDA) approach [<xref ref-type="bibr" rid="B11">11</xref>] for prediction. The advantage of this functional data analytic approach is that the prior knowledge that the data is generated by a continuous smooth dynamics allows for: accurate estimates of derivatives which can then be used in the analysis; effective noise reduction through curve smoothing; applicability to data with irregular time sampling schedules. Such functional data analytic approaches have been previously applied to the analysis of temporal microarray expression data e.g. to cluster time-series gene expression data [<xref ref-type="bibr" rid="B12">12</xref>] and to classify yeast cell-cycle gene expression profiles and Dictyostelium cell-type [<xref ref-type="bibr" rid="B13">13</xref>]. In this paper, we analyze miRNA-124 transfection time-series microarray expression data using FDA and show that such expression change differences can be modeled as different time activity curves to effectively predict miRNA direct targets and distinguish them from indirect targets.</p></sec><sec sec-type="methods"><title>Methods</title><p>We analyzed the miR-124 transfection time-series microarray data previously published in [<xref ref-type="bibr" rid="B4">4</xref>], which measures expression levels over 120 hours at 7 time points. We initially identified a set of genes down-regulated after miRNA transfection. To identify, using sequence information alone, a set of true (with high probability) targets and non-targets to train the functional model, we predicted miRNA targets using publicly available target predictors and used the high confidence predictions to determine direct-target and indirect-target sets as training sets for classification. FPCA was used for exploratory data analysis and NPFDA was used to distinguish the direct targets from the indirect targets. An overview of the analysis pipeline in this study is outlined in figure <xref ref-type="fig" rid="F1">1</xref> and details are described in the following sections.</p><fig position="float" id="F1"><label>Figure 1</label><caption><p>Data analysis flowchart.</p></caption><graphic xlink:href="1471-2105-10-S1-S32-1"/></fig><sec><title>miRNA transfection dataset</title><p>We retrieved the miRNA-124 transfection time-series microarray expression dataset from the GEO database [<xref ref-type="bibr" rid="B14">14</xref>] (accession no. GDS2657). The dataset contains mRNA expression profiles generated by over-expressing miRNA-124 duplexes into human HepG2 cells in comparison to negative controls at times 4, 8, 16, 24, 32, 72 and 120 hours, using Affymetrix microarrays (U133Plus2; RMA-normalized). miRNA-124 is known to be highly expressed in several tissues including brain and kidney, but is not highly expressed in the cell line used [<xref ref-type="bibr" rid="B3">3</xref>,<xref ref-type="bibr" rid="B4">4</xref>]. Starting with all genes provided on the U133Plus2 microarray, we first excluded those genes showing low overall expression levels in the control samples as these genes would be unlikely to be able to clearly show down-regulation after miRNA transfection. Only probes where the expression levels over at least half of all time points of the control samples were greater than the median expression level of control samples were retained for further analysis. Expression values were averaged for those genes with corresponding multiple probes.</p><p>We next identified genes showing substantial evidence for down-regulation of mRNAs. Genes with over 1.4-fold under-expression (corresponding to a log<sub>2 </sub>expression fold change (FC) of less than -0.5) for at least one time point were considered to be down-regulated genes. We subsequently restricted our analysis to these down-regulated genes in this study (from this down-regulated set, we also excluded a further 19 very noisy genes which had some time points showing greater than 1.3-fold over-expression).</p></sec><sec><title>miRNA target prediction</title><p>We obtained two pre-computed target gene sets for miR-124 that were predicted by TargetScanS [<xref ref-type="bibr" rid="B15">15</xref>] and PITA [<xref ref-type="bibr" rid="B16">16</xref>]. The TargetScanS pre-computed target set for miR-124 contains 289 down-regulated genes with 7- and 8-mer sites conserved across several mammalian species and 384 genes with non-conserved sites. The PITA pre-computed target set for miR-124 contains 198 down-regulated genes with 7- and 8-mer conserved sites and 236 genes with non-conserved sites (a conservation score of higher and lower than 0.9 was considered as the conserved and nonconserved targets, respectively [<xref ref-type="bibr" rid="B16">16</xref>]). To construct a control set of genes that were not predicted to be miRNA-124 targets, we further excluded genes showing even weak sites. To do so, we first extracted annotated 3'UTR sequences of genes from Ensemble [<xref ref-type="bibr" rid="B17">17</xref>] using Biomart [<xref ref-type="bibr" rid="B18">18</xref>]. miRNA target predictions were then performed on the 3'UTRs using PITA [<xref ref-type="bibr" rid="B19">19</xref>] with a relaxed parameter setting: a seed of length 6 to 8 bps and allowing G::U pairing in 7- and 8-mer seeds.</p></sec><sec><title>Construction of datasets</title><p>We constructed two datasets to be used as training data for functional classification analysis.</p><p>(1) <italic>Direct-target training set</italic>: we used the existing computational miRNA target predictors described above to construct a relatively high confidence direct-target training set. As current computational target predictors can vary in their effectiveness [<xref ref-type="bibr" rid="B20">20</xref>], to increase confidence we required both predictors to agree. We obtained 157 down-regulated genes that were predicted by both predictors with 7- and 8-mer seed sites and that were found to be evolutionarily conserved in several other species by both predictors.</p><p>(2) <italic>Indirect-target training set</italic>: we selected the down-regulated genes that had annotated 3'UTRs but in which no target sites could be found by either predictor and even no weak sites could be found by using PITA prediction with relaxed parameters. From these genes, a set of size identical to the direct-target training set was randomly sampled to form the indirect-target training set.</p><p>We also constructed two independent datasets that had not been used for training that we used to further evaluate our model.</p><p>(1) <italic>Non-conserved direct-target test set</italic>: we combined the down-regulated genes that were predicted from either of the predictors, yet that had no evidence of conservation. This set consisted of 424 genes and presumably would be enriched for direct targets.</p><p>(2) <italic>Indirect-target test set</italic>: we constructed another independent dataset which met the same criteria as the indirect-target training set but excluding genes that had been used for training the model. This set consisted of 372 genes.</p></sec><sec><title>Functional data analysis</title><p>We used FPCA to perform exploratory data analysis. To fit a smooth function to the discrete sampled data, we used a set of 9 B-spline basis functions of order 4 (for cubic smoothing splines). Knots were located at the data points. Additional regularized smoothing (<italic>&#x003bb; </italic>= 0.01) was applied (second derivative roughness penalty).</p><p>The NPFDA approach was used for classification. The first derivative of the expression profile was effectively used as the predictor variable, with a boolean (two-class) response variable. The NPFDA used B-spline basis functions (with 7 knots) to produce smooth first derivative estimates. Performance evaluation was by 10 &#x000d7; stratified 10-fold cross-validation (CV). Major parameters were determined via nested CV separately for each fold; other parameter settings were set to their defaults or as appropriate for the data size. To evaluate the discriminability of the classes, the Receiver Operating Characteristics (ROC) curves were calculated as well as the associated area under the ROC curve (AUC).</p><p>R code implementing the analysis is available from the authors.</p></sec></sec><sec><title>Results and discussion</title><sec><title>Exploratory data analysis with functional principal components analysis (FPCA)</title><p>In the miR-124 dataset, Wang and Wang [<xref ref-type="bibr" rid="B4">4</xref>] previously noted that genes directly targeted by miR-124 tended to have substantial down-regulation at time points earlier than the indirectly down-regulated genes. This phenomena is as would be expected as the indirect targets would be causally downstream to the directly regulated genes. Figures <xref ref-type="fig" rid="F2">2(a)</xref> and <xref ref-type="fig" rid="F3">3(a)</xref> show the mean, unsmoothed, gene expression profiles of the direct-target training set and the indirect-target training set, respectively (See Methods for construction of the direct-target training and the indirect-target training set). The measurement time points are plotted equally spaced on the time axis to emphasize the early stages of the expression profile. Comparing the mean curves of the two datasets, the direct targets show an immediate decrease in mRNA levels reaching a minimum at approximately 72 hours. By contrast, the indirect targets show a delayed response and do not, on average, commence decreasing until approximately 32 hours, reaching a minimum at about 72 hours. Figures <xref ref-type="fig" rid="F2">2(b)</xref> and <xref ref-type="fig" rid="F3">3(b)</xref> show the smoothed functional profiles that were reconstructed using B-spline basis functions (see Methods). As discussed in the background section, it can be seen that smoothed functional curves allow us to reduce noise and have a better estimate of curve derivatives.</p><fig position="float" id="F2"><label>Figure 2</label><caption><p><bold>Profiles of gene expression of the direct-target training set</bold>. Each grey line represents the expression change (y-axis) of one gene across the 7 time points (x-axis). The black line represents the mean value of the curves. (a) plots the linearly interpolated observed data, and (b) plots the corresponding functional data smoothed with B-spline basis functions.</p></caption><graphic xlink:href="1471-2105-10-S1-S32-2"/></fig><fig position="float" id="F3"><label>Figure 3</label><caption><p><bold>Profiles of gene expression of the indirect-target training set</bold>. Each grey line represents the expression change (y-axis) of one gene across the 7 time points (x-axis). The black line represents the mean value of the curves. (a) plots the linearly interpolated observed data, and (b) plots the corresponding functional data smoothed with B-spline basis functions.</p></caption><graphic xlink:href="1471-2105-10-S1-S32-3"/></fig><p>FPCA analysis reveals the modes of variation across the samples. Figure <xref ref-type="fig" rid="F4">4</xref> shows the results of FPCA applied to the indirect-target training set and the major modes of variance of the signal compared with the mean (the times shown are linear along the x-axis in these figures). In figure <xref ref-type="fig" rid="F4">4(a)</xref> the first principal component (PC) function (or harmonic) is added and subtracted from the mean curve, and similarly for the second PC function in figure <xref ref-type="fig" rid="F4">4(b)</xref>. Figure <xref ref-type="fig" rid="F4">4(a)</xref> shows that there is a large variance in the overall expression fold change along the curves. The curves are normalized in the following classification step to minimize this variance (see below). Figure <xref ref-type="fig" rid="F4">4(b)</xref> shows that the down-regulation peak varies somewhat in the exact time of its minimum across genes. The extent to which this variance is biologically meaningful and represents causal relationships, as opposed to being explained by the relatively low resolution sampling interval used, will require higher resolution studies to investigate. For example, only approximately three time points were available in this dataset to capture the details of the major indirect target down-regulation peak, which is only just sufficient. Ideally, for an FDA analysis of such noisy data a sampling rate 2 or more times higher than this would be needed to capture fine details well [<xref ref-type="bibr" rid="B8">8</xref>].</p><fig position="float" id="F4"><label>Figure 4</label><caption><p><bold>Functional PCA of the indirect-target training set</bold>. (a) and (b) plot the first two principal component harmonics for the indirect-targets. The thin curve represents the mean fold change and the thick curve represents the effect of adding (+) and subtracting (-) the corresponding FPCA harmonic to the mean curve.</p></caption><graphic xlink:href="1471-2105-10-S1-S32-4"/></fig><p>Figure <xref ref-type="fig" rid="F5">5</xref> shows the FPCA results for the direct-target training set. Again, a large variance in overall scale in the first channel (figure <xref ref-type="fig" rid="F5">5(a)</xref>) is seen. Figure <xref ref-type="fig" rid="F5">5(b)</xref> shows a substantial variance in the time of the major peak at around 72 hours as in the indirect target. However, it also shows evidence of a smaller secondary mode of variance at approximately 24 hours; this would suggest that there is a mixture of components to the curve, with the main direct miRNA repression occurring in the first phase, and a later component matching the response of the indirect targets. This biphasic response is also demonstrated in figure <xref ref-type="fig" rid="F6">6</xref> which shows phase plane plots of curve slope against curve value for two representative genes of the direct and indirect target sets. Abrupt changes in such plots (cusps) highlight sudden changes in curve shape. The direct target plot, figure <xref ref-type="fig" rid="F6">6(a)</xref>, shows a cusp at approximately 32 hours, compared with the smooth plot of the indirect target, figure <xref ref-type="fig" rid="F6">6(b)</xref>. Existing kinetic models of miRNA gene regulation have not modeled this effect [<xref ref-type="bibr" rid="B21">21</xref>].</p><fig position="float" id="F5"><label>Figure 5</label><caption><p><bold>Functional PCA for the direct-target training set</bold>. (a) and (b) plot the first two principal component harmonics for the direct-targets. The thin curve represents the mean fold change and the thick curve represents the effect of adding (+) and subtracting (-) the corresponding FPCA harmonic to the mean curve.</p></caption><graphic xlink:href="1471-2105-10-S1-S32-5"/></fig><fig position="float" id="F6"><label>Figure 6</label><caption><p><bold>Phase plane plot for direct and indirect targets</bold>. First derivative, Dx(t), versus expression function, x(t), plot of a representative curve from the (a) direct-target set and (b) indirect target set. The time points are labelled along the curve.</p></caption><graphic xlink:href="1471-2105-10-S1-S32-6"/></fig></sec><sec><title>Classification using nonparametric FDA (NPFDA)</title><p>As noted above, the gene expression curves show a large variance in overall fold change in the first principal component of the functional PCA. A key preprocessing step in FDA is registration of the curves to remove unimportant amplitude or other variations. Prior to classification, therefore, each curve was standardized to have a mean (log<sub>2</sub>) fold change of -1. Thus, average fold change differences between the direct and indirect target sets were normalized away, and the shape of the response curves alone was effectively used to distinguish the direct targets from the indirect targets. Using curve shape information only would be expected to provide a more robust predictor than also relying on the absolute fold change as a feature, as it varies substantially between genes. An NPFDA discrimination model was trained on the direct and indirect target training sets (see Methods). The performance was compared with linear discriminant analysis (LDA) as an example of a standard multivariate analysis.</p><p>The results are shown in Table <xref ref-type="table" rid="T1">1</xref>. The NPFDA gave very good prediction accuracy of 88% and AUC of 0.96. (AUC is a measure of the discriminative power of the classes using the given features and classifier, and varies from 0.5 for non-distinguishable classes to 1.0 for perfectly distinguishable classes. The AUC can be interpreted as the probability that two random samples from the two classes will be ranked correctly, and is invariant to changes in class proportions (unlike accuracy)). The increase in accuracy over LDA was statistically significant (<italic>p &#x0003c;</italic>0.01; McNemar test). Figure <xref ref-type="fig" rid="F7">7</xref> shows the ROC curves for NPFDA and standard LDA: NPFDA shows a substantial improvement over multivariate LDA. For comparison, the discriminability of each time point treated separately as a univariate feature was examined: the expression level across genes at each time point was used directly for ranking to compute the corresponding AUC. The best discriminating time point was at 24 hours with an AUC of 0.91.</p><table-wrap position="float" id="T1"><label>Table 1</label><caption><p>Classification performance using NPFDA and LDA</p></caption><table frame="hsides" rules="groups"><thead><tr><td></td><td align="center">Accuracy (standard error)</td><td align="center">AUC (standard error)</td></tr></thead><tbody><tr><td align="center">NPFDA</td><td align="center">88% (0.019)</td><td align="center">0.96 (0.012)</td></tr><tr><td colspan="3"><hr></hr></td></tr><tr><td align="center">LDA</td><td align="center">83% (0.022)</td><td align="center">0.88 (0.020)</td></tr></tbody></table></table-wrap><fig position="float" id="F7"><label>Figure 7</label><caption><p><bold>ROC curve for classification</bold>. The ROC curves plot the true positive (sensitivity) versus false positive (1-specificity) for NPFDA and LDA classification. Error bars show standard deviation over the CV replications.</p></caption><graphic xlink:href="1471-2105-10-S1-S32-7"/></fig><p>To further validate the trained model, we also used it to classify data that was independent of the training set: the non-conserved direct-target test set and the indirect-target test set (See Method). Although the true status of these data are not known and so explicit accuracy and AUC results cannot be computed, we would expect the majority of the non-conserved test set to be true direct targets. However without conservation information we would expect a proportion of false positives i.e. indirect targets in actuality. For the indirect-target test set, we would expect predominantly true indirect targets. We generated histograms of the posterior probabilities from the NPFDA in these datasets (figure <xref ref-type="fig" rid="F8">8</xref>). Comparing the histograms of the non-conserved direct target test set (red) and the indirect-target test set (black), we see this expected result: the red set has overall high posterior probability (for being a direct target) with a large mode approaching 1. Based on this evidence, the majority of the predicted genes without conservation information are indeed true direct targets.</p><fig position="float" id="F8"><label>Figure 8</label><caption><p><bold>Distributions of posterior probabilities</bold>. Distributions of the predicted posterior probabilities for two independent sets: nonconserved direct-target test set (red) and indirect-target test set (black).</p></caption><graphic xlink:href="1471-2105-10-S1-S32-8"/></fig><p>Figure <xref ref-type="fig" rid="F9">9(a)</xref> shows the time series plots for the top positive predictions of the non-conserved direct target test set (red set in the figure <xref ref-type="fig" rid="F8">8</xref>) with a posterior probability greater than 0.8 (size 262). These true positives show a profile similar to the direct targets in the training set, which gives high confidence that they are indeed true positives. Taking those high confidence predictions with posterior probability <italic>&#x0003e; </italic>0.9 gives a set of 203 new non-conserved miRNA target predictions (cf. 76 conserved targets predicted in [<xref ref-type="bibr" rid="B4">4</xref>]).</p><fig position="float" id="F9"><label>Figure 9</label><caption><p><bold>Profiles of gene expression for predicted classes</bold>. (a) Top nonconserved direct-target test set predictions (posterior probability greater than 80%). (b) Bottom nonconserved direct-target test set predictions (posterior probability less than 20%). (c) Top indirect-target test set predictions (posterior probability less than 20%).</p></caption><graphic xlink:href="1471-2105-10-S1-S32-9"/></fig><p>Figure <xref ref-type="fig" rid="F9">9(b)</xref> shows the bottom predictions of the non-conserved direct target test set with a posterior probability of less than 0.2 (size 44). These curves appear to match the indirect target profile seen in the training set indicating that they are likely false positives of the computational predictors. Figure <xref ref-type="fig" rid="F9">9(c)</xref> shows the time series plots for the top predictions for the indirect-target test set (black set in figure <xref ref-type="fig" rid="F8">8</xref>) with a posterior probability of less than 0.2 (size 262). These curves match the expected indirect target expression change profile. It also appears that there are at least two subgroups amongst these indirect targets, one with a much longer response time.</p></sec></sec><sec><title>Conclusion</title><p>In this study, we presented an FDA analysis of the differences in expression profiles between direct and indirect miRNA targets in a miR-124 miRNA transfection experiment. An exploratory FDA analysis showed differences in response latency, with direct targets showing an immediate down-regulation whereas indirect targets typically showed an approximately 32 hour delay. Also, direct miRNA target curves show evidence of a biphasic, two-component response with an initial early decrease presumably due to direct effects of the miRNA on mRNA, and a later component matching the response of the indirect targets, possibly due to secondary effects.</p><p>These time profile differences can be utilized for classification, and in the prediction analysis we showed that FDA can provide very good discrimination, substantially better than a standard multivariate analysis, as FDA utilizes the prior knowledge that the biological process of regulation generates a smoothly varying time profile. Such a predictive model would be especially useful in cases where computational approaches are less reliable e.g. lack of evolutionary conservation. Further, this approach can be used to provide additional confirmatory evidence (posterior probabilities) for computationally predicted miRNA targets and so improve computational miRNA target prediction. This approach would be applicable to the investigation of other miRNAs and these results suggest that dynamic microarray studies at a higher time resolution could reveal further details on miRNA regulation.</p></sec><sec><title>Competing interests</title><p>The authors declare that they have no competing interests.</p></sec><sec><title>Authors' contributions</title><p>BJP and JW designed the study and analyzed the data. Both authors drafted, read and approved the final manuscript. BJP and JW contributed equally to this work.</p></sec></body><back><ack><sec><title>Acknowledgements</title><p>Thanks to Anders Krogh for helpful discussions. This work was supported by the Danish National Science Foundation and Novo Nordisk Foundation.</p><p>This article has been published as part of <italic>BMC Bioinformatics </italic>Volume 10 Supplement 1, 2009: Proceedings of The Seventh Asia Pacific Bioinformatics Conference (APBC) 2009. The full contents of the supplement are available online at <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/10?issue=S1"/></p></sec></ack><ref-list><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Engels</surname><given-names>BM</given-names></name><name><surname>Hutvagner</surname><given-names>G</given-names></name></person-group><article-title>Principles and effects of microRNA-mediated post-transcriptional gene regulation</article-title><source>Oncogene</source><year>2006</year><volume>25</volume><fpage>6163</fpage><lpage>6169</lpage><pub-id pub-id-type="pmid">17028595</pub-id><pub-id pub-id-type="doi">10.1038/sj.onc.1209909</pub-id></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Yoon</surname><given-names>S</given-names></name><name><surname>De Micheli</surname><given-names>G</given-names></name></person-group><article-title>Computational identification of microRNAs and their targets</article-title><source>Birth Defects Res C Embryo Today</source><year>2006</year><volume>78</volume><fpage>118</fpage><lpage>128</lpage><pub-id pub-id-type="pmid">16847881</pub-id><pub-id pub-id-type="doi">10.1002/bdrc.20067</pub-id></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lim</surname><given-names>LP</given-names></name><name><surname>Lau</surname><given-names>NC</given-names></name><name><surname>Garrett-Engele</surname><given-names>P</given-names></name><name><surname>Grimson</surname><given-names>A</given-names></name><name><surname>Schelter</surname><given-names>JM</given-names></name><name><surname>Castle</surname><given-names>J</given-names></name><name><surname>Bartel</surname><given-names>DP</given-names></name><name><surname>Linsley</surname><given-names>PS</given-names></name><name><surname>Johnson</surname><given-names>JM</given-names></name></person-group><article-title>Microarray analysis shows that some microRNAs downregulate large numbers of target mRNAs</article-title><source>Nature</source><year>2005</year><volume>433</volume><fpage>769</fpage><lpage>773</lpage><pub-id pub-id-type="pmid">15685193</pub-id><pub-id pub-id-type="doi">10.1038/nature03315</pub-id></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>X</given-names></name><name><surname>Wang</surname><given-names>X</given-names></name></person-group><article-title>Systematic identification of microRNA functions by combining target prediction and expression profiling</article-title><source>Nucleic Acids Res</source><year>2006</year><volume>34</volume><fpage>1646</fpage><lpage>1652</lpage><pub-id pub-id-type="pmid">16549876</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkl068</pub-id></citation></ref><ref id="B5"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Cheng</surname><given-names>C</given-names></name><name><surname>Li</surname><given-names>LM</given-names></name></person-group><article-title>Inferring microRNA activities by combining gene expression with microRNA target prediction</article-title><source>PLoS ONE</source><year>2008</year><volume>3</volume><fpage>e1989</fpage><pub-id pub-id-type="pmid">18431476</pub-id><pub-id pub-id-type="doi">10.1371/journal.pone.0001989</pub-id></citation></ref><ref id="B6"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ramsay</surname><given-names>JO</given-names></name><name><surname>Dalzell</surname><given-names>CJ</given-names></name></person-group><article-title>Some tools for functional data analysis</article-title><source>J R Stat Soc Ser B</source><year>1991</year><volume>53</volume><fpage>539</fpage><lpage>572</lpage></citation></ref><ref id="B7"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Ramsay</surname><given-names>JO</given-names></name><name><surname>Silverman</surname><given-names>BW</given-names></name></person-group><source>Functional data analysis</source><year>1997</year><edition>first</edition><publisher-name>Springer-Verlag, New York: Springer Series in Statistics</publisher-name></citation></ref><ref id="B8"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Ramsay</surname><given-names>JO</given-names></name><name><surname>Silverman</surname><given-names>BW</given-names></name></person-group><source>Functional data analysis</source><year>2005</year><edition>second</edition><publisher-name>Springer-Verlag, New York: Springer Series in Statistics</publisher-name></citation></ref><ref id="B9"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Hastie</surname><given-names>T</given-names></name><name><surname>Tibshirani</surname><given-names>R</given-names></name><name><surname>Friedman</surname><given-names>J</given-names></name></person-group><source>The elements of statistical learning</source><year>2001</year><publisher-name>Springer-Verlag, New York: Springer Series in Statistics</publisher-name></citation></ref><ref id="B10"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Besse</surname><given-names>P</given-names></name><name><surname>Ramsay</surname><given-names>JO</given-names></name></person-group><article-title>Principal components analysis of sampled functions</article-title><source>Psychometrika</source><year>1986</year><volume>51</volume><fpage>285</fpage><lpage>311</lpage><pub-id pub-id-type="doi">10.1007/BF02293986</pub-id></citation></ref><ref id="B11"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Ferraty</surname><given-names>F</given-names></name><name><surname>Vieu</surname><given-names>P</given-names></name></person-group><source>Nonparametric functional data analysis</source><year>2006</year><publisher-name>Springer-Verlag, New York: Springer Series in Statistics</publisher-name></citation></ref><ref id="B12"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Song</surname><given-names>JJ</given-names></name><name><surname>Lee</surname><given-names>HJ</given-names></name><name><surname>Morris</surname><given-names>JS</given-names></name><name><surname>Kang</surname><given-names>S</given-names></name></person-group><article-title>Clustering of time-course gene expression data using functional data analysis</article-title><source>Comput Biol Chem</source><year>2007</year><volume>31</volume><fpage>265</fpage><lpage>274</lpage><pub-id pub-id-type="pmid">17631419</pub-id><pub-id pub-id-type="doi">10.1016/j.compbiolchem.2007.05.006</pub-id></citation></ref><ref id="B13"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>M&#x000fc;ller</surname><given-names>HG</given-names></name><name><surname>Leng</surname><given-names>X</given-names></name></person-group><article-title>Classification using functional data analysis for temporal gene expression data</article-title><source>Bioinformatics</source><year>2005</year><volume>22</volume><fpage>68</fpage><lpage>76</lpage><pub-id pub-id-type="pmid">16257986</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/bti742</pub-id></citation></ref><ref id="B14"><citation citation-type="other"><article-title>GEO</article-title><ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/geo/"/></citation></ref><ref id="B15"><citation citation-type="other"><article-title>TargetScanS</article-title><ext-link ext-link-type="uri" xlink:href="http://www.targetscan.org/"/></citation></ref><ref id="B16"><citation citation-type="other"><article-title>PITA</article-title><ext-link ext-link-type="uri" xlink:href="http://genie.weizmann.ac.il/pubs/mir07/index.html"/></citation></ref><ref id="B17"><citation citation-type="other"><article-title>Ensembl</article-title><ext-link ext-link-type="uri" xlink:href="http://www.ensembl.org/"/></citation></ref><ref id="B18"><citation citation-type="other"><article-title>BioMart</article-title><ext-link ext-link-type="uri" xlink:href="http://www.biomart.org/"/></citation></ref><ref id="B19"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kertesz</surname><given-names>M</given-names></name><name><surname>Iovino</surname><given-names>N</given-names></name><name><surname>Unnerstall</surname><given-names>U</given-names></name><name><surname>Gaul</surname><given-names>U</given-names></name><name><surname>Segal</surname><given-names>E</given-names></name></person-group><article-title>The role of site accessibility in microRNA target recognition</article-title><source>Nat Genet</source><year>2007</year><volume>39</volume><fpage>1278</fpage><lpage>1284</lpage><pub-id pub-id-type="pmid">17893677</pub-id><pub-id pub-id-type="doi">10.1038/ng2135</pub-id></citation></ref><ref id="B20"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Baek</surname><given-names>D</given-names></name><name><surname>Vill&#x000e9;n</surname><given-names>J</given-names></name><name><surname>Shin</surname><given-names>C</given-names></name><name><surname>Camargo</surname><given-names>FD</given-names></name><name><surname>Gygi</surname><given-names>SP</given-names></name><name><surname>Bartel</surname><given-names>DP</given-names></name></person-group><article-title>The impact of microRNAs on protein output</article-title><source>Nature</source><year>2008</year><volume>455</volume><fpage>64</fpage><lpage>71</lpage><pub-id pub-id-type="pmid">18668037</pub-id><pub-id pub-id-type="doi">10.1038/nature07242</pub-id></citation></ref><ref id="B21"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Khanin</surname><given-names>R</given-names></name><name><surname>Vinciotti</surname><given-names>V</given-names></name></person-group><article-title>Computational modeling of post-transcriptional gene regulation by microRNAs</article-title><source>J Comput Biol</source><year>2008</year><volume>15</volume><fpage>305</fpage><lpage>316</lpage><pub-id pub-id-type="pmid">18333757</pub-id><pub-id pub-id-type="doi">10.1089/cmb.2007.0184</pub-id></citation></ref></ref-list></back></article>