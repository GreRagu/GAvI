<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd"><article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article" xml:lang="EN"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id><journal-id journal-id-type="publisher-id">bioinformatics</journal-id><journal-id journal-id-type="hwp">bioinfo</journal-id><journal-title>Bioinformatics</journal-title><issn pub-type="ppub">1367-4803</issn><issn pub-type="epub">1460-2059</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">19158162</article-id><article-id pub-id-type="pmc">2647824</article-id><article-id pub-id-type="doi">10.1093/bioinformatics/btp001</article-id><article-id pub-id-type="publisher-id">btp001</article-id><article-categories><subj-group subj-group-type="heading"><subject>Applications Note</subject><subj-group><subject>Sequence Analysis</subject></subj-group></subj-group></article-categories><title-group><article-title>Disperse&#x02014;a software system for design of selector probes for exon resequencing applications</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Stenberg</surname><given-names>J.</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref><xref ref-type="aff" rid="AFF1"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Zhang</surname><given-names>M.</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Ji</surname><given-names>H.</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref><xref ref-type="aff" rid="AFF1"><sup>3</sup></xref><xref ref-type="corresp" rid="COR1">*</xref></contrib></contrib-group><aff id="AFF1"><sup>1</sup>Department of Medicine, Division of Oncology, Stanford University School of Medicine, Clark Center W300, 318 Campus Drive, Stanford, CA 94305-5440, USA, <sup>2</sup>Department of Genetics and Pathology, Rudbeck Laboratory, Uppsala University, 751 85 Uppsala, Sweden and <sup>3</sup>Stanford Genome Technology Center, Stanford University, Palo Alto, CA 94304, USA</aff><author-notes><corresp id="COR1">*To whom correspondence should be addressed.</corresp><fn><p>Associate Editor: John Quackenbush</p></fn></author-notes><pub-date pub-type="ppub"><day>1</day><month>3</month><year>2009</year></pub-date><pub-date pub-type="epub"><day>21</day><month>1</month><year>2009</year></pub-date><pub-date pub-type="pmc-release"><day>21</day><month>1</month><year>2009</year></pub-date><volume>25</volume><issue>5</issue><fpage>666</fpage><lpage>667</lpage><history><date date-type="received"><day>27</day><month>4</month><year>2008</year></date><date date-type="rev-recd"><day>20</day><month>12</month><year>2008</year></date><date date-type="accepted"><day>30</day><month>12</month><year>2008</year></date></history><permissions><copyright-statement>&#x000a9; 2009 The Author(s)</copyright-statement><copyright-year>2009</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/"><p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">http://creativecommons.org/licenses/by-nc/2.0/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</p></license></permissions><abstract><p><bold>Summary:</bold>Selector probes enable the amplification of many selected regions of the genome in multiplex. Disperse is a software pipeline that automates the procedure of designing selector probes for exon resequencing applications.</p><p><bold>Availability:</bold>Software and documentation is available at <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.org/disperse">http://bioinformatics.org/disperse</ext-link></p><p><bold>Contact:</bold> <email>genomics_ji@stanford.edu</email></p></abstract></article-meta></front><body><p>The advent of next-generation sequencing systems has brought with it interesting new possibilities for genomic research (Shendure <italic>et al.</italic>, <xref ref-type="bibr" rid="B8">2004</xref>). One application is resequencing selected regions of the human genome. To accomplish this, methods for sample preparation are required that allow the selective enrichment of many arbitrary regions of the genome.</p><p>Several methods have been proposed to this end, such as hybridization of fragmented genomic DNA to oligonucleotide arrays, followed by washing and amplification of the retained material (Albert <italic>et al.</italic>, <xref ref-type="bibr" rid="B1">2007</xref>; Okou <italic>et al.</italic>, <xref ref-type="bibr" rid="B6">2007</xref>), and various probe-basedapproaches using PCR to achieve multiplex amplification (Dahl <italic>et al.</italic>, <xref ref-type="bibr" rid="B4">2007</xref>; Fredriksson <italic>et al.</italic>, <xref ref-type="bibr" rid="B5">2007</xref>; Porreca <italic>et al.</italic>, <xref ref-type="bibr" rid="B7">2007</xref>).</p><p>One of these approaches, the selector technique, allows amplification of arbitrarily selected restriction fragments in a single-primer pair PCR (Dahl <italic>et al.</italic>, <xref ref-type="bibr" rid="B3">2005</xref>). Selectors are oligonucleotide constructs that consist of a general sequence motif flanked by target-specific end sequences. Each selector targets a single restriction fragment and guides the circularization of this fragment by ligation, incorporating the general sequence motif into all fragments. Either the complete fragment is circularized, or a portion of the fragment is cleaved off using the endonucleolytic cleavage activity of a polymerase, and the 3&#x02032; part of the fragment is circularized. All targeted fragments are then amplified in multiplex. In previous work, we have demonstrated how this can be used for amplification of a large set of exons for subsequent resequencing using massively parallel pyrosequencing (Dahl <italic>et al.</italic>, <xref ref-type="bibr" rid="B4">2007</xref>).</p><p>Designing selector probes for exon resequencing of a set of genes has previously involved querying databases through web interfaces and running a series of command line utilities and interactive programs. This procedure has been time consuming and not readily reproducible, which prompted us to develop an integrated software system, Disperse, to facilitate this task.</p><p>Given a list of genes as HUGO gene symbols, and a set of design parameters, Disperse will generate a set of selector probe sequences, designed to select the largest possible portion of the targeted sequence. The design work is performed in a pipelined fashion, where a number of steps are executed sequentially, each step utilizes the results of previous steps. Each step is implemented as a Perl script or a command line Java program, and all steps can be executed in the order using a pipeline script. The design parameters and the input set of gene names are defined in text files, and the intermediate and final results are also stored as text files. The steps are as follows:<list list-type="order"><list-item><p>Determine coordinates for all coding regions of target genes by lookup in a local copy of CCDS data (<ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/projects/CCDS/">http://www.ncbi.nlm.nih.gov/projects/CCDS/</ext-link>). For genes not found, use NCBI eUtils (<ext-link ext-link-type="uri" xlink:href="http://eutils.ncbi.nlm.nih.gov/entrez/query/static/eutils_help.html">http://eutils.ncbi.nlm.nih.gov/entrez/query/static/eutils_help.html</ext-link>) to acquire GenBank (Benson <italic>et al.</italic>, <xref ref-type="bibr" rid="B2">2008</xref>) files and extract coding sequence coordinates. If any gene is not found in this step, halt the execution.</p></list-item><list-item><p>Define regions of interest (ROIs) by extending all coding regions by a number of bases on each flank, and merging overlapping ROIs.</p></list-item><list-item><p>Use the fastacmd program to retrieve reference sequence for ROIs and flanking regions from a local Blast database file (<ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/blast">http://www.ncbi.nlm.nih.gov/blast</ext-link>).</p></list-item><list-item><p>Extract SNP data for target regions from local SNP data file containing an extract of dbSNP (Sherry <italic>et al.</italic>, <xref ref-type="bibr" rid="B9">2001</xref>).</p></list-item><list-item><p>Collate sequence and SNP data by creating a copy of the target file with SNP data included using degeneracy symbols.</p></list-item><list-item><p>Select a reaction combination and generate a list of all accepted fragments for the combination using the PieceMaker API (application programming interface) (Stenberg <italic>et al.</italic>, <xref ref-type="bibr" rid="B10">2005a</xref>).</p></list-item><list-item><p>Select a subset of the generated fragments, retaining optimal coverage of the targeted regions using the PieceMaker API.</p></list-item><list-item><p>Generate an amplicon output file listing the circularized parts of the fragments of the selected subset, including their genomic coordinates.</p></list-item><list-item><p>Assemble selector probe sequences using the ProbeMaker (Stenberg <italic>et al.</italic>, <xref ref-type="bibr" rid="B11">2005b</xref>) command line interface.</p></list-item><list-item><p>Generate consolidated output files to provide overview of the design.</p></list-item></list>By default, all these steps are carried out when the pipeline script is executed. If manual intervention is required at some stage, e.g. to add a region of interest outside coding regions, the script can be set to run only a subset of the steps at a time.</p><p>The results of a design job are affected by the design parameters and the pool of restriction reactions to choose from. The design parameters determine, among other things, acceptable fragment lengths and the length of the ends of the selector probes. Reactions, which may contain one or more restriction enzymes, are picked from a pool of reactions defined by the user. The size and contents of this pool, and the maximum number of reactions allowed, will affect the design results as measured by the portion of the ROIs that is covered by selected fragments. The likelihood of finding acceptable fragments that cover all ROIs will increase with the size of the pool, and with the number of reactions picked. Also, the time required to generate and evaluate fragments will increase linearly with the number of reactions, while the time required to select a reaction combination will increase with the number of possible reaction combinations, which depends on both the number of reactions in the pool, and the maximum number of reactions allowed.</p><p>To demonstrate the performance of the software, we designed a set of selector probe sequences for the coding regions of the 206 genes on chromosome 18 present in the CCDS data. We used similar design settings as in our previous work (Dahl <italic>et al.</italic>, <xref ref-type="bibr" rid="B3">2005</xref>), allowing selected fragments of length 100&#x02013;200 bases, with a max flap length of 500. We allowed a combination of up to three reactions to be picked from a pool of 120 reactions. This design took 42 min on a 2.4 GHz Intel Quad-core processor computer running 64-bit openSUSE 10.3 with a 32-bit Java virtual machine, and resulted in 90.7% coverage of the targeted region using 5519 selector probes. The results are provided on the project web site.</p><p>To investigate the effects of using a smaller reaction pool, we performed the design using a randomly selected subset of 24 reactions from the pool of 120 reactions. This was completed in 8 min, yielding a slightly smaller coverage of 89.2%. Another run, picking up to six reactions from the smaller pool, resulted in 98.2% coverage and took 34 min. We estimate that a design allowing six reactions to be picked from the larger pool would yield close to full coverage, but would take several months to complete on a typical workstation. The conclusion is that for each design, it is reasonable to do some form of prescreening of enzymes and reactions, for example by analyzing the length distribution of generated fragments, before running the design pipeline.</p><p>Disperse depends on external data sources, programs and libraries. To our knowledge, all required data sources are freely available, as are the external dependencies, with the exception of the PieceMaker program (version 1.3.2) which is freely available for non-commercial users only. Instructions for acquiring PieceMaker are available on the Disperse web site. Disperse is written in Java and Perl, and has been tested on machines running openSUSE Linux, Gentoo Linux, Windows XP and MacOS X, using Perl 5 and Java 1.6.</p></body><back><ack><title>ACKNOWLEDGEMENTS</title><p>We wish to thank Magnus Isaksson, Department of Genetics and Pathology, Uppsala University, for assistance with software testing.</p><p><italic>Funding</italic>: National Institue of Health (5K08CA96879&#x02013;6, 2P01HG000205, 5R21CA128485 to <bold>H.P.J.</bold>); Reddere Foundation (to <bold>H.P.J.</bold>); Liu Bie Ju Cha and Family Fellowship in Cancer (to <bold>H.P.J.</bold>); Olle Engkvist Byggm&#x000e4;stare Foundation (to J.S.).</p><p><italic>Conflict of Interest</italic>: none declared.</p></ack><ref-list><title>REFERENCES</title><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Albert</surname><given-names>TJ</given-names></name><etal/></person-group><article-title>Direct selection of human genomic loci by microarray hybridization</article-title><source>Nat. Methods</source><year>2007</year><volume>4</volume><fpage>903</fpage><lpage>905</lpage><pub-id pub-id-type="pmid">17934467</pub-id></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Benson</surname><given-names>DA</given-names></name><etal/></person-group><article-title>GenBank</article-title><source>Nucleic Acids Res.</source><year>2008</year><volume>36</volume><fpage>D25</fpage><lpage>D30</lpage><pub-id pub-id-type="pmid">18073190</pub-id></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Dahl</surname><given-names>F</given-names></name><etal/></person-group><article-title>Multiplex amplification enabled by selective circularization of large sets of genomic DNA fragments</article-title><source>Nucleic Acids Res.</source><year>2005</year><volume>33</volume><fpage>e71</fpage><lpage>e77</lpage><pub-id pub-id-type="pmid">15860768</pub-id></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Dahl</surname><given-names>F</given-names></name><etal/></person-group><article-title>Multigene amplification and massively parallel sequencing for cancer mutation discovery</article-title><source>Proc. Natl Acad. Sci. USA</source><year>2007</year><volume>104</volume><fpage>9387</fpage><lpage>9392</lpage><pub-id pub-id-type="pmid">17517648</pub-id></citation></ref><ref id="B5"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Fredriksson</surname><given-names>S</given-names></name><etal/></person-group><article-title>Multiplex amplification of all coding sequences within 10 cancer genes by Gene-Collector</article-title><source>Nucleic Acids Res.</source><year>2007</year><volume>35</volume><fpage>e47</fpage><lpage>e53</lpage><pub-id pub-id-type="pmid">17317684</pub-id></citation></ref><ref id="B6"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Okou</surname><given-names>DT</given-names></name><etal/></person-group><article-title>Microarray-based genomic selection for high-throughput resequencing</article-title><source>Nat. Methods</source><year>2007</year><volume>4</volume><fpage>907</fpage><lpage>909</lpage><pub-id pub-id-type="pmid">17934469</pub-id></citation></ref><ref id="B7"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Porreca</surname><given-names>GJ</given-names></name><etal/></person-group><article-title>Multiplex amplification of large sets of human exons</article-title><source>Nat. Methods</source><year>2007</year><volume>4</volume><fpage>931</fpage><lpage>936</lpage><pub-id pub-id-type="pmid">17934468</pub-id></citation></ref><ref id="B8"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Shendure</surname><given-names>J</given-names></name><etal/></person-group><article-title>Advanced sequencing technologies: methods and goals</article-title><source>Nat. Rev. Genet.</source><year>2004</year><volume>5</volume><fpage>335</fpage><lpage>344</lpage><pub-id pub-id-type="pmid">15143316</pub-id></citation></ref><ref id="B9"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Sherry</surname><given-names>ST</given-names></name><etal/></person-group><article-title>dbSNP: the NCBI database of genetic variation</article-title><source>Nucleic Acids Res.</source><year>2001</year><volume>29</volume><fpage>308</fpage><lpage>311</lpage><pub-id pub-id-type="pmid">11125122</pub-id></citation></ref><ref id="B10"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Stenberg</surname><given-names>J</given-names></name><etal/></person-group><article-title>PieceMaker: selection of DNA fragments for selector-guided multiplex amplification</article-title><source>Nucleic Acids Res.</source><year>2005a</year><volume>33</volume><fpage>e72</fpage><lpage>e77</lpage><pub-id pub-id-type="pmid">15860769</pub-id></citation></ref><ref id="B11"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Stenberg</surname><given-names>J</given-names></name><etal/></person-group><article-title>ProbeMaker: an extensible framework for design of sets of oligonucleotide probes</article-title><source>BMC Bioinformatics</source><year>2005b</year><volume>6</volume><fpage>229</fpage><lpage>235</lpage><pub-id pub-id-type="pmid">16171527</pub-id></citation></ref></ref-list></back></article>