<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd"><article xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id><journal-title>BMC Bioinformatics</journal-title><issn pub-type="epub">1471-2105</issn><publisher><publisher-name>BioMed Central</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">19208176</article-id><article-id pub-id-type="pmc">2648800</article-id><article-id pub-id-type="publisher-id">1471-2105-10-S1-S71</article-id><article-id pub-id-type="doi">10.1186/1471-2105-10-S1-S71</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research</subject></subj-group></article-categories><title-group><article-title>CGTS: a site-clustering graph based tagSNP selection algorithm in genotype data</article-title></title-group><contrib-group><contrib id="A1" contrib-type="author"><name><surname>Wang</surname><given-names>Jun</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>wjking@hit.edu.cn</email></contrib><contrib id="A2" corresp="yes" contrib-type="author"><name><surname>Guo</surname><given-names>Mao-zu</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>maozuguo@hit.edu.en</email></contrib><contrib id="A3" contrib-type="author"><name><surname>Wang</surname><given-names>Chun-yu</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>chunyu@hit.edu.cn</email></contrib></contrib-group><aff id="I1"><label>1</label>Department of Computer Science and Engineering, Harbin Institute of Technology, Harbin 150001, PR China</aff><pub-date pub-type="collection"><year>2009</year></pub-date><pub-date pub-type="epub"><day>30</day><month>1</month><year>2009</year></pub-date><volume>10</volume><issue>Suppl 1</issue><supplement><named-content content-type="supplement-title">Selected papers from the Seventh Asia-Pacific Bioinformatics Conference (APBC 2009)</named-content><named-content content-type="supplement-editor">Michael Q Zhang, Michael S Waterman and Xuegong Zhang</named-content></supplement><fpage>S71</fpage><lpage>S71</lpage><ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/10/S1/S71"/><permissions><copyright-statement>Copyright &#x000a9; 2009 Wang et al; licensee BioMed Central Ltd.</copyright-statement><copyright-year>2009</copyright-year><copyright-holder>Wang et al; licensee BioMed Central Ltd.</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0"><p>This is an open access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p><!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>               Wang               Jun                              wjking@hit.edu.cn            </dc:author><dc:title>            CGTS: a site-clustering graph based tagSNP selection algorithm in genotype data         </dc:title><dc:date>2009</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 10(Suppl 1): S71-. (2009)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2009)10:Suppl 1&#x0003c;S71&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>--></license></permissions><abstract><sec><title>Background</title><p>Recent studies have shown genetic variation is the basis of the genome-wide disease association research. However, due to the high cost on genotyping large number of single nucleotide polymorphisms (SNPs), it is essential to choose a small subset of informative SNPs (tagSNPs), which are able to capture most variation in a population, to represent the rest SNPs. Several methods have been proposed to find the minimum set of tagSNPs, but most of them still have some disadvantages such as information loss and block-partition limit.</p></sec><sec><title>Results</title><p>This paper proposes a new hybrid method named CGTS which combines the ideas of the clustering and the graph algorithms to select tagSNPs on genotype data. This method aims to maximize the number of the discarding nontagSNPs in the given set. CGTS integrates the information of the LD association and the genotype diversity using the site graphs, discards redundant SNPs using the algorithm based on these graph structures. The clustering algorithm is used to reduce the running time of CGTS. The efficiency of the algorithm and quality of solutions are evaluated on biological data and the comparisons with three popular selecting methods are shown in the paper.</p></sec><sec><title>Conclusion</title><p>Our theoretical analysis and experimental results show that our algorithm CGTS is not only more efficient than other methods but also can be get higher accuracy in tagSNP selection.</p></sec></abstract><conference><conf-date>13&#x02013;16 January 2009</conf-date><conf-name>The Seventh Asia Pacific Bioinformatics Conference (APBC 2009)</conf-name><conf-loc>Beijing, China</conf-loc></conference></article-meta></front><body><sec><title>Background</title><p>Recent studies show that the abundance of single nucleotide polymorphisms (SNPs) and haplotypes can provide the most complete information for genome-wide association studies. Through the analysis of SNPs and haplotypes, most of the genetic variations among different people can be discovered. However, due to the excessive SNPs, which are about 10 million in the human genome [<xref ref-type="bibr" rid="B1">1</xref>-<xref ref-type="bibr" rid="B3">3</xref>], it is costly to genotyping and studying all SNPs in a candidate region for a large number of individuals. Thus the SNP selecting strategy is proposed to find only a subset of SNPs, which are called tagSNPs or tagging SNPs, to represent the whole SNP set. These tagSNPs have high linkage disequilibrium (LD) values with the rest SNPs [<xref ref-type="bibr" rid="B4">4</xref>], and the genetic variation information they have are enough to support the further study, such like disease association gene identification and population variation finding [<xref ref-type="bibr" rid="B5">5</xref>,<xref ref-type="bibr" rid="B6">6</xref>].</p><p>Several computational methods have been proposed to solve the tagSNP selecting problem. One common approach is based on the haplotype blocks partitions. These methods delimit the human genome into a set of discrete blocks, where only a small set of common haplotypes exist. These methods search the minimum subsets of tagSNPs from each block. The selected tagSNPs can distinguish each pair of common haplotypes in the block [<xref ref-type="bibr" rid="B7">7</xref>], or at least most of them [<xref ref-type="bibr" rid="B8">8</xref>-<xref ref-type="bibr" rid="B11">11</xref>]. However, there is no general solution on how the blocks are formed. And the lack of the inter-block association degrades the selection accuracy. The LD based methods use the pairwise associations of SNPs. TagSNPs are selected from the site clusters which consist of SNPs with strong LD association (measured by the pairwise LD value <italic>r</italic><sup>2</sup>) between each other [<xref ref-type="bibr" rid="B12">12</xref>-<xref ref-type="bibr" rid="B15">15</xref>]. These tagSNPs can represent associated SNPs in long distance without the block restriction, but may lose some important information contained in the rest SNPs and fail to distinguish all haplotypes in a LD cluster. Bafna. et al.[<xref ref-type="bibr" rid="B16">16</xref>] proposed a somewhat different approach, which assumes tagSNPs can reconstruct the remaining SNPs of an unknown sample with high accuracy. TagSNPs are selected by the measure called <italic>informativeness</italic>, which quantifies how well the unselected SNPs are predicted and the complete haplotypes are reconstructed through the selected SNPs [<xref ref-type="bibr" rid="B17">17</xref>-<xref ref-type="bibr" rid="B19">19</xref>]. These methods do not need prior block partitioning or limited haplotype diversity, but their performances are limited by the restrictions such as the fixed number of tagSNPs and the definitions of the <italic>informativeness</italic>.</p><p>In this paper, we present a new method based on clustering and graph, which is called CGTS, to select tagSNPs. Unlike the previous methods, our method integrates the information of the LD association and the genotype diversity using the site graphs without the information loss and the limit of block partition. Graph based algorithm uses the genotype information to discard the redundant SNPs, and does not need to define block or fix on the tagSNP number. To avoid high computational complexity of graph algorithm for large data, the clustering algorithm is proposed to process the genotype data. Compared to three existing popular methods, our method can give better performance in the experiments.</p></sec><sec><title>Results and discussion</title><sec><title>Implementation and data</title><p>We implemented our clustering and graph based tagSNP selection algorithm (CGTS) in C ++ and run the program on a PC with a 1.4 GHz CPU and 512 MB memory. A genotype phasing algorithm: PHASE [<xref ref-type="bibr" rid="B20">20</xref>] is used on the genotype data to obtain the haplotypes for other methods such as HapBlock and STAMPA compared in experiments.</p><p>Five public biological data were used for evaluation. These data include: the Hapmap data set of human chromosome 21 which has 20163 SNPs for 90 European persons [<xref ref-type="bibr" rid="B21">21</xref>]; the IBD 5q31 data set which have genotypes for 103 SNPs [<xref ref-type="bibr" rid="B8">8</xref>] from an inflammatory bowel disease study of father-mother-child trios, and we only used the children's data; three encode regions ENm013, ENr112 and ENr113 from HapMap [<xref ref-type="bibr" rid="B21">21</xref>], The number of SNPs genotyped in each region is 361, 412 and 515. All missing and ambiguous alleles are deleted from the test data.</p></sec><sec><title>Evaluation method</title><p>The evaluation method is based on the accuracy of non-tagging SNP prediction by the tagSNPs. The prediction accuracy is determined by cross-validation [<xref ref-type="bibr" rid="B22">22</xref>]. The data set is divided into ten subsets. The algorithm is run on the nine subsets to select a minimum set of tagSNPs. The nine subsets and the tagSNPs in the remaining set are used to predict the non-tagging SNPs in the remaining set.</p><p>The prediction of non-tagging SNPs is based on the assumption that given the genotype values of two SNPs, the probabilities of the values at any intermediate SNPs do not change by knowing the values of additional distal ones [<xref ref-type="bibr" rid="B18">18</xref>]. It means that for each non-tagging SNP <italic>p</italic>, the value of <italic>p </italic>in given genotype sequence can be identified by the value of two closest tagSNPs in the same sequence. Formally, this assumption can be stated as:</p><p><disp-formula id="bmcM1"><label>(1)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" name="1471-2105-10-S1-S71-i1" overflow="scroll">                     <mml:semantics>                        <mml:mtable columnalign="left">                           <mml:mtr>                              <mml:mtd>                                 <mml:mo>&#x02200;</mml:mo>                                 <mml:mi>p</mml:mi>                                 <mml:mo>:</mml:mo>                                 <mml:mi>a</mml:mi>                                 <mml:mo>&#x0003c;</mml:mo>                                 <mml:mi>p</mml:mi>                                 <mml:mo>&#x0003c;</mml:mo>                                 <mml:mi>b</mml:mi>                                 <mml:mo>,</mml:mo>                                 <mml:mo>&#x02200;</mml:mo>                                 <mml:mi>q</mml:mi>                                 <mml:mo>:</mml:mo>                                 <mml:mi>q</mml:mi>                                 <mml:mo>&#x0003c;</mml:mo>                                 <mml:mi>a</mml:mi>                                 <mml:mtext>&#x000a0;or&#x000a0;</mml:mtext>                                 <mml:mi>q</mml:mi>                                 <mml:mo>&#x0003e;</mml:mo>                                 <mml:mi>b</mml:mi>                                 <mml:mo>,</mml:mo>                                 <mml:mo>&#x02200;</mml:mo>                                 <mml:mi>v</mml:mi>                                 <mml:mo>&#x02208;</mml:mo>                                 <mml:mo>{</mml:mo>                                 <mml:mn>0</mml:mn>                                 <mml:mo>,</mml:mo>                                 <mml:mn>1</mml:mn>                                 <mml:mo>,</mml:mo>                                 <mml:mn>2</mml:mn>                                 <mml:mo>}</mml:mo>                                 <mml:mo>,</mml:mo>                                 <mml:mo>&#x02200;</mml:mo>                                 <mml:mi>i</mml:mi>                                 <mml:mo>:</mml:mo>                              </mml:mtd>                           </mml:mtr>                           <mml:mtr>                              <mml:mtd>                                 <mml:mtext>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;</mml:mtext>                                 <mml:mi>Pr</mml:mi>                                 <mml:mo>&#x02061;</mml:mo>                                 <mml:mo stretchy="false">[</mml:mo>                                 <mml:msub>                                    <mml:mi>g</mml:mi>                                    <mml:mrow>                                       <mml:mi>i</mml:mi>                                       <mml:mo>,</mml:mo>                                       <mml:mi>p</mml:mi>                                    </mml:mrow>                                 </mml:msub>                                 <mml:mo>=</mml:mo>                                 <mml:mi>v</mml:mi>                                 <mml:mo>|</mml:mo>                                 <mml:msub>                                    <mml:mi>g</mml:mi>                                    <mml:mrow>                                       <mml:mi>i</mml:mi>                                       <mml:mo>,</mml:mo>                                       <mml:mi>a</mml:mi>                                    </mml:mrow>                                 </mml:msub>                                 <mml:mo>,</mml:mo>                                 <mml:msub>                                    <mml:mi>g</mml:mi>                                    <mml:mrow>                                       <mml:mi>i</mml:mi>                                       <mml:mo>,</mml:mo>                                       <mml:mi>b</mml:mi>                                    </mml:mrow>                                 </mml:msub>                                 <mml:mo stretchy="false">]</mml:mo>                                 <mml:mo>&#x02248;</mml:mo>                                 <mml:mi>Pr</mml:mi>                                 <mml:mo>&#x02061;</mml:mo>                                 <mml:mo stretchy="false">[</mml:mo>                                 <mml:msub>                                    <mml:mi>g</mml:mi>                                    <mml:mrow>                                       <mml:mi>i</mml:mi>                                       <mml:mo>,</mml:mo>                                       <mml:mi>p</mml:mi>                                    </mml:mrow>                                 </mml:msub>                                 <mml:mo>=</mml:mo>                                 <mml:mi>v</mml:mi>                                 <mml:mo>|</mml:mo>                                 <mml:msub>                                    <mml:mi>g</mml:mi>                                    <mml:mrow>                                       <mml:mi>i</mml:mi>                                       <mml:mo>,</mml:mo>                                       <mml:mi>a</mml:mi>                                    </mml:mrow>                                 </mml:msub>                                 <mml:mo>,</mml:mo>                                 <mml:msub>                                    <mml:mi>g</mml:mi>                                    <mml:mrow>                                       <mml:mi>i</mml:mi>                                       <mml:mo>,</mml:mo>                                       <mml:mi>b</mml:mi>                                    </mml:mrow>                                 </mml:msub>                                 <mml:mo>,</mml:mo>                                 <mml:msub>                                    <mml:mi>g</mml:mi>                                    <mml:mrow>                                       <mml:mi>i</mml:mi>                                       <mml:mo>,</mml:mo>                                       <mml:mi>q</mml:mi>                                    </mml:mrow>                                 </mml:msub>                                 <mml:mo stretchy="false">]</mml:mo>                                 <mml:mtext>&#x000a0;</mml:mtext>                              </mml:mtd>                           </mml:mtr>                        </mml:mtable>                                             </mml:semantics>                  </mml:math></disp-formula></p><p><italic>For an unidentified p</italic>:</p><p><disp-formula id="bmcM2"><label>(2)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2" name="1471-2105-10-S1-S71-i2" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:msub>                              <mml:mi>g</mml:mi>                              <mml:mrow>                                 <mml:mi>i</mml:mi>                                 <mml:mo>,</mml:mo>                                 <mml:mi>p</mml:mi>                              </mml:mrow>                           </mml:msub>                           <mml:mo>=</mml:mo>                           <mml:munder>                              <mml:mrow>                                 <mml:mi>arg</mml:mi>                                 <mml:mo>&#x02061;</mml:mo>                                 <mml:mi>max</mml:mi>                                 <mml:mo>&#x02061;</mml:mo>                              </mml:mrow>                              <mml:mrow>                                 <mml:mi>v</mml:mi>                                 <mml:mo>&#x02208;</mml:mo>                                 <mml:mo>{</mml:mo>                                 <mml:mn>0</mml:mn>                                 <mml:mo>,</mml:mo>                                 <mml:mn>1</mml:mn>                                 <mml:mo>,</mml:mo>                                 <mml:mn>2</mml:mn>                                 <mml:mo>}</mml:mo>                              </mml:mrow>                           </mml:munder>                           <mml:mi>Pr</mml:mi>                           <mml:mo>&#x02061;</mml:mo>                           <mml:mo stretchy="false">[</mml:mo>                           <mml:msub>                              <mml:mi>g</mml:mi>                              <mml:mrow>                                 <mml:mi>i</mml:mi>                                 <mml:mo>,</mml:mo>                                 <mml:mi>p</mml:mi>                              </mml:mrow>                           </mml:msub>                           <mml:mo>=</mml:mo>                           <mml:mi>v</mml:mi>                           <mml:mo>|</mml:mo>                           <mml:msub>                              <mml:mi>g</mml:mi>                              <mml:mrow>                                 <mml:mi>i</mml:mi>                                 <mml:mo>,</mml:mo>                                 <mml:mi>a</mml:mi>                              </mml:mrow>                           </mml:msub>                           <mml:mo>,</mml:mo>                           <mml:mi/>                           <mml:msub>                              <mml:mi>g</mml:mi>                              <mml:mrow>                                 <mml:mi>i</mml:mi>                                 <mml:mo>,</mml:mo>                                 <mml:mi>b</mml:mi>                              </mml:mrow>                           </mml:msub>                           <mml:mo stretchy="false">]</mml:mo>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>where <italic>a, b </italic>are the two closest tagSNPs of <italic>p</italic>. <italic>g</italic><sub><italic>i</italic>, <italic>x </italic></sub>is the allele value of SNP <italic>x </italic>in genotype <italic>i. q </italic>is the tagSNP which is different from <italic>a, b</italic>.</p><p>The prediction precision of one subset is calculated by following equation:</p><p><disp-formula id="bmcM3"><label>(3)</label><italic>P</italic><sub><italic>i </italic></sub>= <italic>N</italic><sub><italic>c</italic></sub><italic>/N</italic><sub><italic>a </italic></sub></disp-formula></p><p><italic>N</italic><sub><italic>c </italic></sub>is the number of correctly predicted alleles and <italic>N</italic><sub><italic>a </italic></sub>is the number of all predicted alleles.</p><p>The accuracy of the algorithm can be computed as:</p><p><disp-formula id="bmcM4"><label>(4)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M3" name="1471-2105-10-S1-S71-i3" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:mi>P</mml:mi>                           <mml:mo>=</mml:mo>                           <mml:mstyle displaystyle="true">                              <mml:munderover>                                 <mml:mo>&#x02211;</mml:mo>                                 <mml:mrow>                                    <mml:mi>i</mml:mi>                                    <mml:mo>=</mml:mo>                                    <mml:mn>1</mml:mn>                                 </mml:mrow>                                 <mml:mi>d</mml:mi>                              </mml:munderover>                              <mml:mrow>                                 <mml:msub>                                    <mml:mi>P</mml:mi>                                    <mml:mi>i</mml:mi>                                 </mml:msub>                              </mml:mrow>                           </mml:mstyle>                           <mml:mo>/</mml:mo>                           <mml:mi>d</mml:mi>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p></sec><sec><title>Experimental results for trade-off test</title><p>In this subsection, we discuss the trade-off between efficiency and solutions of CGTS. CGTS uses a K nearest neighbour (KNN) clustering algorithm to partition the large SNP set and improve the efficiency of tagSNP selection. Different values of clustering size <italic>k </italic>result in different accuracy of the tagSNP selection. By increasing <italic>k</italic>, the solutions of CGTS can be improved but the efficiency may be sacrificed. The efficiency of CGTS is measured by the running time of CGTS with different <italic>k</italic>. The solution improved by different <italic>k </italic>is measured by the improved ratio of algorithm. The improved ratio is calculated by <italic>(N</italic><sub>50</sub>-<italic>N</italic><sub><italic>k</italic></sub><italic>)/N</italic><sub>50</sub>*100%, where <italic>N</italic><sub><italic>k </italic></sub>is the number of tagSNPs found by CGTS with clustering size <italic>k </italic>and 50 is the minimum value of <italic>k </italic>in CGTS. When <italic>k </italic>&#x0003c; 50, the information of SNP cluster is insufficient to find real tagSNPs.</p><p>The trade-off tests use the data of human chromosome 21. The 20163 SNPs are firstly divided into four subsets according to their physical distances. Each subset contains 5000 SNPs (the last has 5163 SNPs). CGTS run on four subsets separately and the final tagSNPs are the union of all results on these subsets.</p><p>Figure <xref ref-type="fig" rid="F1">1a, 1b</xref> plot the selected tagSNP number and the improved ratio of tagSNP number with respect to <italic>k</italic>. The <italic>x</italic>-axis stands for <italic>k </italic>and the <italic>y</italic>-axis stands for the selected tagSNP number and the improved ratio of CGTS on chromosome 21 dataset. The change of running time with increasing <italic>k </italic>is plotted on figure <xref ref-type="fig" rid="F1">1c</xref>. The <italic>x</italic>-axis stands for <italic>k </italic>and the <italic>y</italic>-axis stands for the total running time of CGTS on chromosome 21 dataset. The accuracy decrease is also plotted in figure <xref ref-type="fig" rid="F1">1d</xref>. The <italic>x</italic>-axis stands for <italic>k </italic>and the <italic>y</italic>-axis stands for the accuracy of CGTS on chromosome 21 dataset.</p><p>It can be observed that the improved ratio grows rapidly following the increase of <italic>k </italic>until <italic>k </italic>= 200, after that a more slow improvement is observed. It can be explained by the reduced LD association between SNPs and the stability of information contained by SNP cluster. The elapsed time also increases as <italic>k </italic>becomes large. It is because the sites in the graph increase and more sites need to be investigated with the selecting algorithm to obtain the tagSNPs. On the other hand, the accuracy of CGTS decreases as <italic>k </italic>becomes large. One intuitive reason is that the CGTS discards some real tagSNPs in the selecting step. Following the increase of <italic>k</italic>, the graphs in selecting step become larger and noisy sites also become more in the graph. These noisy sites decrease the LD associations in the graphs and the genotype diversity information they have may interfere with the tagSNP selection. Some real tagSNPs are discarded due to this interference and pseudo-tagSNPs may be put into the result.</p><fig position="float" id="F1"><label>Figure 1</label><caption><p>Performances of CGTS on different <italic>k</italic>.</p></caption><graphic xlink:href="1471-2105-10-S1-S71-1"/></fig><p>As a result, the parameter <italic>k </italic>of CGTS is best set to around 200 to obtain the best improvement in solutions, which still keeps the running time and accuracy within a reasonable period.</p></sec><sec><title>Experimental results on biological data</title><p>We compare our algorithm with three recent algorithms for tagSNP selection that are widely used: HapBlock [<xref ref-type="bibr" rid="B9">9</xref>], MLR-tagging [<xref ref-type="bibr" rid="B23">23</xref>], STAMPA [<xref ref-type="bibr" rid="B18">18</xref>] These three softwares represent three common methods for tagSNP selection. HapBlock bases on the block-partition, uses dynamic programming and EM subroutine to get the tagSNPs for each blocks. MLR-tagging uses a multiple linear regression approach and selects tagSNPs based on LD associations. STAMPA uses the SNP prediction accuracy for other SNPs to select tagSNPs. HapBlock and the training step of STAMPA use the haplotype data as input. MLR-tagging and STAMPA need to fix on the tagSNP number. Therefore, to compare the performance of our method to these methods, the tagSNP number of MLR and STAMPA are same as the tagSNP number obtained by our algorithm.</p><p>The comparison results of the three methods on the ENm013, ENr112, ENr113 and 5q31 are shown in Table <xref ref-type="table" rid="T1">1</xref> and figure <xref ref-type="fig" rid="F2">2</xref>. HapBlock gave no solution for ENr113 due to the memory overload.</p><table-wrap position="float" id="T1"><label>Table 1</label><caption><p>The comparison of the four methods</p></caption><table frame="hsides" rules="groups"><thead><tr><td></td><td align="center">Datasets</td><td align="center">Hap-Block</td><td align="center">MLR</td><td align="center">STAMPA</td><td align="center">CGTS</td></tr></thead><tbody><tr><td align="center">Number of tagSNPs</td><td align="center">5q31</td><td align="center">17</td><td align="center">8</td><td align="center">8</td><td align="center">8</td></tr><tr><td></td><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="center">ENm013</td><td align="center">15</td><td align="center">12</td><td align="center">12</td><td align="center">12</td></tr><tr><td></td><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="center">ENr112</td><td align="center">33</td><td align="center">20</td><td align="center">20</td><td align="center">20</td></tr><tr><td></td><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="center">ENr113</td><td align="center">~</td><td align="center">22</td><td align="center">22</td><td align="center">22</td></tr><tr><td colspan="6"><hr></hr></td></tr><tr><td align="center">Prediction accuracy</td><td align="center">5q31</td><td align="center">0.887</td><td align="center">0.912</td><td align="center">0.909</td><td align="center">0.922</td></tr><tr><td></td><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="center">ENm013</td><td align="center">0.757</td><td align="center">0.932</td><td align="center">0.901</td><td align="center">0.941</td></tr><tr><td></td><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="center">ENr112</td><td align="center">0.819</td><td align="center">0.947</td><td align="center">0.911</td><td align="center">0.949</td></tr><tr><td></td><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="center">ENr113</td><td align="center">~</td><td align="center">0.963</td><td align="center">0.913</td><td align="center">0.972</td></tr><tr><td colspan="6"><hr></hr></td></tr><tr><td align="center">Run time(s)</td><td align="center">5q31</td><td align="center">19100</td><td align="center">18</td><td align="center">122</td><td align="center">14</td></tr><tr><td></td><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="center">ENm013</td><td align="center">9207</td><td align="center">121</td><td align="center">85</td><td align="center">117</td></tr><tr><td></td><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="center">ENr112</td><td align="center">4405</td><td align="center">303</td><td align="center">108</td><td align="center">156</td></tr><tr><td></td><td colspan="5"><hr></hr></td></tr><tr><td></td><td align="center">ENr113</td><td align="center">~</td><td align="center">394</td><td align="center">133</td><td align="center">239</td></tr></tbody></table></table-wrap><fig position="float" id="F2"><label>Figure 2</label><caption><p>Performances of four selection methods.</p></caption><graphic xlink:href="1471-2105-10-S1-S71-2"/></fig><p>CGTS can perform better than HapBlock in prediction accuracy, get smaller tagSNP sets and use shorter times. It is because that there is no need to conduct block partition and the LD associations among SNPs are taken into consideration. CGTS is more accurate than MLR-tagging and STAMPA with the same number of selected tagSNPs. When the SNP size of the input data is increasing, STAMPA is asymptotically faster but CGTS is more accurate with an acceptable running time. It is due to the increasing iteration number of CGTS. Appropriate choosing of <italic>k </italic>can reduce the running time of CGTS. And we chose the <italic>k </italic>= 250 because the CGTS can obtain better improvement in solutions but still keep the running time and accuracy within a reasonable period on the given biological data.</p></sec></sec><sec><title>Conclusion</title><p>We investigate a novel hybrid method for SNP-tagging, which is called CGTS. The efficiency and solutions of SNP-tagging are improved by the combination of graph algorithm and site clustering in CGTS. As shown in the experimental results, our algorithm is able to get higher prediction accuracy than other approaches with the same size of tagSNPs, and outperforms these approaches in terms of the tagSNP size. Computational time required by CGTS is quite reasonable and can be tailored to available computing resources as needed. The key component of CGTS is the SNP graph model which integrates the information of the LD association and the genotype diversity. This model makes the SNP-tagging problem transform to a graph pruning problem. Using this model can avoid the information loss of SNPs. Our method does no need to fix the tagSNP number. The tagSNPs are not restricted to any bounded location, and can easily be applied to cover the whole chromosome. In the algorithm, multiple tagSNPs are used to represent each untagged SNPs, which further reduce the number of selected tagSNPs. Another advantage of CGTS is that it is amenable to further computational improvements. For example, parallel programming could be used to search tagSNPs in separate precincts, and further speed up the computation. In addition, CGTS can also be used on multi-allelic genotype data and haplotype data.</p></sec><sec sec-type="methods"><title>Methods</title><sec><title>SNP graph construction</title><p>We are given <italic>n </italic>genotype sequences, each genotype consist of <italic>m </italic>SNPs. If we assume there are no missing data in the sequences, the <italic>n </italic>sequences can form a <italic>n*m </italic>matrix <italic>M </italic>where rows are sequences and columns are SNPs, <italic>M</italic>[<italic>i</italic>, <italic>j</italic>] &#x02208; {0,1,2}, where 0 and 1 are homozygous types which represent the major and minor alleles, and 2 indicates the heterozygous type. A set <italic>G </italic>of genotype sequences distributes in the genome region of given populations follow a functions <italic>P</italic>(<italic>g</italic><sub><italic>i</italic></sub>). <italic>P</italic>(<italic>g</italic><sub><italic>i</italic></sub>) is the frequency of <italic>g</italic><sub><italic>i</italic></sub>, where <italic>g</italic><sub><italic>i </italic></sub>is a genotype in <italic>G</italic>. Like the haplotype, genotype sequences only have a few common patterns in a given genome region and these patterns can be distinguished by the tagSNPs. According to the observation made by several biological studies [<xref ref-type="bibr" rid="B12">12</xref>,<xref ref-type="bibr" rid="B14">14</xref>], tagSNPs usually have strong LD associations with other relative SNPs, except some special tagSNPs which have no association with other sites. We can represent each genotype by a vector <italic>Ti </italic>&#x02208; {0, 1, 2}<sup><italic>t</italic></sup>, where <italic>t </italic>is the size of tagSNP set in the genotype, and <italic>T</italic><sub><italic>i </italic></sub>belongs to <italic>i</italic>-th genotype. Thus, the tagSNPs at least have two important attributes: (1) <italic>T</italic><sub><italic>i </italic></sub>can identify common patterns of given genotype set, and the frequency of <italic>T</italic><sub><italic>i</italic></sub>: <italic>P</italic>(<italic>T</italic><sub><italic>i</italic></sub>) equals to the related <italic>P</italic>(<italic>g</italic><sub><italic>i</italic></sub>); (2) Each tagSNP has the strong LD value with its relative site set. Our goal is to find a minimum size set <italic>ST </italic>of tagSNPs for given genotype set, and these tagSNPs satisfy the two attributes described above. Formally, for a given set <italic>G </italic>and its matrix <italic>M</italic>, our objective is to find a set of tagSNPs <italic>ST </italic>with minimum size, and for each pair of common genotype pattern <italic>P</italic><sub><italic>i </italic></sub>and <italic>P</italic><sub><italic>j </italic></sub>in the <italic>G</italic>, these is a tagSNP <italic>s</italic><sub><italic>i </italic></sub>&#x02208; <italic>ST </italic>such that <italic>M</italic>[<italic>k</italic>, <italic>i</italic>] &#x02260; <italic>M</italic>[<italic>k</italic>, <italic>j</italic>]. In addition, the average LD value of <italic>s</italic><sub><italic>i </italic></sub>with its relative sites is highest in the related site set.</p><p>To achieve this goal, the main problem is how to represent the two features of tagSNPs and associate them to find the real tagSNPs. For a given genotype set <italic>G</italic>, all SNPs are distributed randomly as discrete sites in the space. If these sites are connected according to the genotype diversity information and the length of edge is set based on the LD value of two sites, the SNPs can form a graph. Through the analysis of several biological data, we discovered that the genetic-relative sites are bunched up in the graph and there are usually more sites around the real tagSNPs than the others except some special tagSNPs which have no association with any sites. That means it is feasible to construct a site graph to describe the SNP attributes and use a graph algorithm on it to find tagSNPs.</p><p>For a given genotype set <italic>G</italic>, the SNP set is <italic>S </italic>(|<italic>S</italic>| = <italic>m</italic>), and the LD value matrix is <italic>R</italic>. Each SNP has some information of the genotype diversity. Therefore, for each site <italic>s</italic><sub><italic>i</italic></sub>, we define a <italic>diversity set X</italic><sub><italic>i </italic></sub>= {<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M4" name="1471-2105-10-S1-S71-i4" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>i</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula>} to represent genotype diversity information for SNP site <italic>s</italic><sub><italic>i</italic></sub>. <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M5" name="1471-2105-10-S1-S71-i5" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula> = {<italic>x</italic><sub><italic>r</italic></sub><italic>| x</italic><sub><italic>r </italic></sub>= <italic>r</italic>, <italic>r </italic>&#x02208; [1, n]}, for <italic>j </italic>= 0,1,2, n is the size of the input genotype set size, <italic>r </italic>is the sequence number of a genotype in given set, <italic>x</italic><sub><italic>r </italic></sub>&#x02208; <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M6" name="1471-2105-10-S1-S71-i5" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula> means the <italic>r-th </italic>genotype have the value <italic>j </italic>at <italic>i</italic>-<italic>th </italic>SNP. If <italic>X</italic><sub><italic>i </italic></sub>has two &#x003a6; subsets, which means the SNP has only one value at all genotypes, we assume this site has no diversity information, and delete it before the graph construction. If two <italic>diversity sets X</italic><sub><italic>a </italic></sub>= <italic>X</italic><sub><italic>b</italic></sub>, we assume these two sites have the same diversity information, and these sites can combine to one site in the graph for their similar information. However, it is too complex to combine the whole SNP <italic>diversity sets </italic>and their LD associations in one graph. Thus, the <italic>X</italic><sub><italic>i </italic></sub>is divided to three subsets <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M7" name="1471-2105-10-S1-S71-i4" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>i</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula>, and three graphs are constructed for <italic>S</italic>. In each graph, only the information of one subset is represented. The selection results for three graphs are combined to get the final tagSNPs. For a given <italic>S </italic>and the <italic>diversity subset </italic><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M8" name="1471-2105-10-S1-S71-i5" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula> for each <italic>s</italic><sub><italic>i</italic></sub>, <italic>j </italic>&#x02208; {0, 1, 2}, the site graph <italic>G</italic><sub><italic>j</italic></sub>(<italic>V, E</italic>) can be constructed as following steps:</p><p>(1) The site set <italic>V</italic>: each site <italic>v</italic><sub><italic>i </italic></sub>of <italic>V </italic>represents a SNP <italic>s</italic><sub><italic>i </italic></sub>of <italic>S</italic>. Each <italic>v</italic><sub><italic>i </italic></sub>corresponds to the <italic>diversity subset </italic><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M9" name="1471-2105-10-S1-S71-i5" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula> of <italic>s</italic><sub><italic>i</italic></sub>. Each <italic>v</italic><sub><italic>i </italic></sub>has a site weight <italic>ws</italic><sub><italic>i </italic></sub>defined by the number of the sites similar to <italic>s</italic><sub><italic>i</italic></sub>. For two SNPs <italic>s</italic><sub><italic>a </italic></sub>and <italic>s</italic><sub><italic>b</italic></sub>, <italic>s</italic><sub><italic>a </italic></sub>is similar to <italic>s</italic><sub><italic>b </italic></sub>in graph <italic>G</italic><sub><italic>j </italic></sub>when <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M10" name="1471-2105-10-S1-S71-i6" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula>. <italic>ws</italic><sub><italic>i </italic></sub>is computed from two sets: the sites satisfy <italic>X</italic><sub><italic>a </italic></sub>= <italic>X</italic><sub><italic>b </italic></sub>and the sites satisfy <italic>X</italic><sub><italic>a </italic></sub>&#x02260; <italic>X</italic><sub><italic>b </italic></sub>and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M11" name="1471-2105-10-S1-S71-i6" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula>.</p><p>(2) The edge set <italic>E</italic>: tagSNPs can identify all or at least most of the common genotype patterns. The diversity information is represented by <italic>X</italic><sub><italic>i</italic></sub>. The associated SNPs have their <italic>X</italic><sub><italic>i </italic></sub>overlap with each other. The overlapping of <italic>X</italic><sub><italic>i </italic></sub>causes the redundancy. TagSNPs are selected to delete these redundancies. The directed edges between <italic>v</italic><sub><italic>i </italic></sub>are identified to describe these overlapping relationships. <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M12" name="1471-2105-10-S1-S71-i7" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula> and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M13" name="1471-2105-10-S1-S71-i8" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula> are <italic>diversity subsets </italic>of sites <italic>a</italic>, <italic>b</italic>. If <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M14" name="1471-2105-10-S1-S71-i9" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo>&#x02283;</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula>, there is a directed edge <italic>e </italic>from <italic>a </italic>to <italic>b</italic>. If <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M15" name="1471-2105-10-S1-S71-i10" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo>&#x02282;</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula>, there is a directed edge <italic>e </italic>from <italic>b </italic>to <italic>a</italic>. If <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M16" name="1471-2105-10-S1-S71-i11" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo>&#x02284;</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M17" name="1471-2105-10-S1-S71-i12" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo>&#x02284;</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M18" name="1471-2105-10-S1-S71-i13" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo>&#x02229;</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula>, there is bi-directed edge <italic>e </italic>between <italic>a </italic>and b. If <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M19" name="1471-2105-10-S1-S71-i13" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:msubsup><mml:mo>&#x02229;</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula>, there is no edge between them.</p><p>(3) The edge weight set <italic>W</italic>: for edge <italic>e </italic>between sites <italic>a </italic>and <italic>b</italic>, the edge weight <italic>w</italic><sub><italic>ab </italic></sub>= <italic>R </italic>[<italic>a</italic>, <italic>b</italic>]. <italic>R</italic>[<italic>a</italic>, <italic>b</italic>] is the LD value <italic>r</italic><sup>2 </sup>of the SNP <italic>a </italic>and the SNP <italic>b</italic>. The LD value <italic>r</italic><sup>2 </sup>is usually chosen to evaluate the correlation between two SNPs [<xref ref-type="bibr" rid="B24">24</xref>,<xref ref-type="bibr" rid="B25">25</xref>], and can be computed as follow:</p><p><disp-formula id="bmcM5"><label>(5)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M20" name="1471-2105-10-S1-S71-i14" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:msup>                              <mml:mi>r</mml:mi>                              <mml:mn>2</mml:mn>                           </mml:msup>                           <mml:mo>=</mml:mo>                           <mml:mstyle displaystyle="true">                              <mml:munderover>                                 <mml:mo>&#x02211;</mml:mo>                                 <mml:mrow>                                    <mml:mi>i</mml:mi>                                    <mml:mo>=</mml:mo>                                    <mml:mn>0</mml:mn>                                 </mml:mrow>                                 <mml:mi>m</mml:mi>                              </mml:munderover>                              <mml:mrow>                                 <mml:mstyle displaystyle="true">                                    <mml:munderover>                                       <mml:mo>&#x02211;</mml:mo>                                       <mml:mrow>                                          <mml:mi>j</mml:mi>                                          <mml:mo>=</mml:mo>                                          <mml:mn>0</mml:mn>                                       </mml:mrow>                                       <mml:mi>n</mml:mi>                                    </mml:munderover>                                    <mml:mrow>                                       <mml:msub>                                          <mml:mi>p</mml:mi>                                          <mml:mi>i</mml:mi>                                       </mml:msub>                                    </mml:mrow>                                 </mml:mstyle>                              </mml:mrow>                           </mml:mstyle>                           <mml:msub>                              <mml:mi>p</mml:mi>                              <mml:mi>j</mml:mi>                           </mml:msub>                           <mml:mrow>                              <mml:mo>|</mml:mo>                              <mml:mrow>                                 <mml:msubsup>                                    <mml:mi>D</mml:mi>                                    <mml:mrow>                                       <mml:mi>i</mml:mi>                                       <mml:mi>j</mml:mi>                                    </mml:mrow>                                    <mml:mo>'</mml:mo>                                 </mml:msubsup>                              </mml:mrow>                              <mml:mo>|</mml:mo>                           </mml:mrow>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p><disp-formula id="bmcM6"><label>(6)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M21" name="1471-2105-10-S1-S71-i15" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:msubsup>                              <mml:mi>D</mml:mi>                              <mml:mrow>                                 <mml:mi>i</mml:mi>                                 <mml:mi>j</mml:mi>                              </mml:mrow>                              <mml:mo>'</mml:mo>                           </mml:msubsup>                           <mml:mo>=</mml:mo>                           <mml:mrow>                              <mml:mo>{</mml:mo>                              <mml:mrow>                                 <mml:mtable columnalign="left">                                    <mml:mtr columnalign="left">                                       <mml:mtd columnalign="left">                                          <mml:mn>1</mml:mn>                                       </mml:mtd>                                       <mml:mtd columnalign="left">                                          <mml:mrow>                                             <mml:mtext>if&#x000a0;</mml:mtext>                                             <mml:msub>                                                <mml:mi>D</mml:mi>                                                <mml:mrow>                                                   <mml:mi>i</mml:mi>                                                   <mml:mi>j</mml:mi>                                                </mml:mrow>                                             </mml:msub>                                             <mml:mo>=</mml:mo>                                             <mml:mn>0</mml:mn>                                          </mml:mrow>                                       </mml:mtd>                                    </mml:mtr>                                    <mml:mtr columnalign="left">                                       <mml:mtd columnalign="left">                                          <mml:mrow>                                             <mml:mfrac>                                                <mml:mrow>                                                   <mml:msub>                                                      <mml:mi>D</mml:mi>                                                      <mml:mrow>                                                         <mml:mi>i</mml:mi>                                                         <mml:mi>j</mml:mi>                                                      </mml:mrow>                                                   </mml:msub>                                                </mml:mrow>                                                <mml:mrow>                                                   <mml:msub>                                                      <mml:mi>D</mml:mi>                                                      <mml:mrow>                                                         <mml:mi>max</mml:mi>                                                         <mml:mo>&#x02061;</mml:mo>                                                      </mml:mrow>                                                   </mml:msub>                                                </mml:mrow>                                             </mml:mfrac>                                          </mml:mrow>                                       </mml:mtd>                                       <mml:mtd columnalign="left">                                          <mml:mrow>                                             <mml:mtext>if&#x000a0;</mml:mtext>                                             <mml:msub>                                                <mml:mi>D</mml:mi>                                                <mml:mrow>                                                   <mml:mi>i</mml:mi>                                                   <mml:mi>j</mml:mi>                                                </mml:mrow>                                             </mml:msub>                                             <mml:mo>&#x02260;</mml:mo>                                             <mml:mn>0</mml:mn>                                          </mml:mrow>                                       </mml:mtd>                                    </mml:mtr>                                 </mml:mtable>                              </mml:mrow>                           </mml:mrow>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p><disp-formula id="bmcM7"><label>(7)</label><italic>D</italic><sub><italic>ij </italic></sub>= <italic>x</italic><sub><italic>ij </italic></sub>- <italic>p</italic><sub><italic>i</italic></sub><italic>p</italic><sub><italic>j</italic></sub></disp-formula></p><p><disp-formula id="bmcM8"><label>(8)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M22" name="1471-2105-10-S1-S71-i16" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:msub>                              <mml:mi>D</mml:mi>                              <mml:mrow>                                 <mml:mi>max</mml:mi>                                 <mml:mo>&#x02061;</mml:mo>                              </mml:mrow>                           </mml:msub>                           <mml:mo>=</mml:mo>                           <mml:mrow>                              <mml:mo>{</mml:mo>                              <mml:mrow>                                 <mml:mtable columnalign="left">                                    <mml:mtr columnalign="left">                                       <mml:mtd columnalign="left">                                          <mml:mrow>                                             <mml:mi>min</mml:mi>                                             <mml:mo>&#x02061;</mml:mo>                                             <mml:mtext>[</mml:mtext>                                             <mml:msub>                                                <mml:mi>p</mml:mi>                                                <mml:mi>i</mml:mi>                                             </mml:msub>                                             <mml:mo stretchy="false">(</mml:mo>                                             <mml:mn>1</mml:mn>                                             <mml:mo>&#x02212;</mml:mo>                                             <mml:msub>                                                <mml:mi>p</mml:mi>                                                <mml:mi>j</mml:mi>                                             </mml:msub>                                             <mml:mo stretchy="false">)</mml:mo>                                             <mml:mo>,</mml:mo>                                             <mml:msub>                                                <mml:mi>p</mml:mi>                                                <mml:mi>j</mml:mi>                                             </mml:msub>                                             <mml:mo stretchy="false">(</mml:mo>                                             <mml:mn>1</mml:mn>                                             <mml:mo>&#x02212;</mml:mo>                                             <mml:msub>                                                <mml:mi>p</mml:mi>                                                <mml:mi>i</mml:mi>                                             </mml:msub>                                             <mml:mo stretchy="false">)</mml:mo>                                             <mml:mtext>]</mml:mtext>                                          </mml:mrow>                                       </mml:mtd>                                       <mml:mtd columnalign="left">                                          <mml:mrow>                                             <mml:mtext>if</mml:mtext>                                             <mml:mi/>                                             <mml:msub>                                                <mml:mi>D</mml:mi>                                                <mml:mrow>                                                   <mml:mi>i</mml:mi>                                                   <mml:mi>j</mml:mi>                                                </mml:mrow>                                             </mml:msub>                                             <mml:mo>&#x0003e;</mml:mo>                                             <mml:mn>0</mml:mn>                                          </mml:mrow>                                       </mml:mtd>                                    </mml:mtr>                                    <mml:mtr columnalign="left">                                       <mml:mtd columnalign="left">                                          <mml:mrow>                                             <mml:mi>min</mml:mi>                                             <mml:mo>&#x02061;</mml:mo>                                             <mml:mtext>[</mml:mtext>                                             <mml:msub>                                                <mml:mi>p</mml:mi>                                                <mml:mi>i</mml:mi>                                             </mml:msub>                                             <mml:msub>                                                <mml:mi>p</mml:mi>                                                <mml:mi>j</mml:mi>                                             </mml:msub>                                             <mml:mo>,</mml:mo>                                             <mml:mo stretchy="false">(</mml:mo>                                             <mml:mn>1</mml:mn>                                             <mml:mo>&#x02212;</mml:mo>                                             <mml:msub>                                                <mml:mi>p</mml:mi>                                                <mml:mi>i</mml:mi>                                             </mml:msub>                                             <mml:mo stretchy="false">)</mml:mo>                                             <mml:mo stretchy="false">(</mml:mo>                                             <mml:mn>1</mml:mn>                                             <mml:mo>&#x02212;</mml:mo>                                             <mml:msub>                                                <mml:mi>p</mml:mi>                                                <mml:mi>j</mml:mi>                                             </mml:msub>                                             <mml:mo stretchy="false">)</mml:mo>                                             <mml:mtext>]</mml:mtext>                                          </mml:mrow>                                       </mml:mtd>                                       <mml:mtd columnalign="left">                                          <mml:mrow>                                             <mml:mtext>if</mml:mtext>                                             <mml:mi/>                                             <mml:msub>                                                <mml:mi>D</mml:mi>                                                <mml:mrow>                                                   <mml:mi>i</mml:mi>                                                   <mml:mi>j</mml:mi>                                                </mml:mrow>                                             </mml:msub>                                             <mml:mo>&#x0003c;</mml:mo>                                             <mml:mn>0</mml:mn>                                          </mml:mrow>                                       </mml:mtd>                                    </mml:mtr>                                 </mml:mtable>                              </mml:mrow>                           </mml:mrow>                           <mml:mtext>&#x000a0;&#x000a0;&#x000a0;&#x000a0;</mml:mtext>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>In these equations, <italic>p</italic><sub><italic>i </italic></sub>denotes the frequency of <italic>i-th </italic>allele for SNP <italic>a</italic>, <italic>p</italic><sub><italic>j </italic></sub>denotes the frequency of <italic>j-th </italic>allele for SNP <italic>b. m </italic>= <italic>n </italic>= 1, when the data are bi-allele haplotypes; <italic>m </italic>= <italic>n </italic>= 2 for the bi-allele genotype data. <italic>x</italic><sub><italic>ij </italic></sub>is the frequency of observing <italic>i-th </italic>allele for SNP <italic>a </italic>and <italic>j-th </italic>allele for SNP <italic>b </italic>together in the same genotype (haplotype) sequence.<italic>D</italic><sub><italic>max </italic></sub>is the maximum value of LD between the <italic>i-th </italic>allele for SNP <italic>a </italic>and <italic>j-th </italic>allele for SNP <italic>b</italic>. A <italic>r</italic><sup>2 </sup>value of 1 indicates the highest LD while 0 indicates no LD. The site graphs of a simple genotype data are shown in figure <xref ref-type="fig" rid="F3">3</xref>.</p><fig position="float" id="F3"><label>Figure 3</label><caption><p><bold>An example of SNP graphs</bold>. The dashed represents the bi-directed edge in the graph.</p></caption><graphic xlink:href="1471-2105-10-S1-S71-3"/></fig></sec><sec><title>TagSNP selection</title><p>In this section we present our selection algorithm. The algorithm is based on the observation that the SNPs with same genotype diversity information and high correlation are congregated into a subgraph through the construction of SNP graphs. The SNPs which have high probability to be tagSNPs usually have a subgraph with higher density. In order to reduce the space and time complexity, we are interested in discarding the redundant sites instead of finding the tagSNPs. Therefore, for each site graph <italic>G</italic><sub><italic>j</italic></sub>(<italic>V, E</italic>), the site which has the subgraph of the maximum density and the highest correlation is the top-priority site for tagSNP selection algorithm. For a given SNP set <italic>S </italic>and its site graph <italic>G</italic><sub><italic>j</italic></sub>(<italic>V, E</italic>) for <italic>diversity subset </italic><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M23" name="1471-2105-10-S1-S71-i5" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula>, the algorithm details are described as follow:</p><p>(1) Subgraph finding: in the graph <italic>G</italic><sub><italic>j</italic></sub>, a set of subgraphs <italic>N</italic>(<italic>v</italic><sub><italic>i</italic></sub>) is defined to represent a neighbourhood for each site <italic>v</italic><sub><italic>i</italic></sub>. It is induced by every vertex which has a directed edge from <italic>v</italic><sub><italic>i </italic></sub>to it or has an bi-directed edge between <italic>v</italic><sub><italic>i </italic></sub>and it, including <italic>v</italic><sub><italic>i </italic></sub>itself. In order to find the top-priority site and the relative subgraph, the measures for subgraph density and site correlations information are defined as follow:</p><p>For each <italic>N</italic>(<italic>v</italic><sub><italic>i</italic></sub>)(<italic>VI, EI</italic>), the subgraph density is:</p><p><disp-formula id="bmcM9"><label>(9)</label><italic>&#x003bb; </italic>= ||<italic>EI</italic>||/||<italic>VI</italic>||</disp-formula></p><p>where ||<italic>EI|</italic>| is the edge set size of the <italic>N</italic>(<italic>v</italic><sub><italic>i</italic></sub>) and ||<italic>VI</italic>|| is the vertex set size of the <italic>N</italic>(<italic>v</italic><sub><italic>i</italic></sub>). The information entropy of the subgraph is defined to describe the correlations information of each <italic>N</italic>(<italic>v</italic><sub><italic>i</italic></sub>) as:</p><p><disp-formula id="bmcM10"><label>(10)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M24" name="1471-2105-10-S1-S71-i17" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:mi>E</mml:mi>                           <mml:mi>P</mml:mi>                           <mml:mo>=</mml:mo>                           <mml:mi>&#x003b3;</mml:mi>                           <mml:mstyle displaystyle="true">                              <mml:munderover>                                 <mml:mo>&#x02211;</mml:mo>                                 <mml:mrow>                                    <mml:mi>i</mml:mi>                                    <mml:mo>=</mml:mo>                                    <mml:mn>1</mml:mn>                                 </mml:mrow>                                 <mml:mi>c</mml:mi>                              </mml:munderover>                              <mml:mrow>                                 <mml:mi>w</mml:mi>                                 <mml:msub>                                    <mml:mi>s</mml:mi>                                    <mml:mi>i</mml:mi>                                 </mml:msub>                                 <mml:mo>/</mml:mo>                                 <mml:mi>c</mml:mi>                                 <mml:mo>+</mml:mo>                              </mml:mrow>                           </mml:mstyle>                           <mml:mstyle displaystyle="true">                              <mml:munderover>                                 <mml:mo>&#x02211;</mml:mo>                                 <mml:mrow>                                    <mml:mi>i</mml:mi>                                    <mml:mo>=</mml:mo>                                    <mml:mn>1</mml:mn>                                 </mml:mrow>                                 <mml:mi>d</mml:mi>                              </mml:munderover>                              <mml:mrow>                                 <mml:mstyle displaystyle="true">                                    <mml:munderover>                                       <mml:mo>&#x02211;</mml:mo>                                       <mml:mrow>                                          <mml:mi>j</mml:mi>                                          <mml:mo>=</mml:mo>                                          <mml:mi>i</mml:mi>                                       </mml:mrow>                                       <mml:mi>d</mml:mi>                                    </mml:munderover>                                    <mml:mrow>                                       <mml:msub>                                          <mml:mi>w</mml:mi>                                          <mml:mrow>                                             <mml:mi>i</mml:mi>                                             <mml:mi>j</mml:mi>                                          </mml:mrow>                                       </mml:msub>                                    </mml:mrow>                                 </mml:mstyle>                              </mml:mrow>                           </mml:mstyle>                           <mml:mo>/</mml:mo>                           <mml:mi>d</mml:mi>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>where <italic>c </italic>is the number of sites in <italic>N(v</italic><sub><italic>i</italic></sub>) which is equal to ||<italic>VI</italic>||, <italic>d </italic>is the edge size of <italic>N(v</italic><sub><italic>i</italic></sub>) which is equal to ||<italic>EI|</italic>|, <italic>&#x003b3; </italic>is the normalization factor, <italic>ws</italic><sub><italic>i </italic></sub>is the weight for site <italic>v</italic><sub><italic>i </italic></sub>in the subgraph, <italic>w</italic><sub><italic>ij </italic></sub>is the weight of edge e<sub><italic>ij </italic></sub>for the site <italic>v</italic><sub><italic>i </italic></sub>and <italic>v</italic><sub><italic>j </italic></sub>in the subgraph. A high value of <italic>EP </italic>means high LD relations among the sites in the subgraph.</p><p>The top-priority site measure function is <italic>T</italic>(<italic>&#x003bb;</italic>, <italic>EP</italic>):</p><p><disp-formula id="bmcM11"><label>(11)</label><italic>T</italic>(<italic>&#x003bb;</italic>, <italic>EP</italic>) = <italic>&#x003b8;&#x003bb; </italic>+ <italic>EP</italic></disp-formula></p><p><italic>&#x003b8; </italic>is the normalization factor, and the top-priority site is the <italic>v</italic><sub><italic>i </italic></sub>which has the maximum <italic>T </italic>value.</p><p>(2) TagSNP candidate selection: for each chosen subgraph in the given <italic>G</italic><sub><italic>j</italic></sub>, the tagSNP candidates are selected by evaluating the information overlapping among the sites. A site which is not the candidate is deleted from the graph. The selection algorithm is described in figure <xref ref-type="fig" rid="F4">4</xref> and figure <xref ref-type="fig" rid="F5">5</xref></p><fig position="float" id="F4"><label>Figure 4</label><caption><p>TagSNP candidate selection algorithm.</p></caption><graphic xlink:href="1471-2105-10-S1-S71-4"/></fig><fig position="float" id="F5"><label>Figure 5</label><caption><p><italic>Divide </italic>function for TagSNP candidate selection algorithm.</p></caption><graphic xlink:href="1471-2105-10-S1-S71-5"/></fig><p>(3) Final tagSNP identification: after the tagSNP candidate set <italic>TC</italic><sub><italic>j </italic></sub>for each <italic>G</italic><sub><italic>j </italic></sub>are obtained, the final tagSNPs are identified by a voting mechanism. For a SNP <italic>s</italic><sub><italic>i</italic></sub>, a score function is defined as:</p><p><disp-formula id="bmcM12"><label>(12)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M25" name="1471-2105-10-S1-S71-i18" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:mtable columnalign="left">                              <mml:mtr columnalign="left">                                 <mml:mtd columnalign="left">                                    <mml:mrow>                                       <mml:mi>s</mml:mi>                                       <mml:mi>c</mml:mi>                                       <mml:mi>o</mml:mi>                                       <mml:mi>r</mml:mi>                                       <mml:mi>e</mml:mi>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:msub>                                          <mml:mi>s</mml:mi>                                          <mml:mi>i</mml:mi>                                       </mml:msub>                                       <mml:mo>,</mml:mo>                                       <mml:mi>T</mml:mi>                                       <mml:msub>                                          <mml:mi>C</mml:mi>                                          <mml:mn>1</mml:mn>                                       </mml:msub>                                       <mml:mo>,</mml:mo>                                       <mml:mi>T</mml:mi>                                       <mml:msub>                                          <mml:mi>C</mml:mi>                                          <mml:mn>2</mml:mn>                                       </mml:msub>                                       <mml:mo>,</mml:mo>                                       <mml:mi>T</mml:mi>                                       <mml:msub>                                          <mml:mi>C</mml:mi>                                          <mml:mn>3</mml:mn>                                       </mml:msub>                                       <mml:mo stretchy="false">)</mml:mo>                                       <mml:mo>=</mml:mo>                                       <mml:mi>f</mml:mi>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:msub>                                          <mml:mi>s</mml:mi>                                          <mml:mi>i</mml:mi>                                       </mml:msub>                                       <mml:mo>,</mml:mo>                                       <mml:mi>T</mml:mi>                                       <mml:msub>                                          <mml:mi>C</mml:mi>                                          <mml:mn>1</mml:mn>                                       </mml:msub>                                       <mml:mo stretchy="false">)</mml:mo>                                       <mml:mo>+</mml:mo>                                       <mml:mi>f</mml:mi>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:msub>                                          <mml:mi>s</mml:mi>                                          <mml:mi>i</mml:mi>                                       </mml:msub>                                       <mml:mo>,</mml:mo>                                       <mml:mi>T</mml:mi>                                       <mml:msub>                                          <mml:mi>C</mml:mi>                                          <mml:mn>2</mml:mn>                                       </mml:msub>                                       <mml:mo stretchy="false">)</mml:mo>                                       <mml:mo>+</mml:mo>                                       <mml:mi>f</mml:mi>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:msub>                                          <mml:mi>s</mml:mi>                                          <mml:mi>i</mml:mi>                                       </mml:msub>                                       <mml:mo>,</mml:mo>                                       <mml:mi>T</mml:mi>                                       <mml:msub>                                          <mml:mi>C</mml:mi>                                          <mml:mn>3</mml:mn>                                       </mml:msub>                                       <mml:mo stretchy="false">)</mml:mo>                                    </mml:mrow>                                 </mml:mtd>                              </mml:mtr>                              <mml:mtr columnalign="left">                                 <mml:mtd columnalign="left">                                    <mml:mrow>                                       <mml:mi>f</mml:mi>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:msub>                                          <mml:mi>s</mml:mi>                                          <mml:mi>i</mml:mi>                                       </mml:msub>                                       <mml:mo>,</mml:mo>                                       <mml:mi>T</mml:mi>                                       <mml:msub>                                          <mml:mi>C</mml:mi>                                          <mml:mi>i</mml:mi>                                       </mml:msub>                                       <mml:mo stretchy="false">)</mml:mo>                                       <mml:mo>=</mml:mo>                                       <mml:mrow>                                          <mml:mo>{</mml:mo>                                          <mml:mrow>                                             <mml:mtable columnalign="left">                                                <mml:mtr columnalign="left">                                                   <mml:mtd columnalign="left">                                                      <mml:mn>0</mml:mn>                                                   </mml:mtd>                                                   <mml:mtd columnalign="left">                                                      <mml:mrow>                                                         <mml:msub>                                                            <mml:mi>s</mml:mi>                                                            <mml:mi>i</mml:mi>                                                         </mml:msub>                                                         <mml:mo>&#x02209;</mml:mo>                                                         <mml:mi>T</mml:mi>                                                         <mml:msub>                                                            <mml:mi>C</mml:mi>                                                            <mml:mi>i</mml:mi>                                                         </mml:msub>                                                      </mml:mrow>                                                   </mml:mtd>                                                </mml:mtr>                                                <mml:mtr columnalign="left">                                                   <mml:mtd columnalign="left">                                                      <mml:mn>1</mml:mn>                                                   </mml:mtd>                                                   <mml:mtd columnalign="left">                                                      <mml:mrow>                                                         <mml:msub>                                                            <mml:mi>s</mml:mi>                                                            <mml:mi>i</mml:mi>                                                         </mml:msub>                                                         <mml:mo>&#x02208;</mml:mo>                                                         <mml:mi>T</mml:mi>                                                         <mml:msub>                                                            <mml:mi>C</mml:mi>                                                            <mml:mi>i</mml:mi>                                                         </mml:msub>                                                      </mml:mrow>                                                   </mml:mtd>                                                </mml:mtr>                                             </mml:mtable>                                          </mml:mrow>                                       </mml:mrow>                                    </mml:mrow>                                 </mml:mtd>                              </mml:mtr>                           </mml:mtable>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>The SNPs which have the highest score are decided to be real tagSNPs. The example of tagSNP selection is given in figure <xref ref-type="fig" rid="F6">6</xref>. The SNP data are the data used in the SNP graph construction section.</p><fig position="float" id="F6"><label>Figure 6</label><caption><p>An example of tagSNP selection.</p></caption><graphic xlink:href="1471-2105-10-S1-S71-6"/></fig></sec><sec><title>SNPs clustering</title><p>When the size of site graph is larger, the efficiency of our graph algorithm decreases, due to the time-consuming graph construction and tagSNP searching in low-relative SNPs. It is observed that the correlation between SNPs tends to decay as the physical distance increases [<xref ref-type="bibr" rid="B8">8</xref>,<xref ref-type="bibr" rid="B11">11</xref>,<xref ref-type="bibr" rid="B16">16</xref>,<xref ref-type="bibr" rid="B26">26</xref>]. That means there are many SNPs have no correlation or less correlation among them and the graph construction and tagSNP searching are unnecessary. Therefore, a clustering algorithm based on KNN is adopted to reduce the complexity of time and space for the input SNP set. The SNP groups which have higher correlation value are selected to construct graph, while the SNPs which have little correlation among them will not appear in the same graph. Due to the correlation decay, the SNP set is firstly divided into several subsets which have SNP number less than 5000. The KNN clustering algorithm is run on these subsets respectively.</p><p>In the KNN clustering algorithm, parameter <italic>k </italic>is an integer less than the number of SNPs in the input SNP set <italic>S</italic>, the correlation between two SNPs is represented by the LD value <italic>r</italic><sup>2 </sup>calculated through equation (5). In this algorithm, <italic>r</italic><sup>2 </sup>is directly related to the distance of two sites. <italic>r</italic><sup>2 </sup>= 1, the distance of two SNP sites is 0, and the two SNPs are considered identical and only one of them is retained. <italic>r</italic><sup>2 </sup>= 0, the distance of two sites is &#x0221e;. <italic>d</italic><sub><italic>k</italic></sub><sup><italic>i </italic></sup>is the LD value of SNP <italic>s</italic><sub><italic>i </italic></sub>and its <italic>k-th </italic>nearest neighbour. In each iteration, the SNP which has the highest <italic>d</italic><sub><italic>k</italic></sub><sup><italic>i </italic></sup>and its <italic>k </italic>nearest neighbours are deleted from <italic>S </italic>and selected to construct the SNP graphs for tagSNP selection. The obtained tagSNPs are put into the <italic>S </italic>and a new iteration is started. The obtained tagSNPs of each subset are combined to get the final set of tagSNPs.</p><p>The choice of <italic>k </italic>in the KNN algorithm controls the maximum information of the SNP set and the maximum size of site graphs. In general, different values of <italic>k </italic>result in different accuracy of the tagSNP selection. The bigger <italic>k</italic>, the smaller tagSNPs may be obtained, the more running time and space are cost. In the tagSNP selection, there are two possible ways to select <italic>k</italic>. (1) Select <italic>k </italic>so that the LD value between a chose SNP and its <italic>k</italic>-nearest neighbour is greater some threshold. (2) Select <italic>k </italic>to achieve desired prediction accuracy via cross-validation. The accuracy evaluation is given in more detail in the evaluation section. The trade-off test of <italic>k </italic>is discussed in result section.</p></sec><sec><title>Complexity analysis</title><p>For a SNP subset which has the site set size <italic>n </italic>andcontains <italic>m </italic>genotype sequences, the running time for LD value computing is <italic>O</italic>(<italic>m</italic>). Thus, the total running time of the clustering step is <italic>O</italic>(<italic>n</italic><sup>2</sup><italic>m</italic>). For each cluster which has (<italic>k</italic>+1) SNPs, constructing site graphs takes <italic>O</italic>(<italic>k</italic><sup>2</sup>). Finding subgraph needs <italic>O</italic>(<italic>k</italic>). Selecting tagSNP candidates from a subgraph which has <italic>t </italic>sites (0 &#x0003c;<italic>t </italic>&#x02264; <italic>k </italic>+ 1) takes <italic>O</italic>(<italic>t</italic><sup>2</sup>). Identifying the final tagSNPs needs <italic>O</italic>(<italic>k</italic>). The total running time of tagSNP selection is <italic>O</italic>(<italic>k</italic><sup>2</sup>+ <italic>kt</italic><sup>2</sup>+<italic>k</italic>). Since <italic>t </italic>&#x02264; <italic>k</italic>+1, the total running time for whole algorithm is <italic>O</italic>(<italic>n</italic><sup>2</sup><italic>m </italic>+ <italic>k</italic><sup>3</sup><italic>n</italic>/<italic>k</italic>) = <italic>O</italic>(<italic>n</italic>(<italic>nm </italic>+ <italic>k</italic><sup>2</sup>)) with taking into the account of the iteration number. In practice, the site set size <italic>n </italic>usuallyless than 5000 and <italic>k </italic>is controlled in interval [50, 500], the running time is less than expectation.</p></sec></sec><sec><title>Abbreviations</title><p>SNPs: single nucleotide polymorphisms; LD: linkage disequilibrium; KNN: K nearest neighbour.</p></sec><sec><title>Competing interests</title><p>The authors declare that they have no competing interests.</p></sec><sec><title>Authors' contributions</title><p>JW proposed the idea, designed the experiments and wrote the paper under the supervision of MG and YW. All authors read and approved the final manuscript.</p></sec></body><back><ack><sec><title>Acknowledgements</title><p>The work was supported in part by the Natural Science Foundation of China under Grant No. 60741001, No.60761001 and No.60871092, the China National 863 High Tech Program under Grant No. 2007AA01Z171, the Science Fund for Distinguished Young Scholars of Heilongjiang Province in China under Grant No. JC200611, and the Natural Science Foundation of Heilongjiang Province in China under Grant No. ZJG0705</p><p>This article has been published as part of <italic>BMC Bioinformatics </italic>Volume 10 Supplement 1, 2009: Proceedings of The Seventh Asia Pacific Bioinformatics Conference (APBC) 2009. The full contents of the supplement are available online at <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/10?issue=S1"/></p></sec></ack><ref-list><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kruglyak</surname><given-names>L</given-names></name><name><surname>Nickerson</surname><given-names>DA</given-names></name></person-group><article-title>Variation is the spice of life</article-title><source>Nat Genet</source><year>2001</year><volume>27</volume><fpage>234</fpage><lpage>236</lpage><pub-id pub-id-type="pmid">11242096</pub-id></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wheeler</surname><given-names>DL</given-names></name><name><surname>Church</surname><given-names>DM</given-names></name><name><surname>Federhen</surname><given-names>S</given-names></name><name><surname>Lash</surname><given-names>AE</given-names></name><name><surname>Madden</surname><given-names>TL</given-names></name><name><surname>Pontius</surname><given-names>JU</given-names></name><name><surname>Schuler</surname><given-names>GD</given-names></name><name><surname>Schriml</surname><given-names>LM</given-names></name><name><surname>Sequeira</surname><given-names>E</given-names></name><name><surname>Tatusova</surname><given-names>TA</given-names></name><name><surname>Wagner</surname><given-names>L</given-names></name></person-group><article-title>Database resources of the National Center for Biotechnology</article-title><source>Nucleic Acids Res</source><year>2003</year><volume>31</volume><fpage>28</fpage><lpage>33</lpage><pub-id pub-id-type="pmid">12519941</pub-id></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Sachidanandam</surname><given-names>R</given-names></name><name><surname>Weissman</surname><given-names>D</given-names></name><etal></etal></person-group><article-title>A map of human genome sequence variation containing 1.42 million single nucleotide polymorphisms</article-title><source>Nature</source><year>2001</year><volume>409</volume><fpage>928</fpage><lpage>933</lpage><pub-id pub-id-type="pmid">11237013</pub-id></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Dawson</surname><given-names>E</given-names></name><name><surname>Abecasis</surname><given-names>G</given-names></name><name><surname>Bumpstead</surname><given-names>S</given-names></name><name><surname>Chen</surname><given-names>Y</given-names></name><name><surname>Hunt</surname><given-names>S</given-names></name><name><surname>Beare</surname><given-names>D</given-names></name><name><surname>Pabila</surname><given-names>J</given-names></name><name><surname>Dibling</surname><given-names>T</given-names></name><name><surname>Tinsley</surname><given-names>E</given-names></name><name><surname>Kirby</surname><given-names>S</given-names></name><name><surname>Carter</surname><given-names>D</given-names></name><name><surname>Papaspyridonos</surname><given-names>M</given-names></name><name><surname>Livingstone</surname><given-names>S</given-names></name><name><surname>Ganske</surname><given-names>R</given-names></name><name><surname>Lomhmussaar</surname><given-names>E</given-names></name><name><surname>Zernant</surname><given-names>J</given-names></name><name><surname>Tonisson</surname><given-names>N</given-names></name><name><surname>Remm</surname><given-names>M</given-names></name><name><surname>Magi</surname><given-names>R</given-names></name><name><surname>Puurand</surname><given-names>J</given-names></name><name><surname>Vilo</surname><given-names>J</given-names></name><name><surname>Kurg</surname><given-names>A</given-names></name><name><surname>Rice</surname><given-names>K</given-names></name><name><surname>Deloukas</surname><given-names>P</given-names></name><name><surname>Mott</surname><given-names>R</given-names></name><name><surname>Metspalu</surname><given-names>A</given-names></name><name><surname>Bentley</surname><given-names>D</given-names></name><name><surname>Cardon</surname><given-names>L</given-names></name><name><surname>Dunham</surname><given-names>I</given-names></name></person-group><article-title>A first-generation linkage disequilibrium map of human chromosome 22</article-title><source>Nature</source><year>2002</year><volume>418</volume><fpage>544</fpage><lpage>548</lpage><pub-id pub-id-type="pmid">12110843</pub-id></citation></ref><ref id="B5"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Martin</surname><given-names>ER</given-names></name><name><surname>Lai</surname><given-names>EH</given-names></name><name><surname>Gilbert</surname><given-names>JR</given-names></name><name><surname>Rogala</surname><given-names>AR</given-names></name><name><surname>Afshari</surname><given-names>AJ</given-names></name><name><surname>Riley</surname><given-names>J</given-names></name><name><surname>Finch</surname><given-names>KL</given-names></name><name><surname>Stevens</surname><given-names>JF</given-names></name><name><surname>Livak</surname><given-names>KJ</given-names></name><name><surname>Slotterbeck</surname><given-names>BD</given-names></name><etal></etal></person-group><article-title>SNPing away at complex diseases: analysis of singlenucleotide polymorphisms around APOE in Alzheimer's disease</article-title><source>Am J Hum Genet</source><year>2000</year><volume>67</volume><fpage>383</fpage><lpage>394</lpage><pub-id pub-id-type="pmid">10869235</pub-id></citation></ref><ref id="B6"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Morris</surname><given-names>RW</given-names></name><name><surname>Kaplan</surname><given-names>NL</given-names></name></person-group><article-title>On the advantage of haplotype analysis in the presence of multiple disease susceptibility alleles</article-title><source>Genet Epidemiol</source><year>2002</year><volume>23</volume><fpage>221</fpage><lpage>233</lpage><pub-id pub-id-type="pmid">12384975</pub-id></citation></ref><ref id="B7"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Patil</surname><given-names>N</given-names></name><name><surname>Berno</surname><given-names>AJ</given-names></name><name><surname>Hinds</surname><given-names>DA</given-names></name><name><surname>Barrett</surname><given-names>WA</given-names></name><name><surname>Doshi</surname><given-names>JM</given-names></name><name><surname>Hacker</surname><given-names>CR</given-names></name><name><surname>Kautzer</surname><given-names>CR</given-names></name><name><surname>Lee</surname><given-names>DH</given-names></name><name><surname>Marjoribanks</surname><given-names>C</given-names></name><name><surname>McDonough</surname><given-names>DP</given-names></name><name><surname>Nguyen</surname><given-names>BT</given-names></name><name><surname>Norris</surname><given-names>MC</given-names></name><name><surname>Sheehan</surname><given-names>JB</given-names></name><name><surname>Shen</surname><given-names>N</given-names></name><name><surname>Stern</surname><given-names>D</given-names></name><name><surname>Stokowski</surname><given-names>RP</given-names></name><name><surname>Thomas</surname><given-names>DJ</given-names></name><name><surname>Trulson</surname><given-names>MO</given-names></name><name><surname>Vyas</surname><given-names>KR</given-names></name><name><surname>Frazer</surname><given-names>KA</given-names></name><name><surname>Fodor</surname><given-names>SP</given-names></name><name><surname>Cox</surname><given-names>DR</given-names></name></person-group><article-title>Blocks of limited haplotype diversity revealed by high-resolution scanning of human chromosome 21</article-title><source>Science</source><year>2001</year><volume>294</volume><fpage>1719</fpage><lpage>1723</lpage><pub-id pub-id-type="pmid">11721056</pub-id></citation></ref><ref id="B8"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Daly</surname><given-names>MJ</given-names></name><name><surname>Rioux</surname><given-names>JD</given-names></name><name><surname>Schaffner</surname><given-names>SF</given-names></name><name><surname>Hudson</surname><given-names>TJ</given-names></name><name><surname>Lander</surname><given-names>ES</given-names></name></person-group><article-title>High-resolution haplotype structure in the human genome</article-title><source>Nat Genet</source><year>2001</year><volume>29</volume><fpage>229</fpage><lpage>232</lpage><pub-id pub-id-type="pmid">11586305</pub-id></citation></ref><ref id="B9"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>K</given-names></name><name><surname>Qin</surname><given-names>Z</given-names></name><etal></etal></person-group><article-title>Haplotype block partitioning and tag SNP selection using genotype data and their applications to association studies</article-title><source>Genome Res</source><year>2004</year><volume>14</volume><fpage>908</fpage><lpage>916</lpage><pub-id pub-id-type="pmid">15078859</pub-id></citation></ref><ref id="B10"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Johnson</surname><given-names>G</given-names></name><name><surname>Esposito</surname><given-names>L</given-names></name><etal></etal></person-group><article-title>Haplotype tagging for the identification of common disease genes</article-title><source>Nat Genet</source><year>2001</year><volume>29</volume><fpage>233</fpage><lpage>237</lpage><pub-id pub-id-type="pmid">11586306</pub-id></citation></ref><ref id="B11"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Gabriel</surname><given-names>SB</given-names></name><name><surname>Schaffner</surname><given-names>SF</given-names></name><name><surname>Nguyen</surname><given-names>H</given-names></name><name><surname>Moore</surname><given-names>JM</given-names></name><etal></etal></person-group><article-title>The structure of haplotype blocks in the human genome</article-title><source>Science</source><year>2002</year><volume>296</volume><fpage>2225</fpage><lpage>2229</lpage><pub-id pub-id-type="pmid">12029063</pub-id></citation></ref><ref id="B12"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Carlson</surname><given-names>C</given-names></name><name><surname>Eberle</surname><given-names>MA</given-names></name><etal></etal></person-group><article-title>Selecting a maximally informative set of single-nucleotide polymorphisms for association analyses using linkage disequilibrium</article-title><source>Am J Hum Genet</source><year>2004</year><volume>74</volume><fpage>106</fpage><lpage>120</lpage><pub-id pub-id-type="pmid">14681826</pub-id></citation></ref><ref id="B13"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ao</surname><given-names>SI</given-names></name><name><surname>Kevin</surname><given-names>Yip</given-names></name><etal></etal></person-group><article-title>CLUSTAG: hierarchical clustering and graph methods for selecting tag SNPs</article-title><source>Bioinformatics</source><year>2005</year><volume>21</volume><fpage>1735</fpage><lpage>1736</lpage><pub-id pub-id-type="pmid">15585525</pub-id></citation></ref><ref id="B14"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Phuong</surname><given-names>TM</given-names></name><name><surname>Lin</surname><given-names>Zhen</given-names></name><name><surname>Altman</surname><given-names>RB</given-names></name></person-group><article-title>Choosing SNPs using feature selection</article-title><source>Proc IEEE Comput Syst Bioinform Conf</source><year>2005</year><fpage>301</fpage><lpage>309</lpage><pub-id pub-id-type="pmid">16447987</pub-id></citation></ref><ref id="B15"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>TF</given-names></name><etal></etal></person-group><article-title>Effective algorithms for tag SNP selection</article-title><source>J Bioinform Comput Biol</source><year>2005</year><volume>3</volume><fpage>1089</fpage><lpage>1106</lpage><pub-id pub-id-type="pmid">16278949</pub-id></citation></ref><ref id="B16"><citation citation-type="other"><person-group person-group-type="author"><name><surname>Bafna</surname><given-names>V</given-names></name><name><surname>Halldorsson</surname><given-names>BV</given-names></name><etal></etal></person-group><article-title>Haplotypes and Informative SNP Selection Algorithms: Don't Block Out Information</article-title><source>The Association for Computing Machinery</source><year>2003</year><fpage>19</fpage><lpage>27</lpage></citation></ref><ref id="B17"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Halld&#x000f3;rsson</surname><given-names>BV</given-names></name><name><surname>Bafna</surname><given-names>V</given-names></name><name><surname>Lippert</surname><given-names>R</given-names></name><name><surname>Schwartz</surname><given-names>R</given-names></name><name><surname>Vega</surname><given-names>FM</given-names></name><name><surname>Clark</surname><given-names>AG</given-names></name><name><surname>Istrail</surname><given-names>S</given-names></name></person-group><article-title>Optimal haplotype block-free selection of tagging SNPs for genome-wide association studies</article-title><source>Genome Res</source><year>2004</year><volume>14</volume><fpage>1633</fpage><lpage>1640</lpage><pub-id pub-id-type="pmid">15289481</pub-id></citation></ref><ref id="B18"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Halperin</surname><given-names>E</given-names></name><name><surname>Kimmel</surname><given-names>G</given-names></name><name><surname>Shamir</surname><given-names>R</given-names></name></person-group><article-title>Tag SNP selection in genotype data for maximizing SNP prediction accuracy</article-title><source>Bioinformatics</source><year>2005</year><volume>21</volume><fpage>i195</fpage><lpage>i203</lpage><pub-id pub-id-type="pmid">15961458</pub-id></citation></ref><ref id="B19"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>Phil Hyoun</given-names></name><name><surname>Shatkay</surname><given-names>Hagit</given-names></name></person-group><article-title>BNTagger: improved tagging SNP selection using Bayesian networks</article-title><source>Bioinformatics</source><year>2006</year><volume>22</volume><fpage>e211</fpage><lpage>e219</lpage><pub-id pub-id-type="pmid">16873474</pub-id></citation></ref><ref id="B20"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Stephens</surname><given-names>M</given-names></name><name><surname>Donnelly</surname><given-names>P</given-names></name></person-group><article-title>A comparison of Bayesian methods for haplotype reconstruction from population genotype data</article-title><source>Am J Hum Genet</source><year>2003</year><volume>73</volume><fpage>1162</fpage><lpage>1169</lpage><pub-id pub-id-type="pmid">14574645</pub-id></citation></ref><ref id="B21"><citation citation-type="other"><article-title>The Hapmap Genotype Database</article-title><ext-link ext-link-type="uri" xlink:href="http://www.hapmap.org/genotypes/?N=D"/></citation></ref><ref id="B22"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lin</surname><given-names>Z</given-names></name><name><surname>Altman</surname><given-names>R</given-names></name></person-group><article-title>Finding haplotype tagging SNP by use of principle component analysis</article-title><source>Am J Hum Genet</source><year>2004</year><volume>75</volume><fpage>850</fpage><lpage>861</lpage><pub-id pub-id-type="pmid">15389393</pub-id></citation></ref><ref id="B23"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>He</surname><given-names>W</given-names></name><name><surname>Zelikovsky</surname><given-names>A</given-names></name></person-group><article-title>MLR-tagging: informative SNP selection for unphased genotypes based on multiple linear regression</article-title><source>Bioinformatics</source><year>2006</year><volume>22</volume><fpage>2558</fpage><lpage>2561</lpage><pub-id pub-id-type="pmid">16895924</pub-id></citation></ref><ref id="B24"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Pritchard</surname><given-names>J</given-names></name></person-group><article-title>Linkage disequilibrium in humans: models and data</article-title><source>Am J Hum Genet</source><year>2001</year><volume>69</volume><fpage>1</fpage><lpage>14</lpage><pub-id pub-id-type="pmid">11410837</pub-id></citation></ref><ref id="B25"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Aulchenko</surname><given-names>Y</given-names></name><etal></etal></person-group><article-title>miLD and booLD programs for calculation and analysis of corrected linkage disequilibrium</article-title><source>Ann Hum Genet</source><year>2003</year><volume>67</volume><fpage>372</fpage><lpage>375</lpage><pub-id pub-id-type="pmid">12914572</pub-id></citation></ref><ref id="B26"><citation citation-type="other"><person-group person-group-type="author"><name><surname>Kimmel</surname><given-names>G</given-names></name><name><surname>Shamir</surname><given-names>R</given-names></name></person-group><article-title>Maximum likelihood resolution of multi-block genotypes</article-title><source>Proceedings of the Eighth Annual International Conference on Research in Computational Molecular Biology (RECOMB 04) The Association for Computing Machinery</source><year>2004</year><fpage>2</fpage><lpage>9</lpage></citation></ref></ref-list></back></article>