<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd"><article xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Proc</journal-id><journal-title>BMC Proceedings</journal-title><issn pub-type="epub">1753-6561</issn><publisher><publisher-name>BioMed Central</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">19091054</article-id><article-id pub-id-type="pmc">2648311</article-id><article-id pub-id-type="publisher-id">1753-6561-2-S4-S7</article-id><article-categories><subj-group subj-group-type="heading"><subject>Proceedings</subject></subj-group></article-categories><title-group><article-title>A marginalized variational bayesian approach to the analysis of array data</article-title></title-group><contrib-group><contrib id="A1" corresp="yes" contrib-type="author"><name><surname>Ying</surname><given-names>Yiming</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>enxyy@bris.ac.uk</email></contrib><contrib id="A2" contrib-type="author"><name><surname>Li</surname><given-names>Peng</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>enxpl@bris.ac.uk</email></contrib><contrib id="A3" contrib-type="author"><name><surname>Campbell</surname><given-names>Colin</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>C.Campbell@bris.ac.uk</email></contrib></contrib-group><aff id="I1"><label>1</label>Department of Engineering Mathematics, University of Bristol, Bristol BS8 1TR, UK</aff><pub-date pub-type="collection"><year>2008</year></pub-date><pub-date pub-type="epub"><day>17</day><month>12</month><year>2008</year></pub-date><volume>2</volume><issue>Suppl 4</issue><supplement><named-content content-type="supplement-title">Selected Proceedings of Machine Learning in Systems Biology: MLSB 2007</named-content><named-content content-type="supplement-editor">Florence d'Alch&#x000e9;-Buc and Louis Wehenkel</named-content></supplement><fpage>S7</fpage><lpage>S7</lpage><ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1753-6561/2/S4/S7"/><permissions><copyright-statement>Copyright &#x000a9; 2008 Ying et al; licensee BioMed Central Ltd.</copyright-statement><copyright-year>2008</copyright-year><copyright-holder>Ying et al; licensee BioMed Central Ltd.</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0"><p>This is an open access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p><!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>               Ying               Yiming                              enxyy@bris.ac.uk            </dc:author><dc:title>            A marginalized variational bayesian approach to the analysis of array data         </dc:title><dc:date>2008</dc:date><dcterms:bibliographicCitation>BMC Proceedings 2(Suppl 4): S7-. (2008)</dcterms:bibliographicCitation><dc:identifier type="sici">1753-6561(2008)2:Suppl 4&#x0003c;S7&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1753-6561</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>--></license></permissions><abstract><sec><title>Background</title><p>Bayesian unsupervised learning methods have many applications in the analysis of biological data. For example, for the cancer expression array datasets presented in this study, they can be used to resolve possible disease subtypes and to indicate statistically significant dysregulated genes within these subtypes.</p></sec><sec><title>Results</title><p>In this paper we outline a marginalized variational Bayesian inference method for unsupervised clustering. In this approach latent process variables and model parameters are allowed to be dependent. This is achieved by marginalizing the mixing Dirichlet variables and then performing inference in the reduced variable space. An iterative update procedure is proposed.</p></sec><sec><title>Conclusion</title><p>Theoretically and experimentally we show that the proposed algorithm gives a much better free-energy lower bound than a standard variational Bayesian approach. The algorithm is computationally efficient and its performance is demonstrated on two expression array data sets.</p></sec></abstract><conference><conf-date>24&#x02013;25 September 2007</conf-date><conf-name>Machine Learning in Systems Biology: MLSB 2007</conf-name><conf-loc>Evry, France</conf-loc></conference></article-meta></front><body><sec><title>Background</title><p>Unsupervised clustering methods from machine learning are very appropriate in extracting structure from biological data sets. There has been extensive work in this direction using hierarchical clustering analysis [<xref ref-type="bibr" rid="B1">1</xref>], <italic>K</italic>-Means clustering [<xref ref-type="bibr" rid="B2">2</xref>] and self-organizing maps [<xref ref-type="bibr" rid="B3">3</xref>]. Bayesian methods are an effective alternative since they provide a mechanism for inferring the number of clusters. They can easily incorporate priors which penalise over-complexed models which would fit to noise and they allow probabilistic confidence measures for cluster membership. In this paper, we focus on Bayesian models which use Dirichlet priors. Examples of these models include Latent Dirichlet Allocation [<xref ref-type="bibr" rid="B4">4</xref>] (LDA) for use in text modeling and Latent Process Decomposition (LPD) [<xref ref-type="bibr" rid="B5">5</xref>] for analysis of microarray gene expression datasets. One appealing feature of the latter models is that each data point can be stochastically associated with multiple clusters. One approach to model inference is to use methods such as Markov Chain Monte Carlo and Gibbs sampling. However, for the large datasets which occur in many biomedical applications these methods can be too slow for certain tasks such as model selection. This motivates our interest in computationally efficient variational inference methods [<xref ref-type="bibr" rid="B4">4</xref>-<xref ref-type="bibr" rid="B6">6</xref>].</p><p>Typically, these inference methods posit that all the latent variables and model parameters are <italic>independent </italic>of each other (i.e. a fully factorized family) which is a strong assumption. In this paper we propose and study an alternative inference method for LPD, which we call marginalized variational Bayesian (MVB). In this approach the latent process (cluster) variables and model parameters are allowed to be <italic>dependent </italic>on each other. As we will show in the next section, this assumption is made feasible by marginalizing the mixing Dirichlet variables, and then performing inference in the reduced variable space. This new approach to constructing an LPD model theoretically and experimentally provides much better free-energy lower bounds than standard a variational Bayes (VB) approach [<xref ref-type="bibr" rid="B6">6</xref>,<xref ref-type="bibr" rid="B7">7</xref>]. Moreover, the algorithm is computationally efficient and converges faster, as we demonstrate with experiments using expression array datasets.</p></sec><sec sec-type="methods"><title>Methods</title><sec><title>The LPD probabilistic model</title><p>We start by recalling LPD [<xref ref-type="bibr" rid="B5">5</xref>]. Let <italic>d </italic>index samples, <italic>g </italic>the genes (attributes) and <italic>k </italic>the soft clusters (samples are represented as combinatorial mixtures over clusters). The numbers of clusters, genes and samples are denoted <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" name="1753-6561-2-S4-S7-i1" overflow="scroll"><mml:semantics><mml:mi mathvariant="script">K</mml:mi></mml:semantics></mml:math></inline-formula>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2" name="1753-6561-2-S4-S7-i2" overflow="scroll"><mml:semantics><mml:mi mathvariant="script">G</mml:mi></mml:semantics></mml:math></inline-formula>, and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M3" name="1753-6561-2-S4-S7-i3" overflow="scroll"><mml:semantics><mml:mi mathvariant="script">D</mml:mi></mml:semantics></mml:math></inline-formula> respectively. For each data <italic>E</italic><sub><italic>d</italic></sub>, we have a multiple process (cluster) latent variable <italic>Z</italic><sub><italic>d </italic></sub>= {<italic>Z</italic><sub><italic>dg</italic></sub>: <italic>g </italic>= 1,..., <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M4" name="1753-6561-2-S4-S7-i2" overflow="scroll"><mml:semantics><mml:mi mathvariant="script">G</mml:mi></mml:semantics></mml:math></inline-formula>} where each <italic>Z</italic><sub><italic>dg </italic></sub>is a <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M5" name="1753-6561-2-S4-S7-i1" overflow="scroll"><mml:semantics><mml:mi mathvariant="script">K</mml:mi></mml:semantics></mml:math></inline-formula>-dimensional unit-basis vector, i.e., choosing cluster <italic>k </italic>is represented by <italic>Z</italic><sub><italic>dg</italic>, <italic>k </italic></sub>= 1 and <italic>Z</italic><sub><italic>dg</italic>, <italic>j </italic></sub>= 0 for <italic>j </italic>&#x02260; <italic>k</italic>, otherwise. Given the mixing coefficient <italic>&#x003b8;</italic><sub><italic>d</italic></sub>, the conditional distribution of <italic>Z</italic><sub><italic>d </italic></sub>is given by <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M6" name="1753-6561-2-S4-S7-i4" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msub><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msubsup><mml:mi>&#x003b8;</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow></mml:semantics></mml:math></inline-formula>. The conditional distributions, given the latent variables, is given by <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M7" name="1753-6561-2-S4-S7-i5" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>&#x003bc;</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x003b2;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msub><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>&#x003bc;</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>&#x003b2;</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:mrow></mml:semantics></mml:math></inline-formula>, where <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M8" name="1753-6561-2-S4-S7-i6" overflow="scroll"><mml:semantics><mml:mi mathvariant="script">N</mml:mi></mml:semantics></mml:math></inline-formula> is the Gaussian distribution with mean <italic>&#x003bc; </italic>and precision <italic>&#x003b2;</italic>.</p><p>Now we introduce conjugate priors over parameters <italic>&#x003b8;</italic>, <italic>&#x003bc;</italic>, <italic>&#x003b2;</italic>. Specifically, we choose <italic>p</italic>(<italic>&#x003b8;</italic><sub><italic>d</italic></sub>) = Dir(<italic>&#x003b8;</italic><sub><italic>d</italic></sub>|<italic>&#x003b1;</italic>), and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M9" name="1753-6561-2-S4-S7-i7" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003bc;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>~</mml:mo><mml:mstyle displaystyle="true"><mml:msub><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>&#x003bc;</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:semantics></mml:math></inline-formula>, and <italic>p</italic>(<italic>&#x003b2;</italic>) distributed as &#x0220f;<sub><italic>gk </italic></sub>&#x00393;(<italic>&#x003b2;</italic><sub><italic>gk</italic></sub>|<italic>a</italic><sub>0</sub>, <italic>b</italic><sub>0</sub>) where &#x00393; is defined by <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M10" name="1753-6561-2-S4-S7-i8" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>&#x00393;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>exp</mml:mi><mml:mo>&#x02061;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mi>x</mml:mi><mml:mi>b</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msubsup><mml:mi>&#x00393;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:semantics></mml:math></inline-formula>. We assume the data is i.i.d. and let &#x00398; = {<italic>&#x003bc;</italic>, <italic>&#x003b2; </italic>}. The joint distribution is given by</p><p><disp-formula id="bmcM1"><label>(1)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M11" name="1753-6561-2-S4-S7-i9" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:mi>p</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>E</mml:mi>                           <mml:mo>,</mml:mo>                           <mml:mi>&#x003b8;</mml:mi>                           <mml:mo>,</mml:mo>                           <mml:mi>Z</mml:mi>                           <mml:mo>|</mml:mo>                           <mml:mi>&#x00398;</mml:mi>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo>=</mml:mo>                           <mml:mstyle displaystyle="true">                              <mml:munder>                                 <mml:mo>&#x0220f;</mml:mo>                                 <mml:mi>d</mml:mi>                              </mml:munder>                              <mml:mrow>                                 <mml:mi>p</mml:mi>                                 <mml:mo stretchy="false">(</mml:mo>                                 <mml:msub>                                    <mml:mi>&#x003b8;</mml:mi>                                    <mml:mi>d</mml:mi>                                 </mml:msub>                                 <mml:mo stretchy="false">)</mml:mo>                                 <mml:mi>p</mml:mi>                                 <mml:mo stretchy="false">(</mml:mo>                                 <mml:msub>                                    <mml:mi>Z</mml:mi>                                    <mml:mi>d</mml:mi>                                 </mml:msub>                                 <mml:mo>|</mml:mo>                                 <mml:msub>                                    <mml:mi>&#x003b8;</mml:mi>                                    <mml:mi>d</mml:mi>                                 </mml:msub>                                 <mml:mo stretchy="false">)</mml:mo>                                 <mml:mi>p</mml:mi>                                 <mml:mo stretchy="false">(</mml:mo>                                 <mml:msub>                                    <mml:mi>E</mml:mi>                                    <mml:mi>d</mml:mi>                                 </mml:msub>                                 <mml:mo>|</mml:mo>                                 <mml:mi>&#x003bc;</mml:mi>                                 <mml:mo>,</mml:mo>                                 <mml:mi>&#x003b2;</mml:mi>                                 <mml:mo>,</mml:mo>                                 <mml:msub>                                    <mml:mi>Z</mml:mi>                                    <mml:mi>d</mml:mi>                                 </mml:msub>                                 <mml:mo stretchy="false">)</mml:mo>                              </mml:mrow>                           </mml:mstyle>                           <mml:mo>,</mml:mo>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>One can easily see that the marginal likelihood <italic>p</italic>(<italic>E</italic>|&#x00398;) is the same as that in [<xref ref-type="bibr" rid="B5">5</xref>]. It is important to note that, in standard Gaussian mixture models [<xref ref-type="bibr" rid="B8">8</xref>], each data point is only related with a <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M12" name="1753-6561-2-S4-S7-i1" overflow="scroll"><mml:semantics><mml:mi mathvariant="script">K</mml:mi></mml:semantics></mml:math></inline-formula>-dimensional latent variable which restricts the data to being in one cluster. Instead, in LPD each data point <italic>E</italic><sub><italic>d </italic></sub>is associated with multiple latent variables <italic>Z</italic><sub><italic>d </italic></sub>= {<italic>Z</italic><sub><italic>dg</italic></sub>: <italic>g </italic>= 1,..., <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M13" name="1753-6561-2-S4-S7-i2" overflow="scroll"><mml:semantics><mml:mi mathvariant="script">G</mml:mi></mml:semantics></mml:math></inline-formula>}, and thus <italic>E</italic><sub><italic>d </italic></sub>is stochastically associated with multiple clusters.</p></sec><sec><title>Marginalized variational Bayes</title><p>In this section we describe a marginalized variational Bayesian approach for LPD. The target of model inference is to compute the posterior distribution <italic>p</italic>(<italic>&#x003b8;</italic>, <italic>Z</italic>, &#x00398; |<italic>E</italic>) = <italic>p</italic>(<italic>E</italic>, <italic>&#x003b8;</italic>, <italic>Z</italic>|&#x00398;)<italic>p</italic>(&#x00398;)/<italic>p</italic>(<italic>E</italic>). Unfortunately, this involves computationally intensive estimation of the integral in the evidence <italic>p</italic>(<italic>E</italic>). Hence, we approximate the posterior distribution in a <italic>hypothesis family </italic>whose element are denoted by <italic>q</italic>(<italic>&#x003b8;</italic>, <italic>Z</italic>, &#x00398;).</p><p>The standard variational bayesian method [<xref ref-type="bibr" rid="B7">7</xref>,<xref ref-type="bibr" rid="B10">10</xref>] uses the equality:</p><p><disp-formula id="bmcM2"><label>(2)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M14" name="1753-6561-2-S4-S7-i10" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:mtable>                              <mml:mtr>                                 <mml:mtd>                                    <mml:mrow>                                       <mml:mi>log</mml:mi>                                       <mml:mo>&#x02061;</mml:mo>                                       <mml:mi>p</mml:mi>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:mi>E</mml:mi>                                       <mml:mo stretchy="false">)</mml:mo>                                       <mml:mo>=</mml:mo>                                       <mml:mi>log</mml:mi>                                       <mml:mo>&#x02061;</mml:mo>                                       <mml:mstyle displaystyle="true">                                          <mml:mrow>                                             <mml:mo>&#x0222b;</mml:mo>                                             <mml:mrow>                                                <mml:mstyle displaystyle="true">                                                   <mml:munder>                                                      <mml:mo>&#x02211;</mml:mo>                                                      <mml:mi>Z</mml:mi>                                                   </mml:munder>                                                   <mml:mrow>                                                      <mml:mi>p</mml:mi>                                                      <mml:mo stretchy="false">(</mml:mo>                                                      <mml:mi>E</mml:mi>                                                      <mml:mo>,</mml:mo>                                                      <mml:mi>&#x003b8;</mml:mi>                                                      <mml:mo>,</mml:mo>                                                      <mml:mi>Z</mml:mi>                                                      <mml:mo>,</mml:mo>                                                      <mml:mi>&#x00398;</mml:mi>                                                      <mml:mo stretchy="false">)</mml:mo>                                                      <mml:mi>d</mml:mi>                                                      <mml:mi>&#x003b8;</mml:mi>                                                      <mml:mi>d</mml:mi>                                                      <mml:mi>&#x00398;</mml:mi>                                                   </mml:mrow>                                                </mml:mstyle>                                             </mml:mrow>                                          </mml:mrow>                                       </mml:mstyle>                                    </mml:mrow>                                 </mml:mtd>                              </mml:mtr>                              <mml:mtr>                                 <mml:mtd>                                    <mml:mrow>                                       <mml:mo>=</mml:mo>                                       <mml:msub>                                          <mml:mi mathvariant="double-struck">E</mml:mi>                                          <mml:mi>q</mml:mi>                                       </mml:msub>                                       <mml:mrow>                                          <mml:mo>[</mml:mo>                                          <mml:mrow>                                             <mml:mi>log</mml:mi>                                             <mml:mo>&#x02061;</mml:mo>                                             <mml:mfrac>                                                <mml:mrow>                                                   <mml:mi>p</mml:mi>                                                   <mml:mo stretchy="false">(</mml:mo>                                                   <mml:mi>E</mml:mi>                                                   <mml:mo>,</mml:mo>                                                   <mml:mi>&#x003b8;</mml:mi>                                                   <mml:mo>,</mml:mo>                                                   <mml:mi>Z</mml:mi>                                                   <mml:mo>|</mml:mo>                                                   <mml:mi>&#x00398;</mml:mi>                                                   <mml:mo stretchy="false">)</mml:mo>                                                   <mml:mi>p</mml:mi>                                                   <mml:mo stretchy="false">(</mml:mo>                                                   <mml:mi>&#x00398;</mml:mi>                                                   <mml:mo stretchy="false">)</mml:mo>                                                </mml:mrow>                                                <mml:mrow>                                                   <mml:mi>q</mml:mi>                                                   <mml:mo stretchy="false">(</mml:mo>                                                   <mml:mi>&#x003b8;</mml:mi>                                                   <mml:mo>,</mml:mo>                                                   <mml:mi>Z</mml:mi>                                                   <mml:mo>,</mml:mo>                                                   <mml:mi>&#x00398;</mml:mi>                                                   <mml:mo stretchy="false">)</mml:mo>                                                </mml:mrow>                                             </mml:mfrac>                                          </mml:mrow>                                          <mml:mo>]</mml:mo>                                       </mml:mrow>                                       <mml:mo>+</mml:mo>                                       <mml:mtext>KL</mml:mtext>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:mi>q</mml:mi>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:mi>&#x003b8;</mml:mi>                                       <mml:mo>,</mml:mo>                                       <mml:mi>Z</mml:mi>                                       <mml:mo>,</mml:mo>                                       <mml:mi>&#x00398;</mml:mi>                                       <mml:mo stretchy="false">)</mml:mo>                                       <mml:mo>|</mml:mo>                                       <mml:mo>|</mml:mo>                                       <mml:mi>p</mml:mi>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:mi>&#x003b8;</mml:mi>                                       <mml:mo>,</mml:mo>                                       <mml:mi>Z</mml:mi>                                       <mml:mo>,</mml:mo>                                       <mml:mi>&#x00398;</mml:mi>                                       <mml:mo stretchy="false">)</mml:mo>                                       <mml:mo stretchy="false">)</mml:mo>                                       <mml:mo stretchy="false">)</mml:mo>                                       <mml:mo>.</mml:mo>                                    </mml:mrow>                                 </mml:mtd>                              </mml:mtr>                           </mml:mtable>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>Our optimization target is to maximize the free-energy: <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M15" name="1753-6561-2-S4-S7-i11" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi mathvariant="double-struck">E</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>&#x02061;</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x003b8;</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>&#x00398;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x00398;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003b8;</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x00398;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:semantics></mml:math></inline-formula> which, equivalently, minimizes the KL-divergence. One standard way is to choose the hypothesis family in a factorized form <italic>q</italic>(<italic>&#x003b8;</italic>, <italic>Z</italic>, &#x00398;) = <italic>q</italic>(<italic>&#x003b8;</italic>)<italic>q</italic>(<italic>Z</italic>)<italic>q</italic>(&#x00398;). In this setting, the free-energy lower bound (2) for the likelihood can be written as:</p><p><disp-formula id="bmcM3"><label>(3)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M16" name="1753-6561-2-S4-S7-i12" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:mi>&#x02112;</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>q</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>&#x003b8;</mml:mi>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo>,</mml:mo>                           <mml:mi>q</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>Z</mml:mi>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo>,</mml:mo>                           <mml:mi>q</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>&#x00398;</mml:mi>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo>:</mml:mo>                           <mml:mo>=</mml:mo>                           <mml:msub>                              <mml:mi mathvariant="double-struck">E</mml:mi>                              <mml:mi>q</mml:mi>                           </mml:msub>                           <mml:mrow>                              <mml:mo>[</mml:mo>                              <mml:mrow>                                 <mml:mi>log</mml:mi>                                 <mml:mo>&#x02061;</mml:mo>                                 <mml:mfrac>                                    <mml:mrow>                                       <mml:mi>p</mml:mi>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:mi>E</mml:mi>                                       <mml:mo>,</mml:mo>                                       <mml:mi>&#x003b8;</mml:mi>                                       <mml:mo>,</mml:mo>                                       <mml:mi>Z</mml:mi>                                       <mml:mo>|</mml:mo>                                       <mml:mi>&#x00398;</mml:mi>                                       <mml:mo stretchy="false">)</mml:mo>                                    </mml:mrow>                                    <mml:mrow>                                       <mml:mi>q</mml:mi>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:mi>&#x003b8;</mml:mi>                                       <mml:mo stretchy="false">)</mml:mo>                                       <mml:mo>,</mml:mo>                                       <mml:mi>q</mml:mi>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:mi>Z</mml:mi>                                       <mml:mo stretchy="false">)</mml:mo>                                    </mml:mrow>                                 </mml:mfrac>                              </mml:mrow>                              <mml:mo>]</mml:mo>                           </mml:mrow>                           <mml:mo>&#x02212;</mml:mo>                           <mml:mtext>KL</mml:mtext>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>q</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>&#x00398;</mml:mi>                           <mml:mo>|</mml:mo>                           <mml:mo>|</mml:mo>                           <mml:mi>p</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>&#x00398;</mml:mi>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo>.</mml:mo>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>In this paper we study an alternative approach motivated by [<xref ref-type="bibr" rid="B9">9</xref>] which only marginalizes the latent variable <italic>&#x003b8; </italic>and do variational inference only with respect to the leftover latent variable <italic>Z</italic>. In essence, we assume that the latent variables <italic>&#x003b8; </italic>can be dependent on <italic>Z</italic>, &#x00398; and the hypothesis family is chosen in the form of <italic>q</italic>(<italic>&#x003b8;</italic>, <italic>Z</italic>, &#x00398;) = <italic>q</italic>(<italic>&#x003b8; </italic>|<italic>Z</italic>, &#x00398;)<italic>q</italic>(<italic>Z</italic>)<italic>q</italic>(&#x00398;). Since the distribution <italic>q</italic>(<italic>&#x003b8;</italic>|<italic>Z</italic>, &#x00398;) is arbitrary, let it be equal to <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M17" name="1753-6561-2-S4-S7-i13" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003b8;</mml:mi><mml:mo>|</mml:mo><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x00398;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x003b8;</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x00398;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x00398;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:semantics></mml:math></inline-formula>. Putting this into equation (2) and observing that <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M18" name="1753-6561-2-S4-S7-i14" overflow="scroll"><mml:semantics><mml:mrow><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x003b8;</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>&#x00398;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003b8;</mml:mi><mml:mo>|</mml:mo><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x00398;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>&#x00398;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:semantics></mml:math></inline-formula> gives</p><p><disp-formula id="bmcM4"><label>(4)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M19" name="1753-6561-2-S4-S7-i15" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:mi>log</mml:mi>                           <mml:mo>&#x02061;</mml:mo>                           <mml:mi>p</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>E</mml:mi>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo>=</mml:mo>                           <mml:msub>                              <mml:mi mathvariant="double-struck">E</mml:mi>                              <mml:mi>q</mml:mi>                           </mml:msub>                           <mml:mo stretchy="false">[</mml:mo>                           <mml:mi>log</mml:mi>                           <mml:mo>&#x02061;</mml:mo>                           <mml:mfrac>                              <mml:mrow>                                 <mml:mi>p</mml:mi>                                 <mml:mo stretchy="false">(</mml:mo>                                 <mml:mi>E</mml:mi>                                 <mml:mo>,</mml:mo>                                 <mml:mi>Z</mml:mi>                                 <mml:mo>|</mml:mo>                                 <mml:mi>&#x00398;</mml:mi>                                 <mml:mo stretchy="false">)</mml:mo>                              </mml:mrow>                              <mml:mrow>                                 <mml:mi>q</mml:mi>                                 <mml:mo stretchy="false">(</mml:mo>                                 <mml:mi>Z</mml:mi>                                 <mml:mo stretchy="false">)</mml:mo>                              </mml:mrow>                           </mml:mfrac>                           <mml:mo stretchy="false">]</mml:mo>                           <mml:mo>&#x02212;</mml:mo>                           <mml:mtext>KL</mml:mtext>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>q</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>&#x00398;</mml:mi>                           <mml:mo>|</mml:mo>                           <mml:mo>|</mml:mo>                           <mml:mi>p</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>&#x00398;</mml:mi>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo>+</mml:mo>                           <mml:mtext>KL</mml:mtext>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>p</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>&#x003b8;</mml:mi>                           <mml:mo>|</mml:mo>                           <mml:mi>Z</mml:mi>                           <mml:mo>,</mml:mo>                           <mml:mi>&#x00398;</mml:mi>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mi>q</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>&#x00398;</mml:mi>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mi>q</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>Z</mml:mi>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo>|</mml:mo>                           <mml:mo>|</mml:mo>                           <mml:mi>p</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>&#x003b8;</mml:mi>                           <mml:mo>,</mml:mo>                           <mml:mi>Z</mml:mi>                           <mml:mo>,</mml:mo>                           <mml:mi>&#x00398;</mml:mi>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo stretchy="false">)</mml:mo>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p><disp-formula id="bmcM5"><label>(5)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M20" name="1753-6561-2-S4-S7-i16" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:mo>=</mml:mo>                           <mml:msub>                              <mml:mi mathvariant="double-struck">E</mml:mi>                              <mml:mi>q</mml:mi>                           </mml:msub>                           <mml:mo stretchy="false">[</mml:mo>                           <mml:mi>log</mml:mi>                           <mml:mo>&#x02061;</mml:mo>                           <mml:mfrac>                              <mml:mrow>                                 <mml:mi>p</mml:mi>                                 <mml:mo stretchy="false">(</mml:mo>                                 <mml:mi>E</mml:mi>                                 <mml:mo>,</mml:mo>                                 <mml:mi>Z</mml:mi>                                 <mml:mo>|</mml:mo>                                 <mml:mi>&#x00398;</mml:mi>                                 <mml:mo stretchy="false">)</mml:mo>                              </mml:mrow>                              <mml:mrow>                                 <mml:mi>q</mml:mi>                                 <mml:mo stretchy="false">(</mml:mo>                                 <mml:mi>Z</mml:mi>                                 <mml:mo stretchy="false">)</mml:mo>                              </mml:mrow>                           </mml:mfrac>                           <mml:mo stretchy="false">]</mml:mo>                           <mml:mo>&#x02212;</mml:mo>                           <mml:mtext>KL</mml:mtext>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>q</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>&#x00398;</mml:mi>                           <mml:mo>|</mml:mo>                           <mml:mo>|</mml:mo>                           <mml:mi>p</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>&#x00398;</mml:mi>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo>+</mml:mo>                           <mml:mtext>KL</mml:mtext>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>q</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>Z</mml:mi>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mi>q</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>&#x00398;</mml:mi>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo>|</mml:mo>                           <mml:mo>|</mml:mo>                           <mml:mi>p</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>Z</mml:mi>                           <mml:mo>,</mml:mo>                           <mml:mi>&#x00398;</mml:mi>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo>.</mml:mo>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>Therefore, it is sufficient to maximize the lower bound</p><p><disp-formula id="bmcM6"><label>(6)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M21" name="1753-6561-2-S4-S7-i17" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:mi>&#x02112;</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>q</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>Z</mml:mi>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo>,</mml:mo>                           <mml:mi>q</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>&#x00398;</mml:mi>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo>:</mml:mo>                           <mml:mo>=</mml:mo>                           <mml:msub>                              <mml:mi mathvariant="double-struck">E</mml:mi>                              <mml:mrow>                                 <mml:mi>q</mml:mi>                                 <mml:mo stretchy="false">(</mml:mo>                                 <mml:mi>&#x00398;</mml:mi>                                 <mml:mo stretchy="false">)</mml:mo>                                 <mml:mi>q</mml:mi>                                 <mml:mo stretchy="false">(</mml:mo>                                 <mml:mi>Z</mml:mi>                                 <mml:mo stretchy="false">)</mml:mo>                              </mml:mrow>                           </mml:msub>                           <mml:mrow>                              <mml:mo>[</mml:mo>                              <mml:mrow>                                 <mml:mi>log</mml:mi>                                 <mml:mo>&#x02061;</mml:mo>                                 <mml:mfrac>                                    <mml:mrow>                                       <mml:mi>p</mml:mi>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:mi>E</mml:mi>                                       <mml:mo>,</mml:mo>                                       <mml:mi>Z</mml:mi>                                       <mml:mo>|</mml:mo>                                       <mml:mi>&#x00398;</mml:mi>                                       <mml:mo stretchy="false">)</mml:mo>                                    </mml:mrow>                                    <mml:mrow>                                       <mml:mi>q</mml:mi>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:mi>Z</mml:mi>                                       <mml:mo stretchy="false">)</mml:mo>                                    </mml:mrow>                                 </mml:mfrac>                              </mml:mrow>                              <mml:mo>]</mml:mo>                           </mml:mrow>                           <mml:mo>&#x02212;</mml:mo>                           <mml:mtext>KL</mml:mtext>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>q</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>&#x00398;</mml:mi>                           <mml:mo>|</mml:mo>                           <mml:mo>|</mml:mo>                           <mml:mi>q</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>&#x00398;</mml:mi>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo>.</mml:mo>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>Observe that log <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M22" name="1753-6561-2-S4-S7-i18" overflow="scroll"><mml:semantics><mml:mrow><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>&#x00398;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>Z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>&#x02265;</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:mo>&#x0222b;</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003b8;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>log</mml:mi><mml:mo>&#x02061;</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x003b8;</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>&#x00398;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>Z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003b8;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:mstyle><mml:mi>d</mml:mi><mml:mi>&#x003b8;</mml:mi></mml:mrow></mml:semantics></mml:math></inline-formula>. Consequently, we see that</p><p><disp-formula id="bmcM7"><label>(7)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M23" name="1753-6561-2-S4-S7-i19" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:mi>&#x02112;</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>q</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>&#x003b8;</mml:mi>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo>,</mml:mo>                           <mml:mi>q</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>Z</mml:mi>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo>,</mml:mo>                           <mml:mi>q</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>&#x00398;</mml:mi>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo>&#x02264;</mml:mo>                           <mml:mi>&#x02112;</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>q</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>Z</mml:mi>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo>,</mml:mo>                           <mml:mi>q</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>&#x00398;</mml:mi>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo>.</mml:mo>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>As mentioned above, since <italic>&#x003b8; </italic>can be dependent on <italic>Z</italic>, &#x00398;, marginalized VB (MVB) yields a tighter lower bound for the likelihood than the standard VB approach in [<xref ref-type="bibr" rid="B6">6</xref>], thus potentially yielding better clustering results.</p></sec><sec><title>Model inference and learning</title><p>We now turn our attention to the derivation of updates for marginalized VB following the inference methodology [<xref ref-type="bibr" rid="B7">7</xref>,<xref ref-type="bibr" rid="B10">10</xref>]. For simplicity, let the posterior distribution <italic>q</italic>(<italic>Z</italic>), <italic>q</italic>(<italic>&#x003bc;</italic>), <italic>q</italic>(<italic>&#x003b2;</italic>) be indexed by parameters. Specifically, we assume that <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M24" name="1753-6561-2-S4-S7-i20" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>Z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msub><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow></mml:semantics></mml:math></inline-formula>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M25" name="1753-6561-2-S4-S7-i21" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003bc;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msub><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>&#x003bc;</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:semantics></mml:math></inline-formula>, and <italic>q</italic>(<italic>&#x003b2;</italic>) = &#x0220f;<sub><italic>g</italic>, <italic>k </italic></sub>&#x00393;(<italic>&#x003b2;</italic><sub><italic>gk</italic></sub>|<italic>a</italic><sub><italic>gk</italic></sub>, <italic>b</italic><sub><italic>gk</italic></sub>). Correspondingly, the free-energy lower bound &#x02112;(<italic>q</italic>(<italic>Z</italic>), <italic>q</italic>(&#x00398;)) in equation (6) becomes a variational functional over these parameters, and hence we use &#x02112;(<italic>R</italic>, <italic>&#x003bc;</italic>, <italic>&#x003b2;</italic>) later on. The model inference can be summarized by the following coordinate ascent updates.</p><p>Let <italic>Z</italic><sup>\<italic>dg </italic></sup>denote the random variables excluding <italic>Z</italic><sub><italic>dg</italic></sub>. For any <italic>d</italic>, <italic>g </italic>let &#x00398; and <italic>Z</italic><sup>\<italic>dg </italic></sup>be fixed, then we take the functional derivative of the free-energy &#x02112;(<italic>q</italic>(<italic>Z</italic>), <italic>q</italic>(&#x00398;)) w.r.t. <italic>q</italic>(<italic>Z</italic><sub><italic>dg</italic></sub>) and obtain the update:</p><p><disp-formula id="bmcM8"><label>(8)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M26" name="1753-6561-2-S4-S7-i23" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:mi>q</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:msub>                              <mml:mi>Z</mml:mi>                              <mml:mrow>                                 <mml:mi>d</mml:mi>                                 <mml:mi>g</mml:mi>                              </mml:mrow>                           </mml:msub>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo>&#x0221d;</mml:mo>                           <mml:mi>exp</mml:mi>                           <mml:mo>&#x02061;</mml:mo>                           <mml:mrow>                              <mml:mo>(</mml:mo>                              <mml:mrow>                                 <mml:msub>                                    <mml:mi mathvariant="double-struck">E</mml:mi>                                    <mml:mrow>                                       <mml:msup>                                          <mml:mi>q</mml:mi>                                          <mml:mrow>                                             <mml:mo>\</mml:mo>                                             <mml:mi>d</mml:mi>                                             <mml:mi>g</mml:mi>                                          </mml:mrow>                                       </mml:msup>                                    </mml:mrow>                                 </mml:msub>                                 <mml:mo stretchy="false">[</mml:mo>                                 <mml:mi>log</mml:mi>                                 <mml:mo>&#x02061;</mml:mo>                                 <mml:mi>p</mml:mi>                                 <mml:mo stretchy="false">(</mml:mo>                                 <mml:mi>E</mml:mi>                                 <mml:mo>,</mml:mo>                                 <mml:mi>Z</mml:mi>                                 <mml:mo>|</mml:mo>                                 <mml:mi>&#x00398;</mml:mi>                                 <mml:mo stretchy="false">)</mml:mo>                                 <mml:mo stretchy="false">]</mml:mo>                              </mml:mrow>                              <mml:mo>)</mml:mo>                           </mml:mrow>                           <mml:mo>.</mml:mo>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>For the updates for <italic>q</italic>(&#x00398;), we obtain</p><p><disp-formula id="bmcM9"><label>(9)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M27" name="1753-6561-2-S4-S7-i24" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:mi>q</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>&#x003bc;</mml:mi>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo>&#x0221d;</mml:mo>                           <mml:mi>p</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>&#x003bc;</mml:mi>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mi>exp</mml:mi>                           <mml:mo>&#x02061;</mml:mo>                           <mml:mrow>                              <mml:mo>(</mml:mo>                              <mml:mrow>                                 <mml:msub>                                    <mml:mi mathvariant="double-struck">E</mml:mi>                                    <mml:mrow>                                       <mml:msup>                                          <mml:mi>q</mml:mi>                                          <mml:mrow>                                             <mml:mo>\</mml:mo>                                             <mml:mi>&#x003bc;</mml:mi>                                          </mml:mrow>                                       </mml:msup>                                    </mml:mrow>                                 </mml:msub>                                 <mml:mo stretchy="false">[</mml:mo>                                 <mml:mi>log</mml:mi>                                 <mml:mo>&#x02061;</mml:mo>                                 <mml:mi>p</mml:mi>                                 <mml:mo stretchy="false">(</mml:mo>                                 <mml:mi>E</mml:mi>                                 <mml:mo>,</mml:mo>                                 <mml:mi>Z</mml:mi>                                 <mml:mo>|</mml:mo>                                 <mml:mi>&#x00398;</mml:mi>                                 <mml:mo stretchy="false">)</mml:mo>                                 <mml:mo stretchy="false">]</mml:mo>                              </mml:mrow>                              <mml:mo>)</mml:mo>                           </mml:mrow>                           <mml:mo>,</mml:mo>                           <mml:mi>q</mml:mi>                           <mml:mrow>                              <mml:mo>(</mml:mo>                              <mml:mi>&#x003b2;</mml:mi>                              <mml:mo>)</mml:mo>                           </mml:mrow>                           <mml:mo>&#x0221d;</mml:mo>                           <mml:mi>p</mml:mi>                           <mml:mrow>                              <mml:mo>(</mml:mo>                              <mml:mi>&#x003b2;</mml:mi>                              <mml:mo>)</mml:mo>                           </mml:mrow>                           <mml:mi>exp</mml:mi>                           <mml:mo>&#x02061;</mml:mo>                           <mml:mrow>                              <mml:mo>(</mml:mo>                              <mml:mrow>                                 <mml:msub>                                    <mml:mi mathvariant="double-struck">E</mml:mi>                                    <mml:mrow>                                       <mml:msup>                                          <mml:mi>q</mml:mi>                                          <mml:mrow>                                             <mml:mo>\</mml:mo>                                             <mml:mi>&#x003b2;</mml:mi>                                          </mml:mrow>                                       </mml:msup>                                    </mml:mrow>                                 </mml:msub>                                 <mml:mo stretchy="false">[</mml:mo>                                 <mml:mi>log</mml:mi>                                 <mml:mo>&#x02061;</mml:mo>                                 <mml:mi>p</mml:mi>                                 <mml:mo stretchy="false">(</mml:mo>                                 <mml:mi>E</mml:mi>                                 <mml:mo>,</mml:mo>                                 <mml:mi>Z</mml:mi>                                 <mml:mo>|</mml:mo>                                 <mml:mi>&#x00398;</mml:mi>                                 <mml:mo stretchy="false">)</mml:mo>                                 <mml:mo stretchy="false">]</mml:mo>                              </mml:mrow>                              <mml:mo>)</mml:mo>                           </mml:mrow>                           <mml:mo>.</mml:mo>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>Marginalizing out <italic>&#x003b8; </italic>in (1) yields</p><p><disp-formula id="bmcM10"><label>(10)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M28" name="1753-6561-2-S4-S7-i25" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:mtable columnalign="left">                              <mml:mtr columnalign="left">                                 <mml:mtd columnalign="left">                                    <mml:mrow>                                       <mml:mi>p</mml:mi>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:mi>E</mml:mi>                                       <mml:mo>,</mml:mo>                                       <mml:mi>Z</mml:mi>                                       <mml:mo>|</mml:mo>                                       <mml:mi>&#x00398;</mml:mi>                                       <mml:mo stretchy="false">)</mml:mo>                                       <mml:mo>:</mml:mo>                                       <mml:mo>=</mml:mo>                                       <mml:mstyle displaystyle="true">                                          <mml:msub>                                             <mml:mo>&#x0220f;</mml:mo>                                             <mml:mi>d</mml:mi>                                          </mml:msub>                                          <mml:mrow>                                             <mml:mrow>                                                <mml:mo>[</mml:mo>                                                <mml:mrow>                                                   <mml:mi>p</mml:mi>                                                   <mml:mo stretchy="false">(</mml:mo>                                                   <mml:msub>                                                      <mml:mi>Z</mml:mi>                                                      <mml:mi>d</mml:mi>                                                   </mml:msub>                                                   <mml:mo>|</mml:mo>                                                   <mml:mi>&#x003b1;</mml:mi>                                                   <mml:mo stretchy="false">)</mml:mo>                                                </mml:mrow>                                                <mml:mo>]</mml:mo>                                             </mml:mrow>                                             <mml:mi>p</mml:mi>                                             <mml:mo stretchy="false">(</mml:mo>                                             <mml:msub>                                                <mml:mi>E</mml:mi>                                                <mml:mi>d</mml:mi>                                             </mml:msub>                                             <mml:mo>|</mml:mo>                                             <mml:msub>                                                <mml:mi>&#x003bc;</mml:mi>                                                <mml:mi>d</mml:mi>                                             </mml:msub>                                             <mml:mo>,</mml:mo>                                             <mml:msub>                                                <mml:mi>&#x003b2;</mml:mi>                                                <mml:mi>d</mml:mi>                                             </mml:msub>                                             <mml:mo>,</mml:mo>                                             <mml:msub>                                                <mml:mi>Z</mml:mi>                                                <mml:mi>d</mml:mi>                                             </mml:msub>                                             <mml:mo stretchy="false">)</mml:mo>                                          </mml:mrow>                                       </mml:mstyle>                                    </mml:mrow>                                 </mml:mtd>                              </mml:mtr>                              <mml:mtr columnalign="left">                                 <mml:mtd columnalign="left">                                    <mml:mrow>                                       <mml:mo>=</mml:mo>                                       <mml:mstyle displaystyle="true">                                          <mml:msub>                                             <mml:mo>&#x0220f;</mml:mo>                                             <mml:mi>d</mml:mi>                                          </mml:msub>                                          <mml:mrow>                                             <mml:mrow>                                                <mml:mo>[</mml:mo>                                                <mml:mrow>                                                   <mml:mfrac>                                                      <mml:mrow>                                                         <mml:mi>&#x00393;</mml:mi>                                                         <mml:mo stretchy="false">(</mml:mo>                                                         <mml:mstyle displaystyle="true">                                                            <mml:msub>                                                               <mml:mo>&#x02211;</mml:mo>                                                               <mml:mi>k</mml:mi>                                                            </mml:msub>                                                            <mml:mrow>                                                               <mml:msub>                                                                  <mml:mi>&#x003b1;</mml:mi>                                                                  <mml:mi>k</mml:mi>                                                               </mml:msub>                                                            </mml:mrow>                                                         </mml:mstyle>                                                         <mml:mo stretchy="false">)</mml:mo>                                                      </mml:mrow>                                                      <mml:mrow>                                                         <mml:mi>&#x00393;</mml:mi>                                                         <mml:mo stretchy="false">(</mml:mo>                                                         <mml:mstyle displaystyle="true">                                                            <mml:msub>                                                               <mml:mo>&#x02211;</mml:mo>                                                               <mml:mi>k</mml:mi>                                                            </mml:msub>                                                            <mml:mrow>                                                               <mml:msub>                                                                  <mml:mi>&#x003b1;</mml:mi>                                                                  <mml:mi>k</mml:mi>                                                               </mml:msub>                                                            </mml:mrow>                                                         </mml:mstyle>                                                         <mml:mo>+</mml:mo>                                                         <mml:mstyle displaystyle="true">                                                            <mml:msub>                                                               <mml:mo>&#x02211;</mml:mo>                                                               <mml:mrow>                                                                  <mml:mi>g</mml:mi>                                                                  <mml:mo>,</mml:mo>                                                                  <mml:mi>k</mml:mi>                                                               </mml:mrow>                                                            </mml:msub>                                                            <mml:mrow>                                                               <mml:msub>                                                                  <mml:mi>Z</mml:mi>                                                                  <mml:mrow>                                                                     <mml:mi>d</mml:mi>                                                                     <mml:mi>g</mml:mi>                                                                     <mml:mo>,</mml:mo>                                                                     <mml:mi>k</mml:mi>                                                                  </mml:mrow>                                                               </mml:msub>                                                               <mml:mo stretchy="false">)</mml:mo>                                                            </mml:mrow>                                                         </mml:mstyle>                                                      </mml:mrow>                                                   </mml:mfrac>                                                   <mml:mstyle displaystyle="true">                                                      <mml:msub>                                                         <mml:mo>&#x0220f;</mml:mo>                                                         <mml:mi>k</mml:mi>                                                      </mml:msub>                                                      <mml:mrow>                                                         <mml:mfrac>                                                            <mml:mrow>                                                               <mml:mi>&#x00393;</mml:mi>                                                               <mml:mo stretchy="false">(</mml:mo>                                                               <mml:msub>                                                                  <mml:mi>&#x003b1;</mml:mi>                                                                  <mml:mi>k</mml:mi>                                                               </mml:msub>                                                               <mml:mo>+</mml:mo>                                                               <mml:mstyle displaystyle="true">                                                                  <mml:msub>                                                                     <mml:mo>&#x02211;</mml:mo>                                                                     <mml:mi>g</mml:mi>                                                                  </mml:msub>                                                                  <mml:mrow>                                                                     <mml:msub>                                                                        <mml:mi>Z</mml:mi>                                                                        <mml:mrow>                                                                           <mml:mi>d</mml:mi>                                                                           <mml:mi>g</mml:mi>                                                                           <mml:mo>,</mml:mo>                                                                           <mml:mi>k</mml:mi>                                                                        </mml:mrow>                                                                     </mml:msub>                                                                  </mml:mrow>                                                               </mml:mstyle>                                                               <mml:mo stretchy="false">)</mml:mo>                                                            </mml:mrow>                                                            <mml:mrow>                                                               <mml:mi>&#x00393;</mml:mi>                                                               <mml:mo stretchy="false">(</mml:mo>                                                               <mml:msub>                                                                  <mml:mi>&#x003b1;</mml:mi>                                                                  <mml:mi>k</mml:mi>                                                               </mml:msub>                                                               <mml:mo stretchy="false">)</mml:mo>                                                            </mml:mrow>                                                         </mml:mfrac>                                                      </mml:mrow>                                                   </mml:mstyle>                                                </mml:mrow>                                                <mml:mo>]</mml:mo>                                             </mml:mrow>                                             <mml:mstyle displaystyle="true">                                                <mml:msub>                                                   <mml:mo>&#x0220f;</mml:mo>                                                   <mml:mrow>                                                      <mml:mi>g</mml:mi>                                                      <mml:mo>,</mml:mo>                                                      <mml:mi>k</mml:mi>                                                   </mml:mrow>                                                </mml:msub>                                                <mml:mrow>                                                   <mml:msup>                                                      <mml:mrow>                                                         <mml:mrow>                                                            <mml:mo>[</mml:mo>                                                            <mml:mrow>                                                               <mml:mi mathvariant="script">N</mml:mi>                                                               <mml:mrow>                                                                  <mml:mo>(</mml:mo>                                                                  <mml:mrow>                                                                     <mml:msub>                                                                        <mml:mi>E</mml:mi>                                                                        <mml:mrow>                                                                           <mml:mi>d</mml:mi>                                                                           <mml:mi>g</mml:mi>                                                                        </mml:mrow>                                                                     </mml:msub>                                                                     <mml:mo>|</mml:mo>                                                                     <mml:msub>                                                                        <mml:mi>&#x003bc;</mml:mi>                                                                        <mml:mrow>                                                                           <mml:mi>g</mml:mi>                                                                           <mml:mi>k</mml:mi>                                                                        </mml:mrow>                                                                     </mml:msub>                                                                     <mml:mo>,</mml:mo>                                                                     <mml:msub>                                                                        <mml:mi>&#x003b2;</mml:mi>                                                                        <mml:mrow>                                                                           <mml:mi>g</mml:mi>                                                                           <mml:mi>k</mml:mi>                                                                        </mml:mrow>                                                                     </mml:msub>                                                                  </mml:mrow>                                                                  <mml:mo>)</mml:mo>                                                               </mml:mrow>                                                            </mml:mrow>                                                            <mml:mo>]</mml:mo>                                                         </mml:mrow>                                                      </mml:mrow>                                                      <mml:mrow>                                                         <mml:msub>                                                            <mml:mi>Z</mml:mi>                                                            <mml:mrow>                                                               <mml:mi>d</mml:mi>                                                               <mml:mi>g</mml:mi>                                                               <mml:mo>,</mml:mo>                                                               <mml:mi>k</mml:mi>                                                            </mml:mrow>                                                         </mml:msub>                                                      </mml:mrow>                                                   </mml:msup>                                                </mml:mrow>                                             </mml:mstyle>                                             <mml:mo>.</mml:mo>                                          </mml:mrow>                                       </mml:mstyle>                                    </mml:mrow>                                 </mml:mtd>                              </mml:mtr>                           </mml:mtable>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>Estimating the expectations of the log likelihoods in equations (8) and (9), we derive the variational EM-updates as follows. Details are postponed to the Appendix.</p><p><bold>E-step</bold>: using equation (8) and denoting the digamma function by <italic>&#x003c8;</italic>, we have</p><p><disp-formula id="bmcM11"><label>(11)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M29" name="1753-6561-2-S4-S7-i26" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:msub>                              <mml:mi>r</mml:mi>                              <mml:mrow>                                 <mml:mi>d</mml:mi>                                 <mml:mi>g</mml:mi>                                 <mml:mo>,</mml:mo>                                 <mml:mi>k</mml:mi>                              </mml:mrow>                           </mml:msub>                           <mml:mo>&#x0221d;</mml:mo>                           <mml:mfrac>                              <mml:mrow>                                 <mml:mo stretchy="false">(</mml:mo>                                 <mml:msub>                                    <mml:mi>&#x003b1;</mml:mi>                                    <mml:mi>k</mml:mi>                                 </mml:msub>                                 <mml:mo>+</mml:mo>                                 <mml:mstyle displaystyle="true">                                    <mml:msub>                                       <mml:mo>&#x02211;</mml:mo>                                       <mml:mrow>                                          <mml:msup>                                             <mml:mi>g</mml:mi>                                             <mml:mo>&#x02032;</mml:mo>                                          </mml:msup>                                          <mml:mo>&#x02260;</mml:mo>                                          <mml:mi>g</mml:mi>                                       </mml:mrow>                                    </mml:msub>                                    <mml:mrow>                                       <mml:msub>                                          <mml:mi>r</mml:mi>                                          <mml:mrow>                                             <mml:mi>d</mml:mi>                                             <mml:msup>                                                <mml:mi>g</mml:mi>                                                <mml:mo>&#x02032;</mml:mo>                                             </mml:msup>                                             <mml:mo>,</mml:mo>                                             <mml:mi>k</mml:mi>                                          </mml:mrow>                                       </mml:msub>                                    </mml:mrow>                                 </mml:mstyle>                                 <mml:mo stretchy="false">)</mml:mo>                                 <mml:mi>exp</mml:mi>                                 <mml:mo>&#x02061;</mml:mo>                                 <mml:mo stretchy="false">(</mml:mo>                                 <mml:msub>                                    <mml:mi>N</mml:mi>                                    <mml:mrow>                                       <mml:mi>d</mml:mi>                                       <mml:mi>g</mml:mi>                                       <mml:mo>,</mml:mo>                                       <mml:mi>k</mml:mi>                                    </mml:mrow>                                 </mml:msub>                                 <mml:mo stretchy="false">)</mml:mo>                              </mml:mrow>                              <mml:mrow>                                 <mml:mi>exp</mml:mi>                                 <mml:mo>&#x02061;</mml:mo>                                 <mml:mrow>                                    <mml:mo>(</mml:mo>                                    <mml:mrow>                                       <mml:mfrac>                                          <mml:mrow>                                             <mml:mstyle displaystyle="true">                                                <mml:msub>                                                   <mml:mo>&#x02211;</mml:mo>                                                   <mml:mrow>                                                      <mml:msup>                                                         <mml:mi>g</mml:mi>                                                         <mml:mo>&#x02032;</mml:mo>                                                      </mml:msup>                                                      <mml:mo>&#x02260;</mml:mo>                                                      <mml:mi>g</mml:mi>                                                   </mml:mrow>                                                </mml:msub>                                                <mml:mrow>                                                   <mml:msub>                                                      <mml:mi>r</mml:mi>                                                      <mml:mrow>                                                         <mml:mi>d</mml:mi>                                                         <mml:msup>                                                            <mml:mi>g</mml:mi>                                                            <mml:mo>&#x02032;</mml:mo>                                                         </mml:msup>                                                         <mml:mo>,</mml:mo>                                                         <mml:mi>k</mml:mi>                                                      </mml:mrow>                                                   </mml:msub>                                                </mml:mrow>                                             </mml:mstyle>                                             <mml:mo stretchy="false">(</mml:mo>                                             <mml:mn>1</mml:mn>                                             <mml:mo>&#x02212;</mml:mo>                                             <mml:msub>                                                <mml:mi>r</mml:mi>                                                <mml:mrow>                                                   <mml:mi>d</mml:mi>                                                   <mml:msup>                                                      <mml:mi>g</mml:mi>                                                      <mml:mo>&#x02032;</mml:mo>                                                   </mml:msup>                                                   <mml:mo>,</mml:mo>                                                   <mml:mi>k</mml:mi>                                                </mml:mrow>                                             </mml:msub>                                             <mml:mo stretchy="false">)</mml:mo>                                          </mml:mrow>                                          <mml:mrow>                                             <mml:mn>2</mml:mn>                                             <mml:msup>                                                <mml:mrow>                                                   <mml:mo stretchy="false">(</mml:mo>                                                   <mml:msub>                                                      <mml:mi>&#x003b1;</mml:mi>                                                      <mml:mi>k</mml:mi>                                                   </mml:msub>                                                   <mml:mo>+</mml:mo>                                                   <mml:mstyle displaystyle="true">                                                      <mml:msub>                                                         <mml:mo>&#x02211;</mml:mo>                                                         <mml:mrow>                                                            <mml:msup>                                                               <mml:mi>g</mml:mi>                                                               <mml:mo>&#x02032;</mml:mo>                                                            </mml:msup>                                                            <mml:mo>&#x02260;</mml:mo>                                                            <mml:mi>g</mml:mi>                                                         </mml:mrow>                                                      </mml:msub>                                                      <mml:mrow>                                                         <mml:msub>                                                            <mml:mi>r</mml:mi>                                                            <mml:mrow>                                                               <mml:mi>d</mml:mi>                                                               <mml:msup>                                                                  <mml:mi>g</mml:mi>                                                                  <mml:mo>&#x02032;</mml:mo>                                                               </mml:msup>                                                               <mml:mo>,</mml:mo>                                                               <mml:mi>k</mml:mi>                                                            </mml:mrow>                                                         </mml:msub>                                                      </mml:mrow>                                                   </mml:mstyle>                                                   <mml:mo stretchy="false">)</mml:mo>                                                </mml:mrow>                                                <mml:mn>2</mml:mn>                                             </mml:msup>                                          </mml:mrow>                                       </mml:mfrac>                                    </mml:mrow>                                    <mml:mo>)</mml:mo>                                 </mml:mrow>                              </mml:mrow>                           </mml:mfrac>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>where <italic>N</italic><sub><italic>dg</italic>, <italic>k </italic></sub>is given by 0.5(<italic>&#x003c8;</italic>(<italic>a</italic><sub><italic>gk</italic></sub>)+log <italic>b</italic><sub><italic>gk</italic></sub>) - 0.5<italic>a</italic><sub><italic>gk</italic></sub><italic>b</italic><sub><italic>gk</italic></sub>((<italic>E</italic><sub><italic>dg </italic></sub>- <italic>m</italic><sub><italic>gk</italic></sub>)<sup>2 </sup>+ <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M30" name="1753-6561-2-S4-S7-i27" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula>) and <italic>r</italic><sub><italic>dg</italic>, <italic>k </italic></sub>should be normalized to one over <italic>k</italic>.</p><p><bold>M-step</bold>: using equation (9):</p><p><disp-formula id="bmcM12"><label>(12)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M31" name="1753-6561-2-S4-S7-i28" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:msub>                              <mml:mi>v</mml:mi>                              <mml:mrow>                                 <mml:mi>g</mml:mi>                                 <mml:mi>k</mml:mi>                              </mml:mrow>                           </mml:msub>                           <mml:mo>=</mml:mo>                           <mml:msub>                              <mml:mi>v</mml:mi>                              <mml:mn>0</mml:mn>                           </mml:msub>                           <mml:mo>+</mml:mo>                           <mml:msub>                              <mml:mi>a</mml:mi>                              <mml:mrow>                                 <mml:mi>g</mml:mi>                                 <mml:mi>k</mml:mi>                              </mml:mrow>                           </mml:msub>                           <mml:msub>                              <mml:mi>b</mml:mi>                              <mml:mrow>                                 <mml:mi>g</mml:mi>                                 <mml:mi>k</mml:mi>                              </mml:mrow>                           </mml:msub>                           <mml:mstyle displaystyle="true">                              <mml:munder>                                 <mml:mo>&#x02211;</mml:mo>                                 <mml:mi>d</mml:mi>                              </mml:munder>                              <mml:mrow>                                 <mml:msub>                                    <mml:mi>r</mml:mi>                                    <mml:mrow>                                       <mml:mi>d</mml:mi>                                       <mml:mi>g</mml:mi>                                       <mml:mo>,</mml:mo>                                       <mml:mi>k</mml:mi>                                    </mml:mrow>                                 </mml:msub>                              </mml:mrow>                           </mml:mstyle>                           <mml:mo>,</mml:mo>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p><disp-formula id="bmcM13"><label>(13)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M32" name="1753-6561-2-S4-S7-i29" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:msub>                              <mml:mi>m</mml:mi>                              <mml:mrow>                                 <mml:mi>g</mml:mi>                                 <mml:mi>k</mml:mi>                              </mml:mrow>                           </mml:msub>                           <mml:mo>=</mml:mo>                           <mml:mfrac>                              <mml:mn>1</mml:mn>                              <mml:mrow>                                 <mml:msub>                                    <mml:mi>v</mml:mi>                                    <mml:mrow>                                       <mml:mi>g</mml:mi>                                       <mml:mi>k</mml:mi>                                    </mml:mrow>                                 </mml:msub>                              </mml:mrow>                           </mml:mfrac>                           <mml:mo stretchy="false">[</mml:mo>                           <mml:msub>                              <mml:mi>v</mml:mi>                              <mml:mn>0</mml:mn>                           </mml:msub>                           <mml:msub>                              <mml:mi>m</mml:mi>                              <mml:mn>0</mml:mn>                           </mml:msub>                           <mml:mo>+</mml:mo>                           <mml:msub>                              <mml:mi>a</mml:mi>                              <mml:mrow>                                 <mml:mi>g</mml:mi>                                 <mml:mi>k</mml:mi>                              </mml:mrow>                           </mml:msub>                           <mml:msub>                              <mml:mi>b</mml:mi>                              <mml:mrow>                                 <mml:mi>g</mml:mi>                                 <mml:mi>k</mml:mi>                              </mml:mrow>                           </mml:msub>                           <mml:mstyle displaystyle="true">                              <mml:munder>                                 <mml:mo>&#x02211;</mml:mo>                                 <mml:mi>d</mml:mi>                              </mml:munder>                              <mml:mrow>                                 <mml:msub>                                    <mml:mi>r</mml:mi>                                    <mml:mrow>                                       <mml:mi>d</mml:mi>                                       <mml:mi>g</mml:mi>                                       <mml:mo>,</mml:mo>                                       <mml:mi>k</mml:mi>                                    </mml:mrow>                                 </mml:msub>                                 <mml:msub>                                    <mml:mi>E</mml:mi>                                    <mml:mrow>                                       <mml:mi>d</mml:mi>                                       <mml:mi>g</mml:mi>                                    </mml:mrow>                                 </mml:msub>                              </mml:mrow>                           </mml:mstyle>                           <mml:mo stretchy="false">]</mml:mo>                           <mml:mo>,</mml:mo>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p><disp-formula id="bmcM14"><label>(14)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M33" name="1753-6561-2-S4-S7-i30" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:msub>                              <mml:mi>a</mml:mi>                              <mml:mrow>                                 <mml:mi>g</mml:mi>                                 <mml:mi>k</mml:mi>                              </mml:mrow>                           </mml:msub>                           <mml:mo>=</mml:mo>                           <mml:msub>                              <mml:mi>a</mml:mi>                              <mml:mn>0</mml:mn>                           </mml:msub>                           <mml:mo>+</mml:mo>                           <mml:mn>0.5</mml:mn>                           <mml:mstyle displaystyle="true">                              <mml:munder>                                 <mml:mo>&#x02211;</mml:mo>                                 <mml:mi>d</mml:mi>                              </mml:munder>                              <mml:mrow>                                 <mml:msub>                                    <mml:mi>r</mml:mi>                                    <mml:mrow>                                       <mml:mi>d</mml:mi>                                       <mml:mi>g</mml:mi>                                       <mml:mo>,</mml:mo>                                       <mml:mi>k</mml:mi>                                    </mml:mrow>                                 </mml:msub>                              </mml:mrow>                           </mml:mstyle>                           <mml:mo>,</mml:mo>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p><disp-formula id="bmcM15"><label>(15)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M34" name="1753-6561-2-S4-S7-i31" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:mfrac>                              <mml:mn>1</mml:mn>                              <mml:mrow>                                 <mml:msub>                                    <mml:mi>b</mml:mi>                                    <mml:mrow>                                       <mml:mi>g</mml:mi>                                       <mml:mi>k</mml:mi>                                    </mml:mrow>                                 </mml:msub>                              </mml:mrow>                           </mml:mfrac>                           <mml:mo>=</mml:mo>                           <mml:mfrac>                              <mml:mn>1</mml:mn>                              <mml:mrow>                                 <mml:msub>                                    <mml:mi>b</mml:mi>                                    <mml:mn>0</mml:mn>                                 </mml:msub>                              </mml:mrow>                           </mml:mfrac>                           <mml:mo>+</mml:mo>                           <mml:mn>0.5</mml:mn>                           <mml:mstyle displaystyle="true">                              <mml:munder>                                 <mml:mo>&#x02211;</mml:mo>                                 <mml:mi>d</mml:mi>                              </mml:munder>                              <mml:mrow>                                 <mml:msub>                                    <mml:mi>r</mml:mi>                                    <mml:mrow>                                       <mml:mi>d</mml:mi>                                       <mml:mi>g</mml:mi>                                       <mml:mo>,</mml:mo>                                       <mml:mi>k</mml:mi>                                    </mml:mrow>                                 </mml:msub>                              </mml:mrow>                           </mml:mstyle>                           <mml:mrow>                              <mml:mo>[</mml:mo>                              <mml:mrow>                                 <mml:msup>                                    <mml:mrow>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:msub>                                          <mml:mi>E</mml:mi>                                          <mml:mrow>                                             <mml:mi>d</mml:mi>                                             <mml:mi>g</mml:mi>                                          </mml:mrow>                                       </mml:msub>                                       <mml:mo>&#x02212;</mml:mo>                                       <mml:msub>                                          <mml:mi>m</mml:mi>                                          <mml:mrow>                                             <mml:mi>g</mml:mi>                                             <mml:mi>k</mml:mi>                                          </mml:mrow>                                       </mml:msub>                                       <mml:mo stretchy="false">)</mml:mo>                                    </mml:mrow>                                    <mml:mn>2</mml:mn>                                 </mml:msup>                                 <mml:mo>+</mml:mo>                                 <mml:mfrac>                                    <mml:mn>1</mml:mn>                                    <mml:mrow>                                       <mml:msub>                                          <mml:mi>v</mml:mi>                                          <mml:mrow>                                             <mml:mi>g</mml:mi>                                             <mml:mi>k</mml:mi>                                          </mml:mrow>                                       </mml:msub>                                    </mml:mrow>                                 </mml:mfrac>                              </mml:mrow>                              <mml:mo>]</mml:mo>                           </mml:mrow>                           <mml:mo>.</mml:mo>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>We pursue the above iterative procedure until convergence of the lower bound &#x02112;(<italic>R</italic>; &#x00398;) whose evaluation is given in the Appendix. Since <italic>Z</italic><sub><italic>dg</italic>, <italic>k </italic></sub>determines the cluster for the observed data point <italic>E</italic><sub><italic>d </italic></sub>at attribute <italic>g </italic>and <italic>r</italic><sub><italic>dg</italic>, <italic>k </italic></sub>is its expectation, we intuitively assign data <italic>E</italic><sub><italic>d </italic></sub>to cluster arg max{&#x02211;<sub><italic>g</italic></sub><italic>r</italic><sub><italic>dg</italic>;<italic>k</italic></sub>: <italic>k </italic>= 1,...., <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M35" name="1753-6561-2-S4-S7-i1" overflow="scroll"><mml:semantics><mml:mi mathvariant="script">K</mml:mi></mml:semantics></mml:math></inline-formula>}. We can also do model selection over the number of clusters based on a free energy lower bound of the marginalized VB. Experiments in the next section show that this approach is reasonable.</p></sec></sec><sec><title>Results</title><p>We ran marginalized VB on three data sets. The first was the wine data set from the UCI Repository [<xref ref-type="bibr" rid="B11">11</xref>]: this has 178 samples and each sample has 13 features. This data set was chosen for the purpose of validating the proposed method since there are 3 distinct clusters present (derived from 3 cultivars). As more biologically relevant examples we then selected two cancer expression array datasets. The first of these was a lung cancer data set [<xref ref-type="bibr" rid="B12">12</xref>] consisting of 73 samples and 918 features. The second was a leukemia data set [<xref ref-type="bibr" rid="B13">13</xref>] with 90 samples and 500 features. All the data sets were normalized to zero mean and unit variance and the hyper-parameters <italic>m</italic><sub>0</sub>, <italic>v</italic><sub>0</sub>, <italic>a</italic><sub>0</sub>, and <italic>b</italic><sub>0 </sub>were chosen to have the same values in both standard VB and marginalized VB. Since the datasets are normalized and <italic>m</italic><sub>0</sub>, <italic>v</italic><sub>0 </sub>are hyper-parameters of the Gaussian prior distribution over the mean for the data, it is reasonable to choose <italic>m</italic><sub>0 </sub>= 0, <italic>v</italic><sub>0 </sub>= 1. For similar reasons, given <italic>a</italic><sub>0</sub>, <italic>b</italic><sub>0 </sub>are hyper-parameters of the Gamma prior distribution over the precision (inverse variance) of the data and the mean of a Gamma distributed random variable is <italic>a</italic><sub>0</sub><italic>b</italic><sub>0</sub>, we chose <italic>a</italic><sub>0 </sub>= 20 and <italic>b</italic><sub>0 </sub>= 0.05 throughout these experiments.</p><p>First we compared the free energy lower bound of marginalized VB and standard VB based on 30 random initialization. In Figure <xref ref-type="fig" rid="F1">1</xref> (top row) we observe an improvement in the free energy as a function of iteration step, for marginalized VB over standard VB. In analogy to standard VB, marginalized VB can determine the appropriate number of soft clusters by estimating the free energy bound given by equation (6) in contrast to the hold-out cross-validation procedure for a maximum likelihood approach to LPD [<xref ref-type="bibr" rid="B5">5</xref>]. To investigate the effectiveness of this approach to model selection, free energies were averaged over 20 runs from different random initializations. As shown in Figure <xref ref-type="fig" rid="F1">1</xref> (middle row), marginalized VB performed well in determining the correct number of clusters (three) in the UCI wine data set. For the cancer array datasets, the peak in the averaged free energy is less marked with an indication of six soft clusters for the leukemia data set and seven clusters for the lung cancer data set.</p><fig position="float" id="F1"><label>Figure 1</label><caption><p>Results for the wine data set (left column), lung cancer data set (middle column) and leukemia data set (right column). Top row (a-c): free energy bounds comparison (upper curve:MVB, lower curve:VB). Middle row (d-f): free energy (<italic>y</italic>-axis) versus <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M36" name="1753-6561-2-S4-S7-i1" overflow="scroll"><mml:semantics><mml:mi mathvariant="script">K</mml:mi></mml:semantics></mml:math></inline-formula>, the number of clusters. Bottom row (g-i): the normalized &#x02211;<sub><italic>g</italic></sub><italic>r</italic><sub><italic>dg</italic>, <italic>k </italic></sub>gives a confidence measure that sample <italic>d </italic>belongs to a cluster <italic>k</italic>. For the two cancer datasets, samples separated by dashed lines belong to an identified class e.g. adenocarcinoma samples or small cell lung cancer samples (figure (h), see text).</p></caption><graphic xlink:href="1753-6561-2-S4-S7-1"/></fig><p>In the bottom row of Figure <xref ref-type="fig" rid="F1">1</xref>, we see that marginalized VB shows quite promising clustering results using the normalized &#x02211;<sub><italic>g</italic></sub><italic>r</italic><sub><italic>dg</italic>, <italic>k</italic></sub>: these peaks indicate the confidence in the allocation of the <italic>d</italic>th sample to the <italic>k</italic>th cluster and accord well with known classifications. The lung cancer dataset of Garber <italic>et al </italic>[<xref ref-type="bibr" rid="B12">12</xref>] (middle column, Figure <xref ref-type="fig" rid="F1">1</xref>) consisted of 73 gene expression profiles from normal and tumour samples with the tumours labelled as squamous, large cell, small cell and adenocarcinoma. The samples are in the order in which they are presented in the original paper [<xref ref-type="bibr" rid="B12">12</xref>] with the dashed lines showing their original principal sample groupings. As with Garber <italic>et al </italic>[<xref ref-type="bibr" rid="B12">12</xref>] we identified seven clusters in the data with the adenocarcinoma samples falling into three separate clusters with strong correlation with clinical outcomes. For their ordering (which we follow) samples 1&#x02013;19 belong to adenocarcinoma cluster 1, samples 20&#x02013;26 belong to adenocarcinoma cluster 2, samples 27&#x02013;32 are normal tissue samples, samples 33&#x02013;43 are adenocarcinoma cluster 3, samples 44&#x02013;60 are squamous cell carcinomas, samples 61&#x02013;67 are small cell carcinomas and samples 68&#x02013;73 are from large cell tumours.</p><p>As our last example, we applied the proposed MVB method to an oligonucleotide microarray dataset from 360 patients with acute lymphoblastic leukemia (ALL) from Yeoh <italic>et al </italic>[<xref ref-type="bibr" rid="B13">13</xref>]. ALL is known to have a number of subtypes with variable responses to chemotherapy. In many cases fusion genes are implicated in the genesis of the disease. For the Yeoh <italic>et al </italic>[<xref ref-type="bibr" rid="B13">13</xref>] dataset, samples were drawn from leukemias with rearrangements involving <italic>BCR-ABL</italic>, <italic>E2A-PBX1</italic>, <italic>TEL-AML1</italic>, rearrangements of MLL gene, hyperdiploid karyotope (more than 50 chromosomes) and T lineage leukemias (<italic>T-ALL</italic>). The free energy is plotted in Figure <xref ref-type="fig" rid="F1">1</xref> (right column, middle row) with a peak suggesting 6 subtypes. The dashed lines represent the original demarcations of groups according to known genetic rearrangement. Samples 1&#x02013;15 are <italic>BCR-ABL</italic>, 16&#x02013;42 are <italic>E2A-PBX1</italic>, 43&#x02013;106 <italic>Hyperdiploid </italic>&#x0003e; 50, 107&#x02013;126 <italic>MLL</italic>, 206&#x02013;248 <italic>T-ALL</italic>, 249&#x02013;327 <italic>TEL-AML1</italic>, 328&#x02013;335 <italic>Group23 </italic>and 127&#x02013;205 are labelled as <italic>Others</italic>. Some groupings, such as <italic>E2A-PBX1</italic>, are very distinct. However, the overall groupings are not as well defined as with lung cancer.</p></sec><sec><title>Conclusion</title><p>We have proposed an efficient variational Bayesian inference method for LPD probabilistic models. By allowing the variables to be dependent on each other, the method can provide more accurate approximation than standard VB. Also, the method provides a principled approach to model selection via the free energy bound. Promising clustering results were also reported on lung cancer and leukemia data sets. Extensions of this method to semi-supervised clustering will be reported elsewhere.</p></sec><sec><title>Competing interests</title><p>The authors declare that they have no competing interests.</p></sec><sec><title>Authors' contributions</title><p>YY and CC conceived the method and drafted the manuscript. PL and YY coded the algorithm and implemented the experiments. All authors read and approved the final manuscript.</p></sec><sec><title>Appendix</title><p>In this appendix we derive the EM-updates and free energy bound for MVB.</p><sec><title>Derivation of updates</title><p>Noting that, for any <italic>d</italic>, <italic>g</italic>, &#x02211;<sub><italic>k</italic></sub><italic>Z</italic><sub><italic>dg</italic>, <italic>k </italic></sub>= 1 and denoting the number of features by <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M37" name="1753-6561-2-S4-S7-i2" overflow="scroll"><mml:semantics><mml:mi mathvariant="script">G</mml:mi></mml:semantics></mml:math></inline-formula> we obtain from equation (10):</p><p><disp-formula id="bmcM16"><label>(16)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M38" name="1753-6561-2-S4-S7-i32" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:mtable columnalign="left">                              <mml:mtr columnalign="left">                                 <mml:mtd columnalign="left">                                    <mml:mrow>                                       <mml:mi>log</mml:mi>                                       <mml:mo>&#x02061;</mml:mo>                                       <mml:mi>p</mml:mi>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:mi>E</mml:mi>                                       <mml:mo>,</mml:mo>                                       <mml:mi>Z</mml:mi>                                       <mml:mo>|</mml:mo>                                       <mml:mi>&#x00398;</mml:mi>                                       <mml:mo stretchy="false">)</mml:mo>                                       <mml:mo>=</mml:mo>                                       <mml:mi mathvariant="script">D</mml:mi>                                       <mml:mi>log</mml:mi>                                       <mml:mo>&#x02061;</mml:mo>                                       <mml:mi>&#x00393;</mml:mi>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:mstyle displaystyle="true">                                          <mml:msub>                                             <mml:mo>&#x02211;</mml:mo>                                             <mml:mi>k</mml:mi>                                          </mml:msub>                                          <mml:mrow>                                             <mml:msub>                                                <mml:mi>&#x003b1;</mml:mi>                                                <mml:mi>k</mml:mi>                                             </mml:msub>                                          </mml:mrow>                                       </mml:mstyle>                                       <mml:mo stretchy="false">)</mml:mo>                                       <mml:mo>&#x02212;</mml:mo>                                       <mml:mi mathvariant="script">D</mml:mi>                                       <mml:mstyle displaystyle="true">                                          <mml:msub>                                             <mml:mo>&#x02211;</mml:mo>                                             <mml:mi>k</mml:mi>                                          </mml:msub>                                          <mml:mrow>                                             <mml:mi>log</mml:mi>                                             <mml:mo>&#x02061;</mml:mo>                                             <mml:mi>&#x00393;</mml:mi>                                             <mml:mo stretchy="false">(</mml:mo>                                             <mml:msub>                                                <mml:mi>&#x003b1;</mml:mi>                                                <mml:mi>k</mml:mi>                                             </mml:msub>                                             <mml:mo stretchy="false">)</mml:mo>                                          </mml:mrow>                                       </mml:mstyle>                                       <mml:mo>&#x02212;</mml:mo>                                       <mml:mi mathvariant="script">D</mml:mi>                                       <mml:mi>log</mml:mi>                                       <mml:mo>&#x02061;</mml:mo>                                       <mml:mi>&#x00393;</mml:mi>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:mstyle displaystyle="true">                                          <mml:msub>                                             <mml:mo>&#x02211;</mml:mo>                                             <mml:mi>k</mml:mi>                                          </mml:msub>                                          <mml:mrow>                                             <mml:msub>                                                <mml:mi>&#x003b1;</mml:mi>                                                <mml:mi>k</mml:mi>                                             </mml:msub>                                             <mml:mo>+</mml:mo>                                             <mml:mi mathvariant="script">G</mml:mi>                                          </mml:mrow>                                       </mml:mstyle>                                       <mml:mo stretchy="false">)</mml:mo>                                    </mml:mrow>                                 </mml:mtd>                              </mml:mtr>                              <mml:mtr columnalign="left">                                 <mml:mtd columnalign="left">                                    <mml:mrow>                                       <mml:mo>+</mml:mo>                                       <mml:mstyle displaystyle="true">                                          <mml:msub>                                             <mml:mo>&#x02211;</mml:mo>                                             <mml:mrow>                                                <mml:msup>                                                   <mml:mi>d</mml:mi>                                                   <mml:mo>&#x02032;</mml:mo>                                                </mml:msup>                                                <mml:mo>,</mml:mo>                                                <mml:mi>k</mml:mi>                                             </mml:mrow>                                          </mml:msub>                                          <mml:mrow>                                             <mml:mi>log</mml:mi>                                             <mml:mo>&#x02061;</mml:mo>                                             <mml:mi>&#x00393;</mml:mi>                                             <mml:mo stretchy="false">(</mml:mo>                                             <mml:msub>                                                <mml:mi>&#x003b1;</mml:mi>                                                <mml:mi>k</mml:mi>                                             </mml:msub>                                             <mml:mo>+</mml:mo>                                             <mml:mstyle displaystyle="true">                                                <mml:msub>                                                   <mml:mo>&#x02211;</mml:mo>                                                   <mml:msup>                                                      <mml:mi>g</mml:mi>                                                      <mml:mo>&#x02032;</mml:mo>                                                   </mml:msup>                                                </mml:msub>                                                <mml:mrow>                                                   <mml:msub>                                                      <mml:mi>Z</mml:mi>                                                      <mml:mrow>                                                         <mml:msup>                                                            <mml:mi>d</mml:mi>                                                            <mml:mo>&#x02032;</mml:mo>                                                         </mml:msup>                                                         <mml:msup>                                                            <mml:mi>g</mml:mi>                                                            <mml:mo>&#x02032;</mml:mo>                                                         </mml:msup>                                                         <mml:mo>,</mml:mo>                                                         <mml:mi>k</mml:mi>                                                      </mml:mrow>                                                   </mml:msub>                                                </mml:mrow>                                             </mml:mstyle>                                             <mml:mo stretchy="false">)</mml:mo>                                             <mml:mo>+</mml:mo>                                             <mml:mstyle displaystyle="true">                                                <mml:msub>                                                   <mml:mo>&#x02211;</mml:mo>                                                   <mml:mrow>                                                      <mml:msup>                                                         <mml:mi>d</mml:mi>                                                         <mml:mo>&#x02032;</mml:mo>                                                      </mml:msup>                                                      <mml:mo>,</mml:mo>                                                      <mml:msup>                                                         <mml:mi>g</mml:mi>                                                         <mml:mo>&#x02032;</mml:mo>                                                      </mml:msup>                                                      <mml:mo>,</mml:mo>                                                      <mml:mi>k</mml:mi>                                                   </mml:mrow>                                                </mml:msub>                                                <mml:mrow>                                                   <mml:msub>                                                      <mml:mi>Z</mml:mi>                                                      <mml:mrow>                                                         <mml:msup>                                                            <mml:mi>d</mml:mi>                                                            <mml:mo>&#x02032;</mml:mo>                                                         </mml:msup>                                                         <mml:msup>                                                            <mml:mi>g</mml:mi>                                                            <mml:mo>&#x02032;</mml:mo>                                                         </mml:msup>                                                         <mml:mo>,</mml:mo>                                                         <mml:mi>k</mml:mi>                                                      </mml:mrow>                                                   </mml:msub>                                                   <mml:mi>log</mml:mi>                                                   <mml:mo>&#x02061;</mml:mo>                                                   <mml:mi mathvariant="script">N</mml:mi>                                                   <mml:mo stretchy="false">(</mml:mo>                                                   <mml:msub>                                                      <mml:mi>E</mml:mi>                                                      <mml:mrow>                                                         <mml:msup>                                                            <mml:mi>d</mml:mi>                                                            <mml:mo>&#x02032;</mml:mo>                                                         </mml:msup>                                                         <mml:msup>                                                            <mml:mi>g</mml:mi>                                                            <mml:mo>&#x02032;</mml:mo>                                                         </mml:msup>                                                      </mml:mrow>                                                   </mml:msub>                                                   <mml:mo>|</mml:mo>                                                   <mml:msub>                                                      <mml:mi>&#x003bc;</mml:mi>                                                      <mml:mrow>                                                         <mml:msup>                                                            <mml:mi>g</mml:mi>                                                            <mml:mo>&#x02032;</mml:mo>                                                         </mml:msup>                                                         <mml:mi>k</mml:mi>                                                      </mml:mrow>                                                   </mml:msub>                                                   <mml:mo>,</mml:mo>                                                   <mml:msub>                                                      <mml:mi>&#x003b2;</mml:mi>                                                      <mml:mrow>                                                         <mml:msup>                                                            <mml:mi>g</mml:mi>                                                            <mml:mo>&#x02032;</mml:mo>                                                         </mml:msup>                                                         <mml:mi>k</mml:mi>                                                      </mml:mrow>                                                   </mml:msub>                                                </mml:mrow>                                             </mml:mstyle>                                             <mml:mo stretchy="false">)</mml:mo>                                             <mml:mo>.</mml:mo>                                          </mml:mrow>                                       </mml:mstyle>                                    </mml:mrow>                                 </mml:mtd>                              </mml:mtr>                           </mml:mtable>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>Since <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M39" name="1753-6561-2-S4-S7-i33" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>&#x00393;</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>&#x003b1;</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:msub><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02260;</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:msup><mml:mi>g</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>&#x003b1;</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:msub><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02260;</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:msup><mml:mi>g</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mi>&#x00393;</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>&#x003b1;</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:msub><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02260;</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:msup><mml:mi>g</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:semantics></mml:math></inline-formula>, putting this observation into the log <italic>p</italic>(<italic>E</italic>, <italic>Z</italic>|&#x00398;) yields:</p><p><disp-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M40" name="1753-6561-2-S4-S7-i34" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:mtable columnalign="left">                              <mml:mtr columnalign="left">                                 <mml:mtd columnalign="left">                                    <mml:mrow>                                       <mml:msub>                                          <mml:mi mathvariant="double-struck">E</mml:mi>                                          <mml:mrow>                                             <mml:mi>q</mml:mi>                                             <mml:mo>\</mml:mo>                                             <mml:mi>d</mml:mi>                                             <mml:mi>g</mml:mi>                                          </mml:mrow>                                       </mml:msub>                                       <mml:mrow>                                          <mml:mo>(</mml:mo>                                          <mml:mrow>                                             <mml:mi>log</mml:mi>                                             <mml:mo>&#x02061;</mml:mo>                                             <mml:mi>p</mml:mi>                                             <mml:mo stretchy="false">(</mml:mo>                                             <mml:mi>E</mml:mi>                                             <mml:mo>,</mml:mo>                                             <mml:mi>Z</mml:mi>                                             <mml:mo>|</mml:mo>                                             <mml:mi>&#x00398;</mml:mi>                                             <mml:mo stretchy="false">)</mml:mo>                                          </mml:mrow>                                          <mml:mo>)</mml:mo>                                       </mml:mrow>                                    </mml:mrow>                                 </mml:mtd>                                 <mml:mtd columnalign="left">                                    <mml:mo>=</mml:mo>                                 </mml:mtd>                                 <mml:mtd columnalign="left">                                    <mml:mrow>                                       <mml:mstyle displaystyle="true">                                          <mml:msub>                                             <mml:mo>&#x02211;</mml:mo>                                             <mml:mi>k</mml:mi>                                          </mml:msub>                                          <mml:mrow>                                             <mml:msub>                                                <mml:mi>Z</mml:mi>                                                <mml:mrow>                                                   <mml:mi>d</mml:mi>                                                   <mml:mi>g</mml:mi>                                                   <mml:mo>,</mml:mo>                                                   <mml:mi>k</mml:mi>                                                </mml:mrow>                                             </mml:msub>                                             <mml:mrow>                                                <mml:mo>(</mml:mo>                                                <mml:mrow>                                                   <mml:msub>                                                      <mml:mi mathvariant="double-struck">E</mml:mi>                                                      <mml:mrow>                                                         <mml:mi>q</mml:mi>                                                         <mml:mo>\</mml:mo>                                                         <mml:mi>d</mml:mi>                                                         <mml:mi>g</mml:mi>                                                      </mml:mrow>                                                   </mml:msub>                                                   <mml:mrow>                                                      <mml:mo>[</mml:mo>                                                      <mml:mrow>                                                         <mml:mi>log</mml:mi>                                                         <mml:mo>&#x02061;</mml:mo>                                                         <mml:mrow>                                                            <mml:mo>(</mml:mo>                                                            <mml:mrow>                                                               <mml:msub>                                                                  <mml:mi>&#x003b1;</mml:mi>                                                                  <mml:mi>k</mml:mi>                                                               </mml:msub>                                                               <mml:mo>+</mml:mo>                                                               <mml:mstyle displaystyle="true">                                                                  <mml:msub>                                                                     <mml:mo>&#x02211;</mml:mo>                                                                     <mml:mrow>                                                                        <mml:msup>                                                                           <mml:mi>g</mml:mi>                                                                           <mml:mo>&#x02032;</mml:mo>                                                                        </mml:msup>                                                                        <mml:mo>&#x02260;</mml:mo>                                                                        <mml:mi>g</mml:mi>                                                                     </mml:mrow>                                                                  </mml:msub>                                                                  <mml:mrow>                                                                     <mml:msub>                                                                        <mml:mi>Z</mml:mi>                                                                        <mml:mrow>                                                                           <mml:mi>d</mml:mi>                                                                           <mml:msup>                                                                              <mml:mi>g</mml:mi>                                                                              <mml:mo>&#x02032;</mml:mo>                                                                           </mml:msup>                                                                           <mml:mo>,</mml:mo>                                                                           <mml:mi>k</mml:mi>                                                                        </mml:mrow>                                                                     </mml:msub>                                                                  </mml:mrow>                                                               </mml:mstyle>                                                            </mml:mrow>                                                            <mml:mo>)</mml:mo>                                                         </mml:mrow>                                                      </mml:mrow>                                                      <mml:mo>]</mml:mo>                                                   </mml:mrow>                                                </mml:mrow>                                             </mml:mrow>                                          </mml:mrow>                                       </mml:mstyle>                                    </mml:mrow>                                 </mml:mtd>                              </mml:mtr>                              <mml:mtr columnalign="left">                                 <mml:mtd columnalign="left">                                    <mml:mrow/>                                 </mml:mtd>                                 <mml:mtd columnalign="left">                                    <mml:mo>+</mml:mo>                                 </mml:mtd>                                 <mml:mtd columnalign="left">                                    <mml:mrow>                                       <mml:mrow>                                          <mml:mrow>                                             <mml:msub>                                                <mml:mi mathvariant="double-struck">E</mml:mi>                                                <mml:mrow>                                                   <mml:mi>q</mml:mi>                                                   <mml:mo stretchy="false">(</mml:mo>                                                   <mml:mi>&#x00398;</mml:mi>                                                   <mml:mo stretchy="false">)</mml:mo>                                                </mml:mrow>                                             </mml:msub>                                             <mml:mrow>                                                <mml:mo>[</mml:mo>                                                <mml:mrow>                                                   <mml:mi>log</mml:mi>                                                   <mml:mo>&#x02061;</mml:mo>                                                   <mml:mi mathvariant="script">N</mml:mi>                                                   <mml:mo stretchy="false">(</mml:mo>                                                   <mml:msub>                                                      <mml:mi>E</mml:mi>                                                      <mml:mrow>                                                         <mml:mi>d</mml:mi>                                                         <mml:mi>g</mml:mi>                                                      </mml:mrow>                                                   </mml:msub>                                                   <mml:mo>|</mml:mo>                                                   <mml:msub>                                                      <mml:mi>&#x003bc;</mml:mi>                                                      <mml:mrow>                                                         <mml:mi>g</mml:mi>                                                         <mml:mi>k</mml:mi>                                                      </mml:mrow>                                                   </mml:msub>                                                   <mml:mo>,</mml:mo>                                                   <mml:msub>                                                      <mml:mi>&#x003c3;</mml:mi>                                                      <mml:mrow>                                                         <mml:mi>g</mml:mi>                                                         <mml:mi>k</mml:mi>                                                      </mml:mrow>                                                   </mml:msub>                                                   <mml:mo stretchy="false">)</mml:mo>                                                </mml:mrow>                                                <mml:mo>]</mml:mo>                                             </mml:mrow>                                          </mml:mrow>                                          <mml:mo>)</mml:mo>                                       </mml:mrow>                                       <mml:mo>+</mml:mo>                                       <mml:mtext>constant&#x000a0;terms</mml:mtext>                                       <mml:mo>,</mml:mo>                                    </mml:mrow>                                 </mml:mtd>                              </mml:mtr>                           </mml:mtable>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>where <italic>constant terms </italic>are independent of <italic>Z</italic><sub><italic>dg</italic>, <italic>k</italic></sub>. Hence, substituting this into equation (8) we conclude that</p><p><disp-formula id="bmcM17"><label>(17)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M41" name="1753-6561-2-S4-S7-i35" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:msub>                              <mml:mi>r</mml:mi>                              <mml:mrow>                                 <mml:mi>d</mml:mi>                                 <mml:mi>g</mml:mi>                                 <mml:mo>,</mml:mo>                                 <mml:mi>k</mml:mi>                              </mml:mrow>                           </mml:msub>                           <mml:mo>&#x0221d;</mml:mo>                           <mml:mi>exp</mml:mi>                           <mml:mo>&#x02061;</mml:mo>                           <mml:mrow>                              <mml:mo>(</mml:mo>                              <mml:mrow>                                 <mml:msub>                                    <mml:mi mathvariant="double-struck">E</mml:mi>                                    <mml:mrow>                                       <mml:mi>q</mml:mi>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:mi>&#x00398;</mml:mi>                                       <mml:mo stretchy="false">)</mml:mo>                                    </mml:mrow>                                 </mml:msub>                                 <mml:mrow>                                    <mml:mo>[</mml:mo>                                    <mml:mrow>                                       <mml:mi>log</mml:mi>                                       <mml:mo>&#x02061;</mml:mo>                                       <mml:mi mathvariant="script">N</mml:mi>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:msub>                                          <mml:mi>E</mml:mi>                                          <mml:mrow>                                             <mml:mi>d</mml:mi>                                             <mml:mi>g</mml:mi>                                          </mml:mrow>                                       </mml:msub>                                       <mml:mo>|</mml:mo>                                       <mml:msub>                                          <mml:mi>&#x003bc;</mml:mi>                                          <mml:mrow>                                             <mml:mi>g</mml:mi>                                             <mml:mi>k</mml:mi>                                          </mml:mrow>                                       </mml:msub>                                       <mml:mo>,</mml:mo>                                       <mml:msub>                                          <mml:mi>&#x003b2;</mml:mi>                                          <mml:mrow>                                             <mml:mi>g</mml:mi>                                             <mml:mi>k</mml:mi>                                          </mml:mrow>                                       </mml:msub>                                       <mml:mo stretchy="false">)</mml:mo>                                    </mml:mrow>                                    <mml:mo>]</mml:mo>                                 </mml:mrow>                                 <mml:mo>+</mml:mo>                                 <mml:mi>log</mml:mi>                                 <mml:mo>&#x02061;</mml:mo>                                 <mml:msub>                                    <mml:mi mathvariant="double-struck">E</mml:mi>                                    <mml:mrow>                                       <mml:mi>q</mml:mi>                                       <mml:mo>\</mml:mo>                                       <mml:mi>d</mml:mi>                                       <mml:mi>g</mml:mi>                                    </mml:mrow>                                 </mml:msub>                                 <mml:mrow>                                    <mml:mo>[</mml:mo>                                    <mml:mrow>                                       <mml:mi>log</mml:mi>                                       <mml:mo>&#x02061;</mml:mo>                                       <mml:mrow>                                          <mml:mo>(</mml:mo>                                          <mml:mrow>                                             <mml:msub>                                                <mml:mi>&#x003b1;</mml:mi>                                                <mml:mi>k</mml:mi>                                             </mml:msub>                                             <mml:mo>+</mml:mo>                                             <mml:mstyle displaystyle="true">                                                <mml:msub>                                                   <mml:mo>&#x02211;</mml:mo>                                                   <mml:mrow>                                                      <mml:msup>                                                         <mml:mi>g</mml:mi>                                                         <mml:mo>&#x02032;</mml:mo>                                                      </mml:msup>                                                      <mml:mo>&#x02260;</mml:mo>                                                      <mml:mi>g</mml:mi>                                                   </mml:mrow>                                                </mml:msub>                                                <mml:mrow>                                                   <mml:msub>                                                      <mml:mi>Z</mml:mi>                                                      <mml:mrow>                                                         <mml:mi>d</mml:mi>                                                         <mml:msup>                                                            <mml:mi>g</mml:mi>                                                            <mml:mo>&#x02032;</mml:mo>                                                         </mml:msup>                                                         <mml:mo>,</mml:mo>                                                         <mml:mi>k</mml:mi>                                                      </mml:mrow>                                                   </mml:msub>                                                </mml:mrow>                                             </mml:mstyle>                                          </mml:mrow>                                          <mml:mo>)</mml:mo>                                       </mml:mrow>                                    </mml:mrow>                                    <mml:mo>]</mml:mo>                                 </mml:mrow>                              </mml:mrow>                              <mml:mo>)</mml:mo>                           </mml:mrow>                           <mml:mo>.</mml:mo>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>To estimate the expectation of the Normal distribution, we use the following observations (e.g. [<xref ref-type="bibr" rid="B7">7</xref>]) for the Gamma and Normal distributions:</p><p><disp-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M42" name="1753-6561-2-S4-S7-i36" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:mtable>                              <mml:mtr>                                 <mml:mtd>                                    <mml:mrow>                                       <mml:msub>                                          <mml:mi mathvariant="double-struck">E</mml:mi>                                          <mml:mrow>                                             <mml:mi>q</mml:mi>                                             <mml:mo stretchy="false">(</mml:mo>                                             <mml:mi>&#x003b2;</mml:mi>                                             <mml:mo stretchy="false">)</mml:mo>                                          </mml:mrow>                                       </mml:msub>                                       <mml:mo stretchy="false">[</mml:mo>                                       <mml:msub>                                          <mml:mi>&#x003b2;</mml:mi>                                          <mml:mrow>                                             <mml:mi>g</mml:mi>                                             <mml:mi>k</mml:mi>                                          </mml:mrow>                                       </mml:msub>                                       <mml:mo stretchy="false">]</mml:mo>                                       <mml:mo>=</mml:mo>                                       <mml:msub>                                          <mml:mi>a</mml:mi>                                          <mml:mrow>                                             <mml:mi>g</mml:mi>                                             <mml:mi>k</mml:mi>                                          </mml:mrow>                                       </mml:msub>                                       <mml:msub>                                          <mml:mi>b</mml:mi>                                          <mml:mrow>                                             <mml:mi>g</mml:mi>                                             <mml:mi>k</mml:mi>                                          </mml:mrow>                                       </mml:msub>                                       <mml:mo>,</mml:mo>                                    </mml:mrow>                                 </mml:mtd>                                 <mml:mtd>                                    <mml:mrow>                                       <mml:msub>                                          <mml:mi mathvariant="double-struck">E</mml:mi>                                          <mml:mrow>                                             <mml:mi>q</mml:mi>                                             <mml:mo stretchy="false">(</mml:mo>                                             <mml:mi>&#x003b2;</mml:mi>                                             <mml:mo stretchy="false">)</mml:mo>                                          </mml:mrow>                                       </mml:msub>                                       <mml:mo stretchy="false">[</mml:mo>                                       <mml:mi>log</mml:mi>                                       <mml:mo>&#x02061;</mml:mo>                                       <mml:msub>                                          <mml:mi>&#x003b2;</mml:mi>                                          <mml:mrow>                                             <mml:mi>g</mml:mi>                                             <mml:mi>k</mml:mi>                                          </mml:mrow>                                       </mml:msub>                                       <mml:mo stretchy="false">]</mml:mo>                                       <mml:mo>=</mml:mo>                                       <mml:mi>&#x003c8;</mml:mi>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:msub>                                          <mml:mi>a</mml:mi>                                          <mml:mrow>                                             <mml:mi>g</mml:mi>                                             <mml:mi>k</mml:mi>                                          </mml:mrow>                                       </mml:msub>                                       <mml:mo stretchy="false">)</mml:mo>                                       <mml:mo>+</mml:mo>                                       <mml:mi>log</mml:mi>                                       <mml:mo>&#x02061;</mml:mo>                                       <mml:msub>                                          <mml:mi>b</mml:mi>                                          <mml:mrow>                                             <mml:mi>g</mml:mi>                                             <mml:mi>k</mml:mi>                                          </mml:mrow>                                       </mml:msub>                                       <mml:mo>,</mml:mo>                                    </mml:mrow>                                 </mml:mtd>                              </mml:mtr>                           </mml:mtable>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>and</p><p><disp-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M43" name="1753-6561-2-S4-S7-i37" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:msub>                              <mml:mi mathvariant="double-struck">E</mml:mi>                              <mml:mrow>                                 <mml:mi>q</mml:mi>                                 <mml:mo stretchy="false">(</mml:mo>                                 <mml:mi>&#x003bc;</mml:mi>                                 <mml:mo stretchy="false">)</mml:mo>                              </mml:mrow>                           </mml:msub>                           <mml:mo stretchy="false">[</mml:mo>                           <mml:msubsup>                              <mml:mi>&#x003bc;</mml:mi>                              <mml:mrow>                                 <mml:mi>g</mml:mi>                                 <mml:mi>k</mml:mi>                              </mml:mrow>                              <mml:mn>2</mml:mn>                           </mml:msubsup>                           <mml:mo stretchy="false">]</mml:mo>                           <mml:mo>=</mml:mo>                           <mml:msubsup>                              <mml:mi>m</mml:mi>                              <mml:mrow>                                 <mml:mi>g</mml:mi>                                 <mml:mi>k</mml:mi>                              </mml:mrow>                              <mml:mn>2</mml:mn>                           </mml:msubsup>                           <mml:mo>+</mml:mo>                           <mml:msubsup>                              <mml:mi>v</mml:mi>                              <mml:mrow>                                 <mml:mi>g</mml:mi>                                 <mml:mi>k</mml:mi>                              </mml:mrow>                              <mml:mrow>                                 <mml:mo>&#x02212;</mml:mo>                                 <mml:mn>1</mml:mn>                              </mml:mrow>                           </mml:msubsup>                           <mml:mo>,</mml:mo>                           <mml:msub>                              <mml:mi mathvariant="double-struck">E</mml:mi>                              <mml:mrow>                                 <mml:mi>q</mml:mi>                                 <mml:mo stretchy="false">(</mml:mo>                                 <mml:mi>&#x003bc;</mml:mi>                                 <mml:mo stretchy="false">)</mml:mo>                              </mml:mrow>                           </mml:msub>                           <mml:mo stretchy="false">[</mml:mo>                           <mml:msub>                              <mml:mi>&#x003bc;</mml:mi>                              <mml:mrow>                                 <mml:mi>g</mml:mi>                                 <mml:mi>k</mml:mi>                              </mml:mrow>                           </mml:msub>                           <mml:mo stretchy="false">]</mml:mo>                           <mml:mo>=</mml:mo>                           <mml:msub>                              <mml:mi>m</mml:mi>                              <mml:mrow>                                 <mml:mi>g</mml:mi>                                 <mml:mi>k</mml:mi>                              </mml:mrow>                           </mml:msub>                           <mml:mo>.</mml:mo>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>Consequently, simple manipulation yields:</p><p><disp-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M44" name="1753-6561-2-S4-S7-i38" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:msub>                              <mml:mi mathvariant="double-struck">E</mml:mi>                              <mml:mrow>                                 <mml:mi>q</mml:mi>                                 <mml:mo stretchy="false">(</mml:mo>                                 <mml:mi>&#x00398;</mml:mi>                                 <mml:mo stretchy="false">)</mml:mo>                              </mml:mrow>                           </mml:msub>                           <mml:mrow>                              <mml:mo>[</mml:mo>                              <mml:mrow>                                 <mml:mi>log</mml:mi>                                 <mml:mo>&#x02061;</mml:mo>                                 <mml:mi mathvariant="script">N</mml:mi>                                 <mml:mo stretchy="false">(</mml:mo>                                 <mml:msub>                                    <mml:mi>E</mml:mi>                                    <mml:mrow>                                       <mml:mi>d</mml:mi>                                       <mml:mi>g</mml:mi>                                    </mml:mrow>                                 </mml:msub>                                 <mml:mo>|</mml:mo>                                 <mml:msub>                                    <mml:mi>&#x003bc;</mml:mi>                                    <mml:mrow>                                       <mml:mi>g</mml:mi>                                       <mml:mi>k</mml:mi>                                    </mml:mrow>                                 </mml:msub>                                 <mml:mo>,</mml:mo>                                 <mml:msub>                                    <mml:mi>&#x003b2;</mml:mi>                                    <mml:mrow>                                       <mml:mi>g</mml:mi>                                       <mml:mi>k</mml:mi>                                    </mml:mrow>                                 </mml:msub>                                 <mml:mo stretchy="false">)</mml:mo>                              </mml:mrow>                              <mml:mo>]</mml:mo>                           </mml:mrow>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>equals, up to a constant term:</p><p><disp-formula id="bmcM18"><label>(18)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M45" name="1753-6561-2-S4-S7-i39" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:mn>0.5</mml:mn>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>&#x003c8;</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:msub>                              <mml:mi>a</mml:mi>                              <mml:mrow>                                 <mml:mi>g</mml:mi>                                 <mml:mi>k</mml:mi>                              </mml:mrow>                           </mml:msub>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo>+</mml:mo>                           <mml:mi>log</mml:mi>                           <mml:mo>&#x02061;</mml:mo>                           <mml:msub>                              <mml:mi>b</mml:mi>                              <mml:mrow>                                 <mml:mi>g</mml:mi>                                 <mml:mi>k</mml:mi>                              </mml:mrow>                           </mml:msub>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo>&#x02212;</mml:mo>                           <mml:mn>0.5</mml:mn>                           <mml:msub>                              <mml:mi>a</mml:mi>                              <mml:mrow>                                 <mml:mi>g</mml:mi>                                 <mml:mi>k</mml:mi>                              </mml:mrow>                           </mml:msub>                           <mml:msub>                              <mml:mi>b</mml:mi>                              <mml:mrow>                                 <mml:mi>g</mml:mi>                                 <mml:mi>k</mml:mi>                              </mml:mrow>                           </mml:msub>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:msup>                              <mml:mrow>                                 <mml:mo stretchy="false">(</mml:mo>                                 <mml:msub>                                    <mml:mi>E</mml:mi>                                    <mml:mrow>                                       <mml:mi>d</mml:mi>                                       <mml:mi>g</mml:mi>                                    </mml:mrow>                                 </mml:msub>                                 <mml:mo>&#x02212;</mml:mo>                                 <mml:msub>                                    <mml:mi>m</mml:mi>                                    <mml:mrow>                                       <mml:mi>g</mml:mi>                                       <mml:mi>k</mml:mi>                                    </mml:mrow>                                 </mml:msub>                                 <mml:mo stretchy="false">)</mml:mo>                              </mml:mrow>                              <mml:mn>2</mml:mn>                           </mml:msup>                           <mml:mo>+</mml:mo>                           <mml:msubsup>                              <mml:mi>v</mml:mi>                              <mml:mrow>                                 <mml:mi>g</mml:mi>                                 <mml:mi>k</mml:mi>                              </mml:mrow>                              <mml:mrow>                                 <mml:mo>&#x02212;</mml:mo>                                 <mml:mn>1</mml:mn>                              </mml:mrow>                           </mml:msubsup>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo>.</mml:mo>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>We also use approximating methods [<xref ref-type="bibr" rid="B9">9</xref>] to estimate log <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M46" name="1753-6561-2-S4-S7-i40" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mo>\</mml:mo><mml:mi>d</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>&#x02061;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>&#x003b1;</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:msub><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02260;</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:msup><mml:mi>g</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:semantics></mml:math></inline-formula>. For this purpose, we observe, for any positive random variable <italic>x</italic>, that</p><p><disp-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M47" name="1753-6561-2-S4-S7-i41" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:mi mathvariant="double-struck">E</mml:mi>                           <mml:mrow>                              <mml:mo>(</mml:mo>                              <mml:mrow>                                 <mml:mi>log</mml:mi>                                 <mml:mo>&#x02061;</mml:mo>                                 <mml:mo stretchy="false">(</mml:mo>                                 <mml:msub>                                    <mml:mi>&#x003b1;</mml:mi>                                    <mml:mi>k</mml:mi>                                 </mml:msub>                                 <mml:mo>+</mml:mo>                                 <mml:mi>x</mml:mi>                                 <mml:mo stretchy="false">)</mml:mo>                              </mml:mrow>                              <mml:mo>)</mml:mo>                           </mml:mrow>                           <mml:mo>&#x02248;</mml:mo>                           <mml:mi>log</mml:mi>                           <mml:mo>&#x02061;</mml:mo>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:msub>                              <mml:mi>&#x003b1;</mml:mi>                              <mml:mi>k</mml:mi>                           </mml:msub>                           <mml:mo>+</mml:mo>                           <mml:mi mathvariant="double-struck">E</mml:mi>                           <mml:mi>x</mml:mi>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo>&#x02212;</mml:mo>                           <mml:mfrac>                              <mml:mrow>                                 <mml:mtext>Var</mml:mtext>                                 <mml:mo stretchy="false">(</mml:mo>                                 <mml:mi>x</mml:mi>                                 <mml:mo stretchy="false">)</mml:mo>                              </mml:mrow>                              <mml:mrow>                                 <mml:mn>2</mml:mn>                                 <mml:msup>                                    <mml:mrow>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:msub>                                          <mml:mi>&#x003b1;</mml:mi>                                          <mml:mi>k</mml:mi>                                       </mml:msub>                                       <mml:mo>+</mml:mo>                                       <mml:mi mathvariant="double-struck">E</mml:mi>                                       <mml:mi>x</mml:mi>                                       <mml:mo stretchy="false">)</mml:mo>                                    </mml:mrow>                                    <mml:mn>2</mml:mn>                                 </mml:msup>                              </mml:mrow>                           </mml:mfrac>                           <mml:mo>,</mml:mo>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M48" name="1753-6561-2-S4-S7-i42" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mo>\</mml:mo><mml:mi>d</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:msub><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02260;</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:msup><mml:mi>g</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msub><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02260;</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:msup><mml:mi>g</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:semantics></mml:math></inline-formula>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M49" name="1753-6561-2-S4-S7-i43" overflow="scroll"><mml:semantics><mml:mrow><mml:mtext>Var</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:msub><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02260;</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:msup><mml:mi>g</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msub><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02260;</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:msup><mml:mi>g</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:msup><mml:mi>g</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:semantics></mml:math></inline-formula>. Plugging the above observations into equation (17) yields the desired E-step updates.</p><p>For the updates for <italic>q</italic>(&#x00398;), the updates are essentially the same as those in [<xref ref-type="bibr" rid="B6">6</xref>,<xref ref-type="bibr" rid="B7">7</xref>] since the associated terms with variables with &#x00398; in <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M50" name="1753-6561-2-S4-S7-i44" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mo>\</mml:mo><mml:mi>&#x003bc;</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>&#x02061;</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>&#x00398;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:semantics></mml:math></inline-formula>[log <italic>p</italic>(<italic>E</italic>, <italic>Z</italic>|&#x00398;)] are exact the same, that is, &#x00398; only appears in the Normal distribution. Hence, noting that the product of two Gamma (Normal) distributions is a Gamma (Normal) distribution, we can obtain, from equations (16) and (9), the M-step updates.</p></sec><sec><title>Free energy bound</title><p>The free-energy lower bound of marginalized VB is defined by equation (6):</p><p><disp-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M51" name="1753-6561-2-S4-S7-i45" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:mi>&#x02112;</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>R</mml:mi>                           <mml:mo>;</mml:mo>                           <mml:mi>&#x00398;</mml:mi>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo>=</mml:mo>                           <mml:msub>                              <mml:mi mathvariant="double-struck">E</mml:mi>                              <mml:mi>q</mml:mi>                           </mml:msub>                           <mml:mo stretchy="false">[</mml:mo>                           <mml:mi>log</mml:mi>                           <mml:mo>&#x02061;</mml:mo>                           <mml:mi>p</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>E</mml:mi>                           <mml:mo>,</mml:mo>                           <mml:mi>Z</mml:mi>                           <mml:mo>|</mml:mo>                           <mml:mi>&#x00398;</mml:mi>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo stretchy="false">]</mml:mo>                           <mml:mo>&#x02212;</mml:mo>                           <mml:msub>                              <mml:mi mathvariant="double-struck">E</mml:mi>                              <mml:mrow>                                 <mml:mi>q</mml:mi>                                 <mml:mo stretchy="false">(</mml:mo>                                 <mml:mi>Z</mml:mi>                                 <mml:mo stretchy="false">)</mml:mo>                              </mml:mrow>                           </mml:msub>                           <mml:mo stretchy="false">[</mml:mo>                           <mml:mi>q</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>Z</mml:mi>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo stretchy="false">]</mml:mo>                           <mml:mo>&#x02212;</mml:mo>                           <mml:mtext>KL</mml:mtext>                           <mml:mrow>                              <mml:mo>(</mml:mo>                              <mml:mrow>                                 <mml:mi>q</mml:mi>                                 <mml:mo stretchy="false">(</mml:mo>                                 <mml:mi>&#x003bc;</mml:mi>                                 <mml:mo stretchy="false">)</mml:mo>                                 <mml:mo>|</mml:mo>                                 <mml:mo>|</mml:mo>                                 <mml:mi>p</mml:mi>                                 <mml:mo stretchy="false">(</mml:mo>                                 <mml:mi>&#x003bc;</mml:mi>                                 <mml:mo stretchy="false">)</mml:mo>                              </mml:mrow>                              <mml:mo>)</mml:mo>                           </mml:mrow>                           <mml:mo>&#x02212;</mml:mo>                           <mml:mtext>KL</mml:mtext>                           <mml:mrow>                              <mml:mo>(</mml:mo>                              <mml:mrow>                                 <mml:mi>q</mml:mi>                                 <mml:mo stretchy="false">(</mml:mo>                                 <mml:mi>&#x003b2;</mml:mi>                                 <mml:mo stretchy="false">)</mml:mo>                                 <mml:mo>|</mml:mo>                                 <mml:mo>|</mml:mo>                                 <mml:mi>p</mml:mi>                                 <mml:mo stretchy="false">(</mml:mo>                                 <mml:mi>&#x003b2;</mml:mi>                                 <mml:mo stretchy="false">)</mml:mo>                              </mml:mrow>                              <mml:mo>)</mml:mo>                           </mml:mrow>                           <mml:mo>.</mml:mo>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>From the fact that &#x00393;(<italic>x </italic>+ 1) = <italic>x</italic>&#x00393;(<italic>x</italic>) for any <italic>x </italic>&#x0003e; 0, we know that <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M52" name="1753-6561-2-S4-S7-i46" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>&#x00393;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>&#x003b1;</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:msub><mml:mo>&#x02211;</mml:mo><mml:mi>g</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>&#x00393;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>&#x003b1;</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:msubsup><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>&#x003b1;</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>g</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:mrow></mml:semantics></mml:math></inline-formula>, where we use the convention <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M53" name="1753-6561-2-S4-S7-i47" overflow="scroll"><mml:semantics><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="script">G</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:msubsup><mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:mrow></mml:semantics></mml:math></inline-formula>. Putting this equation into the expression (10) of log likelihood, we obtain:</p><p><disp-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M54" name="1753-6561-2-S4-S7-i48" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:mtable columnalign="left">                              <mml:mtr columnalign="left">                                 <mml:mtd columnalign="left">                                    <mml:mrow>                                       <mml:msub>                                          <mml:mi mathvariant="double-struck">E</mml:mi>                                          <mml:mi>q</mml:mi>                                       </mml:msub>                                       <mml:mo stretchy="false">[</mml:mo>                                       <mml:mi>log</mml:mi>                                       <mml:mo>&#x02061;</mml:mo>                                       <mml:mi>p</mml:mi>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:mi>E</mml:mi>                                       <mml:mo>,</mml:mo>                                       <mml:mi>Z</mml:mi>                                       <mml:mo>|</mml:mo>                                       <mml:mi>&#x00398;</mml:mi>                                       <mml:mo stretchy="false">)</mml:mo>                                       <mml:mo stretchy="false">]</mml:mo>                                       <mml:mo>=</mml:mo>                                       <mml:mi mathvariant="script">D</mml:mi>                                       <mml:mi>log</mml:mi>                                       <mml:mo>&#x02061;</mml:mo>                                       <mml:mi>&#x00393;</mml:mi>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:mstyle displaystyle="true">                                          <mml:msub>                                             <mml:mo>&#x02211;</mml:mo>                                             <mml:mi>k</mml:mi>                                          </mml:msub>                                          <mml:mrow>                                             <mml:msub>                                                <mml:mi>&#x003b1;</mml:mi>                                                <mml:mi>k</mml:mi>                                             </mml:msub>                                          </mml:mrow>                                       </mml:mstyle>                                       <mml:mo stretchy="false">)</mml:mo>                                       <mml:mo>&#x02212;</mml:mo>                                       <mml:mi mathvariant="script">D</mml:mi>                                       <mml:mstyle displaystyle="true">                                          <mml:msub>                                             <mml:mo>&#x02211;</mml:mo>                                             <mml:mi>k</mml:mi>                                          </mml:msub>                                          <mml:mrow>                                             <mml:mi>log</mml:mi>                                             <mml:mo>&#x02061;</mml:mo>                                             <mml:mi>&#x00393;</mml:mi>                                             <mml:mo stretchy="false">(</mml:mo>                                             <mml:msub>                                                <mml:mi>&#x003b1;</mml:mi>                                                <mml:mi>k</mml:mi>                                             </mml:msub>                                             <mml:mo stretchy="false">)</mml:mo>                                             <mml:mo>&#x02212;</mml:mo>                                             <mml:mi mathvariant="script">D</mml:mi>                                             <mml:mi>log</mml:mi>                                             <mml:mo>&#x02061;</mml:mo>                                             <mml:mi>&#x00393;</mml:mi>                                             <mml:mo stretchy="false">(</mml:mo>                                             <mml:mstyle displaystyle="true">                                                <mml:msub>                                                   <mml:mo>&#x02211;</mml:mo>                                                   <mml:mi>k</mml:mi>                                                </mml:msub>                                                <mml:mrow>                                                   <mml:msub>                                                      <mml:mi>&#x003b1;</mml:mi>                                                      <mml:mi>k</mml:mi>                                                   </mml:msub>                                                </mml:mrow>                                             </mml:mstyle>                                             <mml:mo>+</mml:mo>                                             <mml:mi mathvariant="script">G</mml:mi>                                             <mml:mo stretchy="false">)</mml:mo>                                          </mml:mrow>                                       </mml:mstyle>                                    </mml:mrow>                                 </mml:mtd>                              </mml:mtr>                              <mml:mtr columnalign="left">                                 <mml:mtd columnalign="left">                                    <mml:mrow>                                       <mml:mo>+</mml:mo>                                       <mml:mstyle displaystyle="true">                                          <mml:msub>                                             <mml:mo>&#x02211;</mml:mo>                                             <mml:mrow>                                                <mml:mi>d</mml:mi>                                                <mml:mo>,</mml:mo>                                                <mml:mi>k</mml:mi>                                             </mml:mrow>                                          </mml:msub>                                          <mml:mrow>                                             <mml:msub>                                                <mml:mi mathvariant="double-struck">E</mml:mi>                                                <mml:mi>q</mml:mi>                                             </mml:msub>                                             <mml:mo stretchy="false">[</mml:mo>                                             <mml:mi>log</mml:mi>                                             <mml:mo>&#x02061;</mml:mo>                                             <mml:mi>&#x00393;</mml:mi>                                             <mml:mo stretchy="false">(</mml:mo>                                             <mml:msub>                                                <mml:mi>&#x003b1;</mml:mi>                                                <mml:mi>k</mml:mi>                                             </mml:msub>                                             <mml:mo>+</mml:mo>                                             <mml:mstyle displaystyle="true">                                                <mml:msub>                                                   <mml:mo>&#x02211;</mml:mo>                                                   <mml:mi>g</mml:mi>                                                </mml:msub>                                                <mml:mrow>                                                   <mml:msub>                                                      <mml:mi>Z</mml:mi>                                                      <mml:mrow>                                                         <mml:mi>d</mml:mi>                                                         <mml:mi>g</mml:mi>                                                         <mml:mo>,</mml:mo>                                                         <mml:mi>k</mml:mi>                                                      </mml:mrow>                                                   </mml:msub>                                                </mml:mrow>                                             </mml:mstyle>                                             <mml:mo stretchy="false">)</mml:mo>                                             <mml:mo stretchy="false">]</mml:mo>                                             <mml:mo>+</mml:mo>                                             <mml:mstyle displaystyle="true">                                                <mml:msub>                                                   <mml:mo>&#x02211;</mml:mo>                                                   <mml:mrow>                                                      <mml:mi>d</mml:mi>                                                      <mml:mo>,</mml:mo>                                                      <mml:mi>g</mml:mi>                                                      <mml:mo>,</mml:mo>                                                      <mml:mi>k</mml:mi>                                                   </mml:mrow>                                                </mml:msub>                                                <mml:mrow>                                                   <mml:msub>                                                      <mml:mi>r</mml:mi>                                                      <mml:mrow>                                                         <mml:mi>d</mml:mi>                                                         <mml:mi>g</mml:mi>                                                         <mml:mo>,</mml:mo>                                                         <mml:mi>k</mml:mi>                                                      </mml:mrow>                                                   </mml:msub>                                                </mml:mrow>                                             </mml:mstyle>                                             <mml:mi>log</mml:mi>                                             <mml:mo>&#x02061;</mml:mo>                                             <mml:mi mathvariant="script">N</mml:mi>                                             <mml:mo stretchy="false">(</mml:mo>                                             <mml:msub>                                                <mml:mi>E</mml:mi>                                                <mml:mrow>                                                   <mml:mi>d</mml:mi>                                                   <mml:mi>g</mml:mi>                                                </mml:mrow>                                             </mml:msub>                                             <mml:mo>|</mml:mo>                                             <mml:msub>                                                <mml:mi>&#x003bc;</mml:mi>                                                <mml:mrow>                                                   <mml:mi>g</mml:mi>                                                   <mml:mi>k</mml:mi>                                                </mml:mrow>                                             </mml:msub>                                             <mml:mo>,</mml:mo>                                             <mml:msub>                                                <mml:mi>&#x003c3;</mml:mi>                                                <mml:mrow>                                                   <mml:mi>g</mml:mi>                                                   <mml:mi>k</mml:mi>                                                </mml:mrow>                                             </mml:msub>                                             <mml:mo stretchy="false">)</mml:mo>                                          </mml:mrow>                                       </mml:mstyle>                                    </mml:mrow>                                 </mml:mtd>                              </mml:mtr>                              <mml:mtr columnalign="left">                                 <mml:mtd columnalign="left">                                    <mml:mrow>                                       <mml:mo>=</mml:mo>                                       <mml:mi mathvariant="script">D</mml:mi>                                       <mml:mi>log</mml:mi>                                       <mml:mo>&#x02061;</mml:mo>                                       <mml:mi>&#x00393;</mml:mi>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:mstyle displaystyle="true">                                          <mml:msub>                                             <mml:mo>&#x02211;</mml:mo>                                             <mml:mi>k</mml:mi>                                          </mml:msub>                                          <mml:mrow>                                             <mml:msub>                                                <mml:mi>&#x003b1;</mml:mi>                                                <mml:mi>k</mml:mi>                                             </mml:msub>                                          </mml:mrow>                                       </mml:mstyle>                                       <mml:mo stretchy="false">)</mml:mo>                                       <mml:mo>&#x02212;</mml:mo>                                       <mml:mi mathvariant="script">D</mml:mi>                                       <mml:mi>log</mml:mi>                                       <mml:mo>&#x02061;</mml:mo>                                       <mml:mi>&#x00393;</mml:mi>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:mstyle displaystyle="true">                                          <mml:msub>                                             <mml:mo>&#x02211;</mml:mo>                                             <mml:mi>k</mml:mi>                                          </mml:msub>                                          <mml:mrow>                                             <mml:msub>                                                <mml:mi>&#x003b1;</mml:mi>                                                <mml:mi>k</mml:mi>                                             </mml:msub>                                          </mml:mrow>                                       </mml:mstyle>                                       <mml:mo>+</mml:mo>                                       <mml:mi mathvariant="script">G</mml:mi>                                       <mml:mo stretchy="false">)</mml:mo>                                    </mml:mrow>                                 </mml:mtd>                              </mml:mtr>                              <mml:mtr columnalign="left">                                 <mml:mtd columnalign="left">                                    <mml:mrow>                                       <mml:mo>+</mml:mo>                                       <mml:mstyle displaystyle="true">                                          <mml:msub>                                             <mml:mo>&#x02211;</mml:mo>                                             <mml:mrow>                                                <mml:mi>d</mml:mi>                                                <mml:mo>,</mml:mo>                                                <mml:mi>g</mml:mi>                                                <mml:mo>,</mml:mo>                                                <mml:mi>k</mml:mi>                                             </mml:mrow>                                          </mml:msub>                                          <mml:mrow>                                             <mml:msub>                                                <mml:mi>r</mml:mi>                                                <mml:mrow>                                                   <mml:mi>d</mml:mi>                                                   <mml:mi>g</mml:mi>                                                   <mml:mo>,</mml:mo>                                                   <mml:mi>k</mml:mi>                                                </mml:mrow>                                             </mml:msub>                                          </mml:mrow>                                       </mml:mstyle>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:msub>                                          <mml:mi mathvariant="double-struck">E</mml:mi>                                          <mml:mi>q</mml:mi>                                       </mml:msub>                                       <mml:mo stretchy="false">[</mml:mo>                                       <mml:mi>log</mml:mi>                                       <mml:mo>&#x02061;</mml:mo>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:msub>                                          <mml:mi>&#x003b1;</mml:mi>                                          <mml:mi>k</mml:mi>                                       </mml:msub>                                       <mml:mo>+</mml:mo>                                       <mml:mstyle displaystyle="true">                                          <mml:msub>                                             <mml:mo>&#x02211;</mml:mo>                                             <mml:mrow>                                                <mml:mi>j</mml:mi>                                                <mml:mo>&#x02265;</mml:mo>                                                <mml:mi>g</mml:mi>                                                <mml:mo>+</mml:mo>                                                <mml:mn>1</mml:mn>                                             </mml:mrow>                                          </mml:msub>                                          <mml:mrow>                                             <mml:msub>                                                <mml:mi>Z</mml:mi>                                                <mml:mrow>                                                   <mml:mi>d</mml:mi>                                                   <mml:mi>j</mml:mi>                                                   <mml:mo>,</mml:mo>                                                   <mml:mi>k</mml:mi>                                                </mml:mrow>                                             </mml:msub>                                          </mml:mrow>                                       </mml:mstyle>                                       <mml:mo stretchy="false">)</mml:mo>                                       <mml:mo stretchy="false">]</mml:mo>                                       <mml:mo>+</mml:mo>                                       <mml:mi>log</mml:mi>                                       <mml:mo>&#x02061;</mml:mo>                                       <mml:mi mathvariant="script">N</mml:mi>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:msub>                                          <mml:mi>E</mml:mi>                                          <mml:mrow>                                             <mml:mi>d</mml:mi>                                             <mml:mi>g</mml:mi>                                          </mml:mrow>                                       </mml:msub>                                       <mml:mo>|</mml:mo>                                       <mml:msub>                                          <mml:mi>&#x003bc;</mml:mi>                                          <mml:mrow>                                             <mml:mi>g</mml:mi>                                             <mml:mi>k</mml:mi>                                          </mml:mrow>                                       </mml:msub>                                       <mml:mo>,</mml:mo>                                       <mml:msub>                                          <mml:mi>&#x003c3;</mml:mi>                                          <mml:mrow>                                             <mml:mi>g</mml:mi>                                             <mml:mi>k</mml:mi>                                          </mml:mrow>                                       </mml:msub>                                       <mml:mo stretchy="false">)</mml:mo>                                       <mml:mo stretchy="false">)</mml:mo>                                       <mml:mo>.</mml:mo>                                    </mml:mrow>                                 </mml:mtd>                              </mml:mtr>                           </mml:mtable>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>Since we used the convention <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M55" name="1753-6561-2-S4-S7-i49" overflow="scroll"><mml:semantics><mml:mrow><mml:mstyle displaystyle="true"><mml:msub><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>&#x02265;</mml:mo><mml:mi mathvariant="script">G</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:mrow></mml:semantics></mml:math></inline-formula>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M56" name="1753-6561-2-S4-S7-i50" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi mathvariant="double-struck">E</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>&#x02061;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>&#x003b1;</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:msub><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>&#x02265;</mml:mo><mml:mi mathvariant="script">G</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>log</mml:mi><mml:mo>&#x02061;</mml:mo><mml:msub><mml:mi>&#x003b1;</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>. It remains to estimate the term <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M57" name="1753-6561-2-S4-S7-i51" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi mathvariant="double-struck">E</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>&#x02061;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>&#x003b1;</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:msub><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>&#x02265;</mml:mo><mml:mi>g</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:semantics></mml:math></inline-formula> for <italic>g </italic>= 1,..., <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M58" name="1753-6561-2-S4-S7-i2" overflow="scroll"><mml:semantics><mml:mi mathvariant="script">G</mml:mi></mml:semantics></mml:math></inline-formula> - 1. To this end, we use the approximation (18) again to get:</p><p><disp-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M59" name="1753-6561-2-S4-S7-i52" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:msub>                              <mml:mi mathvariant="double-struck">E</mml:mi>                              <mml:mi>q</mml:mi>                           </mml:msub>                           <mml:mo stretchy="false">[</mml:mo>                           <mml:mi>log</mml:mi>                           <mml:mo>&#x02061;</mml:mo>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:msub>                              <mml:mi>&#x003b1;</mml:mi>                              <mml:mi>k</mml:mi>                           </mml:msub>                           <mml:mo>+</mml:mo>                           <mml:mstyle displaystyle="true">                              <mml:munder>                                 <mml:mo>&#x02211;</mml:mo>                                 <mml:mrow>                                    <mml:mi>j</mml:mi>                                    <mml:mo>&#x02265;</mml:mo>                                    <mml:mi>g</mml:mi>                                    <mml:mo>+</mml:mo>                                    <mml:mn>1</mml:mn>                                 </mml:mrow>                              </mml:munder>                              <mml:mrow>                                 <mml:msub>                                    <mml:mi>Z</mml:mi>                                    <mml:mrow>                                       <mml:mi>d</mml:mi>                                       <mml:mi>j</mml:mi>                                       <mml:mo>,</mml:mo>                                       <mml:mi>k</mml:mi>                                    </mml:mrow>                                 </mml:msub>                              </mml:mrow>                           </mml:mstyle>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo stretchy="false">]</mml:mo>                           <mml:mo>&#x02248;</mml:mo>                           <mml:mi>log</mml:mi>                           <mml:mo>&#x02061;</mml:mo>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:msub>                              <mml:mi>&#x003b1;</mml:mi>                              <mml:mi>k</mml:mi>                           </mml:msub>                           <mml:mo>+</mml:mo>                           <mml:mstyle displaystyle="true">                              <mml:munder>                                 <mml:mo>&#x02211;</mml:mo>                                 <mml:mrow>                                    <mml:mi>j</mml:mi>                                    <mml:mo>&#x02265;</mml:mo>                                    <mml:mi>g</mml:mi>                                    <mml:mo>+</mml:mo>                                    <mml:mn>1</mml:mn>                                 </mml:mrow>                              </mml:munder>                              <mml:mrow>                                 <mml:msub>                                    <mml:mi>r</mml:mi>                                    <mml:mrow>                                       <mml:mi>d</mml:mi>                                       <mml:mi>j</mml:mi>                                       <mml:mo>,</mml:mo>                                       <mml:mi>k</mml:mi>                                    </mml:mrow>                                 </mml:msub>                              </mml:mrow>                           </mml:mstyle>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo>&#x02212;</mml:mo>                           <mml:mfrac>                              <mml:mrow>                                 <mml:mstyle displaystyle="true">                                    <mml:msub>                                       <mml:mo>&#x02211;</mml:mo>                                       <mml:mrow>                                          <mml:mi>j</mml:mi>                                          <mml:mo>&#x02265;</mml:mo>                                          <mml:mi>g</mml:mi>                                          <mml:mo>+</mml:mo>                                          <mml:mn>1</mml:mn>                                       </mml:mrow>                                    </mml:msub>                                    <mml:mrow>                                       <mml:msub>                                          <mml:mi>r</mml:mi>                                          <mml:mrow>                                             <mml:mi>d</mml:mi>                                             <mml:mi>j</mml:mi>                                             <mml:mo>,</mml:mo>                                             <mml:mi>k</mml:mi>                                          </mml:mrow>                                       </mml:msub>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:mn>1</mml:mn>                                       <mml:mo>&#x02212;</mml:mo>                                       <mml:msub>                                          <mml:mi>r</mml:mi>                                          <mml:mrow>                                             <mml:mi>d</mml:mi>                                             <mml:mi>j</mml:mi>                                             <mml:mo>,</mml:mo>                                             <mml:mi>k</mml:mi>                                          </mml:mrow>                                       </mml:msub>                                       <mml:mo stretchy="false">)</mml:mo>                                    </mml:mrow>                                 </mml:mstyle>                              </mml:mrow>                              <mml:mrow>                                 <mml:mn>2</mml:mn>                                 <mml:msup>                                    <mml:mrow>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:msub>                                          <mml:mi>&#x003b1;</mml:mi>                                          <mml:mi>k</mml:mi>                                       </mml:msub>                                       <mml:mo>+</mml:mo>                                       <mml:mstyle displaystyle="true">                                          <mml:msub>                                             <mml:mo>&#x02211;</mml:mo>                                             <mml:mrow>                                                <mml:mi>j</mml:mi>                                                <mml:mo>&#x02265;</mml:mo>                                                <mml:mi>g</mml:mi>                                                <mml:mo>+</mml:mo>                                                <mml:mn>1</mml:mn>                                             </mml:mrow>                                          </mml:msub>                                          <mml:mrow>                                             <mml:msub>                                                <mml:mi>r</mml:mi>                                                <mml:mrow>                                                   <mml:mi>d</mml:mi>                                                   <mml:mi>j</mml:mi>                                                   <mml:mo>,</mml:mo>                                                   <mml:mi>k</mml:mi>                                                </mml:mrow>                                             </mml:msub>                                          </mml:mrow>                                       </mml:mstyle>                                       <mml:mo stretchy="false">)</mml:mo>                                    </mml:mrow>                                    <mml:mn>2</mml:mn>                                 </mml:msup>                              </mml:mrow>                           </mml:mfrac>                           <mml:mo>.</mml:mo>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>Consequently, we conclude:</p><p><disp-formula id="bmcM19"><label>(19)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M60" name="1753-6561-2-S4-S7-i53" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:mtable columnalign="left">                              <mml:mtr columnalign="left">                                 <mml:mtd columnalign="left">                                    <mml:mrow>                                       <mml:msub>                                          <mml:mi mathvariant="double-struck">E</mml:mi>                                          <mml:mi>q</mml:mi>                                       </mml:msub>                                       <mml:mo stretchy="false">[</mml:mo>                                       <mml:mi>log</mml:mi>                                       <mml:mo>&#x02061;</mml:mo>                                       <mml:mi>p</mml:mi>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:mi>E</mml:mi>                                       <mml:mo>,</mml:mo>                                       <mml:mi>Z</mml:mi>                                       <mml:mo>|</mml:mo>                                       <mml:mi>&#x00398;</mml:mi>                                       <mml:mo stretchy="false">)</mml:mo>                                       <mml:mo>=</mml:mo>                                       <mml:mi mathvariant="script">D</mml:mi>                                       <mml:mi>log</mml:mi>                                       <mml:mo>&#x02061;</mml:mo>                                       <mml:mi>&#x00393;</mml:mi>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:mstyle displaystyle="true">                                          <mml:msub>                                             <mml:mo>&#x02211;</mml:mo>                                             <mml:mi>k</mml:mi>                                          </mml:msub>                                          <mml:mrow>                                             <mml:msub>                                                <mml:mi>&#x003b1;</mml:mi>                                                <mml:mi>k</mml:mi>                                             </mml:msub>                                          </mml:mrow>                                       </mml:mstyle>                                       <mml:mo stretchy="false">)</mml:mo>                                       <mml:mo>&#x02212;</mml:mo>                                       <mml:mi mathvariant="script">D</mml:mi>                                       <mml:mi>log</mml:mi>                                       <mml:mo>&#x02061;</mml:mo>                                       <mml:mi>&#x00393;</mml:mi>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:mstyle displaystyle="true">                                          <mml:msub>                                             <mml:mo>&#x02211;</mml:mo>                                             <mml:mi>k</mml:mi>                                          </mml:msub>                                          <mml:mrow>                                             <mml:msub>                                                <mml:mi>&#x003b1;</mml:mi>                                                <mml:mi>k</mml:mi>                                             </mml:msub>                                             <mml:mo>+</mml:mo>                                             <mml:mi mathvariant="script">G</mml:mi>                                          </mml:mrow>                                       </mml:mstyle>                                       <mml:mo stretchy="false">)</mml:mo>                                    </mml:mrow>                                 </mml:mtd>                              </mml:mtr>                              <mml:mtr columnalign="left">                                 <mml:mtd columnalign="left">                                    <mml:mrow>                                       <mml:mo>+</mml:mo>                                       <mml:mstyle displaystyle="true">                                          <mml:msub>                                             <mml:mo>&#x02211;</mml:mo>                                             <mml:mrow>                                                <mml:mi>d</mml:mi>                                                <mml:mo>,</mml:mo>                                                <mml:mi>g</mml:mi>                                                <mml:mo>,</mml:mo>                                                <mml:mi>k</mml:mi>                                             </mml:mrow>                                          </mml:msub>                                          <mml:mrow>                                             <mml:msub>                                                <mml:mi>r</mml:mi>                                                <mml:mrow>                                                   <mml:mi>d</mml:mi>                                                   <mml:mi>g</mml:mi>                                                   <mml:mo>,</mml:mo>                                                   <mml:mi>k</mml:mi>                                                </mml:mrow>                                             </mml:msub>                                          </mml:mrow>                                       </mml:mstyle>                                       <mml:mo stretchy="false">[</mml:mo>                                       <mml:mi>log</mml:mi>                                       <mml:mo>&#x02061;</mml:mo>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:msub>                                          <mml:mi>&#x003b1;</mml:mi>                                          <mml:mi>k</mml:mi>                                       </mml:msub>                                       <mml:mo>+</mml:mo>                                       <mml:mstyle displaystyle="true">                                          <mml:msub>                                             <mml:mo>&#x02211;</mml:mo>                                             <mml:mrow>                                                <mml:mi>j</mml:mi>                                                <mml:mo>&#x02265;</mml:mo>                                                <mml:mi>g</mml:mi>                                                <mml:mo>+</mml:mo>                                                <mml:mn>1</mml:mn>                                             </mml:mrow>                                          </mml:msub>                                          <mml:mrow>                                             <mml:msub>                                                <mml:mi>r</mml:mi>                                                <mml:mrow>                                                   <mml:mi>d</mml:mi>                                                   <mml:mi>j</mml:mi>                                                   <mml:mo>,</mml:mo>                                                   <mml:mi>k</mml:mi>                                                </mml:mrow>                                             </mml:msub>                                          </mml:mrow>                                       </mml:mstyle>                                       <mml:mo stretchy="false">)</mml:mo>                                       <mml:mo>&#x02212;</mml:mo>                                       <mml:mfrac>                                          <mml:mrow>                                             <mml:mstyle displaystyle="true">                                                <mml:msub>                                                   <mml:mo>&#x02211;</mml:mo>                                                   <mml:mrow>                                                      <mml:mi>i</mml:mi>                                                      <mml:mo>&#x02265;</mml:mo>                                                      <mml:mi>g</mml:mi>                                                      <mml:mo>+</mml:mo>                                                      <mml:mn>1</mml:mn>                                                   </mml:mrow>                                                </mml:msub>                                                <mml:mrow>                                                   <mml:msub>                                                      <mml:mi>r</mml:mi>                                                      <mml:mrow>                                                         <mml:mi>d</mml:mi>                                                         <mml:mi>j</mml:mi>                                                         <mml:mo>,</mml:mo>                                                         <mml:mi>k</mml:mi>                                                      </mml:mrow>                                                   </mml:msub>                                                   <mml:mo stretchy="false">(</mml:mo>                                                   <mml:mn>1</mml:mn>                                                   <mml:mo>&#x02212;</mml:mo>                                                   <mml:msub>                                                      <mml:mi>r</mml:mi>                                                      <mml:mrow>                                                         <mml:mi>d</mml:mi>                                                         <mml:mi>j</mml:mi>                                                         <mml:mo>,</mml:mo>                                                         <mml:mi>k</mml:mi>                                                      </mml:mrow>                                                   </mml:msub>                                                   <mml:mo stretchy="false">)</mml:mo>                                                </mml:mrow>                                             </mml:mstyle>                                          </mml:mrow>                                          <mml:mrow>                                             <mml:mn>2</mml:mn>                                             <mml:msup>                                                <mml:mrow>                                                   <mml:mo stretchy="false">(</mml:mo>                                                   <mml:msub>                                                      <mml:mi>&#x003b1;</mml:mi>                                                      <mml:mi>k</mml:mi>                                                   </mml:msub>                                                   <mml:mo>+</mml:mo>                                                   <mml:mstyle displaystyle="true">                                                      <mml:msub>                                                         <mml:mo>&#x02211;</mml:mo>                                                         <mml:mrow>                                                            <mml:mi>j</mml:mi>                                                            <mml:mo>&#x02265;</mml:mo>                                                            <mml:mi>g</mml:mi>                                                            <mml:mo>+</mml:mo>                                                            <mml:mn>1</mml:mn>                                                         </mml:mrow>                                                      </mml:msub>                                                      <mml:mrow>                                                         <mml:msub>                                                            <mml:mi>r</mml:mi>                                                            <mml:mrow>                                                               <mml:mi>d</mml:mi>                                                               <mml:mi>j</mml:mi>                                                               <mml:mo>,</mml:mo>                                                               <mml:mi>k</mml:mi>                                                            </mml:mrow>                                                         </mml:msub>                                                      </mml:mrow>                                                   </mml:mstyle>                                                   <mml:mo stretchy="false">)</mml:mo>                                                </mml:mrow>                                                <mml:mn>2</mml:mn>                                             </mml:msup>                                          </mml:mrow>                                       </mml:mfrac>                                       <mml:mo stretchy="false">]</mml:mo>                                    </mml:mrow>                                 </mml:mtd>                              </mml:mtr>                              <mml:mtr columnalign="left">                                 <mml:mtd columnalign="left">                                    <mml:mrow>                                       <mml:mo>+</mml:mo>                                       <mml:mstyle displaystyle="true">                                          <mml:msub>                                             <mml:mo>&#x02211;</mml:mo>                                             <mml:mrow>                                                <mml:mi>d</mml:mi>                                                <mml:mo>,</mml:mo>                                                <mml:mi>g</mml:mi>                                                <mml:mo>,</mml:mo>                                                <mml:mi>k</mml:mi>                                             </mml:mrow>                                          </mml:msub>                                          <mml:mrow>                                             <mml:msub>                                                <mml:mi>r</mml:mi>                                                <mml:mrow>                                                   <mml:mi>d</mml:mi>                                                   <mml:mi>g</mml:mi>                                                   <mml:mo>,</mml:mo>                                                   <mml:mi>k</mml:mi>                                                </mml:mrow>                                             </mml:msub>                                          </mml:mrow>                                       </mml:mstyle>                                       <mml:mo stretchy="false">[</mml:mo>                                       <mml:mo>&#x02212;</mml:mo>                                       <mml:mn>0.5</mml:mn>                                       <mml:mi>log</mml:mi>                                       <mml:mo>&#x02061;</mml:mo>                                       <mml:mn>2</mml:mn>                                       <mml:mi>&#x003c0;</mml:mi>                                       <mml:mo>+</mml:mo>                                       <mml:mn>0.5</mml:mn>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:mi>&#x003c8;</mml:mi>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:msub>                                          <mml:mi>a</mml:mi>                                          <mml:mrow>                                             <mml:mi>g</mml:mi>                                             <mml:mi>k</mml:mi>                                          </mml:mrow>                                       </mml:msub>                                       <mml:mo stretchy="false">)</mml:mo>                                       <mml:mo>+</mml:mo>                                       <mml:mi>log</mml:mi>                                       <mml:mo>&#x02061;</mml:mo>                                       <mml:msub>                                          <mml:mi>b</mml:mi>                                          <mml:mrow>                                             <mml:mi>g</mml:mi>                                             <mml:mi>k</mml:mi>                                          </mml:mrow>                                       </mml:msub>                                       <mml:mo stretchy="false">)</mml:mo>                                    </mml:mrow>                                 </mml:mtd>                              </mml:mtr>                              <mml:mtr columnalign="left">                                 <mml:mtd columnalign="left">                                    <mml:mrow>                                       <mml:mo>&#x02212;</mml:mo>                                       <mml:mn>0.5</mml:mn>                                       <mml:msub>                                          <mml:mi>a</mml:mi>                                          <mml:mrow>                                             <mml:mi>g</mml:mi>                                             <mml:mi>k</mml:mi>                                          </mml:mrow>                                       </mml:msub>                                       <mml:msub>                                          <mml:mi>b</mml:mi>                                          <mml:mrow>                                             <mml:mi>g</mml:mi>                                             <mml:mi>k</mml:mi>                                          </mml:mrow>                                       </mml:msub>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:mfrac>                                          <mml:mn>1</mml:mn>                                          <mml:mrow>                                             <mml:msub>                                                <mml:mi>v</mml:mi>                                                <mml:mrow>                                                   <mml:mi>g</mml:mi>                                                   <mml:mi>k</mml:mi>                                                </mml:mrow>                                             </mml:msub>                                          </mml:mrow>                                       </mml:mfrac>                                       <mml:mo>+</mml:mo>                                       <mml:msup>                                          <mml:mrow>                                             <mml:mo stretchy="false">(</mml:mo>                                             <mml:msub>                                                <mml:mi>E</mml:mi>                                                <mml:mrow>                                                   <mml:mi>d</mml:mi>                                                   <mml:mi>g</mml:mi>                                                </mml:mrow>                                             </mml:msub>                                             <mml:mo>&#x02212;</mml:mo>                                             <mml:msub>                                                <mml:mi>m</mml:mi>                                                <mml:mrow>                                                   <mml:mi>g</mml:mi>                                                   <mml:mi>k</mml:mi>                                                </mml:mrow>                                             </mml:msub>                                             <mml:mo stretchy="false">)</mml:mo>                                          </mml:mrow>                                          <mml:mn>2</mml:mn>                                       </mml:msup>                                       <mml:mo stretchy="false">]</mml:mo>                                       <mml:mo>.</mml:mo>                                    </mml:mrow>                                 </mml:mtd>                              </mml:mtr>                           </mml:mtable>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>where the convention <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M61" name="1753-6561-2-S4-S7-i54" overflow="scroll"><mml:semantics><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>&#x02265;</mml:mo><mml:mi mathvariant="script">G</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:msubsup><mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:mrow></mml:semantics></mml:math></inline-formula> is used again.</p><p>In addition,</p><p><disp-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M62" name="1753-6561-2-S4-S7-i55" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:msub>                              <mml:mi mathvariant="double-struck">E</mml:mi>                              <mml:mrow>                                 <mml:mi>q</mml:mi>                                 <mml:mo stretchy="false">(</mml:mo>                                 <mml:mi>Z</mml:mi>                                 <mml:mo stretchy="false">)</mml:mo>                              </mml:mrow>                           </mml:msub>                           <mml:mrow>                              <mml:mo>[</mml:mo>                              <mml:mrow>                                 <mml:mi>log</mml:mi>                                 <mml:mo>&#x02061;</mml:mo>                                 <mml:mi>q</mml:mi>                                 <mml:mo stretchy="false">(</mml:mo>                                 <mml:mi>Z</mml:mi>                                 <mml:mo stretchy="false">)</mml:mo>                              </mml:mrow>                              <mml:mo>]</mml:mo>                           </mml:mrow>                           <mml:mo>=</mml:mo>                           <mml:mstyle displaystyle="true">                              <mml:munder>                                 <mml:mo>&#x02211;</mml:mo>                                 <mml:mrow>                                    <mml:mi>d</mml:mi>                                    <mml:mo>,</mml:mo>                                    <mml:mi>g</mml:mi>                                    <mml:mo>,</mml:mo>                                    <mml:mi>k</mml:mi>                                 </mml:mrow>                              </mml:munder>                              <mml:mrow>                                 <mml:msub>                                    <mml:mi>r</mml:mi>                                    <mml:mrow>                                       <mml:mi>d</mml:mi>                                       <mml:mi>g</mml:mi>                                       <mml:mo>,</mml:mo>                                       <mml:mi>k</mml:mi>                                    </mml:mrow>                                 </mml:msub>                                 <mml:mi>log</mml:mi>                                 <mml:mo>&#x02061;</mml:mo>                                 <mml:msub>                                    <mml:mi>r</mml:mi>                                    <mml:mrow>                                       <mml:mi>d</mml:mi>                                       <mml:mi>g</mml:mi>                                       <mml:mo>,</mml:mo>                                       <mml:mi>k</mml:mi>                                    </mml:mrow>                                 </mml:msub>                              </mml:mrow>                           </mml:mstyle>                           <mml:mo>.</mml:mo>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>For the KL divergences, we have:</p><p><disp-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M63" name="1753-6561-2-S4-S7-i56" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:mtext>KL</mml:mtext>                           <mml:mrow>                              <mml:mo>(</mml:mo>                              <mml:mrow>                                 <mml:mi>q</mml:mi>                                 <mml:mo stretchy="false">(</mml:mo>                                 <mml:mi>&#x003bc;</mml:mi>                                 <mml:mo stretchy="false">)</mml:mo>                                 <mml:mo>|</mml:mo>                                 <mml:mo>|</mml:mo>                                 <mml:mi>p</mml:mi>                                 <mml:mo stretchy="false">(</mml:mo>                                 <mml:mi>&#x003bc;</mml:mi>                                 <mml:mo stretchy="false">)</mml:mo>                              </mml:mrow>                              <mml:mo>)</mml:mo>                           </mml:mrow>                           <mml:mo>=</mml:mo>                           <mml:mstyle displaystyle="true">                              <mml:munder>                                 <mml:mo>&#x02211;</mml:mo>                                 <mml:mrow>                                    <mml:mi>g</mml:mi>                                    <mml:mo>,</mml:mo>                                    <mml:mi>k</mml:mi>                                 </mml:mrow>                              </mml:munder>                              <mml:mrow>                                 <mml:mn>0.5</mml:mn>                                 <mml:mi>log</mml:mi>                                 <mml:mo>&#x02061;</mml:mo>                                 <mml:mfrac>                                    <mml:mrow>                                       <mml:msub>                                          <mml:mi>v</mml:mi>                                          <mml:mrow>                                             <mml:mi>g</mml:mi>                                             <mml:mi>k</mml:mi>                                          </mml:mrow>                                       </mml:msub>                                    </mml:mrow>                                    <mml:mrow>                                       <mml:msub>                                          <mml:mi>v</mml:mi>                                          <mml:mn>0</mml:mn>                                       </mml:msub>                                    </mml:mrow>                                 </mml:mfrac>                              </mml:mrow>                           </mml:mstyle>                           <mml:mo>+</mml:mo>                           <mml:mn>0.5</mml:mn>                           <mml:msub>                              <mml:mi>v</mml:mi>                              <mml:mn>0</mml:mn>                           </mml:msub>                           <mml:msup>                              <mml:mrow>                                 <mml:mo stretchy="false">[</mml:mo>                                 <mml:msub>                                    <mml:mi>m</mml:mi>                                    <mml:mrow>                                       <mml:mi>g</mml:mi>                                       <mml:mi>k</mml:mi>                                    </mml:mrow>                                 </mml:msub>                                 <mml:mo>&#x02212;</mml:mo>                                 <mml:msub>                                    <mml:mi>m</mml:mi>                                    <mml:mn>0</mml:mn>                                 </mml:msub>                                 <mml:mo stretchy="false">]</mml:mo>                              </mml:mrow>                              <mml:mn>2</mml:mn>                           </mml:msup>                           <mml:mo>+</mml:mo>                           <mml:mn>0.5</mml:mn>                           <mml:mrow>                              <mml:mo>(</mml:mo>                              <mml:mrow>                                 <mml:mfrac>                                    <mml:mrow>                                       <mml:msub>                                          <mml:mi>v</mml:mi>                                          <mml:mn>0</mml:mn>                                       </mml:msub>                                    </mml:mrow>                                    <mml:mrow>                                       <mml:msub>                                          <mml:mi>v</mml:mi>                                          <mml:mrow>                                             <mml:mi>g</mml:mi>                                             <mml:mi>k</mml:mi>                                          </mml:mrow>                                       </mml:msub>                                    </mml:mrow>                                 </mml:mfrac>                                 <mml:mo>&#x02212;</mml:mo>                                 <mml:mn>1</mml:mn>                              </mml:mrow>                              <mml:mo>)</mml:mo>                           </mml:mrow>                           <mml:mo>,</mml:mo>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>and</p><p><disp-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M64" name="1753-6561-2-S4-S7-i57" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:mtable columnalign="left">                              <mml:mtr columnalign="left">                                 <mml:mtd columnalign="left">                                    <mml:mrow>                                       <mml:mtext>KL</mml:mtext>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:mi>q</mml:mi>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:mi>&#x003b2;</mml:mi>                                       <mml:mo>|</mml:mo>                                       <mml:mo>|</mml:mo>                                       <mml:mi>p</mml:mi>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:mi>&#x003b2;</mml:mi>                                       <mml:mo stretchy="false">)</mml:mo>                                       <mml:mo stretchy="false">)</mml:mo>                                       <mml:mo stretchy="false">)</mml:mo>                                    </mml:mrow>                                 </mml:mtd>                                 <mml:mtd columnalign="left">                                    <mml:mo>=</mml:mo>                                 </mml:mtd>                                 <mml:mtd columnalign="left">                                    <mml:mrow>                                       <mml:mstyle displaystyle="true">                                          <mml:msub>                                             <mml:mo>&#x02211;</mml:mo>                                             <mml:mrow>                                                <mml:mi>g</mml:mi>                                                <mml:mo>,</mml:mo>                                                <mml:mi>k</mml:mi>                                             </mml:mrow>                                          </mml:msub>                                          <mml:mrow>                                             <mml:mo stretchy="false">(</mml:mo>                                             <mml:msub>                                                <mml:mi>a</mml:mi>                                                <mml:mrow>                                                   <mml:mi>g</mml:mi>                                                   <mml:mi>k</mml:mi>                                                </mml:mrow>                                             </mml:msub>                                             <mml:mo>&#x02212;</mml:mo>                                             <mml:msub>                                                <mml:mi>a</mml:mi>                                                <mml:mn>0</mml:mn>                                             </mml:msub>                                             <mml:mo stretchy="false">)</mml:mo>                                             <mml:mi>&#x003c8;</mml:mi>                                             <mml:mo stretchy="false">(</mml:mo>                                             <mml:msub>                                                <mml:mi>a</mml:mi>                                                <mml:mrow>                                                   <mml:mi>g</mml:mi>                                                   <mml:mi>k</mml:mi>                                                </mml:mrow>                                             </mml:msub>                                             <mml:mo stretchy="false">)</mml:mo>                                             <mml:mo>&#x02212;</mml:mo>                                             <mml:mi>log</mml:mi>                                             <mml:mo>&#x02061;</mml:mo>                                             <mml:msub>                                                <mml:mi>b</mml:mi>                                                <mml:mrow>                                                   <mml:mi>g</mml:mi>                                                   <mml:mi>k</mml:mi>                                                </mml:mrow>                                             </mml:msub>                                             <mml:mo>&#x02212;</mml:mo>                                             <mml:msub>                                                <mml:mi>a</mml:mi>                                                <mml:mrow>                                                   <mml:mi>g</mml:mi>                                                   <mml:mi>k</mml:mi>                                                </mml:mrow>                                             </mml:msub>                                             <mml:mo>&#x02212;</mml:mo>                                             <mml:mi>log</mml:mi>                                             <mml:mo>&#x02061;</mml:mo>                                             <mml:mi>&#x00393;</mml:mi>                                             <mml:mo stretchy="false">(</mml:mo>                                             <mml:msub>                                                <mml:mi>a</mml:mi>                                                <mml:mrow>                                                   <mml:mi>g</mml:mi>                                                   <mml:mi>k</mml:mi>                                                </mml:mrow>                                             </mml:msub>                                             <mml:mo stretchy="false">)</mml:mo>                                          </mml:mrow>                                       </mml:mstyle>                                    </mml:mrow>                                 </mml:mtd>                              </mml:mtr>                              <mml:mtr columnalign="left">                                 <mml:mtd columnalign="left">                                    <mml:mrow/>                                 </mml:mtd>                                 <mml:mtd columnalign="left">                                    <mml:mo>+</mml:mo>                                 </mml:mtd>                                 <mml:mtd columnalign="left">                                    <mml:mrow>                                       <mml:mi>log</mml:mi>                                       <mml:mo>&#x02061;</mml:mo>                                       <mml:mi>&#x00393;</mml:mi>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:msub>                                          <mml:mi>a</mml:mi>                                          <mml:mn>0</mml:mn>                                       </mml:msub>                                       <mml:mo stretchy="false">)</mml:mo>                                       <mml:mo>+</mml:mo>                                       <mml:msub>                                          <mml:mi>a</mml:mi>                                          <mml:mn>0</mml:mn>                                       </mml:msub>                                       <mml:mi>log</mml:mi>                                       <mml:mo>&#x02061;</mml:mo>                                       <mml:msub>                                          <mml:mi>b</mml:mi>                                          <mml:mn>0</mml:mn>                                       </mml:msub>                                       <mml:mo>&#x02212;</mml:mo>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:msub>                                          <mml:mi>a</mml:mi>                                          <mml:mn>0</mml:mn>                                       </mml:msub>                                       <mml:mo>&#x02212;</mml:mo>                                       <mml:mn>1</mml:mn>                                       <mml:mo stretchy="false">)</mml:mo>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:mi>&#x003c8;</mml:mi>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:msub>                                          <mml:mi>a</mml:mi>                                          <mml:mrow>                                             <mml:mi>g</mml:mi>                                             <mml:mi>k</mml:mi>                                          </mml:mrow>                                       </mml:msub>                                       <mml:mo stretchy="false">)</mml:mo>                                       <mml:mo>+</mml:mo>                                       <mml:mi>log</mml:mi>                                       <mml:mo>&#x02061;</mml:mo>                                       <mml:msub>                                          <mml:mi>b</mml:mi>                                          <mml:mrow>                                             <mml:mi>g</mml:mi>                                             <mml:mi>k</mml:mi>                                          </mml:mrow>                                       </mml:msub>                                       <mml:mo stretchy="false">)</mml:mo>                                       <mml:mo>+</mml:mo>                                       <mml:mfrac>                                          <mml:mrow>                                             <mml:msub>                                                <mml:mi>a</mml:mi>                                                <mml:mrow>                                                   <mml:mi>g</mml:mi>                                                   <mml:mi>k</mml:mi>                                                </mml:mrow>                                             </mml:msub>                                             <mml:msub>                                                <mml:mi>b</mml:mi>                                                <mml:mrow>                                                   <mml:mi>g</mml:mi>                                                   <mml:mi>k</mml:mi>                                                </mml:mrow>                                             </mml:msub>                                          </mml:mrow>                                          <mml:mrow>                                             <mml:msub>                                                <mml:mi>b</mml:mi>                                                <mml:mn>0</mml:mn>                                             </mml:msub>                                          </mml:mrow>                                       </mml:mfrac>                                       <mml:mo>.</mml:mo>                                    </mml:mrow>                                 </mml:mtd>                              </mml:mtr>                           </mml:mtable>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p></sec></sec></body><back><ack><sec><title>Acknowledgements</title><p>This work is supported by EPSRC grant EP/E027296/1.</p><p>This article has been published as part of <italic>BMC Proceedings </italic>Volume 2 Supplement 4, 2008: Selected Proceedings of Machine Learning in Systems Biology: MLSB 2007. The full contents of the supplement are available online at <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1753-6561/2?issue=S4"/>.</p></sec></ack><ref-list><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Eisen</surname><given-names>MB</given-names></name><etal></etal></person-group><article-title>Cluster analysis and display of genome-wide expression patterns</article-title><source>Proc Natl Acad Sci USA</source><year>1998</year><volume>95</volume><fpage>14863</fpage><lpage>14868</lpage><pub-id pub-id-type="pmid">9843981</pub-id><pub-id pub-id-type="doi">10.1073/pnas.95.25.14863</pub-id></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Tavazoie</surname><given-names>S</given-names></name><etal></etal></person-group><article-title>Systematic determination of genetic network architecture</article-title><source>Nature Genetics</source><year>1999</year><volume>22</volume><fpage>281</fpage><lpage>285</lpage><pub-id pub-id-type="pmid">10391217</pub-id><pub-id pub-id-type="doi">10.1038/10343</pub-id></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Tamayo</surname><given-names>P</given-names></name><etal></etal></person-group><article-title>Interpreting patterns of gene expression with self-organizing maps: methods and application to hematopoietic differentiation</article-title><source>Proc Natl Acad Sci USA</source><year>1999</year><volume>96</volume><fpage>2907</fpage><lpage>2912</lpage><pub-id pub-id-type="pmid">10077610</pub-id><pub-id pub-id-type="doi">10.1073/pnas.96.6.2907</pub-id></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Blei</surname><given-names>DM</given-names></name><name><surname>Ng</surname><given-names>AY</given-names></name><name><surname>Jordan</surname><given-names>MI</given-names></name></person-group><article-title>Latent Dirichlet Allocation</article-title><source>Journal of Machine Learning Research</source><year>2003</year><volume>3</volume><fpage>993</fpage><lpage>1022</lpage><pub-id pub-id-type="doi">10.1162/jmlr.2003.3.4-5.993</pub-id></citation></ref><ref id="B5"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Rogers</surname><given-names>S</given-names></name><name><surname>Girolami</surname><given-names>M</given-names></name><name><surname>Campbell</surname><given-names>C</given-names></name><name><surname>Breitling</surname><given-names>R</given-names></name></person-group><article-title>The Latent Process Decomposition of cDNA Microarray Datasets</article-title><source>IEEE/ACM Transactions on Computational Biology and Bioinformatics</source><year>2005</year><volume>2</volume><fpage>143</fpage><lpage>156</lpage><pub-id pub-id-type="pmid">17044179</pub-id><pub-id pub-id-type="doi">10.1109/TCBB.2005.29</pub-id></citation></ref><ref id="B6"><citation citation-type="other"><person-group person-group-type="author"><name><surname>Carrivick</surname><given-names>L</given-names></name><name><surname>Campbell</surname><given-names>C</given-names></name></person-group><article-title>A Bayesian approach to the analysis of micoarray datasets using variational inference</article-title><source>Journal submission</source><year>2007</year></citation></ref><ref id="B7"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Attias</surname><given-names>H</given-names></name></person-group><article-title>A variational Bayesian framework for graphical models</article-title><source>Advances in Neural Information Processing Systems</source><year>2002</year><volume>12</volume><fpage>209</fpage><lpage>215</lpage></citation></ref><ref id="B8"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Bishop</surname><given-names>CM</given-names></name></person-group><source>Pattern recognition and machine learning</source><year>2006</year><publisher-name>(Series: Information Science &#x00026; Statistics), Springer</publisher-name></citation></ref><ref id="B9"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Teh</surname><given-names>YW</given-names></name><name><surname>Newman</surname><given-names>D</given-names></name><name><surname>Welling</surname><given-names>M</given-names></name></person-group><article-title>A collapsed variational bayesian inference algorithm for latent dirichlet allocation</article-title><source>Advances in Neural Information Processing Systems</source><year>2006</year><volume>19</volume><fpage>1353</fpage><lpage>1360</lpage></citation></ref><ref id="B10"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Jordan</surname><given-names>MI</given-names></name><name><surname>Ghahramani</surname><given-names>Z</given-names></name><name><surname>Jaakkola</surname><given-names>T</given-names></name><name><surname>Saul</surname><given-names>LK</given-names></name></person-group><article-title>An introduction to variational methods for graphical models</article-title><source>Machine Learning</source><year>1999</year><volume>37</volume><fpage>183</fpage><lpage>233</lpage><pub-id pub-id-type="doi">10.1023/A:1007665907178</pub-id></citation></ref><ref id="B11"><citation citation-type="other"><person-group person-group-type="author"><name><surname>Blake</surname><given-names>CL</given-names></name><name><surname>Newman</surname><given-names>DJ</given-names></name><name><surname>Hettich</surname><given-names>S</given-names></name><name><surname>Merz</surname><given-names>CJ</given-names></name></person-group><source>UCI repository of machine learning databases</source><year>1998</year><ext-link ext-link-type="uri" xlink:href="http://www.ics.uci.edu/~mlearn/mlrepository.html"/></citation></ref><ref id="B12"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Garber</surname><given-names>E</given-names></name><etal></etal></person-group><article-title>Diversity of gene expression in adenocarcinoma of the lung</article-title><source>Proc Natl Acad Sci U S A</source><year>2001</year><volume>98</volume><fpage>13784</fpage><lpage>13789</lpage><pub-id pub-id-type="pmid">11707590</pub-id><pub-id pub-id-type="doi">10.1073/pnas.221451398</pub-id></citation></ref><ref id="B13"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Yeoh</surname><given-names>E-J</given-names></name><etal></etal></person-group><article-title>Classification, subtype discovery, and prediction of outcome in pediatric acute lymphoblastic leukemia by gene expression profiling</article-title><source>Cancer Cell</source><year>2002</year><volume>1</volume><fpage>133</fpage><lpage>143</lpage><pub-id pub-id-type="pmid">12086872</pub-id><pub-id pub-id-type="doi">10.1016/S1535-6108(02)00032-6</pub-id></citation></ref></ref-list></back></article>