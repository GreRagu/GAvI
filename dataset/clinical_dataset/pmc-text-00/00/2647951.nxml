<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd"><article xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id><journal-title>BMC Bioinformatics</journal-title><issn pub-type="epub">1471-2105</issn><publisher><publisher-name>BioMed Central</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">19087329</article-id><article-id pub-id-type="pmc">2647951</article-id><article-id pub-id-type="publisher-id">1471-2105-9-540</article-id><article-id pub-id-type="doi">10.1186/1471-2105-9-540</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group></article-categories><title-group><article-title>Shape-IT: new rapid and accurate algorithm for haplotype inference</article-title></title-group><contrib-group><contrib id="A1" contrib-type="author"><name><surname>Delaneau</surname><given-names>Olivier</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>olivier.delaneau@gmail.com</email></contrib><contrib id="A2" contrib-type="author"><name><surname>Coulonges</surname><given-names>C&#x000e9;dric</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>cedcoul@gmail.com</email></contrib><contrib id="A3" corresp="yes" contrib-type="author"><name><surname>Zagury</surname><given-names>Jean-Fran&#x000e7;ois</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>zagury@cnam.fr</email></contrib></contrib-group><aff id="I1"><label>1</label>Chaire de Bioinformatique, Conservatoire National des Arts et M&#x000e9;tiers, 292 rue Saint-Martin, 75003 Paris, France</aff><pub-date pub-type="collection"><year>2008</year></pub-date><pub-date pub-type="epub"><day>16</day><month>12</month><year>2008</year></pub-date><volume>9</volume><fpage>540</fpage><lpage>540</lpage><ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/9/540"/><history><date date-type="received"><day>31</day><month>7</month><year>2008</year></date><date date-type="accepted"><day>16</day><month>12</month><year>2008</year></date></history><permissions><copyright-statement>Copyright &#x000a9; 2008 Delaneau et al; licensee BioMed Central Ltd.</copyright-statement><copyright-year>2008</copyright-year><copyright-holder>Delaneau et al; licensee BioMed Central Ltd.</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0"><p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p><!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>               Delaneau               Olivier                              olivier.delaneau@gmail.com            </dc:author><dc:title>            Shape-IT: new rapid and accurate algorithm for haplotype inference         </dc:title><dc:date>2008</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 9(1): 540-. (2008)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2008)9:1&#x0003c;540&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>--></license></permissions><abstract><sec><title>Background</title><p>We have developed a new computational algorithm, Shape-IT, to infer haplotypes under the genetic model of coalescence with recombination developed by Stephens et al in Phase v2.1. It runs much faster than Phase v2.1 while exhibiting the same accuracy. The major algorithmic improvements rely on the use of binary trees to represent the sets of candidate haplotypes for each individual. These binary tree representations: (1) speed up the computations of posterior probabilities of the haplotypes by avoiding the redundant operations made in Phase v2.1, and (2) overcome the exponential aspect of the haplotypes inference problem by the smart exploration of the most plausible pathways (ie. haplotypes) in the binary trees.</p></sec><sec><title>Results</title><p>Our results show that Shape-IT is several orders of magnitude faster than Phase v2.1 while being as accurate. For instance, Shape-IT runs 50 times faster than Phase v2.1 to compute the haplotypes of 200 subjects on 6,000 segments of 50 SNPs extracted from a standard Illumina 300 K chip (13 days instead of 630 days). We also compared Shape-IT with other widely used software, Gerbil, PL-EM, Fastphase, 2SNP, and Ishape in various tests: Shape-IT and Phase v2.1 were the most accurate in all cases, followed by Ishape and Fastphase. As a matter of speed, Shape-IT was faster than Ishape and Fastphase for datasets smaller than 100 SNPs, but Fastphase became faster -but still less accurate- to infer haplotypes on larger SNP datasets.</p></sec><sec><title>Conclusion</title><p>Shape-IT deserves to be extensively used for regular haplotype inference but also in the context of the new high-throughput genotyping chips since it permits to fit the genetic model of Phase v2.1 on large datasets. This new algorithm based on tree representations could be used in other HMM-based haplotype inference software and may apply more largely to other fields using HMM.</p></sec></abstract></article-meta></front><body><sec><title>Background</title><p>The recent advent of genotyping chips, which can analyze up to 500,000 single nucleotide polymorphisms (SNP) per individual, offers a powerful tool for large scale association studies in human diseases. The most common approach to find genes possibly implicated in a disease relies on the comparison, in patients and controls, of the distributions of SNP markers. An approach to increase the power of such studies is to focus on more complex markers which capture implicitly the linkage disequilibrium (LD) between SNPs: the combination of SNP alleles on the same chromosome called haplotypes. Haplotypes are of great interest to study complex diseases since they are generally derived from chromosomal fragments which are transmitted from one generation to the next or which may have a biological meaning such as the promoter or the exons of a gene [<xref ref-type="bibr" rid="B1">1</xref>]. Beyond the biomedical applications, the comparison of haplotype distributions between populations also provides new insights in the diversity, the history and the migrations of human populations. For instance, several studies [<xref ref-type="bibr" rid="B2">2</xref>-<xref ref-type="bibr" rid="B6">6</xref>] have recently highlighted that genetic diversity of the human genome is organized in regions called haplotype blocks in which SNPs exhibit a high degree of LD and few common haplotypes. These haplotype blocks are delimited by recombination hotspots and chromosomes can thus be viewed as mosaics of common haplotypes. The recently developed HapMap project, dedicated to establish a dense map of SNPs and LD in various human populations [<xref ref-type="bibr" rid="B7">7</xref>-<xref ref-type="bibr" rid="B9">9</xref>], has emphasized the interest of haplotypes to study human diversity.</p><p>Regular genotyping (based on PCR/sequencing or on chips) provides the genotype for each SNP but does not allow the determination of the haplotypes (i.e. the combination of SNP alleles on each chromosome), and current experimental solutions to this problem are still expensive and time-consuming [<xref ref-type="bibr" rid="B10">10</xref>,<xref ref-type="bibr" rid="B11">11</xref>]. Clark was first to introduce a computational alternative [<xref ref-type="bibr" rid="B12">12</xref>]: the determination of haplotypes via a parsimony criterion which leads to a minimal set of haplotypes sufficient to explain the entire population. Since then, efficient statistical algorithms have been developed under the random mating assumption where the observed genotypes are formed by sampling independently two unknown haplotypes. This assumption, coupled with a probabilistic model for the haplotypes, permits to define the likelihood of the observed genotypes as a function of the model parameters. Thus, in order to infer haplotypes, the most likely parameter values are estimated via an Expectation Maximization algorithm (EM) or a Gibbs sampler algorithm (GS) on the observed genotypes.</p><p>The first EM-based model estimated the most likely haplotypes frequencies for observed genotypes without making any assumption on the mutation and recombination history of haplotypes [<xref ref-type="bibr" rid="B13">13</xref>]. Many software were built on this simple model and the best-known is certainly PLEM [<xref ref-type="bibr" rid="B14">14</xref>]. Later on, two new models were developed based on the idea that the haplotypes were arising through mutation and recombination events from few founder haplotypes. In Gerbil [<xref ref-type="bibr" rid="B15">15</xref>], haplotype blocks are strictly defined by dynamic programming and in each block, the haplotypes are derived through mutations from founder haplotypes. On the other hand, in Fastphase [<xref ref-type="bibr" rid="B16">16</xref>], in HIT [<xref ref-type="bibr" rid="B17">17</xref>], and in HINT [<xref ref-type="bibr" rid="B18">18</xref>], both mutation and recombination events on founder haplotypes are simultaneously modeled through a hidden Markov model (HMM). All these methods estimate founder haplotypes from observed genotypes via EM algorithms.</p><p>For the GS-based algorithms, the general case relies on sampling haplotypes for a genotype in function of all the haplotypes currently assigned to the other genotypes. The model of Haplotyper [<xref ref-type="bibr" rid="B19">19</xref>] simply favors haplotypes which have been already assigned to many genotypes. In Phase v1.0 [<xref ref-type="bibr" rid="B20">20</xref>], the idea was to favor the sampling of haplotypes which likely coalesce with the already assigned ones. At last, in Phase v2.1 [<xref ref-type="bibr" rid="B21">21</xref>,<xref ref-type="bibr" rid="B22">22</xref>], the sampled haplotypes are mosaics of the previously sampled ones modeled in a HMM.</p><p>Recently, an alternative approach to the statistical algorithms was proposed in 2snp [<xref ref-type="bibr" rid="B23">23</xref>] which computes LD measures for all pairs of SNPs and then resolves genotypes by finding the maximum spanning trees.</p><p>Several studies have suggested that the HMM-based methods were the most accurate to infer the haplotypes [<xref ref-type="bibr" rid="B17">17</xref>,<xref ref-type="bibr" rid="B18">18</xref>,<xref ref-type="bibr" rid="B24">24</xref>], certainly because of the flexible definition of the haplotype blocks which depends generally on the physical distance between SNPs [<xref ref-type="bibr" rid="B16">16</xref>]. Among the HMM-based methods, Phase v2.1 is often considered as the most accurate developed so far [<xref ref-type="bibr" rid="B24">24</xref>-<xref ref-type="bibr" rid="B30">30</xref>] which explains why it is widely used in genetic association studies [<xref ref-type="bibr" rid="B31">31</xref>-<xref ref-type="bibr" rid="B33">33</xref>] and why it was used to phase the genotype data of the HapMap project [<xref ref-type="bibr" rid="B8">8</xref>]. The strength of Phase v2.1 probably comes from two particularities. First, the HMM is built during the GS iterations with a number of haplotypes proportional to the number of genotypes in opposition to other HMM-based methods which define a fixed number of founder haplotypes. Second, the haplotypes are inferred by summing over all the possible hidden state sequences of the HMM (Forward algorithm) whereas many other HMM-based methods infer haplotypes by sampling only the most probable hidden sequence in the HMM (Viterbi algorithm).</p><p>However, the required running time increases dramatically with the number of SNPs since the search space grows exponentially. This prevents the easy use of Phase v2.1 in the current high-throughput chips. This fact has previously motivated us to develop Ishape [<xref ref-type="bibr" rid="B27">27</xref>] which matches Phase v2.1 accuracy while maintaining feasible running times. For that, we have used a two-step strategy: 1. we defined a limited space of possible haplotypes with a rapid pre-processing algorithm based on bootstrapped EM haplotypes estimations 2. on this limited set of haplotypes, we then used an accurate Phase-like algorithm. The rapidity of the first step is made possible thanks to an iterative implementation of the EM algorithm which avoids any exponential growth of the space of possible haplotypes and includes the SNPs one after the other during the computations. In practice, Ishape runs up to 15 times faster than Phase 2.1 (for up to 100 SNPs) with a similar accuracy in populations with high LD, such as Caucasian genomes.</p><p>In this work, we present major improvements which greatly reduce the computational time of Phase v2.1. These improvements have been implemented in the software package Shape-IT and compared to the widely used competitor software.</p></sec><sec><title>Algorithm</title><sec><title>Notations (Figure <xref ref-type="fig" rid="F1">1</xref>)</title><fig position="float" id="F1"><label>Figure 1</label><caption><p><bold>Schematic representation of a sample of <italic>n </italic>genotypes</bold>. In this example, the space of possible haplotypes <italic>S</italic><sub><italic>i </italic></sub>for individual <italic>i </italic>contains 4 haplotype pairs with 8 distinct haplotypes. The possible phases between heterozygous markers are shown in bold.</p></caption><graphic xlink:href="1471-2105-9-540-1"/></fig><p>Let's assume we have a sample of <italic>n </italic>genotypes <italic>G </italic>= {<italic>G</italic><sub>1</sub>,..., <italic>G</italic><sub><italic>n</italic></sub>} describing the allelic content of <italic>n </italic>diploid individuals over <italic>s </italic>SNPs. A genotype is split into a haplotype pair by setting the phases between the <italic>z </italic>heterozygous SNPs (<italic>z </italic>&#x02264; <italic>s</italic>). The number of distinct haplotype pairs consistent with a genotype is then 2<sup>(<italic>z</italic>-1)</sup>. Let <italic>S </italic>= {<italic>S</italic><sub>1</sub>,..., <italic>S</italic><sub><italic>n</italic></sub>} denotes the total haplotype space where <italic>S</italic><sub><italic>i </italic></sub>is the space of possible haplotype pairs associated with the <italic>ith </italic>genotype. Moreover, let's assume we have the recombination parameters <italic>&#x003c1; </italic>= {<italic>&#x003c1;</italic><sub>1</sub>,..., <italic>&#x003c1;</italic><sub><italic>s</italic>-1</sub>} in the <italic>s-1 </italic>intervals between the <italic>s </italic>SNPs of the sample as described by Stephens et al [<xref ref-type="bibr" rid="B22">22</xref>].</p></sec><sec><title>Gibbs sampler algorithm</title><p>The GS algorithm considers the haplotype reconstructions of <italic>n </italic>individuals as a set of <italic>n </italic>random variables <italic>H </italic>= {<italic>H</italic><sub>1</sub>,..., <italic>H</italic><sub><italic>n</italic></sub>} with sampling spaces in <italic>S </italic>and it estimates the conditional joint distribution of <italic>H </italic>given <italic>G </italic>and some recombination parameters <italic>&#x003c1;</italic>: Pr(<italic>H </italic>| <italic>G</italic>, <italic>&#x003c1;</italic>). In simple words, it computes a conditional probability for each haplotype pair of <italic>S </italic>in light of the observed genotypes <italic>G </italic>and the recombination pattern between the SNPs. Given these probabilities, the haplotype frequencies and the most likely haplotype pair for each genotype are straightforward to obtain. In practice, Pr(<italic>H </italic>| <italic>G</italic>, <italic>&#x003c1;</italic>) is estimated by sampling from the stationary distribution of a Gibbs sampler (GS) <italic>H</italic><sup>(0)</sup>,..., <italic>H</italic><sup>(<italic>t</italic>)</sup>,... where a state <italic>H</italic><sup>(<italic>t</italic>) </sup>is a particular realization of the random variables of <italic>H</italic>: <italic>n </italic>haplotype pairs from <italic>S </italic>which resolves the <italic>n </italic>genotypes of <italic>G</italic>. The GS starts with a random haplotype realization <italic>H</italic><sup>(0)</sup>, and goes from <italic>H</italic><sup>(<italic>t</italic>) </sup>to <italic>H</italic><sup>(<italic>t</italic>+1) </sup>by updating the haplotype pair of an individual <italic>i </italic>in light of the <italic>2n-2 </italic>other haplotypes found in <italic>H</italic><sup>(<italic>t</italic>)</sup>, that we call <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" name="1471-2105-9-540-i1" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula>. This "haplotypes update" step is done by sampling a new haplotype pair from the conditional distribution Pr(<italic>H</italic><sub><italic>i </italic></sub>| <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2" name="1471-2105-9-540-i1" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula>, <italic>&#x003c1;</italic>) proposed by Fearnhead and Donnelly [<xref ref-type="bibr" rid="B34">34</xref>] and Li and Stephens [<xref ref-type="bibr" rid="B35">35</xref>]. This conditional distribution, called FDLS distribution in the following, is computed thanks to a hidden Markov model for haplotypes described in the next section. The important fact here is that computation of Pr(<italic>H</italic><sub><italic>i </italic></sub>| <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M3" name="1471-2105-9-540-i1" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula>, <italic>&#x003c1;</italic>) constitutes the most time-consuming part of the GS since it has to be done on a space of possible haplotype pairs which grows exponentially with the number of heterozygous SNPs.</p><p>An iteration of the GS algorithm corresponds to update successively the haplotypes of the <italic>n </italic>individuals of <italic>G </italic>given a randomly initialized order of treatment. Between iterations, according to the Metropolis Hasting acceptance rates described by Stephens et al [<xref ref-type="bibr" rid="B22">22</xref>], we accept or reject (1) new values for the recombination parameters <italic>&#x003c1; </italic>= {<italic>&#x003c1;</italic><sub>1</sub>,..., <italic>&#x003c1;</italic><sub><italic>s</italic>-1</sub>} in the <italic>s-1 </italic>intervals between SNPs and (2) new treatment order of genotypes in the GS. To finally obtain Pr(<italic>H </italic>| <italic>G</italic>, <italic>&#x003c1;</italic>), we discard the first iterations of the GS as burn-in iterations (typically 100) and for the <italic>n </italic>genotypes <italic>G</italic><sub><italic>i</italic></sub>, we average the distribution Pr(<italic>H</italic><sub><italic>i </italic></sub>| <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M4" name="1471-2105-9-540-i1" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula>, <italic>&#x003c1;</italic>) on several main iterations (typically 100).</p></sec><sec><title>Computation of a haplotype pair probability in a HMM (Figure <xref ref-type="fig" rid="F2">2</xref>)</title><fig position="float" id="F2"><label>Figure 2</label><caption><p><bold>Representation of the execution trellis of the hidden Markov model used to compute the probability of a haplotype</bold>. The haplotypes <italic>h</italic><sub>1</sub>,..., <italic>h</italic><sub>2<italic>n</italic>-2 </sub>denote the previously sampled haplotypes which are used to compute the probability of the observed haplotype <italic>h</italic>. The sets {<italic>o</italic><sub>1</sub>,..., <italic>o</italic><sub><italic>s</italic></sub>} and {<italic>q</italic><sub>1</sub>(<italic>k</italic>), ..., <italic>q</italic><sub><italic>s</italic></sub>(<italic>k</italic>)} correspond respectively to the observed state sequence of haplotype <italic>h </italic>and to the hidden state sequence of haplotype <italic>h</italic><sub><italic>k</italic></sub>. The transition probability <italic>a</italic><sub><italic>j</italic></sub>(<italic>k</italic>,<italic>l</italic>) corresponds to the probability of jumping from hidden state <italic>q</italic><sub><italic>j</italic></sub>(<italic>k</italic>) of haplotype <italic>h</italic><sub><italic>k </italic></sub>to hidden state <italic>q</italic><sub><italic>j</italic>+1</sub>(<italic>l</italic>) of haplotype <italic>h</italic><sub><italic>l</italic></sub>, and the emission probability <italic>b</italic><sub><italic>j</italic></sub>(<italic>k</italic>) corresponds to the probability of observing <italic>o</italic><sub><italic>j </italic></sub>given the hidden state <italic>q</italic><sub><italic>j</italic></sub>(<italic>k</italic>). To compute the probability of observing the sequence h = {<italic>o</italic><sub>1</sub>, ..., <italic>o</italic><sub><italic>s</italic></sub>} in this HMM, one must sum up the probabilities of observing <italic>h </italic>over all (2<italic>n </italic>- 2)<sup><italic>s </italic></sup>possible sequences of <italic>s </italic>hidden states which is done efficiently by the forward algorithm.</p></caption><graphic xlink:href="1471-2105-9-540-2"/></fig><p>First of all, we assume that genotypes are produced by sampling independently two haplotypes according to their respective probabilities, which yields:</p><p><disp-formula id="bmcM1"><label>(1)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M5" name="1471-2105-9-540-i2" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>Pr</mml:mi><mml:mo>&#x02061;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>h</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi>&#x003c1;</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>&#x003b4;</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>h</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>&#x003c0;</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mn>...</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>&#x003c1;</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>&#x003c0;</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>|</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mn>...</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>&#x003c1;</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>where <italic>&#x003b4;</italic><sub><italic>h</italic>,<italic>h</italic>' </sub>= 0 if <italic>h </italic>&#x02260; <italic>h</italic>' and <italic>&#x003b4;</italic><sub><italic>h</italic>,<italic>h' </italic></sub>= 1 if <italic>h </italic>= <italic>h'</italic>. The conditional probability <italic>&#x003c0; </italic>of haplotype <italic>h </italic>reflects how likely <italic>h </italic>corresponds to an "imperfect mosaic" of the other haplotypes {<italic>h</italic><sub>1</sub>, ..., <italic>h</italic><sub>2<italic>n</italic>-2</sub>} [<xref ref-type="bibr" rid="B22">22</xref>]. The underlying idea is that haplotype <italic>h </italic>has been probably created through the generations as a recombined sequence of haplotypes from the pool {<italic>h</italic><sub>1</sub>, ..., <italic>h</italic><sub>2<italic>n</italic>-2</sub>}, possibly altered by some mutations. One models this by computing the probability of observing the sequence <italic>h </italic>= {<italic>o</italic><sub>1</sub>, ..., <italic>o</italic><sub><italic>s</italic></sub>} in a hidden Markov model <italic>&#x003bb; </italic>designed to represent all possible mosaics of {<italic>h</italic><sub>1</sub>, ..., <italic>h</italic><sub>2<italic>n</italic>-2</sub>}: <italic>&#x003c0;</italic>(<italic>h</italic>|<italic>h</italic><sub>1</sub>, ..., <italic>h</italic><sub>2<italic>n</italic>-2</sub>, <italic>&#x003c1;</italic>) = Pr(<italic>o</italic><sub>1</sub>, ..., <italic>o</italic><sub><italic>s</italic></sub>|<italic>&#x003bb;</italic>). Such HMM <italic>&#x003bb; </italic>can be viewed as a trellis of <italic>s </italic>&#x000d7; (2<italic>n </italic>- 2) hidden states <italic>q</italic><sub><italic>j </italic></sub>(<italic>k</italic>) with 1 &#x02264; <italic>j </italic>&#x02264; <italic>s </italic>and 1 &#x02264; <italic>k </italic>&#x02264; 2<italic>n</italic>-2. A hidden state <italic>q</italic><sub><italic>j</italic></sub>(<italic>k</italic>) of <italic>&#x003bb; </italic>corresponds to the allele of haplotype <italic>h</italic><sub><italic>k </italic></sub>at SNP <italic>j </italic>and it is linked to all the hidden states <italic>q</italic><sub><italic>j</italic>+1</sub>(<italic>l</italic>) (1 &#x02264; <italic>l </italic>&#x02264; 2<italic>n</italic>-2) at SNP <italic>j+1 </italic>in order to model all the possible recombination jumps of haplotypes between SNPs <italic>j </italic>and <italic>j+1 </italic>(Figure <xref ref-type="fig" rid="F2">2</xref>). Then, a sequence of <italic>s </italic>hidden states in <italic>&#x003bb; </italic>through the <italic>s </italic>SNPs corresponds to a particular mosaic of {<italic>h</italic><sub>1</sub>, ..., <italic>h</italic><sub>2<italic>n</italic>-2</sub>}. The probability of observing <italic>h </italic>= {<italic>o</italic><sub>1</sub>, ..., <italic>o</italic><sub><italic>s</italic></sub>} in <italic>&#x003bb; </italic>is computed thanks to transition probabilities between hidden states which mimic recombination and thanks to emission probabilities from hidden alleles to observed alleles which mimic mutation. Similar hidden Markov models have been proposed, but they generally rely on a limited number of founder haplotypes where the most likely transition and emission probabilities are estimated from observed genotype data via an EM algorithm [<xref ref-type="bibr" rid="B17">17</xref>,<xref ref-type="bibr" rid="B18">18</xref>]. Here, the emission and transition probabilities are defined with prior distributions depending respectively on a constant mutation parameter and on the variable recombination parameters <italic>&#x003c1; </italic>. The objective of this section is not to fully describe the probabilistic model of transitions and emissions since this has already been done by Stephens and Scheet [<xref ref-type="bibr" rid="B22">22</xref>]. Instead, we focus on how the haplotype probability is computed in such a HMM <italic>&#x003bb; </italic>from transition and emission probabilities. We thus assume that the following quantities are known as set up by Stephens and Scheet:</p><p>&#x02022; The transition probability <italic>a</italic><sub><italic>j </italic></sub>(<italic>l</italic>,<italic>k</italic>) from the state <italic>q</italic><sub><italic>j</italic></sub>(<italic>l</italic>) of haplotype <italic>h</italic><sub><italic>l </italic></sub>for SNP <italic>j </italic>to the state <italic>q</italic><sub><italic>j</italic>+1</sub>(<italic>k</italic>) of haplotype <italic>h</italic><sub><italic>k </italic></sub>for SNP <italic>j+1</italic>. If <italic>l </italic>&#x02260; <italic>k </italic>then <italic>a</italic><sub><italic>j </italic></sub>(<italic>l</italic>,<italic>k</italic>) is the probability for <italic>h</italic><sub><italic>l </italic></sub>to be recombined with <italic>h</italic><sub><italic>k </italic></sub>between SNP <italic>j </italic>and SNP <italic>j+1 </italic>(large dashed arrows in Figure <xref ref-type="fig" rid="F2">2</xref>). And conversely, if <italic>l </italic>= <italic>k </italic>then <italic>a</italic><sub><italic>j </italic></sub>(<italic>l</italic>,<italic>l</italic>) is the probability for <italic>h</italic><sub><italic>l </italic></sub>to be not recombined between the two SNPs (plain arrows in Figure <xref ref-type="fig" rid="F2">2</xref>).</p><p>&#x02022; The emission probability <italic>b</italic><sub><italic>j</italic></sub>(<italic>k</italic>) of the hidden allele of <italic>q</italic><sub><italic>j</italic></sub>(<italic>k</italic>) in the observed allele <italic>o</italic><sub><italic>j </italic></sub>of <italic>h </italic>(small dashed arrows in Figure <xref ref-type="fig" rid="F2">2</xref>). If the hidden allele is different from the observed one, then <italic>b</italic><sub><italic>j</italic></sub>(<italic>k</italic>) corresponds to the probability that the hidden allele <italic>q</italic><sub><italic>j</italic></sub>(<italic>k</italic>) has been altered in <italic>o</italic><sub><italic>j </italic></sub>by a mutation event. Else, <italic>b</italic><sub><italic>j</italic></sub>(<italic>k</italic>) corresponds to the probability that no mutation has occurred.</p><p>In the HMM <italic>&#x003bb;</italic>, the probability of a hidden states' sequence is given by the product of the corresponding transition probabilities. And the probability to observe <italic>h </italic>= {<italic>o</italic><sub>1</sub>, ..., <italic>o</italic><sub><italic>s</italic></sub>} given a particular hidden states' sequence is obtained by the product of the probabilities for the hidden alleles to be emitted in the observed ones. Finally, to compute the probability Pr(<italic>h</italic>|<italic>&#x003bb;</italic>), one must sum up the probabilities of observing <italic>h </italic>over all (2<italic>n </italic>- 2)<sup><italic>s </italic></sup>possible sequences of <italic>s </italic>hidden states. An alternative to this expensive computational approach is to define a forward probability <italic>&#x003b1;</italic><sub><italic>j</italic></sub>(<italic>k</italic>) as the probability for the incomplete observed sequence {<italic>o</italic><sub>1</sub>, ..., <italic>o</italic><sub><italic>j</italic></sub>} to be emitted by all the possible hidden sequences that end at state <italic>q</italic><sub><italic>j</italic></sub>(<italic>k</italic>). Then, the partial posterior probability <italic>&#x003c0;</italic><sub><italic>j </italic></sub>until SNP <italic>j </italic>of <italic>h </italic>can be written as follows:</p><p><disp-formula id="bmcM1a"><label>(1a)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M6" name="1471-2105-9-540-i3" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>&#x003c0;</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>h</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mn>...</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>&#x003c1;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>&#x003b1;</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>And the total probability of <italic>h </italic>over the <italic>s </italic>SNPs becomes:</p><p><disp-formula id="bmcM2"><label>(2)</label><italic>&#x003c0;</italic>(<italic>h</italic>|<italic>h</italic><sub>1</sub>, ..., <italic>h</italic><sub>2<italic>n</italic>-2</sub>, <italic>&#x003c1;</italic>) = <italic>&#x003c0;</italic><sub><italic>s</italic></sub>(<italic>h</italic>|<italic>h</italic><sub>1</sub>, ..., <italic>h</italic><sub>2<italic>n</italic>-2</sub>, <italic>&#x003c1;</italic>)</disp-formula></p><p>The computations of <italic>&#x003b1;</italic><sub><italic>j</italic></sub>(<italic>k</italic>) for <italic>k </italic>= 1,..., 2<italic>n</italic>-2 and <italic>j </italic>= 1,..., <italic>s </italic>are efficiently done by a recursive algorithm for HMM called forward algorithm [<xref ref-type="bibr" rid="B36">36</xref>]. It starts from initial values:</p><p><disp-formula id="bmcM3"><label>(3)</label><italic>&#x003b1;</italic><sub>1</sub>(<italic>k</italic>) = <italic>b</italic><sub>1</sub>(<italic>k</italic>)/(2<italic>n </italic>- 2)</disp-formula></p><p>And recursively computes the <italic>&#x003b1;</italic><sub><italic>j</italic>+1 </sub>values from the <italic>&#x003b1;</italic><sub><italic>j </italic></sub>values as follows:</p><p><disp-formula id="bmcM4"><label>(4)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M7" name="1471-2105-9-540-i4" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>&#x003b1;</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x000d7;</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>&#x003b1;</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x000d7;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>Computing all the <italic>&#x003b1; </italic>values for a haplotype requires now running time in <italic>O</italic>(<italic>sn</italic><sup>2</sup>) instead of <italic>O</italic>(<italic>n</italic><sup><italic>s</italic></sup>).</p></sec><sec><title>Computation of the FDLS distribution from a haplotype list by Phase v2.1 (Figure <xref ref-type="fig" rid="F3">3A</xref>)</title><fig position="float" id="F3"><label>Figure 3</label><caption><p><bold>Different representations of the space of possible haplotypes pairs S<sub><italic>i</italic></sub></bold>. The left panel (A) shows the list representation commonly used by haplotype software such as Phase v2.1. The lower right panel (C) shows the representation used by Shape-IT. White and black circles indicate the phases between the heterozygous SNPs. On this example we use the same genotype G<sub><italic>i </italic></sub>described in Figure <xref ref-type="fig" rid="F1">1</xref>. For iterations as performed by Phase v2.1 (A), the list requires the exploration of 20 nodes (4 haplotype pairs &#x000d7; 5 SNPs). With the complete tree representation (B) 10 nodes need to be explored, and with the incomplete tree representation as performed by Shape-IT (C), only 7 nodes need to be explored. The difference observed between (B) and (C) results from the pruning strategy which avoids the exploration of the nodes with probability &#x02264; 0.01.</p></caption><graphic xlink:href="1471-2105-9-540-3"/></fig><p>The Phase v2.1 algorithm considers the haplotype space <italic>S</italic><sub><italic>i </italic></sub>as a list of <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M8" name="1471-2105-9-540-i5" overflow="scroll"><mml:semantics><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:semantics></mml:math></inline-formula> haplotypes compatibles with the genotype <italic>G</italic><sub><italic>i </italic></sub>where <italic>z</italic><sub><italic>i </italic></sub>is the number of heterozygous SNPs. And it computes the FDLS distribution over this list with equations (3) and (1) on the HMM <italic>&#x003bb;</italic>. This approach is computationally intensive for two reasons. First, it performs many times the same computations of <italic>&#x003b1; </italic>values with the forward algorithm since the haplotypes of <italic>S</italic><sub><italic>i </italic></sub>are derived from the same genotype and share thus identical allelic segments. For instance, as shown in Figure <xref ref-type="fig" rid="F3">3A</xref>, several haplotypes of <italic>S</italic><sub><italic>i </italic></sub>differ only in the last SNPs while the computation of forward values <italic>&#x003b1; </italic>starts each time from the first SNP. Second, the list of haplotypes grows exponentially with the number of heterozygous SNPs which prevents any application with a high number of SNPs. To partially overcome this problem, a "divide for conquer" solution called "partition-ligation" (PL) was first proposed by Niu et al [<xref ref-type="bibr" rid="B14">14</xref>,<xref ref-type="bibr" rid="B19">19</xref>,<xref ref-type="bibr" rid="B21">21</xref>]. It has been included in the Phase v2.1 algorithm as follows: it first divides the genotypes into segments of limited size (typically 5&#x02013;8 SNPs), determines the most probable haplotypes on each segment with complete runs of the GS, and then progressively ligates haplotypes of the adjacent segments in several runs until completion. When two adjacent segments are ligated, the space <italic>S </italic>of candidate haplotype pairs is initialized from all combinations of the most probable haplotypes previously found in each segment. However, the PL procedure remains computationally expensive because it implies <italic>2s/p - 1 </italic>(where <italic>p </italic>is the size of the partitions) complete runs of the algorithm, each time on a quadratic number of combinations of adjacent plausible haplotypes.</p></sec><sec><title>Computation of the FDLS distribution from a complete binary tree by Shape-IT (Figure <xref ref-type="fig" rid="F3">3B</xref>)</title><p>To compute the FDLS distribution while avoiding any redundant calculations of <italic>&#x003b1; </italic>values, our algorithm uses a complete binary tree (called haplotype tree in the following) instead of an exhaustive list to represent the haplotype pairs space <italic>S</italic><sub><italic>i</italic></sub>. It can be viewed as an extension of the forward algorithm which computes the probabilities of observing in the HMM <italic>&#x003bb; </italic>several pairs of sequences classified into a binary tree rather than observing a unique sequence.</p><p>Such a haplotype tree is easily derived from a partition of genotype <italic>G</italic><sub><italic>i </italic></sub>into <italic>m </italic>unambiguous segments <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M9" name="1471-2105-9-540-i6" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:msup><mml:mi>g</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mn>...</mml:mn><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:msup><mml:mi>g</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:semantics></mml:math></inline-formula> : each one starts from a heterozygous SNP, includes all the following homozygous SNPs, and ends before the next heterozygous SNP. A node of the haplotype tree corresponds to a genotype segment <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M10" name="1471-2105-9-540-i7" overflow="scroll"><mml:semantics><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:msup><mml:mi>g</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:semantics></mml:math></inline-formula>, and the two children nodes, to the two possible switch orientations with the following segment (<italic>g</italic><sub><italic>j</italic>+1</sub>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M11" name="1471-2105-9-540-i8" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:msup><mml:mi>g</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>) and (<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M12" name="1471-2105-9-540-i8" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:msup><mml:mi>g</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>, <italic>g</italic><sub><italic>j</italic>+1</sub>). Then, a single path from the root to a leaf corresponds to a single possible haplotype pair of <italic>S</italic><sub><italic>i </italic></sub>(Figure <xref ref-type="fig" rid="F3">3B</xref>).</p><p>To compute efficiently the FDLS distribution, Shape-IT explores the haplotype tree with a single recursive algorithm which combines the reconstruction of the haplotypes and the calculation of associated <italic>&#x003b1; </italic>forward values. In practice, it iterates the nodes by level-order (i.e. segment-order) to avoid any previous construction in memory of the haplotype tree. When visiting a node with the associated genotype segment (<italic>g</italic>, <italic>g</italic>'), the algorithm makes recursively a quadruplet <italic>q </italic>= {<italic>h</italic>, <italic>&#x003b1;</italic>, <italic>h'</italic>, <italic>&#x003b1;'</italic>} where <italic>h </italic>and <italic>h</italic>' are the two haplotypes with respective forward values <italic>&#x003b1; </italic>and <italic>&#x003b1;' </italic>corresponding to the current explored path in the haplotype tree. Once all the nodes visited, the haplotype pairs of <italic>S</italic><sub><italic>i </italic></sub>and the FDLS distribution are given respectively by the haplotypes and the forward values of the quadruplets associated to the leaf nodes. This approach is implemented in the algorithm 1 (Figure <xref ref-type="fig" rid="F4">4</xref>).</p><fig position="float" id="F4"><label>Figure 4</label><caption><p>Algorithm 1 to compute the FDSL distribution on the complete haplotype tree.</p></caption><graphic xlink:href="1471-2105-9-540-4"/></fig><p>This algorithm avoids all the unnecessary forward value computations made when using the representation by haplotype lists. However, the haplotype tree to be explored still grows exponentially with an increasing number of heterozygous SNPs. It results in a list <italic>L </italic>whose size is multiplied by two at each level explored (Figure <xref ref-type="fig" rid="F4">4</xref>). As with the classical haplotype list approach, this algorithm can be simply implemented in a PL strategy: first, a haplotype tree is derived for each segment of genotype, and then the most probable adjacent subtrees are determined and combined until completion. We have used an alternative strategy described in the next paragraph.</p></sec><sec><title>Computation of the FDLS distribution from an incomplete binary tree by Shape-IT (Figure <xref ref-type="fig" rid="F3">3C</xref>)</title><p>In practice, the number of haplotype pairs sufficiently probable to be sampled in the FDLS distribution is roughly linear with the number of SNPs instead of being exponential. As an alternative to the classical and expensive PL strategy, we have thus modified our recursive algorithm to explore only the paths in the haplotype tree which correspond to the most plausible haplotype pairs. In other words, our algorithm aims at identifying an incomplete binary tree of limited size which captures at best the informative part of FDLS distribution (Figure <xref ref-type="fig" rid="F3">3C</xref>). For that, recursions are made only on nodes exhibiting a probability, as given by expressions (2) and (1), greater than a threshold <italic>f </italic>initially defined. In practice, it results in maintaining a list <italic>L </italic>of quadruplets of limited size for each level of the tree explored, which no longer grows exponentially with the number of heterozygous SNPs. The corresponding modifications made in algorithm 1 are implemented in algorithm 2 (Figure <xref ref-type="fig" rid="F5">5</xref>). Obviously the value of the threshold <italic>f </italic>affects the number of quadruplets kept at each level of the haplotype tree and thus, the number of haplotype pairs on which the FDLS distribution is computed. It is clear that the value of threshold <italic>f </italic>influences the diversity of haplotypes to be captured and so, the computational effort needed. However, the strength of our algorithm clearly lies in the greatly reduced complexity with the number of SNPs of the FDLS computation step. Moreover, compared to the <italic>2s/p - 1 </italic>complete runs of the GS required by the PL strategy, it treats all the SNPs in a single run.</p><fig position="float" id="F5"><label>Figure 5</label><caption><p>Algorithm 2 to compute the FDSL distribution on the incomplete haplotype tree.</p></caption><graphic xlink:href="1471-2105-9-540-5"/></fig></sec></sec><sec sec-type="methods"><title>Methods</title><p>We have implemented our algorithm in the software package Shape-IT publicly available at <ext-link ext-link-type="uri" xlink:href="http://www.griv.org/shapeit/"/>. We have extensively compared Shape-IT with the widely used haplotype inference software 2snp [<xref ref-type="bibr" rid="B23">23</xref>], Gerbil [<xref ref-type="bibr" rid="B15">15</xref>], Fastphase [<xref ref-type="bibr" rid="B16">16</xref>], PL-EM [<xref ref-type="bibr" rid="B14">14</xref>], Ishape [<xref ref-type="bibr" rid="B27">27</xref>] and Phase v2.1 [<xref ref-type="bibr" rid="B21">21</xref>,<xref ref-type="bibr" rid="B22">22</xref>] on 3 kinds of datasets described hereafter. All the software were run with default parameters on a standard 2 GHz computer with 1 Go of RAM.</p><p>In the comparisons, we have tried to work as close as possible to real conditions: on the one hand, we have used tightly linked SNPs such as those used in a single gene fine mapping and on the other hand, we have used TagSNPs with a low level of LD which correspond to the worst conditions to infer haplotypes. At last, we have also made estimations of the running times required by the most accurate software to infer the haplotypes of a 300 K Illumina chips.</p><sec><title>Single gene datasets</title><p>First, we have used genotypes for which the haplotypes have been completely determined experimentally: the GH1 [<xref ref-type="bibr" rid="B37">37</xref>] and ApoE [<xref ref-type="bibr" rid="B38">38</xref>] genes. The GH1 dataset contains 14 SNPs for 150 Caucasian individuals and the ApoE dataset contains 9 SNPs for 90 individuals of mixed ethnic origins. For each gene, we have additionally generated 100 replicates by randomly masking 5% of the alleles in order to simulate real experimental conditions (missing data). On these datasets, we have measured the IER (Individual Error Rate) and the MER (Missing data Error Rate) which corresponds respectively to the percentage of individuals incorrectly inferred and to the percentage of missing data incorrectly inferred. Although of limited size, these two genes are very useful to compare precisely the haplotype frequency estimations made by the algorithms via the I<sub>F </sub>coefficient [<xref ref-type="bibr" rid="B25">25</xref>], since haplotype frequencies are commonly used by the geneticists in genetic association studies.</p></sec><sec><title>HapMap trio datasets</title><p>Second, we have worked on trios' genotypes (2 parents and 1 child) derived from the HapMap project [<xref ref-type="bibr" rid="B7">7</xref>,<xref ref-type="bibr" rid="B8">8</xref>]. We have collected five regions of 10 Mb on chromosomes 1, 2, 3, 4 and 5 in African (YRI) or European (CEU) populations. The 10 resulting chromosomal regions have been preprocessed by the Haploview software [<xref ref-type="bibr" rid="B39">39</xref>] to remove SNPs with Mendelian inconsistency or with insufficient minor allele frequency (MAF). From these chromosomal regions, we have generated several HapMap datasets according to the choices of markers described in Table <xref ref-type="table" rid="T1">1</xref>[<xref ref-type="bibr" rid="B24">24</xref>,<xref ref-type="bibr" rid="B27">27</xref>]. On all these trios' genotypes, the parent haplotypes can be partially obtained (about ~80% of the phases between adjacent heterozygous SNPs are determined), and we have measured the running times of the various algorithms and the SER (Switch Error Rate) of haplotypes inferred by the various software. The SER corresponds to the percentage of known phases between adjacent heterozygous SNPs (obtained thanks to the trios affiliation) incorrectly inferred [<xref ref-type="bibr" rid="B22">22</xref>,<xref ref-type="bibr" rid="B27">27</xref>], which is more adapted than the IER on large numbers of SNPs because the IER does not differentiate between one or several heterozygous SNPs incorrectly inferred.</p><table-wrap position="float" id="T1"><label>Table 1</label><caption><p>Hapmap trio datasets description</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="left"><bold>Datasets</bold></td><td align="center"><bold>Chromosome</bold></td><td align="center"><bold>#datasets</bold></td><td align="center"><bold>#SNP</bold></td><td align="center"><bold>#indiv</bold></td><td align="left"><bold>Details</bold></td></tr></thead><tbody><tr><td align="left">CEU Size</td><td align="center">1 to 5</td><td align="center">250</td><td align="center">10 to 160</td><td align="center">60</td><td align="left">50 datasets of 10, 20, 40, 80 and 160 adjacent SNPs with MAF above 5%</td></tr><tr><td align="left">CEU Density</td><td align="center">1 to 5</td><td align="center">300</td><td align="center">40</td><td align="center">60</td><td align="left">50 datasets with spanned distance between SNP above 0, 0.5, 1, 2, 4 and 8 kb (MAF 5%)</td></tr><tr><td align="left">CEU MAF</td><td align="center">1 to 5</td><td align="center">150</td><td align="center">40</td><td align="center">60</td><td align="left">50 datasets with MAF above 1%, 5% and 10%</td></tr><tr><td align="left">YRI Size</td><td align="center">1 to 5</td><td align="center">250</td><td align="center">10 to 160</td><td align="center">60</td><td align="left">50 datasets of 10, 20, 40, 80 and 160 adjacent SNPs with MAF above 5%</td></tr><tr><td align="left">YRI Density</td><td align="center">1 to 5</td><td align="center">300</td><td align="center">40</td><td align="center">60</td><td align="left">50 datasets with spanned distance between SNP above 0, 0.5, 1, 2, 4 and 8 kb (MAF 5%)</td></tr><tr><td align="left">YRI MAF</td><td align="center">1 to 5</td><td align="center">150</td><td align="center">40</td><td align="center">60</td><td align="left">50 datasets with MAF above 1%, 5% and 10%</td></tr><tr><td align="left">CEU illumina 50</td><td align="center">12</td><td align="center">300</td><td align="center">50</td><td align="center">60</td><td align="left">15,000 illumina SNPs grouped by dataset of 50 SNPs</td></tr><tr><td align="left">CEU illumina 100</td><td align="center">12</td><td align="center">150</td><td align="center">100</td><td align="center">60</td><td align="left">15,000 illumina SNPs grouped by dataset of 100 SNPs</td></tr><tr><td align="left">CEU illumina 200</td><td align="center">12</td><td align="center">75</td><td align="center">200</td><td align="center">60</td><td align="left">15,000 illumina SNPs grouped by dataset of 200 SNPs</td></tr><tr><td align="left">GRIV</td><td align="center">1</td><td align="center">90</td><td align="center">50 to 200</td><td align="center">100 to 300</td><td align="left">3,500 illumina SNPs grouped by dataset of 50, 100 and 200 SNPs</td></tr></tbody></table><table-wrap-foot><p>Description of the benchmarks derived from the HapMap trios datasets that we used to compare accuracy and runtimes of the various algorithms in Table <xref ref-type="table" rid="T4">4</xref>. For each parameter (size, density, and MAF) 10 samples were chosen in each of the chromosomes 1 to 5, i.e. a total of 50 tests per parameter.</p></table-wrap-foot></table-wrap><p>To investigate on the impact of low LD in haplotype inference, we have also used a set of 15,000 adjacent Tag SNPs picked up from the large arm of chromosome 12 and found in the 300 K Illumina chips.</p></sec><sec><title>GRIV cohort datasets</title><p>Third, we have generated large SNP datasets from subjects of the GRIV (Genomics of Resistance to Immunodeficiency Virus) cohort genotyped with the 300 K Illumina chip. The GRIV cohort comprehends about 400 Caucasian subjects collected for genomic studies in AIDS [<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B40">40</xref>-<xref ref-type="bibr" rid="B43">43</xref>]. These datasets were used to estimate the running times required by the most accurate software to infer the haplotypes of a 300 K Illumina chips. For that, we have generated 10 datasets from the GRIV cohort data for various numbers of markers (50, 100 and 200) and for various numbers of individuals (100, 200 and 300). Then the average running time over the 10 datasets of each combination of SNP number and genotype number was used to extrapolate the running time required to infer the haplotypes over the 300,000 SNPs.</p></sec></sec><sec><title>Results</title><sec><title>Empirical determination of the threshold f (Figure <xref ref-type="fig" rid="F6">6</xref>)</title><fig position="float" id="F6"><label>Figure 6</label><caption><p><bold>Accuracy of the different values tested for the threshold <italic>f </italic>in Shape-IT (grey boxes) compared to Phase v2.1 (black line)</bold>. This comparison was done on 300 datasets of 50 Tag SNPs called CEU Illumina 50.</p></caption><graphic xlink:href="1471-2105-9-540-6"/></fig><p>As discussed in the section Algorithm, Shape-IT relies on a threshold <italic>f </italic>to discard some branches of the haplotype binary trees. So, we have tested several values for <italic>f</italic>: the accuracy is clearly stable for values below 0.01. Since the running time was optimal for <italic>f </italic>= 0.01, we have used this value as default in all the following comparisons.</p></sec><sec><title>Comparisons on the single gene datasets (Table <xref ref-type="table" rid="T2">2</xref> and <xref ref-type="table" rid="T3">3</xref>)</title><table-wrap position="float" id="T2"><label>Table 2</label><caption><p>Results obtained by various haplotyping software on the experimentally determined ApoE dataset.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="left"><bold>ApoE</bold></td><td align="center" colspan="2"><bold>0%MD</bold></td><td align="center" colspan="3"><bold>5%MD</bold></td></tr></thead><tbody><tr><td></td><td align="center"><bold>IER</bold></td><td align="center"><bold>IF</bold></td><td align="center"><bold>IER</bold></td><td align="center"><bold>MER</bold></td><td align="center"><bold>IF</bold></td></tr><tr><td></td><td colspan="2"><hr></hr></td><td colspan="3"><hr></hr></td></tr><tr><td align="left">2snp</td><td align="center">20.0</td><td align="center">83.8</td><td align="center">22.7</td><td align="center">7.3</td><td align="center">83.9</td></tr><tr><td align="left">Fastphase</td><td align="center">11.3</td><td align="center">89.4</td><td align="center">17.4</td><td align="center">6.1</td><td align="center">87.5</td></tr><tr><td align="left">Gerbil</td><td align="center">20.0</td><td align="center">81.3</td><td align="center">20.3</td><td align="center">6.6</td><td align="center">84.6</td></tr><tr><td align="left">Ishape</td><td align="center"><bold><italic>5.6</italic></bold></td><td align="center"><bold><italic>94.1</italic></bold></td><td align="center"><bold><italic>10.2</italic></bold></td><td align="center">5.9</td><td align="center"><bold><italic>92.5</italic></bold></td></tr><tr><td align="left">Shape-IT</td><td align="center"><bold><italic>5.6</italic></bold></td><td align="center"><bold><italic>94.1</italic></bold></td><td align="center">10.5</td><td align="center">6.2</td><td align="center">92.4</td></tr><tr><td align="left">Phase v2.1</td><td align="center">5.8</td><td align="center">94.0</td><td align="center"><bold><italic>10.2</italic></bold></td><td align="center"><bold><italic>5.8</italic></bold></td><td align="center">92.4</td></tr><tr><td align="left">PLEM</td><td align="center">12.5</td><td align="center">89.8</td><td align="center">16.0</td><td align="center">6.5</td><td align="center">88.7</td></tr></tbody></table><table-wrap-foot><p>For the various software tested, we measured the percentage of individuals incorrectly reconstructed (IER), the percentage of missing data incorrectly inferred (MER), and the distance between real and inferred haplotype frequencies (IF) on the ApoE with complete genotypes and 5% random missing genotypes.</p></table-wrap-foot></table-wrap><table-wrap position="float" id="T3"><label>Table 3</label><caption><p>Results obtained by various haplotyping software on the experimentally determined GH1 dataset.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="left"><bold>GH1</bold></td><td align="center" colspan="2"><bold>0%MD</bold></td><td align="center" colspan="3"><bold>5%MD</bold></td></tr></thead><tbody><tr><td></td><td align="center"><bold>IER</bold></td><td align="center"><bold>IF</bold></td><td align="center"><bold>IER</bold></td><td align="center"><bold>MER</bold></td><td align="center"><bold>IF</bold></td></tr><tr><td></td><td colspan="2"><hr></hr></td><td colspan="3"><hr></hr></td></tr><tr><td align="left">2snp</td><td align="center">15.7</td><td align="center">88.2</td><td align="center">22.0</td><td align="center">7.5</td><td align="center">88.3</td></tr><tr><td align="left">Fastphase</td><td align="center">10.5</td><td align="center">92.5</td><td align="center">17.3</td><td align="center">4.5</td><td align="center">90.7</td></tr><tr><td align="left">Gerbil</td><td align="center">11.8</td><td align="center">92.8</td><td align="center">16.7</td><td align="center"><bold><italic>4.2</italic></bold></td><td align="center">91.6</td></tr><tr><td align="left">Ishape</td><td align="center"><bold><italic>10.1</italic></bold></td><td align="center"><bold><italic>93.8</italic></bold></td><td align="center">15.0</td><td align="center">4.5</td><td align="center"><bold><italic>92.6</italic></bold></td></tr><tr><td align="left">Shape-IT</td><td align="center">10.3</td><td align="center">93.6</td><td align="center"><bold><italic>14.9</italic></bold></td><td align="center">4.5</td><td align="center">92.5</td></tr><tr><td align="left">Phase v2.1</td><td align="center">10.3</td><td align="center">93.7</td><td align="center">15.2</td><td align="center">4.5</td><td align="center">92.5</td></tr><tr><td align="left">PLEM</td><td align="center">12.4</td><td align="center">90.3</td><td align="center">17.2</td><td align="center">4.8</td><td align="center">89.4</td></tr></tbody></table><table-wrap-foot><p>For the various software tested, we measured the percentage of individuals incorrectly reconstructed (IER), the percentage of missing data incorrectly inferred (MER), and the distance between real and inferred haplotype frequencies (IF) on the GH1 with complete genotypes and 5% random missing genotypes.</p></table-wrap-foot></table-wrap><p>On these datasets, Shape-IT, Ishape and Phase v2.1 give clearly the better haplotype reconstructions and frequency estimations compared to the other software. One can notice that Ishape seems to be slightly more accurate than Shape-IT and Phase v2.1. For the completion of missing data, all the methods (except 2snp) are closely related.</p></sec><sec><title>Comparisons on the HapMap trio datasets (Table <xref ref-type="table" rid="T1">1</xref> and <xref ref-type="table" rid="T4">4</xref>)</title><table-wrap position="float" id="T4"><label>Table 4</label><caption><p>Hapmap trio datasets results</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="center"><bold>Datasets</bold></td><td align="center" colspan="2"><bold>Shape-IT</bold></td><td align="center" colspan="2"><bold>Phase v2.1</bold></td><td align="center" colspan="2"><bold>Fastphase</bold></td><td align="center" colspan="2"><bold>Ishape</bold></td><td align="center" colspan="2"><bold>2snp</bold></td><td align="center" colspan="2"><bold>Gerbil</bold></td><td align="center" colspan="2"><bold>PLEM</bold></td></tr><tr><td colspan="1"><hr></hr></td><td colspan="2"><hr></hr></td><td colspan="2"><hr></hr></td><td colspan="2"><hr></hr></td><td colspan="2"><hr></hr></td><td colspan="2"><hr></hr></td><td colspan="2"><hr></hr></td><td colspan="2"><hr></hr></td></tr><tr><td></td><td align="center"><bold>SER</bold></td><td align="center"><bold>Time</bold></td><td align="center"><bold>SER</bold></td><td align="center"><bold>Time</bold></td><td align="center"><bold>SER</bold></td><td align="center"><bold>Time</bold></td><td align="center"><bold>SER</bold></td><td align="center"><bold>Time</bold></td><td align="center"><bold>SER</bold></td><td align="center"><bold>Time</bold></td><td align="center"><bold>SER</bold></td><td align="center"><bold>Time</bold></td><td align="center"><bold>SER</bold></td><td align="center"><bold>Time</bold></td></tr></thead><tbody><tr><td align="left">CEU Size</td><td align="center"><bold><italic>1.1</italic></bold></td><td></td><td align="center"><bold><italic>1.1</italic></bold></td><td></td><td align="center">1.5</td><td></td><td align="center"><bold>1.1</bold></td><td></td><td align="center">2.2</td><td></td><td align="center">2.3</td><td></td><td align="center">2.0</td><td></td></tr><tr><td></td><td></td><td align="center">53</td><td></td><td align="center">832</td><td></td><td align="center">113</td><td></td><td align="center">93</td><td></td><td align="center">&#x0003c; 1</td><td></td><td align="center">50</td><td></td><td align="center">10</td></tr><tr><td align="left">YRI Size</td><td align="center"><bold><italic>1.7</italic></bold></td><td></td><td align="center"><bold><italic>1.7</italic></bold></td><td></td><td align="center">2.3</td><td></td><td align="center">1.8</td><td></td><td align="center">4.5</td><td></td><td align="center">3.9</td><td></td><td align="center">4.2</td><td></td></tr><tr><td></td><td></td><td align="center">64</td><td></td><td align="center">1,209</td><td></td><td align="center">125</td><td></td><td align="center">138</td><td></td><td align="center">&#x0003c; 1</td><td></td><td align="center">131</td><td></td><td align="center">10</td></tr><tr><td align="left">CEU Density</td><td align="center"><bold><italic>2.3</italic></bold></td><td></td><td align="center"><bold><italic>2.3</italic></bold></td><td></td><td align="center">2.7</td><td></td><td align="center">2.4</td><td></td><td align="center">4.2</td><td></td><td align="center">4.0</td><td></td><td align="center">4.1</td><td></td></tr><tr><td></td><td></td><td align="center">26</td><td></td><td align="center">214</td><td></td><td align="center">64</td><td></td><td align="center">43</td><td></td><td align="center">&#x0003c; 1</td><td></td><td align="center">5</td><td></td><td align="center">6</td></tr><tr><td align="left">YRI Density</td><td align="center"><bold><italic>3.7</italic></bold></td><td></td><td align="center"><bold><italic>3.7</italic></bold></td><td></td><td align="center">4.9</td><td></td><td align="center">3.9</td><td></td><td align="center">8.5</td><td></td><td align="center">7.5</td><td></td><td align="center">8.8</td><td></td></tr><tr><td></td><td></td><td align="center">35</td><td></td><td align="center">490</td><td></td><td align="center">71</td><td></td><td align="center">80</td><td></td><td align="center">&#x0003c; 1</td><td></td><td align="center">9</td><td></td><td align="center">5</td></tr><tr><td align="left">CEU MAF</td><td align="center"><bold><italic>1.1</italic></bold></td><td></td><td align="center"><bold><italic>1.1</italic></bold></td><td></td><td align="center">1.2</td><td></td><td align="center">1.2</td><td></td><td align="center">2.0</td><td></td><td align="center">2.1</td><td></td><td align="center">1.7</td><td></td></tr><tr><td></td><td></td><td align="center">19</td><td></td><td align="center">104</td><td></td><td align="center">71</td><td></td><td align="center">22</td><td></td><td align="center">&#x0003c; 1</td><td></td><td align="center">2</td><td></td><td align="center">4</td></tr><tr><td align="left">YRI MAF</td><td align="center"><bold><italic>1.5</italic></bold></td><td></td><td align="center"><bold><italic>1.5</italic></bold></td><td></td><td align="center">2.0</td><td></td><td align="center"><bold><italic>1.5</italic></bold></td><td></td><td align="center">4.5</td><td></td><td align="center">3.8</td><td></td><td align="center">3.2</td><td></td></tr><tr><td></td><td></td><td align="center">26</td><td></td><td align="center">173</td><td></td><td align="center">80</td><td></td><td align="center">38</td><td></td><td align="center">&#x0003c; 1</td><td></td><td align="center">4</td><td></td><td align="center">4</td></tr><tr><td align="left">CEU 50 illumina SNP</td><td align="center"><bold><italic>6.3</italic></bold></td><td></td><td align="center"><bold><italic>6.3</italic></bold></td><td></td><td align="center">7.2</td><td></td><td align="center">6.6</td><td></td><td align="center">10.7</td><td></td><td align="center">9.2</td><td></td><td align="center">12.2</td><td></td></tr><tr><td></td><td></td><td align="center">51</td><td></td><td align="center">1,214</td><td></td><td align="center">60</td><td></td><td align="center">161</td><td></td><td align="center">&#x0003c; 1</td><td></td><td align="center">22</td><td></td><td align="center">5</td></tr><tr><td align="left">CEU 100 illumina SNP</td><td align="center"><bold><italic>6.7</italic></bold></td><td></td><td align="center">6.8</td><td></td><td align="center">7.7</td><td></td><td align="center">9.2</td><td></td><td align="center">11.3</td><td></td><td align="center">9.7</td><td></td><td align="center">N/A</td><td></td></tr><tr><td></td><td></td><td align="center">143</td><td></td><td align="center">11,678</td><td></td><td align="center">144</td><td></td><td align="center">461</td><td></td><td align="center">&#x0003c; 1</td><td></td><td align="center">254</td><td></td><td align="center">N/A</td></tr><tr><td align="left">CEU 200 illumina SNP</td><td align="center"><bold><italic>7.2</italic></bold></td><td></td><td align="center">N/A</td><td></td><td align="center">8.0</td><td></td><td align="center">N/A</td><td></td><td align="center">11.5</td><td></td><td align="center">9.9</td><td></td><td align="center">N/A</td><td></td></tr><tr><td></td><td></td><td align="center">372</td><td></td><td align="center">N/A</td><td></td><td align="center">198</td><td></td><td align="center">N/A</td><td></td><td align="center">&#x0003c; 1</td><td></td><td align="center">2,038</td><td></td><td align="center">N/A</td></tr></tbody></table><table-wrap-foot><p>N/A: software was unable to handle some of these datasets (errors or untracktable running times). Results of the various tested software on the HapMap trios datasets described in Table <xref ref-type="table" rid="T1">1</xref>. For each software tested, the mean percentage of heterozygous markers incorrectly inferred (SER) is shown in the upper-left corner, and the mean running time in seconds is shown in the lower-right corner.</p></table-wrap-foot></table-wrap><p>As a matter of accuracy, Shape-IT and Phase v2.1 outperform all the other methods. Ishape comes second but plunges when dealing with larger number of Tag SNPs. Fastphase comes third but it seems to work relatively better when the datasets get bigger. 2snp, Gerbil, and PLEM do not match the accuracy of the other software. All the software get higher error rates when the number of Tag SNPs increases which is probably the consequence of the increasing complexity of the LD pattern when dealing with limited numbers of individuals.</p><p>As a matter of speed, the fastest software is clearly 2snp. For relatively small numbers of SNPs, PLEM and Gerbil are also very fast, but become very slow when the number of SNPs increases or when the LD pattern gets more complex to capture. Among the 4 most accurate software (Phase v2.1, Fastphase, Ishape, and Shape-IT), Phase v2.1 is the slowest, Shape-IT is the fastest for small and medium-sized SNP samples (&#x0003c; 100 SNPs), and Fastphase becomes faster for larger numbers of SNPs (see additional file <xref ref-type="supplementary-material" rid="S1">1</xref>).</p></sec><sec><title>Running time on the GRIV cohort datasets (Table <xref ref-type="table" rid="T5">5</xref>)</title><table-wrap position="float" id="T5"><label>Table 5</label><caption><p>Comparison of the estimated running times of various software on 300 K Illunima genotyping chips datasets.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="center"><bold>#SNPs</bold></td><td align="center"><bold>#genotypes</bold></td><td align="center"><bold>Fastphase</bold></td><td align="center"><bold>Ishape</bold></td><td align="center"><bold>Shape-IT</bold></td><td align="center"><bold>Phase v2.1</bold></td></tr></thead><tbody><tr><td align="center">50</td><td align="center">100</td><td align="center">10</td><td align="center">29</td><td align="center">10</td><td align="center">151</td></tr><tr><td align="center">100</td><td align="center">100</td><td align="center">6</td><td align="center">37</td><td align="center">12</td><td align="center">519</td></tr><tr><td align="center">200</td><td align="center">100</td><td align="center">6</td><td align="center">41</td><td align="center">19</td><td align="center">3,137</td></tr><tr><td align="center">50</td><td align="center">200</td><td align="center">21</td><td align="center">34</td><td align="center">13</td><td align="center">443</td></tr><tr><td align="center">100</td><td align="center">200</td><td align="center">21</td><td align="center">119</td><td align="center">29</td><td align="center">2,739</td></tr><tr><td align="center">200</td><td align="center">200</td><td align="center">21</td><td align="center">124</td><td align="center">37</td><td align="center">7,601</td></tr><tr><td align="center">50</td><td align="center">300</td><td align="center">37</td><td align="center">113</td><td align="center">28</td><td align="center">1,372</td></tr><tr><td align="center">100</td><td align="center">300</td><td align="center">41</td><td align="center">268</td><td align="center">52</td><td align="center">6,514</td></tr><tr><td align="center">200</td><td align="center">300</td><td align="center">42</td><td align="center">261</td><td align="center">81</td><td align="center">12,757</td></tr></tbody></table><table-wrap-foot><p>Estimations of the running times in days of the 4 most accurate software (Phase v2.1, Ishape, Fastphase and Shape-IT) to infer the haplotypes for 100, 200, or 300 genotypes derived from Illumina 300 k chips partitioned into segments of either 50 SNPs, or 100 SNPs, or 200 SNPs. For each combination #SNPs #genotypes, the running time estimations were extrapolated from the measures performed on 10 datasets extracted from the GRIV cohort 300 K Illumina chip genomic data.</p></table-wrap-foot></table-wrap><p>On these datasets, Shape-IT runs between 15 to 150 times faster that Phase v2.1, depending on the segmentation strategy used (50, 100 or 200 SNPs) and the number of genotypes in the population (100, 200 or 300). Fastphase remains the fastest software but closely followed by Shape-IT. The increase of SNP and genotype numbers strongly cripples Phase v2.1 and Ishape, while it is better handled by Shape-IT and Fastphase.</p></sec></sec><sec><title>Discussion and conclusion</title><p>We have developed a new algorithm derived from the Phase v2.1 Gibbs sampler scheme. We have improved the most time-consuming steps by using binary tree representations and by avoiding the PL procedure thanks to an incomplete exploration of binary trees. The resulting software, Shape-IT, is extremely accurate like Phase v2.1, but may run up to 150 times faster as shown in our tests. These results have an impact for the computation of haplotypes in genome scans as shown in Table <xref ref-type="table" rid="T5">5</xref>. As an example, for the 300,000 SNPs of an Illumina genotyping chip, inferring haplotypes on 6,000 segments of 50 SNPs with a regular 2 GHz computer would take for Shape-IT about 10 days for 100 individuals, 13 days for 200 individuals, 28 days for 300 individuals while it would take for Phase v2.1 151 days for 100 individuals (15 times more), 443 days for 200 individuals (34 times more) and 1372 days for 300 individuals (49 times more). The gain of time using Shape-IT is thus considerable and practically very useful to exploit datasets derived from large-scale genotyping chips.</p><p>An important aspect of this work is that other haplotype inference software relying on HMM may gain to implement this new binary tree representation of the observed genotypes. Moreover, we have not found in the literature the description of this algorithm whereas it might be useful for other fields using HMM.</p></sec><sec><title>Availability and requirements</title><p>Project name: Shape-IT v1.0</p><p>Project home page: <ext-link ext-link-type="uri" xlink:href="http://www.griv.org/shapeit/"/></p><p>Operating systems: MacOS, Windows, Linux32bits and Linux64bits.</p><p>Programming language: C++</p><p>Do not forget to read the manual file, manual_ShapeITv1.0.pdf, to get the detailed information. The software remains confidential until publication of the work. It will be freely available to academics, and a licence will be needed for non-academics (patented for business and commercial applications).</p></sec><sec><title>Authors' contributions</title><p>OD and CC worked on developing the methods and programs used in this study under the direct supervision of JFZ who conceived the study. All the authors have read and approved the final manuscript.</p></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="S1"><caption><title>Additional file 1</title><p><bold>Detailed trio datasets results.</bold> Detailed results of the various software tested on the HapMap trios datasets described in Table <xref ref-type="table" rid="T1">1</xref>. For each software tested, the mean percentage of heterozygous markers incorrectly inferred (SER) and the average running time in seconds are shown.</p></caption><media xlink:href="1471-2105-9-540-S1.xls" mimetype="application" mime-subtype="vnd.ms-excel"><caption><p>Click here for file</p></caption></media></supplementary-material></sec></body><back><ack><sec><title>Acknowledgements</title><p>OD has a fellowship from the French Ministry of Education, Research and technology, and CC has a fellowship from Conservatoire National des Arts et M&#x000e9;tiers. This work was supported by ACV development foundation, by Vaxconsulting, and by the Innovation 2007 program of Conservatoire National des Arts et M&#x000e9;tiers. The authors thank Dr Adkins and Dr Orzack for providing respectively the GH1 and ApoE gene datasets.</p></sec></ack><ref-list><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Vasilescu</surname><given-names>A</given-names></name><name><surname>Terashima</surname><given-names>Y</given-names></name><name><surname>Enomoto</surname><given-names>M</given-names></name><name><surname>Heath</surname><given-names>S</given-names></name><name><surname>Poonpiriya</surname><given-names>V</given-names></name><name><surname>Gatanaga</surname><given-names>H</given-names></name><name><surname>Do</surname><given-names>H</given-names></name><name><surname>Diop</surname><given-names>G</given-names></name><name><surname>Hirtzig</surname><given-names>T</given-names></name><name><surname>Auewarakul</surname><given-names>P</given-names></name><etal></etal></person-group><article-title>A haplotype of the human CXCR1 gene protective against rapid disease progression in HIV-1+ patients</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><year>2007</year><volume>104</volume><fpage>3354</fpage><lpage>3359</lpage><pub-id pub-id-type="pmid">17360650</pub-id><pub-id pub-id-type="doi">10.1073/pnas.0611670104</pub-id></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Daly</surname><given-names>MJ</given-names></name><name><surname>Rioux</surname><given-names>JD</given-names></name><name><surname>Schaffner</surname><given-names>SF</given-names></name><name><surname>Hudson</surname><given-names>TJ</given-names></name><name><surname>Lander</surname><given-names>ES</given-names></name></person-group><article-title>High-resolution haplotype structure in the human genome</article-title><source>Nature genetics</source><year>2001</year><volume>29</volume><fpage>229</fpage><lpage>232</lpage><pub-id pub-id-type="pmid">11586305</pub-id><pub-id pub-id-type="doi">10.1038/ng1001-229</pub-id></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Dawson</surname><given-names>E</given-names></name><name><surname>Abecasis</surname><given-names>GR</given-names></name><name><surname>Bumpstead</surname><given-names>S</given-names></name><name><surname>Chen</surname><given-names>Y</given-names></name><name><surname>Hunt</surname><given-names>S</given-names></name><name><surname>Beare</surname><given-names>DM</given-names></name><name><surname>Pabial</surname><given-names>J</given-names></name><name><surname>Dibling</surname><given-names>T</given-names></name><name><surname>Tinsley</surname><given-names>E</given-names></name><name><surname>Kirby</surname><given-names>S</given-names></name><etal></etal></person-group><article-title>A first-generation linkage disequilibrium map of human chromosome 22</article-title><source>Nature</source><year>2002</year><volume>418</volume><fpage>544</fpage><lpage>548</lpage><pub-id pub-id-type="pmid">12110843</pub-id><pub-id pub-id-type="doi">10.1038/nature00864</pub-id></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Gabriel</surname><given-names>SB</given-names></name><name><surname>Schaffner</surname><given-names>SF</given-names></name><name><surname>Nguyen</surname><given-names>H</given-names></name><name><surname>Moore</surname><given-names>JM</given-names></name><name><surname>Roy</surname><given-names>J</given-names></name><name><surname>Blumenstiel</surname><given-names>B</given-names></name><name><surname>Higgins</surname><given-names>J</given-names></name><name><surname>DeFelice</surname><given-names>M</given-names></name><name><surname>Lochner</surname><given-names>A</given-names></name><name><surname>Faggart</surname><given-names>M</given-names></name><etal></etal></person-group><article-title>The structure of haplotype blocks in the human genome</article-title><source>Science</source><year>2002</year><volume>296</volume><fpage>2225</fpage><lpage>2229</lpage><pub-id pub-id-type="pmid">12029063</pub-id><pub-id pub-id-type="doi">10.1126/science.1069424</pub-id></citation></ref><ref id="B5"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Johnson</surname><given-names>GC</given-names></name><name><surname>Esposito</surname><given-names>L</given-names></name><name><surname>Barratt</surname><given-names>BJ</given-names></name><name><surname>Smith</surname><given-names>AN</given-names></name><name><surname>Heward</surname><given-names>J</given-names></name><name><surname>Di Genova</surname><given-names>G</given-names></name><name><surname>Ueda</surname><given-names>H</given-names></name><name><surname>Cordell</surname><given-names>HJ</given-names></name><name><surname>Eaves</surname><given-names>IA</given-names></name><name><surname>Dudbridge</surname><given-names>F</given-names></name><etal></etal></person-group><article-title>Haplotype tagging for the identification of common disease genes</article-title><source>Nature genetics</source><year>2001</year><volume>29</volume><fpage>233</fpage><lpage>237</lpage><pub-id pub-id-type="pmid">11586306</pub-id><pub-id pub-id-type="doi">10.1038/ng1001-233</pub-id></citation></ref><ref id="B6"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Patil</surname><given-names>N</given-names></name><name><surname>Berno</surname><given-names>AJ</given-names></name><name><surname>Hinds</surname><given-names>DA</given-names></name><name><surname>Barrett</surname><given-names>WA</given-names></name><name><surname>Doshi</surname><given-names>JM</given-names></name><name><surname>Hacker</surname><given-names>CR</given-names></name><name><surname>Kautzer</surname><given-names>CR</given-names></name><name><surname>Lee</surname><given-names>DH</given-names></name><name><surname>Marjoribanks</surname><given-names>C</given-names></name><name><surname>McDonough</surname><given-names>DP</given-names></name><etal></etal></person-group><article-title>Blocks of limited haplotype diversity revealed by high-resolution scanning of human chromosome 21</article-title><source>Science</source><year>2001</year><volume>294</volume><fpage>1719</fpage><lpage>1723</lpage><pub-id pub-id-type="pmid">11721056</pub-id><pub-id pub-id-type="doi">10.1126/science.1065573</pub-id></citation></ref><ref id="B7"><citation citation-type="journal"><article-title>The International HapMap Project</article-title><source>Nature</source><year>2003</year><volume>426</volume><fpage>789</fpage><lpage>796</lpage><pub-id pub-id-type="pmid">14685227</pub-id><pub-id pub-id-type="doi">10.1038/nature02168</pub-id></citation></ref><ref id="B8"><citation citation-type="journal"><article-title>A haplotype map of the human genome</article-title><source>Nature</source><year>2005</year><volume>437</volume><fpage>1299</fpage><lpage>1320</lpage><pub-id pub-id-type="pmid">16255080</pub-id><pub-id pub-id-type="doi">10.1038/nature04226</pub-id></citation></ref><ref id="B9"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Frazer</surname><given-names>KA</given-names></name><name><surname>Ballinger</surname><given-names>DG</given-names></name><name><surname>Cox</surname><given-names>DR</given-names></name><name><surname>Hinds</surname><given-names>DA</given-names></name><name><surname>Stuve</surname><given-names>LL</given-names></name><name><surname>Gibbs</surname><given-names>RA</given-names></name><name><surname>Belmont</surname><given-names>JW</given-names></name><name><surname>Boudreau</surname><given-names>A</given-names></name><name><surname>Hardenbol</surname><given-names>P</given-names></name><name><surname>Leal</surname><given-names>SM</given-names></name><etal></etal></person-group><article-title>A second generation human haplotype map of over 3.1 million SNPs</article-title><source>Nature</source><year>2007</year><volume>449</volume><fpage>851</fpage><lpage>861</lpage><pub-id pub-id-type="pmid">17943122</pub-id><pub-id pub-id-type="doi">10.1038/nature06258</pub-id></citation></ref><ref id="B10"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Burgtorf</surname><given-names>C</given-names></name><name><surname>Kepper</surname><given-names>P</given-names></name><name><surname>Hoehe</surname><given-names>M</given-names></name><name><surname>Schmitt</surname><given-names>C</given-names></name><name><surname>Reinhardt</surname><given-names>R</given-names></name><name><surname>Lehrach</surname><given-names>H</given-names></name><name><surname>Sauer</surname><given-names>S</given-names></name></person-group><article-title>Clone-based systematic haplotyping (CSH): a procedure for physical haplotyping of whole genomes</article-title><source>Genome research</source><year>2003</year><volume>13</volume><fpage>2717</fpage><lpage>2724</lpage><pub-id pub-id-type="pmid">14656974</pub-id><pub-id pub-id-type="doi">10.1101/gr.1442303</pub-id></citation></ref><ref id="B11"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ding</surname><given-names>C</given-names></name><name><surname>Cantor</surname><given-names>CR</given-names></name></person-group><article-title>Direct molecular haplotyping of long-range genomic DNA with M1-PCR</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><year>2003</year><volume>100</volume><fpage>7449</fpage><lpage>7453</lpage><pub-id pub-id-type="pmid">12802015</pub-id><pub-id pub-id-type="doi">10.1073/pnas.1232475100</pub-id></citation></ref><ref id="B12"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Clark</surname><given-names>AG</given-names></name></person-group><article-title>Inference of haplotypes from PCR-amplified samples of diploid populations</article-title><source>Mol Biol Evol</source><year>1990</year><volume>7</volume><fpage>111</fpage><lpage>122</lpage><pub-id pub-id-type="pmid">2108305</pub-id></citation></ref><ref id="B13"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Excoffier</surname><given-names>L</given-names></name><name><surname>Slatkin</surname><given-names>M</given-names></name></person-group><article-title>Maximum-likelihood estimation of molecular haplotype frequencies in a diploid population</article-title><source>Mol Biol Evol</source><year>1995</year><volume>12</volume><fpage>921</fpage><lpage>927</lpage><pub-id pub-id-type="pmid">7476138</pub-id></citation></ref><ref id="B14"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Qin</surname><given-names>ZS</given-names></name><name><surname>Niu</surname><given-names>T</given-names></name><name><surname>Liu</surname><given-names>JS</given-names></name></person-group><article-title>Partition-ligation-expectation-maximization algorithm for haplotype inference with single-nucleotide polymorphisms</article-title><source>American journal of human genetics</source><year>2002</year><volume>71</volume><fpage>1242</fpage><lpage>1247</lpage><pub-id pub-id-type="pmid">12452179</pub-id><pub-id pub-id-type="doi">10.1086/344207</pub-id></citation></ref><ref id="B15"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kimmel</surname><given-names>G</given-names></name><name><surname>Shamir</surname><given-names>R</given-names></name></person-group><article-title>GERBIL: Genotype resolution and block identification using likelihood</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><year>2005</year><volume>102</volume><fpage>158</fpage><lpage>162</lpage><pub-id pub-id-type="pmid">15615859</pub-id><pub-id pub-id-type="doi">10.1073/pnas.0404730102</pub-id></citation></ref><ref id="B16"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Scheet</surname><given-names>P</given-names></name><name><surname>Stephens</surname><given-names>M</given-names></name></person-group><article-title>A fast and flexible statistical model for large-scale population genotype data: applications to inferring missing genotypes and haplotypic phase</article-title><source>American journal of human genetics</source><year>2006</year><volume>78</volume><fpage>629</fpage><lpage>644</lpage><pub-id pub-id-type="pmid">16532393</pub-id><pub-id pub-id-type="doi">10.1086/502802</pub-id></citation></ref><ref id="B17"><citation citation-type="other"><person-group person-group-type="author"><name><surname>Rastas</surname><given-names>P</given-names></name><name><surname>Koivisto</surname><given-names>M</given-names></name><name><surname>Mannila</surname><given-names>H</given-names></name><name><surname>Ukkonen</surname><given-names>E</given-names></name></person-group><article-title>A Hidden Markov Technique for Haplotype Reconstruction</article-title><source>5th Workshop on Algorithms in Bioinformatics: 2005</source><year>2005</year></citation></ref><ref id="B18"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kimmel</surname><given-names>G</given-names></name><name><surname>Shamir</surname><given-names>R</given-names></name></person-group><article-title>A block-free hidden Markov model for genotypes and its application to disease association</article-title><source>J Comput Biol</source><year>2005</year><volume>12</volume><fpage>1243</fpage><lpage>1260</lpage><pub-id pub-id-type="pmid">16379532</pub-id><pub-id pub-id-type="doi">10.1089/cmb.2005.12.1243</pub-id></citation></ref><ref id="B19"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Niu</surname><given-names>T</given-names></name><name><surname>Qin</surname><given-names>ZS</given-names></name><name><surname>Xu</surname><given-names>X</given-names></name><name><surname>Liu</surname><given-names>JS</given-names></name></person-group><article-title>Bayesian haplotype inference for multiple linked single-nucleotide polymorphisms</article-title><source>American journal of human genetics</source><year>2002</year><volume>70</volume><fpage>157</fpage><lpage>169</lpage><pub-id pub-id-type="pmid">11741196</pub-id><pub-id pub-id-type="doi">10.1086/338446</pub-id></citation></ref><ref id="B20"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Stephens</surname><given-names>M</given-names></name><name><surname>Smith</surname><given-names>NJ</given-names></name><name><surname>Donnelly</surname><given-names>P</given-names></name></person-group><article-title>A new statistical method for haplotype reconstruction from population data</article-title><source>American journal of human genetics</source><year>2001</year><volume>68</volume><fpage>978</fpage><lpage>989</lpage><pub-id pub-id-type="pmid">11254454</pub-id><pub-id pub-id-type="doi">10.1086/319501</pub-id></citation></ref><ref id="B21"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Stephens</surname><given-names>M</given-names></name><name><surname>Donnelly</surname><given-names>P</given-names></name></person-group><article-title>A comparison of bayesian methods for haplotype reconstruction from population genotype data</article-title><source>American journal of human genetics</source><year>2003</year><volume>73</volume><fpage>1162</fpage><lpage>1169</lpage><pub-id pub-id-type="pmid">14574645</pub-id><pub-id pub-id-type="doi">10.1086/379378</pub-id></citation></ref><ref id="B22"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Stephens</surname><given-names>M</given-names></name><name><surname>Scheet</surname><given-names>P</given-names></name></person-group><article-title>Accounting for decay of linkage disequilibrium in haplotype inference and missing-data imputation</article-title><source>American journal of human genetics</source><year>2005</year><volume>76</volume><fpage>449</fpage><lpage>462</lpage><pub-id pub-id-type="pmid">15700229</pub-id><pub-id pub-id-type="doi">10.1086/428594</pub-id></citation></ref><ref id="B23"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Brinza</surname><given-names>D</given-names></name><name><surname>Zelikovsky</surname><given-names>A</given-names></name></person-group><article-title>2SNP: scalable phasing based on 2-SNP haplotypes</article-title><source>Bioinformatics (Oxford, England)</source><year>2006</year><volume>22</volume><fpage>371</fpage><lpage>373</lpage><pub-id pub-id-type="pmid">16287933</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/bti785</pub-id></citation></ref><ref id="B24"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Marchini</surname><given-names>J</given-names></name><name><surname>Cutler</surname><given-names>D</given-names></name><name><surname>Patterson</surname><given-names>N</given-names></name><name><surname>Stephens</surname><given-names>M</given-names></name><name><surname>Eskin</surname><given-names>E</given-names></name><name><surname>Halperin</surname><given-names>E</given-names></name><name><surname>Lin</surname><given-names>S</given-names></name><name><surname>Qin</surname><given-names>ZS</given-names></name><name><surname>Munro</surname><given-names>HM</given-names></name><name><surname>Abecasis</surname><given-names>GR</given-names></name><etal></etal></person-group><article-title>A comparison of phasing algorithms for trios and unrelated individuals</article-title><source>American journal of human genetics</source><year>2006</year><volume>78</volume><fpage>437</fpage><lpage>450</lpage><pub-id pub-id-type="pmid">16465620</pub-id><pub-id pub-id-type="doi">10.1086/500808</pub-id></citation></ref><ref id="B25"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Adkins</surname><given-names>RM</given-names></name></person-group><article-title>Comparison of the accuracy of methods of computational haplotype inference using a large empirical dataset</article-title><source>BMC genetics</source><year>2004</year><volume>5</volume><fpage>22</fpage><pub-id pub-id-type="pmid">15291970</pub-id><pub-id pub-id-type="doi">10.1186/1471-2156-5-22</pub-id></citation></ref><ref id="B26"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Bettencourt</surname><given-names>BF</given-names></name><name><surname>Santos</surname><given-names>MR</given-names></name><name><surname>Fialho</surname><given-names>RN</given-names></name><name><surname>Couto</surname><given-names>AR</given-names></name><name><surname>Peixoto</surname><given-names>MJ</given-names></name><name><surname>Pinheiro</surname><given-names>JP</given-names></name><name><surname>Spinola</surname><given-names>H</given-names></name><name><surname>Mora</surname><given-names>MG</given-names></name><name><surname>Santos</surname><given-names>C</given-names></name><name><surname>Brehm</surname><given-names>A</given-names></name><etal></etal></person-group><article-title>Evaluation of two methods for computational HLA haplotypes inference using a real dataset</article-title><source>BMC bioinformatics</source><year>2008</year><volume>9</volume><fpage>68</fpage><pub-id pub-id-type="pmid">18230173</pub-id><pub-id pub-id-type="doi">10.1186/1471-2105-9-68</pub-id></citation></ref><ref id="B27"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Delaneau</surname><given-names>O</given-names></name><name><surname>Coulonges</surname><given-names>C</given-names></name><name><surname>Boelle</surname><given-names>PY</given-names></name><name><surname>Nelson</surname><given-names>G</given-names></name><name><surname>Spadoni</surname><given-names>JL</given-names></name><name><surname>Zagury</surname><given-names>JF</given-names></name></person-group><article-title>ISHAPE: new rapid and accurate software for haplotyping</article-title><source>BMC bioinformatics</source><year>2007</year><volume>8</volume><fpage>205</fpage><pub-id pub-id-type="pmid">17573965</pub-id><pub-id pub-id-type="doi">10.1186/1471-2105-8-205</pub-id></citation></ref><ref id="B28"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Marroni</surname><given-names>F</given-names></name><name><surname>Toni</surname><given-names>C</given-names></name><name><surname>Pennato</surname><given-names>B</given-names></name><name><surname>Tsai</surname><given-names>YY</given-names></name><name><surname>Duggal</surname><given-names>P</given-names></name><name><surname>Bailey-Wilson</surname><given-names>JE</given-names></name><name><surname>Presciuttini</surname><given-names>S</given-names></name></person-group><article-title>Haplotypic structure of the X chromosome in the COGA population sample and the quality of its reconstruction by extant software packages</article-title><source>BMC genetics</source><year>2005</year><volume>6</volume><fpage>S77</fpage><pub-id pub-id-type="pmid">16451691</pub-id><pub-id pub-id-type="doi">10.1186/1471-2156-6-S1-S77</pub-id></citation></ref><ref id="B29"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname><given-names>H</given-names></name><name><surname>Wu</surname><given-names>X</given-names></name><name><surname>Spitz</surname><given-names>MR</given-names></name><name><surname>Shete</surname><given-names>S</given-names></name></person-group><article-title>Comparison of haplotype inference methods using genotypic data from unrelated individuals</article-title><source>Human heredity</source><year>2004</year><volume>58</volume><fpage>63</fpage><lpage>68</lpage><pub-id pub-id-type="pmid">15711085</pub-id><pub-id pub-id-type="doi">10.1159/000083026</pub-id></citation></ref><ref id="B30"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Zaitlen</surname><given-names>NA</given-names></name><name><surname>Kang</surname><given-names>HM</given-names></name><name><surname>Feolo</surname><given-names>ML</given-names></name><name><surname>Sherry</surname><given-names>ST</given-names></name><name><surname>Halperin</surname><given-names>E</given-names></name><name><surname>Eskin</surname><given-names>E</given-names></name></person-group><article-title>Inference and analysis of haplotypes from combined genotyping studies deposited in dbSNP</article-title><source>Genome research</source><year>2005</year><volume>15</volume><fpage>1594</fpage><lpage>1600</lpage><pub-id pub-id-type="pmid">16251470</pub-id><pub-id pub-id-type="doi">10.1101/gr.4297805</pub-id></citation></ref><ref id="B31"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Do</surname><given-names>H</given-names></name><name><surname>Vasilescu</surname><given-names>A</given-names></name><name><surname>Carpentier</surname><given-names>W</given-names></name><name><surname>Meyer</surname><given-names>L</given-names></name><name><surname>Diop</surname><given-names>G</given-names></name><name><surname>Hirtzig</surname><given-names>T</given-names></name><name><surname>Coulonges</surname><given-names>C</given-names></name><name><surname>Labib</surname><given-names>T</given-names></name><name><surname>Spadoni</surname><given-names>JL</given-names></name><name><surname>Therwath</surname><given-names>A</given-names></name><etal></etal></person-group><article-title>Exhaustive genotyping of the interleukin-1 family genes and associations with AIDS progression in a French cohort</article-title><source>The Journal of infectious diseases</source><year>2006</year><volume>194</volume><fpage>1492</fpage><lpage>1504</lpage><pub-id pub-id-type="pmid">17083033</pub-id><pub-id pub-id-type="doi">10.1086/508545</pub-id></citation></ref><ref id="B32"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Do</surname><given-names>H</given-names></name><name><surname>Vasilescu</surname><given-names>A</given-names></name><name><surname>Diop</surname><given-names>G</given-names></name><name><surname>Hirtzig</surname><given-names>T</given-names></name><name><surname>Coulonges</surname><given-names>C</given-names></name><name><surname>Labib</surname><given-names>T</given-names></name><name><surname>Heath</surname><given-names>SC</given-names></name><name><surname>Spadoni</surname><given-names>JL</given-names></name><name><surname>Therwath</surname><given-names>A</given-names></name><name><surname>Lathrop</surname><given-names>M</given-names></name><etal></etal></person-group><article-title>Associations of the IL2Ralpha, IL4Ralpha, IL10Ralpha, and IFN (gamma) R1 cytokine receptor genes with AIDS progression in a French AIDS cohort</article-title><source>Immunogenetics</source><year>2006</year><volume>58</volume><fpage>2</fpage><lpage>3</lpage><pub-id pub-id-type="doi">10.1007/s00251-005-0072-3</pub-id></citation></ref><ref id="B33"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kamarainen</surname><given-names>OP</given-names></name><name><surname>Solovieva</surname><given-names>S</given-names></name><name><surname>Vehmas</surname><given-names>T</given-names></name><name><surname>Luoma</surname><given-names>K</given-names></name><name><surname>Riihimaki</surname><given-names>H</given-names></name><name><surname>Ala-Kokko</surname><given-names>L</given-names></name><name><surname>Mannikko</surname><given-names>M</given-names></name><name><surname>Leino-Arjas</surname><given-names>P</given-names></name></person-group><article-title>Common interleukin-6 promoter variants associate with the more severe forms of distal interphalangeal osteoarthritis</article-title><source>Arthritis research &#x00026; therapy</source><year>2008</year><volume>10</volume><fpage>R21</fpage><pub-id pub-id-type="pmid">18257935</pub-id><pub-id pub-id-type="doi">10.1186/ar2374</pub-id></citation></ref><ref id="B34"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Fearnhead</surname><given-names>P</given-names></name><name><surname>Donnelly</surname><given-names>P</given-names></name></person-group><article-title>Estimating recombination rates from population genetic data</article-title><source>Genetics</source><year>2001</year><volume>159</volume><fpage>1299</fpage><lpage>1318</lpage><pub-id pub-id-type="pmid">11729171</pub-id></citation></ref><ref id="B35"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>N</given-names></name><name><surname>Stephens</surname><given-names>M</given-names></name></person-group><article-title>Modeling linkage disequilibrium and identifying recombination hotspots using single-nucleotide polymorphism data</article-title><source>Genetics</source><year>2003</year><volume>165</volume><fpage>2213</fpage><lpage>2233</lpage><pub-id pub-id-type="pmid">14704198</pub-id></citation></ref><ref id="B36"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Rabiner</surname><given-names>LR</given-names></name></person-group><article-title>A tutorial on hidden Markov models and selected applications in speech recognition</article-title><source>Proceedings of the IEEE</source><year>1989</year><volume>77</volume><fpage>257</fpage><lpage>286</lpage><pub-id pub-id-type="doi">10.1109/5.18626</pub-id></citation></ref><ref id="B37"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Horan</surname><given-names>M</given-names></name><name><surname>Millar</surname><given-names>DS</given-names></name><name><surname>Hedderich</surname><given-names>J</given-names></name><name><surname>Lewis</surname><given-names>G</given-names></name><name><surname>Newsway</surname><given-names>V</given-names></name><name><surname>Mo</surname><given-names>N</given-names></name><name><surname>Fryklund</surname><given-names>L</given-names></name><name><surname>Procter</surname><given-names>AM</given-names></name><name><surname>Krawczak</surname><given-names>M</given-names></name><name><surname>Cooper</surname><given-names>DN</given-names></name></person-group><article-title>Human growth hormone 1 (GH1) gene expression: complex haplotype-dependent influence of polymorphic variation in the proximal promoter and locus control region</article-title><source>Human mutation</source><year>2003</year><volume>21</volume><fpage>408</fpage><lpage>423</lpage><pub-id pub-id-type="pmid">12655556</pub-id><pub-id pub-id-type="doi">10.1002/humu.10167</pub-id></citation></ref><ref id="B38"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Orzack</surname><given-names>SH</given-names></name><name><surname>Gusfield</surname><given-names>D</given-names></name><name><surname>Olson</surname><given-names>J</given-names></name><name><surname>Nesbitt</surname><given-names>S</given-names></name><name><surname>Subrahmanyan</surname><given-names>L</given-names></name><name><surname>Stanton</surname><given-names>VP</given-names><suffix>Jr</suffix></name></person-group><article-title>Analysis and exploration of the use of rule-based algorithms and consensus methods for the inferral of haplotypes</article-title><source>Genetics</source><year>2003</year><volume>165</volume><fpage>915</fpage><lpage>928</lpage><pub-id pub-id-type="pmid">14573498</pub-id></citation></ref><ref id="B39"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Barrett</surname><given-names>JC</given-names></name><name><surname>Fry</surname><given-names>B</given-names></name><name><surname>Maller</surname><given-names>J</given-names></name><name><surname>Daly</surname><given-names>MJ</given-names></name></person-group><article-title>Haploview: analysis and visualization of LD and haplotype maps</article-title><source>Bioinformatics (Oxford, England)</source><year>2005</year><volume>21</volume><fpage>263</fpage><lpage>265</lpage><pub-id pub-id-type="pmid">15297300</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/bth457</pub-id></citation></ref><ref id="B40"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hendel</surname><given-names>H</given-names></name><name><surname>Caillat-Zucman</surname><given-names>S</given-names></name><name><surname>Lebuanec</surname><given-names>H</given-names></name><name><surname>Carrington</surname><given-names>M</given-names></name><name><surname>O'Brien</surname><given-names>S</given-names></name><name><surname>Andrieu</surname><given-names>JM</given-names></name><name><surname>Schachter</surname><given-names>F</given-names></name><name><surname>Zagury</surname><given-names>D</given-names></name><name><surname>Rappaport</surname><given-names>J</given-names></name><name><surname>Winkler</surname><given-names>C</given-names></name><etal></etal></person-group><article-title>New class I and II HLA alleles strongly associated with opposite patterns of progression to AIDS</article-title><source>J Immunol</source><year>1999</year><volume>162</volume><fpage>6942</fpage><lpage>6946</lpage><pub-id pub-id-type="pmid">10352317</pub-id></citation></ref><ref id="B41"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Rappaport</surname><given-names>J</given-names></name><name><surname>Cho</surname><given-names>YY</given-names></name><name><surname>Hendel</surname><given-names>H</given-names></name><name><surname>Schwartz</surname><given-names>EJ</given-names></name><name><surname>Schachter</surname><given-names>F</given-names></name><name><surname>Zagury</surname><given-names>JF</given-names></name></person-group><article-title>32 bp CCR-5 gene deletion and resistance to fast progression in HIV-1 infected heterozygotes</article-title><source>Lancet</source><year>1997</year><volume>349</volume><fpage>922</fpage><lpage>923</lpage><pub-id pub-id-type="pmid">9093257</pub-id><pub-id pub-id-type="doi">10.1016/S0140-6736(05)62697-9</pub-id></citation></ref><ref id="B42"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Vasilescu</surname><given-names>A</given-names></name><name><surname>Heath</surname><given-names>SC</given-names></name><name><surname>Ivanova</surname><given-names>R</given-names></name><name><surname>Hendel</surname><given-names>H</given-names></name><name><surname>Do</surname><given-names>H</given-names></name><name><surname>Mazoyer</surname><given-names>A</given-names></name><name><surname>Khadivpour</surname><given-names>E</given-names></name><name><surname>Goutalier</surname><given-names>FX</given-names></name><name><surname>Khalili</surname><given-names>K</given-names></name><name><surname>Rappaport</surname><given-names>J</given-names></name><etal></etal></person-group><article-title>Genomic analysis of Th1-Th2 cytokine genes in an AIDS cohort: identification of IL4 and IL10 haplotypes associated with the disease progression</article-title><source>Genes and immunity</source><year>2003</year><volume>4</volume><fpage>441</fpage><lpage>449</lpage><pub-id pub-id-type="pmid">12944981</pub-id><pub-id pub-id-type="doi">10.1038/sj.gene.6363983</pub-id></citation></ref><ref id="B43"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Winkler</surname><given-names>CA</given-names></name><name><surname>Hendel</surname><given-names>H</given-names></name><name><surname>Carrington</surname><given-names>M</given-names></name><name><surname>Smith</surname><given-names>MW</given-names></name><name><surname>Nelson</surname><given-names>GW</given-names></name><name><surname>O'Brien</surname><given-names>SJ</given-names></name><name><surname>Phair</surname><given-names>J</given-names></name><name><surname>Vlahov</surname><given-names>D</given-names></name><name><surname>Jacobson</surname><given-names>LP</given-names></name><name><surname>Rappaport</surname><given-names>J</given-names></name><etal></etal></person-group><article-title>Dominant effects of CCR2-CCR5 haplotypes in HIV-1 disease progression</article-title><source>Journal of acquired immune deficiency syndromes (1999)</source><year>2004</year><volume>37</volume><fpage>1534</fpage><lpage>1538</lpage><pub-id pub-id-type="pmid">15602133</pub-id><pub-id pub-id-type="doi">10.1097/01.qai.0000127353.01578.63</pub-id></citation></ref></ref-list></back></article>