<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd"><article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article" xml:lang="EN"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id><journal-id journal-id-type="publisher-id">bioinformatics</journal-id><journal-id journal-id-type="hwp">bioinfo</journal-id><journal-title>Bioinformatics</journal-title><issn pub-type="ppub">1367-4803</issn><issn pub-type="epub">1460-2059</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">19043077</article-id><article-id pub-id-type="pmc">2639008</article-id><article-id pub-id-type="doi">10.1093/bioinformatics/btn616</article-id><article-id pub-id-type="publisher-id">btn616</article-id><article-categories><subj-group subj-group-type="heading"><subject>Applications Note</subject><subj-group><subject>Genome Analysis</subject></subj-group></subj-group></article-categories><title-group><article-title>Programs for calculating the statistical powers of detecting susceptibility genes in case&#x02013;control studies based on multistage designs</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Kitamura</surname><given-names>Nobutaka</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref><xref ref-type="corresp" rid="COR1">*</xref></contrib><contrib contrib-type="author"><name><surname>Akazawa</surname><given-names>Kouhei</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Miyashita</surname><given-names>Akinori</given-names></name><xref ref-type="aff" rid="AFF1"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Kuwano</surname><given-names>Ryozo</given-names></name><xref ref-type="aff" rid="AFF1"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Toyabe</surname><given-names>Shin-ichi</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Nakamura</surname><given-names>Junichiro</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Nakamura</surname><given-names>Norihito</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Sato</surname><given-names>Tatsuhiko</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Hoque</surname><given-names>M. Aminul</given-names></name><xref ref-type="aff" rid="AFF1"><sup>3</sup></xref></contrib></contrib-group><aff id="AFF1"><sup>1</sup>Department of Medical Informatics, Niigata University Medical and Dental Hospital, Niigata 951-8520, <sup>2</sup>Genome Science Branch, Center of Bioresource-Based Researches, Brain Research Institute, Niigata University, Niigata 951-8585, Japan and <sup>3</sup>Department of Statistics, University of Rajshahi, Rajshahi-6205, Bangladesh</aff><author-notes><corresp id="COR1">*To whom correspondence should be addressed.</corresp><fn><p>Associate Editor: Alfonso Valencia</p></fn></author-notes><pub-date pub-type="ppub"><day>15</day><month>1</month><year>2009</year></pub-date><pub-date pub-type="epub"><day>28</day><month>11</month><year>2008</year></pub-date><pub-date pub-type="pmc-release"><day>28</day><month>11</month><year>2008</year></pub-date><volume>25</volume><issue>2</issue><fpage>272</fpage><lpage>273</lpage><history><date date-type="received"><day>5</day><month>6</month><year>2008</year></date><date date-type="rev-recd"><day>14</day><month>11</month><year>2008</year></date><date date-type="accepted"><day>24</day><month>11</month><year>2008</year></date></history><permissions><copyright-statement>&#x000a9; 2008 The Author(s)</copyright-statement><copyright-year>2008</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/"><p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">http://creativecommons.org/licenses/by-nc/2.0/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</p></license></permissions><abstract><p><bold>Motivation:</bold> A two-stage association study is the most commonly used method among multistage designs to efficiently identify disease susceptibility genes. Recently, some SNP studies have utilized more than two stages to detect disease genes. However, there are few available programs for calculating statistical powers and positive predictive values (PPVs) of arbitrary <italic>n</italic>-stage designs.</p><p><bold>Results:</bold> We developed programs for a multistage case&#x02013;control association study using R language. In our programs, input parameters include numbers of samples and candidate loci, genome-wide false positive rate and proportions of samples and loci to be selected at the <italic>k</italic>-th stage (<italic>k</italic>=1,&#x02026;, <italic>n</italic>). The programs output statistical powers, PPVs and numbers of typings in arbitrary <italic>n</italic>-stage designs. The programs can contribute to prior simulations under various conditions in planning a genome-wide association study.</p><p><bold>Availability:</bold> The R programs are freely available for academic users and can be downloaded from <ext-link ext-link-type="uri" xlink:href="http://www.med.niigata-u.ac.jp/eng/resources/informatics/gwa.html">http://www.med.niigata-u.ac.jp/eng/resources/informatics/gwa.html</ext-link></p><p><bold>Contact:</bold> <email>nktmr@m12.alpha-net.ne.jp</email></p><p><bold>Supplementary information:</bold> <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn616/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p></abstract></article-meta></front><body><sec sec-type="intro" id="SEC1"><title>1 INTRODUCTION</title><p>Genome-wide association (GWA) case&#x02013;control studies using genetic polymorphism data, including data on single nucleotide polymorphisms (SNPs) and microsatellite markers, aim to identify genes involved in common human diseases. Some multistage GWA case&#x02013;control studies have been proposed as powerful and cost-effective study designs. The most commonly used method among the multistage designs is a two-stage design. In the designs, all markers in the first stage are genotyped and statistical tests are conducted for each marker. Only significant markers selected in the first stage remain for the following stages. At the end of the last stage, the overall evidence for association is evaluated by replication-based analysis (RBA)(Satagopan <italic>et al</italic>., <xref ref-type="bibr" rid="B5">2002</xref>) or joint analysis (JA) (Skol <italic>et al</italic>., <xref ref-type="bibr" rid="B6">2006</xref>).</p><p>Recently, some SNP-based studies have utilized more than two stages of multistage designs (Kathiresan et al., <xref ref-type="bibr" rid="B3">2007</xref>; Prentice et al., <xref ref-type="bibr" rid="B4">2006</xref>). However, there are few available programs for multistage designs. Skol <italic>et al</italic>. (<xref ref-type="bibr" rid="B6">2006</xref>) proposed JA by new statistics of a linear combination weighted by the square root of the proportion of subjects and presented their power calculation for one- and two-stage designs on their website, but they have not reported about more than two stages. In previous studies, statistical power was used to evaluate the performance of different designs. On the other hand, positive predictive values (PPVs) are more practical for identifying disease susceptibility genes implicated in complex traits. However, there is no program for statistical powers, PPVs and numbers of typings of multistage designs for arbitrary <italic>n</italic> &#x0003e;2.</p><p>In this article, we present programs for calculating the indicators of arbitrary <italic>n</italic>-stage designs using disease model parameters (prevalence, disease-associated allele frequency and genetic relative risk) or 2&#x000d7;3 contingency table data as input parameters by R language (Crawley, <xref ref-type="bibr" rid="B1">2005</xref>). The programs can output the indicators for allelic models, additive models, dominant models and recessive models under various conditions.</p></sec><sec sec-type="methods" id="SEC2"><title>2 METHODS</title><sec id="SEC2.1"><title>2.1 Statistical background for detecting risk SNPs</title><p>We extended Skol's power-evaluation methods of two-stage designs Skol <italic>et al</italic>. (<xref ref-type="bibr" rid="B6">2006</xref> to generalized <italic>n</italic>-multistage designs (<italic>n</italic> being an arbitrary natural number). Let &#x003c0;<sub><italic>s,k</italic></sub> be a proportion of the sample size at the <italic>k</italic>-th stage and let &#x003c0;<sub><italic>m,k</italic></sub> be a proportion of loci to be selected at the <italic>k</italic>-th stage (<italic>k</italic>=1,&#x02026;, <italic>n</italic>). In RBA, statistical tests are conducted by statistics for difference in ratio of an expected disease-associated allele rate in cases (<italic>p&#x02032;</italic>) and that in controls (<italic>p</italic>). Critical values for the <italic>k</italic>-th stage of RBA (<italic>C<sub>m,k</sub></italic>) can be obtained by calculating &#x003a6;<sup>&#x02212;1</sup> [1&#x02212; &#x003c0; <sub><italic>m,k</italic></sub> /2] under the null hypothesis, and powers of <italic>k</italic>-stage designs of RBA are calculated by multiplying cumulative distribution functions of a normal distribution of each stage under the alternative hypothesis.</p><p>Test statistics of JA are represented as the <inline-formula><inline-graphic xlink:href="btn616i1.jpg"/></inline-formula>weighted sum of statistics of each stage. Since the statistics of JA and those of previous stages are not independent from those definitions, critical values of JA (<italic>C<sub>j,k</sub></italic>) can be calculated iteratively by solving the equation of <italic>n</italic>-multiple integrals under the null hypothesis using the Newton&#x02013;Raphson method. Powers of JA can be calculated with <italic>C<sub>j,k</sub></italic> under the alternative hypothesis.</p><p>PPVs can be calculated by the number of true positive loci (<italic>tp<sub>k</sub></italic>) and false positive loci (<italic>fp<sub>k</sub></italic>). Let <italic>N</italic> be the number of samples in cases and controls, <italic>M</italic> be the number of candidate loci and <italic>m</italic> be the number of true loci. <italic>tp<sub>k</sub></italic> is given as<italic>m</italic>&#x000d7; power of RBA or JA, and <italic>fp<sub>k</sub></italic> is given as(<italic>M&#x02212;m</italic>)&#x000d7;&#x003a0;<sup><italic>n</italic></sup><sub><italic>k=1</italic></sub> &#x003c0;<sub><italic>m,k</italic></sub>.</p><p>Therefore, PPV at the <italic>k</italic>-th stage is calculated as <italic>tp<sub>k</sub></italic>/(<italic>tp<sub>k</sub></italic>+<italic>fp<sub>k</sub></italic>).</p><p>The number of typings of one-stage design is given as 2<italic>MN</italic>.</p><p>The number of typings of <italic>n</italic>-stage design is<disp-formula><graphic xlink:href="btn616um1.jpg" position="float"/></disp-formula></p></sec><sec id="SEC2.2"><title>2.2 Algorithm and programs for multistage designs</title><p>The algorithm for the powers and PPVs and numbers of typings of multistage designs consists of the following three modules: a module for internal parameters, a module for RBA and a module for JA.</p><p>Let a candidate locus be a base pair of allele <italic>A</italic> and allele <italic>a</italic> and let a penetrance of <italic>aa</italic> be <italic>f</italic><sub>0</sub>. The relative risk to <italic>f</italic><sub>0</sub> in a human population of <italic>Aa</italic> and that of <italic>AA</italic> will be <italic>f</italic><sub>1</sub>/<italic>f</italic><sub>0</sub> and <italic>f</italic><sub>2</sub>/<italic>f</italic><sub>0</sub> respectively. By using disease model parameters, such as prevalence (Prev) and disease-associated allele rate (<italic>p</italic><sub>po</sub>) as input parameters, <italic>f</italic><sub>0</sub>, <italic>f</italic><sub>1</sub> and <italic>f</italic><sub>2</sub> in the allelic model, in which the numbers of each allele per cases and controls are counted, is calculated as follows:<disp-formula><graphic xlink:href="btn616um2.jpg" position="float"/></disp-formula>Therefore, <italic>p&#x02032;</italic> and <italic>p</italic> are calculated as follows:<disp-formula><graphic xlink:href="btn616um3.jpg" position="float"/></disp-formula></p><p>In additive models, dominant models and recessive models, those genotype rates in cases and controls are calculated according to each definition (refer to <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn616/DC1">Supplementary Material</ext-link>).</p><p>The programs for calculating the indicators were made by using R language (version 2.7.1). In the program, calculation of the equation of <italic>n</italic>-multiple integrals uses the &#x02018;pmvnorm&#x02019; function. This function computes the distribution function of the multivariate normal distribution for arbitrary limits and correlation matrices based on algorithms by Genz (<xref ref-type="bibr" rid="B2">1992</xref>). We prepared the R package and the web user interface (WUI) for calculating them in our website (see Availability).</p></sec><sec id="SEC2.3"><title>2.3 Simulation algorithm</title><p>Assume the following conditions for calculating the powers and PPVs and the numbers of typings in one- to five-stage designs:<italic>N</italic>=1000, <italic>M</italic>=500 000, <italic>m</italic>=5, genome-wide false positive rate (<italic>&#x003b1;</italic><sub><italic>genome</italic></sub>)=0.05 and odds ratio (OR)=1.5, which is calculated by Prev=0.1, disease-associated allele frequency = 0.4 and GRR=1.44, and the genetic model is set to be an allelic model. The samples were equally divided into each stage. In addition, &#x003c0;<sub><italic>m,k</italic></sub> are set to equal proportions to adjust the product of them to 0.0001 so that the number of remaining loci in the final stage by each stage design is equal.</p></sec></sec><sec sec-type="results" id="SEC3"><title>3 RESULTS</title><p><xref ref-type="fig" rid="F1">Figure 1</xref> shows the powers and PPVs and the numbers of typings of RBA and JA in one- to five-stage designs. The powers of JA were always higher than those of RBA. In RBA, with an increase in the number of stages, the numbers of typings and the powers monotonically decreased. However, in JA, the powers decreased more slowly than in RBA. The powers of the three-stage design were higher than the powers of two-, four- and five-stage designs. On the other hand, PPVs of RBA and those of JA both exhibited plateau behaviors in a high range of PPVs.<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>Powers and PPVs and numbers of typings by RBA and JA in one- to five-stage designs.</p></caption><graphic xlink:href="btn616f1"/></fig></p></sec><sec sec-type="discussion" id="SEC4"><title>4 DISCUSSION</title><p>Multistage case&#x02013;control association designs have the distinct advantage of considerable reduction in the number of typings, while maintaining high powers for many practical projects to detect disease-related genes.</p><p>We made programs for multistage designs by an arbitrary number of stages by using package R language. In this study, the properties of multistage designs of RBA and JA were investigated by comparisons of one- to five-stage designs, and it was shown that the powers by JA are larger than those by RBA in any number of stages and that three-stage designs are superior to two-, four- and five-stage designs in powers under the condition that the samples are equally divided into each stage (refer to <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn616/DC1">Supplementary Material</ext-link>).</p><p>Factors affecting powers include <italic>N</italic>, <italic>M</italic>, &#x003c0;<sub><italic>s,k</italic></sub>,&#x003c0;<sub><italic>m,k</italic></sub> and study designs. However, there is no simple way to predict the powers by various study designs. Therefore, our programs would be beneficial in study communities at the planning stage of GWA studies.</p><p><italic>Funding</italic>: This research was supported by grants-in-aid for scientific research [Based research (B)] by the Japanese Ministry of Education, Culture, Sports, Science and Technology.</p><p><italic>Conflict of Interest</italic>: none declared.</p></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material id="PMC_1" content-type="local-data"><caption><title>[Supplementary Data]</title></caption><media mimetype="text" mime-subtype="html" xlink:href="btn616_index.html"/><media xlink:role="associated-file" mimetype="application" mime-subtype="msword" xlink:href="btn616_bioinf-2008-0882-File003.doc"/></supplementary-material></sec></body><back><ref-list><title>REFERENCES</title><ref id="B1"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Crawley</surname><given-names>MJ</given-names></name></person-group><article-title>Statistics</article-title><source>An Introduction Using R.</source><year>2005</year><publisher-loc>England</publisher-loc><publisher-name>John Wiley&#x00026;Sons</publisher-name></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Genz</surname><given-names>A</given-names></name></person-group><article-title>Numerical computation of multivariate normal probabilities</article-title><source>J. Comput. Graph. Stat.</source><year>1992</year><volume>1</volume><fpage>141</fpage><lpage>150</lpage></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kathiresan</surname><given-names>S</given-names></name><etal/></person-group><article-title>A genome-wide association study for blood lipid phenotypes in the Framingham Heart Study</article-title><source>BMC Med. Genet.</source><year>2007</year><volume>8</volume><comment><ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2350/8/S1/S17">http://www.biomedcentral.com/1471-2350/8/S1/S17</ext-link> (last accessed on December 7, 2008)</comment></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Prentice</surname><given-names>RL</given-names></name><name><surname>Lihong</surname><given-names>Qi</given-names></name></person-group><article-title>Aspects of the design and analysis of high-dimensional SNP studies for disease risk estimation</article-title><source>Biostatistics</source><year>2006</year><volume>7</volume><fpage>339</fpage><lpage>654</lpage><pub-id pub-id-type="pmid">16443924</pub-id></citation></ref><ref id="B5"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Satagopan</surname><given-names>JM</given-names></name><etal/></person-group><article-title>Two-stage designs for gene-disease association studies</article-title><source>Biometrics</source><year>2002</year><volume>58</volume><fpage>163</fpage><lpage>170</lpage><pub-id pub-id-type="pmid">11890312</pub-id></citation></ref><ref id="B6"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Skol</surname><given-names>AD</given-names></name><etal/></person-group><article-title>Joint analysis is more efficient than replication-based analysis for two-stage genome-wide association studies</article-title><source>Nat. Genet.</source><year>2006</year><volume>38</volume><fpage>209</fpage><lpage>213</lpage><pub-id pub-id-type="pmid">16415888</pub-id></citation></ref></ref-list></back></article>