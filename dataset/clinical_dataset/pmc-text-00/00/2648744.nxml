<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd"><article xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id><journal-title>BMC Bioinformatics</journal-title><issn pub-type="epub">1471-2105</issn><publisher><publisher-name>BioMed Central</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">19208139</article-id><article-id pub-id-type="pmc">2648744</article-id><article-id pub-id-type="publisher-id">1471-2105-10-S1-S38</article-id><article-id pub-id-type="doi">10.1186/1471-2105-10-S1-S38</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research</subject></subj-group></article-categories><title-group><article-title>Prediction of RNA secondary structure with pseudoknots using integer programming</article-title></title-group><contrib-group><contrib id="A1" contrib-type="author"><name><surname>Poolsap</surname><given-names>Unyanee</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>unyanee@kuicr.kyoto-u.ac.jp</email></contrib><contrib id="A2" corresp="yes" contrib-type="author"><name><surname>Kato</surname><given-names>Yuki</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>ykato@kuicr.kyoto-u.ac.jp</email></contrib><contrib id="A3" contrib-type="author"><name><surname>Akutsu</surname><given-names>Tatsuya</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>takutsu@kuicr.kyoto-u.ac.jp</email></contrib></contrib-group><aff id="I1"><label>1</label>Bioinformatics Center, Institute for Chemical Research, Kyoto University, Gokasho, Uji, Kyoto 611-0011, Japan</aff><pub-date pub-type="collection"><year>2009</year></pub-date><pub-date pub-type="epub"><day>30</day><month>1</month><year>2009</year></pub-date><volume>10</volume><issue>Suppl 1</issue><supplement><named-content content-type="supplement-title">Selected papers from the Seventh Asia-Pacific Bioinformatics Conference (APBC 2009)</named-content><named-content content-type="supplement-editor">Michael Q Zhang, Michael S Waterman and Xuegong Zhang</named-content></supplement><fpage>S38</fpage><lpage>S38</lpage><ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/10/S1/S38"/><permissions><copyright-statement>Copyright &#x000a9; 2009 Poolsap et al; licensee BioMed Central Ltd.</copyright-statement><copyright-year>2009</copyright-year><copyright-holder>Poolsap et al; licensee BioMed Central Ltd.</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0"><p>This is an open access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p><!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>               Poolsap               Unyanee                              unyanee@kuicr.kyoto-u.ac.jp            </dc:author><dc:title>            Prediction of RNA secondary structure with pseudoknots using integer programming         </dc:title><dc:date>2009</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 10(Suppl 1): S38-. (2009)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2009)10:Suppl 1&#x0003c;S38&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>--></license></permissions><abstract><sec><title>Background</title><p>RNA secondary structure prediction is one major task in bioinformatics, and various computational methods have been proposed so far. Pseudoknot is one of the typical substructures appearing in several RNAs, and plays an important role in some biological processes. Prediction of RNA secondary structure with pseudoknots is still challenging since the problem is NP-hard when arbitrary pseudoknots are taken into consideration.</p></sec><sec><title>Results</title><p>We introduce a new method of predicting RNA secondary structure with pseudoknots based on integer programming. In our formulation, we aim at minimizing the value of the objective function that reflects free energy of a folding structure of an input RNA sequence. We focus on a practical class of pseudoknots by setting constraints appropriately. Experimental results for a set of real RNA sequences show that our proposed method outperforms several existing methods in sensitivity. Furthermore, for a set of sequences of small length, our approach achieved good performance in both sensitivity and specificity.</p></sec><sec><title>Conclusion</title><p>Our integer programming-based approach for RNA structure prediction is flexible and extensible.</p></sec></abstract><conference><conf-date>13&#x02013;16 January 2009</conf-date><conf-name>The Seventh Asia Pacific Bioinformatics Conference (APBC 2009)</conf-name><conf-loc>Beijing, China</conf-loc></conference></article-meta></front><body><sec><title>Background</title><p>Functional noncoding RNAs (ncRNAs) have been recognized as regulatory or catalytic molecules, and have received much attention in recent years. It is known that ncRNA genes cover a fair proportion of the whole genome in higher organisms including humans [<xref ref-type="bibr" rid="B1">1</xref>], and studying functional ncRNAs is an important task to understand complex mechanism of higher organisms. Structure analysis of ncRNAs will help us elucidate their functions since it is widely recognized that there is correlation between structure and function. Due to difficulty in determining RNA 3D structure (tertiary structure) by experimental techniques, many attempts have so far been made at predicting <italic>secondary structure</italic> given an RNA sequence (primary structure). A secondary structure is defined as a set of hydrogen-bonding base pairs such as Watson-Crick complementary pairs (i.e., A-U and C-G). One of the fundamental secondary structures is shown in Figure <xref ref-type="fig" rid="F1">1(a)</xref>, which is called a hairpin loop or stem loop. Another diagrammatic representation is arc depiction where base pairs are connected by arcs over the RNA sequence (see Figure <xref ref-type="fig" rid="F1">1(b)</xref>). Among several RNAs, including rRNAs, tmRNAs and viral RNAs, there are substructures called <italic>pseudoknots </italic>(Figure <xref ref-type="fig" rid="F1">1(c)</xref>) where some arcs over the sequence cross in the arc representation as shown in Figure <xref ref-type="fig" rid="F1">1(d)</xref>. Prediction of RNA secondary structure with pseudoknots has increased in importance since pseudoknots have been known to play an important role in a number of RNA functions such as ribosomal frameshifting and splicing. Furthermore, a biologically reliable database called PseudoBase [<xref ref-type="bibr" rid="B2">2</xref>] has been constructed, which contains structural, functional and sequence data on RNA pseudoknots.</p><fig position="float" id="F1"><label>Figure 1</label><caption><p><bold>Example of RNA secondary structure</bold>. (a) Hairpin loop. (b) Arc representation of (a). (c) Pseudoknot. (d) Arc representation of (c).</p></caption><graphic xlink:href="1471-2105-10-S1-S38-1"/></fig><p>Many single-stranded RNAs are considered to fold back on themselves to be thermodynamically stable. This idea has led to the development of several algorithms that minimize the equilibrium free energy of RNA. In the pioneering work, we refer to the Zuker's algorithm [<xref ref-type="bibr" rid="B3">3</xref>] that predicts secondary structure with the lowest free energy by using a dynamic programming (DP) technique, and its implementation named Mfold [<xref ref-type="bibr" rid="B4">4</xref>] is one of the major softwares for RNA secondary structure prediction. The time complexity of the Zuker's algorithm is <italic>O</italic>(<italic>n</italic><sup>3</sup>) where <italic>n </italic>is the length of an input RNA sequence. However, this algorithm cannot deal with pseudoknots. To predict pseudoknotted structure, several DP algorithms that minimize free energy in the range from <italic>O</italic>(<italic>n</italic><sup>4</sup>) to <italic>O</italic>(<italic>n</italic><sup>6</sup>) time were proposed including PKNOTS [<xref ref-type="bibr" rid="B5">5</xref>], pknotsRG [<xref ref-type="bibr" rid="B6">6</xref>] and iterated loop matching (ILM) [<xref ref-type="bibr" rid="B7">7</xref>]. These algorithms focus on some restricted pseudoknots for solvability in polynomial time since prediction of arbitrary pseudoknotted structure was proven to be NP-hard [<xref ref-type="bibr" rid="B8">8</xref>,<xref ref-type="bibr" rid="B9">9</xref>]. </p><p>There have also been several grammatical approaches to modeling some kinds of pseudoknots, including use of tree adjoining grammar [<xref ref-type="bibr" rid="B10">10</xref>,<xref ref-type="bibr" rid="B11">11</xref>], crossed-interaction grammar [<xref ref-type="bibr" rid="B12">12</xref>], parallel communicating grammar [<xref ref-type="bibr" rid="B13">13</xref>] and multiple context-free grammar [<xref ref-type="bibr" rid="B14">14</xref>]. In these grammatical approaches, secondary structure prediction can be interpreted as parsing of the grammars, which can be addressed in <italic>O</italic>(<italic>n</italic><sup>4</sup>) to <italic>O</italic>(<italic>n</italic><sup>6</sup>) time. Although performance of these grammar-based methods is comparable to that of energy-based methods, grammatical approaches have the advantage of the capability of constructing profile (or modeling consensus structure) when multiple structural alignment is given in advance.</p><p>The sequence alignment information is also useful for RNA secondary structure prediction. Sankoff [<xref ref-type="bibr" rid="B15">15</xref>] proposed a DP algorithm that can simultaneously solve the sequence alignment and folding problems for multiple sequences. Later, Sankoff's algorithm was improved by Mathews and Turner [<xref ref-type="bibr" rid="B16">16</xref>], where their proposed algorithm is called Dynalign. Dynalign combines free energy minimization and comparative sequence analysis to find a low free energy structure common to two sequences without requiring any sequence identity.</p><p>Recently, Parisien and Major [<xref ref-type="bibr" rid="B17">17</xref>] presented a new analysis of RNA secondary structure prediction by incorporating all base pairs including noncanonical ones. They introduced a new representation of the nucleotide relationships in structural RNAs, called the nucleotide cyclic motif (NCM). NCM is incorporated into the scoring function of a folding algorithm, which is also based on DP.</p><p>Returning to the viewpoint of energy minimization, RNA secondary structure prediction can be regarded as a kind of optimization problem. In fact, several problems in bioinformatics can be formulated as combinatorial optimization problems. One of the successful applications is RAPTOR [<xref ref-type="bibr" rid="B18">18</xref>], which calculates protein threading using an <italic>integer programming </italic>(IP) formulation. Although IP problems are known to be NP-hard, descriptive power of IP is strong and flexible. In addition, recent commercial optimization softwares can deal with relatively large-scale instances even if a problem is computationally hard to solve. </p><p>In this paper, we present a new method of predicting RNA secondary structure with pseudoknots based on IP. In our model, thermodynamic information is incorporated into the objective function whose value is to be minimized, and structural information is represented by constraints. It should be noted that we focus on a practical class of pseudoknots by setting constraints appropriately. We use the CPLEX software [<xref ref-type="bibr" rid="B19">19</xref>] to solve the IP problem and evaluate our method on a set of RNA sequences contained in PseudoBase [<xref ref-type="bibr" rid="B2">2</xref>] and Rfam [<xref ref-type="bibr" rid="B20">20</xref>]. Advantages of our proposed method are summarized as follows:</p><p>&#x02022; Our prediction method using IP is flexible. Specifically, various types of secondary structures can be handled by adding or removing constraints. In fact, we can describe pseudoknot-free structures as well as generalized planar pseudoknots (see [<xref ref-type="bibr" rid="B8">8</xref>] for definition) by IP formulations, and in this paper we provide a modeling of a certain type of <italic>recursive </italic>pseudoknot (see Methods).</p><p>&#x02022; The IP-based method outperforms three existing methods PKNOTS, pknotsRG and ILM in sensitivity for 34 RNA sequences known to have pseudoknots. In particular, for a set of sequences of small length (&#x02264; 46), our approach achieved good performance in both sensitivity and specificity.</p><p>&#x02022; Once we can model the prediction problem by an IP formulation, we need not develop any algorithm from scratch because high-performance solvers for IP are now available. Thus, we can focus on how to describe the topology of structure and how to assign appropriate scores to the model.</p><p>&#x02022; The IP-based approach is extensible. If we have incomplete data on secondary structure where parts of the structure (i.e., a set of base pairs) have been determined by experiment, we can complement the incomplete structure by modeling the known parts of the structure as constraints and solving the IP problem.</p></sec><sec sec-type="methods"><title>Methods</title><sec><title>Definitions of RNA secondary structure and pseudoknot</title><p>In this section we will describe the preliminary definitions of RNA secondary structure including pseudoknots.</p><p><bold>Definition 1 </bold>(RNA secondary structure). An RNA sequence is represented by a string of <italic>n </italic>characters <italic>s </italic>= <italic>s</italic><sub>1</sub><italic>s</italic><sub>2 </sub>&#x022ef; s<sub><italic>n </italic></sub>where <italic>s</italic><sub><italic>i </italic></sub>&#x02208; {<italic>A</italic>, <italic>C</italic>, <italic>G</italic>, <italic>U</italic>}. A <italic>secondary structure </italic>of the sequence <italic>s </italic>is defined as a set <italic>S </italic>of base pairs (<italic>s</italic><sub><italic>i</italic></sub>, <italic>s</italic><sub><italic>j</italic></sub>) such that the following conditions are satisfied:</p><p>1. 1 &#x02264; <italic>i </italic>&#x0003c;<italic>j </italic>&#x02264; <italic>n</italic>, meaning, two bases that form a pair must be located at different positions.</p><p>2. <italic>j </italic>- <italic>i </italic>&#x0003e; <italic>t </italic>where <italic>t </italic>is a small positive constant, meaning, the sequence does not fold too sharply on itself.</p><p>3. For all base pairs (<italic>s</italic><sub><italic>i</italic></sub>, <italic>s</italic><sub><italic>j</italic></sub>) and (<italic>s</italic><sub><italic>i</italic></sub>', <italic>s</italic><sub><italic>j</italic></sub>') in <italic>S</italic>, <italic>i </italic>= <italic>i</italic>' if and only if <italic>j </italic>= <italic>j</italic>', meaning, each base can be paired with at most one base.</p><p>Here, we allow only Watson-Crick base pairs (<italic>A</italic>, <italic>U</italic>) and (<italic>C</italic>, <italic>G</italic>), and a wobble base pair (<italic>G</italic>, <italic>U</italic>) to form the secondary structure, which we call <italic>valid </italic>base pairs.</p><p><bold>Definition 2 </bold>(Pseudoknot). An RNA secondary structure <italic>S </italic>is said to contain a <italic>pseudoknot </italic>if and only if there exist (<italic>s</italic><sub><italic>i</italic></sub>, <italic>s</italic><sub><italic>j</italic></sub>), (<italic>s</italic>'<sub><italic>i</italic></sub>, <italic>s</italic>'<sub><italic>j</italic></sub>) &#x02208; <italic>S </italic>(<italic>i </italic>&#x0003c;<italic>i</italic>') such that <italic>i </italic>&#x0003c;<italic>i</italic>' &#x0003c;<italic>j </italic>&#x0003c;<italic>j</italic>'.</p><p><bold>Definition 3 </bold>(Pseudoknot free). An RNA secondary structure <italic>S </italic>is called <italic>pseudoknot free </italic>if and only if for all pairs (<italic>s</italic><sub><italic>i</italic></sub>, <italic>s</italic><sub><italic>j</italic></sub>), (<italic>s</italic><sub><italic>i</italic></sub>', <italic>s</italic><sub><italic>j</italic></sub>') &#x02208; <italic>S </italic>(<italic>i </italic>&#x0003c;<italic>i</italic>'), one of the following conditions is satisfied:</p><p>1. <italic>i </italic>&#x0003c;<italic>j </italic>&#x0003c;<italic>i</italic>' &#x0003c;<italic>j</italic>', i.e., (<italic>s</italic><sub><italic>i</italic></sub>, <italic>s</italic><sub><italic>j</italic></sub>) precedes (<italic>s</italic><sub><italic>i'</italic></sub>, <italic>s</italic><sub><italic>j'</italic></sub>), or</p><p>2. <italic>i </italic>&#x0003c;<italic>i</italic>' &#x0003c;<italic>j</italic>' &#x0003c;<italic>j</italic>, i.e., (<italic>s</italic><sub><italic>i</italic></sub>, <italic>s</italic><sub><italic>j</italic></sub>) includes (<italic>s</italic><sub><italic>i'</italic></sub>, <italic>s</italic><sub><italic>j'</italic></sub>).</p><p>There are various kinds of pseudoknots, depending on how arcs representing base pairs cross above the sequence. For tractability in computational complexity, several classes of pseudoknots were proposed.</p><p><bold>Definition 4 </bold>(Simple pseudoknot [<xref ref-type="bibr" rid="B8">8</xref>]). Let <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" name="1471-2105-10-S1-S38-i1" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&#x022ef;</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> be a consecutive RNA subsequence. A set of base pairs <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2" name="1471-2105-10-S1-S38-i2" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:msup><mml:mi>S</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> is called a <italic>simple pseudoknot </italic>if there exist positions <italic>j</italic><sub>0</sub>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M3" name="1471-2105-10-S1-S38-i3" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:msup><mml:mi>j</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> (<italic>i</italic><sub>0 </sub>&#x0003c;<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M4" name="1471-2105-10-S1-S38-i3" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:msup><mml:mi>j</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> &#x0003c;<italic>j</italic><sub>0 </sub>&#x0003c;<italic>k</italic><sub>0</sub>) satisfying the following conditions (see Figure <xref ref-type="fig" rid="F2">2(a)</xref>):</p><fig position="float" id="F2"><label>Figure 2</label><caption><p><bold>Illustration of pseudoknots</bold>. (a) Simple pseudoknot. (b) Recursive pseudoknot.</p></caption><graphic xlink:href="1471-2105-10-S1-S38-2"/></fig><p>1. Each (<italic>i</italic>, <italic>j</italic>) &#x02208; <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M5" name="1471-2105-10-S1-S38-i4" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:msup><mml:mi>S</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> satisfies either <italic>i</italic><sub>0 </sub>&#x02264; <italic>i </italic>&#x0003c;<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M6" name="1471-2105-10-S1-S38-i3" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:msup><mml:mi>j</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> &#x02264; <italic>j </italic>&#x0003c;<italic>j</italic><sub>0 </sub>or <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M7" name="1471-2105-10-S1-S38-i3" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:msup><mml:mi>j</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> &#x02264; <italic>i </italic>&#x0003c;<italic>j</italic><sub>0 </sub>&#x02264; <italic>j </italic>&#x02264; <italic>k</italic><sub>0</sub>.</p><p>2. There exists (<italic>i</italic>, <italic>j</italic>) &#x02208; <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M8" name="1471-2105-10-S1-S38-i4" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:msup><mml:mi>S</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> satisfying <italic>i</italic><sub>0 </sub>&#x02264; <italic>i </italic>&#x0003c;<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M9" name="1471-2105-10-S1-S38-i3" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:msup><mml:mi>j</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> &#x02264; <italic>j </italic>&#x0003c;<italic>j</italic><sub>0</sub>.</p><p>3. There exists (<italic>i</italic>, <italic>j</italic>) &#x02208; <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M10" name="1471-2105-10-S1-S38-i4" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:msup><mml:mi>S</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> satisfying <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M11" name="1471-2105-10-S1-S38-i3" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:msup><mml:mi>j</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> &#x02264; <italic>i </italic>&#x0003c;<italic>j</italic><sub>0 </sub>&#x02264; <italic>j </italic>&#x02264; <italic>k</italic><sub>0</sub>.</p><p>4. If pairs (<italic>i</italic>, <italic>j</italic>) and (<italic>i</italic>', <italic>j</italic>') in <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M12" name="1471-2105-10-S1-S38-i4" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:msup><mml:mi>S</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> satisfy either <italic>i </italic>&#x0003c;<italic>i</italic>' &#x0003c;<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M13" name="1471-2105-10-S1-S38-i3" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:msup><mml:mi>j</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> or <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M14" name="1471-2105-10-S1-S38-i3" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:msup><mml:mi>j</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> &#x02264; <italic>i </italic>&#x0003c;<italic> i</italic>', then <italic>j </italic>&#x0003e; <italic>j</italic>' holds.</p><p><bold>Definition 5 </bold>(Recursive pseudoknot [<xref ref-type="bibr" rid="B8">8</xref>]). If internal unpaired regions of a simple pseudoknot (e.g., subsequences <italic>u</italic>, <italic>v </italic>and <italic>w </italic>in Figure <xref ref-type="fig" rid="F2">2(a)</xref>) fold into pseudoknot-free structure and/or simple pseudoknot, the structure is called a <italic>recursive pseudoknot </italic>(see Figure <xref ref-type="fig" rid="F2">2(b)</xref>).</p><p>In this paper, we propose an integer programming-based method that can predict a subclass of recursive pseudoknots. It should be noted that our formulation allows unpaired regions of a simple pseudoknot to fold into pseudoknot-free structure only.</p></sec><sec><title>Integer programming-based model</title><sec><title>Definitions of integer programming</title><p>Integer programming (IP) is an extension of linear programming. A linear programming (LP) problem is one of the optimization problems, which optimizes a linear function subject to linear equality and/or inequality constraints. An LP problem is composed of <italic>decision variables </italic>whose values are to be decided in some optimal fashion, an <italic>objective function </italic>to be maximized or minimized, and a set of <italic>constraints</italic>. The constraints consist of linear equalities and/or inequalities with respect to the decision variables. When the decision variables are required to be integer, the problem is called an <italic>integer programming (IP) problem</italic>. In general, an IP problem can be written as follows:</p><p><disp-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M15" name="1471-2105-10-S1-S38-i5" overflow="scroll">                        <mml:semantics>                           <mml:mrow>                              <mml:mtable columnalign="left">                                 <mml:mtr columnalign="left">                                    <mml:mtd columnalign="left">                                       <mml:mrow>                                          <mml:mtext>minimize</mml:mtext>                                       </mml:mrow>                                    </mml:mtd>                                    <mml:mtd columnalign="left">                                       <mml:mrow>                                          <mml:mstyle displaystyle="true">                                             <mml:munderover>                                                <mml:mo>&#x02211;</mml:mo>                                                <mml:mrow>                                                   <mml:mi>j</mml:mi>                                                   <mml:mo>=</mml:mo>                                                   <mml:mn>1</mml:mn>                                                </mml:mrow>                                                <mml:mi>n</mml:mi>                                             </mml:munderover>                                             <mml:mrow>                                                <mml:msub>                                                   <mml:mi>c</mml:mi>                                                   <mml:mi>j</mml:mi>                                                </mml:msub>                                                <mml:msub>                                                   <mml:mi>x</mml:mi>                                                   <mml:mi>j</mml:mi>                                                </mml:msub>                                             </mml:mrow>                                          </mml:mstyle>                                       </mml:mrow>                                    </mml:mtd>                                 </mml:mtr>                                 <mml:mtr columnalign="left">                                    <mml:mtd columnalign="left">                                       <mml:mrow>                                          <mml:mtext>subject&#x000a0;to</mml:mtext>                                       </mml:mrow>                                    </mml:mtd>                                    <mml:mtd columnalign="left">                                       <mml:mrow>                                          <mml:mtable>                                             <mml:mtr>                                                <mml:mtd>                                                   <mml:mrow>                                                      <mml:mstyle displaystyle="true">                                                         <mml:munderover>                                                            <mml:mo>&#x02211;</mml:mo>                                                            <mml:mrow>                                                               <mml:mi>j</mml:mi>                                                               <mml:mo>=</mml:mo>                                                               <mml:mn>1</mml:mn>                                                            </mml:mrow>                                                            <mml:mi>n</mml:mi>                                                         </mml:munderover>                                                         <mml:mrow>                                                            <mml:msub>                                                               <mml:mi>&#x003b1;</mml:mi>                                                               <mml:mrow>                                                                  <mml:mi>i</mml:mi>                                                                  <mml:mi>j</mml:mi>                                                               </mml:mrow>                                                            </mml:msub>                                                            <mml:msub>                                                               <mml:mi>x</mml:mi>                                                               <mml:mi>j</mml:mi>                                                            </mml:msub>                                                            <mml:mo>&#x02264;</mml:mo>                                                            <mml:msub>                                                               <mml:mi>b</mml:mi>                                                               <mml:mi>i</mml:mi>                                                            </mml:msub>                                                         </mml:mrow>                                                      </mml:mstyle>                                                      <mml:mo>,</mml:mo>                                                   </mml:mrow>                                                </mml:mtd>                                                <mml:mtd>                                                   <mml:mrow>                                                      <mml:mi>i</mml:mi>                                                      <mml:mo>=</mml:mo>                                                      <mml:mn>1</mml:mn>                                                      <mml:mo>,</mml:mo>                                                      <mml:mn>2</mml:mn>                                                      <mml:mo>,</mml:mo>                                                      <mml:mn>...</mml:mn>                                                      <mml:mo>,</mml:mo>                                                      <mml:mi>m</mml:mi>                                                   </mml:mrow>                                                </mml:mtd>                                             </mml:mtr>                                          </mml:mtable>                                       </mml:mrow>                                    </mml:mtd>                                 </mml:mtr>                                 <mml:mtr columnalign="left">                                    <mml:mtd columnalign="left">                                       <mml:mrow/>                                    </mml:mtd>                                    <mml:mtd columnalign="left">                                       <mml:mrow>                                          <mml:mtable>                                             <mml:mtr>                                                <mml:mtd>                                                   <mml:mrow>                                                      <mml:msub>                                                         <mml:mi>x</mml:mi>                                                         <mml:mi>j</mml:mi>                                                      </mml:msub>                                                      <mml:mo>&#x02208;</mml:mo>                                                      <mml:msup>                                                         <mml:mi>&#x02124;</mml:mi>                                                         <mml:mo>+</mml:mo>                                                      </mml:msup>                                                      <mml:mo>,</mml:mo>                                                   </mml:mrow>                                                </mml:mtd>                                                <mml:mtd>                                                   <mml:mrow>                                                      <mml:mi>j</mml:mi>                                                      <mml:mo>=</mml:mo>                                                      <mml:mn>1</mml:mn>                                                      <mml:mo>,</mml:mo>                                                      <mml:mn>2</mml:mn>                                                      <mml:mo>,</mml:mo>                                                      <mml:mn>...</mml:mn>                                                      <mml:mo>,</mml:mo>                                                      <mml:mi>n</mml:mi>                                                   </mml:mrow>                                                </mml:mtd>                                             </mml:mtr>                                          </mml:mtable>                                       </mml:mrow>                                    </mml:mtd>                                 </mml:mtr>                              </mml:mtable>                           </mml:mrow>                                                   </mml:semantics>                     </mml:math></disp-formula></p><p>where <italic>a</italic><sub><italic>ij</italic></sub>, <italic>b</italic><sub><italic>i</italic></sub>, <italic>c</italic><sub><italic>j </italic></sub>&#x02208; &#x0211d; (<italic>i </italic>= 1, 2, ..., <italic>m</italic>; <italic>j </italic>= 1, 2, ..., <italic>n</italic>) and <italic>x</italic><sub><italic>j </italic></sub>(<italic>j </italic>= 1, 2, ..., <italic>n</italic>) denotes a decision variable defined over a set of nonnegative integers &#x02124;<sup>+</sup>. Note that the maximization problem is equivalent to the minimization problem where the sign of the objective function is inverted.</p></sec><sec><title>Formulation for RNA pseudoknot prediction</title><p>We will formulate the RNA pseudoknotted structure prediction problem as an IP problem. Specifically, we define the decision variables, the objective function and the linear constraints with respect to the decision variables.</p><p>We first define the following decision variables:</p><p><disp-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M16" name="1471-2105-10-S1-S38-i6" overflow="scroll">                        <mml:semantics>                           <mml:mrow>                              <mml:msub>                                 <mml:mi>x</mml:mi>                                 <mml:mrow>                                    <mml:mi>i</mml:mi>                                    <mml:mi>j</mml:mi>                                 </mml:mrow>                              </mml:msub>                              <mml:mo>,</mml:mo>                              <mml:msub>                                 <mml:mi>y</mml:mi>                                 <mml:mrow>                                    <mml:mi>i</mml:mi>                                    <mml:mi>j</mml:mi>                                 </mml:mrow>                              </mml:msub>                              <mml:mo>=</mml:mo>                              <mml:mrow>                                 <mml:mo>{</mml:mo>                                 <mml:mrow>                                    <mml:mtable columnalign="left">                                       <mml:mtr columnalign="left">                                          <mml:mtd columnalign="left">                                             <mml:mn>1</mml:mn>                                          </mml:mtd>                                          <mml:mtd columnalign="left">                                             <mml:mrow>                                                <mml:mo stretchy="false">(</mml:mo>                                                <mml:mo stretchy="false">(</mml:mo>                                                <mml:msub>                                                   <mml:mi>s</mml:mi>                                                   <mml:mi>i</mml:mi>                                                </mml:msub>                                                <mml:mo>,</mml:mo>                                                <mml:msub>                                                   <mml:mi>s</mml:mi>                                                   <mml:mi>j</mml:mi>                                                </mml:msub>                                                <mml:mo stretchy="false">)</mml:mo>                                                <mml:mtext>&#x000a0;is&#x000a0;a&#x000a0;valid&#x000a0;pair</mml:mtext>                                                <mml:mo stretchy="false">)</mml:mo>                                                <mml:mo>,</mml:mo>                                             </mml:mrow>                                          </mml:mtd>                                       </mml:mtr>                                       <mml:mtr columnalign="left">                                          <mml:mtd columnalign="left">                                             <mml:mn>0</mml:mn>                                          </mml:mtd>                                          <mml:mtd columnalign="left">                                             <mml:mrow>                                                <mml:mo stretchy="false">(</mml:mo>                                                <mml:mtext>otherwise</mml:mtext>                                                <mml:mo stretchy="false">)</mml:mo>                                             </mml:mrow>                                          </mml:mtd>                                       </mml:mtr>                                    </mml:mtable>                                 </mml:mrow>                              </mml:mrow>                           </mml:mrow>                                                   </mml:semantics>                     </mml:math></disp-formula></p><p>for <italic>i</italic>, <italic>j </italic>= 1, 2, ..., <italic>n</italic>. The difference between <italic>x</italic><sub><italic>ij </italic></sub>and <italic>y</italic><sub><italic>ij </italic></sub>is that <italic>x</italic><sub><italic>ij </italic></sub>= 1 corresponds to an arc that connects two bases drawn above the sequence, while <italic>y</italic><sub><italic>ij </italic></sub>= 1 represents an arc drawn below the sequence (see Figure <xref ref-type="fig" rid="F3">3(a)</xref>).</p><fig position="float" id="F3"><label>Figure 3</label><caption><p><bold>Illustration of decision variables</bold>. (a) <italic>x</italic><sub><italic>ij </italic></sub>and <italic>y</italic><sub><italic>i' j'</italic></sub>. (b) <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M17" name="1471-2105-10-S1-S38-i7" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mi>z</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula>.</p></caption><graphic xlink:href="1471-2105-10-S1-S38-3"/></fig><p>In order to incorporate stacking energy into decision variables, we use 6 &#x000d7; 6 (row &#x000d7; column, resp.) energy parameter matrix E = (<italic>e</italic><sub><italic>kl</italic></sub>) (<italic>k</italic>, <italic>l </italic>= 1, 2, ..., 6) shown in Table <xref ref-type="table" rid="T1">1</xref> . This matrix provides stacking energy parameters for RNA folding at 37&#x000b0;C given by Mfold version 3.0 [<xref ref-type="bibr" rid="B4">4</xref>]. Note that the value of <italic>k </italic>denotes the "type" of six valid pairs. For example, <italic>k </italic>= 1 indicates A-U pair and we call it "type 1." This statement also holds for the value of <italic>l</italic>.</p><table-wrap position="float" id="T1"><label>Table 1</label><caption><p>Stacking energy parameter matrix <italic>E </italic>[<xref ref-type="bibr" rid="B4">4</xref>].</p></caption><table frame="hsides" rules="groups"><thead><tr><td></td><td align="center">A-U</td><td align="center">C-G</td><td align="center">G-C</td><td align="center">G-U</td><td align="center">U-G</td><td align="center">U-A</td></tr></thead><tbody><tr><td align="center">A-U</td><td align="center">-1.1</td><td align="center">-2.1</td><td align="center">-2.2</td><td align="center">-1.4</td><td align="center">-0.9</td><td align="center">-0.6</td></tr><tr><td align="center">C-G</td><td align="center">-2.1</td><td align="center">-2.4</td><td align="center">-3.3</td><td align="center">-2.1</td><td align="center">-2.1</td><td align="center">-1.4</td></tr><tr><td align="center">G-C</td><td align="center">-2.2</td><td align="center">-3.3</td><td align="center">-3.4</td><td align="center">-2.5</td><td align="center">-2.4</td><td align="center">-1.5</td></tr><tr><td align="center">G-U</td><td align="center">-1.4</td><td align="center">-2.1</td><td align="center">-2.5</td><td align="center">-1.3</td><td align="center">-1.3</td><td align="center">-0.5</td></tr><tr><td align="center">U-G</td><td align="center">-0.9</td><td align="center">-2.1</td><td align="center">-2.4</td><td align="center">-1.3</td><td align="center">-1.3</td><td align="center">-1.0</td></tr><tr><td align="center">U-A</td><td align="center">-0.6</td><td align="center">-1.4</td><td align="center">-1.5</td><td align="center">-0.5</td><td align="center">-1.0</td><td align="center">-0.3</td></tr></tbody></table></table-wrap><p>We then define variables for representing the stacking pair of (<italic>s</italic><sub><italic>i</italic></sub>, <italic>s</italic><sub><italic>j</italic></sub>) and (<italic>s</italic><sub><italic>i</italic>+1</sub>, <italic>s</italic><sub><italic>j</italic>-1</sub>) as follows:</p><p><disp-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M18" name="1471-2105-10-S1-S38-i8" overflow="scroll">                        <mml:semantics>                           <mml:mrow>                              <mml:mtable>                                 <mml:mtr>                                    <mml:mtd>                                       <mml:mrow>                                          <mml:msubsup>                                             <mml:mi>z</mml:mi>                                             <mml:mrow>                                                <mml:msub>                                                   <mml:mi>x</mml:mi>                                                   <mml:mrow>                                                      <mml:mi>i</mml:mi>                                                      <mml:mi>j</mml:mi>                                                   </mml:mrow>                                                </mml:msub>                                             </mml:mrow>                                             <mml:mrow>                                                <mml:mi>k</mml:mi>                                                <mml:mi>l</mml:mi>                                             </mml:mrow>                                          </mml:msubsup>                                          <mml:mo>=</mml:mo>                                          <mml:mrow>                                             <mml:mo>{</mml:mo>                                             <mml:mrow>                                                <mml:mtable columnalign="left">                                                   <mml:mtr columnalign="left">                                                      <mml:mtd columnalign="left">                                                         <mml:mn>1</mml:mn>                                                      </mml:mtd>                                                      <mml:mtd columnalign="left">                                                         <mml:mrow>                                                            <mml:mo stretchy="false">(</mml:mo>                                                            <mml:msub>                                                               <mml:mi>x</mml:mi>                                                               <mml:mrow>                                                                  <mml:mi>i</mml:mi>                                                                  <mml:mi>j</mml:mi>                                                               </mml:mrow>                                                            </mml:msub>                                                            <mml:mo>=</mml:mo>                                                            <mml:mn>1</mml:mn>                                                            <mml:mtext>&#x000a0;with&#x000a0;type&#x000a0;</mml:mtext>                                                            <mml:mi>k</mml:mi>                                                            <mml:mtext>&#x000a0;and&#x000a0;</mml:mtext>                                                            <mml:msub>                                                               <mml:mi>x</mml:mi>                                                               <mml:mrow>                                                                  <mml:mi>i</mml:mi>                                                                  <mml:mo>+</mml:mo>                                                                  <mml:mn>1</mml:mn>                                                                  <mml:mo>,</mml:mo>                                                                  <mml:mi>j</mml:mi>                                                                  <mml:mo>&#x02212;</mml:mo>                                                                  <mml:mn>1</mml:mn>                                                               </mml:mrow>                                                            </mml:msub>                                                            <mml:mo>=</mml:mo>                                                            <mml:mn>1</mml:mn>                                                            <mml:mtext>&#x000a0;with&#x000a0;type&#x000a0;</mml:mtext>                                                            <mml:mi>l</mml:mi>                                                            <mml:mo stretchy="false">)</mml:mo>                                                            <mml:mo>,</mml:mo>                                                         </mml:mrow>                                                      </mml:mtd>                                                   </mml:mtr>                                                   <mml:mtr columnalign="left">                                                      <mml:mtd columnalign="left">                                                         <mml:mn>0</mml:mn>                                                      </mml:mtd>                                                      <mml:mtd columnalign="left">                                                         <mml:mrow>                                                            <mml:mo stretchy="false">(</mml:mo>                                                            <mml:mtext>otherwise</mml:mtext>                                                            <mml:mo stretchy="false">)</mml:mo>                                                            <mml:mo>,</mml:mo>                                                         </mml:mrow>                                                      </mml:mtd>                                                   </mml:mtr>                                                </mml:mtable>                                             </mml:mrow>                                          </mml:mrow>                                       </mml:mrow>                                    </mml:mtd>                                 </mml:mtr>                                 <mml:mtr>                                    <mml:mtd>                                       <mml:mrow>                                          <mml:msubsup>                                             <mml:mi>z</mml:mi>                                             <mml:mrow>                                                <mml:msub>                                                   <mml:mi>y</mml:mi>                                                   <mml:mrow>                                                      <mml:mi>i</mml:mi>                                                      <mml:mi>j</mml:mi>                                                   </mml:mrow>                                                </mml:msub>                                             </mml:mrow>                                             <mml:mrow>                                                <mml:mi>k</mml:mi>                                                <mml:mi>l</mml:mi>                                             </mml:mrow>                                          </mml:msubsup>                                          <mml:mo>=</mml:mo>                                          <mml:mrow>                                             <mml:mo>{</mml:mo>                                             <mml:mrow>                                                <mml:mtable columnalign="left">                                                   <mml:mtr columnalign="left">                                                      <mml:mtd columnalign="left">                                                         <mml:mn>1</mml:mn>                                                      </mml:mtd>                                                      <mml:mtd columnalign="left">                                                         <mml:mrow>                                                            <mml:mo stretchy="false">(</mml:mo>                                                            <mml:msub>                                                               <mml:mi>y</mml:mi>                                                               <mml:mrow>                                                                  <mml:mi>i</mml:mi>                                                                  <mml:mi>j</mml:mi>                                                               </mml:mrow>                                                            </mml:msub>                                                            <mml:mo>=</mml:mo>                                                            <mml:mn>1</mml:mn>                                                            <mml:mtext>&#x000a0;with&#x000a0;type&#x000a0;</mml:mtext>                                                            <mml:mi>k</mml:mi>                                                            <mml:mtext>&#x000a0;and&#x000a0;</mml:mtext>                                                            <mml:msub>                                                               <mml:mi>y</mml:mi>                                                               <mml:mrow>                                                                  <mml:mi>i</mml:mi>                                                                  <mml:mo>+</mml:mo>                                                                  <mml:mn>1</mml:mn>                                                                  <mml:mo>,</mml:mo>                                                                  <mml:mi>j</mml:mi>                                                                  <mml:mo>&#x02212;</mml:mo>                                                                  <mml:mn>1</mml:mn>                                                               </mml:mrow>                                                            </mml:msub>                                                            <mml:mo>=</mml:mo>                                                            <mml:mn>1</mml:mn>                                                            <mml:mtext>&#x000a0;with&#x000a0;type&#x000a0;</mml:mtext>                                                            <mml:mi>l</mml:mi>                                                            <mml:mo stretchy="false">)</mml:mo>                                                            <mml:mo>,</mml:mo>                                                         </mml:mrow>                                                      </mml:mtd>                                                   </mml:mtr>                                                   <mml:mtr columnalign="left">                                                      <mml:mtd columnalign="left">                                                         <mml:mn>0</mml:mn>                                                      </mml:mtd>                                                      <mml:mtd columnalign="left">                                                         <mml:mrow>                                                            <mml:mo stretchy="false">(</mml:mo>                                                            <mml:mtext>otherwise</mml:mtext>                                                            <mml:mo stretchy="false">)</mml:mo>                                                         </mml:mrow>                                                      </mml:mtd>                                                   </mml:mtr>                                                </mml:mtable>                                             </mml:mrow>                                          </mml:mrow>                                       </mml:mrow>                                    </mml:mtd>                                 </mml:mtr>                              </mml:mtable>                           </mml:mrow>                                                   </mml:semantics>                     </mml:math></disp-formula></p><p>for <italic>i</italic>, <italic>j </italic>= 1, 2, ..., <italic>n </italic>and <italic>k</italic>, <italic>l </italic>= 1, 2, ..., 6 (see Figure <xref ref-type="fig" rid="F3">3(b)</xref>). Note that the above definitions include illegal variables <italic>x</italic><sub><italic>i</italic>+1,0 </sub>and <italic>x</italic><sub><italic>n</italic>+1,<italic>j</italic>-1 </sub>for each <italic>i </italic>and <italic>j </italic>respectively (which also applies to <italic>y</italic><sub><italic>ij</italic></sub>), though we allow this notation for simplicity.</p><p>Let <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M19" name="1471-2105-10-S1-S38-i9" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> = 1 and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M20" name="1471-2105-10-S1-S38-i10" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> = 1 if and only if the base <italic>s</italic><sub><italic>i </italic></sub>pairs with some base at any other position greater than <italic>i </italic>and less than <italic>i </italic>respectively. In other words, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M21" name="1471-2105-10-S1-S38-i9" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> = 1 means that <italic>s</italic><sub><italic>i </italic></sub>is on the left side of a base pair and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M22" name="1471-2105-10-S1-S38-i10" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> = 1 means that <italic>s</italic><sub><italic>i </italic></sub>is on the right side of a base pair. This set of variables also applies to <italic>y</italic><sub><italic>ij</italic></sub>, defined by <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M23" name="1471-2105-10-S1-S38-i11" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M24" name="1471-2105-10-S1-S38-i12" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>.</p><p>We will use variables <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M25" name="1471-2105-10-S1-S38-i13" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M26" name="1471-2105-10-S1-S38-i14" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> to represent a recursive pseudoknotted structure. We let <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M27" name="1471-2105-10-S1-S38-i13" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> = 1 if and only if for a base pair (<italic>s</italic><sub><italic>i</italic></sub>, <italic>s</italic><sub><italic>j</italic></sub>) below the sequence, there is at least one base pair above the sequence (<italic>s</italic><sub><italic>i'</italic></sub>, <italic>s</italic><sub><italic>j'</italic></sub>) such that <italic>i</italic>' &#x0003c;<italic>i </italic>&#x0003c;<italic>j</italic>'. Similarly, let <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M28" name="1471-2105-10-S1-S38-i14" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> = 1 if and only if for a pair (<italic>s</italic><sub><italic>i</italic></sub>, <italic>s</italic><sub><italic>j</italic></sub>) below the sequence, there is at least one base pair above the sequence (<italic>s</italic><sub><italic>i'</italic></sub>, <italic>s</italic><sub><italic>j'</italic></sub>) such that <italic>i</italic>' &#x0003c;<italic>j </italic>&#x0003c;<italic>j</italic>' (see Figure <xref ref-type="fig" rid="F4">4(d)</xref>). With these variables, we can formulate an IP problem for RNA pseudoknot prediction as follows:</p><p><disp-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M29" name="1471-2105-10-S1-S38-i15" overflow="scroll">                        <mml:semantics>                           <mml:mrow>                              <mml:mtable>                                 <mml:mtr>                                    <mml:mtd>                                       <mml:mrow>                                          <mml:mtext>minimize</mml:mtext>                                       </mml:mrow>                                    </mml:mtd>                                    <mml:mtd>                                       <mml:mrow>                                          <mml:mstyle displaystyle="true">                                             <mml:munderover>                                                <mml:mo>&#x02211;</mml:mo>                                                <mml:mrow>                                                   <mml:mi>i</mml:mi>                                                   <mml:mo>=</mml:mo>                                                   <mml:mn>1</mml:mn>                                                </mml:mrow>                                                <mml:mi>n</mml:mi>                                             </mml:munderover>                                             <mml:mrow>                                                <mml:mstyle displaystyle="true">                                                   <mml:munderover>                                                      <mml:mo>&#x02211;</mml:mo>                                                      <mml:mrow>                                                         <mml:mi>j</mml:mi>                                                         <mml:mo>=</mml:mo>                                                         <mml:mn>1</mml:mn>                                                      </mml:mrow>                                                      <mml:mi>n</mml:mi>                                                   </mml:munderover>                                                   <mml:mrow>                                                      <mml:mstyle displaystyle="true">                                                         <mml:munderover>                                                            <mml:mo>&#x02211;</mml:mo>                                                            <mml:mrow>                                                               <mml:mi>k</mml:mi>                                                               <mml:mo>=</mml:mo>                                                               <mml:mn>1</mml:mn>                                                            </mml:mrow>                                                            <mml:mn>6</mml:mn>                                                         </mml:munderover>                                                         <mml:mrow>                                                            <mml:mstyle displaystyle="true">                                                               <mml:munderover>                                                                  <mml:mo>&#x02211;</mml:mo>                                                                  <mml:mrow>                                                                     <mml:mi>l</mml:mi>                                                                     <mml:mo>=</mml:mo>                                                                     <mml:mn>1</mml:mn>                                                                  </mml:mrow>                                                                  <mml:mn>6</mml:mn>                                                               </mml:munderover>                                                               <mml:mrow>                                                                  <mml:mo stretchy="false">(</mml:mo>                                                                  <mml:msub>                                                                     <mml:mi>e</mml:mi>                                                                     <mml:mrow>                                                                        <mml:mi>k</mml:mi>                                                                        <mml:mi>l</mml:mi>                                                                     </mml:mrow>                                                                  </mml:msub>                                                                  <mml:msubsup>                                                                     <mml:mi>z</mml:mi>                                                                     <mml:mrow>                                                                        <mml:msub>                                                                           <mml:mi>x</mml:mi>                                                                           <mml:mrow>                                                                              <mml:mi>i</mml:mi>                                                                              <mml:mi>j</mml:mi>                                                                           </mml:mrow>                                                                        </mml:msub>                                                                     </mml:mrow>                                                                     <mml:mrow>                                                                        <mml:mi>k</mml:mi>                                                                        <mml:mi>l</mml:mi>                                                                     </mml:mrow>                                                                  </mml:msubsup>                                                                  <mml:mo>+</mml:mo>                                                                  <mml:mi>&#x003c3;</mml:mi>                                                                  <mml:msub>                                                                     <mml:mi>e</mml:mi>                                                                     <mml:mrow>                                                                        <mml:mi>k</mml:mi>                                                                        <mml:mi>l</mml:mi>                                                                     </mml:mrow>                                                                  </mml:msub>                                                                  <mml:msubsup>                                                                     <mml:mi>z</mml:mi>                                                                     <mml:mrow>                                                                        <mml:msub>                                                                           <mml:mi>y</mml:mi>                                                                           <mml:mrow>                                                                              <mml:mi>i</mml:mi>                                                                              <mml:mi>j</mml:mi>                                                                           </mml:mrow>                                                                        </mml:msub>                                                                     </mml:mrow>                                                                     <mml:mrow>                                                                        <mml:mi>k</mml:mi>                                                                        <mml:mi>l</mml:mi>                                                                     </mml:mrow>                                                                  </mml:msubsup>                                                                  <mml:mo stretchy="false">)</mml:mo>                                                               </mml:mrow>                                                            </mml:mstyle>                                                         </mml:mrow>                                                      </mml:mstyle>                                                   </mml:mrow>                                                </mml:mstyle>                                             </mml:mrow>                                          </mml:mstyle>                                       </mml:mrow>                                    </mml:mtd>                                 </mml:mtr>                              </mml:mtable>                           </mml:mrow>                                                   </mml:semantics>                     </mml:math></disp-formula></p><p>subject to</p><p><disp-formula id="bmcM1"><label>(1)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M30" name="1471-2105-10-S1-S38-i16" overflow="scroll">                        <mml:semantics>                           <mml:mrow>                              <mml:msubsup>                                 <mml:mi>z</mml:mi>                                 <mml:mrow>                                    <mml:msub>                                       <mml:mi>x</mml:mi>                                       <mml:mrow>                                          <mml:mi>i</mml:mi>                                          <mml:mi>j</mml:mi>                                       </mml:mrow>                                    </mml:msub>                                 </mml:mrow>                                 <mml:mrow>                                    <mml:mi>k</mml:mi>                                    <mml:mi>l</mml:mi>                                 </mml:mrow>                              </mml:msubsup>                              <mml:mo>&#x02264;</mml:mo>                              <mml:mfrac>                                 <mml:mrow>                                    <mml:msub>                                       <mml:mi>x</mml:mi>                                       <mml:mrow>                                          <mml:mi>i</mml:mi>                                          <mml:mi>j</mml:mi>                                       </mml:mrow>                                    </mml:msub>                                    <mml:mo>+</mml:mo>                                    <mml:msub>                                       <mml:mi>x</mml:mi>                                       <mml:mrow>                                          <mml:mi>i</mml:mi>                                          <mml:mo>+</mml:mo>                                          <mml:mn>1</mml:mn>                                          <mml:mo>,</mml:mo>                                          <mml:mi>j</mml:mi>                                          <mml:mo>&#x02212;</mml:mo>                                          <mml:mn>1</mml:mn>                                       </mml:mrow>                                    </mml:msub>                                 </mml:mrow>                                 <mml:mn>2</mml:mn>                              </mml:mfrac>                           </mml:mrow>                                                   </mml:semantics>                     </mml:math></disp-formula></p><p><disp-formula>((<italic>s<sub>i</sub>,s<sub>j</sub></italic>) is type <italic>k</italic> and (<italic>s</italic><sub><italic>i</italic>+1</sub>,<italic>s</italic><sub><italic>j</italic>-1</sub>) is type <italic>l</italic>),</disp-formula></p><p><disp-formula id="bmcM2"><label>(2)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M31" name="1471-2105-10-S1-S38-i17" overflow="scroll">                        <mml:semantics>                           <mml:mrow>                              <mml:msubsup>                                 <mml:mi>z</mml:mi>                                 <mml:mrow>                                    <mml:msub>                                       <mml:mi>y</mml:mi>                                       <mml:mrow>                                          <mml:mi>i</mml:mi>                                          <mml:mi>j</mml:mi>                                       </mml:mrow>                                    </mml:msub>                                 </mml:mrow>                                 <mml:mrow>                                    <mml:mi>k</mml:mi>                                    <mml:mi>l</mml:mi>                                 </mml:mrow>                              </mml:msubsup>                              <mml:mo>&#x02264;</mml:mo>                              <mml:mfrac>                                 <mml:mrow>                                    <mml:msub>                                       <mml:mi>y</mml:mi>                                       <mml:mrow>                                          <mml:mi>i</mml:mi>                                          <mml:mi>j</mml:mi>                                       </mml:mrow>                                    </mml:msub>                                    <mml:mo>+</mml:mo>                                    <mml:msub>                                       <mml:mi>y</mml:mi>                                       <mml:mrow>                                          <mml:mi>i</mml:mi>                                          <mml:mo>+</mml:mo>                                          <mml:mn>1</mml:mn>                                          <mml:mo>,</mml:mo>                                          <mml:mi>j</mml:mi>                                          <mml:mo>&#x02212;</mml:mo>                                          <mml:mn>1</mml:mn>                                       </mml:mrow>                                    </mml:msub>                                 </mml:mrow>                                 <mml:mn>2</mml:mn>                              </mml:mfrac>                           </mml:mrow>                                                   </mml:semantics>                     </mml:math></disp-formula></p><p><disp-formula>((<italic>s<sub>i</sub>,s<sub>j</sub></italic>) is type <italic>k</italic> and (<italic>s</italic><sub><italic>i</italic>+1</sub>,<italic>s</italic><sub><italic>j</italic>-1</sub>) is type <italic>l</italic>),</disp-formula></p><p><disp-formula id="bmcM3"><label>(3)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M32" name="1471-2105-10-S1-S38-i18" overflow="scroll">                        <mml:semantics>                           <mml:mrow>                              <mml:mstyle displaystyle="true">                                 <mml:munderover>                                    <mml:mo>&#x02211;</mml:mo>                                    <mml:mrow>                                       <mml:mi>j</mml:mi>                                       <mml:mo>=</mml:mo>                                       <mml:mn>1</mml:mn>                                    </mml:mrow>                                    <mml:mrow>                                       <mml:mi>i</mml:mi>                                       <mml:mo>&#x02212;</mml:mo>                                       <mml:mn>1</mml:mn>                                    </mml:mrow>                                 </mml:munderover>                                 <mml:mrow>                                    <mml:msub>                                       <mml:mi>x</mml:mi>                                       <mml:mrow>                                          <mml:mi>j</mml:mi>                                          <mml:mi>i</mml:mi>                                       </mml:mrow>                                    </mml:msub>                                 </mml:mrow>                              </mml:mstyle>                              <mml:mo>+</mml:mo>                              <mml:mstyle displaystyle="true">                                 <mml:munderover>                                    <mml:mo>&#x02211;</mml:mo>                                    <mml:mrow>                                       <mml:msup>                                          <mml:mi>j</mml:mi>                                          <mml:mo>&#x02032;</mml:mo>                                       </mml:msup>                                       <mml:mo>=</mml:mo>                                       <mml:mi>i</mml:mi>                                       <mml:mo>+</mml:mo>                                       <mml:mn>1</mml:mn>                                    </mml:mrow>                                    <mml:mi>n</mml:mi>                                 </mml:munderover>                                 <mml:mrow>                                    <mml:msub>                                       <mml:mi>x</mml:mi>                                       <mml:mrow>                                          <mml:mi>i</mml:mi>                                          <mml:msup>                                             <mml:mi>j</mml:mi>                                             <mml:mo>&#x02032;</mml:mo>                                          </mml:msup>                                       </mml:mrow>                                    </mml:msub>                                 </mml:mrow>                              </mml:mstyle>                              <mml:mo>+</mml:mo>                              <mml:mstyle displaystyle="true">                                 <mml:munderover>                                    <mml:mo>&#x02211;</mml:mo>                                    <mml:mrow>                                       <mml:mi>j</mml:mi>                                       <mml:mo>=</mml:mo>                                       <mml:mn>1</mml:mn>                                    </mml:mrow>                                    <mml:mrow>                                       <mml:mi>i</mml:mi>                                       <mml:mo>&#x02212;</mml:mo>                                       <mml:mn>1</mml:mn>                                    </mml:mrow>                                 </mml:munderover>                                 <mml:mrow>                                    <mml:msub>                                       <mml:mi>y</mml:mi>                                       <mml:mrow>                                          <mml:mi>j</mml:mi>                                          <mml:mi>i</mml:mi>                                       </mml:mrow>                                    </mml:msub>                                 </mml:mrow>                              </mml:mstyle>                              <mml:mo>+</mml:mo>                              <mml:mstyle displaystyle="true">                                 <mml:munderover>                                    <mml:mo>&#x02211;</mml:mo>                                    <mml:mrow>                                       <mml:msup>                                          <mml:mi>j</mml:mi>                                          <mml:mo>&#x02032;</mml:mo>                                       </mml:msup>                                       <mml:mo>=</mml:mo>                                       <mml:mi>i</mml:mi>                                       <mml:mo>+</mml:mo>                                       <mml:mn>1</mml:mn>                                    </mml:mrow>                                    <mml:mi>n</mml:mi>                                 </mml:munderover>                                 <mml:mrow>                                    <mml:msub>                                       <mml:mi>y</mml:mi>                                       <mml:mrow>                                          <mml:mi>i</mml:mi>                                          <mml:msup>                                             <mml:mi>j</mml:mi>                                             <mml:mo>&#x02032;</mml:mo>                                          </mml:msup>                                       </mml:mrow>                                    </mml:msub>                                    <mml:mo>&#x02264;</mml:mo>                                    <mml:mn>1</mml:mn>                                 </mml:mrow>                              </mml:mstyle>                              <mml:mo>,</mml:mo>                           </mml:mrow>                                                   </mml:semantics>                     </mml:math></disp-formula></p><p><disp-formula id="bmcM4"><label>(4)</label><italic>x</italic><sub><italic>ij </italic></sub>+ <italic>y</italic><sub><italic>ij </italic></sub>&#x02264; 1,</disp-formula></p><p><disp-formula id="bmcM5"><label>(5)</label><italic>x</italic><sub><italic>ij </italic></sub>+ <italic>x</italic><sub><italic>i</italic>'<italic>j</italic>' </sub>&#x02264; 1 (&#x02200;<italic>i </italic>&#x0003c;<italic>i</italic>' &#x0003c;<italic>j </italic>&#x0003c;<italic>j</italic>'),</disp-formula></p><p><disp-formula id="bmcM6"><label>(6)</label><italic>y</italic><sub><italic>ij </italic></sub>+ <italic>y</italic><sub><italic>i</italic>'<italic>j</italic>' </sub>&#x02264; 1 (&#x02200;<italic>i </italic>&#x0003c;<italic>i</italic>' &#x0003c;<italic>j </italic>&#x0003c;<italic>j</italic>'),</disp-formula></p><p><disp-formula id="bmcM7"><label>(7)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M33" name="1471-2105-10-S1-S38-i19" overflow="scroll">                        <mml:semantics>                           <mml:mrow>                              <mml:msub>                                 <mml:mi>L</mml:mi>                                 <mml:mrow>                                    <mml:msub>                                       <mml:mi>x</mml:mi>                                       <mml:mi>i</mml:mi>                                    </mml:msub>                                 </mml:mrow>                              </mml:msub>                              <mml:mo>&#x02212;</mml:mo>                              <mml:mstyle displaystyle="true">                                 <mml:munderover>                                    <mml:mo>&#x02211;</mml:mo>                                    <mml:mrow>                                       <mml:mi>j</mml:mi>                                       <mml:mo>=</mml:mo>                                       <mml:mi>i</mml:mi>                                       <mml:mo>+</mml:mo>                                       <mml:mn>1</mml:mn>                                    </mml:mrow>                                    <mml:mi>n</mml:mi>                                 </mml:munderover>                                 <mml:mrow>                                    <mml:msub>                                       <mml:mi>x</mml:mi>                                       <mml:mrow>                                          <mml:mi>i</mml:mi>                                          <mml:mi>j</mml:mi>                                       </mml:mrow>                                    </mml:msub>                                    <mml:mo>=</mml:mo>                                    <mml:mn>0</mml:mn>                                 </mml:mrow>                              </mml:mstyle>                              <mml:mo>,</mml:mo>                           </mml:mrow>                                                   </mml:semantics>                     </mml:math></disp-formula></p><p><disp-formula id="bmcM8"><label>(8)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M34" name="1471-2105-10-S1-S38-i20" overflow="scroll">                        <mml:semantics>                           <mml:mrow>                              <mml:msub>                                 <mml:mi>R</mml:mi>                                 <mml:mrow>                                    <mml:msub>                                       <mml:mi>x</mml:mi>                                       <mml:mi>i</mml:mi>                                    </mml:msub>                                 </mml:mrow>                              </mml:msub>                              <mml:mo>&#x02212;</mml:mo>                              <mml:mstyle displaystyle="true">                                 <mml:munderover>                                    <mml:mo>&#x02211;</mml:mo>                                    <mml:mrow>                                       <mml:mi>j</mml:mi>                                       <mml:mo>=</mml:mo>                                       <mml:mn>1</mml:mn>                                    </mml:mrow>                                    <mml:mrow>                                       <mml:mi>i</mml:mi>                                       <mml:mo>&#x02212;</mml:mo>                                       <mml:mn>1</mml:mn>                                    </mml:mrow>                                 </mml:munderover>                                 <mml:mrow>                                    <mml:msub>                                       <mml:mi>x</mml:mi>                                       <mml:mrow>                                          <mml:mi>j</mml:mi>                                          <mml:mi>i</mml:mi>                                       </mml:mrow>                                    </mml:msub>                                    <mml:mo>=</mml:mo>                                    <mml:mn>0</mml:mn>                                 </mml:mrow>                              </mml:mstyle>                              <mml:mo>,</mml:mo>                           </mml:mrow>                                                   </mml:semantics>                     </mml:math></disp-formula></p><p><disp-formula id="bmcM9"><label>(9)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M35" name="1471-2105-10-S1-S38-i21" overflow="scroll">                        <mml:semantics>                           <mml:mrow>                              <mml:msub>                                 <mml:mi>L</mml:mi>                                 <mml:mrow>                                    <mml:msub>                                       <mml:mi>y</mml:mi>                                       <mml:mi>i</mml:mi>                                    </mml:msub>                                 </mml:mrow>                              </mml:msub>                              <mml:mo>&#x02212;</mml:mo>                              <mml:mstyle displaystyle="true">                                 <mml:munderover>                                    <mml:mo>&#x02211;</mml:mo>                                    <mml:mrow>                                       <mml:mi>j</mml:mi>                                       <mml:mo>=</mml:mo>                                       <mml:mi>i</mml:mi>                                       <mml:mo>+</mml:mo>                                       <mml:mn>1</mml:mn>                                    </mml:mrow>                                    <mml:mi>n</mml:mi>                                 </mml:munderover>                                 <mml:mrow>                                    <mml:msub>                                       <mml:mi>y</mml:mi>                                       <mml:mrow>                                          <mml:mi>i</mml:mi>                                          <mml:mi>j</mml:mi>                                       </mml:mrow>                                    </mml:msub>                                    <mml:mo>=</mml:mo>                                    <mml:mn>0</mml:mn>                                 </mml:mrow>                              </mml:mstyle>                              <mml:mo>,</mml:mo>                           </mml:mrow>                                                   </mml:semantics>                     </mml:math></disp-formula></p><p><disp-formula id="bmcM10"><label>(10)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M36" name="1471-2105-10-S1-S38-i22" overflow="scroll">                        <mml:semantics>                           <mml:mrow>                              <mml:msub>                                 <mml:mi>R</mml:mi>                                 <mml:mrow>                                    <mml:msub>                                       <mml:mi>y</mml:mi>                                       <mml:mi>i</mml:mi>                                    </mml:msub>                                 </mml:mrow>                              </mml:msub>                              <mml:mo>&#x02212;</mml:mo>                              <mml:mstyle displaystyle="true">                                 <mml:munderover>                                    <mml:mo>&#x02211;</mml:mo>                                    <mml:mrow>                                       <mml:mi>j</mml:mi>                                       <mml:mo>=</mml:mo>                                       <mml:mn>1</mml:mn>                                    </mml:mrow>                                    <mml:mrow>                                       <mml:mi>i</mml:mi>                                       <mml:mo>&#x02212;</mml:mo>                                       <mml:mn>1</mml:mn>                                    </mml:mrow>                                 </mml:munderover>                                 <mml:mrow>                                    <mml:msub>                                       <mml:mi>y</mml:mi>                                       <mml:mrow>                                          <mml:mi>j</mml:mi>                                          <mml:mi>i</mml:mi>                                       </mml:mrow>                                    </mml:msub>                                    <mml:mo>=</mml:mo>                                    <mml:mn>0</mml:mn>                                 </mml:mrow>                              </mml:mstyle>                              <mml:mo>,</mml:mo>                           </mml:mrow>                                                   </mml:semantics>                     </mml:math></disp-formula></p><p><disp-formula id="bmcM11"><label>(11)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M37" name="1471-2105-10-S1-S38-i23" overflow="scroll">                        <mml:semantics>                           <mml:mrow>                              <mml:msub>                                 <mml:mi>L</mml:mi>                                 <mml:mrow>                                    <mml:msub>                                       <mml:mi>x</mml:mi>                                       <mml:mrow>                                          <mml:mi>i</mml:mi>                                          <mml:mo>&#x02212;</mml:mo>                                          <mml:mn>1</mml:mn>                                       </mml:mrow>                                    </mml:msub>                                 </mml:mrow>                              </mml:msub>                              <mml:mo>+</mml:mo>                              <mml:mo stretchy="false">(</mml:mo>                              <mml:mn>1</mml:mn>                              <mml:mo>&#x02212;</mml:mo>                              <mml:msub>                                 <mml:mi>L</mml:mi>                                 <mml:mrow>                                    <mml:msub>                                       <mml:mi>x</mml:mi>                                       <mml:mi>i</mml:mi>                                    </mml:msub>                                 </mml:mrow>                              </mml:msub>                              <mml:mo stretchy="false">)</mml:mo>                              <mml:mo>+</mml:mo>                              <mml:msub>                                 <mml:mi>L</mml:mi>                                 <mml:mrow>                                    <mml:msub>                                       <mml:mi>x</mml:mi>                                       <mml:mrow>                                          <mml:mi>i</mml:mi>                                          <mml:mo>+</mml:mo>                                          <mml:mn>1</mml:mn>                                       </mml:mrow>                                    </mml:msub>                                 </mml:mrow>                              </mml:msub>                              <mml:mo>&#x02265;</mml:mo>                              <mml:mn>1</mml:mn>                              <mml:mo>,</mml:mo>                           </mml:mrow>                                                   </mml:semantics>                     </mml:math></disp-formula></p><p><disp-formula id="bmcM12"><label>(12)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M38" name="1471-2105-10-S1-S38-i24" overflow="scroll">                        <mml:semantics>                           <mml:mrow>                              <mml:msub>                                 <mml:mi>R</mml:mi>                                 <mml:mrow>                                    <mml:msub>                                       <mml:mi>x</mml:mi>                                       <mml:mrow>                                          <mml:mi>i</mml:mi>                                          <mml:mo>&#x02212;</mml:mo>                                          <mml:mn>1</mml:mn>                                       </mml:mrow>                                    </mml:msub>                                 </mml:mrow>                              </mml:msub>                              <mml:mo>+</mml:mo>                              <mml:mo stretchy="false">(</mml:mo>                              <mml:mn>1</mml:mn>                              <mml:mo>&#x02212;</mml:mo>                              <mml:msub>                                 <mml:mi>R</mml:mi>                                 <mml:mrow>                                    <mml:msub>                                       <mml:mi>x</mml:mi>                                       <mml:mi>i</mml:mi>                                    </mml:msub>                                 </mml:mrow>                              </mml:msub>                              <mml:mo stretchy="false">)</mml:mo>                              <mml:mo>+</mml:mo>                              <mml:msub>                                 <mml:mi>R</mml:mi>                                 <mml:mrow>                                    <mml:msub>                                       <mml:mi>x</mml:mi>                                       <mml:mrow>                                          <mml:mi>i</mml:mi>                                          <mml:mo>+</mml:mo>                                          <mml:mn>1</mml:mn>                                       </mml:mrow>                                    </mml:msub>                                 </mml:mrow>                              </mml:msub>                              <mml:mo>&#x02265;</mml:mo>                              <mml:mn>1</mml:mn>                              <mml:mo>,</mml:mo>                           </mml:mrow>                                                   </mml:semantics>                     </mml:math></disp-formula></p><p><disp-formula id="bmcM13"><label>(13)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M39" name="1471-2105-10-S1-S38-i25" overflow="scroll">                        <mml:semantics>                           <mml:mrow>                              <mml:msub>                                 <mml:mi>L</mml:mi>                                 <mml:mrow>                                    <mml:msub>                                       <mml:mi>y</mml:mi>                                       <mml:mrow>                                          <mml:mi>i</mml:mi>                                          <mml:mo>&#x02212;</mml:mo>                                          <mml:mn>1</mml:mn>                                       </mml:mrow>                                    </mml:msub>                                 </mml:mrow>                              </mml:msub>                              <mml:mo>+</mml:mo>                              <mml:mo stretchy="false">(</mml:mo>                              <mml:mn>1</mml:mn>                              <mml:mo>&#x02212;</mml:mo>                              <mml:msub>                                 <mml:mi>L</mml:mi>                                 <mml:mrow>                                    <mml:msub>                                       <mml:mi>y</mml:mi>                                       <mml:mi>i</mml:mi>                                    </mml:msub>                                 </mml:mrow>                              </mml:msub>                              <mml:mo stretchy="false">)</mml:mo>                              <mml:mo>+</mml:mo>                              <mml:msub>                                 <mml:mi>L</mml:mi>                                 <mml:mrow>                                    <mml:msub>                                       <mml:mi>y</mml:mi>                                       <mml:mrow>                                          <mml:mi>i</mml:mi>                                          <mml:mo>+</mml:mo>                                          <mml:mn>1</mml:mn>                                       </mml:mrow>                                    </mml:msub>                                 </mml:mrow>                              </mml:msub>                              <mml:mo>&#x02265;</mml:mo>                              <mml:mn>1</mml:mn>                              <mml:mo>,</mml:mo>                           </mml:mrow>                                                   </mml:semantics>                     </mml:math></disp-formula></p><p><disp-formula id="bmcM14"><label>(14)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M40" name="1471-2105-10-S1-S38-i26" overflow="scroll">                        <mml:semantics>                           <mml:mrow>                              <mml:msub>                                 <mml:mi>R</mml:mi>                                 <mml:mrow>                                    <mml:msub>                                       <mml:mi>y</mml:mi>                                       <mml:mrow>                                          <mml:mi>i</mml:mi>                                          <mml:mo>&#x02212;</mml:mo>                                          <mml:mn>1</mml:mn>                                       </mml:mrow>                                    </mml:msub>                                 </mml:mrow>                              </mml:msub>                              <mml:mo>+</mml:mo>                              <mml:mo stretchy="false">(</mml:mo>                              <mml:mn>1</mml:mn>                              <mml:mo>&#x02212;</mml:mo>                              <mml:msub>                                 <mml:mi>R</mml:mi>                                 <mml:mrow>                                    <mml:msub>                                       <mml:mi>y</mml:mi>                                       <mml:mi>i</mml:mi>                                    </mml:msub>                                 </mml:mrow>                              </mml:msub>                              <mml:mo stretchy="false">)</mml:mo>                              <mml:mo>+</mml:mo>                              <mml:msub>                                 <mml:mi>R</mml:mi>                                 <mml:mrow>                                    <mml:msub>                                       <mml:mi>y</mml:mi>                                       <mml:mrow>                                          <mml:mi>i</mml:mi>                                          <mml:mo>+</mml:mo>                                          <mml:mn>1</mml:mn>                                       </mml:mrow>                                    </mml:msub>                                 </mml:mrow>                              </mml:msub>                              <mml:mo>&#x02265;</mml:mo>                              <mml:mn>1</mml:mn>                              <mml:mo>,</mml:mo>                           </mml:mrow>                                                   </mml:semantics>                     </mml:math></disp-formula></p><p><disp-formula id="bmcM15"><label>(15)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M41" name="1471-2105-10-S1-S38-i27" overflow="scroll">                        <mml:semantics>                           <mml:mrow>                              <mml:msub>                                 <mml:mi>L</mml:mi>                                 <mml:mrow>                                    <mml:msub>                                       <mml:mi>t</mml:mi>                                       <mml:mrow>                                          <mml:mi>i</mml:mi>                                          <mml:mi>j</mml:mi>                                       </mml:mrow>                                    </mml:msub>                                 </mml:mrow>                              </mml:msub>                              <mml:mo>&#x02265;</mml:mo>                              <mml:mfrac>                                 <mml:mn>1</mml:mn>                                 <mml:mrow>                                    <mml:msup>                                       <mml:mi>n</mml:mi>                                       <mml:mn>2</mml:mn>                                    </mml:msup>                                 </mml:mrow>                              </mml:mfrac>                              <mml:mstyle displaystyle="true">                                 <mml:munder>                                    <mml:mo>&#x02211;</mml:mo>                                    <mml:mrow>                                       <mml:msup>                                          <mml:mi>i</mml:mi>                                          <mml:mo>&#x02032;</mml:mo>                                       </mml:msup>                                       <mml:mo>&#x0003c;</mml:mo>                                       <mml:mi>i</mml:mi>                                       <mml:mo>&#x0003c;</mml:mo>                                       <mml:msup>                                          <mml:mi>j</mml:mi>                                          <mml:mo>&#x02032;</mml:mo>                                       </mml:msup>                                       <mml:mo>&#x0003c;</mml:mo>                                       <mml:mi>j</mml:mi>                                    </mml:mrow>                                 </mml:munder>                                 <mml:mrow>                                    <mml:msub>                                       <mml:mi>x</mml:mi>                                       <mml:mrow>                                          <mml:msup>                                             <mml:mi>i</mml:mi>                                             <mml:mo>&#x02032;</mml:mo>                                          </mml:msup>                                          <mml:msup>                                             <mml:mi>j</mml:mi>                                             <mml:mo>&#x02032;</mml:mo>                                          </mml:msup>                                       </mml:mrow>                                    </mml:msub>                                 </mml:mrow>                              </mml:mstyle>                              <mml:mo>,</mml:mo>                           </mml:mrow>                                                   </mml:semantics>                     </mml:math></disp-formula></p><p><disp-formula id="bmcM16"><label>(16)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M42" name="1471-2105-10-S1-S38-i28" overflow="scroll">                        <mml:semantics>                           <mml:mrow>                              <mml:msub>                                 <mml:mi>R</mml:mi>                                 <mml:mrow>                                    <mml:msub>                                       <mml:mi>t</mml:mi>                                       <mml:mrow>                                          <mml:mi>i</mml:mi>                                          <mml:mi>j</mml:mi>                                       </mml:mrow>                                    </mml:msub>                                 </mml:mrow>                              </mml:msub>                              <mml:mo>&#x02265;</mml:mo>                              <mml:mfrac>                                 <mml:mn>1</mml:mn>                                 <mml:mrow>                                    <mml:msup>                                       <mml:mi>n</mml:mi>                                       <mml:mn>2</mml:mn>                                    </mml:msup>                                 </mml:mrow>                              </mml:mfrac>                              <mml:mstyle displaystyle="true">                                 <mml:munder>                                    <mml:mo>&#x02211;</mml:mo>                                    <mml:mrow>                                       <mml:mi>i</mml:mi>                                       <mml:mo>&#x0003c;</mml:mo>                                       <mml:msup>                                          <mml:mi>i</mml:mi>                                          <mml:mo>&#x02032;</mml:mo>                                       </mml:msup>                                       <mml:mo>&#x0003c;</mml:mo>                                       <mml:mi>j</mml:mi>                                       <mml:mo>&#x0003c;</mml:mo>                                       <mml:msup>                                          <mml:mi>j</mml:mi>                                          <mml:mo>&#x02032;</mml:mo>                                       </mml:msup>                                    </mml:mrow>                                 </mml:munder>                                 <mml:mrow>                                    <mml:msub>                                       <mml:mi>x</mml:mi>                                       <mml:mrow>                                          <mml:msup>                                             <mml:mi>i</mml:mi>                                             <mml:mo>&#x02032;</mml:mo>                                          </mml:msup>                                          <mml:msup>                                             <mml:mi>j</mml:mi>                                             <mml:mo>&#x02032;</mml:mo>                                          </mml:msup>                                       </mml:mrow>                                    </mml:msub>                                 </mml:mrow>                              </mml:mstyle>                              <mml:mo>,</mml:mo>                           </mml:mrow>                                                   </mml:semantics>                     </mml:math></disp-formula></p><p><disp-formula id="bmcM17"><label>(17)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M43" name="1471-2105-10-S1-S38-i29" overflow="scroll">                        <mml:semantics>                           <mml:mrow>                              <mml:msub>                                 <mml:mi>L</mml:mi>                                 <mml:mrow>                                    <mml:msub>                                       <mml:mi>t</mml:mi>                                       <mml:mrow>                                          <mml:mi>i</mml:mi>                                          <mml:mi>j</mml:mi>                                       </mml:mrow>                                    </mml:msub>                                 </mml:mrow>                              </mml:msub>                              <mml:mo>+</mml:mo>                              <mml:msub>                                 <mml:mi>R</mml:mi>                                 <mml:mrow>                                    <mml:msub>                                       <mml:mi>t</mml:mi>                                       <mml:mrow>                                          <mml:mi>i</mml:mi>                                          <mml:mi>j</mml:mi>                                       </mml:mrow>                                    </mml:msub>                                 </mml:mrow>                              </mml:msub>                              <mml:mo>&#x02264;</mml:mo>                              <mml:mn>1</mml:mn>                              <mml:mo>,</mml:mo>                           </mml:mrow>                                                   </mml:semantics>                     </mml:math></disp-formula></p><p><disp-formula id="bmcM18"><label>(18)</label><italic>y</italic><sub><italic>ij </italic></sub>+ <italic>y</italic><sub><italic>i</italic>'<italic>j</italic>' </sub>&#x02264; 1 (&#x02200;<italic>i </italic>&#x0003c;<italic>j </italic>&#x0003c;<italic>i</italic>' &#x0003c;<italic>j</italic>'),</disp-formula></p><p><disp-formula id="bmcM19"><label>(19)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M44" name="1471-2105-10-S1-S38-i30" overflow="scroll">                        <mml:semantics>                           <mml:mrow>                              <mml:msub>                                 <mml:mi>x</mml:mi>                                 <mml:mrow>                                    <mml:mi>i</mml:mi>                                    <mml:mi>j</mml:mi>                                 </mml:mrow>                              </mml:msub>                              <mml:mo>,</mml:mo>                              <mml:msub>                                 <mml:mi>y</mml:mi>                                 <mml:mrow>                                    <mml:mi>i</mml:mi>                                    <mml:mi>j</mml:mi>                                 </mml:mrow>                              </mml:msub>                              <mml:mo>,</mml:mo>                              <mml:msubsup>                                 <mml:mi>z</mml:mi>                                 <mml:mrow>                                    <mml:msub>                                       <mml:mi>x</mml:mi>                                       <mml:mrow>                                          <mml:mi>i</mml:mi>                                          <mml:mi>j</mml:mi>                                       </mml:mrow>                                    </mml:msub>                                 </mml:mrow>                                 <mml:mrow>                                    <mml:mi>k</mml:mi>                                    <mml:mi>l</mml:mi>                                 </mml:mrow>                              </mml:msubsup>                              <mml:mo>,</mml:mo>                              <mml:msubsup>                                 <mml:mi>z</mml:mi>                                 <mml:mrow>                                    <mml:msub>                                       <mml:mi>y</mml:mi>                                       <mml:mrow>                                          <mml:mi>i</mml:mi>                                          <mml:mi>j</mml:mi>                                       </mml:mrow>                                    </mml:msub>                                 </mml:mrow>                                 <mml:mrow>                                    <mml:mi>k</mml:mi>                                    <mml:mi>l</mml:mi>                                 </mml:mrow>                              </mml:msubsup>                              <mml:mo>,</mml:mo>                              <mml:msub>                                 <mml:mi>L</mml:mi>                                 <mml:mrow>                                    <mml:msub>                                       <mml:mi>x</mml:mi>                                       <mml:mi>i</mml:mi>                                    </mml:msub>                                 </mml:mrow>                              </mml:msub>                              <mml:mo>,</mml:mo>                              <mml:msub>                                 <mml:mi>L</mml:mi>                                 <mml:mrow>                                    <mml:msub>                                       <mml:mi>y</mml:mi>                                       <mml:mi>i</mml:mi>                                    </mml:msub>                                 </mml:mrow>                              </mml:msub>                              <mml:mo>,</mml:mo>                              <mml:msub>                                 <mml:mi>R</mml:mi>                                 <mml:mrow>                                    <mml:msub>                                       <mml:mi>x</mml:mi>                                       <mml:mi>i</mml:mi>                                    </mml:msub>                                 </mml:mrow>                              </mml:msub>                              <mml:mo>,</mml:mo>                              <mml:msub>                                 <mml:mi>R</mml:mi>                                 <mml:mrow>                                    <mml:msub>                                       <mml:mi>y</mml:mi>                                       <mml:mi>i</mml:mi>                                    </mml:msub>                                 </mml:mrow>                              </mml:msub>                              <mml:mo>,</mml:mo>                              <mml:msub>                                 <mml:mi>L</mml:mi>                                 <mml:mrow>                                    <mml:msub>                                       <mml:mi>t</mml:mi>                                       <mml:mrow>                                          <mml:mi>i</mml:mi>                                          <mml:mi>j</mml:mi>                                       </mml:mrow>                                    </mml:msub>                                 </mml:mrow>                              </mml:msub>                              <mml:mo>,</mml:mo>                              <mml:msub>                                 <mml:mi>R</mml:mi>                                 <mml:mrow>                                    <mml:msub>                                       <mml:mi>t</mml:mi>                                       <mml:mrow>                                          <mml:mi>i</mml:mi>                                          <mml:mi>j</mml:mi>                                       </mml:mrow>                                    </mml:msub>                                 </mml:mrow>                              </mml:msub>                              <mml:mo>&#x02208;</mml:mo>                              <mml:mo>{</mml:mo>                              <mml:mn>0</mml:mn>                              <mml:mo>,</mml:mo>                              <mml:mn>1</mml:mn>                              <mml:mo>}</mml:mo>                           </mml:mrow>                                                   </mml:semantics>                     </mml:math></disp-formula></p><p>where <italic>i</italic>, <italic>j</italic>, <italic>i</italic>', <italic>j</italic>' = 1, 2, ..., <italic>n</italic>; <italic>k</italic>, <italic>l </italic>= 1, 2, ..., 6.</p><fig position="float" id="F4"><label>Figure 4</label><caption><p><bold>Illustration of several constraints</bold>. (a) Constraints (3) and (4). (b) Constraints (5) and (6). (c) Constraints (11)&#x02013;(14). (d) Constraints (15)&#x02013;(17). (e) Constraint (18).</p></caption><graphic xlink:href="1471-2105-10-S1-S38-4"/></fig><p>The first term in summations of the objective function is the sum of the overall energy of stacking base pairs formed above the sequence, while the second term is the sum of the overall energy of the stacking base pairs formed below the sequence. We multiply the second term by a positive weighting parameter <italic>&#x003c3;</italic>. The weighting parameter restricts the occurrence of base pairs below the sequence. This is to take into account that pseudoknotted structure frequently does not appear in nature. The value of <italic>&#x003c3; </italic>suggested in [<xref ref-type="bibr" rid="B5">5</xref>] is <italic>&#x003c3; </italic>&#x0003c; 1, though the early work employed a dynamic programming-based approach. In our model, we define <italic>&#x003c3; </italic>&#x02208; {0.55, 0.6, 0.65, 0.7, 0.75, 0.8}.</p><p>Constraints (1) and (2) mean that if (<italic>s</italic><sub><italic>i</italic></sub>, <italic>s</italic><sub><italic>j</italic></sub>) is a valid pair with type <italic>k </italic>and (<italic>s</italic><sub><italic>i</italic>+1</sub>, <italic>s</italic><sub><italic>j</italic>-1</sub>) is a valid pair with type <italic>l</italic>, the energy parameter associated with (<italic>k</italic>, <italic>l</italic>) stacking type will contribute to the total energy of the structure (Figure <xref ref-type="fig" rid="F3">3(b)</xref>). Constraints (3) and (4) say that each base can be paired with at most one base regardless of whether the pair is formed above or below the sequence (Figure <xref ref-type="fig" rid="F4">4(a)</xref>). Constraints (5) and (6) inhibit crossing pairs both above the sequence and below the sequence (Figure <xref ref-type="fig" rid="F4">4(b)</xref>). In constraints (7), (8), (9) and (10), <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M45" name="1471-2105-10-S1-S38-i9" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M46" name="1471-2105-10-S1-S38-i10" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M47" name="1471-2105-10-S1-S38-i11" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M48" name="1471-2105-10-S1-S38-i12" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> are defined respectively. Constraints (11), (12), (13) and (14) guarantee that if a base is paired with another one, its adjacent base must also form a base pair (Figure <xref ref-type="fig" rid="F4">4(c)</xref>). The purpose of these constraints is to promote stacking pairs because they are known to help to stabilize the structure. Constraints (15) and (16) define <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M49" name="1471-2105-10-S1-S38-i13" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M50" name="1471-2105-10-S1-S38-i14" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> respectively. In the constraint (17), if (<italic>s</italic><sub><italic>i</italic></sub>, <italic>s</italic><sub><italic>j</italic></sub>) is a base pair formed below the sequence, either <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M51" name="1471-2105-10-S1-S38-i13" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> or <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M52" name="1471-2105-10-S1-S38-i14" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> can take the value 1. This means that the crossing region can occur once at a time (Figure <xref ref-type="fig" rid="F4">4(d)</xref>). Notice that base pairs can be formed recursively in the loop regions, for example, the region from <italic>i</italic>' to <italic>i </italic>and the region from <italic>i </italic>to <italic>j</italic>' in Figure <xref ref-type="fig" rid="F4">4(d)</xref>. By virtue of constraints (15), (16), (17), this IP model can handle a subclass of recursive pseudoknots where internal unpaired regions of a simple pseudoknot can have pseudoknot-free structure. The constraint (18) is used for prohibiting bifurcation structure from occurring below the sequence (Figure <xref ref-type="fig" rid="F4">4(e)</xref>). The constraint (19) guarantees all variables to be either 0 or 1.</p></sec></sec></sec><sec><title>Results and discussion</title><sec><title>Data set</title><p>Test sequences that are known to form pseudoknots were taken from PseudoBase [<xref ref-type="bibr" rid="B2">2</xref>], where we selected 34 sequences of several kinds of secondary structures and of various lengths (21&#x02013;137 bases) from different families (viral 3'UTR, mRNA, rRNA, ribozymes and tRNA-like). Specifically, we first selected a set of sequences of lengths 20&#x02013;140 bases uniformly. We then checked the secondary structure of each sequence and removed sequences of similar secondary structure from the set.</p><p>Other test sequences that do not contain any pseudoknots were obtained from Rfam [<xref ref-type="bibr" rid="B20">20</xref>]. Seven pseudoknot-free sequences from different families were selected in the same way as the sequences that contain pseudoknots, so that their secondary structures and lengths are different (26&#x02013;88 bases).</p></sec><sec><title>Implementation</title><p>After formulating the IP problem for prediction of RNA secondary structure, we employed the optimizer software called ILOG CPLEX 10.1 [<xref ref-type="bibr" rid="B19">19</xref>] to solve the IP formulation. CPLEX is a commercial software that can solve mathematical optimization problems, including IP problems. We implemented the IP formulation by C++ and included the C++ optimization library provided by CPLEX on a machine with Intel Xeon CPU 5160 3.00 GHz and 8.00 GB RAM.</p><p>In our implementation, we reduced the set of variables <italic>x</italic><sub><italic>ij </italic></sub>and <italic>y</italic><sub><italic>ij </italic></sub>to solve the problem fast. During implementation of <italic>x</italic><sub><italic>ij </italic></sub>and <italic>y</italic><sub><italic>ij</italic></sub>, we focused on the fact that at least two base pairs are likely to appear consecutively on the sequence. We considered not only the pair of (<italic>s</italic><sub><italic>i</italic></sub>, <italic>s</italic><sub><italic>j</italic></sub>) but also its adjacent pairs, i.e., (<italic>s</italic><sub><italic>i</italic>-1</sub>, <italic>s</italic><sub><italic>j</italic>+1</sub>) and (<italic>s</italic><sub><italic>i</italic>+1</sub>, <italic>s</italic><sub><italic>j</italic>-1</sub>). If (<italic>s</italic><sub><italic>i</italic></sub>, <italic>s</italic><sub><italic>j</italic></sub>) and at least one of those adjacent pairs are valid, we implemented <italic>x</italic><sub><italic>ij </italic></sub>and <italic>y</italic><sub><italic>ij </italic></sub>as decision variables.</p></sec><sec><title>Tests</title><p>Prediction accuracy of our method was measured by the sensitivity and specificity. Specificity is defined as the proportion of the number of correctly predicted base pairs to the number of base pairs of the known structure. Specificity is defined as the proportion of the number of correctly predicted base pairs to the total number of base pairs predicted by the algorithm.</p><p>We carried out pseudoknotted structure prediction with each value of <italic>&#x003c3; </italic>in order to determine the most proper value (see Table <xref ref-type="table" rid="T2">2</xref> . We then chose <italic>&#x003c3; </italic>that yielded the highest average prediction accuracy on our data set. From Table <xref ref-type="table" rid="T2">2</xref> , the best value of <italic>&#x003c3; </italic>is 0.70. However, increasing or decreasing value of <italic>&#x003c3; </italic>did not show any definitive way to find the optimal value of <italic>&#x003c3;</italic>.</p><table-wrap position="float" id="T2"><label>Table 2</label><caption><p>Average sensitivity and specificity of each value of <italic>&#x003c3;</italic>.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="center"><italic>&#x003c3;</italic></td><td align="center">Avg. sensitivity (%)</td><td align="center">Avg. specificity (%)</td></tr></thead><tbody><tr><td align="center">0.55</td><td align="center">75.67</td><td align="center">64.92</td></tr><tr><td align="center">0.60</td><td align="center">72.70</td><td align="center">62.21</td></tr><tr><td align="center">0.65</td><td align="center">70.53</td><td align="center">60.86</td></tr><tr><td align="center"><bold>0.70</bold></td><td align="center">75.91</td><td align="center">65.40</td></tr><tr><td align="center">0.75</td><td align="center">75.09</td><td align="center">65.02</td></tr><tr><td align="center">0.80</td><td align="center">70.53</td><td align="center">60.89</td></tr></tbody></table></table-wrap><p>We compared the prediction results on the best <italic>&#x003c3; </italic>(<italic>&#x003c3; </italic>= 0.70) of IP with the results from ILM [<xref ref-type="bibr" rid="B7">7</xref>], pknotsRG [<xref ref-type="bibr" rid="B6">6</xref>] and PKNOTS [<xref ref-type="bibr" rid="B5">5</xref>], shown in Table <xref ref-type="table" rid="T3">3</xref> . Note that PKB number is an identification number of each RNA sequence used in PseudoBase. Moreover, we compared computation time of each method (see Table <xref ref-type="table" rid="T4">4</xref> ). As the table shows, computation time of the IP-based method depends on the sequence length. Specifically, as the sequence length elongates, the computation time increases exponentially.</p><table-wrap position="float" id="T3"><label>Table 3</label><caption><p>Prediction results of the IP-based method (<italic>&#x003c3; </italic>= 0.7) and prediction results of the other algorithms.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="left">PKB num.</td><td align="center">Length</td><td align="center" colspan="4">Sensitivity (%)</td><td align="center" colspan="4">Specificity (%)</td></tr><tr><td></td><td></td><td colspan="8"><hr></hr></td></tr><tr><td></td><td></td><td align="right"><bold>IP</bold></td><td align="right">ILM</td><td align="right">pknotsRG</td><td align="right">PKNOTS</td><td align="right"><bold>IP</bold></td><td align="right">ILM</td><td align="right">pknotsRG</td><td align="right">PKNOTS</td></tr></thead><tbody><tr><td align="left">PKB115</td><td align="center">21</td><td align="right"><bold>100.00</bold></td><td align="right">66.67</td><td align="right"><bold>100.00</bold></td><td align="right">66.67</td><td align="right"><bold>100.00</bold></td><td align="right"><bold>100.00</bold></td><td align="right"><bold>100.00</bold></td><td align="right"><bold>100.00</bold></td></tr><tr><td align="left">PKB102</td><td align="center">24</td><td align="right"><bold>100.00</bold></td><td align="right">87.50</td><td align="right"><bold>100.00</bold></td><td align="right">87.50</td><td align="right">80.00</td><td align="right">77.78</td><td align="right"><bold>88.89</bold></td><td align="right">77.78</td></tr><tr><td align="left">PKB119</td><td align="center">24</td><td align="right"><bold>88.89</bold></td><td align="right">0.00</td><td align="right">77.78</td><td align="right">66.67</td><td align="right">88.89</td><td align="right">0.00</td><td align="right">87.50</td><td align="right"><bold>100.00</bold></td></tr><tr><td align="left">PKB103</td><td align="center">25</td><td align="right"><bold>100.00</bold></td><td align="right">57.14</td><td align="right">57.14</td><td align="right">42.86</td><td align="right"><bold>70.00</bold></td><td align="right">66.67</td><td align="right">50.00</td><td align="right">50.00</td></tr><tr><td align="left">PKB123</td><td align="center">26</td><td align="right"><bold>90.00</bold></td><td align="right"><bold>90.00</bold></td><td align="right">70.00</td><td align="right">60.00</td><td align="right"><bold>90.00</bold></td><td align="right"><bold>90.00</bold></td><td align="right">77.78</td><td align="right">85.71</td></tr><tr><td align="left">PKB154</td><td align="center">26</td><td align="right"><bold>100.00</bold></td><td align="right">90.00</td><td align="right"><bold>100.00</bold></td><td align="right"><bold>100.00</bold></td><td align="right"><bold>100.00</bold></td><td align="right"><bold>100.00</bold></td><td align="right"><bold>100.00</bold></td><td align="right"><bold>100.00</bold></td></tr><tr><td align="left">PKB152</td><td align="center">26</td><td align="right"><bold>100.00</bold></td><td align="right">90.00</td><td align="right"><bold>100.00</bold></td><td align="right"><bold>100.00</bold></td><td align="right"><bold>90.91</bold></td><td align="right">90.00</td><td align="right"><bold>90.91</bold></td><td align="right"><bold>90.91</bold></td></tr><tr><td align="left">PKB126</td><td align="center">27</td><td align="right"><bold>100.00</bold></td><td align="right"><bold>100.00</bold></td><td align="right"><bold>100.00</bold></td><td align="right"><bold>100.00</bold></td><td align="right"><bold>100.00</bold></td><td align="right"><bold>100.00</bold></td><td align="right"><bold>100.00</bold></td><td align="right"><bold>100.00</bold></td></tr><tr><td align="left">PKB124</td><td align="center">29</td><td align="right"><bold>100.00</bold></td><td align="right">70.00</td><td align="right"><bold>100.00</bold></td><td align="right">70.00</td><td align="right"><bold>100.00</bold></td><td align="right"><bold>100.00</bold></td><td align="right"><bold>100.00</bold></td><td align="right"><bold>100.00</bold></td></tr><tr><td align="left">PKB100</td><td align="center">31</td><td align="right"><bold>100.00</bold></td><td align="right">91.67</td><td align="right">91.67</td><td align="right"><bold>100.00</bold></td><td align="right">92.31</td><td align="right">91.67</td><td align="right">91.67</td><td align="right"><bold>100.00</bold></td></tr><tr><td align="left">PKB105</td><td align="center">32</td><td align="right"><bold>88.89</bold></td><td align="right"><bold>88.89</bold></td><td align="right"><bold>88.89</bold></td><td align="right"><bold>88.89</bold></td><td align="right">88.89</td><td align="right"><bold>100.00</bold></td><td align="right"><bold>100.00</bold></td><td align="right"><bold>100.00</bold></td></tr><tr><td align="left">PKB118</td><td align="center">33</td><td align="right"><bold>90.00</bold></td><td align="right">80.00</td><td align="right"><bold>90.00</bold></td><td align="right">80.00</td><td align="right"><bold>81.82</bold></td><td align="right">72.73</td><td align="right"><bold>81.82</bold></td><td align="right">72.73</td></tr><tr><td align="left">PKB120</td><td align="center">36</td><td align="right"><bold>100.00</bold></td><td align="right"><bold>100.00</bold></td><td align="right"><bold>100.00</bold></td><td align="right"><bold>100.00</bold></td><td align="right">85.71</td><td align="right"><bold>100.00</bold></td><td align="right"><bold>100.00</bold></td><td align="right"><bold>100.00</bold></td></tr><tr><td align="left">PKB65</td><td align="center">46</td><td align="right"><bold>93.33</bold></td><td align="right"><bold>93.33</bold></td><td align="right">0.00</td><td align="right">73.33</td><td align="right">70.00</td><td align="right"><bold>87.50</bold></td><td align="right">0.00</td><td align="right">68.75</td></tr><tr><td align="left">PKB205</td><td align="center">48</td><td align="right"><bold>23.08</bold></td><td align="right">0.00</td><td align="right"><bold>23.08</bold></td><td align="right"><bold>23.08</bold></td><td align="right">15.00</td><td align="right">0.00</td><td align="right"><bold>23.08</bold></td><td align="right"><bold>23.08</bold></td></tr><tr><td align="left">PKB147</td><td align="center">51</td><td align="right"><bold>77.78</bold></td><td align="right">55.56</td><td align="right">50.00</td><td align="right">50.00</td><td align="right"><bold>63.64</bold></td><td align="right">55.56</td><td align="right">47.37</td><td align="right">52.94</td></tr><tr><td align="left">PKB248</td><td align="center">66</td><td align="right"><bold>80.00</bold></td><td align="right">65.00</td><td align="right">35.00</td><td align="right">65.00</td><td align="right">64.00</td><td align="right"><bold>72.22</bold></td><td align="right">33.33</td><td align="right">61.90</td></tr><tr><td align="left">PKB72</td><td align="center">67</td><td align="right"><bold>100.00</bold></td><td align="right">0.00</td><td align="right">35.29</td><td align="right"><bold>100.00</bold></td><td align="right">62.96</td><td align="right">0.00</td><td align="right">31.58</td><td align="right"><bold>73.91</bold></td></tr><tr><td align="left">PKB140</td><td align="center">69</td><td align="right"><bold>73.91</bold></td><td align="right">65.22</td><td align="right">13.04</td><td align="right">43.48</td><td align="right">62.96</td><td align="right"><bold>65.22</bold></td><td align="right">15.79</td><td align="right">50.00</td></tr><tr><td align="left">PKB143</td><td align="center">71</td><td align="right">62.50</td><td align="right"><bold>91.67</bold></td><td align="right">29.17</td><td align="right">70.83</td><td align="right">48.39</td><td align="right"><bold>78.57</bold></td><td align="right">29.17</td><td align="right">68.00</td></tr><tr><td align="left">PKB144</td><td align="center">71</td><td align="right">79.17</td><td align="right"><bold>95.83</bold></td><td align="right">29.17</td><td align="right">66.67</td><td align="right">70.37</td><td align="right"><bold>95.83</bold></td><td align="right">31.82</td><td align="right">72.73</td></tr><tr><td align="left">PKB173</td><td align="center">73</td><td align="right">63.64</td><td align="right"><bold>77.27</bold></td><td align="right">36.36</td><td align="right"><bold>77.27</bold></td><td align="right">50.00</td><td align="right">68.00</td><td align="right">44.44</td><td align="right"><bold>77.27</bold></td></tr><tr><td align="left">PKB276</td><td align="center">73</td><td align="right">42.86</td><td align="right"><bold>76.19</bold></td><td align="right">33.33</td><td align="right">38.10</td><td align="right">30.00</td><td align="right"><bold>80.00</bold></td><td align="right">30.43</td><td align="right">38.10</td></tr><tr><td align="left">PKB275</td><td align="center">85</td><td align="right">65.38</td><td align="right"><bold>96.15</bold></td><td align="right">15.38</td><td align="right">50.00</td><td align="right">50.00</td><td align="right"><bold>83.33</bold></td><td align="right">15.38</td><td align="right">72.22</td></tr><tr><td align="left">PKB75</td><td align="center">88</td><td align="right">71.88</td><td align="right"><bold>93.75</bold></td><td align="right">18.75</td><td align="right">81.25</td><td align="right">62.16</td><td align="right"><bold>85.71</bold></td><td align="right">22.22</td><td align="right">81.25</td></tr><tr><td align="left">PKB76</td><td align="center">89</td><td align="right">56.00</td><td align="right"><bold>100.00</bold></td><td align="right">52.00</td><td align="right">44.00</td><td align="right">40.00</td><td align="right"><bold>69.44</bold></td><td align="right">48.15</td><td align="right">34.38</td></tr><tr><td align="left">PKB164</td><td align="center">96</td><td align="right">38.71</td><td align="right"><bold>74.19</bold></td><td align="right">48.39</td><td align="right">35.48</td><td align="right">29.27</td><td align="right"><bold>65.71</bold></td><td align="right">53.57</td><td align="right">34.38</td></tr><tr><td align="left">PKB168</td><td align="center">105</td><td align="right">61.76</td><td align="right"><bold>79.41</bold></td><td align="right">35.29</td><td align="right">76.47</td><td align="right">50.00</td><td align="right">81.82</td><td align="right">34.29</td><td align="right"><bold>86.67</bold></td></tr><tr><td align="left">PKB252</td><td align="center">110</td><td align="right">15.38</td><td align="right"><bold>97.44</bold></td><td align="right">35.90</td><td align="right"><bold>97.44</bold></td><td align="right">13.04</td><td align="right">80.85</td><td align="right">35.90</td><td align="right"><bold>92.68</bold></td></tr><tr><td align="left">PKB191</td><td align="center">113</td><td align="right">74.36</td><td align="right"><bold>82.05</bold></td><td align="right">56.41</td><td align="right">71.79</td><td align="right">61.70</td><td align="right"><bold>80.00</bold></td><td align="right">55.00</td><td align="right">73.68</td></tr><tr><td align="left">PKB135</td><td align="center">116</td><td align="right">82.05</td><td align="right"><bold>84.62</bold></td><td align="right">38.46</td><td align="right">74.36</td><td align="right">69.57</td><td align="right"><bold>84.62</bold></td><td align="right">40.54</td><td align="right">74.36</td></tr><tr><td align="left">PKB236</td><td align="center">120</td><td align="right">50.00</td><td align="right">37.50</td><td align="right">0.00</td><td align="right"><bold>67.50</bold></td><td align="right">42.55</td><td align="right">30.61</td><td align="right">0.00</td><td align="right"><bold>72.97</bold></td></tr><tr><td align="left">PKB137</td><td align="center">133</td><td align="right">70.45</td><td align="right">84.09</td><td align="right">63.64</td><td align="right"><bold>86.36</bold></td><td align="right">65.96</td><td align="right">80.43</td><td align="right">63.64</td><td align="right"><bold>86.36</bold></td></tr><tr><td align="left">PKB134</td><td align="center">137</td><td align="right">40.91</td><td align="right">59.09</td><td align="right">40.91</td><td align="right"><bold>84.09</bold></td><td align="right">33.33</td><td align="right">50.00</td><td align="right">41.86</td><td align="right"><bold>80.43</bold></td></tr><tr><td colspan="10"><hr></hr></td></tr><tr><td align="center" colspan="2">Average</td><td align="right"><bold>75.91</bold></td><td align="right">74.12</td><td align="right">54.85</td><td align="right">71.74</td><td align="right">65.40</td><td align="right">73.07</td><td align="right">54.89</td><td align="right"><bold>75.09</bold></td></tr></tbody></table></table-wrap><table-wrap position="float" id="T4"><label>Table 4</label><caption><p>Computation time of the IP-based method (<italic>&#x003c3; </italic>= 0.7) and the other algorithms. Note that it is difficult to measure the exact computation time of pknotsRG since it is provided as an interactive system, and the time listed below is a rough estimate when running pknotsRG.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="center">Seq. length</td><td align="center" colspan="4">Avg. computation time (sec.)</td></tr><tr><td></td><td colspan="4"><hr></hr></td></tr><tr><td></td><td align="right"><bold>IP</bold></td><td align="right">ILM</td><td align="right">pknotsRG</td><td align="right">PKNOTS</td></tr></thead><tbody><tr><td align="center">21&#x02013;46</td><td align="right">0.14</td><td align="right">0.05</td><td align="right">&#x0003c;1.00</td><td align="right">0.73</td></tr><tr><td align="center">48&#x02013;66</td><td align="right">16.40</td><td align="right">0.15</td><td align="right">&#x0003c;1.00</td><td align="right">24.67</td></tr><tr><td align="center">67&#x02013;137</td><td align="right">6641.53</td><td align="right">0.31</td><td align="right">&#x0003c;1.00</td><td align="right">1205.61</td></tr></tbody></table></table-wrap><p>We also tested the IP-based model with the pseudoknot-free sequences. The IP-based model with <italic>&#x003c3; </italic>= 0.7 gives 63.30% of average sensitivity and 47.89% of average specificity. Since the input data set is a set of pseudoknot-free sequences, the appropriate value of <italic>&#x003c3; </italic>should be close to 0. Hence, we tested the model with <italic>&#x003c3; </italic>&#x02208; {0.05, 0.1, 0.15, 0.2}. The results showed that <italic>&#x003c3; </italic>= 0.1 gives the best average sensitivity (72.18%) and the best average specificity (55.93%).</p></sec></sec><sec><title>Discussion</title><p>We averaged the sensitivity and specificity to examine the overall performance of each prediction method. Our IP-based method gives 75.91% sensitivity, which is the highest of the four models. For specificity, the IP-based method gives 65.40%, which is the third highest, and the best specificity is given by PKNOTS (75.09%). From Table <xref ref-type="table" rid="T3">3</xref> , it is obvious that for short sequences (less than 70 bases), the accuracy of IP is very high and at least comparable to the other algorithms. For sequences of lengths 70&#x02013;116 bases, ILM yields the highest sensitivity and specificity for most of the sequences in this group. One reason might be that some statistical information that ILM uses plays a key role in achieving good accuracy for long sequences. It is a challenge to incorporate some kind of statistical information into our IP-based method. </p><p>The reason why the IP-based method does not yield high specificity could be that when IP is being optimized, <italic>x</italic><sub><italic>ij </italic></sub>and <italic>y</italic><sub><italic>ij </italic></sub>are assigned to be 1 as many as possible because the energy parameters are negative values and the objective function is to minimize the overall energy. This results in the occurrence of a number of false positive pairs. Therefore, the specificity of our method is lower than that of the other methods.</p><p>When we observed predicted structures, we found that IP always outputs pseudoknotted structure. Although ILM and PKNOTS provide good specificity, it is not guaranteed that base pairs forming pseudoknots are always predicted, especially for short sequences (see Figure <xref ref-type="fig" rid="F5">5</xref>). Since the proportion of base pairs that constitute pseudoknots in RNA secondary structure is small compared to the total number of base pairs, the specificity of those algorithms is high.</p><fig position="float" id="F5"><label>Figure 5</label><caption><p>Comparison of predicted structure for PKB124 between the four algorithms.</p></caption><graphic xlink:href="1471-2105-10-S1-S38-5"/></fig><p>We considered using the leave-one-out strategy to verify the optimality of <italic>&#x003c3;</italic>, resulting in a drop in accuracy (70.19% average sensitivity and 60.33% average specificity). Among 34 leave-one-out experiments, there are 28 experiments where <italic>&#x003c3; </italic>= 0.70 yields the best prediction result. However, there is one experiment that gives low accuracy (11.11% sensitivity and 8.70% specificity), where PKB147 is used as a test sequence and <italic>&#x003c3; </italic>= 0.75. As a result, the average sensitivity and specificity is lower than the results shown in Table <xref ref-type="table" rid="T3">3</xref>  where we do not perform the cross validation for <italic>&#x003c3;</italic>. As stated before, <italic>&#x003c3; </italic>is a fixed weighting parameter to restrict the occurrence of base pairs that form pseudoknots. It is not necessary to train the value of <italic>&#x003c3; </italic>because our main purpose is not to optimize the <italic>&#x003c3; </italic>parameter but to test the applicability of the IP-based model to the secondary structure prediction problem. If we aim at training parameters of the prediction algorithm, we should consider not only <italic>&#x003c3; </italic>but also the other coefficients of the objective function (i.e., energy parameters), which is left as future work.</p><p>As explained in Implementation subsection, we implemented decision variables <italic>x</italic><sub><italic>ij </italic></sub>and <italic>y</italic><sub><italic>ij </italic></sub>based on two valid consecutive base pairs. It should be noted that the number of these variables is fewer than the number of original variables before the reduction (seeTable <xref ref-type="table" rid="T5">5</xref> ). Such a reduction contributes to lower memory usage, which leads to the capability of dealing with long sequences for prediction. Furthermore, we also considered three valid consecutive pairs, i.e., (<italic>s</italic><sub><italic>i</italic>-2</sub>, <italic>s</italic><sub><italic>j</italic>+2</sub>), (<italic>s</italic><sub><italic>i</italic>-1</sub>, <italic>s</italic><sub><italic>j</italic>+1</sub>), (<italic>s</italic><sub><italic>i</italic>+1</sub>, <italic>s</italic><sub><italic>j</italic>-1</sub>), and (<italic>s</italic><sub><italic>i</italic>+2</sub>, <italic>s</italic><sub><italic>j</italic>-2</sub>) for each pair of (<italic>s</italic><sub><italic>i</italic></sub>, <italic>s</italic><sub><italic>j</italic></sub>) so that we can further reduce the number of variables and can expect to increase the prediction accuracy. However, the performance using two consecutive pairs was better than using three consecutive pairs. This might reveal that reducing too many variables could make the problem harder to optimize, which results in worse prediction accuracy and more computation time. Note that in this paper we only show the results using variables on two consecutive pairs.</p><table-wrap position="float" id="T5"><label>Table 5</label><caption><p>Number of variables before and after implementing variable reduction.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="center">Seq. length</td><td align="right">21</td><td align="right">137</td></tr></thead><tbody><tr><td align="center">Before reduction</td><td align="right">12244</td><td align="right">400984</td></tr><tr><td align="center">After reduction</td><td align="right">2938</td><td align="right">117240</td></tr></tbody></table></table-wrap><p>Since actual RNA structure does not necessarily have the lowest energy, it is important to consider suboptimal structures, which might improve prediction accuracy. From this viewpoint, Zuker [<xref ref-type="bibr" rid="B21">21</xref>] proposed an efficient suboptimal folding algorithm. In our case, the optimal solution depends on how the solver (CPLEX) works out the IP problem, which is hidden to us, and thus we cannot retrieve suboptimal solutions from the solver. However, once an optimal solution (structure) is determined by the solver, we might be able to calculate some of the suboptimal structures by describing constraints where some stacking pairs are forbidden.</p></sec><sec><title>Conclusion</title><p>We proposed an integer programming (IP)-based method of predicting RNA secondary structure with a certain kind of recursive pseudoknot. Prediction tests on a set of RNA sequences were carried out, which showed good performance in accuracy for a data set of relatively small length. Furthermore, our method achieved higher average sensitivity than that of several existing prediction methods for the same test set, as well as guaranteed that base pairs involved in pseudoknots are always predicted.</p><p>We also tested the IP-based model with pseudoknot-free sequences. Although this IP formulation is specifically designed for pseudoknotted structure, the results showed that the IP-based method can also be useful in predicting secondary structure in the absence of pseudoknots. However, based on this IP formulation, we can formulate another IP-based model to predict pseudoknot-free structure and would be able to obtain better prediction accuracy.</p><p>As described before, our IP-based approach is flexible and extensible. Recall that the IP-based prediction method takes much time for long RNA sequences. In general, computation time of IP is exponential to the number of variables and thus it is important to reduce the number of variables. Although in this paper we used an IP variable (e.g., <italic>x</italic><sub><italic>ij</italic></sub>) to represent just one base pair, we would be able to define variables in such a way that they can handle larger units at a time, which results in further reduction of the number of variables. A kind of divide-and-conquer approach could also be useful where a long input sequence is divided into several subsequences of short length and then we apply the IP-based prediction method to each short subsequence. This approach will shorten the computation time, as well as increase the prediction accuracy, which is left as our future work.</p></sec><sec><title>Competing interests</title><p>The authors declare that they have no competing interests.</p></sec><sec><title>Authors' contributions</title><p>UP carried out all experiments and drafted the manuscript. YK participated in the design of the integer programming formulation and drafted the manuscript. TA conceived the idea of the work and helped to draft the manuscript. All authors read and approved the final manuscript.</p></sec></body><back><ack><sec><title>Acknowledgements</title><p>The authors gratefully acknowledge helpful discussions with Professor Hiroyuki Seki of Nara Institute of Science and Technology and Professor Kiyoshi Asai of the University of Tokyo on several points in the paper. The first author thanks the Japanese Government (Monbukagakusho: MEXT) Scholarship from the Ministry of Education, Culture, Sports, Science and Technology.</p><p>This article has been published as part of <italic>BMC Bioinformatics </italic>Volume 10 Supplement 1, 2009: Proceedings of The Seventh Asia Pacific Bioinformatics Conference (APBC) 2009. The full contents of the supplement are available online at <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/10?issue=S1"/></p></sec></ack><ref-list><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Shabalina</surname><given-names>SA</given-names></name><name><surname>Spiridonov</surname><given-names>NA</given-names></name></person-group><article-title>The mammalian transcriptome and the function of non-coding DNA sequences</article-title><source>Genome Biology</source><year>2004</year><volume>5</volume><fpage>105</fpage><pub-id pub-id-type="pmid">15059247</pub-id><pub-id pub-id-type="doi">10.1186/gb-2004-5-4-105</pub-id></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Batenburg</surname><given-names>FHDvan</given-names></name><name><surname>Gultyaev</surname><given-names>AP</given-names></name><name><surname>Pleij</surname><given-names>CWA</given-names></name><name><surname>Ng</surname><given-names>J</given-names></name><name><surname>Oliehoek</surname><given-names>J</given-names></name></person-group><article-title>PseudoBase: a database with RNA pseudoknots</article-title><source>Nucleic Acids Research</source><year>2000</year><volume>28</volume><fpage>201</fpage><lpage>204</lpage><pub-id pub-id-type="pmid">10592225</pub-id><pub-id pub-id-type="doi">10.1093/nar/28.1.201</pub-id></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Zuker</surname><given-names>M</given-names></name><name><surname>Stiegler</surname><given-names>P</given-names></name></person-group><article-title>Optimal computer folding of large RNA sequences using thermodynamics and auxiliary information</article-title><source>Nucleic Acids Research</source><year>1981</year><volume>9</volume><fpage>133</fpage><lpage>148</lpage><pub-id pub-id-type="pmid">6163133</pub-id><pub-id pub-id-type="doi">10.1093/nar/9.1.133</pub-id></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Zuker</surname><given-names>M</given-names></name></person-group><article-title>Mfold web server for nucleic acid folding and hybridization prediction</article-title><source>Nucleic Acids Research</source><year>2003</year><volume>31</volume><fpage>3406</fpage><lpage>3415</lpage><pub-id pub-id-type="pmid">12824337</pub-id><pub-id pub-id-type="doi">10.1093/nar/gkg595</pub-id></citation></ref><ref id="B5"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Rivas</surname><given-names>E</given-names></name><name><surname>Eddy</surname><given-names>SR</given-names></name></person-group><article-title>A dynamic programming algorithm for RNA structure prediction including pseudoknots</article-title><source>Journal of Molecular Biology</source><year>1999</year><volume>285</volume><fpage>2053</fpage><lpage>2068</lpage><pub-id pub-id-type="pmid">9925784</pub-id><pub-id pub-id-type="doi">10.1006/jmbi.1998.2436</pub-id></citation></ref><ref id="B6"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Reeder</surname><given-names>J</given-names></name><name><surname>Giegerich</surname><given-names>R</given-names></name></person-group><article-title>Design, implementation and evaluation of a practical pseudoknot folding algorithm based on thermodynamics</article-title><source>BMC Bioinformatics</source><year>2004</year><volume>5</volume><pub-id pub-id-type="pmid">15294028</pub-id></citation></ref><ref id="B7"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ruan</surname><given-names>J</given-names></name><name><surname>Stormo</surname><given-names>GD</given-names></name><name><surname>Zhang</surname><given-names>W</given-names></name></person-group><article-title>An iterated loop matching approach to the prediction of RNA secondary structures with pseudoknots</article-title><source>Bioinformatics</source><year>2004</year><volume>20</volume><fpage>58</fpage><lpage>66</lpage><pub-id pub-id-type="pmid">14693809</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btg373</pub-id></citation></ref><ref id="B8"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Akutsu</surname><given-names>T</given-names></name></person-group><article-title>Dynamic programming algorithms for RNA secondary structure prediction with pseudoknots</article-title><source>Discrete Applied Mathematics</source><year>2000</year><volume>104</volume><fpage>45</fpage><lpage>62</lpage><pub-id pub-id-type="doi">10.1016/S0166-218X(00)00186-4</pub-id></citation></ref><ref id="B9"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lyngs&#x000f8;</surname><given-names>RB</given-names></name><name><surname>Pedersen</surname><given-names>CNS</given-names></name></person-group><article-title>RNA pseudoknot prediction in energy-based models</article-title><source>Journal of Computational Biology</source><year>2000</year><volume>7</volume><fpage>409</fpage><lpage>427</lpage><pub-id pub-id-type="pmid">11108471</pub-id><pub-id pub-id-type="doi">10.1089/106652700750050862</pub-id></citation></ref><ref id="B10"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Uemura</surname><given-names>Y</given-names></name><name><surname>Hasegawa</surname><given-names>A</given-names></name><name><surname>Kobayashi</surname><given-names>S</given-names></name><name><surname>Yokomori</surname><given-names>T</given-names></name></person-group><article-title>Tree adjoining grammars for RNA structure prediction</article-title><source>Theoretical Computer Science</source><year>1999</year><volume>210</volume><fpage>277</fpage><lpage>303</lpage><pub-id pub-id-type="doi">10.1016/S0304-3975(98)00090-5</pub-id></citation></ref><ref id="B11"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Matsui</surname><given-names>H</given-names></name><name><surname>Sato</surname><given-names>K</given-names></name><name><surname>Sakakibara</surname><given-names>Y</given-names></name></person-group><article-title>Pair stochastic tree adjoining grammars for aligning and predicting pseudoknot RNA structures</article-title><source>Bioinformatics</source><year>2005</year><volume>21</volume><fpage>2611</fpage><lpage>2617</lpage><pub-id pub-id-type="pmid">15784748</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/bti385</pub-id></citation></ref><ref id="B12"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Rivas</surname><given-names>E</given-names></name><name><surname>Eddy</surname><given-names>SR</given-names></name></person-group><article-title>The language of RNA: a formal grammar that includes pseudoknots</article-title><source>Bioinformatics</source><year>2000</year><volume>16</volume><fpage>334</fpage><lpage>340</lpage><pub-id pub-id-type="pmid">10869031</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/16.4.334</pub-id></citation></ref><ref id="B13"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Cai</surname><given-names>L</given-names></name><name><surname>Malmberg</surname><given-names>RL</given-names></name><name><surname>Wu</surname><given-names>Y</given-names></name></person-group><article-title>Stochastic modeling of RNA pseudoknotted structures: a grammatical approach</article-title><source>Bioinformatics</source><year>2003</year><volume>19</volume><fpage>i66</fpage><lpage>i73</lpage><pub-id pub-id-type="pmid">12855439</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btg1007</pub-id></citation></ref><ref id="B14"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kato</surname><given-names>Y</given-names></name><name><surname>Seki</surname><given-names>H</given-names></name><name><surname>Kasami</surname><given-names>T</given-names></name></person-group><article-title>RNA pseudoknotted structure prediction using stochastic multiple context-free grammar</article-title><source>IPSJ Transactions on Bioinformatics</source><year>2006</year><volume>47</volume><fpage>12</fpage><lpage>21</lpage></citation></ref><ref id="B15"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Sankoff</surname><given-names>D</given-names></name></person-group><article-title>Simultaneous solution of the RNA folding, alignment and protosequence problems</article-title><source>SIAM Journal on Applied Mathematics</source><year>1985</year><volume>45</volume><fpage>810</fpage><lpage>825</lpage><pub-id pub-id-type="doi">10.1137/0145048</pub-id></citation></ref><ref id="B16"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Mathews</surname><given-names>DH</given-names></name><name><surname>Turner</surname><given-names>DH</given-names></name></person-group><article-title>Dynalign: an algorithm for finding the secondary structure common to two RNA sequences</article-title><source>Journal of Molecular Biology</source><year>2002</year><volume>317</volume><fpage>191</fpage><lpage>203</lpage><pub-id pub-id-type="pmid">11902836</pub-id><pub-id pub-id-type="doi">10.1006/jmbi.2001.5351</pub-id></citation></ref><ref id="B17"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Parisien</surname><given-names>M</given-names></name><name><surname>Major</surname><given-names>F</given-names></name></person-group><article-title>The MC-Fold and MC-Sym pipeline infers RNA structure from sequence data</article-title><source>Nature</source><year>2008</year><volume>452</volume><fpage>51</fpage><lpage>55</lpage><pub-id pub-id-type="pmid">18322526</pub-id><pub-id pub-id-type="doi">10.1038/nature06684</pub-id></citation></ref><ref id="B18"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname><given-names>J</given-names></name><name><surname>Li</surname><given-names>M</given-names></name><name><surname>Kim</surname><given-names>D</given-names></name><name><surname>Xu</surname><given-names>Y</given-names></name></person-group><article-title>RAPTOR: optimal protein threading by linear programming</article-title><source>J Bioinform Comput Biol</source><year>2003</year><volume>1</volume><fpage>95</fpage><lpage>117</lpage><pub-id pub-id-type="pmid">15290783</pub-id><pub-id pub-id-type="doi">10.1142/S0219720003000186</pub-id></citation></ref><ref id="B19"><citation citation-type="other"><article-title>ILOG CPLEX</article-title><ext-link ext-link-type="uri" xlink:href="http://www.ilog.com/products/cplex/"/></citation></ref><ref id="B20"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Griffiths-Jones</surname><given-names>S</given-names></name><name><surname>Moxon</surname><given-names>S</given-names></name><name><surname>Marshall</surname><given-names>M</given-names></name><name><surname>Khanna</surname><given-names>A</given-names></name><name><surname>Eddy</surname><given-names>SR</given-names></name><name><surname>Bateman</surname><given-names>A</given-names></name></person-group><article-title>Rfam: annotating non-coding RNAs in complete genomes</article-title><source>Nucleic Acids Res</source><year>2005</year><volume>33</volume><fpage>D121</fpage><lpage>D124</lpage><pub-id pub-id-type="pmid">15608160</pub-id><pub-id pub-id-type="doi">10.1093/nar/gki081</pub-id></citation></ref><ref id="B21"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Zuker</surname><given-names>M</given-names></name></person-group><article-title>On finding all suboptimal foldings of an RNA molecule</article-title><source>Science</source><year>1989</year><volume>244</volume><fpage>48</fpage><lpage>52</lpage><pub-id pub-id-type="pmid">2468181</pub-id><pub-id pub-id-type="doi">10.1126/science.2468181</pub-id></citation></ref></ref-list></back></article>