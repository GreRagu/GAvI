<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd"><article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article" xml:lang="EN"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id><journal-id journal-id-type="publisher-id">bioinformatics</journal-id><journal-id journal-id-type="hwp">bioinfo</journal-id><journal-title>Bioinformatics</journal-title><issn pub-type="ppub">1367-4803</issn><issn pub-type="epub">1460-2059</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">18984599</article-id><article-id pub-id-type="pmc">2638937</article-id><article-id pub-id-type="doi">10.1093/bioinformatics/btn575</article-id><article-id pub-id-type="publisher-id">btn575</article-id><article-categories><subj-group subj-group-type="heading"><subject>Applications Note</subject><subj-group><subject>Phylogenetics</subject></subj-group></subj-group></article-categories><title-group><article-title>TOPALi v2: a rich graphical interface for evolutionary analyses of multiple alignments on HPC clusters and multi-core desktops</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Milne</surname><given-names>Iain</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref><xref ref-type="corresp" rid="COR1">*</xref></contrib><contrib contrib-type="author"><name><surname>Lindner</surname><given-names>Dominik</given-names></name><xref ref-type="aff" rid="AFF1"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Bayer</surname><given-names>Micha</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Husmeier</surname><given-names>Dirk</given-names></name><xref ref-type="aff" rid="AFF1"><sup>3</sup></xref></contrib><contrib contrib-type="author"><name><surname>McGuire</surname><given-names>Gr&#x000e1;inne</given-names></name><xref ref-type="aff" rid="AFF1"><sup>3</sup></xref></contrib><contrib contrib-type="author"><name><surname>Marshall</surname><given-names>David F.</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Wright</surname><given-names>Frank</given-names></name><xref ref-type="aff" rid="AFF1"><sup>2</sup></xref></contrib></contrib-group><aff id="AFF1"><sup>1</sup>Scottish Crop Research Institute, <sup>2</sup>Biomathematics and Statistics Scotland (BioSS), SCRI, Invergowrie, Dundee DD2 5DA and <sup>3</sup>Biomathematics and Statistics Scotland (BioSS), JCMB, The King's Buildings, Edinburgh EH9 3JZ, UK</aff><author-notes><corresp id="COR1"><sup>*</sup>To whom correspondence should be addressed.</corresp><fn><p>Associate Editor: Martin Bishop</p></fn></author-notes><pub-date pub-type="ppub"><day>1</day><month>1</month><year>2009</year></pub-date><pub-date pub-type="epub"><day>4</day><month>11</month><year>2008</year></pub-date><pub-date pub-type="pmc-release"><day>4</day><month>11</month><year>2008</year></pub-date><volume>25</volume><issue>1</issue><fpage>126</fpage><lpage>127</lpage><history><date date-type="received"><day>2</day><month>8</month><year>2008</year></date><date date-type="rev-recd"><day>3</day><month>11</month><year>2008</year></date><date date-type="accepted"><day>3</day><month>11</month><year>2008</year></date></history><permissions><copyright-statement>&#x000a9; 2008 The Author(s)</copyright-statement><copyright-year>2008</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/"><p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">http://creativecommons.org/licenses/by-nc/2.0/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</p></license></permissions><abstract><p><bold>Summary:</bold> TOPALi v2 simplifies and automates the use of several methods for the evolutionary analysis of multiple sequence alignments. Jobs are submitted from a Java graphical user interface as TOPALi web services to either run remotely on high-performance computing clusters or locally (with multiple cores supported). Methods available include model selection and phylogenetic tree estimation using the Bayesian inference and maximum likelihood (ML) approaches, in addition to recombination detection methods. The optimal substitution model can be selected for protein or nucleic acid (standard, or protein-coding using a codon position model) data using accurate statistical criteria derived from ML co-estimation of the tree and the substitution model. Phylogenetic software available includes PhyML, RAxML and MrBayes.</p><p><bold>Availability:</bold> Freely downloadable from <ext-link ext-link-type="uri" xlink:href="http://www.topali.org">http://www.topali.org</ext-link> for Windows, Mac OS X, Linux and Solaris.</p><p><bold>Contact:</bold> <email>iain.milne@scri.ac.uk</email></p></abstract></article-meta></front><body><sec sec-type="intro" id="SEC1"><title>1 INTRODUCTION</title><p>The statistical revolution in molecular phylogenetics (Felsenstein, <xref ref-type="bibr" rid="B3">2001</xref>) continues to gather pace with the development of faster and/or more sophisticated maximum likelihood (ML) and Bayesian inference methods, with recent software implementations including PhyML (Guindon and Gascuel, <xref ref-type="bibr" rid="B4">2003</xref>), RAxML (Stamatakis, <xref ref-type="bibr" rid="B9">2006</xref>) and MrBayes (Ronquist and Huelsenbeck, <xref ref-type="bibr" rid="B7">2003</xref>). To fully utilize these methods, it is also important to select a model of evolution with an appropriate level of complexity for the dataset by making use of model selection procedures, e.g. as in the ModelTest software (Posada and Crandall, <xref ref-type="bibr" rid="B6">1998</xref>). However, there are opportunities for improved practice in model testing, particularly for protein-coding DNA where appropriate models for each codon position (CP) are usually required (Bofkin and Goldman, <xref ref-type="bibr" rid="B1">2007</xref>) and are often underused (Shapiro <italic>et al.</italic>, <xref ref-type="bibr" rid="B8">2005</xref>). While biologists are being encouraged to adopt these improved methods (Whelan <italic>et al.</italic>, <xref ref-type="bibr" rid="B10">2000</xref>), there are still obstacles, including the lack of a single easy-to-use interface for analyzing a multiple sequence alignment (MSA) with a range of methods (e.g. model selection and phylogenetic tree estimation) and sophisticated access to computer power. While computational resources are becoming available for phylogenetic analysis (e.g. Dereeper <italic>et al.</italic>, <xref ref-type="bibr" rid="B2">2008</xref>), the interfaces available are basic and analysis options are often not stored for amendment.</p><p>TOPALi (tree TOPology-related analysis of ALignments Interface) version 1 (Milne <italic>et al.</italic>, <xref ref-type="bibr" rid="B5">2004</xref>) specialized in the detection of recombination in an MSA and ran only on desktops. We have extended and redesigned TOPALi to carry out additional analyses, particularly automated model selection linked to phylogenetic analyses, resulting in rich graphical output, and to utilize, via a sophisticated interface with access to previous option choices, the increased power of high performance computing (HPC) clusters and multi-core desktops. In particular, TOPALi v2 reduces the learning curve for biologists to carry out high quality phylogenetic analyses, by hiding the complexities of setting up and running many analyses.</p></sec><sec id="SEC2"><title>2 FEATURES</title><p><bold>Alignment handling:</bold> TOPALi can import/export DNA, RNA and protein MSAs in many formats and create DNA alignments from a protein MSA and corresponding unaligned DNA. Several MSAs can be stored within a TOPALi project allowing working with a group of related MSAs. TOPALi can quickly render alignments facilitating quality checks: the alignment overview shows the relative position of the zoomed region to the full alignment. The user can semi-automatically or manually select a reduced number of sequences for analysis and can also restrict the columns, e.g. exons could be extracted from a genomic alignment and saved as a new alignment.</p><p><bold>Model selection:</bold> the menu launches models available in MrBayes (24 nucleotide models, 36 amino acid models) or in PhyML (56 and 40, respectively) or in RAxML (no nucleotide model choice, 40 amino acid models). The optimal model is automatically selected (and passed to the phylogenetic analysis launch menus) based on calculations involving either hierarchical likelihood ratio tests (hLRTs), Akaike information criterion (AIC), or Bayesian information criterion (BIC), generally following the ModelTest approach, except that (i) the model parameters (substitution, rate heterogeneity) and the phylogenetic tree are estimated by running a separate PhyML job for each model resulting in more accurate estimates of the log likelihood and derived quantities (AIC, BIC) and (ii) the hLRT tests among the 56 PhyML nucleotide models are based on single pairwise LRT tests. CP model selection treats the coding region as three separate alignments. Model components that are similar across CPs can be linked to share parameter estimation in subsequent MrBayes analysis.</p><p><bold>Phylogenetic tree estimation:</bold> web services run the MrBayes, PhyML and RAxML programs on either nucleotide or protein MSAs. For nucleotide data, MrBayes analysis can use a model for all positions or a CP model. The user then accepts, or overrules the model selection choices and enters the MrBayes analyses settings (nRuns, nGenerations, Sample Frequency and Burn-in percentage). For ML analysis, PhyML offers only one model for all positions, so the user accepts or overrules the model selection choice and analysis settings (including number of bootstrap runs). RAxML has three rate heterogeneity models (including the Gamma distribution) but only one parameter-rich model (GTR) for nucleotide analysis, although the model parameters can be estimated separately for each CP. Tree manipulation tools include midpoint rooting and editing to simplify the display of support values.</p></sec><sec id="SEC3"><title>3 IMPLEMENTATION</title><p>TOPALi's analysis methods have been designed to run either on remote HPC clusters (the default setting), or on standard desktops. With no underlying code duplication, we have devised a novel approach that runs tasks as independent processes within their own Java Virtual Machine (when executed on separate cluster nodes), or as semi-independent processes within a typical multithreaded application (when running on a desktop), managed by a local process manager that sets the number of CPUs to be used.</p><p>In addition to the obvious speed benefits, HPC usage also eliminates any compilation or configuration issues a user may encounter when running jobs locally as some sub-components of the analyses are handled by C or C++ programs from third parties, and must therefore be compiled for local use.</p><p>TOPALi is designed to be user-friendly and thus includes functionality that allows the user to work with a project locally (loading or examining alignments for instance) and then to submit one or more analysis jobs for remote processing. The client can be closed and reopened later, and the progress of the jobs will be updated from the server. Previously, completed jobs can also be reselected and a new job submission can be created that mirrors the settings from the original job, with or without further modifications.</p><p>Making use of a newly developed web services resource broker (I.Milne <italic>et al.</italic>, manuscript in preparation), TOPALi queries the broker monitoring a pool of remote HPC clusters hosting TOPALi web services (currently at the Scottish Crop Research Institute and University of Dundee) that can then intelligently decide which cluster is most suitable for the job. We can also manage load by rejecting jobs submitted with very high numbers of sequences (on a per analysis basis). Readers who are interested in hosting TOPALi services on their own Sun Grid Engine enabled cluster (either for private or further public use) may contact us for advice on configuration.<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>TOPALi's main interface showing alignment handling, tree estimation and model selection features.</p></caption><graphic xlink:href="btn575f1"/></fig></p><p>TOPALi is coded in Java for platforms supporting Java version 1.5.0 and above. We provide installable versions with everything required to run the application, including a suitable Java runtime.</p><p><italic>Funding</italic>: UK BBSRC/EPSRC Bioinformatics/E-science Initiative (BBSB16615); the Scottish Government; Scottish Funding Council; Scottish Enterprise.</p><p><italic>Conflict of Interest</italic>: none declared.</p></sec></body><back><ref-list><title>REFERENCES</title><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Bofkin</surname><given-names>L</given-names></name><name><surname>Goldman</surname><given-names>N</given-names></name></person-group><article-title>Variation in evolutionary processes at different codon positions</article-title><source>Mol. Biol. Evol.</source><year>2007</year><volume>24</volume><fpage>513</fpage><lpage>521</lpage><pub-id pub-id-type="pmid">17119011</pub-id></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Dereeper</surname><given-names>A</given-names></name><etal/></person-group><article-title>Phylogeny.fr: robust phylogenetic analysis for the non-specialist</article-title><source>Nucl. Acids Res.</source><year>2008</year><volume>36</volume><fpage>W465</fpage><lpage>W469</lpage><pub-id pub-id-type="pmid">18424797</pub-id></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Felsenstein</surname><given-names>J</given-names></name></person-group><article-title>The troubled growth of statistical phylogenetics</article-title><source>Syst. Biol.</source><year>2001</year><volume>50</volume><fpage>465</fpage><lpage>467</lpage><pub-id pub-id-type="pmid">12116645</pub-id></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Guindon</surname><given-names>S</given-names></name><name><surname>Gascuel</surname><given-names>O</given-names></name></person-group><article-title>A simple, fast and accurate algorithm to estimate large phylogenies by maximum likelihood</article-title><source>Syst. Biol.</source><year>2003</year><volume>52</volume><fpage>696</fpage><lpage>704</lpage><pub-id pub-id-type="pmid">14530136</pub-id></citation></ref><ref id="B5"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Milne</surname><given-names>I</given-names></name><etal/></person-group><article-title>TOPALi: software for automatic identification of recombinant sequences within DNA multiple alignments</article-title><source>Bioinformatics</source><year>2004</year><volume>20</volume><fpage>1806</fpage><lpage>1807</lpage><pub-id pub-id-type="pmid">14988107</pub-id></citation></ref><ref id="B6"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Posada</surname><given-names>D</given-names></name><name><surname>Crandall</surname><given-names>KA</given-names></name></person-group><article-title>Modeltest: testing the model of DNA substitution</article-title><source>Bioinformatics</source><year>1998</year><volume>14</volume><fpage>817</fpage><lpage>818</lpage><pub-id pub-id-type="pmid">9918953</pub-id></citation></ref><ref id="B7"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ronquist</surname><given-names>F</given-names></name><name><surname>Huelsenbeck</surname><given-names>JP</given-names></name></person-group><article-title>MrBayes 3: Bayesian phylogenetic inference under mixed models</article-title><source>Bioinformatics</source><year>2003</year><volume>19</volume><fpage>1572</fpage><lpage>1574</lpage><pub-id pub-id-type="pmid">12912839</pub-id></citation></ref><ref id="B8"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Shapiro</surname><given-names>B</given-names></name><etal/></person-group><article-title>Choosing appropriate substitution models for the phylogenetic analysis of protein-coding sequences</article-title><source>Mol. Biol. Evol.</source><year>2006</year><volume>23</volume><fpage>7</fpage><lpage>9</lpage><pub-id pub-id-type="pmid">16177232</pub-id></citation></ref><ref id="B9"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Stamatakis</surname><given-names>A</given-names></name></person-group><article-title>RaxML-VI-HPC: maximum likelihood-based phylogenetic analyses with thousands of taxa and mixed models</article-title><source>Bioinformatics</source><year>2006</year><volume>22</volume><fpage>2688</fpage><lpage>2690</lpage><pub-id pub-id-type="pmid">16928733</pub-id></citation></ref><ref id="B10"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Whelan</surname><given-names>S</given-names></name><etal/></person-group><article-title>Molecular phylogenetics: state-of-the-art methods for looking into the past</article-title><source>Trends Genet.</source><year>2000</year><volume>17</volume><fpage>262</fpage><lpage>272</lpage><pub-id pub-id-type="pmid">11335036</pub-id></citation></ref></ref-list></back></article>