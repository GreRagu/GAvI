<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd"><article xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id><journal-title>BMC Bioinformatics</journal-title><issn pub-type="epub">1471-2105</issn><publisher><publisher-name>BioMed Central</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">19208195</article-id><article-id pub-id-type="pmc">2646249</article-id><article-id pub-id-type="publisher-id">1471-2105-10-S2-S7</article-id><article-id pub-id-type="doi">10.1186/1471-2105-10-S2-S7</article-id><article-categories><subj-group subj-group-type="heading"><subject>Proceedings</subject></subj-group></article-categories><title-group><article-title>Phenotype forecasting with SNPs data through gene-based Bayesian networks</article-title></title-group><contrib-group><contrib id="A1" equal-contrib="yes" contrib-type="author"><name><surname>Malovini</surname><given-names>Alberto</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>alberto.malovini@unipv.it</email></contrib><contrib id="A2" equal-contrib="yes" contrib-type="author"><name><surname>Nuzzo</surname><given-names>Angelo</given-names></name><xref ref-type="aff" rid="I2">2</xref><email>angelo.nuzzo@unipv.it</email></contrib><contrib id="A3" contrib-type="author"><name><surname>Ferrazzi</surname><given-names>Fulvia</given-names></name><xref ref-type="aff" rid="I2">2</xref><email>fulvia.ferrazzi@unipv.it</email></contrib><contrib id="A4" contrib-type="author"><name><surname>Puca</surname><given-names>Annibale A</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>annibale.puca@multimedica.it</email></contrib><contrib id="A5" corresp="yes" contrib-type="author"><name><surname>Bellazzi</surname><given-names>Riccardo</given-names></name><xref ref-type="aff" rid="I2">2</xref><email>riccardo.bellazzi@unipv.it</email></contrib></contrib-group><aff id="I1"><label>1</label>IRCCS Multimedica, Via Fantoli 16/15, I-20138 Milano, Italy</aff><aff id="I2"><label>2</label>Department of Computer Engineering and Systems Science, University of Pavia, via Ferrata 1, I-27100, Pavia, Italy</aff><pub-date pub-type="collection"><year>2009</year></pub-date><pub-date pub-type="epub"><day>5</day><month>2</month><year>2009</year></pub-date><volume>10</volume><issue>Suppl 2</issue><supplement><named-content content-type="supplement-title">Selected Proceedings of the First Summit on Translational Bioinformatics 2008</named-content><named-content content-type="supplement-editor">Atul J Butte, Indra Neil Sarkar, Marco Ramoni, Yves Lussier and Olga Troyanskaya</named-content></supplement><fpage>S7</fpage><lpage>S7</lpage><ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/10/S2/S7"/><permissions><copyright-statement>Copyright &#x000a9; 2009 Malovini et al; licensee BioMed Central Ltd.</copyright-statement><copyright-year>2009</copyright-year><copyright-holder>Malovini et al; licensee BioMed Central Ltd.</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0"><p>This is an open access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p><!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>               Malovini               Alberto                              alberto.malovini@unipv.it            </dc:author><dc:title>            Phenotype forecasting with SNPs data through gene-based Bayesian networks         </dc:title><dc:date>2009</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 10(Suppl 2): S7-. (2009)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2009)10:Suppl 2&#x0003c;S7&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>--></license></permissions><abstract><sec><title>Background</title><p>Bayesian networks are powerful instruments to learn genetic models from association studies data. They are able to derive the existing correlation between genetic markers and phenotypic traits and, at the same time, to find the relationships between the markers themselves. However, learning Bayesian networks is often non-trivial due to the high number of variables to be taken into account in the model with respect to the instances of the dataset. Therefore, it becomes very interesting to use an abstraction of the variable space that suitably reduces its dimensionality without losing information. In this paper we present a new strategy to achieve this goal by mapping the SNPs related to the same gene to one meta-variable. In order to assign states to the meta-variables we employ an approach based on classification trees.</p></sec><sec><title>Results</title><p>We applied our approach to data coming from a genome-wide scan on 288 individuals affected by arterial hypertension and 271 nonagenarians without history of hypertension. After pre-processing, we focused on a subset of 24 SNPs. We compared the performance of the proposed approach with the Bayesian network learned with SNPs as variables and with the network learned with haplotypes as meta-variables. The results were obtained by running a hold-out experiment five times. The mean accuracy of the new method was 64.28%, while the mean accuracy of the SNPs network was 58.99% and the mean accuracy of the haplotype network was 54.57%.</p></sec><sec><title>Conclusion</title><p>The new approach presented in this paper is able to derive a gene-based predictive model based on SNPs data. Such model is more parsimonious than the one based on single SNPs, while preserving the capability of highlighting predictive SNPs configurations. The prediction performance of this approach was consistently superior to the SNP-based and the haplotype-based one in all the test sets of the evaluation procedure. The method can be then considered as an alternative way to analyze the data coming from association studies.</p></sec></abstract><conference><conf-date>10&#x02013;12 March 2008</conf-date><conf-name>The First Summit on Translational Bioinformatics 2008</conf-name><conf-loc>San Francisco, CA, USA</conf-loc></conference></article-meta></front><body><sec><title>Background</title><p>Genetic association studies are a powerful method to assess correlations between genetic variants and traits differences occurring in a population. When a significant correlation arises with respect to a pathological trait, these studies may lead to the identification of candidate disease susceptibility genes, offering the promise of novel targets for therapeutic treatments. Nowadays, high-throughput genotype technologies allow a genome wide approach to these studies, taking into account hundreds of thousands of different markers [<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B2">2</xref>]. Standard statistics is usually applied to this data to extract univariate models and find significant markers with univariate tests. However, together with deriving the existing correlation between genetic markers and phenotypic traits it is also extremely interesting to find the relations between the markers themselves. Both aims can be effectively achieved by using Bayesian networks (BNs) [<xref ref-type="bibr" rid="B3">3</xref>]. BNs represent probabilistic relationships between random variables by means of a directed acyclic graph and a set of conditional probability distributions. Nodes in the graph correspond to variables and directed arcs represent dependencies between them. A conditional probability distribution is associated with each node and quantifies the dependency of the node on its parents, i.e. the nodes that have an arc directly pointing to it.</p><p>BNs have already been successfully applied in association studies, for example to study overt stroke in sickle cell anaemia [<xref ref-type="bibr" rid="B4">4</xref>] and to identify the relationships between SNP variations in the human <italic>APOE </italic>gene and plasma apolipoprotein E levels [<xref ref-type="bibr" rid="B5">5</xref>].</p><p>When performing an association study, the data typically consist of measurements for a set of genetic markers (SNPs) and evidence for a certain number of phenotypic traits (such as disease status, age, sex...). Each genetic marker is modelled as a random variable taking on one of three possible states: 'AA', which corresponds to homozygous for the minor allele, 'Aa', heterozygous, and 'aa', homozygous for the major allele. Each phenotypic trait is also represented by a random variable, such as 'affected' and 'unaffected' for the disease status. An example of BN modelling the relationships between 4 SNPs and a phenotypic trait is given in Figure <xref ref-type="fig" rid="F1">1</xref>. This network not only models the relationships between the phenotype and SNPs, but it also represents conditional independence assumptions between variables. Referring to the Figure, we can for example say that the phenotype is conditionally independent of SNP<sub>3 </sub>and SNP<sub>4 </sub>given SNP<sub>2</sub>: this means that, if the value for SNP<sub>2 </sub>is known, the phenotypic status does not depend on the values of SNP<sub>3 </sub>and SNP<sub>4</sub>. Thus, the BN can highlight potential key markers in phenotype prediction.</p><fig position="float" id="F1"><label>Figure 1</label><caption><p><bold>Example of Bayesian network representing the dependencies between a Phenotype and 4 SNPs</bold>. On the left, the directed acyclic graph of the BN; on the right the conditional probabilities tables associated with each node.</p></caption><graphic xlink:href="1471-2105-10-S2-S7-1"/></fig><p>Both the graphical structure of a BN and the parameters of the conditional probability distributions can be learned from the available data. However, learning these networks is often non-trivial due to the high number of variables to be taken into account in the model, with respect to the instances of the dataset. Therefore, it becomes very interesting to use an abstraction of the variable space that suitably reduces its dimensionality without losing information. Thanks to this abstraction, a more parsimonious model might be built, whose graphical connections are also more easily interpretable. As the final aim of genetic dissection studies is to identify how genes affect the phenotype, we decided to consider the set of SNPs mapping to the same gene as a new meta-variable. In order to assign states to the meta-variables we employed an approach based on classification trees. By learning a classification tree for the SNPs mapping to each gene, it is possible to identify the most relevant combination of SNP values to predict the phenotypic status. Once the meta-variables have been identified, a BN is built using them and the phenotype as nodes.</p><p>We applied our method to genotypic data measured in a group of patients affected by arterial hypertension and in a group of nonagenarians without history of hypertension. The ability of the BN inferred on the meta-variables to correctly predict the phenotype (hypertension) is quantitatively assessed and compared with that achievable with a BN built using single SNPs.</p></sec><sec sec-type="methods"><title>Methods</title><p>Our goal is to build a model to estimate the probability of a phenotypic trait given the genotype of an individual, represented as a suitable collection of SNPs. When learning this model from data, we also want to extract the relationships between SNPs and highlight the potential role of the genes associated to the SNPs. To this end, it is possible to resort to classification algorithms, in which the phenotype is the class and the SNPs (and potentially other interesting variables, such as sex and age) are the predictive attributes.</p><p>Our strategy is made of two main steps: i) generation of meta-variables corresponding to each gene by using an approach based on classification trees, ii) learning of a BN in which the nodes are the meta-variables and the phenotype.</p><p>Classification trees (CTs) are one of the most largely used classification tools [<xref ref-type="bibr" rid="B6">6</xref>]. Given a database of <italic>n </italic>cases, each containing the values for <italic>v </italic>attributes and a class <italic>c</italic>, a CT learned from this database graphically represents a set of rules that allow the classification of each case on the basis of its attribute values (Figure <xref ref-type="fig" rid="F2">2</xref>). A test on the value of an attribute is associated with every non-leaf node of the tree and a branch descends from this node for every possible value taken by the attribute; leaf nodes are instead associated with a class value. Therefore the path going from the root node to a leaf node can be mapped into a classification rule of the kind "<italic>if </italic>attribute_A = a<sub>1 </sub>and attribute_B = b<sub>2 </sub>and attribute_C = c<sub>1 </sub><italic>then </italic>class = c<sub>i</sub>".</p><fig position="float" id="F2"><label>Figure 2</label><caption><p><bold>Classification tree for meta-variable state assignment</bold>. Example of classification tree used to infer the possible states of the meta-variable associated with gene C, represented by two SNPs, C1 and C2. OR = "Odds Ratio".</p></caption><graphic xlink:href="1471-2105-10-S2-S7-2"/></fig><p>Bayesian networks [<xref ref-type="bibr" rid="B7">7</xref>] are a formalism for the representation and use of probabilistic knowledge widely employed in various fields, such as Artificial Intelligence, Statistics, and more recently Bioinformatics. As mentioned in the Background Section, a BN consists of two main components, a directed acyclic graph and a set of probability distributions. While the graph qualitatively describes dependence relationships between variables, a conditional probability distribution is associated with each node X<sub>i </sub>and quantifies the probabilistic dependence of the node on its parents pa(X<sub>i</sub>). A very interesting property of BNs is the fact that the joint probability distribution of all variables can be expressed as the product of these conditional distributions (chain rule): <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" name="1471-2105-10-S2-S7-i1" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mn>...</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>&#x0220f;</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:semantics></mml:math></inline-formula>. Once a BN is learned it is possible to use it to perform probabilistic inference, i.e. to calculate the posterior probabilities of unobserved variables on the basis of evidence on the values of other variables in the network [<xref ref-type="bibr" rid="B8">8</xref>]. A BN can thus be employed for classification purposes, allowing the prediction of the most probable value for a class node once the values of some attributes are known.</p><p>In the following of this section we describe how we employ CTs to generate meta-variables and how we learn BNs on the generated variables.</p><sec><title>Meta-variables generation</title><p>There are different available algorithms to learn a classification tree from a dataset. Partitioning algorithms recursively split the tree by choosing the "most informative" attribute, i.e. the attribute that better separates instances with respect to their class value. These algorithms usually implement some "pruning" strategies, i.e. they remove leaves corresponding to negligible improvements in the classification performance. Pruning helps avoiding overfitting and thus helps improving the tree's ability to classify new instances not used to generate the tree.</p><p>CTs allow us to find rules to assign state values to meta-variables. Our procedure is performed with the following steps:</p><p>1. Select the set of SNPs S<sub><italic>i </italic></sub>mapping to the <italic>i</italic>-th gene (see "Data collection and pre-processing" section for SNPs annotation details).</p><p>2. Learn a classification tree using the phenotype to be forecast as class and the set S<sub><italic>i </italic></sub>as attributes. To this aim, we employed the C4.5 algorithm [<xref ref-type="bibr" rid="B9">9</xref>].</p><p>3. Prune the tree according to the following rules:</p><p>a. Apply minimal error pruning with m-estimate [<xref ref-type="bibr" rid="B10">10</xref>] and equal prior probability for each class. In the following all the results have been obtained with m = 8.</p><p>b. Remove leaves containing a number of instances lower than 1% of the total number of individuals (in our case, 5 instances).</p><p>c. Check the total number of meta-variable states that remain after pruning steps a and b: if there are more than 5 states, cut the subtree with the lowest number of instances.</p><p>4. Create a discrete variable G<sub><italic>i </italic></sub>with states corresponding to the leaves of the final pruned tree.</p><p>As an example, suppose having a gene C represented by two SNPs (C1 and C2), each taking three possible values ("AA" and "BB" stand for homozygous for the minor allele, "Aa" and "Bb" stand for heterozygous, "aa" and "bb" for homozygous for the major allele). Suppose also that the classification tree corresponding to gene C is shown in Figure <xref ref-type="fig" rid="F2">2</xref>.</p><p>Looking at the leaf nodes we can derive three rules to assign state values to the meta-variable for gene C, each one dependent on combinations of the two SNPs values: <italic>if </italic>"C1 = AA and C2 = BB" <italic>then </italic>State1; <italic>if </italic>"(C1 = Aa or C1 = aa) and C2 = BB" <italic>then </italic>State2; <italic>if </italic>"C2 = Bb or C2 = bb" <italic>then </italic>State3.</p><p>The classification trees were learned using the software Orange [<xref ref-type="bibr" rid="B11">11</xref>].</p></sec><sec><title>BN learning</title><p>Learning BNs can be approached as a model selection problem, in which different network models are compared on the basis of their posterior probability with respect to the available data. Thanks to the decomposability of the joint probability of all variables, the network with highest posterior can be learned by learning local models, i.e. the parent sets of each variable, and then joining the inferred models. However, the number of possible models to be explored grows exponentially with respect to the number of candidate parents. For this reason, an exhaustive search is unfeasible and a heuristic strategy must be employed. An effective one is the greedy search strategy known as K2 algorithm [<xref ref-type="bibr" rid="B12">12</xref>]. This algorithm requires the specification of an ordering of the analyzed variables, so that the parents of each variable are searched only among those variables that precede it in the ordering. We decided to use the gain ratio of variables (i.e. the information gain divided by the variable's entropy [<xref ref-type="bibr" rid="B6">6</xref>]) to establish the ordering to be given as input to the K2 algorithm. In this way, variables with higher gain ratio were tested as parents of those with lower ratios. Moreover, we focused on networks in which the genotypes are dependent on the phenotype, in accordance with Sebastiani et al. [<xref ref-type="bibr" rid="B4">4</xref>].</p><p>In order to infer BNs from data we employed the software Bayesware Discoverer [<xref ref-type="bibr" rid="B13">13</xref>], which implements the K2 algorithm for the search.</p></sec></sec><sec><title>Results and discussion</title><p>We applied our approach to data coming from a genome-wide scan on 288 individuals affected by arterial hypertension (AH) and 271 nonagenarians without history of AH. Arterial hypertension is considered a polygenic disease, resulting from the combination of a number of genetic risk factors, whose expression depends on their interaction with environmental factors such as high dietary intake of sodium, alcohol, obesity and stress [<xref ref-type="bibr" rid="B14">14</xref>].</p><p>The number of alleles and polygenes contributing to the phenotype of elevated arterial blood pressure (BP) is still unknown; however, experiments in inbred rats suggest that about ten or more genes might contribute to the control of BP [<xref ref-type="bibr" rid="B15">15</xref>]. Moreover, although the number of genes influencing BP is not known, it is expected that many alleles at different loci may contribute to the ultimate disease trait. In agreement with these observations, linkage and association analyses have shown that BP is not due to a single genetic variant [<xref ref-type="bibr" rid="B15">15</xref>]. Our multivariate method thus appears particularly suitable to analyze this kind of data. In the following we describe in more details data collection, pre-processing and obtained results.</p><sec><title>Data collection and pre-processing</title><p>288 patients with high BP and aged 35&#x02013;55 years were recruited; the control population was represented by 271 nonagenarians, without history of AH and selected during the course of the last few years. After approval of the ethical committee and under informed consent collected following the Italian law, blood was drawn from every patient participating in the study. DNA was extracted and anamnestic, clinical and laboratory data were collected. All samples were assayed with the Illumina HumanHap300Duo bead chips (Illumina, San Diego, CA, USA) containing 318,237 Phase I HapMap tagging SNPs. Data were acquired with Illumina Bead Studio Software (Illumina); afterwards, standard preliminary analysis was performed with gPLINK [<xref ref-type="bibr" rid="B16">16</xref>] as follows: i) genotyping/missing rate statistics were calculated; ii) the minor allele frequency (MAF) was calculated; iii) Hardy Weinberg Equilibrium (HWE) was evaluated; iv) SNPs with HWE values in the control population deviating from the equilibrium (p-value &#x0003c; 0.001) were removed. In order to identify and remove outliers, we performed a multidimensional scaling plot (MDS plot) and a neighbors plot, based on the genome-wide identity-by-state (IBS) information.</p><p>After data pre-processing, we performed both allelic and genotypic association tests to compare frequencies distribution between cases and controls and identify the most significant SNPs. Allelic association tests yielded 93 highly significant SNPs (p &#x0003c; 10<sup>-4</sup>, corrected for permutation tests). P-values given by genotypic association tests confirmed the same results as the allelic association tests.</p><p>SNP annotation was performed using <italic>Genephony</italic>, an online tool for genomic dataset annotation [<xref ref-type="bibr" rid="B17">17</xref>]: a SNP is annotated to a gene if it is located in a 10 Kb region around the coding sequence. Selecting only those genes represented by at least two SNPs, we focused on a subset of 24 SNPs mapping to 9 different genes. Thus the final dataset to be analyzed consisted of 559 individuals (288 cases and 271 controls) and the 24 selected SNPs. Since such results still have to be biologically validated, in the following we will denote genes by letters and SNPs by numbers, so that for example "D3" represents SNP number 3 of gene D.</p></sec><sec><title>Bayesian networks for arterial hypertension prediction</title><p>We first learned a Bayesian network using single SNPs as variables and employing the whole dataset. In this network SNPs within each gene appear tightly connected (Figure <xref ref-type="fig" rid="F3">3</xref>). This is probably due to the fact that SNPs mapping to the same gene present highly correlated configurations and thus the BN learning algorithm correctly infers a direct dependence between them. This result supports the hypothesis that considering the SNPs mapping to the same gene as a unique meta-variable is an appropriate way to make an abstraction of the network structure without losing information. Hypertension is connected to 3 genes, and, among the SNPs within each gene, it is always directly connected to the SNP with the largest gain ratio.</p><fig position="float" id="F3"><label>Figure 3</label><caption><p><bold>SNP-based BN learned using the whole dataset</bold>. Bayesian network learned on the whole dataset using single SNPs as variables.</p></caption><graphic xlink:href="1471-2105-10-S2-S7-3"/></fig><p>We then associated each gene to a meta-variable, whose states were derived by building a classification tree according to the procedure outlined in the Methods section. In the network built using the meta-variables (Figure <xref ref-type="fig" rid="F4">4</xref>) the phenotype is directly connected to the same genes as in the network learned with all SNPs. Moreover the indirect path gene A &#x02013; hypertension &#x02013; gene C &#x02013; gene G, identifiable in the single-SNP network, is conserved in the meta-variable BN. Therefore, the use of meta-variables appears able to summarize the relationships between genes and phenotype with little loss of information.</p><fig position="float" id="F4"><label>Figure 4</label><caption><p><bold>Meta-variable BN learned using the whole dataset</bold>. Bayesian network learned on the whole dataset using meta-variables associated to each gene.</p></caption><graphic xlink:href="1471-2105-10-S2-S7-4"/></fig></sec><sec><title>Predictive ability of the networks</title><p>Bayesian networks allow the prediction of the most likely value for any node given the values of any group of other nodes. In our case, we are interested in assessing the ability of the learned BN models to predict the phenotype status given a certain configuration of SNPs or meta-variables.</p><p>The single-SNP network (Figure <xref ref-type="fig" rid="F3">3</xref>) and the meta-variable network (Figure <xref ref-type="fig" rid="F4">4</xref>) built on the whole dataset have a predictive accuracy (training accuracy) equal to 62.79% and to 64.22%, respectively. We compared these values with respect to the majority classifier performance, which had a classification accuracy of 51.52%. A normalized measure of how much those accuracies differ from the majority classifier is given by the k-statistic, which is 0.1541 for the SNP network and 0.2632 for the meta-variable one. Thus, the ability to predict the true phenotypic status of the meta-variable network appears to be slightly superior. However, as training accuracy is affected by overfitting, it is much more interesting to evaluate the capability of the models to correctly predict the unknown phenotype of a new sample of data (generalization accuracy). In order to obtain an estimate of the generalization accuracy, we repeated 5 times a random sampling hold-out scheme in which 75% of the dataset (419 individuals) was employed as training set and the remaining 25% as test set (140 individuals). The sampling was performed with stratification, so that both the training and the test set have the same distribution of phenotypic classes as the entire dataset. Thus, the validation scheme we performed 5 times can be summarized as:</p><p>&#x02022; Split the dataset into 75% training and 25% test</p><p>&#x02022; On the training set:</p><p>&#x025e6; Learn the meta-variables according to the strategy presented in the Methods section;</p><p>&#x025e6; Learn a BN using the gain ratio of meta-variables as ordering for the K2 algorithm.</p><p>&#x02022; On the test set:</p><p>&#x025e6; Map the SNPs of the test set into meta-variables and assign the states using the rules derived on the training set;</p><p>&#x025e6; Compute the accuracy of phenotype prediction given all the meta-variables.</p><p>The mean accuracy on the 5 test sets was equal to 64.28% (Table <xref ref-type="table" rid="T1">1</xref>). As a benchmark for our method, we used the BN with SNPs as variables, learned and evaluated on the corresponding test set. The mean accuracy of the SNPs BNs was 58.99%. Moreover, as reported in Table <xref ref-type="table" rid="T1">1</xref>, the accuracy of the meta-variable network was always higher than the accuracy of the SNP network on the same test set, suggesting that our method is able to achieve a better classification performance. The k-statistic computed on each test set is also higher for the meta-variable networks. To confirm these results, we computed the 95%-confidence intervals (CI) of the mean accuracy for the meta-variable networks and for the single-SNP BNs (Table <xref ref-type="table" rid="T1">1</xref>). Although the two CIs partially overlap, the mean accuracy of the meta-variable network is higher than the upper bound of the CI for the SNP-network. In order to evaluate the difference between the two sets of accuracies values, we applied the Wilcoxon signed rank test as suggested by J. Demsar [<xref ref-type="bibr" rid="B18">18</xref>], obtaining a significant result (p &#x0003c; 0.05). This reinforces the evidence that the performance of the meta-variable BNs is superior to the single-SNP ones.</p><table-wrap position="float" id="T1"><label>Table 1</label><caption><p>Classification performance on the test sets.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="left"><bold>Model</bold></td><td align="center" colspan="2"><bold>SNP based</bold></td><td align="center" colspan="2"><bold>Meta-variable based</bold></td><td align="center" colspan="2"><bold>Haplotype based</bold></td><td align="center"><bold>Majority Classifier</bold></td></tr></thead><tbody><tr><td align="left"><bold>Classification Accuracies (%) and K statistics</bold></td><td align="center"><bold>CA</bold></td><td align="center"><bold>K-stat</bold></td><td align="center"><bold>CA</bold></td><td align="center"><bold>K-stat</bold></td><td align="center"><bold>CA</bold></td><td align="center"><bold>K-stat</bold></td><td align="center"><bold>CA</bold></td></tr><tr><td align="left">Sampling test 1</td><td align="center">55.71</td><td align="center">0.09</td><td align="center">64.28</td><td align="center">0.26</td><td align="center">57.14</td><td align="center">0.12</td><td align="center">51.43</td></tr><tr><td align="left">Sampling test 2</td><td align="center">55</td><td align="center">0.07</td><td align="center">59.28</td><td align="center">0.16</td><td align="center">53.57</td><td align="center">0.04</td><td align="center">51.43</td></tr><tr><td align="left">Sampling test 3</td><td align="center">63.57</td><td align="center">0.25</td><td align="center">67.86</td><td align="center">0.34</td><td align="center">55</td><td align="center">0.07</td><td align="center">51.43</td></tr><tr><td align="left">Sampling test 4</td><td align="center">62.14</td><td align="center">0.22</td><td align="center">65.72</td><td align="center">0.29</td><td align="center">49.29</td><td align="center">-0.04</td><td align="center">51.43</td></tr><tr><td align="left">Sampling test 5</td><td align="center">58.57</td><td align="center">0.15</td><td align="center">64.28</td><td align="center">0.26</td><td align="center">57.85</td><td align="center">0.13</td><td align="center">51.43</td></tr><tr><td align="left"><bold>Mean values on test sets</bold></td><td align="center"><bold>58.99</bold></td><td align="center"><bold>0.16</bold></td><td align="center"><bold>64.28</bold></td><td align="center"><bold>0.26</bold></td><td align="center"><bold>54.57</bold></td><td align="center"><bold>0.06</bold></td><td align="center"><bold>51.43</bold></td></tr><tr><td align="left">95% Confidence Interval</td><td align="center">54.28&#x02013;63.72</td><td></td><td align="center">60.36&#x02013;68.2</td><td></td><td align="center">50.34&#x02013;58.80</td><td></td><td></td></tr><tr><td align="left">Standard Deviation</td><td align="center">3.8</td><td></td><td align="center">3.16</td><td></td><td align="center">3.4</td><td></td><td></td></tr><tr><td align="left">Standard Error</td><td align="center">1.7</td><td></td><td align="center">1.41</td><td></td><td align="center">1.52</td><td></td><td></td></tr></tbody></table><table-wrap-foot><p>The table summarizes the results obtained by repeating 5 times a random sampling hold-out scheme in which 75% of the dataset (216 affected and 203 unaffected individuals) was employed as training set and the remaining 25% as test set (72 affected and 68 unaffected individuals). In particular, the table shows the classification accuracies obtained on the test sets by the single-SNP BN, the meta-variable BN and the haplotype BN, the accuracies of the majority classifier and the k-statistics.</p></table-wrap-foot></table-wrap></sec><sec><title>Comparison with haplotype-based BN</title><p>A typical way of performing association analysis using aggregated variables instead of single SNPs is to group them into haplotype blocks. Thus, we compared our classification approach with a haplotype-based one, considering haplotypes as variables to learn the BN. Haplotype definition was performed through the following steps:</p><p>&#x02022; linkage disequilibrium (LD) analyses using Haploview software [<xref ref-type="bibr" rid="B19">19</xref>] to identify haplotype blocks for each gene region;</p><p>&#x02022; haplotype blocks filtering to keep only blocks with frequency in the dataset larger than 10% (the frequencies are estimated using the expectation-maximization algorithm [<xref ref-type="bibr" rid="B20">20</xref>]);</p><p>&#x02022; selection of the most informative haplotype configuration for each haplotype block, according to a case-control analysis based on permutation tests on the whole dataset;</p><p>&#x02022; inference of the haplotype phases for each individual on the previously selected blocks (we used PLINK software package [<xref ref-type="bibr" rid="B16">16</xref>]);</p><p>&#x02022; removal of individuals with a posterior haplotype probability &#x0003c; 0.80.</p><p>After haplotype phases reconstruction and individuals selection, we learned a BN using haplotype phases as variables and we then applied the same validation scheme previously described for the single-SNP and meta-variable based approaches. The network built on the whole dataset is represented in Figure <xref ref-type="fig" rid="F5">5</xref>: the phenotype is connected to 5 haplotypes out of 14 (h-A1, h-B1, h-C, h-F and h-H), which map to 5 genes. Three of these genes (A, B and G) are directly connected to hypertension also in the meta-variable network. Yet haplotypes belonging to the same genes are not always connected with each other and the network shows a higher interconnectivity among variables than the meta-variable one. The classification accuracy of this network is 65.83% and thus higher than the single-SNP and meta-variable networks. However, the classification performances on the hold-out test sets are lower than the other two approaches, with an average classification accuracy of 54.57% (Table <xref ref-type="table" rid="T1">1</xref>). The haplotype method seems prone to overfit the data, since it has the worst performance in terms of generalization accuracy, but the best one in terms of training accuracy. We also applied the Friedman statistical test [<xref ref-type="bibr" rid="B18">18</xref>] to verify the difference in the median accuracy of the three methods, obtaining significant results (p &#x0003c; 0.05).</p><fig position="float" id="F5"><label>Figure 5</label><caption><p><bold>Haplotype-based BN learned using the whole dataset</bold>. Bayesian network learned on the whole dataset using haplotypes as variables.</p></caption><graphic xlink:href="1471-2105-10-S2-S7-5"/></fig></sec></sec><sec><title>Conclusion</title><p>The new approach presented in this paper can be considered as an instrument to derive a gene-based predictive model based on SNPs data. Such model is more parsimonious than the one based on single SNPs, while preserving the capability of highlighting predictive SNPs configurations. Its limited number of nodes provides an abstract view of the relationships between genes and the phenotype of interest, and therefore represents an alternative way to analyze the available data. The prediction performance of this approach was consistently superior to the SNP-based and the haplotype-based one in all the sets studied in the paper.</p><p>The results of this approach should however be cautiously interpreted. First of all, the proposed learning method heavily exploits the training set, and, therefore, is prone to overfit the data. The evaluation should be performed on a separate test set to carefully assess the predictive performance. Moreover, learning the meta-nodes requires classification tree pruning to reduce overfitting. For this reason, the learning process needs to specify tree pruning parameters.</p><p>Furthermore, the method's goal is to perform prediction and the meta-variables have a precise meaning as predictors of a phenotype of interest. The method is designed to extract models based on gene-related SNPs, and cannot be properly applied to intergenic SNPs.</p><p>Finally, the results have been obtained after a selection of SNPs performed on the entire dataset. For this reason, the absolute values of the accuracies here reported are probably overestimated. However, since all the analyzed BNs have been learned with the same set of SNPs, their comparison is fair.</p><p>As regards the limits of the association study, we are aware of the potential confounding factors related to age and AH differences between groups. To address this issue we are genotyping an age-matched control population.</p></sec><sec><title>Competing interests</title><p>The authors declare that they have no competing interests.</p></sec><sec><title>Authors' contributions</title><p>AM carried out the molecular genetic studies, performed the statistical analysis and drafted the paper. AN carried out software tools development and integrations, participated in study design and drafted the manuscript. FF participated in the definition of the methodology and in drafting and reviewing the manuscript. AAP participated in study coordination and draft revision. RB conceived the study, participated in its design and coordination and helped to draft the manuscript. All authors read and approved the final manuscript.</p></sec></body><back><ack><sec><title>Acknowledgements</title><p>This study is part of the FIRB project ITALBIONET, Rete Nazionale di Bioinformatica. A. Malovini was supported by Ministry of Italian Research (FIRB RBIN04X9XE) and he is a PhD student in Bioengineering and Bioinformatics at the Laboratory for Biomedical Informatics, University of Pavia, Italy. F. Ferrazzi was supported by an Investigator Fellowship from Collegio Ghislieri, Pavia, Italy. We are grateful to the Multimedica staff (Valeria Novelli, Roberta Roncarati and Chiara Viviani Anselmi) for data collection, and to the Editors and the anonymous reviewers for their invaluable suggestions.</p><p>This article has been published as part of <italic>BMC Bioinformatics </italic>Volume 10 Supplement 2, 2009: Selected Proceedings of the First Summit on Translational Bioinformatics 2008. The full contents of the supplement are available online at <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/10?issue=S2"/>.</p></sec></ack><ref-list><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hirschhorn</surname><given-names>JN</given-names></name><name><surname>Daly</surname><given-names>MJ</given-names></name></person-group><article-title>Genome-wide association studies for common diseases and complex traits</article-title><source>Nature reviews</source><year>2005</year><volume>6</volume><fpage>95</fpage><lpage>108</lpage><pub-id pub-id-type="pmid">15716906</pub-id></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>McCarthy</surname><given-names>MI</given-names></name><name><surname>Abecasis</surname><given-names>GR</given-names></name><name><surname>Cardon</surname><given-names>LR</given-names></name><name><surname>Goldstein</surname><given-names>DB</given-names></name><name><surname>Little</surname><given-names>J</given-names></name><name><surname>Ioannidis</surname><given-names>JP</given-names></name><name><surname>Hirschhorn</surname><given-names>JN</given-names></name></person-group><article-title>Genome-wide association studies for complex traits: consensus, uncertainty and challenges</article-title><source>Nature reviews</source><year>2008</year><volume>9</volume><fpage>356</fpage><lpage>369</lpage><pub-id pub-id-type="pmid">18398418</pub-id><pub-id pub-id-type="doi">10.1038/nrg2344</pub-id></citation></ref><ref id="B3"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Sebastiani</surname><given-names>P</given-names></name><name><surname>Abad-Grau</surname><given-names>MM</given-names></name></person-group><person-group person-group-type="editor"><name><surname>Alterovitz G, Ramoni MF</surname></name></person-group><article-title>Bayesian Networks for Genetic Analysis</article-title><source>Systems Bioinformatics: An Engineering Case-Based Approach</source><year>2007</year><publisher-name>Artech House</publisher-name><fpage>205</fpage><lpage>227</lpage></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Sebastiani</surname><given-names>P</given-names></name><name><surname>Ramoni</surname><given-names>MF</given-names></name><name><surname>Nolan</surname><given-names>V</given-names></name><name><surname>Baldwin</surname><given-names>CT</given-names></name><name><surname>Steinberg</surname><given-names>MH</given-names></name></person-group><article-title>Genetic dissection and prognostic modeling of overt stroke in sickle cell anemia</article-title><source>Nat Genet</source><year>2005</year><volume>37</volume><fpage>435</fpage><lpage>440</lpage><pub-id pub-id-type="pmid">15778708</pub-id><pub-id pub-id-type="doi">10.1038/ng1533</pub-id></citation></ref><ref id="B5"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Rodin</surname><given-names>A</given-names></name><name><surname>Mosley</surname><given-names>TH</given-names><suffix>Jr</suffix></name><name><surname>Clark</surname><given-names>AG</given-names></name><name><surname>Sing</surname><given-names>CF</given-names></name><name><surname>Boerwinkle</surname><given-names>E</given-names></name></person-group><article-title>Mining genetic epidemiology data with Bayesian networks application to APOE gene variation and plasma lipid levels</article-title><source>J Comput Biol</source><year>2005</year><volume>12</volume><fpage>1</fpage><lpage>11</lpage><pub-id pub-id-type="pmid">15725730</pub-id><pub-id pub-id-type="doi">10.1089/cmb.2005.12.1</pub-id></citation></ref><ref id="B6"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Mitchell</surname><given-names>TM</given-names></name></person-group><source>Machine learning</source><year>1997</year><publisher-name>McGraw-Hill</publisher-name></citation></ref><ref id="B7"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Pearl</surname><given-names>J</given-names></name></person-group><source>Probabilistic reasoning in intelligent systems: networks of plausible inference</source><year>1988</year><publisher-name>Morgan Kaufmann</publisher-name></citation></ref><ref id="B8"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lauritzen</surname><given-names>SL</given-names></name><name><surname>Spiegelhalter</surname><given-names>SJ</given-names></name></person-group><article-title>Local Computations with Probabilities on Graphical Structures and Their Application to Expert Systems</article-title><source>Journal of the Royal Statistical Society Series B</source><year>1988</year><volume>50</volume><fpage>157</fpage><lpage>224</lpage></citation></ref><ref id="B9"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Witten</surname><given-names>IH</given-names></name><name><surname>Frank</surname><given-names>E</given-names></name></person-group><source>Data mining: Practical machine learning tools and techniques with Java implementations</source><year>2000</year><publisher-name>San Francisco, CA, USA: Morgan Kaufman</publisher-name></citation></ref><ref id="B10"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Niblett</surname><given-names>T</given-names></name><name><surname>Bratko</surname><given-names>I</given-names></name></person-group><person-group person-group-type="editor"><name><surname>Bratko I, Lavrac N</surname></name></person-group><article-title>Constructing Decision Trees in Noisy Domains</article-title><source>Progress in Machine Learning</source><year>1986</year><publisher-name>England: Sigma Press</publisher-name></citation></ref><ref id="B11"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Demsar</surname><given-names>J</given-names></name><name><surname>Zupan</surname><given-names>B</given-names></name><name><surname>Leban</surname><given-names>G</given-names></name></person-group><article-title>Orange: From experimental machine learning to interactive data mining</article-title><source>White Paper,</source><year>2004</year><publisher-name>Faculty of Computer and Information Science, University of Ljubljana</publisher-name><ext-link ext-link-type="uri" xlink:href="http://www.ailab.si/orange"/></citation></ref><ref id="B12"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Cooper</surname><given-names>GF</given-names></name><name><surname>Herskovits</surname><given-names>E</given-names></name></person-group><article-title>A Bayesian method for the induction of probabilistic networks from data</article-title><source>Machine Learning</source><year>1992</year><volume>9</volume><fpage>309</fpage><lpage>347</lpage></citation></ref><ref id="B13"><citation citation-type="other"><article-title>Bayesware Discoverer</article-title><ext-link ext-link-type="uri" xlink:href="http://www.bayesware.com/products/discoverer/discoverer.html"/></citation></ref><ref id="B14"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Whelton</surname><given-names>PK</given-names></name></person-group><article-title>Epidemiology of hypertension</article-title><source>Lancet</source><year>1994</year><volume>344</volume><fpage>101</fpage><lpage>106</lpage><pub-id pub-id-type="pmid">7912348</pub-id><pub-id pub-id-type="doi">10.1016/S0140-6736(94)91285-8</pub-id></citation></ref><ref id="B15"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Harrap</surname><given-names>SB</given-names></name></person-group><article-title>Genetic analysis of blood pressure and sodium balance in spontaneously hypertensive rats</article-title><source>Hypertension</source><year>1986</year><volume>8</volume><fpage>572</fpage><lpage>582</lpage><pub-id pub-id-type="pmid">3721560</pub-id></citation></ref><ref id="B16"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Purcell</surname><given-names>S</given-names></name><name><surname>Neale</surname><given-names>B</given-names></name><name><surname>Todd-Brown</surname><given-names>K</given-names></name><name><surname>Thomas</surname><given-names>L</given-names></name><name><surname>Ferreira</surname><given-names>MA</given-names></name><name><surname>Bender</surname><given-names>D</given-names></name><name><surname>Maller</surname><given-names>J</given-names></name><name><surname>Sklar</surname><given-names>P</given-names></name><name><surname>de Bakker</surname><given-names>PI</given-names></name><name><surname>Daly</surname><given-names>MJ</given-names></name><etal></etal></person-group><article-title>PLINK: a tool set for whole-genome association and population-based linkage analyses</article-title><source>American journal of human genetics</source><year>2007</year><volume>81</volume><fpage>559</fpage><lpage>575</lpage><pub-id pub-id-type="pmid">17701901</pub-id><pub-id pub-id-type="doi">10.1086/519795</pub-id></citation></ref><ref id="B17"><citation citation-type="other"><person-group person-group-type="author"><name><surname>Nuzzo</surname><given-names>A</given-names></name><name><surname>Riva</surname><given-names>A</given-names></name></person-group><article-title>A Knowledge Management Tool for Translational Research</article-title><source>AMIA Summit on Translational Bioinformatics: 2008 </source><fpage> 17</fpage></citation></ref><ref id="B18"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Demsar</surname><given-names>J</given-names></name></person-group><article-title>Statistical Comparisons of Classifiers over Multiple Data Sets</article-title><source>Journal of Machine Learning Research</source><year>2006</year><volume>7</volume><fpage>1</fpage><lpage>30</lpage></citation></ref><ref id="B19"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Barrett</surname><given-names>JC</given-names></name><name><surname>Fry</surname><given-names>B</given-names></name><name><surname>Maller</surname><given-names>J</given-names></name><name><surname>Daly</surname><given-names>MJ</given-names></name></person-group><article-title>Haploview: analysis and visualization of LD and haplotype maps</article-title><source>Bioinformatics (Oxford, England)</source><year>2005</year><volume>21</volume><fpage>263</fpage><lpage>265</lpage><pub-id pub-id-type="pmid">15297300</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/bth457</pub-id></citation></ref><ref id="B20"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Dempster</surname><given-names>AP</given-names></name><name><surname>Laird</surname><given-names>NM</given-names></name><name><surname>Rubin</surname><given-names>DB</given-names></name></person-group><article-title>Maximum likelihood from incomplete data via the EM algorithm</article-title><source>Journal of the Royal Statistical Society Series B</source><year>1977</year><volume>39</volume><fpage>1</fpage><lpage>38</lpage></citation></ref></ref-list></back></article>