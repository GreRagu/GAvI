<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd"><article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article" xml:lang="EN"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id><journal-id journal-id-type="publisher-id">bioinformatics</journal-id><journal-id journal-id-type="hwp">bioinfo</journal-id><journal-title>Bioinformatics</journal-title><issn pub-type="ppub">1367-4803</issn><issn pub-type="epub">1460-2059</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">18974167</article-id><article-id pub-id-type="pmc">2639305</article-id><article-id pub-id-type="doi">10.1093/bioinformatics/btn541</article-id><article-id pub-id-type="publisher-id">btn541</article-id><article-categories><subj-group subj-group-type="heading"><subject>Applications Note</subject><subj-group><subject>Sequence Analysis</subject></subj-group></subj-group></article-categories><title-group><article-title><italic>iMapper</italic>: a web application for the automated analysis and mapping of insertional mutagenesis sequence data against Ensembl genomes</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Kong</surname><given-names>Jun</given-names></name></contrib><contrib contrib-type="author"><name><surname>Zhu</surname><given-names>Fei</given-names></name></contrib><contrib contrib-type="author"><name><surname>Stalker</surname><given-names>Jim</given-names></name></contrib><contrib contrib-type="author"><name><surname>Adams</surname><given-names>David J.</given-names></name><xref ref-type="corresp" rid="COR1">*</xref></contrib></contrib-group><aff>Experimental Cancer Genetics, The Wellcome Trust Sanger Institute, Hinxton, Cambs, CB10 1HH, UK</aff><author-notes><corresp id="COR1">*To whom correspondence should be addressed.</corresp><fn><p>Associate Editor: Dmitrij Frishman</p></fn></author-notes><pub-date pub-type="ppub"><day>15</day><month>12</month><year>2008</year></pub-date><pub-date pub-type="epub"><day>30</day><month>10</month><year>2008</year></pub-date><pub-date pub-type="pmc-release"><day>30</day><month>10</month><year>2008</year></pub-date><volume>24</volume><issue>24</issue><fpage>2923</fpage><lpage>2925</lpage><history><date date-type="received"><day>1</day><month>9</month><year>2008</year></date><date date-type="rev-recd"><day>30</day><month>9</month><year>2008</year></date><date date-type="accepted"><day>16</day><month>10</month><year>2008</year></date></history><permissions><copyright-statement>&#x000a9; 2008 The Author(s)</copyright-statement><copyright-year>2008</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/"><p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">http://creativecommons.org/licenses/by-nc/2.0/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</p></license></permissions><abstract><p><bold>Summary:</bold> Insertional mutagenesis is a powerful method for gene discovery. To identify the location of insertion sites in the genome linker based polymerase chain reaction (PCR) methods (such as splinkerette-PCR) may be employed. We have developed a web application called <italic>iMapper</italic> (Insertional Mutagenesis Mapping and Analysis Tool) for the efficient analysis of insertion site sequence reads against vertebrate and invertebrate Ensembl genomes. Taking linker based sequences as input, <italic>iMapper</italic> scans and trims the sequence to remove the linker and sequences derived from the insertional mutagen. The software then identifies and removes contaminating sequences derived from chimeric genomic fragments, vector or the transposon concatamer and then presents the clipped sequence reads to a sequence mapping server which aligns them to an Ensembl genome. Insertion sites can then be navigated in Ensembl in the context of genomic features such as gene structures. <italic>iMapper</italic> also generates test-based format for nucleic acid or protein sequences (FASTA) and generic file format (GFF) files of the clipped sequence reads and provides a graphical overview of the mapped insertion sites against a karyotype. <italic>iMapper</italic> is designed for high-throughput applications and can efficiently process thousands of DNA sequence reads.</p><p><bold>Availability:</bold> <italic>iMapper</italic> is web based and can be accessed at <ext-link ext-link-type="uri" xlink:href="http://www.sanger.ac.uk/cgi-bin/teams/team113/imapper.cgi">http://www.sanger.ac.uk/cgi-bin/teams/team113/imapper.cgi</ext-link>.</p><p><bold>Contact:</bold> <email>da1@sanger.ac.uk</email>; <email>iMapper@sanger.ac.uk</email></p><p><bold>Supplementary information:</bold> <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn541/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p></abstract></article-meta></front><body><sec sec-type="intro" id="SEC1"><title>1 INTRODUCTION</title><p>Retroviral-based insertional mutagenesis screens in mice have been a valuable tool for the discovery of oncogenes and tumor suppressors in mice (Mikkers and Berns, <xref ref-type="bibr" rid="B5">2003</xref>), and also for gene discovery in cultured cells (Du <italic>et al.</italic>, <xref ref-type="bibr" rid="B3">2005</xref>). More recently transposon-based approaches such as the use of the <italic>Tc1</italic>-family transposon <italic>Sleeping Beauty</italic> (Collier <italic>et al.</italic>, <xref ref-type="bibr" rid="B1">2005</xref>; Dupuy <italic>et al.</italic>, <xref ref-type="bibr" rid="B4">2005</xref>) and the <italic>Trichoplusia</italic>-derived transposon <italic>Piggybac</italic> (Wang <italic>et al.</italic>, <xref ref-type="bibr" rid="B7">2008</xref>) have been developed increasing the repertoire of insertional mutagens available as gene discovery tools in mammals. To determine where in the genome an insertional mutagen has inserted the usual approach is to use a linker based polymerase chain reaction (PCR) method, such as vectorette or splinkerette (Devon <italic>et al.</italic>, <xref ref-type="bibr" rid="B2">1995</xref>). For any insertional mutagenesis screen to cover a significant proportion of the genome, it is desirable to perform a screen using hundred of mice, and hundreds if not thousands of cell clones. Thus insertional mutagenesis screens may involve the generation and analysis of tens of thousands of DNA sequence reads from insertion sites. Although linker based PCR methods are generally specific, non-specific PCR products, chimeric sequences and sequences derived from transposon concatemeric arrays can all represents contaminating sequences within pools of insertion site PCR products. Thus without careful processing of DNA sequence data, the direct mapping of insertion site sequence reads to the genome may result in the identification of false-positive insertion sites. To facilitate the analysis of linker mediated insertion site sequences, we have developed a web application called <italic>iMapper</italic> (Insertional Mutagenesis Mapping and Analysis Tool). Using linker based PCR sequence reads as input <italic>iMapper</italic> uses a local sequence alignment algorithm to identify a tag sequence derived from the end of the insertional mutagen (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn541/DC1">Supplementary Material</ext-link>). <italic>iMapper</italic> then scans the downstream sequence for user defined contaminating sequences, processes the sequence to identify the restriction site sequence used for linker ligation during the insertion site PCR, clips out the genomic sequence between the tag and first restriction enzyme cutting site and presents this sequence to a rapid mapping algorithm called sequence search and alignment by hashing algorithm (SSAHA) (Ning <italic>et al.</italic>, <xref ref-type="bibr" rid="B6">2001</xref>). Output is then generated in various formats. The main features of <italic>iMapper</italic> include:<list list-type="order"><list-item><p>Efficient and accurate processing of insertion site sequence data and analysis against Ensembl human, mouse, rat, zebra-fish, <italic>Drosophila</italic> and <italic>Saccharomyces cerevisiae</italic> genomes.</p></list-item><list-item><p>Output of annotated sequence reads in tabular format with links to Ensembl <italic>ContigView</italic> so that insertion sites can be viewed in the context of gene structures and other genomic features.</p></list-item><list-item><p>Output of processed sequence data in test-based format for nucleic acid or protein sequences (FASTA) and generic file format (GFF) allowing insertion site sequence data to be analyzed in any sequence analysis package and displayed as a distributed annotation system (DAS) track against an Ensembl genome.</p></list-item><list-item><p>Output of a graphical chromosome &#x02018;<italic>KaryoView</italic>&#x02019; showing insertion sites against an ideogram of each chromosome.</p></list-item></list></p></sec><sec sec-type="methods" id="SEC2"><title>2 METHODS</title><sec id="SEC2.1"><title>2.1 Architecture</title><p>The <italic>iMapper</italic> interface is web-based (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn541/DC1">Supplementary Material</ext-link>). The sequence analysis module within <italic>iMapper</italic> uses Perl and computer generated imagery (CGI), and for comparison to an Ensembl genome Perl scripts run against the Ensembl application programming interface (Ensembl-API).</p></sec><sec id="SEC2.2"><title>2.2 Input format</title><p>Sequence is imported into <italic>iMapper</italic> in FASTA format. Sequence data in this format can either be pasted into the text box or imported using the file upload option (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn541/DC1">Supplementary Material</ext-link>).</p></sec><sec id="SEC2.3"><title>2.3 User defined parameters</title><p>After sequence input, a user can define the species against which they would like their insertion site data analyzed from human, mouse, rat, zebrafish, <italic>Drosophila</italic> and <italic>S. cerevisiae</italic>. The orientation of the tag in the sequence can then be chosen, and the output option selected. Selecting &#x02018;output good sequences&#x02019; will exclude those sequences that do not contain the tag sequence, sequences that do not map to the genome, and sequences that are identified to contain contaminating sequences from all output formats. The sequence of the mutagen &#x02018;tag&#x02019; sequence can then be specified, or a prevalidated tag sequence can be selected from the drop down menu. We provide tag sequences for the transposons <italic>Sleeping Beauty</italic> and <italic>Piggybac</italic>, and for the U3LTR of the MuLV retrovirus. The sequence of the restriction site can then be specified. At this point, the user has defined the boundaries of the sequence which will be mapped to the genome as the sequence between the tag and the restriction site or linker. Advanced options can then be specified. These include the tag alignment parameters and the sequence of contaminating sequences, which will be highlighted in the tabular format (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn541/DC1">Supplementary Material</ext-link>). It is also possible to specify the parameters used by the SSAHA algorithm for matching the genomic sequence between the tag and the restriction site or linker, to the genome. Finally, it is possible to specify the criteria for &#x02018;gene overlaps&#x02019;. By specifying &#x02018;gene overlaps&#x02019;, it is possible to vary the spatial criteria for defining what constitutes an insertion event in or near a gene. For example, it may be desirable to identify insertion events that mutate in or upstream of a gene, but not downstream. Sequence processing commences when the &#x02018;Submit Query&#x02019; button is selected.</p></sec><sec id="SEC2.4"><title>2.4 Sequence processing</title><p>The procedure used by the code for sequence processing is shown in the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn541/DC1">Supplementary Material</ext-link>.</p></sec><sec id="SEC2.5"><title>2.5 Tabular format</title><p>The tabular format is an html-based output of the analyzed sequence data (<xref ref-type="fig" rid="F1">Fig. 1</xref>). Sequences such as the tag sequence, the restriction site and contaminating sequence are highlighted in this view. Links to Ensembl gene pages and to the Ensembl <italic>ContigView</italic> are also provided from this page.<fig id="F1" position="float"><label>Fig. 1.</label><caption><p><italic>iMapper</italic> maps and analyzes insertion site sequence data. <italic>iMapper</italic> generates output in several formats including a tabular format with links to Ensembl <italic>ContigView</italic> and Ensembl gene pages (upper panel), GFF file format, FASTA format and a <italic>KaryoView</italic> format (lower panel) which provides a global overview of all insertion site sequences that were mapped to the genome. Sequence traces displayed in the tabular format are annotated to show the location of the tag sequence (green), the restriction enzyme site (orange) and the mapped genomic sequence (yellow). An alignment of the tag sequence from the trace and the insertion site mapping location is also shown in the tabular format. In the <italic>KaryoView</italic> format, each red triangle indicates an independent insertion site displayed against a genome ideogram.</p></caption><graphic xlink:href="btn541f1"/></fig></p></sec><sec id="SEC2.6"><title>2.6 FASTA and GFF formats</title><p>A FASTA file of the processed traces and a GFF file of the data are provided when the analysis run is complete.</p></sec><sec id="SEC2.7"><title>2.7 <italic>KaryoView</italic></title><p>To obtain a global overview of the sequence data, <italic>iMapper</italic> has a link to an Ensembl <italic>KaryoView</italic> providing a graphical view of the data against a chromosomal ideogram (<xref ref-type="fig" rid="F1">Fig. 1</xref>).</p></sec><sec id="SEC2.8"><title>2.8 Performance</title><p>The specificity of tag identification depends on the length of the tag sequence entered, and the predefined thresholds specified for sequence tag identification including the percentage alignment threshold, gap penalty, match and mismatch score. Longer tag sequences, higher alignment percentages and more stringent gap and mismatch scores will result in more accurate tag sequence identification. We have tested the optimal tag sequence length and percentage threshold using a dataset of 1920 <italic>PiggyBac</italic> insertion site sequence reads (Wang <italic>et al.</italic>, <xref ref-type="bibr" rid="B7">2008</xref>). Because <italic>PiggyBac</italic> integrations invariably occur at &#x02018;TTAA&#x02019; sites a precisely identified tag sequence will always be followed by the sequence TTAA. As shown in the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn541/DC1">Supplementary Material</ext-link>, the minimal advisable tag sequence length is 15 bp. We determined the optimal percentage threshold for sequence tag identification, to be used as the default, and determined this to be 80% (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn541/DC1">Supplementary Material</ext-link>). Finally, we optimized the SSAHA sequence mapping parameters to be used as the default finding that for sequences from splinkerette-PCR reactions containing genomic junction fragments of on average 200 bp in length the optimal SSAHA score is 35. This score should be ideal for insertion site sequences generated by capillary read sequencing but may need to be lowered to 20 for shorter reads such as those generated by 454 sequencing. It is advisable to optimize the SSAHA mapping score for each dataset selecting a score that generates the highest number of uniquely mapped reads. This is important because the default mapping parameters used by <italic>iMapper</italic> are stringent and will return only those reads that map to unique unambiguous genomic locations.</p><p>We have used <italic>iMapper</italic> to analyze up to 20 000 DNA sequence traces. It takes, on average, 1&#x02013;2 s for <italic>iMapper</italic> to analyze each DNA sequence trace (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn541/DC1">Supplementary Material</ext-link>) and to return the analyzed data in tabular, <italic>ContigView</italic>, GFF, FASTA and <italic>karyoView</italic> formats.</p></sec></sec><sec id="SEC3"><title>3 SUMMARY</title><p><italic>iMapper</italic> is a web-based freely accessible solution for the analysis of insertional mutagenesis datasets and should facilitate the many insertional mutagenesis screens that are ongoing worldwide.</p><p><italic>Funding</italic>: Cancer Research-UK (C20510/A6997) and the Wellcome Trust (76943 to D.J.A.); Wellcome Trust Sanger Institute PhD programme (to J.K. and F.Z.).</p><p><italic>Conflict of Interest</italic>: none declared.</p></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material id="PMC_1" content-type="local-data"><caption><title>[Supplementary Data]</title></caption><media mimetype="text" mime-subtype="html" xlink:href="btn541_index.html"/><media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="btn541_1.pdf"/></supplementary-material></sec></body><back><ref-list><title>REFERENCES</title><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Collier</surname><given-names>LS</given-names></name><etal/></person-group><article-title>Cancer gene discovery in solid tumours using transposon-based somatic mutagenesis in the mouse</article-title><source>Nature</source><year>2005</year><volume>436</volume><fpage>272</fpage><lpage>276</lpage><pub-id pub-id-type="pmid">16015333</pub-id></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Devon</surname><given-names>RS</given-names></name><etal/></person-group><article-title>Splinkerettes&#x02013;improved vectorettes for greater efficiency in PCR walking</article-title><source>Nucleic Acids Res.</source><year>1995</year><volume>23</volume><fpage>1644</fpage><lpage>1645</lpage><pub-id pub-id-type="pmid">7784225</pub-id></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Du</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Insertional mutagenesis identifies genes that promote the immortalization of primary bone marrow progenitor cells</article-title><source>Blood</source><year>2005</year><volume>106</volume><fpage>3932</fpage><lpage>3939</lpage><pub-id pub-id-type="pmid">16109773</pub-id></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Dupuy</surname><given-names>AJ</given-names></name><etal/></person-group><article-title>Mammalian mutagenesis using a highly mobile somatic sleeping beauty transposon system</article-title><source>Nature</source><year>2005</year><volume>436</volume><fpage>221</fpage><lpage>226</lpage><pub-id pub-id-type="pmid">16015321</pub-id></citation></ref><ref id="B5"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Mikkers</surname><given-names>H</given-names></name><name><surname>Berns</surname><given-names>A</given-names></name></person-group><article-title>Retroviral insertional mutagenesis: tagging cancer pathways</article-title><source>Adv. Cancer Res.</source><year>2003</year><volume>88</volume><fpage>53</fpage><lpage>99</lpage><pub-id pub-id-type="pmid">12665053</pub-id></citation></ref><ref id="B6"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ning</surname><given-names>Z</given-names></name><etal/></person-group><article-title>SSAHA: a fast search method for large DNA databases</article-title><source>Genome Res.</source><year>2001</year><volume>11</volume><fpage>1725</fpage><lpage>1729</lpage><pub-id pub-id-type="pmid">11591649</pub-id></citation></ref><ref id="B7"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>W</given-names></name><etal/></person-group><article-title>Chromosomal transposition of PiggyBac in mouse embryonic stem cells</article-title><source>Proc. Natl Acad. Sci. USA</source><year>2008</year><volume>105</volume><fpage>9290</fpage><lpage>9295</lpage><pub-id pub-id-type="pmid">18579772</pub-id></citation></ref></ref-list></back></article>