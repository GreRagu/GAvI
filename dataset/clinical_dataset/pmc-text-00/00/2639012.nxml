<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd"><article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article" xml:lang="EN"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id><journal-id journal-id-type="publisher-id">bioinformatics</journal-id><journal-id journal-id-type="hwp">bioinfo</journal-id><journal-title>Bioinformatics</journal-title><issn pub-type="ppub">1367-4803</issn><issn pub-type="epub">1460-2059</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">19028720</article-id><article-id pub-id-type="pmc">2639012</article-id><article-id pub-id-type="doi">10.1093/bioinformatics/btn607</article-id><article-id pub-id-type="publisher-id">btn607</article-id><article-categories><subj-group subj-group-type="heading"><subject>Original Papers</subject><subj-group><subject>Phylogenetics</subject></subj-group></subj-group></article-categories><title-group><article-title>Phylogenetic inference under recombination using Bayesian stochastic topology selection</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Webb</surname><given-names>Alex</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Hancock</surname><given-names>John M.</given-names></name><xref ref-type="aff" rid="AFF1"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Holmes</surname><given-names>Chris C.</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref><xref ref-type="aff" rid="AFF1"><sup>2</sup></xref><xref ref-type="corresp" rid="COR1">*</xref></contrib></contrib-group><aff id="AFF1"><sup>1</sup>Department of Statistics, 1 South Parks Road, Oxford, OX1 3TG and <sup>2</sup>MRC Harwell, Oxfordshire, OX11 0RD, UK</aff><author-notes><corresp id="COR1">*To whom correspondence should be addressed.</corresp><fn><p>Associate Editor: Martin Bishop</p></fn></author-notes><pub-date pub-type="ppub"><day>15</day><month>1</month><year>2009</year></pub-date><pub-date pub-type="epub"><day>20</day><month>11</month><year>2008</year></pub-date><pub-date pub-type="pmc-release"><day>20</day><month>11</month><year>2008</year></pub-date><volume>25</volume><issue>2</issue><fpage>197</fpage><lpage>203</lpage><history><date date-type="received"><day>22</day><month>9</month><year>2008</year></date><date date-type="rev-recd"><day>19</day><month>11</month><year>2008</year></date><date date-type="accepted"><day>19</day><month>11</month><year>2008</year></date></history><permissions><copyright-statement>&#x000a9; 2008 The Author(s)</copyright-statement><copyright-year>2008</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/"><p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">http://creativecommons.org/licenses/by-nc/2.0/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</p></license></permissions><abstract><p><bold>Motivation:</bold> Conventional phylogenetic analysis for characterizing the relatedness between taxa typically assumes that a single relationship exists between species at every site along the genome. This assumption fails to take into account recombination which is a fundamental process for generating diversity and can lead to spurious results. Recombination induces a localized phylogenetic structure which may vary along the genome. Here, we generalize a hidden Markov model (HMM) to infer changes in phylogeny along multiple sequence alignments while accounting for rate heterogeneity; the hidden states refer to the unobserved phylogenic topology underlying the relatedness at a genomic location. The dimensionality of the number of hidden states (topologies) and their structure are random (not known a priori) and are sampled using Markov chain Monte Carlo algorithms. The HMM structure allows us to analytically integrate out over all possible changepoints in topologies as well as all the unknown branch lengths.</p><p><bold>Results:</bold> We demonstrate our approach on simulated data and also to the genome of a suspected HIV recombinant strain as well as to an investigation of recombination in the sequences of 15 laboratory mouse strains sequenced by Perlegen Sciences. Our findings indicate that our method allows us to distinguish between rate heterogeneity and variation in phylogeny caused by recombination without being restricted to 4-taxa data.</p><p><bold>Availability:</bold> The method has been implemented in JAVA and is available, along with data studied here, from <ext-link ext-link-type="uri" xlink:href="http://www.stats.ox.ac.uk/~webb">http://www.stats.ox.ac.uk/~webb</ext-link>.</p><p><bold>Contact:</bold> <email>cholmes@stats.ox.ac.uk</email></p><p><bold>Supplementary information:</bold> <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn607/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p></abstract></article-meta></front><body><sec sec-type="intro" id="SEC1"><title>1 INTRODUCTION</title><p>Recombination is one of the fundamental mechanisms that creates diversity within species; as such it is of great interest to understand the ways in which it shapes evolution and the imprint it leaves on the genomes of related organisms. The relationship between different species is typically described using a phylogeny and recombination can be viewed as a process which induces varying dependent phylogenies as we move along the genome. Conventionally, methods of phylogenetic inference assume that a single phylogeny is sufficient to characterize the relatedness across the entire sequence thus ignoring the effects of recombination. Since this assumption will be violated, we cannot be sure that our inference on the data will be correct (Schierup and Hein, <xref ref-type="bibr" rid="B26">2000</xref>). We note that since our focus is on reticulate evolution, the approach we develop is only appropriate for considering phylogenies that represent closely related taxa that have had the opportunity to undergo recombination in their evolutionary history.</p><p>There has been much work on trying to incorporate recombination into phylogenetic analysis. One simplifying assumption is to assume independence between differing phylogenies across the genome. An example of such methods includes those based on moving a window along the sequence to try to identify regions with a dissimilar phylogeny using some sort of divergence score (Grassly and Holmes, <xref ref-type="bibr" rid="B8">1997</xref>; McGuire et al., <xref ref-type="bibr" rid="B19">1997</xref>; McGuire and Wright, <xref ref-type="bibr" rid="B20">2000</xref>). However, these suffer from the problem of multiple testing and also the possible sensitivity to the size of the window used. Our approach follows others in adopting a hidden Markov model (HMM) with the states representing unrooted topologies which allows us to efficiently calculate the marginal likelihood of the data given a set of states. Importantly, the HMM structure allows us to integrate over the <italic>k</italic><sup><italic>L</italic></sup> possible recombination breakpoints (where <italic>k</italic> is the number of states and <italic>L</italic> is the length of the sequence) using the Forwards-Backwards algorithm instead of, for instance, requiring a MCMC procedure to place the breakpoints such as in Suchard et al. (<xref ref-type="bibr" rid="B27">2003</xref>) or Minin et al. (<xref ref-type="bibr" rid="B21">2005</xref>). However, a problem with the HMM approach is that the state space is vast for even moderate number of taxa, of order (2<italic>k</italic>-5)!/2<sup><italic>k</italic>&#x02212;3</sup>(<italic>k</italic>&#x02212;3)! distinct topologies for <italic>k</italic> taxa. For example, with <italic>k</italic>=10 taxa there are 21 027 025 unrooted topologies. To overcome this we introduce a stochastic topology selection approach, analogous to stochastic variable selection in regression models (George and McCulloch, <xref ref-type="bibr" rid="B7">1995</xref>), whereby only a random subset of topologies dictated by the data is maintained. Most topologies have very little probabilistic support under the data and these are effectively removed from the inference leading to massive computational savings. Conceptually, we can imagine an indicator variable, &#x003b3;<sub><italic>j</italic></sub> on each of the <italic>j</italic> = 1, &#x02026;, (2<italic>k</italic>&#x02212;5)!/2<sup><italic>k</italic>&#x02212;3</sup>(<italic>k</italic>&#x02212;3)! potential topologies such that if &#x003b3;<sub><italic>j</italic></sub> = 0 then the state is excluded from the HMM, equivalent to setting the in-going state transition probability to zero; and if &#x003b3;<sub><italic>j</italic></sub>=1 the topology is included as a candidate for a local phylogeny. Using Markov chain Monte Carlo, we are able to perform analytic marginal sampling on the set of indicator variables {&#x003b3;<sub>1</sub>, &#x02026;, &#x003b3;<sub>(2<italic>k</italic>&#x02212;5)!/2<sup><italic>k</italic>&#x02212;3</sup>(<italic>k</italic>&#x02212;3)!</sub>} integrating over all potential breakpoints and branch lengths; thus obtaining a marginal probability of support for the corresponding topology. This is analogous to a probabilistic threshold such that if the <italic>j</italic>-th topology has limited marginal likelihood under the data then the corresponding state will be removed from the HMM. We also include a separate HMM to model rate variation along the sequence since ignoring this can lead to spurious recombination detection (Husmeier and McGuire, <xref ref-type="bibr" rid="B13">2002</xref>).</p><p>Our method has similarities and differences with previous methods which are discussed below. Previous methods only deal with up to four taxa, and our aim was to develop a method which scales competitively with the number of taxa whilst still exploring the phylogeny space effectively and thus achieve more accurate location of recombination breakpoints and inference of phylogenetic trees than previous methods. Husmeier and McGuire (<xref ref-type="bibr" rid="B14">2003</xref>) used a HMM to detect recombination. The states of their model represent the three possible unrooted phylogenies relating 4-taxa and by using standards techniques for HMMs they are able to calculate the posterior probabilities of each topology at each site of their alignment including inference on the branch lengths, whereas we attempt to integrate over the branch lengths to reduce the computational complexity. However, since the number of possible topologies increases super exponentially with the number of taxa, and the algorithms used with HMMs are computationally intensive, their method is restricted to 4 taxa data. Husmeier (<xref ref-type="bibr" rid="B12">2005</xref>) extended this model to incorporate rate heterogeneity and our approach also follows this. Similary, Hobolth et al. (<xref ref-type="bibr" rid="B11">2007</xref>) use a HMM with the states representing coalescent trees to infer recombination and speciation between humans, chimps and gorillas. Again, this approach is restricted to four taxa although could in theory be extended. We also use the states of an HMM to represent topologies but we do not fix them beforehand. Instead we allow the data to dictate how many and which topologies should be used. Suchard et al. (<xref ref-type="bibr" rid="B27">2003</xref>) and Minin et al. (<xref ref-type="bibr" rid="B21">2005</xref>) attempt to capture what they call spatial phylogenetic variation using a multiple change-point model. They allow for varying phylogenies and evolutionary parameters along the sequence by assuming that changepoints occur along the alignment and within each section there is a separate phylogeny and mutation rate matrix. The locations of the breakpoints, the phylogenies and mutation parameters within each section, and various other parameters are all updated in a reversible-jump Markov chain Monte Carlo scheme (Green, <xref ref-type="bibr" rid="B9">1995</xref>). In comparison, our approach uses an HMM which due to its structure allows us to more effectively change back to a previously visited topology and also account for the uncertainty of the location of breakpoints by integrating over all potential ones using the Forwards-Backwards algorithm. This massively reduces the problem to focusing the search on probable topologies.</p></sec><sec sec-type="methods" id="SEC2"><title>2 METHODS</title><p>Given an alignment, <italic>A</italic>, of <italic>n</italic> DNA sequences of length <italic>L</italic> we wish to model the extent of recombination in the evolutionary history of the sequences. Our alignment can be represented as a vector a = {<italic>a</italic><sub>1</sub>,<italic>a</italic><sub>2</sub>,&#x02026;,<italic>a</italic><sub><italic>L</italic></sub>} where the elements of this vector are columns of our alignment. Each <italic>a</italic><sub><italic>i</italic></sub> is an element of <italic>B</italic><sup><italic>n</italic></sup> where <italic>B</italic> = {<italic>A</italic>,<italic>C</italic>,<italic>G</italic>,<italic>T</italic>,&#x02013;}, the four possible nucleotide bases or a gap character. Each column of our alignment is a realization of a continuous time Markov evolutionary process on some topology, <italic>T</italic><sub><italic>i</italic></sub>, with branch lengths <bold><italic>b</italic></bold><sub><italic>T</italic><sub><italic>i</italic></sub></sub>}. This process will be governed by a matrix, <italic>Q</italic>, the infinitesimal rate matrix. The topology is an unrooted tree characterizing the relationships of the <italic>n</italic> taxa and it is changes in this topology that will inform our inference of recombination.</p><p>There are several choices of parameterization for the matrix <italic>Q</italic>, but we choose to use the HKY matrix of Hasegawa et al. (<xref ref-type="bibr" rid="B10">1985</xref>). This allows for differing rates between nucleotide transitions and transversions and for not necessarily identical stationary probabilities, &#x003c0; = (&#x003c0;<sub><italic>A</italic></sub>, &#x003c0;<sub><italic>G</italic></sub>, &#x003c0;<sub><italic>C</italic></sub>, &#x003c0;<sub><italic>T</italic></sub>), for the four nucleotides. The matrix can be written as<disp-formula id="M1"><label>(1)</label><graphic xlink:href="btn607m1.jpg" position="float"/></disp-formula>where the &#x02018;&#x02013;&#x02019; in each row is the negative sum of the remaining elements of that row. The matrix can instead be parametrized in terms of &#x003ba;= &#x003b1;/ &#x003b2; which in this article will be set to 2 but can be estimated beforehand if an alternative value is appropriate. For identifiability between branch lengths <italic>t</italic> and <bold><italic>Q</italic></bold> we apply the constraint &#x02211;<sup>4</sup><sub><italic>i</italic> = 1</sub> <bold><italic>Q</italic></bold><sub><italic>ii</italic></sub> &#x003c0;<sub><italic>i</italic></sub>= &#x02212;1 (Minin et al., <xref ref-type="bibr" rid="B21">2005</xref>) which also gives the branch lengths the interpretation of expected number of substitutions per site. The equilibrium frequencies, &#x003c0;, are calculated from the data and fixed at their observed values.</p><p>In order to model recombination and rate variation, two HMMs are introduced, one to model the topologies underlying the data and one to take account of rate heterogeneity. Our approach is similar to that of Husmeier (<xref ref-type="bibr" rid="B12">2005</xref>) where HMMs were used to detect recombination but due to computational complexity this was restricted to 4-taxa data. Each site, <italic>a</italic><sub><italic>i</italic></sub>, of our alignment, <italic>A</italic>, will be assumed to be generated from an underlying topology, <italic>T</italic><sub><italic>i</italic></sub>, with associated branch lengths, <bold><italic>b</italic></bold><sub><italic>T</italic><sub><italic>i</italic></sub></sub>. As we move along the alignment we can change topology with probability<disp-formula id="M2"><label>(2)</label><graphic xlink:href="btn607m2.jpg" position="float"/></disp-formula>where <italic>K</italic><sub><italic>T</italic></sub> is the number of states currently in the topology HMM. The parameter &#x003c1;<sub><italic>T</italic></sub> is as in Husmeier (<xref ref-type="bibr" rid="B12">2005</xref>) and represents the probability of not changing topology between sites. Given a matrix <italic>Q</italic> we can calculate the probability of a site of our alignment, Pr(<italic>a</italic><sub><italic>i</italic></sub> | <italic>T</italic><sub><italic>i</italic></sub>, <bold><italic>b</italic></bold><sub><italic>T</italic><sub><italic>i</italic></sub></sub>) using the Pruning algorithm of Felsenstein (<xref ref-type="bibr" rid="B3">1981</xref>). However, since we do not know the branch lengths, <bold><italic>b</italic></bold><sub><italic>T</italic><sub><italic>i</italic></sub></sub>, we would need to average this probability over all possible branch lengths for topology <italic>T</italic><sub><italic>i</italic></sub>. To reduce the complexity, we place an exponential prior distribution on the branch lengths, <bold><italic>b</italic></bold>, as in Suchard et al. (<xref ref-type="bibr" rid="B27">2003</xref>)<disp-formula id="M3"><label>(3)</label><graphic xlink:href="btn607m3.jpg" position="float"/></disp-formula>Since this is conjugate to the likelihood from the Pruning algorithm, we are able to calculate the marginal probability of change along a branch<disp-formula id="M4"><label>(4)</label><graphic xlink:href="btn607m4.jpg" position="float"/></disp-formula>This relies on the parameter <italic>R</italic><sub><italic>i</italic></sub> which is the average branch length of topology <italic>T</italic><sub><italic>i</italic></sub>. To account for rate heterogeneity, we allow this parameter to vary along the alignment using another HMM. Similar to the transition probability for the topology HMM, we change state with probability<disp-formula id="M5"><label>(5)</label><graphic xlink:href="btn607m5.jpg" position="float"/></disp-formula>where the parameter &#x003c1;<sub><italic>R</italic></sub> represents the probability of not changing rate between states and <italic>K</italic><sub><italic>R</italic></sub> is the number of states in the rate HMM. Finally, a conjugate prior is placed on &#x003c1;<sub><italic>T</italic></sub> and &#x003c1;<sub><italic>R</italic></sub>, which is a beta distribution<disp-formula id="M6"><label>(6)</label><graphic xlink:href="btn607m6.jpg" position="float"/></disp-formula>Here &#x003b8;=&#x003d5; = 1 provides us with the uniform distribution, so as to give an uninformative prior for the &#x003c1; parameters. The prior on the branch lengths assumes that the branches at each site are independent. The standard phylogenetic model does not include this assumption, since a single set of branch lengths are assigned to each topology. The consequence of this assumption is that in certain situations the method is susceptible to &#x02018;long-branch attraction&#x02019; and spurious recombination can be inferred. Husmeier and Mantzaris (<xref ref-type="bibr" rid="B15">2008</xref>) discuss this issue in greater detail.</p></sec><sec id="SEC3"><title>3 INFERENCE</title><p>In order to infer the topologies and rates underlying the data, we employ a Markov chain Monte Carlo approach to find the posterior probability of topology <italic>T</italic><sub><italic>i</italic></sub> and average branch length <italic>R</italic><sub><italic>i</italic></sub> for each site in the data. For cases where the topologies are easily enumerable (i.e. for four or five taxa) we can use one state in our topology HMM for each of these. However, in order to avoid exploring the entire space of topologies for larger numbers of taxa, since many of them would contribute little to the likelihood of the data, we need to restrict our set of topologies. We propose to do this dynamically via the use of a sampling scheme analagous to a Stochastic Search Variable Selection approach (George and McCulloch, <xref ref-type="bibr" rid="B7">1995</xref>). Conceptually we can imagine an indicator variable &#x003b3;<sub><italic>j</italic></sub> on each of the (2<italic>k</italic>&#x02212;5)! /2<sup><italic>k</italic>&#x02212;3</sup>(<italic>k</italic>&#x02212;3)! possible topologies such that if &#x003b3;<sub><italic>j</italic></sub>=0 then the corresponding <italic>j</italic>-th state (topology) is not included in the HMM and if &#x003b3;<sub><italic>j</italic></sub>=1 then it is included.</p><p>Thus the (<italic>i</italic> +1)-th sample is obtained by sampling<disp-formula id="M7"><label>(7)</label><graphic xlink:href="btn607m7.jpg" position="float"/></disp-formula><disp-formula id="M8"><label>(8)</label><graphic xlink:href="btn607m8.jpg" position="float"/></disp-formula><disp-formula id="M9"><label>(9)</label><graphic xlink:href="btn607m9.jpg" position="float"/></disp-formula><disp-formula id="M10"><label>(10)</label><graphic xlink:href="btn607m10.jpg" position="float"/></disp-formula>where <bold><italic>T</italic></bold> and <bold><italic>R</italic></bold> represent a sample path through the topology and rate HMM, respectively. For the sampling step in (7), we first allow the topology HMM to update, then we sample a new path given the current states using the stochastic Forwards-Backwards algorithm of Boys et al. (<xref ref-type="bibr" rid="B1">2000</xref>).</p><p>Each time we update the topology HMM we may<list list-type="roman-lower"><list-item><p>add a new state to the HMM, i.e. select a state such that &#x003b3;<sub><italic>j</italic></sub> = 0 and propose to set &#x003b3;<sub><italic>j</italic></sub> =1;</p></list-item><list-item><p>remove an existing state from the HMM, i.e. select a state with &#x003b3;<sub><italic>j</italic></sub> =1 and set to &#x003b3;<sub><italic>j</italic></sub>=0, or; and</p></list-item><list-item><p>make a local rearrangement of an existing state (topology) in the HMM.</p></list-item></list></p><p>In order to jump between models with different numbers of included states we need a prior on the number of states &#x02211;<sub><italic>j</italic></sub> &#x003b3;<sub><italic>j</italic></sub> in the topology HMM. A natural choice for this is a Poisson distribution. Let <italic>K</italic><sub><italic>T</italic></sub> be the current number of states in the topology HMM, <italic>K</italic><sub><italic>T</italic></sub> = &#x02211;<sub><italic>j</italic></sub> &#x003b3;<sub><italic>j</italic></sub>, then<disp-formula id="M11"><label>(11)</label><graphic xlink:href="btn607m11.jpg" position="float"/></disp-formula>a truncated Poisson distribution with mean &#x003bb;. <italic>I</italic>(<italic>K</italic><sub><italic>T</italic></sub> &#x0003c; <italic>L</italic>) is the indicator function taking value 1 if <italic>K</italic><sub><italic>T</italic></sub> &#x0003c; <italic>L</italic> and 0 otherwise since we need at most <italic>L</italic> topologies to explain the data, which would correspond to one topology for each site in the alignment. The &#x003bb; is chosen a priori as the xpected number of regions in the data. It can be given as input to the method and throughout this article we set &#x003bb; = 5. We sample from the posterior by choosing one of the above moves at each step and then recording a path through the data using the stochastic Forwards-Backwards algorithm of Boys et al. (<xref ref-type="bibr" rid="B1">2000</xref>).The moves occur with probabilities<disp-formula id="M12"><label>(12)</label><graphic xlink:href="btn607m12.jpg" position="float"/></disp-formula>respectively, where <italic>c</italic> is a tuning constant. These are as in Suchard et al. (<xref ref-type="bibr" rid="B27">2003</xref>) and satisfy the detailed balance condition <italic>a</italic><sub><italic>K</italic><sub><italic>T</italic></sub></sub><italic>q</italic>(<italic>K</italic><sub><italic>T</italic></sub>) = <italic>r</italic><sub><italic>K</italic><sub><italic>T</italic>+1</sub></sub><italic>q</italic>(<italic>K</italic><sub><italic>T</italic>+1</sub>).</p><p>If we choose to add a topology a random <italic>n</italic>-taxa unrooted tree is generated from the prior. When removing a state we choose at random. When updating an existing topology we choose randomly and perform a local rearrangement by selecting a branch in the tree and cutting it. The two resulting subtrees are then joined together with a new branch (<xref ref-type="fig" rid="F1">Fig. 1</xref>). The resulting model is accepted or rejected according to the Metropolis-Hastings ratio:<disp-formula id="M13"><label>(13)</label><graphic xlink:href="btn607m13.jpg" position="float"/></disp-formula>Since we do not propose parameters that change across dimension, the Jacobian is equal to 1.<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>When we choose to update an existing topology, we perform a local rearrangement. A branch in the tree is selected [the dashed branch in subplot (a)] and this branch is removed. The resulting subtree is rejoined to the main tree at a new location [via the dotted branch in subplot (b)]</p></caption><graphic xlink:href="btn607f1"/></fig></p><p>For the sampling step in (8), we again sample a path through the data, this time through the states of the rate HMM, using the algorithm of Boys et al. (<xref ref-type="bibr" rid="B1">2000</xref>). In order to update the &#x003c1; parameters we can sample from a beta distribution. Let <italic>C</italic><sub><italic>T</italic></sub> = &#x02211;<sup><italic>L</italic>&#x02212;1</sup><sub><italic>i</italic>=1</sub> &#x003b4; (<italic>T</italic><sub><italic>i</italic></sub>,<italic>T</italic><sub><italic>i</italic>+1</sub>) and <italic>C</italic><sub><italic>R</italic></sub> =; &#x02211;<sup><italic>L</italic>&#x02212;1</sup><sub><italic>i</italic>=1</sub> &#x003b4; (<italic>R</italic><sub><italic>i</italic></sub>,<italic>R</italic><sub><italic>i</italic>+1</sub>). Then<disp-formula id="M14"><label>(14)</label><graphic xlink:href="btn607m14.jpg" position="float"/></disp-formula><disp-formula id="M15"><label>(15)</label><graphic xlink:href="btn607m15.jpg" position="float"/></disp-formula></p></sec><sec id="SEC4"><title>4 DATA</title><p>The proposed method has been tested on several datasets, both simulated and real. The datasets described below and the implemented method are available from <ext-link ext-link-type="uri" xlink:href="http://www.stats.ox.ac.uk/~webb">http://www.stats.ox.ac.uk/~webb</ext-link></p><sec id="SEC4.1"><title>4.1 Simulated data</title><p>Initially we consider a 4-taxa dataset which was generated using the BARGE program of Husmeier (<xref ref-type="bibr" rid="B12">2005</xref>). This generated a 1000 bp alignment using the Kimura model of substitution. Two recombination events were simulated as well as a 100 bp region of increased branch lengths of the topologies as shown in <xref ref-type="fig" rid="F2">Figure 2</xref>. Full details of the simulation are given in Husmeier (<xref ref-type="bibr" rid="B12">2005</xref>).<fig id="F2" position="float"><label>Fig. 2.</label><caption><p>Simulated recombination in a 4-species alignment. A change in topology is simulated between sites 200 and 300 and between sites 500 and 600. The average branch length of the topologies is increased by a factor of 10 between sites 800 and 900.</p></caption><graphic xlink:href="btn607f2"/></fig></p><p>We will also consider two datasets with more than four taxa. A 6-taxa dataset of length 1000 bp and a 15-taxa dataset of length 3000 bp were both generated using the program SeqGen of Rambaut and Grassly (<xref ref-type="bibr" rid="B25">1997</xref>). Data were simulated under an HKY model of mutation with a stationary distribution of (0.1, 0.4, 0.4 and 0.1) for the four nucleotides and a transition transversion ratio of 2.0. Rate heterogeneity was incorporated into the simulation by assigning different branch lengths in different parts of the tree. The average branch length for most of the alignment was 0.1 but each dataset contains a 100 bp region where the average length is increased to 1.0. The topologies and rates used to simulate the data are shown in <xref ref-type="fig" rid="F3">Figure 3</xref> and <xref ref-type="fig" rid="F4">Figure 4</xref> for the 6-taxa and 15-taxa datasets, respectively. As mentioned by a reviewer, our inference of recombination will be affected by the rate of substitution. This is explored in the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn607/DC1">Supplementary Materials</ext-link>.<fig id="F3" position="float"><label>Fig. 3.</label><caption><p>Simulated recombination in a 6-species alignment. A change in topology is simulated at sites 200 and 700. The average branch length undergoes a 10-fold increase between sites 400 and 500.</p></caption><graphic xlink:href="btn607f3"/></fig><fig id="F4" position="float"><label>Fig. 4.</label><caption><p>Simulated recombination in a 15-species alignment. A change in topology is simulated at sites 700, 1700 and 2500. The relative rate of evolution undergoes a 10-fold increase between sites 1200 and 1300.</p></caption><graphic xlink:href="btn607f4"/></fig></p><p>The MCMC algorithm was run for 50 000 iterations with the first 25 000 discarded as burn-in. The &#x003c1; parameters were initialized to be &#x003c1;<sub><italic>T</italic></sub> = &#x003c1;<sub><italic>R</italic></sub> = 0.9, since we do not expect recombination events or changes in rate to be common in our alignment. The resulting samples are used to form our posterior distribution on the probability of each topology at each site of the alignment.</p></sec><sec id="SEC4.2"><title>4.2 An HIV recombinant</title><p>As an application to a real dataset, we apply our method to the genome of an HIV-1 isolate, KAL153 (accession number AF193276). The isolate is aligned with consensus sequences of HIV-1 subtypes A, B and F since Liitsola et al. (<xref ref-type="bibr" rid="B17">1998</xref>) showed that KAL153 has genes originating from subtypes A and B. This dataset has previously been analyzed by (Minin et al., <xref ref-type="bibr" rid="B21">2005</xref>) in their DualMCP method which will provide a useful comparison to our approach. The algorithm was again run for 50 000 iterations and 25 000 were taken as our sample from the posterior.</p></sec><sec id="SEC4.3"><title>4.3 15 inbred mouse strains</title><p>Finally, we consider SNPs spanning the genomes of 15 strains of mice. Recently Yang et al. (<xref ref-type="bibr" rid="B28">2007</xref>) and Frazer et al. (<xref ref-type="bibr" rid="B6">2007</xref>) studied these data and attempted to identify varying ancestral origin of the 11 classical strains using the wild-derived strains as reference sequences for each subspecies. We study a 1 Mb region of chromosome 4 which has been mapped for ancestral origin by Frazer et al. (<xref ref-type="bibr" rid="B6">2007</xref>). The results in Frazer et al. (<xref ref-type="bibr" rid="B6">2007</xref>) are presented as blocks representing which of the four wild types each of the classical strains is derived from (<xref ref-type="fig" rid="F2">Fig. 2</xref> of their paper). Due to the larger number of taxa the algorithm was run for 100 000 iterations with the final 25 000 being used to make our posterior sample.</p></sec><sec id="SEC5"><title>5 RESULTS</title><p><xref ref-type="fig" rid="F5">Figure 5</xref> shows the predicted structure of the 4-taxa alignment using our Stochastic Topology HMM (STHMM). We have accurately recovered the locations of the changes in topology and evolutionary rate. The results are very similar to those of Husmeier (<xref ref-type="bibr" rid="B12">2005</xref>) for a similarly generated dataset. While this is not surprising, it does demonstrate the ability of the STHMM to infer recombination and rate heterogeneity correctly. The posterior probability shown in the figure is calculated as the average number of times each topology is present in the sampled path for each site of the alignment. The posterior probabilities are close to 1 for Topology 1 for most of the alignment and we see an obvious change in probability at the appropriate points giving us high confidence in the ability of the method to predict the changepoints.<fig id="F5" position="float"><label>Fig. 5.</label><caption><p>Results from the 4-taxa data simulated using the BARGE program of Husmeier (<xref ref-type="bibr" rid="B12">2005</xref>). The solid line corresponds to topology 1, the dashed line to topology 2 and the dotted line to topology 3. We have successfully recovered the recombination events. The bottom plots show the posterior probability for the different states in the rate HMM. The values of the average branch length are restricted to {0.001, 0.003, 0.01, 0.03, 0.1, 0.3, 1.0, 3.0, 10.0, 100.0}. Only rates with a posterior <italic>P</italic> &#x02265; 0 are shown in the plot. The proposed method has picked up a change in rate between sites 800 and 900.</p></caption><graphic xlink:href="btn607f5"/></fig></p><p>Our main goal is to be able to go beyond the case of 4-species alignments. <xref ref-type="fig" rid="F6">Figure 6</xref> shows the outcome of the STHMM when run on the simulated data for six taxa. Again we have successfully recovered the true trees under which the data were simulated as well as the changepoints for the factorial HMM. The STHMM was run on 100 replicates of the data to test for consistency. The average breakpoint location was taken across all samples in all runs and is shown in <xref ref-type="table" rid="T1">Table 1</xref>. In each of the 100 replicates, the true topologies used to generate the data were recovered by the STHMM. The method seems robust to other types of rate heterogeneity. Results are shown in the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn607/DC1">Supplementary Materials</ext-link>.<fig id="F6" position="float"><label>Fig. 6.</label><caption><p>Results from the 6-taxa data simulated using the SeqGen program of Rambaut and Grassly (<xref ref-type="bibr" rid="B25">1997</xref>). The solid line corresponds to topology 1, the dashed line to topology 2 and the dotted line to topology 3. We have successfully recovered the recombination events. The bottom plots show the posterior probability for the different states in the rate HMM as described in <xref ref-type="fig" rid="F5">Figure 5</xref>. We have inferred a change in rate between sites 400 and 500.</p></caption><graphic xlink:href="btn607f6"/></fig><table-wrap id="T1" position="float"><label>Table 1.</label><caption><p>Average breakpoint locations from 100 replicates of the 6-taxa and 15-taxa simulated data</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">Breakpoint 1</th><th rowspan="1" colspan="1">Breakpoint 2</th><th rowspan="1" colspan="1">Breakpoint 3</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">6 Taxa</td><td rowspan="1" colspan="1">198.97 (0.83)</td><td rowspan="1" colspan="1">702.59 (0.47)</td><td rowspan="1" colspan="1">&#x02212;</td></tr><tr><td rowspan="1" colspan="1">15 Taxa</td><td rowspan="1" colspan="1">701.95 (0.61)</td><td rowspan="1" colspan="1">1696.45 (2.62)</td><td rowspan="1" colspan="1">2499.56 (0.56)</td></tr></tbody></table><table-wrap-foot><fn><p>The averages for the 15-taxa data were taken over the datasets which contained that breakpoint (<xref ref-type="table" rid="T2">Table 2</xref>). The standard errors are shown in brackets.</p></fn></table-wrap-foot></table-wrap><table-wrap id="T2" position="float"><label>Table 2.</label><caption><p>Proportion of times each breakpoint was located and the average Robinson-Foulds distance between the inferred and true trees for each region over 100 replicates of the 15-taxa simulated data</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Breakpoint 1</th><th rowspan="1" colspan="1">Breakpoint 2</th><th rowspan="1" colspan="1">Breakpoint 3</th><th rowspan="1" colspan="1"/></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">0.88</td><td rowspan="1" colspan="1">0.51</td><td rowspan="1" colspan="1">0.81</td><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1">Topology 1</td><td rowspan="1" colspan="1">Topology 2</td><td rowspan="1" colspan="1">Topology 3</td><td rowspan="1" colspan="1">Topology 4</td></tr><tr><td rowspan="1" colspan="1">0.3 (0.09)</td><td rowspan="1" colspan="1">0.75 (0.11)</td><td rowspan="1" colspan="1">1.15 (0.13)</td><td rowspan="1" colspan="1">0.8 (0.18)</td></tr></tbody></table><table-wrap-foot><fn><p>The standard error for the Robinson-Foulds distance is shown in brackets.</p></fn></table-wrap-foot></table-wrap></p><p><xref ref-type="fig" rid="F7">Figure 7</xref> shows the inferred structure from the 15-taxa simulation. Again the STHMM has managed to recover the change in rate between sites 1200 and 1300. The changes in topology presented more of a problem here, due to the vastly increased state space (7, 905, 853, 580, 625 possible unrooted trees). We have not managed to detect all the breakpoints. Where one of the breakpoints is not located, the regions that are joined into one are represented by one &#x02018;compromise&#x02019; topology. <xref ref-type="table" rid="T1">Table 1</xref> shows the average breakpoint locations from 100 replicates and <xref ref-type="table" rid="T2">Table 2</xref> shows the proportion of times we recover a breakpoint at approximately the correct location (within 50 bp) and the average Robinson-Foulds distance between the inferred and true trees. This should give us a measure of how close our trees are to the ones used to generate the data. The Robinson-Foulds distance was calculated using the Split-Dist program of Mailund (<xref ref-type="bibr" rid="B18">2003</xref>). Since the state space is so large it is likely that we have not been able to propose the true trees underlying the data. In fact, if the ST-HMM algorithm is initialized with the four correct topologies it maintains them throughout and the likelihood is higher than that reached in any replicate where the truth is not recovered. Ideally, we would be able to propose to add new trees to the topology HMM that can be reached in one recombination event from an existing tree in the model. This idea is discussed in the Discussion section.<fig id="F7" position="float"><label>Fig. 7.</label><caption><p>Results from one run of the STHMM on the 15-taxa data simulated using the SeqGen program of Rambaut and Grassly (<xref ref-type="bibr" rid="B25">1997</xref>). We have inferred, correctly, a breakpoint at positions 700 and 2500, however we are not certain of the topology between sites 1700 and 2500. The trees inferred in this example are correct except for the region 3 tree which has a Robinson-Foulds distance of 3 from the true tree. The bottom plots show the posterior probability for the different states in the rate HMM as described in <xref ref-type="fig" rid="F5">Figure 5</xref>. We have correctly inferred a change in rate between sites 1200 and 1300.</p></caption><graphic xlink:href="btn607f7"/></fig></p><p>We now apply the STHMM to two real datasets, one alignment of four HIV strains which has been studied in Minin et al. (<xref ref-type="bibr" rid="B21">2005</xref>) and SNP data from 15 strains of inbred laboratory mice that have been investigated for variation in ancestral origin by Frazer et al. (<xref ref-type="bibr" rid="B6">2007</xref>). The results for the HIV-1 alignment are shown in <xref ref-type="fig" rid="F8">Figure 8</xref>. Subtypes A and B correspond to the taxon labels 1 and 2, respectively, and the KAL153 isolate is taxon 3. As we can see, the inferred structure of the suspected recombinant is (A,B,A,B,A). This is very similar to the result from the DualMCP (Minin et al., <xref ref-type="bibr" rid="B21">2005</xref>). However, we infer a change in topology at around site 4000 which is not inferred by the DualMCP.<fig id="F8" position="float"><label>Fig. 8.</label><caption><p>Results from the KAL153 isolate. The solid line corresponds to topology 1, the dashed line to topology 2 and the dotted line to topology 3 as in <xref ref-type="fig" rid="F2">Figure 2</xref>. The inferred recombinant structure is (A,B,A,B,A).</p></caption><graphic xlink:href="btn607f8"/></fig></p><p><xref ref-type="fig" rid="F9">Figure 9</xref>, shows the results for the 15 inbred mouse strains. In Frazer et al. (<xref ref-type="bibr" rid="B6">2007</xref>), a HMM is created with five states, one for each of the four ancestral strains and a state representing unknown origin. Each SNP for each classical strain is then assigned to one of these states by using the Viterbi algorithm. The STHMM is very consistent with the positions of the recombination breakpoints. However, it seems unable to resolve several of the splits in the tree and hence explores a large number of similar trees and we end up assigning a small posterior probability to many of them. To illustrate the results, we have therefore collected together the probabilities for several trees and represented them with a single tree with multifurcations.<fig id="F9" position="float"><label>Fig. 9.</label><caption><p>Results from the 15 inbred mouse strains. The trees output by the STHMM have been collected together into trees with multifurcations. The lines correspond to the following topologies: black&#x02014;1, red&#x02014;2, blue&#x02014;3, green&#x02014;4. The labels on the trees refer to the strains: 0&#x02014;DBA/2J, 1&#x02014;A/J, 2&#x02014;BALB/cByJ, 3&#x02014;C3H/HeJ, 4&#x02014;AKR/J, 5&#x02014;FVB/NJ, 6&#x02014;129S1/SvImJ, 7&#x02014;NOD/LtJ, 8&#x02014;WSB/EiJ, 9&#x02014;PWD/PhJ, 10&#x02014;BTBR T+ tf/J, 11&#x02014;CAST/EiJ, 12&#x02014;MOLF/EiJ, 13&#x02014;NZW/LacJ and 14&#x02014;KK/HlJ. The trees were drawn using the TreeView program of (Page, <xref ref-type="bibr" rid="B22">1996</xref>).</p></caption><graphic xlink:href="btn607f9"/></fig></p><p>While our results are not directly comparable to those of Frazer et al. (<xref ref-type="bibr" rid="B6">2007</xref>) since they only classify the 11 classical strains according to which of the four ancestral strains they are closest to at each point, there are similarities which lead us to believe that our results are meaningful. For example, in <xref ref-type="fig" rid="F2">Figure 2</xref> of Frazer et al. (<xref ref-type="bibr" rid="B6">2007</xref>) the strains BALB/cByJ, 129S1/SvImJ and KK/HlJ seem to share a similar pattern of ancestry. As we can see from our topologies in <xref ref-type="fig" rid="F9">Figure 9</xref>, taxa 2, 6 and 14 are grouped together consistently. Also, strain NZW/LacJ undergoes a change in ancestry from WSB/EiJ to PWD/PhJ in the method of Frazer et al. (<xref ref-type="bibr" rid="B6">2007</xref>). We see a change in our topologies where strain 13 is closer to strain 9 than strain 8 for topologies 3 and 4. The advantage of our method is that we are able to quantify our uncertainty at each position, since we consider the posterior probability of each topology rather than the single most likely outcome. We are also able to give greater detail of the ancestry of the mouse strains as we provide a topology relating all 15 strains instead of just considering which ancestral strain is the most similar to each of the 11 classical strains.</p></sec></sec><sec sec-type="discussion" id="SEC6"><title>6 DISCUSSION</title><p>We have developed a STHMM for inferring recombination breakpoints and rate heterogeneity and estimating the relationships between species. We have also successfully applied it to several datasets, both simulated and real. We are able to investigate problems beyond four taxa by not considering all possible phylogenies but instead focusing our stochastic search on trees with high posterior probability. Our method allows us to take advantage of the structure of HMMs to sample over all possible breakpoints using the stochastic Forwards-Backwards algorithm, assuming sufficient MCMC iterations. Therefore, we reduce the dimensionality of the problem by only needing to explore trees as opposed to breakpoint locations and trees as in Suchard et al. (<xref ref-type="bibr" rid="B27">2003</xref>) and Minin et al.(<xref ref-type="bibr" rid="B21">2005</xref>). The advantage of our method is that we take account of the uncertainty by allowing the data to dictate how many topologies we require and the most probable locations for the breakpoints.</p><p>One problem we did encounter was the difficulty for the method to detect breakpoints between trees which are very similar. One way to deal with this may be to allow both local and global trees to be proposed when we choose to add a new tree to the topology HMM. Global trees could be suggested from the prior; whereas, local trees would be restricted to be one &#x02018;subtree prune and regraft&#x02019; move away from an existing tree. This would require us to be able to calculate the probability of proposing a particular topology given the set of topologies already in the HMM. An algorithm for calculating the approximate &#x02018;SPR distance&#x02019; between two trees is proposed in de Oliveira Martins et al. (<xref ref-type="bibr" rid="B2">2008</xref>). This might enable a more focused search of the tree space although one must be careful to ensure that the probabilities of moving between trees take account of all possible paths between states.</p><p>For this analysis, we have fixed the rate HMM to contain a specified number of states. However, it would be possible to use a similar approach as for the topology HMM where we can add and remove states using reversible-jump MCMC (Green, <xref ref-type="bibr" rid="B9">1995</xref>; Lehrach and Husmeier, <xref ref-type="bibr" rid="B16">2008</xref>). This would be easy to implement, given the current structure but would add computational time since we would expect the MCMC to take longer to converge.</p></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material id="PMC_1" content-type="local-data"><caption><title>[Supplementary Data]</title></caption><media mimetype="text" mime-subtype="html" xlink:href="btn607_index.html"/><media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="btn607_1.pdf"/></supplementary-material></sec></body><back><ack><title>ACKNOWLEDGEMENTS</title><p>We thank the anonymous referees for their constructive comments. C.C.H. wishes to acknowledge support from the MolPAGE Consortium.</p><p><italic>Funding</italic>: Engineering and Physical Sciences Research Council.</p><p><italic>Conflict of Interest</italic>: none declared.</p></ack><ref-list><title>REFERENCES</title><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Boys</surname><given-names>RJ</given-names></name><etal/></person-group><article-title>Detecting homogeneous segments in DNA sequences by using hidden Markov models</article-title><source>Appl. Stat</source><year>2000</year><volume>49</volume><fpage>269</fpage><lpage>285</lpage></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>de Oliveira Martins</surname><given-names>L</given-names></name><etal/></person-group><article-title>Phylogenetic detection of recombination with a Bayesian prior on the distance between trees</article-title><source>PLoS ONE</source><year>2008</year><volume>3</volume></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Felsenstein</surname><given-names>J</given-names></name></person-group><article-title>Evolutionary trees from DNA sequences: a maximum likelihood approach</article-title><source>J. Mol. Evol</source><year>1981</year><volume>17</volume><fpage>368</fpage><lpage>374</lpage><pub-id pub-id-type="pmid">7288891</pub-id></citation></ref><ref id="B4"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Felsenstein</surname><given-names>J</given-names></name></person-group><source>PHYLIP (Phylogeny Inference Package) version 3.6.</source><year>2005a</year><publisher-loc>Seattle</publisher-loc><publisher-name>Department of Genome Sciences, University of Washington</publisher-name></citation></ref><ref id="B5"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Felsenstein</surname><given-names>J</given-names></name></person-group><source>Inferring Phylogenies.</source><year>2005b</year><publisher-name>Sinauer Associates, Inc</publisher-name></citation></ref><ref id="B6"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Frazer</surname><given-names>KA</given-names></name><etal/></person-group><article-title>A sequence-based variation map of 8.27 million SNPs in inbred mouse strains</article-title><source>Nature</source><year>2007</year><volume>448</volume><fpage>1050</fpage><lpage>1053</lpage><pub-id pub-id-type="pmid">17660834</pub-id></citation></ref><ref id="B7"><citation citation-type="book"><person-group person-group-type="author"><name><surname>George</surname><given-names>EI</given-names></name><name><surname>McCulloch</surname><given-names>RE</given-names></name></person-group><person-group person-group-type="editor"><name><surname>Gilks</surname><given-names>WR</given-names></name><etal/></person-group><article-title>Stochastic search variable selection. In</article-title><source>Markov Chain Monte Carlo in Practice.</source><year>1995</year><publisher-name>Chapman &#x00026; Hall</publisher-name><fpage>203</fpage><lpage>214</lpage></citation></ref><ref id="B8"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Grassly</surname><given-names>NC</given-names></name><name><surname>Holmes</surname><given-names>EC</given-names></name></person-group><article-title>A likelihood method for the detection of selection and recombination using nucleotide sequences</article-title><source>Mol. Biol. Evol</source><year>1997</year><volume>14</volume><fpage>239</fpage><lpage>247</lpage><pub-id pub-id-type="pmid">9066792</pub-id></citation></ref><ref id="B9"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Green</surname><given-names>PJ</given-names></name></person-group><article-title>Reversible jump markov chain monte carlo computation and Bayesian model determination</article-title><source>Biometrika</source><year>1995</year><volume>82</volume><fpage>711</fpage><lpage>732</lpage></citation></ref><ref id="B10"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hasegawa</surname><given-names>M</given-names></name><etal/></person-group><article-title>Dating the human-ape splitting by a molecular clock of mitochondrial DNA</article-title><source>J. Mol. Evol</source><year>1985</year><volume>22</volume><fpage>160</fpage><lpage>174</lpage><pub-id pub-id-type="pmid">3934395</pub-id></citation></ref><ref id="B11"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hobolth</surname><given-names>A</given-names></name><etal/></person-group><article-title>Genomic relationships and speciation times of human, chimpanzee, and gorilla inferred from a coalescent hidden Markov model</article-title><source>PLoS Genet</source><year>2007</year><volume>3</volume><fpage>294</fpage><lpage>304</lpage></citation></ref><ref id="B12"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Husmeier</surname><given-names>D</given-names></name></person-group><article-title>Discriminating between rate heterogeneity and interspecific recombination in DNA sequence alignments with phylogenetic hidden Markov models</article-title><source>Bioinformatics</source><year>2005</year><volume>21</volume><fpage>166</fpage><lpage>172</lpage></citation></ref><ref id="B13"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Husmeier</surname><given-names>D</given-names></name><name><surname>McGuire</surname><given-names>G</given-names></name></person-group><article-title>Detecting recombination with MCMC</article-title><source>Bioinformatics</source><year>2002</year><volume>18</volume><fpage>S345</fpage><lpage>S353</lpage><pub-id pub-id-type="pmid">12169565</pub-id></citation></ref><ref id="B14"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Husmeier</surname><given-names>D</given-names></name><name><surname>McGuire</surname><given-names>G</given-names></name></person-group><article-title>Detecting recombination in 4-taxa DNA sequence alignments with Bayesian hidden Markov models and Markov chain Monte Carlo</article-title><source>Mol. Biol. Evol</source><year>2003</year><volume>20</volume><fpage>315</fpage><lpage>337</lpage><pub-id pub-id-type="pmid">12644553</pub-id></citation></ref><ref id="B15"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Husmeier</surname><given-names>D</given-names></name><name><surname>Mantzaris</surname><given-names>A</given-names></name></person-group><article-title>Addressing the shortcomings of three recent Bayesian methods for detecting interspecific recombination in DNA sequence alignments</article-title><source>Stat. Appl. Genet. Mol. Biol</source><year>2008</year></citation></ref><ref id="B16"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lehrach</surname><given-names>W</given-names></name><name><surname>Husmeier</surname><given-names>D</given-names></name></person-group><article-title>Segmenting bacterial and viral DNA sequence alignments with a transdimensional phylogenetic factorial hidden Markov model</article-title><source>Appl. Stat</source><year>2008</year></citation></ref><ref id="B17"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Liitsola</surname></name><etal/></person-group><article-title>An AB recombinant and its parental HIV type 1 strains in the area of the former Soviet Union: low requirements for sequence identity in recombination</article-title><source>AIDS Res. Hum. Retroviruses</source><year>1998</year><volume>16</volume><fpage>1047</fpage><lpage>1053</lpage><pub-id pub-id-type="pmid">10933619</pub-id></citation></ref><ref id="B18"><citation citation-type="web"><person-group person-group-type="author"><name><surname>Mailund</surname><given-names>T</given-names></name></person-group><article-title>Split-Dist &#x02013; calculating split-distances for sets of trees</article-title><year>2003</year><comment>Available at <ext-link ext-link-type="uri" xlink:href="http://www.daimi.au.dk/~mailund/split-dist.html">http://www.daimi.au.dk/~mailund/split-dist.html</ext-link></comment></citation></ref><ref id="B19"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>McGuire</surname><given-names>G</given-names></name><etal/></person-group><article-title>A graphical method for detecting recombination in phylogenetic data sets</article-title><source>Mol. Biol. Evol</source><year>1997</year><volume>14</volume><fpage>1125</fpage><lpage>1131</lpage><pub-id pub-id-type="pmid">9364770</pub-id></citation></ref><ref id="B20"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>McGuire</surname><given-names>G</given-names></name><name><surname>Wright</surname><given-names>F</given-names></name></person-group><article-title>TOPAL 2.0: improved detection of mosaic sequences within multiple alignments</article-title><source>Bioinformatics</source><year>2000</year><volume>16</volume><fpage>130</fpage><lpage>134</lpage><pub-id pub-id-type="pmid">10842734</pub-id></citation></ref><ref id="B21"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Minin</surname><given-names>VN</given-names></name><etal/></person-group><article-title>Dual multiple change-point model leads to more accurate recombination detection</article-title><source>Bioinformatics</source><year>2005</year><volume>21</volume><fpage>3034</fpage><lpage>3042</lpage><pub-id pub-id-type="pmid">15914546</pub-id></citation></ref><ref id="B22"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Page</surname><given-names>RDM</given-names></name></person-group><article-title>TREEVIEW: an application to display phylogenetic trees on personal computers</article-title><source>Comput. Appl. Biosci</source><year>1996</year><volume>12</volume><fpage>357</fpage><lpage>358</lpage><pub-id pub-id-type="pmid">8902363</pub-id></citation></ref><ref id="B23"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Pattengale</surname><given-names>ND</given-names></name><etal/></person-group><article-title>Efficiently computing the robinson-foulds metric</article-title><source>J. Comput. Biol</source><year>2007</year><volume>14</volume><fpage>724</fpage><lpage>735</lpage><pub-id pub-id-type="pmid">17691890</pub-id></citation></ref><ref id="B24"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Rabiner</surname><given-names>LR</given-names></name></person-group><article-title>A tutorial on hidden Markov models and selected applications in speech recognition</article-title><source>Proc. IEEE</source><year>1989</year><volume>77</volume><fpage>257</fpage><lpage>286</lpage></citation></ref><ref id="B25"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Rambaut</surname><given-names>A</given-names></name><name><surname>Grassly</surname><given-names>NC</given-names></name></person-group><article-title>Seq-Gen: an application for the Monte Carlo simulation of DNA sequence evolution along phylogenetic trees</article-title><source>Comput. Appl. Biosci</source><year>1997</year><volume>13</volume><fpage>235</fpage><lpage>238</lpage><pub-id pub-id-type="pmid">9183526</pub-id></citation></ref><ref id="B26"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Schierup</surname><given-names>MH</given-names></name><name><surname>Hein</surname><given-names>J</given-names></name></person-group><article-title>Consequences of recombination on traditional phylogenetic analysis</article-title><source>Genetics</source><year>2000</year><volume>156</volume><fpage>879</fpage><lpage>891</lpage><pub-id pub-id-type="pmid">11014833</pub-id></citation></ref><ref id="B27"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Suchard</surname><given-names>MA</given-names></name><etal/></person-group><article-title>Inferring spatial phylogenetic variation along nucleotide sequences: a multiple changepoint model</article-title><source>J. Am. Stat. Assoc</source><year>2003</year><volume>98</volume><fpage>427</fpage><lpage>437</lpage></citation></ref><ref id="B28"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>H</given-names></name><etal/></person-group><article-title>On the subspecific origin of the laboratory mouse</article-title><source>Nat. Genet</source><year>2007</year><volume>39</volume><fpage>1100</fpage><lpage>1107</lpage><pub-id pub-id-type="pmid">17660819</pub-id></citation></ref></ref-list></back></article>