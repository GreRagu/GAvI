<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd"><article xmlns:xlink="http://www.w3.org/1999/xlink" article-type="product-review"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Genomics</journal-id><journal-title>BMC Genomics</journal-title><issn pub-type="epub">1471-2164</issn><publisher><publisher-name>BioMed Central</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">19117518</article-id><article-id pub-id-type="pmc">2636804</article-id><article-id pub-id-type="publisher-id">1471-2164-9-636</article-id><article-id pub-id-type="doi">10.1186/1471-2164-9-636</article-id><article-categories><subj-group subj-group-type="heading"><subject>Software</subject></subj-group></article-categories><title-group><article-title>OpenADAM: an open source genome-wide association data management system for Affymetrix SNP arrays</article-title></title-group><contrib-group><contrib id="A1" contrib-type="author"><name><surname>Yeung</surname><given-names>J MY</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>juilian@hku.hk</email></contrib><contrib id="A2" contrib-type="author"><name><surname>Sham</surname><given-names>P C</given-names></name><xref ref-type="aff" rid="I1">1</xref><xref ref-type="aff" rid="I2">2</xref><xref ref-type="aff" rid="I3">3</xref><email>pcsham@hku.hk</email></contrib><contrib id="A3" contrib-type="author"><name><surname>Chan</surname><given-names>A SW</given-names></name><xref ref-type="aff" rid="I2">2</xref><email>chansw3@hku.hk</email></contrib><contrib id="A4" corresp="yes" contrib-type="author"><name><surname>Cherny</surname><given-names>S S</given-names></name><xref ref-type="aff" rid="I1">1</xref><xref ref-type="aff" rid="I2">2</xref><xref ref-type="aff" rid="I3">3</xref><email>cherny@hku.hk</email></contrib></contrib-group><aff id="I1"><label>1</label>Department of Psychiatry, The University of Hong Kong, 21 Sassoon Road, Pokfulam, Hong Kong, PR China</aff><aff id="I2"><label>2</label>Genome Research Centre, The University of Hong Kong, 21 Sassoon Road, Pokfulam, Hong Kong, PR China</aff><aff id="I3"><label>3</label>The State Key Laboratory of Brain and Cognitive Sciences, The University of Hong Kong, 21 Sassoon Road, Pokfulam, Hong Kong, PR China</aff><pub-date pub-type="collection"><year>2008</year></pub-date><pub-date pub-type="epub"><day>31</day><month>12</month><year>2008</year></pub-date><volume>9</volume><fpage>636</fpage><lpage>636</lpage><ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2164/9/636"/><history><date date-type="received"><day>14</day><month>7</month><year>2008</year></date><date date-type="accepted"><day>31</day><month>12</month><year>2008</year></date></history><permissions><copyright-statement>Copyright &#x000a9; 2008 Yeung et al; licensee BioMed Central Ltd.</copyright-statement><copyright-year>2008</copyright-year><copyright-holder>Yeung et al; licensee BioMed Central Ltd.</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0"><p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p><!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>               Yeung               MY               J                              juilian@hku.hk            </dc:author><dc:title>            OpenADAM: an open source genome-wide association data management system for Affymetrix SNP arrays         </dc:title><dc:date>2008</dc:date><dcterms:bibliographicCitation>BMC Genomics 9(1): 636-. (2008)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2164(2008)9:1&#x0003c;636&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2164</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>--></license></permissions><abstract><sec><title>Background</title><p>Large scale genome-wide association studies have become popular since the introduction of high throughput genotyping platforms. Efficient management of the vast array of data generated poses many challenges.</p></sec><sec><title>Description</title><p>We have developed an open source web-based data management system for the large amount of genotype data generated from the Affymetrix GeneChip<sup>&#x000ae; </sup>Mapping Array and Affymetrix Genome-Wide Human SNP Array platforms. The database supports genotype calling using DM, BRLMM, BRLMM-P or Birdseed algorithms provided by the Affymetrix Power Tools. The genotype and corresponding pedigree data are stored in a relational database for efficient downstream data manipulation and analysis, such as calculation of allele and genotype frequencies, sample identity checking, and export of genotype data in various file formats for analysis using commonly-available software. A novel method for genotyping error estimation is implemented using linkage disequilibrium information from the HapMap project. All functionalities are accessible via a web-based user interface.</p></sec><sec><title>Conclusion</title><p>OpenADAM provides an open source database system for management of Affymetrix genome-wide association SNP data.</p></sec></abstract></article-meta></front><body><sec><title>Background</title><p>Large scale genome-wide association studies (GWAS) have become popular since the introduction of high throughput genotyping platforms. Hundreds of thousands of single nucleotide polymorphisms (SNPs) can be accurately and rapidly genotyped at a reasonable cost. GWAS allow researchers to pinpoint the genetic variations that are associated with susceptibility to complex disorders, such as bipolar disorder, coronary artery disease, Crohn's disease, hypertension, rheumatoid arthritis, and diabetes [<xref ref-type="bibr" rid="B1">1</xref>]. Affymetrix produce microarray genotyping technologies commonly used in GWAS, such as the Affymetrix GeneChip<sup>&#x000ae; </sup>platform, which includes the Mapping 500K array and the Affymetrix Genome-Wide Human SNP Array 5.0 and 6.0, assaying up to nearly 1,000,000 SNPs on a single microarray chip.</p><p>GeneChip<sup>&#x000ae; </sup>Genotyping Analysis Software (Affymetrix, Santa Clara, California) and Genotyping Console (Affymetrix, Santa Clara, California) are provided by Affymetrix to automate SNP allele calling and export of data. However, the functionality provided is rather primitive and lacks necessary features such as genotype data format conversion, allele and genotype frequency calculation, and data quality checking. While many existing software packages for downstream analysis of genetic data are command line programs designed for UNIX or Linux, the software provided by Affymetrix employs a graphical user interface designed solely for Microsoft Windows. Additionally, there may be multiple ongoing GWAS in an institution where different users should have different data access privileges. The existing software provided by Affymetrix may not be able to cope with actual data management needs, as there is a gap between the work flow of genotype data management and downstream statistical analysis of GWAS. With a view to filling this gap, the open source Association Data Management System (OpenADAM) package was developed.</p></sec><sec><title>Implementation</title><p>The OpenADAM software package has been designed to allow management and data quality checking of the large amount of genotype data from the Affymetrix microarray platforms. The command line programs for genotype calling provided in the Affymetrix Power Tools (APT) are embedded in a software framework and act as the starting point of the data pipeline. The raw intensities in the CEL files generated from Affymetrix chips are analyzed by the DM, BRLMM, BRLMM-P or Birdseed algorithms implemented in the APT and converted into genotype calls. The genotype call dataset is then parsed by scripts written in the PERL programming language and loaded into the MySQL relational database server. The use of MySQL as the storage engine allows efficient retrieval and query of genotype data for downstream analysis. A web-based user interface is written in the PHP programming language for use with an Apache web server. OpenADAM is open source and relies only on open source software and software freely available from Affymetrix. It also takes advantage of the security protections of MySQL and the SSL version of the Apache web server.</p></sec><sec><title>Results and discussion</title><p>The web interface allows users to remotely manage genotype data from their own projects with simple mouse clicks via a web browser. Each user of the system is given a user name and password to login and perform various operations. Users can view the list of called chips and the corresponding call rates, verify that samples done on the Nsp and Sty 250K arrays of the 500K microarray chip sets are indeed from the same individual, and calculate genotype and allele frequencies. Moreover, the system supports export of genotype data in formats suitable for downstream analysis using the standard software packages PLINK [<xref ref-type="bibr" rid="B2">2</xref>], Merlin [<xref ref-type="bibr" rid="B3">3</xref>] and Haploview [<xref ref-type="bibr" rid="B4">4</xref>]. Filters can be applied in order to export genotype data on a subset of chips or SNPs for tailored analysis.</p><p>In addition, a novel method to estimate the genotyping error rate is implemented in OpenADAM, which may serve as a data quality control metric and an aid in the calculation of statistical power. The estimation is based on linkage disequilibrium (LD) information of SNP pairs provided by the International HapMap Project [<xref ref-type="bibr" rid="B5">5</xref>]. About 7000 SNP pairs in the Affymetrix GeneChip<sup>&#x000ae; </sup>array sets were selected which satisfy the requirement that each SNP in a pair has minor allele frequencies of at least 0.1 and the pair is in perfect LD (<italic>r</italic><sup>2 </sup>= 1) in each of the African, European, Chinese, and Japanese populations in the HapMap [<xref ref-type="bibr" rid="B5">5</xref>] data. Under these specific conditions, any mismatch in genotype between the two SNPs of a pair is likely to be the result of a genotyping error. However, this could also mean that LD is in fact not perfect in a particular GWAS sample, as a result of employing a population different from those represented in HapMap. Additionally, LD may not even be perfect for some of those 7000 SNP pairs in the HapMap populations, but due to limited sample size, recombinants may not have been observed in HapMap. The proportion of mismatched SNP pairs, therefore, provides a lower-bound estimate of the genotyping error rate of each GeneChip<sup>&#x000ae;</sup>. Assuming that a mismatch occurs when and only when one of the two SNPs in the pair is miscalled, the estimated error rate (<italic>E</italic>) is obtained from the proportion of SNP pairs with mismatched genotypes (<italic>M </italic>= 2[<italic>E </italic>- <italic>E</italic><sup>2</sup>]), which gives <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" name="1471-2164-9-636-i1" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:msqrt><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn><mml:mi>M</mml:mi></mml:mrow></mml:msqrt></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>&#x02248;</mml:mo><mml:mfrac><mml:mi>M</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:semantics></mml:math></inline-formula> for small mismatch rates. This expression assumes that if there is an error in calling both SNPs of a given LD pair, there would be no mismatch (that is, both SNPs would be called with the same incorrect genotype). Given that having an error on both SNPs of an LD pair would be a very rare event and further given that if there is an error on both SNPs it is not likely it would be the same type of error for systematic reasons, this simplification shouldn't bias our estimate of error rate very much.</p><p>By plotting estimated chip error rate (<italic>E</italic>) versus chip call rate, for a sample of Affymetrix 500K Sty chips, as shown in Figure <xref ref-type="fig" rid="F1">1</xref>, we note the relationship between estimated error rate and call rate is very strong and linear (<italic>r </italic>= .95), which may aid in determining suitable cutoffs of call rate for discarding chips from analysis. From inspection of Figure <xref ref-type="fig" rid="F1">1</xref> and other data (not shown), we further note little empirical evidence to justify the Affymetrix quality control threshold of 93% call rate in this particular sample, with perhaps a more liberal cutoff being equally acceptable, since error rate generally appears to be low (&#x0003c; 2.5%) for 90% call rate chips and not very different from chips of 93% call rate.</p><fig position="float" id="F1"><label>Figure 1</label><caption><p><bold>Sample plot of estimated genotype error rate vs. mismatch rate for a sample of anonymous data genotyped using the Sty GeneChip<sup>&#x000ae; </sup>from the 500K set</bold>.</p></caption><graphic xlink:href="1471-2164-9-636-1"/></fig><p>We further validated this approach to error estimation by correlating estimated error rate, from 14 pairs of samples which our lab had genotyped twice using the Affymetrix 5.0 platform, with error rate estimated using the LD method (averaged across each pair of chips done on an individual), and found the two estimates were reasonably highly correlated (<italic>r </italic>= .81). However, there was a strong tendency to overestimate error using the LD approach, as indicated by only 31% of LD-detected errors being confirmed by duplicate genotyping. Across our 28 chips where we estimated error based on the LD pairs, we found as many as 90% of errors confirmed for a chip with an estimated average error rate of .8% (and 45% confirmed for the chip with the highest estimated error rate of 1.99%), but none of the errors were confirmed for some chips with the lowest error rate estimates of .08&#x02013;.28%. However, such low confirmation rates of LD-detected errors is somewhat misleading, given the substantial correlation (<italic>r </italic>= .68) between the LD-method estimated error rate and the percentage of confirmed errors, combined with the restricted range of error rates among these 28 chips. We suspect the method will be less biased for higher error rates (above 2%). Nonetheless, we caution the user that this approach appears to be only a very rough approximate estimate of the chip error rate. Further investigation of the approach is clearly needed to determine its validity.</p></sec><sec><title>Conclusion</title><p>We have developed OpenADAM, a web-based data management system to streamline the workflow of the large amount of genotype data in genome-wide association studies using the Affymetrix GeneChip<sup>&#x000ae; </sup>Mapping Array and Affymetrix Genome-Wide Human SNP Array platforms. This open source software will be a valuable resource for the research community performing GWAS.</p></sec><sec><title>Availability and requirements</title><p><bold>Project name: </bold>OpenADAM</p><p><bold>Project home page: </bold><ext-link ext-link-type="uri" xlink:href="http://openadam.sourceforge.net"/></p><p><bold>Operating system(s): </bold>Platform independent</p><p><bold>Programming language: </bold>MySQL, PERL, PHP</p><p><bold>Other requirements: </bold>Apache webserver and Affymetrix Power Tools</p><p><bold>License: </bold>GNU GPLv2</p><p><bold>Any restrictions to use by non-academics: </bold>None</p></sec><sec><title>Authors' contributions</title><p>PCS conceived of the software. JMYY, PCS, ASWC, and SSC designed the software. JMYY wrote the software code. JMYY and SSC wrote the manuscript and all authors revised and approved the final manuscript.</p></sec></body><back><ack><sec><title>Acknowledgements</title><p>Some of this work was done while JMYY was a Research Assistant in our group at the Genome Research Centre and partially supported by The University of Hong Kong's strategic research theme of Genomics, Proteomics and Bio-Informatics. We acknowledge support from grant EY-12562 from the National Insitutes of Health, USA, to PCS and SSC.</p></sec></ack><ref-list><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><collab>The Wellcome Trust Case Control Consortium</collab></person-group><article-title>Genome-wide association study of 14,000 cases of seven common diseases and 3,000 shared controls</article-title><source>Nature</source><year>2007</year><volume>447</volume><fpage>661</fpage><lpage>78</lpage><pub-id pub-id-type="pmid">17554300</pub-id><pub-id pub-id-type="doi">10.1038/nature05911</pub-id></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Purcell</surname><given-names>S</given-names></name><name><surname>Neale</surname><given-names>B</given-names></name><name><surname>Todd-Brown</surname><given-names>K</given-names></name><name><surname>Thomas</surname><given-names>L</given-names></name><name><surname>Ferreira</surname><given-names>MAR</given-names></name><name><surname>Bender</surname><given-names>D</given-names></name><name><surname>Maller</surname><given-names>J</given-names></name><name><surname>Sklar</surname><given-names>P</given-names></name><name><surname>de Bakker</surname><given-names>PIW</given-names></name><name><surname>Daly</surname><given-names>MJ</given-names></name><name><surname>Sham</surname><given-names>PC</given-names></name></person-group><article-title>PLINK: A Tool Set for Whole-Genome Association and Population-Based Linkage Analyses</article-title><source>Am J Hum Genet</source><year>2007</year><volume>81</volume><fpage>559</fpage><lpage>75</lpage><pub-id pub-id-type="pmid">17701901</pub-id><pub-id pub-id-type="doi">10.1086/519795</pub-id></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Abecasis</surname><given-names>GR</given-names></name><name><surname>Cherny</surname><given-names>SS</given-names></name><name><surname>Cookson</surname><given-names>WO</given-names></name><name><surname>Cardon</surname><given-names>LR</given-names></name></person-group><article-title>Merlin&#x02013;rapid analysis of dense genetic maps using sparse gene flow trees</article-title><source>Nature Genetics</source><year>2002</year><volume>30</volume><fpage>97</fpage><lpage>101</lpage><pub-id pub-id-type="pmid">11731797</pub-id><pub-id pub-id-type="doi">10.1038/ng786</pub-id></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Barrett</surname><given-names>J</given-names></name><name><surname>Fry</surname><given-names>B</given-names></name><name><surname>Maller</surname><given-names>J</given-names></name><name><surname>Daly</surname><given-names>M</given-names></name></person-group><article-title>Haploview: analysis and visualization of LD and haplotype maps</article-title><source>Bioinformatics</source><year>2005</year><volume>21</volume><fpage>263</fpage><lpage>265</lpage><pub-id pub-id-type="pmid">15297300</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/bth457</pub-id></citation></ref><ref id="B5"><citation citation-type="journal"><person-group person-group-type="author"><collab>The International HapMap Consortium</collab></person-group><article-title>A second generation human haplotype map of over 3.1 million SNPs</article-title><source>Nature</source><year>2007</year><volume>449</volume><fpage>851</fpage><lpage>861</lpage><pub-id pub-id-type="pmid">17943122</pub-id><pub-id pub-id-type="doi">10.1038/nature06258</pub-id></citation></ref></ref-list></back></article>