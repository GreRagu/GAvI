<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd"><article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article" xml:lang="EN"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id><journal-id journal-id-type="publisher-id">bioinformatics</journal-id><journal-id journal-id-type="hwp">bioinfo</journal-id><journal-title>Bioinformatics</journal-title><issn pub-type="ppub">1367-4803</issn><issn pub-type="epub">1460-2059</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">18849569</article-id><article-id pub-id-type="pmc">2639271</article-id><article-id pub-id-type="doi">10.1093/bioinformatics/btn533</article-id><article-id pub-id-type="publisher-id">btn533</article-id><article-categories><subj-group subj-group-type="heading"><subject>Applications Note</subject><subj-group><subject>Phylogenetics</subject></subj-group></subj-group></article-categories><title-group><article-title>POPE&#x02014;a tool to aid high-throughput phylogenetic analysis</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Juliusdottir</surname><given-names>Thorhildur</given-names></name><xref ref-type="corresp" rid="COR1">*</xref></contrib><contrib contrib-type="author"><name><surname>Pettersson</surname><given-names>Fredrik</given-names></name></contrib><contrib contrib-type="author"><name><surname>Copley</surname><given-names>Richard R.</given-names></name></contrib></contrib-group><aff>Wellcome Trust Centre for Human Genetics, Roosevelt Drive, Oxford, OX3 7BN, UK</aff><author-notes><corresp id="COR1">*To whom correspondence should be addressed.</corresp><fn><p>Associate Editor: Martin Bishop</p></fn></author-notes><pub-date pub-type="ppub"><day>1</day><month>12</month><year>2008</year></pub-date><pub-date pub-type="epub"><day>10</day><month>10</month><year>2008</year></pub-date><pub-date pub-type="pmc-release"><day>10</day><month>10</month><year>2008</year></pub-date><volume>24</volume><issue>23</issue><fpage>2778</fpage><lpage>2779</lpage><history><date date-type="received"><day>18</day><month>7</month><year>2008</year></date><date date-type="rev-recd"><day>8</day><month>10</month><year>2008</year></date><date date-type="accepted"><day>8</day><month>10</month><year>2008</year></date></history><permissions><copyright-statement>&#x000a9; 2008 The Author(s)</copyright-statement><copyright-year>2008</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/"><p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">http://creativecommons.org/licenses/by-nc/2.0/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</p></license></permissions><abstract><p><bold>Summary:</bold> POPE (Phylogeny, Ortholog and Paralog Extractor) provides an integrated platform for automatic ortholog identification. Intermediate steps can be visualized, modified and analyzed in order to assess and improve the underlying quality of orthology and paralogy assignments.</p><p><bold>Availability:</bold> POPE is available for download from the website: <ext-link ext-link-type="uri" xlink:href="http://www.well.ox.ac.uk/~tota/pope">http://www.well.ox.ac.uk/~tota/pope</ext-link>.</p><p><bold>Contact:</bold> <email>tota@well.ox.ac.uk</email></p></abstract></article-meta></front><body><sec sec-type="intro" id="SEC1"><title>1 INTRODUCTION</title><p>The correct identification of orthologs and paralogs is central to understanding gene function and studies of genome evolution. Orthologs are defined as genes related by a speciation event, whereas paralogs are related via an inter-genome duplication event. The formally correct way of identifying orthologs is therefore to infer a phylogenetic tree and then parse that tree for species relationships between genes. This approach is used by online databases, such as TreeFam (Li <italic>et al.</italic>, <xref ref-type="bibr" rid="B7">2006</xref>) and RIO/Forester (Zmasek and Eddy, <xref ref-type="bibr" rid="B9">2002</xref>), both of which compare a master species tree to individual gene trees to infer orthologs and paralogs from phylogenies. Tools such as Phylogenie (Frickey and Lupas, <xref ref-type="bibr" rid="B5">2004</xref>) automatically identify orthologs of a starting sequence, via database searching, sequence alignment, alignment processing and tree reconstruction. These intermediate steps, however, are hard to automate reliably in this context although their success can have a major impact on the quality of the resulting phylogeny. Such issues can often be dealt with by manually reviewing the underlying data, and modifying analysis techniques where necessary.</p></sec><sec id="SEC2"><title>2 DESCRIPTION</title><p>POPE (Phylogeny, Ortholog and Paralog Extractor) is a Java and Perl program, developed in order to aid in phylogenetic data analysis using a large number of proteins. POPE includes routines to sort phylogenetic trees based on the presence or absence of orthologs of the target gene, at the same time as graphically displaying alignments, phylogenies and domain locations within the multiple alignments.</p><p>The user can either apply POPE to previously generated phylogenies or use POPE to drive phylogeny generation. POPE provides an interface to fully automate traditional phylogenetic analysis using multiple query sequences (belonging to one species). Currently BLAST (Altschul <italic>et al.</italic>, <xref ref-type="bibr" rid="B1">1990</xref>) is used to search for homologs, MUSCLE (Edgar, <xref ref-type="bibr" rid="B4">2004</xref>) to align the homologs and PHYML (Guindon and Gascuel, <xref ref-type="bibr" rid="B6">2003</xref>) is applied for tree reconstruction, although in principle any equivalent tools could be used.</p><p>POPE identifies orthologs of the query sequence by parsing the local phylogenetic tree structure for genes or groups of species-specific paralogs related to the query by speciation events. Phylogenies displaying an orthologous relationship between the query species sequence and for example human, worm and fly can be extracted. The results are graphically displayed in tables in POPE, as shown in <xref ref-type="fig" rid="F1">Figure 1</xref>A and B. Two different layouts are used to display the results, called the <italic>Overview and Selection View</italic> and the <italic>Table View</italic>, respectively. The <italic>Overview and Selection View</italic> (<xref ref-type="fig" rid="F1">Fig. 1</xref>A) gives a numerical overview of the results and a schematic view of the presence/absence of any given gene in a particular species. For example, the results displayed in <xref ref-type="fig" rid="F1">Figure 1</xref>A, were obtained when 87 trees (including eight species) were read by POPE in the search for human, worm and fly genes that were orthologous to <italic>Nematostella vectensis</italic> genes. Out of the 87 trees, 29 fulfilled the requested orthology criterion according to the tree pattern search algorithm. The query sequences in these 29 trees, are represented as rows in the table in <xref ref-type="fig" rid="F1">Figure 1</xref>A (one row for each <italic>Nematostella</italic> sequence), along with its potential orthologs according to the tree structure. Colored rectangles indicate presence of a species whereas white rectangles represent its absence, i.e. the first row in the table in <xref ref-type="fig" rid="F1">Figure 1</xref>A shows that the associated <italic>Nematostella</italic> sequence has potential orthologs in seven out of the eight possible species. The rectangles are colored according to the bootstrap value supporting the branch of orthologs and whether the orthologs extracted from the phylogenies are also the top blast hits (<xref ref-type="fig" rid="F1">Fig. 1</xref>A). Phylogenies that are &#x02018;in agreement&#x02019; with the blast results as well as having their group of orthologs supported by a bootstrap value above a given threshold are automatically selected as &#x02018;good phylogenies/results&#x02019;. The user can regulate which trees are automatically selected by altering the bootstrap value supplied by default. By clicking on an entry in the overview table, or by selecting the results tab, the results can be viewed in the more detailed <italic>Table View</italic> (<xref ref-type="fig" rid="F1">Fig. 1</xref>C).<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>POPE's results viewer. (<bold>A</bold>) The <italic>Overview and Selection view,</italic> where each query sequence and its potential orthologs are represented in the table, color coded based on bootstrap and agreement with the blast results. (<bold>B</bold>) An image of one of the generated phylogenies. The group of orthologs is colored in red. (<bold>C</bold>) The <italic>Table view</italic>, illustrates the query sequence along with its potential orthologs and top blast hits. Graphical representations of all generated alignments and phylogenies are accessible through the interface. (<bold>D</bold>) The alignment panel shows the multiple alignment associated with the selected row, colored according to hydrophobicity. The target sequence is colored in yellow, and extracted domains are distinguished by a green color.</p></caption><graphic xlink:href="btn533f1"/></fig></p><p>The <italic>Table View</italic> is used to view, further analyze and sort the results. It has three tables associated with it: <italic>trees to sort</italic>, <italic>good trees</italic> and <italic>bad trees</italic> (<xref ref-type="fig" rid="F1">Fig. 1</xref>C). Table entries (rows) can be moved between all three tables by selecting them and clicking on the &#x02018;move to&#x02019; button. Grouping the results into the three tables, enables the user to spend most of his/her time viewing and modifying the data in the <italic>trees to sort</italic> table and gradually move the data into either the &#x02018;good&#x02019; or &#x02018;bad&#x02019; categories. Analyses are accessible through the tables in order to aid the selection of orthologs. GBlocks (Castresana, <xref ref-type="bibr" rid="B3">2000</xref>) and PHYML can be run to observe whether removing less conserved regions within the alignment will affect the arrangement of potential orthologs within the tree.</p><p>POPE keeps track of all the files generated for each query sequence, by listing them in the table. Each generated alignment file can then be viewed individually or all alignment files (along with the original files) can be viewed simultaneously for comparison (<xref ref-type="fig" rid="F1">Fig. 1</xref>B). Phylogenies are displayed through POPE using Njplot (Perriere and Gouy, <xref ref-type="bibr" rid="B8">1996</xref>). Alternatively, an image of the original phylogeny where the orthologous group has been colored in red can be viewed. The potential orthologs for each sequence are also listed in the table, where orthologs that are also the top blast hits are colored in red. The list of orthologs can be modified and saved by the user. Trees with less strong support might be clarified by best BLAST hits, so we highlight the top blast hits that are also among the group of orthologs. The entire BLAST file can also be examined through POPE's tables.</p><p>Information on domains retrieved from Ensembl (Birney <italic>et al.</italic>, <xref ref-type="bibr" rid="B2">2006</xref>), can also be extracted and displayed when available. This information is displayed on the right-hand side of the Table View in the <italic>Domain</italic> panel. A <italic>Tree</italic> panel and an <italic>Alignment</italic> panel are also displayed to the right in the Tree view. The tree panel shows the phylogeny of the selected table entry. The <italic>Alignment</italic> panel, shows the alignment belonging to the selected entry, color coded according to the hydrophobicity of the amino acids included in the alignment. When domains have been extracted using the domain panel, they are displayed in green within their respective sequence in the group panel (<xref ref-type="fig" rid="F1">Fig. 1</xref>D). This shows the user whether the available domains have been correctly aligned, and will assist in visually evaluating the quality of the multiple alignment.</p></sec><sec id="SEC3"><title>SUMMARY</title><p>In summary, POPE is a tool that automates phylogenetic analysis and offers an interactive environment to view, sort and further analyse the derived alignments and phylogenies. It provides the user with a graphical overview of the data, and makes it easy to apply different methods to the data and compare the outcome to the original results. By using POPE for large-scale phylogenetic analysis, a time-consuming and often tedious procedure due to the multiple steps involved, can be performed in an organized and efficient manner.</p></sec><sec id="SEC4"><title>SYSTEM REQUIREMENTS</title><p>POPE requires Java Runtime Environment version 1.5 or higher and BioPerl.</p><p><italic>Funding</italic>: Wellcome Trust (to R.R.C. and F.P.); Marie Curie FP6 RTN ZOONET (to T.J.).</p><p><italic>Conflict of Interest</italic>: none declared.</p></sec></body><back><ref-list><title>REFERENCES</title><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Altschul</surname><given-names>SF</given-names></name><etal/></person-group><article-title>Basic local alignment search tool</article-title><source>J. Mol. Biol.</source><year>1990</year><volume>215</volume><fpage>403</fpage><lpage>410</lpage><pub-id pub-id-type="pmid">2231712</pub-id></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Birney</surname><given-names>E</given-names></name><etal/></person-group><article-title>Ensembl 2006</article-title><source>Nucleic Acids Res.</source><year>2006</year><volume>34</volume><fpage>D556</fpage><lpage>D561</lpage><pub-id pub-id-type="pmid">16381931</pub-id></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Castresana</surname><given-names>J</given-names></name></person-group><article-title>Selection of conserved blocks from multiple alignments for their use in phylogenetic analysis</article-title><source>Mol. Biol. Evol.</source><year>2000</year><volume>17</volume><fpage>540</fpage><lpage>552</lpage><pub-id pub-id-type="pmid">10742046</pub-id></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Edgar</surname><given-names>RC</given-names></name></person-group><article-title>MUSCLE: multiple sequence alignment with high accuracy and high throughput</article-title><source>Nucleic Acids Res.</source><year>2004</year><volume>32</volume><fpage>1792</fpage><lpage>1797</lpage><pub-id pub-id-type="pmid">15034147</pub-id></citation></ref><ref id="B5"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Frickey</surname><given-names>T</given-names></name><name><surname>Lupas</surname><given-names>AN</given-names></name></person-group><article-title>PhyloGenie: automated phylome generation and analysis</article-title><source>Nucleic Acids Res.</source><year>2004</year><volume>32</volume><fpage>5231</fpage><lpage>5238</lpage><pub-id pub-id-type="pmid">15459293</pub-id></citation></ref><ref id="B6"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Guindon</surname><given-names>S</given-names></name><name><surname>Gascuel</surname><given-names>O</given-names></name></person-group><article-title>A simple, fast, and accurate algorithm to estimate large phylogenies by maximum likelihood</article-title><source>Syst. Biol.</source><year>2003</year><volume>52</volume><fpage>696</fpage><lpage>704</lpage><pub-id pub-id-type="pmid">14530136</pub-id></citation></ref><ref id="B7"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name><etal/></person-group><article-title>TreeFam: a curated database of phylogenetic trees of animal gene families</article-title><source>Nucleic Acids Res.</source><year>2006</year><volume>34</volume><fpage>D572</fpage><lpage>D580</lpage><pub-id pub-id-type="pmid">16381935</pub-id></citation></ref><ref id="B8"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Perriere</surname><given-names>G</given-names></name><name><surname>Gouy</surname><given-names>M</given-names></name></person-group><article-title>WWW-query: an on-line retrieval system for biological sequence banks</article-title><source>Biochimie</source><year>1996</year><volume>78</volume><fpage>364</fpage><lpage>369</lpage><pub-id pub-id-type="pmid">8905155</pub-id></citation></ref><ref id="B9"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Zmasek</surname><given-names>CM</given-names></name><name><surname>Eddy</surname><given-names>SR</given-names></name></person-group><article-title>RIO: analyzing proteomes by automated phylogenomics using resampled inference of orthologs</article-title><source>BMC Bioinformatics</source><year>2002</year><volume>3</volume><fpage>14</fpage><pub-id pub-id-type="pmid">12028595</pub-id></citation></ref></ref-list></back></article>