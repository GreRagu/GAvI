<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd"><article xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id><journal-title>BMC Bioinformatics</journal-title><issn pub-type="epub">1471-2105</issn><publisher><publisher-name>BioMed Central</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">19091030</article-id><article-id pub-id-type="pmc">2638147</article-id><article-id pub-id-type="publisher-id">1471-2105-9-S12-S7</article-id><article-id pub-id-type="doi">10.1186/1471-2105-9-S12-S7</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research</subject></subj-group></article-categories><title-group><article-title>Extracting transcription factor binding sites from unaligned gene sequences with statistical models</article-title></title-group><contrib-group><contrib id="A1" contrib-type="author"><name><surname>Lu</surname><given-names>Chung-Chin</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>cclu@ee.nthu.edu.tw</email></contrib><contrib id="A2" contrib-type="author"><name><surname>Yuan</surname><given-names>Wei-Hao</given-names></name><xref ref-type="aff" rid="I2">2</xref><email>whyuan@a-i-t.com.tw</email></contrib><contrib id="A3" corresp="yes" contrib-type="author"><name><surname>Chen</surname><given-names>Te-Ming</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>dmchen@abel.ee.nthu.edu.tw</email></contrib></contrib-group><aff id="I1"><label>1</label>Department of Electrical Engineering, National Tsing Hua University, Hsinchu 30013, Taiwan</aff><aff id="I2"><label>2</label>Alpha Imaging Technology Corp., Jubei City, Hsinchu 302, Taiwan</aff><pub-date pub-type="collection"><year>2008</year></pub-date><pub-date pub-type="epub"><day>12</day><month>12</month><year>2008</year></pub-date><volume>9</volume><issue>Suppl 12</issue><supplement><named-content content-type="supplement-title">Seventh International Conference on Bioinformatics (InCoB2008)</named-content><named-content content-type="supplement-editor">Shoba Ranganathan, Wen-Lian Hsu, Ueng-Cheng Yang and Tin Wee Tan</named-content></supplement><fpage>S7</fpage><lpage>S7</lpage><ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/9/S12/S7"/><permissions><copyright-statement>Copyright &#x000a9; 2008 Lu et al; licensee BioMed Central Ltd.</copyright-statement><copyright-year>2008</copyright-year><copyright-holder>Lu et al; licensee BioMed Central Ltd.</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0"><p>This is an open access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p><!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>               Lu               Chung-Chin                              cclu@ee.nthu.edu.tw            </dc:author><dc:title>            Extracting transcription factor binding sites from unaligned gene sequences with statistical models         </dc:title><dc:date>2008</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 9(Suppl 12): S7-. (2008)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2008)9:Suppl 12&#x0003c;S7&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>--></license></permissions><abstract><sec><title>Background</title><p>Transcription factor binding sites (TFBSs) are crucial in the regulation of gene transcription. Recently, chromatin immunoprecipitation followed by cDNA microarray hybridization (ChIP-chip array) has been used to identify potential regulatory sequences, but the procedure can only map the probable protein-DNA interaction loci within 1&#x02013;2 kb resolution. To find out the exact binding motifs, it is necessary to build a computational method to examine the ChIP-chip array binding sequences and search for possible motifs representing the transcription factor binding sites.</p></sec><sec><title>Results</title><p>We developed a program to find out accurate motif sites from a set of unaligned DNA sequences in the yeast genome. Compared with MDscan, the prediction results suggest that, overall, our algorithm outperforms MDscan since the predicted motifs are more consistent with previously known specificities reported in the literature and have better prediction ranks. Our program also outperforms the constraint-less Cosmo program, especially in the elimination of false positives.</p></sec><sec><title>Conclusion</title><p>In this study, an improved sampling algorithm is proposed to incorporate the binomial probability model to build significant initial candidate motif sets. By investigating the statistical dependence between base positions in TFBSs, the method of dependency graphs and their expanded Bayesian networks is combined. The results show that our program satisfactorily extract transcription factor binding sites from unaligned gene sequences.</p></sec></abstract><conference><conf-date>20&#x02013;23 October 2008</conf-date><conf-name>Asia Pacific Bioinformatics Network (APBioNet) Seventh International Conference on Bioinformatics (InCoB2008)</conf-name><conf-loc>Taipei, Taiwan</conf-loc></conference></article-meta></front><body><sec><title>Background</title><p>Understanding transcription is central to understanding genetic regulatory mechanisms. The transcription of a gene is generally dependent on the presence of specific signals located at upstream regions of the core-promoter. These specific signals derive from their use as binding sites by transcription factors (TFs), and are therefore termed transcription factor binding sites (TFBSs). Recently, chromatin immunoprecipitation followed by cDNA microarray hybridization (ChIP-chip array) has been used to identify potential regulatory sequences, but the procedure can only map the probable protein-DNA interaction loci within 1&#x02013;2 kilobases resolution [<xref ref-type="bibr" rid="B1">1</xref>]. To find out the exact binding motifs, it is necessary to build a computational method to examine the ChIP-chip array binding sequences and search for possible motifs representing the TFBSs (motif discovery).</p><p>There are many computational TFBS motif finding tools available [<xref ref-type="bibr" rid="B2">2</xref>-<xref ref-type="bibr" rid="B4">4</xref>]. The traditional approach for finding TFBSs is to collect and align a set of promoter sequences of co-regulated genes from either the literature or systematic experiments. Numerous computational tools, such as CONSENSUS [<xref ref-type="bibr" rid="B5">5</xref>], EM [<xref ref-type="bibr" rid="B6">6</xref>], MEME [<xref ref-type="bibr" rid="B7">7</xref>] and the Gibbs sampler [<xref ref-type="bibr" rid="B8">8</xref>], have utilized the approach to identify short DNA sequence motifs which are statistically over-represented in the promoter sequences.</p><p>Other than the alignment-based motif finding algorithms in above, many approaches have tried to extend to the use of evolutionary conservation information such as phylogenetic footprinting or the detection of combinations of binding sites (termed as cis-regulatory modules; CRMs) [<xref ref-type="bibr" rid="B2">2</xref>,<xref ref-type="bibr" rid="B3">3</xref>]. Phylogenetic footprinting methods [<xref ref-type="bibr" rid="B9">9</xref>-<xref ref-type="bibr" rid="B11">11</xref>] is an approach that seeks to identify conserved regulatory elements by comparing genomic sequences between related species. However, due to the statistical nature of the approach, e.g., a small amount of closely related species, not all transcription binding sites can be found by using phylogenetic footprinting. Hence, some algorithms have emerged to combine the alignment-based motif prediction with phylogenetic footprinting such as PhyloGibbs [<xref ref-type="bibr" rid="B12">12</xref>] and MY sampler [<xref ref-type="bibr" rid="B13">13</xref>]. On the other hand, by the detection of CRMs due to the cooperative interactions between TFs, algorithms like those in [<xref ref-type="bibr" rid="B14">14</xref>-<xref ref-type="bibr" rid="B16">16</xref>] can produce predictions of substantially better specificity than those of isolated sites.</p><p>Recently, more effective motif finders, e.g., MDscan [<xref ref-type="bibr" rid="B1">1</xref>], ANN-Spec [<xref ref-type="bibr" rid="B17">17</xref>], DMOTIFS [<xref ref-type="bibr" rid="B18">18</xref>], DME [<xref ref-type="bibr" rid="B19">19</xref>] and Cosmo [<xref ref-type="bibr" rid="B20">20</xref>], have taken the advantage of a background set, serving as a negative control. The goal of these discriminant motif finders is to search only for motifs that are most discriminating, that is, only those enriched in the foreground set relative to the background set [<xref ref-type="bibr" rid="B2">2</xref>]. Although these motif finders have improved the performance of TFBS prediction, it is still a trouble to have a satisfactory solution. How to find out accurate binding motifs may require much attention in the computational biology community. In this study, an improved sampling algorithm is proposed to incorporate the binomial probability model to build significant initial motif sets. By investigating the statistical dependence between base positions in TFBSs, it appears feasible to use statistical models to formulate the structural dependence of a motif in the identification of TFBSs. In light of this observation, the method of dependency graphs and their expanded Bayesian networks [<xref ref-type="bibr" rid="B21">21</xref>] is combined and prediction results show that our algorithm is able to find out motifs more consistent with previously known evidence.</p></sec><sec sec-type="methods"><title>Methods</title><p>Let <italic>TF </italic>be one of the transcription factors to be investigated. The binding dataset of the transcription factor <italic>TF</italic>, denoted as <italic>B</italic><sub><italic>TF</italic></sub>, consists of the sequences with low binding <italic>p</italic>-value (&#x0003c; 0.001) to the <italic>TF </italic>in the ChIP-chip array data [<xref ref-type="bibr" rid="B22">22</xref>]. A sliding window of size <italic>w </italic>is used to extract segments of length <italic>w </italic>when sliding through each of the sequences in <italic>B</italic><sub><italic>TF</italic></sub>.</p><p>Let <italic>S</italic><sub><italic>TF </italic></sub>be the collection of all extracted segments from <italic>B</italic><sub><italic>TF</italic></sub>, <italic>M </italic>the number of sequences in the binding dataset <italic>B</italic><sub><italic>TF</italic></sub>, <italic>L</italic><sub><italic>i </italic></sub>the length of the <italic>i</italic>th sequence in the binding dataset <italic>B</italic><sub><italic>TF</italic></sub>, and <italic>T</italic><sub><italic>TF </italic></sub>the total number of segments in <italic>S</italic><sub><italic>TF</italic></sub>. Then</p><p><disp-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" name="1471-2105-9-S12-S7-i1" overflow="scroll">                  <mml:semantics>                     <mml:mrow>                        <mml:msub>                           <mml:mi>T</mml:mi>                           <mml:mrow>                              <mml:mi>T</mml:mi>                              <mml:mi>F</mml:mi>                           </mml:mrow>                        </mml:msub>                        <mml:mo>=</mml:mo>                        <mml:mstyle displaystyle="true">                           <mml:munderover>                              <mml:mo>&#x02211;</mml:mo>                              <mml:mrow>                                 <mml:mi>i</mml:mi>                                 <mml:mo>=</mml:mo>                                 <mml:mn>1</mml:mn>                              </mml:mrow>                              <mml:mi>M</mml:mi>                           </mml:munderover>                           <mml:mrow>                              <mml:mo stretchy="false">(</mml:mo>                              <mml:msub>                                 <mml:mi>L</mml:mi>                                 <mml:mi>i</mml:mi>                              </mml:msub>                              <mml:mo>&#x02212;</mml:mo>                              <mml:mi>w</mml:mi>                              <mml:mo>+</mml:mo>                              <mml:mn>1</mml:mn>                              <mml:mo stretchy="false">)</mml:mo>                           </mml:mrow>                        </mml:mstyle>                        <mml:mo>.</mml:mo>                     </mml:mrow>                                       </mml:semantics>               </mml:math></disp-formula></p><p>To discover the binding motifs of the transcription factor <italic>TF</italic>, a number of initial candidate motif sets for <italic>TF </italic>is subsequently built from the collection <italic>S</italic><sub><italic>TF </italic></sub>of extracted segments. Note that the contents of segments, called patterns, in <italic>S</italic><sub><italic>TF </italic></sub>may not be distinct.</p><p>Most of early motif finding algorithms, such as Gibbs sampler [<xref ref-type="bibr" rid="B8">8</xref>] and MEME [<xref ref-type="bibr" rid="B23">23</xref>], have a weakness, where initial candidate motif sets are built by randomly extracting segments from sequences in the binding dataset <italic>B</italic><sub><italic>TF </italic></sub>(i.e. randomly selecting segments from the set <italic>S</italic><sub><italic>TF</italic></sub>). To improve the deficiency, the binomial probability distribution model is firstly utilized in the establishment of a number of initial candidate motif sets in our algorithm.</p><p>Then in the process of iterative sampling in our algorithm to expand and/or trim each of the initial candidate motif sets, the method of dependency graphs and their expanded Bayesian networks [<xref ref-type="bibr" rid="B21">21</xref>] is used to develop a statistical model for the background motif set identified as the union <italic>S </italic>= &#x0222a;<sub><italic>TF</italic></sub><italic>S</italic><sub><italic>TF </italic></sub>of segments extracted from all transcription factor binding datasets.</p><p>The basic procedure to find the binding motifs of the transcription factor <italic>TF </italic>is as follows:</p><p>1. Build <italic>N </italic>initial candidate motif sets.</p><p>(a) Take <italic>N </italic>distinct patterns from the set <italic>S</italic><sub><italic>TF </italic></sub>with the most highest significance scores as the candidates by the binomial distribution model (see the Binomial probability distribution model subsection).</p><p>(b) Then for each of the <italic>N </italic>significant binding site candidates for the transcription factor <italic>TF</italic>, in view of evolution, collect all segments in <italic>S</italic><sub><italic>TF </italic></sub>whose patterns have no more than <italic>d </italic>Hamming distance matching to the candidate pattern to form an initial candidate motif set.</p><p>At this stage, <italic>N </italic>initial candidate motif sets for the transcription factor <italic>TF </italic>are built.</p><p>2. Iteratively sample through the binding dateset <italic>B</italic><sub><italic>TF </italic></sub>to expand and/or trim each of the <italic>N </italic>initial candidate motif sets so that their approximate maximum a posteriori (AMAP) scores [<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B24">24</xref>] can keep increasing until the <italic>N </italic>candidate motif sets are invariant in <italic>K </italic>consecutive iterations (see the Iterative sampling subsection).</p><p>(a) In the calculation of AMAP scores in this stage, the background model for the background motif set <italic>S </italic>= &#x0222a;<sub><italic>TF</italic></sub><italic>S</italic><sub><italic>TF </italic></sub>is established under the method of dependency graphs and their expanded Bayesian networks (see the Method of dependency graphs and their expanded Bayesian networks subsection).</p><p>3. Refine each of the <italic>N </italic>candidate motif sets by re-examining all the segments already included in the motif set. A segment is removed from the motif set if doing so increases the AMAP score.</p><p>A simple flowchart for our algorithm is shown in Figure <xref ref-type="fig" rid="F1">1</xref>. The following subsections will expatiate on each stage of our algorithm. As an illustration of the dynamics of the PWM and the rank of different candidate motif sets at different stages of our algorithm, a summary of the prediction process for the motif of the transcription factor CBF1 is given in Figure <xref ref-type="fig" rid="F2">2</xref>.</p><fig position="float" id="F1"><label>Figure 1</label><caption><p>A flowchart of our algorithm.</p></caption><graphic xlink:href="1471-2105-9-S12-S7-1"/></fig><fig position="float" id="F2"><label>Figure 2</label><caption><p>An illustration of the dynamics of the PWM and the rank of five candidate motif sets at different stages of our algorithm in the motif prediction of the transcription factor CBF1.</p></caption><graphic xlink:href="1471-2105-9-S12-S7-2"/></fig><sec><title>Initial motif sets building</title><p>Our method begins by enumerating those patterns in <italic>S</italic><sub><italic>TF </italic></sub>that appear most often in the binding dataset <italic>B</italic><sub><italic>TF </italic></sub>than in others. What we want to do first is to calculate the appearance probability of a pattern in <italic>S</italic><sub><italic>TF</italic></sub>, which is the probability that the pattern appears no less than <italic>n </italic>times in the binding dataset <italic>B</italic><sub><italic>TF</italic></sub>. If a pattern <italic>b </italic>appears more often than other patterns in <italic>S</italic><sub><italic>TF </italic></sub>and its occurrence probability in a generic intergenic region is comparatively low, the calculated significance score of <italic>b </italic>would be relatively high. We will take patterns with the most highest significance scores as the candidates to build a number of initial candidate motif sets.</p><sec><title>Binomial probability distribution model</title><p>The probability to observe exactly <italic>j</italic> occurrences of pattern <italic>b </italic>in the collection <italic>S</italic><sub><italic>TF </italic></sub>of segments extracted from the binding dataset <italic>B</italic><sub><italic>TF </italic></sub>is estimated by the binomial distribution</p><p><disp-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2" name="1471-2105-9-S12-S7-i2" overflow="scroll">                        <mml:semantics>                           <mml:mrow>                              <mml:msub>                                 <mml:mi>P</mml:mi>                                 <mml:mrow>                                    <mml:mi>T</mml:mi>                                    <mml:mi>F</mml:mi>                                 </mml:mrow>                              </mml:msub>                              <mml:mo stretchy="false">(</mml:mo>                              <mml:mi>o</mml:mi>                              <mml:mi>c</mml:mi>                              <mml:mi>c</mml:mi>                              <mml:mo stretchy="false">(</mml:mo>                              <mml:mi>b</mml:mi>                              <mml:mo stretchy="false">)</mml:mo>                              <mml:mo>=</mml:mo>                              <mml:mi>j</mml:mi>                              <mml:mo stretchy="false">)</mml:mo>                              <mml:mo>=</mml:mo>                              <mml:mrow>                                 <mml:mo>(</mml:mo>                                 <mml:mrow>                                    <mml:mtable>                                       <mml:mtr>                                          <mml:mtd>                                             <mml:mrow>                                                <mml:msub>                                                   <mml:mi>T</mml:mi>                                                   <mml:mrow>                                                      <mml:mi>T</mml:mi>                                                      <mml:mi>F</mml:mi>                                                   </mml:mrow>                                                </mml:msub>                                             </mml:mrow>                                          </mml:mtd>                                       </mml:mtr>                                       <mml:mtr>                                          <mml:mtd>                                             <mml:mi>j</mml:mi>                                          </mml:mtd>                                       </mml:mtr>                                    </mml:mtable>                                 </mml:mrow>                                 <mml:mo>)</mml:mo>                              </mml:mrow>                              <mml:mo>&#x000d7;</mml:mo>                              <mml:msup>                                 <mml:mrow>                                    <mml:mo stretchy="false">(</mml:mo>                                    <mml:mi>f</mml:mi>                                    <mml:mo stretchy="false">(</mml:mo>                                    <mml:mi>b</mml:mi>                                    <mml:mo stretchy="false">)</mml:mo>                                    <mml:mo stretchy="false">)</mml:mo>                                 </mml:mrow>                                 <mml:mi>j</mml:mi>                              </mml:msup>                              <mml:mo>&#x000d7;</mml:mo>                              <mml:msup>                                 <mml:mrow>                                    <mml:mo stretchy="false">(</mml:mo>                                    <mml:mn>1</mml:mn>                                    <mml:mo>&#x02212;</mml:mo>                                    <mml:mi>f</mml:mi>                                    <mml:mo stretchy="false">(</mml:mo>                                    <mml:mi>b</mml:mi>                                    <mml:mo stretchy="false">)</mml:mo>                                    <mml:mo stretchy="false">)</mml:mo>                                 </mml:mrow>                                 <mml:mrow>                                    <mml:msub>                                       <mml:mi>T</mml:mi>                                       <mml:mrow>                                          <mml:mi>T</mml:mi>                                          <mml:mi>F</mml:mi>                                       </mml:mrow>                                    </mml:msub>                                    <mml:mo>&#x02212;</mml:mo>                                    <mml:mi>j</mml:mi>                                 </mml:mrow>                              </mml:msup>                              <mml:mo>,</mml:mo>                           </mml:mrow>                                                   </mml:semantics>                     </mml:math></disp-formula></p><p>where <italic>occ</italic>(<italic>b</italic>) is the occurrence times of pattern <italic>b </italic>in <italic>S</italic><sub><italic>TF </italic></sub>and <italic>f </italic>(<italic>b</italic>) is the probability that pattern <italic>b </italic>occurs in the intergenic region and is estimated as the relative frequency of pattern <italic>b </italic>in the union <italic>S </italic>= &#x0222a;<sub><italic>TF</italic></sub><italic>S</italic><sub><italic>TF </italic></sub>of segments extracted from all transcription factor binding datasets. The probability to observe <italic>n </italic>or more occurrences of the pattern <italic>b </italic>in <italic>S</italic><sub><italic>TF </italic></sub>is</p><p><disp-formula id="bmcM1"><label>(1)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M3" name="1471-2105-9-S12-S7-i3" overflow="scroll">                        <mml:semantics>                           <mml:mrow>                              <mml:msub>                                 <mml:mi>P</mml:mi>                                 <mml:mrow>                                    <mml:mi>T</mml:mi>                                    <mml:mi>F</mml:mi>                                 </mml:mrow>                              </mml:msub>                              <mml:mo stretchy="false">(</mml:mo>                              <mml:mi>o</mml:mi>                              <mml:mi>c</mml:mi>                              <mml:mi>c</mml:mi>                              <mml:mo stretchy="false">(</mml:mo>                              <mml:mi>b</mml:mi>                              <mml:mo stretchy="false">)</mml:mo>                              <mml:mo>&#x02265;</mml:mo>                              <mml:mi>n</mml:mi>                              <mml:mo stretchy="false">)</mml:mo>                              <mml:mo>=</mml:mo>                              <mml:mn>1</mml:mn>                              <mml:mo>&#x02212;</mml:mo>                              <mml:mstyle displaystyle="true">                                 <mml:munderover>                                    <mml:mo>&#x02211;</mml:mo>                                    <mml:mrow>                                       <mml:mi>j</mml:mi>                                       <mml:mo>=</mml:mo>                                       <mml:mn>0</mml:mn>                                    </mml:mrow>                                    <mml:mrow>                                       <mml:mi>n</mml:mi>                                       <mml:mo>&#x02212;</mml:mo>                                       <mml:mn>1</mml:mn>                                    </mml:mrow>                                 </mml:munderover>                                 <mml:mrow>                                    <mml:msub>                                       <mml:mi>P</mml:mi>                                       <mml:mrow>                                          <mml:mi>T</mml:mi>                                          <mml:mi>F</mml:mi>                                       </mml:mrow>                                    </mml:msub>                                    <mml:mo stretchy="false">(</mml:mo>                                    <mml:mi>o</mml:mi>                                    <mml:mi>c</mml:mi>                                    <mml:mi>c</mml:mi>                                    <mml:mo stretchy="false">(</mml:mo>                                    <mml:mi>b</mml:mi>                                    <mml:mo stretchy="false">)</mml:mo>                                    <mml:mo>=</mml:mo>                                    <mml:mi>j</mml:mi>                                    <mml:mo stretchy="false">)</mml:mo>                                 </mml:mrow>                              </mml:mstyle>                              <mml:mo>.</mml:mo>                           </mml:mrow>                                                   </mml:semantics>                     </mml:math></disp-formula></p><p>We define the significance score <italic>sig</italic><sub><italic>TF </italic></sub>(<italic>b</italic>) of a pattern <italic>b </italic>to <italic>TF </italic>as</p><p><disp-formula><italic>sig</italic><sub><italic>TF </italic></sub>(<italic>b</italic>) = -log<sub>10</sub>(<italic>P</italic><sub><italic>TF </italic></sub>(<italic>occ</italic>(<italic>b</italic>) &#x02265; <italic>n</italic>)).</disp-formula></p><p>The less probable pattern <italic>b </italic>in <italic>S </italic>appears more than <italic>n </italic>times in <italic>S</italic><sub><italic>TF</italic></sub>, the more probable will it be a binding site candidate for the transcription factor <italic>TF</italic>. We will take <italic>N </italic>distinct patterns with the most highest significance scores as the candidates.</p><p>For each of the <italic>N </italic>significant binding site candidates for the transcription factor <italic>TF</italic>, in view of evolution, collect all segments in <italic>S</italic><sub><italic>TF </italic></sub>whose patterns have no more than <italic>d </italic>Hamming distance matching to the candidate pattern to form an initial candidate motif set. Thus <italic>N </italic>initial candidate motif sets for the transcription factor <italic>TF </italic>are built at the end of this stage. As an example, the PWM and the rank of five initial candidate motif sets for the motif prediction of the transcription factor CBF1 are shown in Figure <xref ref-type="fig" rid="F2">2</xref>.</p></sec></sec><sec><title>Iterative sampling</title><p>In this stage, a sampling method is used to expand and/or trim each of the <italic>N </italic>initial candidate motif sets <italic>M</italic><sub>1</sub>, <italic>M</italic><sub>2</sub>,.., <italic>M</italic><sub><italic>N</italic></sub>. For our purpose, a false motif set <italic>M</italic><sub><italic>N</italic>+1 </sub>is created by randomly selecting <italic>e</italic><sub>0 </sub>(<italic>e</italic><sub>0 </sub>is equal to the maximum size of the <italic>N </italic>initial candidate motif sets) segments from the collection <italic>S</italic><sub><italic>TF </italic></sub>such that <italic>M</italic><sub><italic>i </italic></sub>&#x02229; <italic>M</italic><sub><italic>N</italic>+1 </sub>= &#x02205;, for all <italic>i </italic>= 1, 2,..., <italic>N</italic>. In addition, let the collection <italic>S </italic>= &#x0222a;<sub><italic>TF</italic></sub><italic>S</italic><sub><italic>TF </italic></sub>of segments extracted from all transcription factor binding datasets represent the intergenic background and here be denoted as <italic>M</italic><sub><italic>BG</italic></sub>.</p><sec><title>Approximate maximum a posteriori (AMAP) measure</title><p>The score <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M4" name="1471-2105-9-S12-S7-i4" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> of the approximate maximum a posteriori (AMAP) measure of the candidate motif set <italic>M</italic><sub><italic>i </italic></sub>is defined as [<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B24">24</xref>]</p><p><disp-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M5" name="1471-2105-9-S12-S7-i5" overflow="scroll">                        <mml:semantics>                           <mml:mrow>                              <mml:mi>a</mml:mi>                              <mml:mi>m</mml:mi>                              <mml:mi>a</mml:mi>                              <mml:msub>                                 <mml:mi>p</mml:mi>                                 <mml:mrow>                                    <mml:msub>                                       <mml:mi>M</mml:mi>                                       <mml:mi>i</mml:mi>                                    </mml:msub>                                 </mml:mrow>                              </mml:msub>                              <mml:mo>=</mml:mo>                              <mml:mfrac>                                 <mml:mn>1</mml:mn>                                 <mml:mi>w</mml:mi>                              </mml:mfrac>                              <mml:mrow>                                 <mml:mo>{</mml:mo>                                 <mml:mrow>                                    <mml:mstyle displaystyle="true">                                       <mml:munderover>                                          <mml:mo>&#x02211;</mml:mo>                                          <mml:mrow>                                             <mml:mi>s</mml:mi>                                             <mml:mo>=</mml:mo>                                             <mml:mn>0</mml:mn>                                          </mml:mrow>                                          <mml:mrow>                                             <mml:mi>w</mml:mi>                                             <mml:mo>&#x02212;</mml:mo>                                             <mml:mn>1</mml:mn>                                          </mml:mrow>                                       </mml:munderover>                                       <mml:mrow>                                          <mml:mstyle displaystyle="true">                                             <mml:munder>                                                <mml:mo>&#x02211;</mml:mo>                                                <mml:mrow>                                                   <mml:mi>j</mml:mi>                                                   <mml:mo>&#x02208;</mml:mo>                                                   <mml:mi>A</mml:mi>                                                   <mml:mo>,</mml:mo>                                                   <mml:mi>T</mml:mi>                                                   <mml:mo>,</mml:mo>                                                   <mml:mi>G</mml:mi>                                                   <mml:mo>,</mml:mo>                                                   <mml:mi>C</mml:mi>                                                </mml:mrow>                                             </mml:munder>                                             <mml:mrow>                                                <mml:msub>                                                   <mml:mi>p</mml:mi>                                                   <mml:mrow>                                                      <mml:mi>s</mml:mi>                                                      <mml:mo>,</mml:mo>                                                      <mml:mi>j</mml:mi>                                                   </mml:mrow>                                                </mml:msub>                                                <mml:mi>log</mml:mi>                                                <mml:mo>&#x02061;</mml:mo>                                                <mml:mo stretchy="false">(</mml:mo>                                                <mml:msub>                                                   <mml:mi>p</mml:mi>                                                   <mml:mrow>                                                      <mml:mi>s</mml:mi>                                                      <mml:mo>,</mml:mo>                                                      <mml:mi>j</mml:mi>                                                   </mml:mrow>                                                </mml:msub>                                                <mml:mo stretchy="false">)</mml:mo>                                             </mml:mrow>                                          </mml:mstyle>                                       </mml:mrow>                                    </mml:mstyle>                                    <mml:mo>&#x02212;</mml:mo>                                    <mml:mfrac>                                       <mml:mn>1</mml:mn>                                       <mml:mrow>                                          <mml:msub>                                             <mml:mi>n</mml:mi>                                             <mml:mi>i</mml:mi>                                          </mml:msub>                                       </mml:mrow>                                    </mml:mfrac>                                    <mml:mstyle displaystyle="true">                                       <mml:munder>                                          <mml:mo>&#x02211;</mml:mo>                                          <mml:mrow>                                             <mml:mi>m</mml:mi>                                             <mml:mo>&#x02208;</mml:mo>                                             <mml:msub>                                                <mml:mi>M</mml:mi>                                                <mml:mi>i</mml:mi>                                             </mml:msub>                                          </mml:mrow>                                       </mml:munder>                                       <mml:mrow>                                          <mml:mi>log</mml:mi>                                          <mml:mo>&#x02061;</mml:mo>                                          <mml:mo stretchy="false">(</mml:mo>                                          <mml:mi>P</mml:mi>                                          <mml:mo stretchy="false">(</mml:mo>                                          <mml:mi>m</mml:mi>                                          <mml:mo>|</mml:mo>                                          <mml:msub>                                             <mml:mi>M</mml:mi>                                             <mml:mrow>                                                <mml:mi>B</mml:mi>                                                <mml:mi>G</mml:mi>                                             </mml:mrow>                                          </mml:msub>                                          <mml:mo stretchy="false">)</mml:mo>                                          <mml:mo stretchy="false">)</mml:mo>                                       </mml:mrow>                                    </mml:mstyle>                                 </mml:mrow>                                 <mml:mo>}</mml:mo>                              </mml:mrow>                              <mml:mo>,</mml:mo>                           </mml:mrow>                                                   </mml:semantics>                     </mml:math></disp-formula></p><p>where <italic>p</italic><sub><italic>s</italic>, <italic>j </italic></sub>is the frequency of nucleotide <italic>j </italic>at base position <italic>s </italic>in the candidate motif set <italic>M</italic><sub><italic>i</italic></sub>(which can be retrieved from the position specific scoring matrix (PSSM) of <italic>M</italic><sub><italic>i</italic></sub>), <italic>n</italic><sub><italic>i </italic></sub>is the number of segments in <italic>M</italic><sub><italic>i</italic></sub>, and <italic>P</italic>(<italic>m</italic>|<italic>M</italic><sub><italic>BG</italic></sub>) is the probability of the pattern of segment <italic>m </italic>in the motif set <italic>M</italic><sub><italic>i </italic></sub>under an expanded Bayesian network (EBN) model [<xref ref-type="bibr" rid="B21">21</xref>] developed from the background motif set <italic>M</italic><sub><italic>BG </italic></sub>(EBN model will be discussed shortly).</p><p>The first part of the AMAP score is a negative entropy, which is higher if there are more similar patterns in the candidate motif set <italic>M</italic><sub><italic>i</italic></sub>. A motif set <italic>M</italic><sub><italic>i </italic></sub>with all identical patterns has the maximum negative entropy 0, whereas equal nucleotide frequencies at every position in the PSSM of <italic>M</italic><sub><italic>i </italic></sub>has the minimum negative entropy. And a segment <italic>m </italic>in the candidate motif set <italic>M</italic><sub><italic>i </italic></sub>which has a pattern much different from the background motif model built from <italic>M</italic><sub><italic>BG </italic></sub>would have lower appearance probability <italic>P </italic>(<italic>m</italic>|<italic>M</italic><sub><italic>BG</italic></sub>) and hence increases the score <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M6" name="1471-2105-9-S12-S7-i4" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> of the AMAP measure of <italic>M</italic><sub><italic>i</italic></sub>.</p></sec><sec><title>Sampling strategy</title><p>In each iteration, there are two steps for the sampler, the S-step and the M-step.</p><p>In the S-step, the sampler samples a site by randomly selecting a sequence from <italic>B</italic><sub><italic>TF </italic></sub>and then randomly picking up a site in the selected sequence to extract a segment <italic>m</italic><sub><italic>s </italic></sub>of length <italic>w</italic>. For 1 &#x02264; <italic>i </italic>&#x02264; <italic>N</italic>, if the sampled segment <italic>m</italic><sub><italic>s </italic></sub>appears in <italic>M</italic><sub><italic>i</italic></sub>, segment <italic>m</italic><sub><italic>s </italic></sub>will be removed from <italic>M</italic><sub><italic>i </italic></sub>if the AMAP score <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M7" name="1471-2105-9-S12-S7-i4" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> of the candidate motif set <italic>M</italic><sub><italic>i </italic></sub>increases after its removal; otherwise, segment <italic>m</italic><sub><italic>s </italic></sub>will be kept in <italic>M</italic><sub><italic>i</italic></sub>. Note that the PSSM of the motif model <italic>M</italic><sub><italic>i </italic></sub>should be retrained if the sampled segment <italic>m</italic><sub><italic>s </italic></sub>is removed from <italic>M</italic><sub><italic>i</italic></sub>.</p><p>Which one of the <italic>N </italic>+ 1 motif sets would be the best motif set for the sampled segment <italic>m</italic><sub><italic>s </italic></sub>will depend on the appendant score <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M8" name="1471-2105-9-S12-S7-i6" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>a</mml:mi><mml:mi>p</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> that the segment <italic>m</italic><sub><italic>s </italic></sub>is derived from <italic>M</italic><sub><italic>i </italic></sub>[<xref ref-type="bibr" rid="B24">24</xref>,<xref ref-type="bibr" rid="B25">25</xref>]</p><p><disp-formula id="bmcM2"><label>(2)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M9" name="1471-2105-9-S12-S7-i7" overflow="scroll">                        <mml:semantics>                           <mml:mrow>                              <mml:mi>a</mml:mi>                              <mml:mi>p</mml:mi>                              <mml:msub>                                 <mml:mi>p</mml:mi>                                 <mml:mrow>                                    <mml:msub>                                       <mml:mi>M</mml:mi>                                       <mml:mi>i</mml:mi>                                    </mml:msub>                                 </mml:mrow>                              </mml:msub>                              <mml:mo>=</mml:mo>                              <mml:mi>log</mml:mi>                              <mml:mo>&#x02061;</mml:mo>                              <mml:mrow>                                 <mml:mo>(</mml:mo>                                 <mml:mrow>                                    <mml:mfrac>                                       <mml:mrow>                                          <mml:mi>P</mml:mi>                                          <mml:mo stretchy="false">(</mml:mo>                                          <mml:msub>                                             <mml:mi>n</mml:mi>                                             <mml:mi>i</mml:mi>                                          </mml:msub>                                          <mml:mo stretchy="false">)</mml:mo>                                       </mml:mrow>                                       <mml:mrow>                                          <mml:mn>1</mml:mn>                                          <mml:mo>&#x02212;</mml:mo>                                          <mml:mi>P</mml:mi>                                          <mml:mo stretchy="false">(</mml:mo>                                          <mml:msub>                                             <mml:mi>n</mml:mi>                                             <mml:mi>i</mml:mi>                                          </mml:msub>                                          <mml:mo stretchy="false">)</mml:mo>                                       </mml:mrow>                                    </mml:mfrac>                                    <mml:mfrac>                                       <mml:mrow>                                          <mml:mi>P</mml:mi>                                          <mml:mo stretchy="false">(</mml:mo>                                          <mml:msub>                                             <mml:mi>m</mml:mi>                                             <mml:mi>s</mml:mi>                                          </mml:msub>                                          <mml:mo>|</mml:mo>                                          <mml:msub>                                             <mml:mi>M</mml:mi>                                             <mml:mi>i</mml:mi>                                          </mml:msub>                                          <mml:mo stretchy="false">)</mml:mo>                                       </mml:mrow>                                       <mml:mrow>                                          <mml:mi>P</mml:mi>                                          <mml:mo stretchy="false">(</mml:mo>                                          <mml:msub>                                             <mml:mi>m</mml:mi>                                             <mml:mi>s</mml:mi>                                          </mml:msub>                                          <mml:mo>|</mml:mo>                                          <mml:msub>                                             <mml:mi>M</mml:mi>                                             <mml:mrow>                                                <mml:mi>B</mml:mi>                                                <mml:mi>G</mml:mi>                                             </mml:mrow>                                          </mml:msub>                                          <mml:mo stretchy="false">)</mml:mo>                                       </mml:mrow>                                    </mml:mfrac>                                 </mml:mrow>                                 <mml:mo>)</mml:mo>                              </mml:mrow>                              <mml:mo>,</mml:mo>                              <mml:mn>1</mml:mn>                              <mml:mo>&#x02264;</mml:mo>                              <mml:mi>i</mml:mi>                              <mml:mo>&#x02264;</mml:mo>                              <mml:mi>N</mml:mi>                              <mml:mo>+</mml:mo>                              <mml:mn>1</mml:mn>                              <mml:mo>,</mml:mo>                           </mml:mrow>                                                   </mml:semantics>                     </mml:math></disp-formula></p><p>where <italic>n</italic><sub><italic>i </italic></sub>is the size of current motif set <italic>M</italic><sub><italic>i</italic></sub>, <italic>P</italic>(<italic>n</italic><sub><italic>i</italic></sub>) equals <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M10" name="1471-2105-9-S12-S7-i8" overflow="scroll"><mml:semantics><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>F</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:semantics></mml:math></inline-formula>, <italic>P</italic>(<italic>m</italic><sub><italic>s</italic></sub>|<italic>M</italic><sub><italic>i</italic></sub>) and <italic>P</italic>(<italic>m</italic><sub><italic>s</italic></sub>|<italic>M</italic><sub><italic>BG</italic></sub>) are the probabilities of the content of the sampled segment <italic>m</italic><sub><italic>s </italic></sub>under the PSSM model developed from the current motif set <italic>M</italic><sub><italic>i </italic></sub>and under an EBN model developed from the background <italic>M</italic><sub><italic>BG</italic></sub>, respectively. The sampled segment <italic>m</italic><sub><italic>s </italic></sub>will be considered to append into the motif set <italic>M</italic><sub><italic>i </italic></sub>with the highest appendant score <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M11" name="1471-2105-9-S12-S7-i6" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>a</mml:mi><mml:mi>p</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>. If <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M12" name="1471-2105-9-S12-S7-i9" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>a</mml:mi><mml:mi>p</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> is the highest score, then the sampled segment <italic>m</italic><sub><italic>s </italic></sub>is appended into the false motif set <italic>M</italic><sub><italic>N</italic>+1 </sub>unless <italic>m</italic><sub><italic>s </italic></sub>is already there and the current iteration stops here. If for some <italic>i</italic>, 1 &#x02264; <italic>i </italic>&#x02264; <italic>N</italic>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M13" name="1471-2105-9-S12-S7-i6" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>a</mml:mi><mml:mi>p</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> is the highest score, the sampled segment <italic>m</italic><sub><italic>s </italic></sub>will be further checked in the M-step to see if we really want to append <italic>m</italic><sub><italic>s </italic></sub>into <italic>M</italic><sub><italic>i </italic></sub>unless we have processed <italic>m</italic><sub><italic>s </italic></sub>for <italic>M</italic><sub><italic>i </italic></sub>at the beginning of this S-step as in above and the current iteration stops here.</p><p>In the M-step, the sampler has to decide whether the newly sampled segment <italic>m</italic><sub><italic>s </italic></sub>should be appended into the candidate motif set <italic>M</italic><sub><italic>i </italic></sub>or not. The AMAP measure again will be used to evaluate our decision. The sampled segment <italic>m</italic><sub><italic>s </italic></sub>is appended into the candidate motif set <italic>M</italic><sub><italic>i </italic></sub>if and only if the score <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M14" name="1471-2105-9-S12-S7-i4" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> of the motif model <italic>M</italic><sub><italic>i </italic></sub>is increased once the sampled segment <italic>m</italic><sub><italic>s </italic></sub>is appended to <italic>M</italic><sub><italic>i</italic></sub>. Note that the PSSM of the motif model <italic>M</italic><sub><italic>i </italic></sub>should be retrained after the sampled segment <italic>b</italic><sub><italic>s </italic></sub>is appended to <italic>M</italic><sub><italic>i</italic></sub>. Now the M-step is done and the current iteration stops here.</p><p>The sampler will iteratively sample through the binding dataset <italic>B</italic><sub><italic>TF </italic></sub>to expand and/or trim the <italic>N </italic>candidate motif sets <italic>M</italic><sub>1</sub>, <italic>M</italic><sub>2</sub>,.., <italic>M</italic><sub><italic>N </italic></sub>so that their AMAP scores <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M15" name="1471-2105-9-S12-S7-i4" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> will keep increasing. The <italic>N </italic>candidate motif sets will tend to be invariant after a (larger) number of iterations. The stopping criterion of the sampling process is that all the <italic>N </italic>candidate motif sets are invariant in <italic>K </italic>consecutive iterations. The parameter <italic>K </italic>is usually set to be 1% of the size of <italic>S</italic><sub><italic>TF</italic></sub>.</p></sec><sec><title>Alternative sampling strategy</title><p>There is an alternative sampling strategy as follows.</p><p>In the S-step, the new sampler also randomly samples a site from a sequence in <italic>B</italic><sub><italic>TF </italic></sub>to extract a segment <italic>m</italic><sub><italic>s</italic></sub>of length <italic>w</italic>. For 1 &#x02264; <italic>i </italic>&#x02264; <italic>N</italic>, if the pattern of the sampled segment <italic>m</italic><sub><italic>s </italic></sub>appears in <italic>M</italic><sub><italic>i</italic></sub>, all the segments in <italic>M</italic><sub><italic>i </italic></sub>whose pattern is the same as that of <italic>m</italic><sub><italic>s </italic></sub>will be removed if the AMAP score <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M16" name="1471-2105-9-S12-S7-i4" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> of the motif set <italic>M</italic><sub><italic>i </italic></sub>increases after their removal. Otherwise, these segments will be kept in <italic>M</italic><sub><italic>i</italic></sub>.</p><p>Also in the S-step, if <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M17" name="1471-2105-9-S12-S7-i9" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>a</mml:mi><mml:mi>p</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> is the highest among all <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M18" name="1471-2105-9-S12-S7-i6" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>a</mml:mi><mml:mi>p</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>, 1 &#x02264; <italic>i </italic>&#x02264; <italic>N </italic>+ 1, then all segments in the set <italic>S</italic><sub><italic>TF </italic></sub>having the same pattern as that of the sampled segment <italic>m</italic><sub><italic>s </italic></sub>will be appended into the false motif set <italic>M</italic><sub><italic>N</italic>+1 </sub>unless these segments are already there and the current iteration stops here. If <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M19" name="1471-2105-9-S12-S7-i6" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>a</mml:mi><mml:mi>p</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> is the highest for some <italic>i</italic>, 1 &#x02264; <italic>i </italic>&#x02264; <italic>N</italic>, the sampled segment <italic>m</italic><sub><italic>s </italic></sub>will be further checked in the M-step to see if we really want to append those segments in the set <italic>S</italic><sub><italic>TF </italic></sub>having the same pattern as that of the sampled segment <italic>m</italic><sub><italic>s </italic></sub>into <italic>M</italic><sub><italic>i </italic></sub>unless we have already processed those segments for <italic>M</italic><sub><italic>i </italic></sub>at the beginning of this S-step as in above and the current iteration stops here.</p><p>In the M-step, all the segments in the set <italic>S</italic><sub><italic>TF </italic></sub>having the same pattern as that of the sampled segment <italic>m</italic><sub><italic>s </italic></sub>are decided to append to the candidate motif set <italic>M</italic><sub><italic>i </italic></sub>if and only if the AMAP score <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M20" name="1471-2105-9-S12-S7-i4" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> of <italic>M</italic><sub><italic>i </italic></sub>increases after these segaments are appended into <italic>M</italic><sub><italic>i</italic></sub>.</p></sec><sec><title>Method of dependency graphs and their expanded Bayesian networks</title><p>Considering the binding mechanism of transcription factors to specific DNA sites (motifs), there must be distinctive features for the specific motif regions from other intergenic regions which represent the background DNA sequence. Hence, it is conceivable that we can use a statistical model to capture the feature of a specific DAN site (motif) or a generic DNA intergenic region (background). Since the size of a candidate motif set <italic>M</italic><sub><italic>i </italic></sub>is often small, a PSSM model is commonly used for <italic>M</italic><sub><italic>i </italic></sub>instead of any other more sophisticated statistical model. However, the size of the background motif set <italic>M</italic><sub><italic>BG </italic></sub>is usually large enough to be equipped with a more sophisticated one.</p><p>As reported in [<xref ref-type="bibr" rid="B21">21</xref>], a dependency graph model is used to fully capture the intrinsic interdependency between base positions in a motif or region. The establishment of dependency between two positions is based on a <italic>&#x003c7;</italic><sup>2</sup>-test from known sample data. An edge is established between two nodes (a node represents a base position) in the graph if the two corresponding base positions of the motif or region are dependent. After all dependent edges have being established completely, a dependency graph for the motif or region is constructed. An example of a dependency graph with 7 nodes is shown in Figure <xref ref-type="fig" rid="F3">3</xref>.</p><fig position="float" id="F3"><label>Figure 3</label><caption><p>An example of dependency graph.</p></caption><graphic xlink:href="1471-2105-9-S12-S7-3"/></fig><p>As reported in [<xref ref-type="bibr" rid="B21">21</xref>], although the dependency graph can fully capture the intrinsic interdependency between base positions in a motif or region, it is difficult, if not impossible, to perform statistical inference based on the dependency graph. To resolve the dilemma, the dependency graph is expanded to form a Bayesian network (which is a directed acyclic graph that facilitates statistical reasoning) by allowing a base position in the dependency graph to appear more than once in the Bayesian network as nominally distinct nodes. Figure <xref ref-type="fig" rid="F4">4</xref> shows an example of an expanded Bayesian network of the dependency graph in Figure <xref ref-type="fig" rid="F3">3</xref>. For the detailed procedure of constructing an expanded Bayesian network (EBN) from a dependency graph, please see [<xref ref-type="bibr" rid="B21">21</xref>]. In this paper, we use EBNs to model the background motif set <italic>M</italic><sub><italic>BG</italic></sub>.</p><fig position="float" id="F4"><label>Figure 4</label><caption><p>An example of expanded Bayesian network.</p></caption><graphic xlink:href="1471-2105-9-S12-S7-4"/></fig><p>Continued with the same example of the motif prediction of the transcription factor CBF1, the PWM and the rank of the five candidate motif sets at the end of the iterative sampling stage are also shown in Figure <xref ref-type="fig" rid="F2">2</xref>, together with the final results at the end of the refinement stage.</p></sec></sec></sec><sec><title>Results and discussion</title><sec><title>Data</title><p>In order to search for the transcription factor binding sites that regulate gene expressions, we collected binding promotor sequences from the cDNA microarray hybridization (ChIp-chip array) of yeast genome [<xref ref-type="bibr" rid="B22">22</xref>]. Each of the binding sequences may contain some unknown motifs that are implanted at unknown positions. These data represent the binding affinity of a target transcription factor to the promoter region of a gene <italic>in vivo</italic>. The experiment protocol assigns a binding <italic>p</italic>-value to each binding promoter sequence of the corresponding transcription factor. A sequence with binding <italic>p</italic>-value less than 0.001 is considered to be bound by the corresponding transcription factor. The threshold of 0.001 is set up to reduce the false positive identification in yeast genome-wide screening.</p><p>We collected the ChIp-chip array sequence data from the "Motif discovery results &#x02013; Discovered motifs, version 24" at [<xref ref-type="bibr" rid="B26">26</xref>]. For a transcription factor <italic>TF </italic>to be investigated, we collected all sequences with binding <italic>p</italic>-value less than the threshold 0.001 to <italic>TF </italic>into the binding dataset <italic>B</italic><sub><italic>TF</italic></sub>. There are 65 binding datasets <italic>B</italic><sub><italic>TF </italic></sub>being able to be collected from Harbison's website.</p></sec><sec><title>Accuracy measurement and comparison</title><p>To evaluate the performance of our program, we collected known specificities from many famous websites, such as YPD, SCPD, Transfac and from the literature with experimental evidence [<xref ref-type="bibr" rid="B27">27</xref>] to compare with the discovered specificities predicted by our program.</p><p>Among the 65 binding datasets <italic>B</italic><sub><italic>TF </italic></sub>collected from Harbison's website, we chose 36 transcription factor binding datasets which have known specificities with experimental evidence to evaluate the performance of our program. The results of our program for the 36 transcription factor binding datasets are listed in Figure <xref ref-type="fig" rid="F5">5</xref>. It is deserved to be mentioned that the specificity reported for transcription factor PHO2 in Harbrison <italic>et al</italic>'s website is "GTGCGsyGCG", while the predicted result of our program is "ATTATC". In this case, the newly found motif by our program is more consistent with the results reported by Barbaric <italic>et al </italic>[<xref ref-type="bibr" rid="B28">28</xref>] that PHO2 binds to an AT-rich region than the specificity reported in Harbrison <italic>et al</italic>'s website.</p><fig position="float" id="F5"><label>Figure 5</label><caption><p><bold>Predicted results of our program compared with known evidence</bold>. The letter symbols used in the 'Known specificity' column have the following mapping: aA: a tT: t gG: g cC: c wW: at rR: ag mM: ac kK: tg yY: tc sS: gc dD: atg hH: atc vV: agc bB: tgc nN: atgc</p></caption><graphic xlink:href="1471-2105-9-S12-S7-5"/></fig><p>In this study, we compared our program with two online programs, MDscan [<xref ref-type="bibr" rid="B29">29</xref>] and Cosmo [<xref ref-type="bibr" rid="B30">30</xref>]. MDscan is a famous program that can be used to examine the ChIP-array selected sequences and search for DNA sequence motifs representing the protein-DNA interaction sites. It takes the advantage of combining two widely adopted motif search strategies, word enumeration and position-specific weight matrix updating, and incorporates the ChIP enrichment information to accelerate the search and enhance its success rate. The comparison of MDscan with our program is shown in Table <xref ref-type="table" rid="T1">1</xref>. Also reported in Table <xref ref-type="table" rid="T1">1</xref> is the performance of our algorithm when the the PSSM model [<xref ref-type="bibr" rid="B8">8</xref>] instead of the EBN model [<xref ref-type="bibr" rid="B21">21</xref>] is used to model the background motif set <italic>M</italic><sub><italic>BG </italic></sub>in the calculation of the AMAP scores of the <italic>N </italic>candidate motif sets and the appendant scores of the <italic>N </italic>+ 1 motif sets. In Table <xref ref-type="table" rid="T1">1</xref>, for each transcription factor, the number in each 'Rank' column indicates the rank of the predicted motif which is most consistent with the known evidence from the top ten predicted candidate motifs.</p><table-wrap position="float" id="T1"><label>Table 1</label><caption><p>Comparison of MDscan and our program.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="left">TF</td><td align="left">Rank (EBN model)</td><td align="left">Rank (PSSM model)</td><td align="left">Rank (MDscan)</td></tr></thead><tbody><tr><td align="left">AFT2</td><td align="left">1</td><td align="left">1</td><td align="left">1</td></tr><tr><td align="left">BAS1</td><td align="left">1</td><td align="left">5</td><td align="left">2</td></tr><tr><td align="left">CAD1</td><td align="left">1</td><td align="left">5</td><td align="left">4</td></tr><tr><td align="left">CBF1</td><td align="left">1</td><td align="left">2</td><td align="left">1</td></tr><tr><td align="left">CIN5</td><td align="left">1</td><td align="left">2</td><td align="left">1</td></tr><tr><td align="left">FKH2</td><td align="left">1</td><td align="left">1</td><td align="left">3</td></tr><tr><td align="left">DAL82</td><td align="left">2</td><td align="left">1</td><td align="left">N*</td></tr><tr><td align="left">DIG1</td><td align="left">2</td><td align="left">3</td><td align="left">1</td></tr><tr><td align="left">FKH1</td><td align="left">1</td><td align="left">2</td><td align="left">1</td></tr><tr><td align="left">GAT1</td><td align="left">1</td><td align="left">2</td><td align="left">2</td></tr><tr><td align="left">GCN4</td><td align="left">1</td><td align="left">1</td><td align="left">1</td></tr><tr><td align="left">RPN4</td><td align="left">1</td><td align="left">1</td><td align="left">1</td></tr><tr><td align="left">GLN3</td><td align="left">1</td><td align="left">1</td><td align="left">1</td></tr><tr><td align="left">HAP4</td><td align="left">1</td><td align="left">3</td><td align="left">1</td></tr><tr><td align="left">INO2</td><td align="left">1</td><td align="left">2</td><td align="left">1</td></tr><tr><td align="left">INO4</td><td align="left">2</td><td align="left">2</td><td align="left">1</td></tr><tr><td align="left">LEU3</td><td align="left">1</td><td align="left">1</td><td align="left">1</td></tr><tr><td align="left">MBP1</td><td align="left">1</td><td align="left">1</td><td align="left">2</td></tr><tr><td align="left">MSN2</td><td align="left">3</td><td align="left">3</td><td align="left">4</td></tr><tr><td align="left">NRG1</td><td align="left">1</td><td align="left">2</td><td align="left">1</td></tr><tr><td align="left">PHO2</td><td align="left">1</td><td align="left">1</td><td align="left">2</td></tr><tr><td align="left">PHO4</td><td align="left">1</td><td align="left">2</td><td align="left">1</td></tr><tr><td align="left">RCS1</td><td align="left">1</td><td align="left">1</td><td align="left">5</td></tr><tr><td align="left">RAP1</td><td align="left">1</td><td align="left">3</td><td align="left">2</td></tr><tr><td align="left">RDS1</td><td align="left">1</td><td align="left">1</td><td align="left">1</td></tr><tr><td align="left">REB1</td><td align="left">1</td><td align="left">3</td><td align="left">4</td></tr><tr><td align="left">STE12</td><td align="left">1</td><td align="left">2</td><td align="left">1</td></tr><tr><td align="left">SWI4</td><td align="left">3</td><td align="left">2</td><td align="left">4</td></tr><tr><td align="left">TEC1</td><td align="left">1</td><td align="left">4</td><td align="left">1</td></tr><tr><td align="left">TYE7</td><td align="left">1</td><td align="left">1</td><td align="left">4</td></tr><tr><td align="left">UME6</td><td align="left">1</td><td align="left">1</td><td align="left">3</td></tr><tr><td align="left">YAP1</td><td align="left">1</td><td align="left">5</td><td align="left">1</td></tr><tr><td align="left">YAP7</td><td align="left">1</td><td align="left">2</td><td align="left">1</td></tr><tr><td align="left">HSF1</td><td align="left">1</td><td align="left">1</td><td align="left">1</td></tr><tr><td align="left">AZF1</td><td align="left">1</td><td align="left">1</td><td align="left">N</td></tr><tr><td align="left">MCM1</td><td align="left">2</td><td align="left">2</td><td align="left">N</td></tr></tbody></table><table-wrap-foot><p>* N means that the program predicts no motif.</p></table-wrap-foot></table-wrap><p>As shown in Table <xref ref-type="table" rid="T1">1</xref>, our approach with EBN background model outperforms the other two methods. Our approach with EBN background model gives 30 out of the 36 most predicted motifs for the corresponding 36 transcription factors with the 1st rank, while MDscan and our approach with PSSM background model give only 20 out of 36 and 15 out of 36 most predicted motifs with the 1st rank, respectively. Moreover, MDscan fails in discovering a motif for three transcription factor binding datasets, while our approach in this study is still able to predict a motif consistent with the known evidence.</p><p>Cosmo (constrained search for motifs) is a general purpose algorithm for conserved motif detection that allows the search to be supervised by specifying a set of constraints that the PWM of the unknown motif must satisfy. Such constraints may be formulated derived from prior biological knowledge about the structure of the transcription factor, such as the length of the motif intervals. Although Cosmo is based on the same two-component multinomial mixture model used in MEME, it employs the likelihood principle instead of the <italic>E</italic>-value criterion in MEME. In addition, three model types (OOPS, ZOOPS, or TCM) can data-adaptively be selected in Cosmo to achieve better performance. Since there is no prior knowledge used in our program, we compared it to the constraint-less version of the Cosmo program. On the other hand, since the Cosmo program reports only one motif PWM for a dataset, instead of a list of ranked candidate motif PWMs as in MDscan, we adopted only the rank 1 results of our program in this comparison. To evaluate the performance of both programs, we used the statistics proposed by Tompa et al. [<xref ref-type="bibr" rid="B4">4</xref>]. For a (computational) tool at the site level, the performance statistics on a dataset are defined as follows:</p><p><disp-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M21" name="1471-2105-9-S12-S7-i10" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:mtable>                              <mml:mtr>                                 <mml:mtd>                                    <mml:mrow>                                       <mml:mtable columnalign="right">                                          <mml:mtr columnalign="right">                                             <mml:mtd columnalign="right">                                                <mml:mrow>                                                   <mml:mtext>Sensitivity</mml:mtext>                                                </mml:mrow>                                             </mml:mtd>                                          </mml:mtr>                                          <mml:mtr columnalign="right">                                             <mml:mtd columnalign="right">                                                <mml:mrow>                                                   <mml:mtext>Positive&#x000a0;predictive&#x000a0;value</mml:mtext>                                                </mml:mrow>                                             </mml:mtd>                                          </mml:mtr>                                          <mml:mtr columnalign="right">                                             <mml:mtd columnalign="right">                                                <mml:mrow>                                                   <mml:mtext>Average&#x000a0;site&#x000a0;performance</mml:mtext>                                                </mml:mrow>                                             </mml:mtd>                                          </mml:mtr>                                       </mml:mtable>                                    </mml:mrow>                                 </mml:mtd>                                 <mml:mtd>                                    <mml:mrow>                                       <mml:mtable>                                          <mml:mtr>                                             <mml:mtd>                                                <mml:mo>:</mml:mo>                                             </mml:mtd>                                          </mml:mtr>                                          <mml:mtr>                                             <mml:mtd>                                                <mml:mo>:</mml:mo>                                             </mml:mtd>                                          </mml:mtr>                                          <mml:mtr>                                             <mml:mtd>                                                <mml:mo>:</mml:mo>                                             </mml:mtd>                                          </mml:mtr>                                       </mml:mtable>                                    </mml:mrow>                                 </mml:mtd>                                 <mml:mtd>                                    <mml:mrow>                                       <mml:mtable>                                          <mml:mtr>                                             <mml:mtd>                                                <mml:mrow>                                                   <mml:mi>S</mml:mi>                                                   <mml:mi>n</mml:mi>                                                   <mml:mo>=</mml:mo>                                                   <mml:mi>T</mml:mi>                                                   <mml:mi>P</mml:mi>                                                   <mml:mo>/</mml:mo>                                                   <mml:mo stretchy="false">(</mml:mo>                                                   <mml:mi>T</mml:mi>                                                   <mml:mi>P</mml:mi>                                                   <mml:mo>+</mml:mo>                                                   <mml:mi>F</mml:mi>                                                   <mml:mi>N</mml:mi>                                                   <mml:mo stretchy="false">)</mml:mo>                                                </mml:mrow>                                             </mml:mtd>                                          </mml:mtr>                                          <mml:mtr>                                             <mml:mtd>                                                <mml:mrow>                                                   <mml:mi>P</mml:mi>                                                   <mml:mi>P</mml:mi>                                                   <mml:mi>V</mml:mi>                                                   <mml:mo>=</mml:mo>                                                   <mml:mi>T</mml:mi>                                                   <mml:mi>P</mml:mi>                                                   <mml:mo>/</mml:mo>                                                   <mml:mo stretchy="false">(</mml:mo>                                                   <mml:mi>T</mml:mi>                                                   <mml:mi>P</mml:mi>                                                   <mml:mo>+</mml:mo>                                                   <mml:mi>F</mml:mi>                                                   <mml:mi>P</mml:mi>                                                   <mml:mo stretchy="false">)</mml:mo>                                                </mml:mrow>                                             </mml:mtd>                                          </mml:mtr>                                          <mml:mtr>                                             <mml:mtd>                                                <mml:mrow>                                                   <mml:mi>A</mml:mi>                                                   <mml:mi>S</mml:mi>                                                   <mml:mi>P</mml:mi>                                                   <mml:mo>=</mml:mo>                                                   <mml:mo stretchy="false">(</mml:mo>                                                   <mml:mi>S</mml:mi>                                                   <mml:mi>n</mml:mi>                                                   <mml:mo>+</mml:mo>                                                   <mml:mi>P</mml:mi>                                                   <mml:mi>P</mml:mi>                                                   <mml:mi>V</mml:mi>                                                   <mml:mo stretchy="false">)</mml:mo>                                                   <mml:mo>/</mml:mo>                                                   <mml:mn>2</mml:mn>                                                </mml:mrow>                                             </mml:mtd>                                          </mml:mtr>                                       </mml:mtable>                                    </mml:mrow>                                 </mml:mtd>                              </mml:mtr>                           </mml:mtable>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>where <italic>TP </italic>is the number of known sites overlapped by predicted sites, <italic>FN </italic>is the number of known sites not overlapped by predicted sites, and <italic>FP </italic>is the number of predicted sites not overlapped by known sites. To summarize the performance of a given tool over a collection <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M22" name="1471-2105-9-S12-S7-i11" overflow="scroll"><mml:semantics><mml:mi mathvariant="script">C</mml:mi></mml:semantics></mml:math></inline-formula> of datasets, we compute the "combined" statistics as though <italic>C </italic>were one large dataset by adding <italic>TP</italic>, <italic>FP </italic>and <italic>FN </italic>respectively over the datasets in <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M23" name="1471-2105-9-S12-S7-i11" overflow="scroll"><mml:semantics><mml:mi mathvariant="script">C</mml:mi></mml:semantics></mml:math></inline-formula>. Then the combined statistics of our program are <italic>Sn </italic>= 0.6698, <italic>PPV </italic>= 0.8206, and <italic>ASP </italic>= 0.7452, while those of Cosmo are <italic>Sn </italic>= 0.6573, <italic>PPV </italic>= 0.5134 and <italic>ASP </italic>= 0.5854. For the detailed Cosmo prediction results and the comparison of the two programs, please see Figure S1 (see Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). The comparison shows that our program can offer better performance than Cosmo, especially in the elimination of false positives.</p><p>The parameters used in our program include the sliding window size <italic>w </italic>used to extract segments from binding datasets <italic>B</italic><sub><italic>TF </italic></sub>to form <italic>S</italic><sub><italic>TF</italic></sub>, the Hamming distance <italic>d </italic>used to collect segments from <italic>S</italic><sub><italic>TF </italic></sub>to establish initial candidate motif sets, the number of most dependent edges used to form a dependency graph for the background motif model and the number of parents used in the construction of an expanded Bayesian network from the dependency graph [<xref ref-type="bibr" rid="B21">21</xref>]. The parameters used in our program to give the best predicted motifs for each of the 36 transcription factors are listed in Table S1 (see Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>). Comparing the performance of the two sampling strategies discussed in the Method section, as shown in Figure S2 (see Additional file <xref ref-type="supplementary-material" rid="S3">3</xref>), we found that the alternative sampler is faster and has almost identical best predicted motifs with those by the primary sampler, except that transcription factors GCN4, HAP4 and PHO4 have the best predicted motifs one nucleotide position shift from those by the primary sampler. In addition, the alternative sampler is slightly better than the primary sampler in the sense that the best predicted motif for the transcription factor DIG1 promotes its rank from the 2nd place by the primary sampler to the 1st place by the alternative sampler.</p></sec></sec><sec><title>Conclusion</title><p>In this study, we employed the binomial probability model to establish a number of initial candidate motif sets, and used the method of dependence graphs and their expanded Bayesian networks to model the background motif set as a control to predict TFBSs (motifs) from a set of unaligned DNA sequences. The prediction results suggest that, overall, our algorithm outperforms MDscan since the predicted motifs are more consistent with previously known specificities reported in the literature and have better prediction ranks. And when compared with the constraint-less Cosmo program, our algorithm has a slightly higher combined sensitivity <italic>Sn</italic>, a much higher positive predictive value <italic>PPV </italic>and a higher average site performance <italic>ASP</italic>. However, the performance of our algorithm is not much better if the length of possible binding sites are too long (more than 12 bps). Further research is needed to discover long motifs.</p><p>Furthermore, variable spacing within binding sites is legitimate for some transcription factors while this study focuses on ungapped motif discovery. Programs such as BIPAD [<xref ref-type="bibr" rid="B31">31</xref>] and spaced dyad [<xref ref-type="bibr" rid="B32">32</xref>] have investigated into such a bipartitie sequence element discovery problem. Therefore another direction for our future research is to investigate into gapped motifs.</p></sec><sec><title>Competing interests</title><p>The authors declare that they have no competing interests.</p></sec><sec><title>Authors' contributions</title><p>CL and WY developed and implemented the method. All authors participated in discussions and writing of the paper.</p></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="S1"><caption><title>Additional file 1</title><p>Figure S1 &#x02013; Predicted results of the constraint-less Cosmo program and the comparison with our program.</p></caption><media xlink:href="1471-2105-9-S12-S7-S1.pdf" mimetype="application" mime-subtype="pdf"><caption><p>Click here for file</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="S2"><caption><title>Additional file 2</title><p>Table S1 &#x02013; Parameters used in our program to give the best predicted motifs for the 36 transcription factors.</p></caption><media xlink:href="1471-2105-9-S12-S7-S2.pdf" mimetype="application" mime-subtype="pdf"><caption><p>Click here for file</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="S3"><caption><title>Additional file 3</title><p>Figure S2 &#x02013; Comparison of the predicted results with the primary and alternative samplers.</p></caption><media xlink:href="1471-2105-9-S12-S7-S3.pdf" mimetype="application" mime-subtype="pdf"><caption><p>Click here for file</p></caption></media></supplementary-material></sec></body><back><ack><sec><title>Acknowledgements</title><p>We thank Yi-Sian Liao for helping the execution of our prediction program. We also thank the reviewers for their valuable suggestions which improve the presentation of this paper. This work was supported by the National Science Council, Taiwan, under Contracts NSC 93-3112-B-007-004 and NSC95-3114-P-002-005-Y.</p><p>This article has been published as part of <italic>BMC Bioinformatics </italic>Volume 9 Supplement 12, 2008: Asia Pacific Bioinformatics Network (APBioNet) Seventh International Conference on Bioinformatics (InCoB2008). The full contents of the supplement are available online at <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/9?issue=S12"/>.</p></sec></ack><ref-list><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>XS</given-names></name><name><surname>Brutlag</surname><given-names>DL</given-names></name><name><surname>Liu</surname><given-names>JS</given-names></name></person-group><article-title>An algorithm for finding protein-DNA binding sites with applications to chromatin-immunoprecipitaion microarray experiments</article-title><source>Nat Biotechnol</source><year>2002</year><volume>20</volume><fpage>835</fpage><lpage>839</lpage><pub-id pub-id-type="pmid">12101404</pub-id></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>MQ</given-names></name></person-group><article-title>Computational analyses of eukaryotic promoters</article-title><source>BMC Bioinformatics</source><year>2007</year><volume>8</volume><pub-id pub-id-type="pmid">17903284</pub-id></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wasserman</surname><given-names>WW</given-names></name><name><surname>Sandelin</surname><given-names>A</given-names></name></person-group><article-title>Applied bioinformatics for the identification of regulatory elements</article-title><source>Nat Rev Genet</source><year>2004</year><volume>5</volume><fpage>276</fpage><lpage>287</lpage><pub-id pub-id-type="pmid">15131651</pub-id><pub-id pub-id-type="doi">10.1038/nrg1315</pub-id></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Tompa</surname><given-names>M</given-names></name><name><surname>Li</surname><given-names>N</given-names></name><name><surname>Bailey</surname><given-names>TL</given-names></name><name><surname>Church</surname><given-names>GM</given-names></name><name><surname>Moor</surname><given-names>BD</given-names></name><name><surname>Eskin</surname><given-names>E</given-names></name><name><surname>Favorov</surname><given-names>AV</given-names></name><name><surname>Frith</surname><given-names>MC</given-names></name><name><surname>Fu</surname><given-names>Y</given-names></name><name><surname>Kent</surname><given-names>WJ</given-names></name><name><surname>Makeev</surname><given-names>VJ</given-names></name><name><surname>Mironov</surname><given-names>AA</given-names></name><name><surname>Noble</surname><given-names>WS</given-names></name><name><surname>Pavesi</surname><given-names>G</given-names></name><name><surname>Pesole</surname><given-names>G</given-names></name><name><surname>Regnier</surname><given-names>M</given-names></name><name><surname>Simonis</surname><given-names>N</given-names></name><name><surname>Sinha</surname><given-names>S</given-names></name><name><surname>Thijs</surname><given-names>G</given-names></name><name><surname>van Helden</surname><given-names>J</given-names></name><name><surname>Vandenbogaert</surname><given-names>M</given-names></name><name><surname>Weng</surname><given-names>Z</given-names></name><name><surname>Workman</surname><given-names>C</given-names></name><name><surname>Ye</surname><given-names>C</given-names></name><name><surname>Zhu</surname><given-names>Z</given-names></name></person-group><article-title>Assessing computational tools for the discovery of transcription factor binding sites</article-title><source>Nat Biotechnol</source><year>2005</year><volume>23</volume><fpage>137</fpage><lpage>144</lpage><pub-id pub-id-type="pmid">15637633</pub-id><pub-id pub-id-type="doi">10.1038/nbt1053</pub-id></citation></ref><ref id="B5"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hertz</surname><given-names>GZ</given-names></name><name><surname>George</surname><given-names>W</given-names></name><name><surname>Hartzell</surname><given-names>I</given-names></name><name><surname>Stormo</surname><given-names>GD</given-names></name></person-group><article-title>Identification of consensus patterns in unaligned DNA sequences known to be functionally related</article-title><source>Comput Appl Biosci</source><year>1990</year><volume>6</volume><fpage>81</fpage><lpage>92</lpage><pub-id pub-id-type="pmid">2193692</pub-id></citation></ref><ref id="B6"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lawrence</surname><given-names>CE</given-names></name><name><surname>Reilly</surname><given-names>AA</given-names></name></person-group><article-title>An expectation maximization (EM) algorithm for the identification and characterization of common sites in unaligned biopolymer sequences</article-title><source>Proteins</source><year>1990</year><volume>7</volume><fpage>41</fpage><lpage>51</lpage><pub-id pub-id-type="pmid">2184437</pub-id><pub-id pub-id-type="doi">10.1002/prot.340070105</pub-id></citation></ref><ref id="B7"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Bailey</surname><given-names>TL</given-names></name><name><surname>Elkan</surname><given-names>C</given-names></name></person-group><article-title>The value of prior knowledge in discovering motifs with MEME</article-title><source>Proceedings of the Third International Comference on Intelligent Systems for Molecular Biology</source><year>1995</year><publisher-name>Menlo Park, CA: AAAI Press</publisher-name><fpage>21</fpage><lpage>29</lpage></citation></ref><ref id="B8"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lawrence</surname><given-names>CE</given-names></name><name><surname>Altschul</surname><given-names>SF</given-names></name><name><surname>Boguski</surname><given-names>MS</given-names></name><name><surname>Liu</surname><given-names>JS</given-names></name><name><surname>Neuwald</surname><given-names>AF</given-names></name><name><surname>Wootton</surname><given-names>JC</given-names></name></person-group><article-title>Detecting subtle sequence signals: A Gibbs sampling strategy for multiple alignment</article-title><source>Science</source><year>1993</year><volume>262</volume><fpage>208</fpage><lpage>214</lpage><pub-id pub-id-type="pmid">8211139</pub-id><pub-id pub-id-type="doi">10.1126/science.8211139</pub-id></citation></ref><ref id="B9"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Tagle</surname><given-names>DA</given-names></name><name><surname>Koop</surname><given-names>BF</given-names></name><name><surname>Goodman</surname><given-names>M</given-names></name><name><surname>Slightom</surname><given-names>JL</given-names></name><name><surname>Hess</surname><given-names>DL</given-names></name><name><surname>Jones</surname><given-names>RT</given-names></name></person-group><article-title>Embryonic <italic>&#x003b5; </italic>and <italic>&#x003b3; </italic>globin genes of a prosimian primate (Galago crassicaudatus). Nucleotide and amino acid sequences, developmental regulation and phylogenetic footprints</article-title><source>J Mol Biol</source><year>1988</year><volume>203</volume><fpage>439</fpage><lpage>455</lpage><pub-id pub-id-type="pmid">3199442</pub-id><pub-id pub-id-type="doi">10.1016/0022-2836(88)90011-3</pub-id></citation></ref><ref id="B10"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Blanchette</surname><given-names>M</given-names></name><name><surname>Schwikowski</surname><given-names>B</given-names></name><name><surname>Tompa</surname><given-names>M</given-names></name></person-group><article-title>Algorithms for phylogenetic footprinting</article-title><source>J Comput Biol</source><year>2002</year><volume>9</volume><fpage>211</fpage><lpage>223</lpage><pub-id pub-id-type="pmid">12015878</pub-id><pub-id pub-id-type="doi">10.1089/10665270252935421</pub-id></citation></ref><ref id="B11"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lenhard</surname><given-names>B</given-names></name><name><surname>Sandelin</surname><given-names>A</given-names></name><name><surname>Mendoza</surname><given-names>L</given-names></name><name><surname>Engstrom1</surname><given-names>P</given-names></name><name><surname>Jareborg</surname><given-names>N</given-names></name><name><surname>Wasserman</surname><given-names>WW</given-names></name></person-group><article-title>Identification of conserved regulatory elements by comparative genome analysis</article-title><source>J Biol</source><year>2003</year><volume>2</volume><fpage>13</fpage><pub-id pub-id-type="pmid">12760745</pub-id><pub-id pub-id-type="doi">10.1186/1475-4924-2-13</pub-id></citation></ref><ref id="B12"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Siddhartan</surname><given-names>R</given-names></name><name><surname>Siggia</surname><given-names>ED</given-names></name><name><surname>van Nimwegen</surname><given-names>E</given-names></name></person-group><article-title>PhyloGibbs: A Gibbs sampling motif finder that incorporates phylogeny</article-title><source>PLoS Comput Biol</source><year>2005</year><volume>1</volume><fpage>e67</fpage><pub-id pub-id-type="pmid">16477324</pub-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.0010067</pub-id></citation></ref><ref id="B13"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Andersson</surname><given-names>SA</given-names></name><name><surname>Lagergren</surname><given-names>J</given-names></name></person-group><article-title>Motif Yggdrasil: Sampling sequence motifs from a tree mixture model</article-title><source>J Comput Biol</source><year>2007</year><volume>14</volume><fpage>682</fpage><lpage>697</lpage><pub-id pub-id-type="pmid">17683268</pub-id><pub-id pub-id-type="doi">10.1089/cmb.2007.R010</pub-id></citation></ref><ref id="B14"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wasserman</surname><given-names>WW</given-names></name><name><surname>Fickett</surname><given-names>JW</given-names></name></person-group><article-title>Identification of regulatory regions which confer muscle-specific gene expression</article-title><source>J Mol Biol</source><year>1998</year><volume>278</volume><fpage>167</fpage><lpage>181</lpage><pub-id pub-id-type="pmid">9571041</pub-id><pub-id pub-id-type="doi">10.1006/jmbi.1998.1700</pub-id></citation></ref><ref id="B15"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Johansson</surname><given-names>O</given-names></name><name><surname>Alkema</surname><given-names>W</given-names></name><name><surname>Wasserman</surname><given-names>WW</given-names></name><name><surname>Lagergren</surname><given-names>J</given-names></name></person-group><article-title>Identification of functional clusters of transcription factor binding motifs in genome sequences: the MSCAN algorithm</article-title><source>Bioinformatics</source><year>2003</year><volume>19</volume><fpage>i169</fpage><lpage>i176</lpage><pub-id pub-id-type="pmid">12855453</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btg1021</pub-id></citation></ref><ref id="B16"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Aerts</surname><given-names>S</given-names></name><name><surname>Van Loo</surname><given-names>P</given-names></name><name><surname>Thijs</surname><given-names>G</given-names></name><name><surname>Moreau</surname><given-names>Y</given-names></name><name><surname>De Moor</surname><given-names>B</given-names></name></person-group><article-title>Computational detection of cis-regulatory modules</article-title><source>Bioinformatics</source><year>2003</year><volume>19</volume><fpage>ii5</fpage><lpage>ii14</lpage><pub-id pub-id-type="pmid">14534164</pub-id></citation></ref><ref id="B17"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Workman</surname><given-names>CT</given-names></name><name><surname>Stormo</surname><given-names>GD</given-names></name></person-group><article-title>ANN-Spec: A method for discovering transcription factor binding sites with improved specificity</article-title><source>Pac Symp Biocomput</source><year>2002</year><volume>5</volume><fpage>467</fpage><lpage>478</lpage></citation></ref><ref id="B18"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Sinha</surname><given-names>S</given-names></name></person-group><article-title>Discriminative motifs</article-title><source>J Comput Biol</source><year>2003</year><volume>10</volume><fpage>599</fpage><lpage>615</lpage><pub-id pub-id-type="pmid">12935347</pub-id><pub-id pub-id-type="doi">10.1089/10665270360688219</pub-id></citation></ref><ref id="B19"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>AD</given-names></name><name><surname>Sumazin</surname><given-names>P</given-names></name><name><surname>Zhang</surname><given-names>MQ</given-names></name></person-group><article-title>Identifying tissue-selective transcription factor binding sites in vertebrate promoters</article-title><source>Proc Natl Acad Sci USA</source><year>2005</year><volume>102</volume><fpage>1560</fpage><lpage>1565</lpage><pub-id pub-id-type="pmid">15668401</pub-id><pub-id pub-id-type="doi">10.1073/pnas.0406123102</pub-id></citation></ref><ref id="B20"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Bembom</surname><given-names>O</given-names></name><name><surname>Keles</surname><given-names>S</given-names></name><name><surname>van der Laan</surname><given-names>MJ</given-names></name></person-group><article-title>Supervised detection of conserved motifs in DNA sequences with Cosmo</article-title><source>Stat Appl Genet Mol Biol</source><year>2007</year><volume>6</volume><fpage>8</fpage></citation></ref><ref id="B21"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>TM</given-names></name><name><surname>Lu</surname><given-names>CC</given-names></name><name><surname>Li</surname><given-names>WH</given-names></name></person-group><article-title>Prediction of splice sites with dependency graphs and their expanded bayesian networks</article-title><source>Bioinformatics</source><year>2004</year><volume>21</volume><fpage>471</fpage><lpage>482</lpage><pub-id pub-id-type="pmid">15374869</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/bti025</pub-id></citation></ref><ref id="B22"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Harbison</surname><given-names>CT</given-names></name><name><surname>Gordon</surname><given-names>DB</given-names></name><name><surname>Lee</surname><given-names>TI</given-names></name><name><surname>Rinaldi</surname><given-names>NJ</given-names></name><name><surname>Macisaac</surname><given-names>KD</given-names></name><name><surname>Danford</surname><given-names>TW</given-names></name><name><surname>Hannett</surname><given-names>NM</given-names></name><name><surname>Tagne</surname><given-names>JB</given-names></name><name><surname>Reynolds</surname><given-names>DB</given-names></name><name><surname>Yoo</surname><given-names>J</given-names></name><name><surname>Jennings</surname><given-names>EG</given-names></name><name><surname>Zeitlinger</surname><given-names>J</given-names></name><name><surname>Pokholok</surname><given-names>DK</given-names></name><name><surname>Kellis</surname><given-names>M</given-names></name><name><surname>Rolfe</surname><given-names>PA</given-names></name><name><surname>KT</surname><given-names>T</given-names></name><name><surname>Lander</surname><given-names>ES</given-names></name><name><surname>Gifford</surname><given-names>DK</given-names></name><name><surname>Fraenkel</surname><given-names>E</given-names></name><name><surname>Young</surname><given-names>RA</given-names></name></person-group><article-title>Transcriptional regulatory code of a eukaryotic genome</article-title><source>Nature</source><year>2004</year><volume>431</volume><fpage>99</fpage><lpage>104</lpage><pub-id pub-id-type="pmid">15343339</pub-id><pub-id pub-id-type="doi">10.1038/nature02800</pub-id></citation></ref><ref id="B23"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Bailey</surname><given-names>TL</given-names></name><name><surname>Elkan</surname><given-names>C</given-names></name></person-group><article-title>Unsupervised learning of multiple motif in biopolymers using expectation maximization</article-title><source>Machine Learning</source><year>1995</year><volume>21</volume><fpage>51</fpage><lpage>80</lpage></citation></ref><ref id="B24"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>J</given-names></name><name><surname>Neuwald</surname><given-names>AF</given-names></name><name><surname>Larence</surname><given-names>CE</given-names></name></person-group><article-title>Bayesian models for multiple local sequence alignment and Gibbs sampling strategies</article-title><source>J Am Stat Assoc</source><year>1995</year><volume>90</volume><fpage>1156</fpage><lpage>1170</lpage><pub-id pub-id-type="doi">10.2307/2291508</pub-id></citation></ref><ref id="B25"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Neuwald</surname><given-names>AF</given-names></name><name><surname>Liu</surname><given-names>JS</given-names></name><name><surname>Lawrence</surname><given-names>CE</given-names></name></person-group><article-title>Gibbs motif sampling: Detection of bacterial outer membrane protein repeats</article-title><source>Protein Sci</source><year>1995</year><volume>4</volume><fpage>1618</fpage><lpage>1632</lpage><pub-id pub-id-type="pmid">8520488</pub-id></citation></ref><ref id="B26"><citation citation-type="other"><article-title>Motif discovery results &#x02013; Discovered motifs, version 24</article-title><ext-link ext-link-type="uri" xlink:href="http://fraenkel.mit.edu/Harbison/release_v24/final_set/Final_Motifs/"/></citation></ref><ref id="B27"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>MacIsaac</surname><given-names>KD</given-names></name><name><surname>Wang</surname><given-names>T</given-names></name><name><surname>Gordeon</surname><given-names>DB</given-names></name><name><surname>Gifford</surname><given-names>DK</given-names></name><name><surname>Stormo</surname><given-names>GD</given-names></name><name><surname>Fraenkel</surname><given-names>E</given-names></name></person-group><article-title>An improved map of conserved regulatory sites for Saccharomyces cerevisiae</article-title><source>BMC Bioinformatics</source><year>2006</year><volume>7</volume><fpage>113</fpage><pub-id pub-id-type="pmid">16522208</pub-id><pub-id pub-id-type="doi">10.1186/1471-2105-7-113</pub-id></citation></ref><ref id="B28"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Barbaric</surname><given-names>S</given-names></name><name><surname>Munsterkotter</surname><given-names>M</given-names></name><name><surname>Svaren</surname><given-names>J</given-names></name><name><surname>Horz</surname><given-names>W</given-names></name></person-group><article-title>The homeodomain protein Pho2 and the basic-helix-loop-helix protein Pho4 bind DNA cooperatively at the yeast PHO5 promoter</article-title><source>Nucleic Acids Res</source><year>1996</year><volume>24</volume><fpage>4479</fpage><lpage>4486</lpage><pub-id pub-id-type="pmid">8948638</pub-id><pub-id pub-id-type="doi">10.1093/nar/24.22.4479</pub-id></citation></ref><ref id="B29"><citation citation-type="other"><article-title>MDscan: A fast and accurate motif finding algorithm with aApplications to chromatin immunoprecipitation microarray experiments</article-title><ext-link ext-link-type="uri" xlink:href="http://ai.stanford.edu/~xsliu/MDscan/"/></citation></ref><ref id="B30"><citation citation-type="other"><article-title>Cosmo &#x02013; Constrained search for motifs in DNA sequences</article-title><ext-link ext-link-type="uri" xlink:href="http://cosmoweb.berkeley.edu/"/></citation></ref><ref id="B31"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Bi</surname><given-names>C</given-names></name><name><surname>Rogan</surname><given-names>PK</given-names></name></person-group><article-title>BIPAD: A web server for modeling bipartite sequence elements</article-title><source>BMC Bioinformatics</source><year>2006</year><volume>7</volume><fpage>76</fpage><pub-id pub-id-type="pmid">16503993</pub-id><pub-id pub-id-type="doi">10.1186/1471-2105-7-76</pub-id></citation></ref><ref id="B32"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>van Helden</surname><given-names>J</given-names></name><name><surname>Rios</surname><given-names>AF</given-names></name><name><surname>J</surname><given-names>CV</given-names></name></person-group><article-title>Discovering regulatory elements in non-coding sequences by analysis of spaced dyads</article-title><source>Nucleic Acid Res</source><year>2000</year><volume>28</volume><fpage>1808</fpage><lpage>1818</lpage><pub-id pub-id-type="pmid">10734201</pub-id><pub-id pub-id-type="doi">10.1093/nar/28.8.1808</pub-id></citation></ref></ref-list></back></article>