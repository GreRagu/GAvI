<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd"><article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article" xml:lang="EN"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id><journal-id journal-id-type="publisher-id">bioinformatics</journal-id><journal-id journal-id-type="hwp">bioinfo</journal-id><journal-title>Bioinformatics</journal-title><issn pub-type="ppub">1367-4803</issn><issn pub-type="epub">1460-2059</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">19129207</article-id><article-id pub-id-type="pmc">2642634</article-id><article-id pub-id-type="doi">10.1093/bioinformatics/btn656</article-id><article-id pub-id-type="publisher-id">btn656</article-id><article-categories><subj-group subj-group-type="heading"><subject>Applications Note</subject><subj-group><subject>Databases and Ontologies</subject></subj-group></subj-group></article-categories><title-group><article-title>A novel method for large tree visualization</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Heard</surname><given-names>Jeff</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref><xref ref-type="corresp" rid="COR1">*</xref></contrib><contrib contrib-type="author"><name><surname>Kaufmann</surname><given-names>William</given-names></name><xref ref-type="aff" rid="AFF1"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Guan</surname><given-names>Xiaojun</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref><xref ref-type="corresp" rid="COR1">*</xref></contrib></contrib-group><aff id="AFF1"><sup>1</sup>Renaissance Computing Institute, 100 Europa Drive, Chapel Hill, NC 27519 and <sup>2</sup>Department of Pathology and Laboratory of Medicine, University of North Carolina, Chapel Hill, NC 27599, USA</aff><author-notes><corresp id="COR1">*To whom correspondence should be addressed.</corresp><fn><p>Associate Editor: Jonathan Wren</p></fn></author-notes><pub-date pub-type="ppub"><day>15</day><month>2</month><year>2009</year></pub-date><pub-date pub-type="epub"><day>7</day><month>1</month><year>2009</year></pub-date><pub-date pub-type="pmc-release"><day>7</day><month>1</month><year>2009</year></pub-date><volume>25</volume><issue>4</issue><fpage>557</fpage><lpage>558</lpage><history><date date-type="received"><day>24</day><month>9</month><year>2008</year></date><date date-type="rev-recd"><day>24</day><month>11</month><year>2008</year></date><date date-type="accepted"><day>18</day><month>12</month><year>2008</year></date></history><permissions><copyright-statement>&#x000a9; 2009 The Author(s)</copyright-statement><copyright-year>2009</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/"><p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">http://creativecommons.org/licenses/by-nc/2.0/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</p></license></permissions><abstract><p><bold>Summary:</bold> Many genomic and proteomic analyses generate as a result a tree of genes or proteins. These trees are often large (containing tens of thousands of nodes and edges), and need a visualization tool to fully display all the information contained in the tree. Clustering analysis can be performed on these trees to obtain clusters of proteins, and we need an efficient way to visualize the clustering results. We present a novel tree visualization tool to help with such analyses.</p><p><bold>Availability:</bold> <ext-link ext-link-type="uri" xlink:href="http://www2.renci.org/~jeff/software/bin/win32/ProteinVis-2.1.6-win32.zip">http://www2.renci.org/~jeff/software/bin/win32/ProteinVis-2.1.6-win32.zip</ext-link></p><p><bold>Contact:</bold> <email>jeff@renci.org</email>; <email>xguan@renci.org</email></p></abstract></article-meta></front><body><sec sec-type="intro" id="SEC1"><title>1 INTRODUCTION</title><p>When processing large amounts of genomic or proteomic data, many analyses produce results as a tree of genes or proteins, for example, to classify genes based on results of microarray analysis, or to classify proteins based on sequence similarity. The resulting trees are large with tens of thousands of nodes. Very often, researchers need to perform analysis on these trees, such as identifying gene clusters based on Gene Ontology (GO, <ext-link ext-link-type="uri" xlink:href="http://www.geneontology.org/">http://www.geneontology.org/</ext-link>), or identifying groups of genes that are up- or down-regulated under certain conditions.</p><p>There are tree viewers, such as the Java TreeView (Saldanha, <xref ref-type="bibr" rid="B7">2004</xref>), Hierarchical Cluster Explorer (Seo <italic>et al.</italic>, <xref ref-type="bibr" rid="B8">2006</xref>), PhyloWidget (Jordan and Piel, <xref ref-type="bibr" rid="B5">2008</xref>) and Dendroscope (Huson <italic>et al.</italic>, <xref ref-type="bibr" rid="B4">2007</xref>). But these programs either cannot handle trees with tens of thousands of nodes very well, or do not have the built in capabilities to identify and visualize clusters of nodes based on certain biological properties (such as GO annotations). When clustering analysis is performed, we need a way to represent the resulting clusters in the tree, and to be able to interact with these clusters to check the accuracy of the clusters. Here, we present a new tool for visualizing a large tree and the results of clustering analysis on the tree.</p></sec><sec sec-type="methods" id="SEC2"><title>2 METHODS</title><p>Java TreeView and others provide linear views of hierarchical trees. While this is appropriate for small trees, large trees show keenly the drawbacks of such an approach. In the binary tree, the total number of internal nodes cannot exceed the number of leaves (Cormen, <xref ref-type="bibr" rid="B2">2001</xref>). Linearly arranged trees devote the same amount of layout space per level to nodes in the tree further from the leaves as they do for nodes near the leaves.</p><p>The protein trees in our analysis contain upwards of 18 000 leaf nodes, and therefore we want to spread things out for better viewing while maximizing the amount of the whole tree that we can see on the screen at once. Thus, we have developed a radial view (Sheth, <xref ref-type="bibr" rid="B9">2003</xref>) of the binary protein tree. This radial view takes advantage of the decreasing number of nodes in the interior at higher levels and compresses them in favor of spreading the nodes at the leaves out further. The difference between our tree and Sheth's tree is that our layout remains static while Sheth's tree rearranges itself every time a user clicks on a node. Since the ordering of our nodes is important, we prefer to see the user-highlighted node in the context of the entire tree as is. There are more space optimal ways to represent a tree than this (Nguyen and Huang, <xref ref-type="bibr" rid="B6">2007</xref>), but the advantage of the radial view for our tree is that leaf nodes are adjacent to each other, and the nature of our clustering means that adjacent leaf nodes close together on the rim should have similar function.</p><p>The algorithm for laying out the tree starts with the leaves. Leaves are first sorted by an in-order walk of the tree, so that nodes that share a parent will be next to each other, recursively up the tree. Then angles along the rim of a circle are calculated for each leaf node based on this ordering. Then the immediate parents are situated at angles halfway in-between their children. Internal nodes are situated at radii proportional to the number of steps to the root versus the number of steps to the furthest leaf. Once this geometry is created, it is converted to Cartesian coordinates and passed through OpenGL for rendering. Coloring is based on a numerical attribute of each node, usually similarity. For example, if each protein has a vector of features (expression levels), the similarity between a pair of proteins can be measured as Euclidean distance of the two vectors.</p><p>The input to the application is a binary tree, generated by any program, in the format of:<disp-formula><graphic xlink:href="btn656um1.jpg" position="float"/></disp-formula>along with any ancillary metadata about the node. The tree can be constructed with hierarchical clustering. For example, our example data were generated using the Cluster 3.0 program (<ext-link ext-link-type="uri" xlink:href="http://www.geo.vu.nl/~huik/cluster.htm">http://www.geo.vu.nl/~huik/cluster.htm</ext-link>). Leaf nodes represent proteins or genes. At construction time, each internal node is associated with its children, and all descendant leaf-nodes are inspected for shared GO-terms. The intersection of all sets of GO terms in the reachable leaves are then associated with the internal nodes.</p><p>Users can add annotations for leaf nodes. Additionally, there are various clustering approaches that can be used to group and collapse subtrees at will. For an example, any internal node whose leaf nodes share at least <italic>k</italic> GO terms can represent a cluster, where <italic>k</italic> is adjustable by the users. We call these internal nodes &#x02018;super-nodes&#x02019; and they are highlighted with an enlarged circle and with a special color.</p><p>Users can click internal nodes (including super-nodes) to examine the GO terms that they share. Clicking on an internal node also lists the leaf nodes (proteins or genes) that are reachable by descending the tree from that node. Users can collapse and expand a sub-tree by right-clicking a node, thus expanding the rest of the rim to fill the space, allowing one to effectively zoom in on an interesting part of the tree. Users can change the <italic>k</italic> parameter and be able to check the accuracy of the resulting clusters.<inline-formula><inline-graphic xlink:href="btn656i1.jpg"/></inline-formula></p><p>Users can search for individual nodes by name, and the node will snap to the 45<sup>&#x025cb;</sup> position (centered, in other words) and be highlighted.</p><p>The picture above is a snapshot of a tree generated by hierarchical clustering of human proteins based on how they share GO terms. We have a set of 18 000 human proteins that are in our interactome database (<ext-link ext-link-type="uri" xlink:href="idea.renci.org">idea.renci.org</ext-link>) and we have downloaded all GO terms that these proteins are associated with. Each protein has a vector of GO terms. The hierarchical clustering is performed on these vectors. Then we identify all &#x02018;super-nodes&#x02019; whose leaf children share at least <italic>k</italic> GO terms and highlight them in blue and in enlarged circles. When clicking a node, all the leaf nodes under this node and GO terms that they share are displayed on the right.</p><p>The colors reflect the similarity between nodes. Nodes towards the bottom left (root of the tree) are higher up in the tree, further from the leaves. Leaf nodes are spread around the rim. Enlarged blue nodes are the super-nodes. Proteins are listed to the right. A glyph to the upper right of the main viewing portion shows where in the whole tree the user currently is. One quarter of the full tree can be viewed at any one time. At the bottom right are statistics about the number of total nodes and number of collapsed ones. At the top right is a histogram of showing a breakdown of internal nodes and similarity scores.</p><p>The visualization uses the full gamut of mouse functions, and can be controlled, except for node searching entirely by the mouse. The left button selects nodes and displays their details. The scroll wheel rotates the tree interactively. The right button brings up a menu for changing <italic>k</italic> and searching for nodes. The middle button expands and contracts subtrees. We have tested this visualization with success on both specialized visualization hardware (a 9<sup>&#x02032;</sup> &#x000d7; 14<sup>&#x02032;</sup> high-resolution visualization wall), and typical desktop and laptop hardware.</p><p><italic>Funding</italic>: National Institute of Environmental Health Sciences (#5P01ES014635-01, P30-ES10126, in part).</p><p><italic>Conflict of Interest</italic>: none declared.</p></sec></body><back><ref-list><title>REFERENCES</title><ref id="B1"><citation citation-type="book">Cluster 3.0 -<ext-link ext-link-type="uri" xlink:href="http://www.geo.vu.nl/~huik/cluster.htm">http://www.geo.vu.nl/~huik/cluster.htm</ext-link>.</citation></ref><ref id="B2"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Cormen</surname><given-names>T</given-names></name><etal/></person-group><source>Introduction to Algorithms.</source><year>2001</year><edition>2nd edn</edition><publisher-loc>Boston</publisher-loc><publisher-name>McGraw-Hill</publisher-name><fpage>253</fpage></citation></ref><ref id="B3"><citation citation-type="book">Gene Ontology -<ext-link ext-link-type="uri" xlink:href="http://www.geneontology.org">http://www.geneontology.org</ext-link>.</citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Huson</surname><given-names>DH</given-names></name><etal/></person-group><article-title>Dendroscope: an interactive viewer for large phylogenetic trees</article-title><source>BMC Bioinformatics</source><year>2007</year><volume>8</volume><fpage>460</fpage><lpage>465</lpage><pub-id pub-id-type="pmid">18034891</pub-id></citation></ref><ref id="B5"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Jordan</surname><given-names>G</given-names></name><name><surname>Piel</surname><given-names>W</given-names></name></person-group><article-title>PhyloWidget: webbased visualizations for the tree of life</article-title><source>Bioinformatics</source><year>2008</year><volume>24</volume><fpage>1641</fpage><lpage>1642</lpage><pub-id pub-id-type="pmid">18487241</pub-id></citation></ref><ref id="B6"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Nguyen</surname><given-names>QV</given-names></name><name><surname>Huang</surname><given-names>ML</given-names></name></person-group><article-title>A space efficient clustered visualization of large graphs</article-title><source>Fourth International Conference on Image and Graphics (ICIG 2007) 2007.</source><year>2007</year><publisher-loc>Sichuan, China</publisher-loc><fpage>920</fpage><lpage>927</lpage></citation></ref><ref id="B7"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Saldanha</surname><given-names>A</given-names></name></person-group><article-title>Java Treeview&#x02014;extensible visualization of microarray data</article-title><source>Bioinformatics</source><year>2004</year><volume>17</volume><fpage>3246</fpage><lpage>3248</lpage><pub-id pub-id-type="pmid">15180930</pub-id></citation></ref><ref id="B8"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Seo</surname><given-names>J</given-names></name><etal/></person-group><article-title>A interactive power analysis tool for microarray hypothesis testing and generation</article-title><source>Bioinformatics</source><year>2006</year><volume>7</volume><fpage>808</fpage><lpage>814</lpage><pub-id pub-id-type="pmid">16418236</pub-id></citation></ref><ref id="B9"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Sheth</surname><given-names>N</given-names></name><etal/></person-group><article-title>Treemap, Radial Tree and 3D Tree Visualizations</article-title><source>IEEE Information Visualization Conference.</source><year>2003</year><publisher-loc>Seattle, Washington</publisher-loc><fpage>28</fpage><lpage>129</lpage></citation></ref></ref-list></back></article>