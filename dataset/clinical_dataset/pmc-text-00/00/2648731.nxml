<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd"><article xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id><journal-title>BMC Bioinformatics</journal-title><issn pub-type="epub">1471-2105</issn><publisher><publisher-name>BioMed Central</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">19208154</article-id><article-id pub-id-type="pmc">2648731</article-id><article-id pub-id-type="publisher-id">1471-2105-10-S1-S51</article-id><article-id pub-id-type="doi">10.1186/1471-2105-10-S1-S51</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research</subject></subj-group></article-categories><title-group><article-title>Analysis of mass spectrometry data using sub-spectra</article-title></title-group><contrib-group><contrib id="A1" corresp="yes" contrib-type="author"><name><surname>Meuleman</surname><given-names>Wouter</given-names></name><xref ref-type="aff" rid="I1">1</xref><xref ref-type="aff" rid="I2">2</xref><email>w.meuleman@tudelft.nl</email></contrib><contrib id="A2" contrib-type="author"><name><surname>Engwegen</surname><given-names>Judith YMN</given-names></name><xref ref-type="aff" rid="I3">3</xref><email>Judith.Engwegen@slz.nl</email></contrib><contrib id="A3" contrib-type="author"><name><surname>Gast</surname><given-names>Marie-Christine W</given-names></name><xref ref-type="aff" rid="I3">3</xref><email>Marie-Christine.Gast@slz.nl</email></contrib><contrib id="A4" contrib-type="author"><name><surname>Wessels</surname><given-names>Lodewyk FA</given-names></name><xref ref-type="aff" rid="I1">1</xref><xref ref-type="aff" rid="I2">2</xref><email>l.wessels@nki.nl</email></contrib><contrib id="A5" contrib-type="author"><name><surname>Reinders</surname><given-names>Marcel JT</given-names></name><xref ref-type="aff" rid="I2">2</xref><email>m.j.t.reinders@tudelft.nl</email></contrib></contrib-group><aff id="I1"><label>1</label>Bioinformatics and Statistics, Department of Molecular Biology, The Netherlands Cancer Institute, Amsterdam, The Netherlands</aff><aff id="I2"><label>2</label>Information and Communication Theory Group, Faculty of Electrical Engineering, Mathematics and Computer Science, Delft University of Technology, Delft, The Netherlands</aff><aff id="I3"><label>3</label>Department of Pharmacy &#x00026; Pharmacology, The Netherlands Cancer Institute/Slotervaart Hospital, Amsterdam, The Netherlands</aff><pub-date pub-type="collection"><year>2009</year></pub-date><pub-date pub-type="epub"><day>30</day><month>1</month><year>2009</year></pub-date><volume>10</volume><issue>Suppl 1</issue><supplement><named-content content-type="supplement-title">Selected papers from the Seventh Asia-Pacific Bioinformatics Conference (APBC 2009)</named-content><named-content content-type="supplement-editor">Michael Q Zhang, Michael S Waterman and Xuegong Zhang</named-content></supplement><fpage>S51</fpage><lpage>S51</lpage><ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/10/S1/S51"/><permissions><copyright-statement>Copyright &#x000a9; 2009 Meuleman et al; licensee BioMed Central Ltd.</copyright-statement><copyright-year>2009</copyright-year><copyright-holder>Meuleman et al; licensee BioMed Central Ltd.</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0"><p>This is an open access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p><!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>               Meuleman               Wouter                                             w.meuleman@tudelft.nl            </dc:author><dc:title>            Analysis of mass spectrometry data using sub-spectra         </dc:title><dc:date>2009</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 10(Suppl 1): S51-. (2009)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2009)10:Suppl 1&#x0003c;S51&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>--></license></permissions><abstract><sec><title>Background</title><p>Spectra resulting from Surface-Enhanced Laser Desorption/Ionisation (SELDI) mass spectrometry measurements are constructed by combining sub-spectra, each of which are the result of a single firing of the laser responsible for the process of desorption/ionisation. These firings are performed at different locations of the spot on which the sample is analysed. The final spectrum is then constructed by summing over all these sub-spectra. This process is sub-optimal in that it can average out peaks from peptides that are present in low abundance or are unevenly distributed across the spot, particularly because the amount of noise varies considerably between sub-spectra. This argues for analysing sub-spectra separately and combining results afterwards.</p></sec><sec><title>Results</title><p>Here, we propose to analyse these sub-spectra one-by-one and combine the results using a framework which includes a significance test. This allows one to, for the first time, attach a confidence measure to detected peaks, based on the signal strength of a peak across sub-spectra. In a comparison with three other approaches the sub-spectral approach achieves a higher sensitivity and a low FDR. We further introduce the notion of peak-bags, which provide rich information about the sub-spectral contributions to a given peak.</p></sec><sec><title>Conclusion</title><p>The proposed procedure offers better control over the process of distinguishing signal from noise, resulting in an improved performance over other available methods. Moreover, our method provides an implicit deconvolution of peaks, yielding insight in the actual shape of a peak, potentially aiding in a deeper understanding of peak distribution.</p></sec><sec><title>Availability</title><p>Implementations of the algorithm in R are available upon request.</p></sec></abstract><conference><conf-date>13&#x02013;16 January 2009</conf-date><conf-name>The Seventh Asia Pacific Bioinformatics Conference (APBC 2009)</conf-name><conf-loc>Beijing, China</conf-loc></conference></article-meta></front><body><sec><title>Background</title><p>Surface-Enhanced Laser Desorption/Ionisation (SELDI) Time-Of-Flight (TOF) mass spectrometry [<xref ref-type="bibr" rid="B1">1</xref>] allows one to scan the (sub-)proteome of a biological sample. The sample, e.g., purified serum, is applied to a spot on a chip and repeatedly irradiated by a laser, which causes peptides contained in the sample to desorb from the spot and become ionised (charged), which is crucial for the subsequent process of mass-separation and detection.</p><p>The used laser beam has, depending on the machine model employed, either an elliptical or round shape. In any case, its size does not allow for a full coverage of the complete spot in one go. Therefore, in order to cover most of it, the laser probes different positions of the spot, resulting in <italic>sub-spectra </italic>(also termed <italic>single-shot spectra </italic>or <italic>transients</italic>) for each location. By default, a final spectrum is constructed by summing over all sub-spectra, which is then presented to the user.</p><p>The individual sub-spectra however, contain a wealth of information, that is normally missed by studying full spectra only. This includes information on spatial differences between sub-spectra, such as the total protein and matrix material content and the amount of noise, which all can vary considerably between sub-spectra due to, e.g., inhomogeneity of the sample and various experimental factors.</p><p>Figure <xref ref-type="fig" rid="F1">1a</xref> shows sub-spectra of an example spectrum, displaying large global differences in the amount of signal and noise between spot positions.</p><fig position="float" id="F1"><label>Figure 1</label><caption><p><bold>Examples of sub-spectra</bold>. (a) Example of differences in the amount of signal and noise in sub-spectra resulting from measurements at different spot positions. The spot positions are indicated on the right. (b) Examples of a peak corresponding to ubiquitin (mass indicated by red dotted line) in two sub-spectra and the full (aggregated) spectrum.</p></caption><graphic xlink:href="1471-2105-10-S1-S51-1"/></fig><p>This is made more clear in Figure <xref ref-type="fig" rid="F1">1b</xref>. The first two panels show sub-spectra at spot positions 9 and 10 for the mass region corresponding to the ubiquitin protein. This clearly shows the large possible differences in signal between spot positions. The third panel shows the full spectrum, resulting from averaging over all sub-spectra. Indeed, here the ubiquitin peak is not significantly higher than the background.</p><p>In case of an inhomogeneous distribution of peptides over the spot, for example in the case of a low abundant peptide, taking the mean over all sub-spectra with these highly varying signal and noise levels can average out peaks, causing only the most abundant peptides to appear in the final spectrum. In Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>, section 1, we describe a simple experiment that simulates this behaviour, showing that for arbitrary signals with varying noise levels it is indeed beneficial to study them separately.</p><p>We are not alone [<xref ref-type="bibr" rid="B2">2</xref>] in believing that the default data acquisition process is sub-optimal and that it is beneficial to analyse individual sub-spectra and combining findings afterwards. Sk&#x000f6;ld <italic>et al. </italic>have also analysed sub-spectra before, mainly within the scope of imputing missing values, i.e., identifying and recovering saturated spectral peaks. Our focus is on peak detection. More specifically, by analysing individual sub-spectra and combining results afterwards, we account for differences in noise levels between spot positions, decreasing the chance of losing peaks from peptides that are present in low abundance or are unevenly distributed over the spot.</p><p>Furthermore, we are able to quantify the confidence of detected peaks being true positives. The analysis of sub-spectra allows us to test the significance of peaks based on their amplitude in these sub-spectra, largely eliminating the need for (arbitrary) parameter settings during the peak detection process.</p></sec><sec><title>Results and discussion</title><p>The approach we take involves a low-level analysis of individual sub-spectra using wavelets, followed by a method to assess the significance of peaks detected in the sub-spectra. We show that our method compares favourably to a number of existing methods by using spectra resulting from a carefully designed spiking experiment. Furthermore, we show that our method offers an implicit deconvolution of peaks through the notion of <italic>peak-bags</italic>.</p><sec><title>Analysis of sub-spectra</title><p>SELDI (sub-)spectra exhibit much noise, including a strong baseline effect caused by the use of energy absorbing matrix material inherent to the technology. Conventionally, this baseline effect is estimated and subtracted from the data explicitly, using <italic>ad hoc </italic>baseline correction algorithms. Methods based on wavelets [<xref ref-type="bibr" rid="B3">3</xref>-<xref ref-type="bibr" rid="B5">5</xref>] model this noise implicitly, assuming its frequency and shape is fundamentally different from that of the signal.</p><p>We use the algorithm proposed by Du <italic>et al. </italic>[<xref ref-type="bibr" rid="B4">4</xref>] to detect peaks in <italic>individual sub-spectra</italic>. They use an approach based on a continuous wavelet transform. By scaling and translating a so-called mother wavelet function, a spectrum is decomposed into a 'scale space', where low scales model high frequency noise and high scales model low frequency global trends in the data. Peaks can be found by identifying ridges in this scale space, corresponding to regions where the spectrum is highly correlated with the wavelet function.</p><p>This process is described in more detail in the Methods section ('Wavelet analysis on full spectrum'). Although we consider the scale space approach taken by Du <italic>et al. </italic>to be elegant, their algorithm employs a number of fairly arbitrarily chosen parameters to identify ridges as being peaks. For instance, the range and number of scales across which ridges are detected and a signal-to-noise ratio threshold. Instead, we consider all ridges detected in sub-spectra to be candidate peaks and use them as input to subsequent analyses, regardless of these parameters.</p></sec><sec><title>Peak significance</title><p>Instead of using parameter-based peak-detection, we rely on a significance test for candidate peaks. The wavelet analysis yields, for each sub-spectrum, a set of identified (candidate) peak positions and amplitudes in the form of peak signal-to-noise ratios (Figure <xref ref-type="fig" rid="F2">2a</xref>). All these single-peak amplitudes, i.e., from all sub-spectra, form a peak distribution <italic>P </italic>which roughly follows a Gamma distribution (Figure <xref ref-type="fig" rid="F2">2b</xref>). This distribution consists of both real peaks as well as a background distribution. In order to estimate the background distribution, we use an iterative procedure of removing high values, i.e., 'real' peaks, and re-fitting a Gamma distribution, until we obtain a distribution <italic>Q </italic>of 'noise' peaks (see Methods section ('Estimating the noise distribution')).</p><fig position="float" id="F2"><label>Figure 2</label><caption><p><bold>Combined analysis of sub-spectra</bold>. (a) Peaks detected in each sub-spectrum using the wavelet analysis. We obtain one set of peaks for each sub-spectrum, although in this cartoon we show only three, for simplicity. (b) Using the distribution of <italic>all </italic>peaks detected across <italic>all </italic>sub-spectra (<italic>P</italic>, solid line), we estimate a distribution of noise peaks (<italic>Q</italic>, dashed line). (c) Sets of peaks obtained in (a) are summed per <italic>m/z </italic>position and used as input for the significance test.</p></caption><graphic xlink:href="1471-2105-10-S1-S51-2"/></fig><p>In order to assess peak significance, we aggregate the wavelet analysis results from all sub-spectra. To obtain the aggregate spectrum, we sum the sub-spectral values per <italic>m/z </italic>value across all sub-spectra (Figure <xref ref-type="fig" rid="F2">2c</xref>). The significance of one particular <italic>m/z </italic>position is assessed by comparing the value in the summed peak spectrum to a null distribution, yielding a p-value. This null distribution is the probability density function associated with the random variable which is obtained by summing <italic>n </italic>(number of sub-spectra) random variables distributed according to <italic>Q</italic>. In other words, this null distribution is a <italic>summed sampling distribution </italic>of <italic>Q</italic>, denoted <italic>Q</italic><sub>&#x003a3;</sub>. Please refer to the Methods section ('Peak significance test') for a more elaborate discussion on this procedure.</p><p>Mass spectrometers suffer from a limited mass accuracy. To account for small deviations in peak positions across sub-spectra, we extend the significance test to multiple <italic>m/z </italic>positions simultaneously, i.e., all positions contained in a sliding window of size <italic>w</italic>. For multiple window sizes, this results in a second scale space of p-values with the <italic>m/z </italic>positions of the window on the horizontal axis and the window size on the vertical axis. Each position contains the p-value of the test result at that <italic>m/z </italic>position with the given window size. All p-values are corrected for multiple testing per window size (i.e., row-wise) over all non-empty windows using the procedure proposed by Benjamini and Hochberg [<xref ref-type="bibr" rid="B6">6</xref>].</p><p>In this second scale space, we now search for clusters containing as many <italic>m/z </italic>positions as possible that are significant <italic>and </italic>have at most one contribution from each sub-spectrum. The latter is used to prevent finding clusters containing peaks for actually different peptides; these should result in separate clusters. We start the search from the most significant peak at a minimal window size. In an iterative process, the window size is gradually increased, up to the point where either</p><p>&#x02022; the combined values of peaks within the window are not significant anymore, or</p><p>&#x02022; we include more than one contribution from a single sub-spectrum.</p><p>The results of this procedure we call <italic>peak-bags </italic>and they encompass a central peak position, a range of <italic>m/z </italic>values in a window centered around this peak position, and a signal level for each <italic>m/z </italic>value, also registering which sub-spectra contributed to this signal. The signal level is a summation of the wavelet coefficient values for the contributing sub-spectra.</p><p>Figure <xref ref-type="fig" rid="F3">3</xref> contains a cartoon of the iterative process to detect peak-bags. In Panel (a), the position that is significant at a minimal window size is Position 10 at window size 1. At a window size of 3, this is still significant. Also, the positions within this window (Positions 9, 10 and 11) contain at most one contribution from each sub-spectrum. At a window size of 5 however, a second 'black' peak is included (Position 12), thereby violating the rules. Therefore, the window of size 3, centered on Position 10, is selected as a new peak-bag. In Panel (b), the scale space elements that will not be used for detecting future peak-bags are greyed out. These elements are the ones that, when used as a future window-center, would reference peak positions already belonging the newly identified peak-bag. More formally, for each window size <italic>w </italic>in the scale space, with <italic>x</italic><sub><italic>i </italic></sub>being the center of the new peak-bag, this includes positions <italic>x</italic><sub><italic>i </italic></sub>- ((<italic>w</italic>-1)/2) - ((<italic>W</italic>-1)/2) to <italic>x</italic><sub><italic>i</italic></sub>+((<italic>w</italic>-1)/2)+((<italic>W</italic>-1)/2), where <italic>W </italic>is the window size of the new peak-bag.</p><fig position="float" id="F3"><label>Figure 3</label><caption><p><bold>Cartoon depicting the process used to identifypeak-bags</bold>. Each panel shows the same example wavelet analysis output (bottom), with peaks coloured corresponding to the originating sub-spectra, and a hypothetical p-value scale space (top), where white regions are termed significant. (a) Analysis over multiple window sizes. Window size 5 at <italic>m/z </italic>= 10 is significant, but has multiple contributions from the same sub-spectrum (i.e., the black peaks). Therefore, a window of size 3 is used for the new peak-bag, since it is the largest significant window size with at most one contribution from each sub-spectra. Scale space elements that, when used as a future window-center, reference peak positions lying in the current window, are greyed out and the process restarts. (b) Although the combined peaks are significant, there are again multiple contributions from one sub-spectrum at window size 3. Position 5 at window size 1 is not significant. (c) Peak-bag at slightly higher scale. Larger windows are greyed out, so a new peak-bag is selected with window size 5. (d) No significant elements remaining.</p></caption><graphic xlink:href="1471-2105-10-S1-S51-3"/></fig><p>The next significant position is Position 5 (window size 3). However, this has two contributions from the same sub-spectrum (the black peaks). Position 5 alone (i.e., at window size 1) is not significant. Therefore, no new peak-bag is defined. However, in Panel (c) the appropriate elements in the significance scale space are still greyed out. This is to avoid re-analysis of Position 5. Position 14 at window size 5 is significant, contains only single contributions and no larger window exists. It is selected as a second peak-bag. Panel (d) shows the result of greying out the appropriate elements again. No significant elements are remaining, finalising the analysis.</p></sec><sec><title>Experiments</title><p>We performed SELDI-TOF mass spectrometry twice on 16 samples containing a mixture of 5 spiking peptides. This way, we obtained 32 full spectra and their respective sub-spectra. The spiking peptides used are dynorphin (2147.5 Da), ACTH 1&#x02013;24 (2933.5 Da), <italic>&#x003b2;</italic>-endorphin (3465.6 Da), insulin (cow pancreas; 5733.6 Da) and ubiquitin (8564.8 Da).</p><p>We employed our sub-spectral analysis method and compared the obtained peak-bags to the results of three methods for analysing full mass spectra. These are the wavelet-based method proposed by Du <italic>et al. </italic>[<xref ref-type="bibr" rid="B4">4</xref>], a standard method implemented in the PROcess R-package and another method implemented in the MASDA R-package. MASDA implements an elementary SELDI-TOF analysis pipeline, used for the comparison of normalisation methods [<xref ref-type="bibr" rid="B7">7</xref>]. Except for the approach presented here, all these methods employ a signal-to-noise ratio cutoff in order to detect peaks.</p><p>For the comparison of results, we assessed the sensitivity and False Discovery Rate (FDR) with respect to finding peaks corresponding to the five spiking peptides. By varying the parameters that influence the number of detected peaks (p-value or signal-to-noise ratio) over a wide range of values, and computing the sensitivity and FDR at every setting, we can construct and Operating Characteristic (OC) curve (see Figure <xref ref-type="fig" rid="F4">4</xref>).</p><fig position="float" id="F4"><label>Figure 4</label><caption><p><bold>Operating Characteristic curves</bold>. Operating Characteristic (OC) curves evaluating the performance of four analysis methods, including the method proposed here.</p></caption><graphic xlink:href="1471-2105-10-S1-S51-4"/></fig><p>Ideally, the sensitivity of a method should be as high as possible, while keeping the FDR as small as possible. In other words, we would like to be as much as possible towards the topleft position of the graph in Figure <xref ref-type="fig" rid="F4">4</xref>.</p><p>The sub-spectral analysis clearly outperforms the other (full spectrum based) methods by achieving both a high sensitivity and low FDR across a relatively large range of p-value thresholds. Even when the FDR is high, the sensitivity of the sub-spectral analysis clearly outperforms all other approaches. Although it has been shown in the literature [<xref ref-type="bibr" rid="B4">4</xref>,<xref ref-type="bibr" rid="B5">5</xref>] that the wavelet-based analysis often outperforms the traditional analysis methods, such as the one implemented in the MASDA package, here it only seems to outperform the latter in the low FDR range. This is, however, not so bad, as in most proteomics analyses it is actually desirable to keep the FDR at a low level. The PROcess package generally performs the worst. Although it displays the lowest FDR, its sensitivity is extremely low.</p></sec><sec><title>Peak-bags</title><p>The methods we compare our approach with do not provide any information on the shape of peaks. Our method, based on analysing sub-spectra, yields peak-bags that do provide this information, as well as a confidence measure in the form of a p-value. Figure <xref ref-type="fig" rid="F5">5</xref> shows part of a spectrum of a human serum sample (full spectrum is shown in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>, section 5) with one large peak and what seems to be several adduct peaks of the same peptide.</p><fig position="float" id="F5"><label>Figure 5</label><caption><p><bold>Examples of peak-bags found by our algorithm in a spectrum of human serum</bold>. (a) Full spectrum (b) Identified peak-bags with <italic>p </italic>&#x0003c; 0.05. (c) Details of peak-bags with <italic>m/z </italic>values, contributing sub-spectra and a graphical representation of the peaks in the bag.</p></caption><graphic xlink:href="1471-2105-10-S1-S51-5"/></fig><p>The methods implemented by Du <italic>et al. </italic>and the PROcess package find only one peak here, namely the largest one. The MASDA package finds some of the adduct peaks as well, albeit at an unrealisticly low signal-to-noise ratio cutoff. Sub-spectral analysis however, yields multiple peak-bags. In the figure, each colour represents a peak-bag with its associated peak positions and amplitudes. Note that these peak-bags are selected with <italic>p </italic>&#x0003c; 0.05 and have at most one contribution from each sub-spectrum, as shown in Figure <xref ref-type="fig" rid="F5">5</xref>.</p></sec></sec><sec><title>Conclusion</title><p>We have shown that analysing sub-spectra allows one to find real peaks not found by other methods. Our results are not heavily dependent on parameter settings, such as a signal-to-noise ratio threshold for detecting peaks. Instead, for the first time, we provide a confidence measure for peaks in the form of p-values, reducing the false positive rate and yielding a better sensitivity.</p><p>Furthermore, our notion of peak-bags provides information on the variability and distribution of peaks across sub-spectra and their contribution to the aggregate (full) spectrum. This provides a more complete representation of peaks, impossible to obtain using full spectra. Effectively, our approach offers an implicit way of deconvoluting spectra.</p></sec><sec sec-type="methods"><title>Methods</title><sec><title>Sample pre-processing</title><p>Spiking mixture was freshly prepared from individual peptides (Ciphergen Biosystems Inc., Freemont, CA, USA). A 100 <italic>&#x003bc;l</italic>-stock solution containing a mixture of dynorphin (2147.5 Da), ACTH 1&#x02013;24 (2933.5 Da), <italic>&#x003b2;</italic>-endorphin (3465.6 Da), insulin (cow pancreas; 5733.6 Da) and ubiquitin (8564.8 Da), each 1 nmol/100 <italic>&#x003bc;l</italic>, in deionised water was prepared. In pilot experiments the optimal dilution for spiking in matrix was assessed, resulting in an optimal dilution of 1:1000 when applying 20 <italic>&#x003bc;l </italic>of sample and 2 <italic>&#x003bc;l </italic>of matrix to the chip.</p><p>Before the experiment, the serum sample was thawed and denatured by adding 190 <italic>&#x003bc;l </italic>of a solution of 9 M urea and 2% CHAPS, (Sigma, St. Louis, MO, USA) to 10 <italic>&#x003bc;l </italic>of serum. As energy absorbing matrix a 50% solution of sinapinic acid (SPA; Ciphergen Biosystems) in 50% acetonitrile (ACN) + 0.5% trifluoracetic acid (TFA) was used. Spiked matrix was prepared by adding 6 <italic>&#x003bc;l </italic>of a 1:15 dilution of spiking solution to a total of 400 <italic>&#x003bc;l </italic>SPA solution.</p><p>We performed SELDI-TOF mass spectrometry (Ciphergen Biosystems) with CM10 chips (weak cation exchange chip containing anionic carboxylate groups that bind positively charged proteins in serum) with a 100 mM sodium acetate (Sigma) binding buffer, pH 4, and a 50 mM HEPES wash buffer.</p><p>During all steps of the protocol, the bioprocessor was placed on a platform shaker at 350 rpm. Chips were equilibrated twice with 200 <italic>&#x003bc;l </italic>of binding buffer for 5 min. Subsequently, 180 <italic>&#x003bc;l </italic>of binding buffer and 20 <italic>&#x003bc;l </italic>of denatured sample were applied to the chip surface. Incubation was set to 30 min. After binding, the chips were washed twice for 5 min with binding buffer, followed by two 5-min washes with wash buffer. Lastly, chips were rinsed with deionised water, air-dried and finished with two 1-<italic>&#x003bc;l </italic>SPA applications to the sample spots.</p></sec><sec><title>Data acquisition</title><p>Protein chips were analysed using the PBS-IIC ProteinChip Reader (Ciphergen Biosystems). Data were collected between 0 and 100000 Da, optimisation range from 1500 to 50000 Da, laser intensity 155, detector sensitivity 5 and laser focusing at 10000 Da. We probed spot positions 20 to 80, with intervals of 5 and with five repeat shots per position, yielding in total 65 sub-spectra per spot. For information on how to obtain sub-spectra, please refer to Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>, section 6.</p><p>We performed a two-way ANOVA analysis, with 'spot position' and 'repeat shot index' as covariates, to test whether there are significant differences in noise levels that can be explained by either one of these covariates. We confirmed the findings of [<xref ref-type="bibr" rid="B2">2</xref>] in the sense that in general we find a significant portion of the variance to be explained by spot position and not by shot index. This lead us to the decision to sum sub-spectra on a per-position basis, thereby reducing the computational complexity of the study, while still enabling us to show the potential of our method. This procedure leads to the 13 sub-spectra described in the paper.</p></sec><sec><title>Full spectrum approaches</title><sec><title>PROcess R-package</title><p>We use the PROcess R-package exactly as recommended in the accompanying documentation (i.e., the R <italic>vignette</italic>). The peak discriminating parameter we vary for the performance assessment is the signal-to-noise ratio.</p></sec><sec><title>MASDA R-package</title><p>An often used method of analysing a mass spectrum is by extracting the (monotonically decreasing) baseline signal, normalising the spectrum and detecting peaks above a certain pre-specified noise level. Normalisation is done here using a method found to perform well in an earlier study [<xref ref-type="bibr" rid="B7">7</xref>], namely by extracting the mean from a spectrum and subsequently dividing it by the standard deviation. Peaks are selected above a threshold (the signal-to-noise ratio), defined by the mean plus a number of times the standard devation, both of which are estimated within a local window of 1000 measurement points. These procedures are implemented in the MASDA R-package for mass spectrometry data analysis, freely available from [<xref ref-type="bibr" rid="B8">8</xref>].</p></sec><sec><title>Wavelet analysis on full spectrum</title><p>Following [<xref ref-type="bibr" rid="B4">4</xref>], we employ a <italic>mexican hat </italic>mother wavelet, which is proportional to the second derivative of a Gaussian function and is similar in shape to actual peaks found in a mass spectrum.</p><p>The mother wavelet is scaled and translated over spectra, during which the inner product between the wavelet and the signal is calculated, resulting in a scale space of wavelet coefficients. This scale space is used to extract features, i.e., peaks, from spectra.</p><p><italic>Ridges </italic>in this space are identified, by locating local maxima over scales. Du <italic>et al. </italic>then filter these according to a certain parameter set, consisting of, among others, the range of scales in which peaks are detected, the minimal length of identified ridges and a signal-to-noise ratio threshold. The <italic>m/z </italic>axis locations of the ridges that pass these filtering steps they label as peak positions. We used the default parameters, such as used in [<xref ref-type="bibr" rid="B4">4</xref>]. Additional file <xref ref-type="supplementary-material" rid="S1">1</xref> (section 2) contains an illustration of this analyis.</p></sec></sec><sec><title>Analysis of sub-spectra</title><p>To analyse sub-spectra, we used the same procedure as for full spectra, except that we do not employ the parameters proposed by Du <italic>et al.</italic>. We do not filter ridges at this point to distinguish 'real' peaks from 'noise' peaks. Rather, we retain information on all identified ridges, in order to construct a noise distribution.</p><sec><title>Estimating the noise distribution</title><p>We have confirmed that the distribution of wavelet coefficients for an empty spectrum approximately follows a Gamma distribution (see Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>, section 3). In order to estimate the noise distribution <italic>Q</italic>, we iterate over the following procedure:</p><p>1. <italic>Q' </italic>= <italic>P</italic></p><p>2. Remove upper 0.01% quantile values from <italic>Q'</italic></p><p>3. Fit a Gamma distribution to <italic>Q'</italic></p><p>4. Assess maximum squared error (MSE) between fitted Gamma and <italic>Q'</italic></p><p>5. Go to step 2</p><p>The Gamma for which the MSE is lowest, i.e., only containing 'noise' peaks, is selected as the noise distribution <italic>Q</italic>. Please also refer to Additional file <xref ref-type="supplementary-material" rid="S1">1</xref> (section 4) for more information on this. The detection of peaks then follows the procedure as described in the main text, and peak-bags are constructed using a significance threshold (p-value).</p></sec><sec><title>Peak significance test</title><p>The wavelet analysis results for a random, noise-only, spectrum can effectively be seen as a sampling from the estimated distribution <italic>Q </italic>~ &#x00393; (<italic>k</italic>, <italic>&#x003b8;</italic>). Per sub-spectrum and <italic>m/z </italic>position, one value is drawn from <italic>Q</italic>. For <italic>n </italic>acquired sub-spectra, <italic>n </italic>values are drawn. The value for one <italic>m/z </italic>position in a full (summed) spectrum is therefore approximately the sum of these <italic>n </italic>values. The random variable representing this sum follows a <italic>summed sampling distribution</italic>, <italic>Q</italic><sub>&#x003a3;</sub>, of <italic>n</italic>-summed values drawn from <italic>Q</italic>. It follows from the Central Limit Theorem that for large enough <italic>n</italic>, the distribution of <italic>Q</italic><sub>&#x003a3; </sub>approximates a Normal distribution, defined by <italic>N</italic>(<italic>nk&#x003b8;</italic>, <italic>nk&#x003b8;</italic><sup>2</sup>), where <italic>k&#x003b8; </italic>and <italic>k&#x003b8;</italic><sup>2 </sup>are the mean and variance of <italic>Q</italic>, respectively. For one particular <italic>m/z </italic>position, the significance can be assessed by comparing the summed signal of all <italic>s </italic>peaks at that position, plus <italic>n </italic>&#x02013; <italic>s </italic>times the mean of <italic>Q </italic>(i.e., <italic>k&#x003b8;</italic>), against <italic>Q</italic><sub>&#x003a3;</sub>. For multiple <italic>m/z </italic>positions, i.e., in a sliding window of size <italic>w</italic>, a summed sampling distribution is used where <italic>n </italic>is multiplied by the window size <italic>w </italic>and <italic>s </italic>is equal to the number of peaks in the window.</p></sec></sec><sec><title>OC curve construction</title><p>We assessed the performances of the different peak detection methods using Operating Characteristic curves. Such curves are similar to Receiver Operating Characteristics curves, which register the trade-off between sensitivity and specificity. OC curves however, utilise the False Discovery Rate instead of specificity. This is much more useful in the context of mass spectrometry data, as the presence of real and noisy peaks is extremely unbalanced, in favour of the latter.</p><p>OC curves register the trade-off between sensitivity (or True Positive Rate, TPR) and False Discovery Rate (FDR), defined as follows:</p><p><disp-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" name="1471-2105-10-S1-S51-i1" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:mtable columnalign="left">                              <mml:mtr columnalign="left">                                 <mml:mtd columnalign="left">                                    <mml:mrow>                                       <mml:mtext>TPR</mml:mtext>                                    </mml:mrow>                                 </mml:mtd>                                 <mml:mtd columnalign="left">                                    <mml:mo>=</mml:mo>                                 </mml:mtd>                                 <mml:mtd columnalign="left">                                    <mml:mrow>                                       <mml:mtext>TP</mml:mtext>                                       <mml:mo>/</mml:mo>                                       <mml:mtext>P</mml:mtext>                                    </mml:mrow>                                 </mml:mtd>                              </mml:mtr>                              <mml:mtr columnalign="left">                                 <mml:mtd columnalign="left">                                    <mml:mrow/>                                 </mml:mtd>                                 <mml:mtd columnalign="left">                                    <mml:mo>=</mml:mo>                                 </mml:mtd>                                 <mml:mtd columnalign="left">                                    <mml:mrow>                                       <mml:mtext>TP</mml:mtext>                                       <mml:mo>/</mml:mo>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:mtext>TP</mml:mtext>                                       <mml:mo>+</mml:mo>                                       <mml:mtext>FN</mml:mtext>                                       <mml:mo stretchy="false">)</mml:mo>                                    </mml:mrow>                                 </mml:mtd>                              </mml:mtr>                              <mml:mtr columnalign="left">                                 <mml:mtd columnalign="left">                                    <mml:mrow>                                       <mml:mtext>FDR</mml:mtext>                                    </mml:mrow>                                 </mml:mtd>                                 <mml:mtd columnalign="left">                                    <mml:mo>=</mml:mo>                                 </mml:mtd>                                 <mml:mtd columnalign="left">                                    <mml:mrow>                                       <mml:mtext>FP</mml:mtext>                                       <mml:mo>/</mml:mo>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:mtext>FP</mml:mtext>                                       <mml:mo>+</mml:mo>                                       <mml:mtext>TP</mml:mtext>                                       <mml:mo stretchy="false">)</mml:mo>                                       <mml:mo>.</mml:mo>                                    </mml:mrow>                                 </mml:mtd>                              </mml:mtr>                           </mml:mtable>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>Here, the set of positives (P) consists of all peaks detected by a method in one run. True positives are peaks corresponding to the mass of the five spiked-in peptides described earlier. A peak is called a true positive if it lies within 0.2% [<xref ref-type="bibr" rid="B9">9</xref>-<xref ref-type="bibr" rid="B11">11</xref>] of the mass of one of these peptides plus one proton [<xref ref-type="bibr" rid="B12">12</xref>]. False negatives are the true positive peaks not found by a method. False positives are peaks detected by a method that do not correspond to any one of the spiked-in peptides.</p><p>In order to construct an OC curve, results are obtained for each method while varying a parameter value that determines the number of peaks detected by that method. This threshold is the p-value resulting from the significance test for the sub-spectra based method and the signal-to-noise ratio for all other methods. Results from the 32 spectra assessed are averaged per threshold value and plotted. A line is fitted through these points using a local running median function.</p></sec></sec><sec><title>Competing interests</title><p>The authors declare that they have no competing interests.</p></sec><sec><title>Authors' contributions</title><p>WM performed the analyses. WM, MJTR and LFAW designed the algorithms and dry-lab experiments and wrote the manuscript. WM, JYMNE and MCWG designed and performed the wet-lab experiment with the spiking peptides. All authors read and approved the final manuscript.</p></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="S1"><caption><title>Additional file 1</title><p><bold>Additional details</bold>. File containing additional details about analysis process. For now available from: <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.nki.nl/~meuleman/Meuleman2008_suppl.pdf"/>.</p></caption><media xlink:href="1471-2105-10-S1-S51-S1.pdf" mimetype="application" mime-subtype="pdf"><caption><p>Click here for file</p></caption></media></supplementary-material></sec></body><back><ack><sec><title>Acknowledgements</title><p>This work is part of the BioRange programme of the Netherlands Bioinformatics Centre (NBIC), which is supported by a BSIK grant through the Netherlands Genomics Initiative (NGI).</p><p>This article has been published as part of <italic>BMC Bioinformatics </italic>Volume 10 Supplement 1, 2009: Proceedings of The Seventh Asia Pacific Bioinformatics Conference (APBC) 2009. The full contents of the supplement are available online at <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/10?issue=S1"/></p></sec></ack><ref-list><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wright</surname><given-names>GL</given-names><suffix>Jr</suffix></name><name><surname>Cazares</surname><given-names>LH</given-names></name><name><surname>Leung</surname><given-names>SM</given-names></name><name><surname>Nasim</surname><given-names>S</given-names></name><name><surname>Adam</surname><given-names>BL</given-names></name><name><surname>Yip</surname><given-names>TT</given-names></name><name><surname>Schellhammer</surname><given-names>PF</given-names></name><name><surname>Gong</surname><given-names>L</given-names></name><name><surname>Vlahou</surname><given-names>A</given-names></name></person-group><article-title>Proteinchip(R) surface enhanced laser desorption/ionization (SELDI) mass spectrometry: a novel protein biochip technology for detection of prostate cancer biomarkers in complex protein mixtures</article-title><source>Prostate Cancer Prostatic Dis</source><year>1999</year><volume>2</volume><fpage>264</fpage><lpage>276</lpage><pub-id pub-id-type="pmid">12497173</pub-id></citation></ref><ref id="B2"><citation citation-type="other"><person-group person-group-type="author"><name><surname>Sk&#x000f6;ld</surname><given-names>M</given-names></name><name><surname>Ryden</surname><given-names>T</given-names></name><name><surname>Samuelsson</surname><given-names>V</given-names></name><name><surname>Bratt</surname><given-names>C</given-names></name><name><surname>Ekblad</surname><given-names>L</given-names></name><name><surname>Olsson</surname><given-names>H</given-names></name><name><surname>Baldetorp</surname><given-names>B</given-names></name></person-group><article-title>Regression analysis and modelling of data acquisition for SELDI-TOF mass spectrometry</article-title><source>Bioinformatics</source><year>2007</year><comment>btm104.</comment></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lio</surname><given-names>P</given-names></name></person-group><article-title>Wavelets in bioinformatics and computational biology: state of art and perspectives</article-title><source>Bioinformatics</source><year>2003</year><volume>19</volume><fpage>2</fpage><lpage>9</lpage><pub-id pub-id-type="pmid">12499286</pub-id></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Du</surname><given-names>P</given-names></name><name><surname>Kibbe</surname><given-names>WA</given-names></name><name><surname>Lin</surname><given-names>SM</given-names></name></person-group><article-title>Improved peak detection in mass spectrum by incorporating continuous wavelet transform-based pattern matching</article-title><source>Bioinformatics</source><year>2006</year><volume>22</volume><fpage>2059</fpage><lpage>2065</lpage><pub-id pub-id-type="pmid">16820428</pub-id></citation></ref><ref id="B5"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lange</surname><given-names>E</given-names></name><name><surname>Gr&#x000f6;pl</surname><given-names>C</given-names></name><name><surname>Reinert</surname><given-names>K</given-names></name><name><surname>Kohlbacher</surname><given-names>O</given-names></name><name><surname>Hildebrandt</surname><given-names>A</given-names></name></person-group><article-title>High-Accuracy Peak Picking of Proteomics Data Using Wavelet Techniques</article-title><source>Pacific Symposium on Biocomputing</source><year>2006</year><volume>11</volume><fpage>243</fpage><lpage>254</lpage><pub-id pub-id-type="pmid">17094243</pub-id></citation></ref><ref id="B6"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Benjamini</surname><given-names>Y</given-names></name><name><surname>Hochberg</surname><given-names>Y</given-names></name></person-group><article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title><source>Journal of the Royal Statistical Society</source><year>1995</year><volume>57</volume><fpage>289</fpage><lpage>300</lpage></citation></ref><ref id="B7"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Meuleman</surname><given-names>W</given-names></name><name><surname>Engwegen</surname><given-names>J</given-names></name><name><surname>Gast</surname><given-names>M</given-names></name><name><surname>Beijnen</surname><given-names>J</given-names></name><name><surname>Reinders</surname><given-names>M</given-names></name><name><surname>Wessels</surname><given-names>L</given-names></name></person-group><article-title>Comparison of normalisation methods for Surface-Enhanced Laser Desorption and Ionisation Time-Of-Flight Mass Spectrometry data</article-title><source>BMC Bioinformatics</source><year>2008</year><volume>9</volume><pub-id pub-id-type="pmid">18257918</pub-id></citation></ref><ref id="B8"><citation citation-type="other"><article-title>NKI Bioinformatics group website</article-title><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.nki.nl"/></citation></ref><ref id="B9"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Grizzle</surname><given-names>WE</given-names></name><name><surname>Semmes</surname><given-names>OJ</given-names></name><name><surname>Bigbee</surname><given-names>W</given-names></name><name><surname>Zhu</surname><given-names>L</given-names></name><name><surname>Malik</surname><given-names>G</given-names></name><name><surname>Oelschlager</surname><given-names>DK</given-names></name><name><surname>Manne</surname><given-names>B</given-names></name><name><surname>Manne</surname><given-names>U</given-names></name></person-group><article-title>The Need for Review and Understanding of SELDI/MALDI Mass Spectroscopy Data Prior to Analysis</article-title><source>Cancer Informatics</source><year>2005</year><volume>1</volume><fpage>86</fpage><lpage>97</lpage></citation></ref><ref id="B10"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Yasui</surname><given-names>Y</given-names></name><name><surname>Pepe</surname><given-names>M</given-names></name><name><surname>Thompson</surname><given-names>ML</given-names></name><name><surname>Adam</surname><given-names>BL</given-names></name><name><surname>Wright</surname><given-names>J</given-names></name><name><surname>George</surname><given-names>L</given-names></name><name><surname>Qu</surname><given-names>Y</given-names></name><name><surname>Potter</surname><given-names>JD</given-names></name><name><surname>Winget</surname><given-names>M</given-names></name><name><surname>Thornquist</surname><given-names>M</given-names></name><name><surname>Feng</surname><given-names>Z</given-names></name></person-group><article-title>A data-analytic strategy for protein biomarker discovery: profiling of high-dimensional proteomic data for cancer detection</article-title><source>Biostat</source><year>2003</year><volume>4</volume><fpage>449</fpage><lpage>463</lpage></citation></ref><ref id="B11"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Adam</surname><given-names>BL</given-names></name><name><surname>Qu</surname><given-names>Y</given-names></name><name><surname>Davis</surname><given-names>JW</given-names></name><name><surname>Ward</surname><given-names>MD</given-names></name><name><surname>Clements</surname><given-names>MA</given-names></name><name><surname>Cazares</surname><given-names>LH</given-names></name><name><surname>Semmes</surname><given-names>OJ</given-names></name><name><surname>Schellhammer</surname><given-names>PF</given-names></name><name><surname>Yasui</surname><given-names>Y</given-names></name><name><surname>Feng</surname><given-names>Z</given-names></name><name><surname>Wright</surname><given-names>J</given-names></name><name><surname>George</surname><given-names>L</given-names></name></person-group><article-title>Serum Protein Fingerprinting Coupled with a Pattern-matching Algorithm Distinguishes Prostate Cancer from Benign Prostate Hyperplasia and Healthy Men</article-title><source>Cancer Res</source><year>2002</year><volume>62</volume><fpage>3609</fpage><lpage>3614</lpage><pub-id pub-id-type="pmid">12097261</pub-id></citation></ref><ref id="B12"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Dijkstra</surname><given-names>M</given-names></name><name><surname>Vonk</surname><given-names>RJ</given-names></name><name><surname>Jansen</surname><given-names>RC</given-names></name></person-group><article-title>SELDI-TOF mass spectra: A view on sources of variation</article-title><source>J Chromatogr B Analyt Technol Biomed Life Sci</source><year>2006</year><pub-id pub-id-type="pmid">17118720</pub-id></citation></ref></ref-list></back></article>