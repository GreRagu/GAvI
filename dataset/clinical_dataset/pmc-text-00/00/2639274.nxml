<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd"><article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article" xml:lang="EN"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id><journal-id journal-id-type="publisher-id">bioinformatics</journal-id><journal-id journal-id-type="hwp">bioinfo</journal-id><journal-title>Bioinformatics</journal-title><issn pub-type="ppub">1367-4803</issn><issn pub-type="epub">1460-2059</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">18842597</article-id><article-id pub-id-type="pmc">2639274</article-id><article-id pub-id-type="doi">10.1093/bioinformatics/btn514</article-id><article-id pub-id-type="publisher-id">btn514</article-id><article-categories><subj-group subj-group-type="heading"><subject>Original Papers</subject><subj-group><subject>Genetics and Population Analysis</subject></subj-group></subj-group></article-categories><title-group><article-title>Inferring population history with <italic>DIY ABC</italic>: a user-friendly approach to approximate Bayesian computation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Cornuet</surname><given-names>Jean-Marie</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref><xref ref-type="aff" rid="AFF1"><sup>2</sup></xref><xref ref-type="corresp" rid="COR1">*</xref></contrib><contrib contrib-type="author"><name><surname>Santos</surname><given-names>Filipe</given-names></name><xref ref-type="aff" rid="AFF1"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Beaumont</surname><given-names>Mark A.</given-names></name><xref ref-type="aff" rid="AFF1"><sup>3</sup></xref></contrib><contrib contrib-type="author"><name><surname>Robert</surname><given-names>Christian P.</given-names></name><xref ref-type="aff" rid="AFF1"><sup>4</sup></xref></contrib><contrib contrib-type="author"><name><surname>Marin</surname><given-names>Jean-Michel</given-names></name><xref ref-type="aff" rid="AFF1"><sup>5</sup></xref></contrib><contrib contrib-type="author"><name><surname>Balding</surname><given-names>David J.</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Guillemaud</surname><given-names>Thomas</given-names></name><xref ref-type="aff" rid="AFF1"><sup>6</sup></xref></contrib><contrib contrib-type="author"><name><surname>Estoup</surname><given-names>Arnaud</given-names></name><xref ref-type="aff" rid="AFF1"><sup>2</sup></xref></contrib></contrib-group><aff id="AFF1"><sup>1</sup>Department of Epidemiology and Public Health, Imperial College, St Mary's Campus, Norfolk Place, London W2 1PG, UK, <sup>2</sup>Centre de Biologie et de Gestion des Populations, INRA, Campus International de Baillarguet, CS 30016 34988 Montferrier-sur-Lez, France, <sup>3</sup>School of Biological Sciences, Lyle Building, The University of Reading Whiteknights, Reading RG6 6AS, UK, <sup>4</sup>CEREMADE, Universit&#x000e9; Paris-Dauphine, Place Delattre de Tassigny, 75775 Paris cedex 16, <sup>5</sup>INRIA Saclay, Projet select, Universit&#x000e9; Paris-Sud, Laboratoire de Math&#x000e9;matiques (B&#x000e2;t. 425), 91400 Orsay and <sup>6</sup>UMR 1301 I.B.S.V. INRA-UNSA-CNRS, 400 Route des Chappes, BP 167 - 06903 Sophia Antipolis cedex. France</aff><author-notes><corresp id="COR1">*To whom correspondence should be addressed.</corresp><fn><p>Associate Editor: Martin Bishop</p></fn></author-notes><pub-date pub-type="ppub"><day>1</day><month>12</month><year>2008</year></pub-date><pub-date pub-type="epub"><day>7</day><month>10</month><year>2008</year></pub-date><pub-date pub-type="pmc-release"><day>7</day><month>10</month><year>2008</year></pub-date><volume>24</volume><issue>23</issue><fpage>2713</fpage><lpage>2719</lpage><history><date date-type="received"><day>17</day><month>6</month><year>2008</year></date><date date-type="rev-recd"><day>5</day><month>9</month><year>2008</year></date><date date-type="accepted"><day>2</day><month>10</month><year>2008</year></date></history><permissions><copyright-statement>&#x000a9; 2008 The Author(s)</copyright-statement><copyright-year>2008</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/"><p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">http://creativecommons.org/licenses/by-nc/2.0/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</p></license></permissions><abstract><p><bold>Summary:</bold> Genetic data obtained on population samples convey information about their evolutionary history. Inference methods can extract part of this information but they require sophisticated statistical techniques that have been made available to the biologist community (through computer programs) only for simple and standard situations typically involving a small number of samples. We propose here a computer program (<italic>DIY ABC</italic>) for inference based on approximate Bayesian computation (ABC), in which scenarios can be customized by the user to fit many complex situations involving any number of populations and samples. Such scenarios involve any combination of population divergences, admixtures and population size changes. <italic>DIY ABC</italic> can be used to compare competing scenarios, estimate parameters for one or more scenarios and compute bias and precision measures for a given scenario and known values of parameters (the current version applies to unlinked microsatellite data). This article describes key methods used in the program and provides its main features. The analysis of one simulated and one real dataset, both with complex evolutionary scenarios, illustrates the main possibilities of <italic>DIY ABC</italic>.</p><p><bold>Availability:</bold> The software <italic>DIY ABC</italic> is freely available at <ext-link ext-link-type="uri" xlink:href="http://www.montpellier.inra.fr/CBGP/diyabc">http://www.montpellier.inra.fr/CBGP/diyabc</ext-link>.</p><p><bold>Contact:</bold> <email>j.cornuet@imperial.ac.uk</email></p><p><bold>Supplementary information:</bold> Supplementary data are also available at <ext-link ext-link-type="uri" xlink:href="http://www.montpellier.inra.fr/CBGP/diyabc">http://www.montpellier.inra.fr/CBGP/diyabc</ext-link></p></abstract></article-meta></front><body><sec sec-type="intro" id="SEC1"><title>1 INTRODUCTION</title><p>Until now, most literature and software about inference in population genetics concern simple standard evolutionary scenarios: a single population (Beaumont, <xref ref-type="bibr" rid="B1">1999</xref>; Griffiths and Tavar&#x000e9;, <xref ref-type="bibr" rid="B16">1994</xref>; Stephens and Donnelly, <xref ref-type="bibr" rid="B30">2000</xref>), two populations exchanging genes (De Iorio and Griffiths, <xref ref-type="bibr" rid="B7">2004</xref>; Hey and Nielsen, <xref ref-type="bibr" rid="B18">2004</xref>) or not (Hickerson <italic>et al.</italic>, <xref ref-type="bibr" rid="B19">2007</xref>) or three populations in the classic admixture scheme (Excoffier <italic>et al.</italic>, <xref ref-type="bibr" rid="B13">2005</xref>; Wang, <xref ref-type="bibr" rid="B32">2003</xref>). The main exception to our knowledge is the computer program <italic>BATWING</italic> (Wilson <italic>et al.</italic>, <xref ref-type="bibr" rid="B35">2003</xref>) which considers a whole family of scenarios in which an ancestral population splits into as many subpopulations as needed. However, in practice, population geneticists collect and analyse samples which rarely correspond to one of these standard scenarios. If they want to apply methods developed in the literature and for which computer programs are available, they have to select subsets of samples (to fit these standard situations), at the price of lowering the power of the analysis. The other solution is to develop their own software, which requires specific skills or the right collaborators. Rare examples of inference in non-standard scenarios can be found in O'Ryan <italic>et al.</italic> (<xref ref-type="bibr" rid="B26">1998</xref>) including three populations and two successive divergences, or Estoup <italic>et al.</italic> (<xref ref-type="bibr" rid="B11">2004</xref>) (10 populations that sequentially diverged with initial bottlenecks and exchanging migrants with neighbouring populations).</p><p>Inference in complex evolutionary scenarios can be performed in various ways, but all are based on the genealogical tree of sampled genes and coalescence theory. A first approach used in programs such as <italic>IM</italic> (Hey and Nielsen, <xref ref-type="bibr" rid="B18">2004</xref>) or <italic>BATWING</italic> consists of starting from a gene genealogy compatible with the observed data and exploring the parameter and genealogy space through MCMC algorithms. One difficulty with this approach is to be sure that the MCMC has converged, because of the huge dimension of the parameter space. With a complex scenario, the difficulty is increased. Also, although not impossible, it seems quite challenging to write a program that would deal with very different scenarios. A second approach pioneered by Beaumont (<xref ref-type="bibr" rid="B2">2003</xref>) consists in combining MCMC exploration of the scenario parameter space with an importance sampling (IS)-based estimation of the likelihood. The strength of this approach is that the low number of parameters ensures a (relatively) fast convergence of the MCMC. Its weakness is that the likelihood is only approximated through IS, sometimes resulting in poor acceptance rates.</p><p>When dealing with complex situations, the two previous approaches raise difficulties which mainly stem in the computation of the likelihood. Consequently, a line of research including the works of Tavar&#x000e9; <italic>et al.</italic> (<xref ref-type="bibr" rid="B31">1997</xref>), Weiss and von Haeseler (<xref ref-type="bibr" rid="B34">1998</xref>), Pritchard <italic>et al.</italic> (<xref ref-type="bibr" rid="B28">1999</xref>) and Marjoram <italic>et al.</italic> (<xref ref-type="bibr" rid="B22">2003</xref>) developed a new approach termed approximate Bayesian computation (or ABC) by Beaumont <italic>et al.</italic> (<xref ref-type="bibr" rid="B4">2002</xref>). In this approach, the likelihood criterion is replaced by a similarity criterion between simulated and observed datasets, similarity usually measured by a distance between summary statistics computed on both datasets. Among examples of inference in complex scenarios given above, all but one (the simplest) have used this approach, showing that it can indeed solve complex problems.</p><p>The ABC approach presents two additional features that can be of interest for experimental biologist. One characteristic, already noted by Excoffier <italic>et al.</italic> (<xref ref-type="bibr" rid="B13">2005</xref>), is the possibility to assess the bias and precision of estimates for simulated datasets produced with known values of parameters with little extra computational cost. To get the same information with likelihood-based methods would require a huge amount of additional computation whereas, with ABC, the largest proportion of computation used for estimating parameters can be recycled in a bias/precision analysis. The second feature is the simple way by which the posterior probability of different scenarios applied to the same dataset can be estimated (e.g. Miller <italic>et al.</italic>, <xref ref-type="bibr" rid="B23">2005</xref>; Pascual <italic>et al.</italic>, <xref ref-type="bibr" rid="B27">2007</xref>).</p><p>In its current state, the ABC approach remains inaccessible to most biologists because there is not yet a simple software solution. Therefore, we developed the program <italic>DIYABC</italic> that performs ABC analyses on complex scenarios, i.e. which include any number of populations and samples (samples possibly taken at different times), with populations related by divergence and/or admixture events and possibly experiencing changes of population size. The current version is restricted to unlinked microsatellite data. In this article, we describe the rationale for some methods involved in the program. Then we give the main features of <italic>DIYABC</italic> and we provide two complete example analyses performed with this program to illustrate its possibilities.</p></sec><sec id="SEC2"><title>2 KEY METHODS INVOLVED IN <italic>DIY ABC</italic></title><p>Inference about the posterior distribution of parameters in an ABC analysis is usually performed in three steps (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn514/DC1">Figure S1 in Supplementary Material</ext-link>). The first one is a simulation step in which a very large table (the <italic>reference table</italic>) is produced and recorded. Each row corresponds to a simulated dataset and contains the parameter values used to simulate the dataset and summary statistics computed on the simulated dataset. Parameter values are drawn from prior distributions. Using these parameter values, genetic data are simulated as explained in the next section. The summary statistics correspond to those traditionally used by population geneticists to characterize the genetic diversity within and among samples (e.g. number of alleles, genic diversity and genetic distances). The idea is to extract maximum genetic information from the data, admitting that exhaustivity or sufficiency are generally out of reach. The simulation step is generally the most time-consuming step, since the number of simulated datasets can reach several millions. The second step is a rejection step. Euclidian distances between each simulated and the observed dataset in the space of summary statistics are computed and only the simulated data sets closest to the observed dataset are retained. The parameter values used to simulate these selected datasets provide a sample of parameter values approximately distributed according to their own posterior distribution. Beaumont <italic>et al.</italic> (<xref ref-type="bibr" rid="B4">2002</xref>) have shown that a local linear regression (third step&#x02009;=&#x02009;estimation step) provides a better approximation of the posterior distribution.</p><p>This synoptic of ABC is well established and we now concentrate on more specific issues that are implemented in <italic>DIYABC</italic>.</p><sec id="SEC2.1"><title>2.1 Simulating genetic data in complex scenarios</title><p>Thanks to coalescence theory, it has become easy to simulate datasets by a two-steps procedure. The first step consists of building a genealogical tree of sampled genes according to rather simple rules provided by coalescence theory (see below). The second step consists of attributing allelic states to all the nodes of the genealogy, starting from the common ancestor and simulating mutations according to the mutation model of the genetic markers. In a complex scenario, only the first step needs special attention and we will concentrate on it now.</p><p>In a single isolated population of constant effective size, the genealogical tree of a sample of genes is simulated backward in time: starting from the time of sampling, the gene lineages are merged (coalesced) at times that are drawn from an exponential distribution with rate <italic>j</italic>(<italic>j</italic>&#x02009;&#x02212;&#x02009;1)/4<italic>N</italic><sub><italic>e</italic></sub>, when there are <italic>j</italic> distinct lineages and the (diploid) effective population size is <italic>N</italic><sub><italic>e</italic></sub>. The genealogical tree is completed when there remains a single lineage.</p><p>Consider now two isolated populations (effective population sizes <italic>N</italic><sub>1</sub> and <italic>N</italic><sub>2</sub>, respectively) that diverged <italic>t</italic><sub><italic>d</italic></sub> generations before their common sampling time. Since the two populations do not exchange genes, lineages within each population will coalesce independently. Coalescence simulation will stop either when there remains a single lineage or when the simulated time is beyond the divergence (looking back in time). In the latter case, the coalescence event is simply discarded. At generation <italic>t</italic><sub><italic>d</italic></sub>, the remaining lineages are simply pooled and will coalesce in the ancestral population. Because of the memoryless property of the exponential distribution, the time to the first coalescence in the ancestral population is independent of the times of the last coalescence in each daughter population and can be simulated as in the single isolated population above. Again, the genealogical tree is completed when there remains a single lineage in the ancestral population. Note that the two populations need not be sampled at the same generation since this has no bearing on the simulation process.</p><p>Consider now the classic admixture scenario with one admixed and two parental populations, as in <xref ref-type="fig" rid="F1">Figure 1</xref> in Excoffier <italic>et al.</italic> (<xref ref-type="bibr" rid="B13">2005</xref>). Simulating the complete genealogical tree can be achieved with the following steps: (i) coalesce gene lineages in each population independently until reaching admixture time, (ii) distribute remaining lineages of the admixed population among the two parental populations, each with a Bernoulli draw with probability equal to the admixture rate, (iii) coalesce gene lineages in the two parental populations until reaching their divergence time, (iv) pool the remaining gene lineages of the two parental populations and place them into the ancestral population and (v) coalesce gene lineages in the ancestral population.<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>First example: the three evolutionary scenarios. The dataset used as an example has been simulated according to scenario 1 (left). The parameter values were the following: all populations had an effective (diploid) size of 1000, the times of successive events (backward in time) were <italic>t</italic><sub>1</sub>&#x02009;=&#x02009;10, <italic>t</italic><sub>2</sub>&#x02009;=&#x02009;500, <italic>t</italic><sub>3</sub>&#x02009;=&#x02009;10 000, <italic>t</italic><sub>4</sub>&#x02009;=&#x02009;20 000 and <italic>t</italic><sub>5</sub>&#x02009;=&#x02009;200 000, the two admixture rates were <italic>r</italic><sub>1</sub>&#x02009;=&#x02009;0.6 and <italic>r</italic><sub>2</sub>&#x02009;=&#x02009;0.4. Scenario 1 includes six populations, the four that have been sampled and two <italic>left</italic> parental populations in the admixture events. Scenario 2 and 3 include 5 and 4 populations, respectively. Samples 3 and 4 have been collected 2 and 4 generations earlier than the first two samples, hence their slightly upward locations on the graphs. Time is not at scale.</p></caption><graphic xlink:href="btn514f1"/></fig></p><p>We first note the modular form of this algorithm which involves only three modules:<list list-type="order"><list-item><p>a module that performs coalescences in an isolated constant size population between two given times,</p></list-item><list-item><p>a module that pools gene lineages from two populations (for divergence),</p></list-item><list-item><p>a module that splits gene lineages from the admixed population between two parental populations (for admixture).</p></list-item></list></p><p>We also note that the last two modules are quite simple and that the first one might be extended to include population size variations.</p><p>We have introduced a fourth module that proves useful in many instances. It performs the (simple) task of adding a gene sample to a population at a given generation. The interest of this module is to allow for multiple samples of the same population taken at different generations. By combining the aforementioned four modules, it is possible to simulate genetic data involving any number of populations according to a scenario that can include divergence, admixture events as well as population size variations. In addition, populations can be sampled more than once at different times. Compared with our previous definition of complex scenarios, the only restriction so far concerns the absence of migrations among populations. If migrations have to be taken into account, coalescences in two (or more) populations exchanging migrants are no longer independent and should be treated in the same module. Such a module would require to consider simultaneously two kind of events, coalescences of lineages within population and migrations of gene lineages from one population to another. In the current stage of <italic>DIYABC</italic>, this has not yet been achieved.</p></sec><sec id="SEC2.2"><title>2.2 Two ways of simulating coalescence events</title><p>Simulating coalescences can be performed in two ways. The most traditional way is based on the usually fulfilled assumption that the effective population size is large enough so that the probability of coalescence is small and hence that the probability that two or more coalescences occur at the same generation is low enough so that it can be neglected (e.g. Nordborg, <xref ref-type="bibr" rid="B25">2007</xref>). Time is then considered as a continuous variable in computations. The corresponding algorithm, called here the <italic>continuous time</italic> (CT) algorithm, consists in drawing first times between two successive coalescence events and then drawing two lineages at random at each coalescence event.</p><p>However, in practice, population size can be so small (e.g. during a bottleneck) that multiple coalescences at the same generation become common, including with the same parental gene (producing multifurcating trees). Simulating gene genealogies with multiple coalescences is possible, (e.g. Laval and Excoffier, <xref ref-type="bibr" rid="B21">2004</xref>). In effect, lineages are reconstructed one generation at a time: lineages existing at generation <italic>g</italic> are given a random number drawn in <italic>U</italic>[1,2<italic>N</italic><sub><italic>e</italic></sub>] and lineages with the same number coalesce together. The latter is termed here the <italic>generation by generation</italic> (GbG) algorithm.</p><p>The CT algorithm is much faster in most cases and is used in most softwares, but in some circumstances, the approximation becomes unacceptable. The solution taken in <italic>DIYABC</italic> is to swap between the two algorithms according to a criterion based on the effective population size, the time during which the effective size keeps its value, and the number of lineages at the start of the module. The criterion is such that the generation per generation (GbG) algorithm is taken whenever it is faster (this occurs when the effective size is very small) or when the CT algorithm overestimates by more than 5% on average the number of lineages at the end of the module.</p><p>A specific comparison study has been performed to establish this criterion. For different time periods counted in number of generations (<italic>g</italic>), effective population sizes (<italic>N</italic><sub><italic>e</italic></sub>) and number of entering lineages (<italic>n</italic><sub><italic>el</italic></sub>), coalescences have been simulated according to each algorithm 10 000 times and the average number of remaining lineages at the end of the period have been recorded as well as the average computation duration of each algorithm. Our results (Figure S2) show that the following rules optimize computation speed, while keeping the relative bias in coalescence rates under the 5% threshold:<list list-type="simple"><list-item><p>if (1&#x0003c;<italic>g</italic>&#x02264;30) do CT if <italic>n</italic><sub><italic>el</italic></sub>/<italic>N</italic><sub><italic>e</italic></sub>&#x0003c;0.0031<italic>g</italic><sup>2</sup>&#x02212;0.053<italic>g</italic>+0.7197 else do GbG</p></list-item><list-item><p>if (30&#x0003c;<italic>g</italic>&#x02264;100) do CT if <italic>n</italic><sub><italic>el</italic></sub>/<italic>N</italic><sub><italic>e</italic></sub>&#x0003c;0.033<italic>g</italic>+1.7 else do GbG</p></list-item><list-item><p>if (100&#x0003c;<italic>g</italic>) do CT if <italic>n</italic><sub><italic>el</italic></sub>/<italic>N</italic><sub><italic>e</italic></sub>&#x0003c;5 else do GbG</p></list-item></list></p></sec><sec id="SEC2.3"><title>2.3 Comparing scenarios</title><p>Using ABC to compare different scenarios and infer their posterior probability has been performed in two ways in the literature. Starting with a reference table containing parameters and summary statistics obtained with the different scenarios to be compared (or pooling reference tables, each obtained with a given scenario), datasets are ordered by increasing distance to the observed dataset. A first method (termed hereafter the <italic>direct</italic> approach) is to take as an estimate of the posterior probability of a scenario the proportion of datasets obtained with this scenario in the <italic>n</italic><sub>&#x003b4;</sub> closest datasets (Miller <italic>et al.</italic>, <xref ref-type="bibr" rid="B23">2005</xref>; Pascual <italic>et al.</italic>, <xref ref-type="bibr" rid="B27">2007</xref>). The value of <italic>n</italic><sub>&#x003b4;</sub> is arbitrary and unless the results are quite clear cut, the estimated posterior probability may vary with <italic>n</italic><sub>&#x003b4;</sub>.</p><p>Following the same rationale that introduced the local linear regression in the estimation of posterior distributions for parameters (Beaumont <italic>et al.</italic>, <xref ref-type="bibr" rid="B4">2002</xref>), we perform a weighted polychotomous logistic regression to estimate the posterior probability of scenarios, termed hereafter the <italic>logistic</italic> approach (see also Beaumont, <xref ref-type="bibr" rid="B3">2008</xref>; Fagundes <italic>et al.</italic>, <xref ref-type="bibr" rid="B14">2007</xref>). In the estimation of parameters, a linear regression is performed with dependent variable the parameter and predictors the differences between the observed and simulated statistics. This linear regression is local at the point (in the predictor space) corresponding to the observed dataset, using an Epanechnikov kernel based on the distance between observed and simulated summary statistics [see formula (5) in Beaumont <italic>et al.</italic>, <xref ref-type="bibr" rid="B4">2002</xref>]. Parameters values are then replaced by their estimates at that point in the regression.</p><p>Keeping the differences between observed and simulated statistics as the predictor variables in the regression, we consider now the posterior probability of scenarios as the dependent variable. Because of the nature of the &#x02018;parameter&#x02019;, an indicator of the scenario number, a <italic>logit</italic> link function is applied to the regression. The local aspect of the regression is obtained by taking the same weights as in the linear adjustment of parameter values as described in Beaumont <italic>et al.</italic> (<xref ref-type="bibr" rid="B4">2002</xref>). Confidence intervals for the posterior probabilities of scenarios are computed through the limiting distribution of the maximum likelihood estimators. See <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn514/DC1">Annex 1 in Supplementary Material</ext-link> for a detailed explanation.</p></sec><sec id="SEC2.4"><title>2.4 Quantifying confidence in parameter estimations on simulated test datasets</title><p>In order to measure bias and precision, we need to simulate datasets (i.e. test datasets) with known values of parameters and compare estimates with their true values. In the ABC estimation procedure, the most time-consuming task is to produce a large enough reference table. However, when such a reference table has been produced, e.g. for the analysis of a real dataset, it can also be used to quantify bias and precision on test datasets as well.</p><p>Measuring bias is straightforward, but precision can be assessed with different measures. In <italic>DIYABC</italic>, the latter include the relative square root of the mean square error, the relative square root of the mean integrated square error, the relative mean absolute deviation, the 95% and 50% coverages and the factor 2. See <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn514/DC1">Annex 2 in Supplementary Material</ext-link> for more details.</p></sec></sec><sec id="SEC3"><title>3 <italic>DIY ABC</italic>: A COMPUTER PROGRAM FOR POPULATION BIOLOGISTS</title><sec id="SEC3.1"><title>3.1 Main features</title><p><italic>DIYABC</italic> is a program that performs ABC inference on population genetic data. In its current state, the data are genotypes at microsatellite loci of samples of diploid individuals (missing data are allowed). The inference bears on the evolutionary history of the sampled populations by quantifying the relative support of data to possible scenarios and by estimating posterior densities of associated parameters. <italic>DIYABC</italic> is a program written in Delphi running under a 32-bit Windows operating system (e.g. Windows XP) and it has a user-friendly graphical interface.</p><p>The program accepts complex evolutionary scenarios involving any number of populations and samples. Scenarios can include any number of the following timed events: stepwise change of effective population size, population divergence and admixture. They can also include unsampled as well as serially sampled populations as in Beaumont (<xref ref-type="bibr" rid="B2">2003</xref>). The main restriction regarding scenario complexity is the absence of migrations between populations.</p><p>Since the program has been written for microsatellite data, it proposes two mutation models, namely the stepwise mutation model (SMM) and the generalized stepwise mutation (GSM) model (Estoup <italic>et al.</italic>, <xref ref-type="bibr" rid="B9">2002</xref>). Note that the same mutation model has to be applied to all microsatellite loci, but these may have different values of mutation parameters.</p><p>The historico-demographic parameters of scenarios may be of three types: effective sizes, times of events (in generations) and admixture rates. Marker parameters are mutation rates and the coefficient of the geometric distribution (under the GSM only). The program can also estimate composite parameters, such as &#x003b8;&#x02009;=&#x02009;4<italic>N</italic><sub><italic>e</italic></sub>&#x003bc; and &#x003c4;&#x02009;=&#x02009;<italic>t</italic>&#x003bc;, with <italic>N</italic><sub><italic>e</italic></sub> being the diploid effective population size, <italic>t</italic> the time of an event and &#x003bc; the mean mutation rate. Prior distributions are defined for original parameters and those for composite parameters are obtained via an assumption of independence of their component prior densities. Priors for historico-demographic parameters can be chosen among four common distributions: Uniform, Log-uniform, Normal and Log-normal. Users can set minimum and maximum (for all distributions) and mean and SD (for Normal and Log-normal). In addition, priors can be modified by setting binary conditions (&#x0003e;, &#x0003c;, &#x02265; and &#x02264;) on pairs of parameters of the same category (two effectives sizes or two times of event). This is especially useful to control the relative times of events when these are parameters of the scenario. For priors of mutation parameters, only the Uniform and the Gamma distributions are considered, but hierarchical schemes are possible, with a mean mutation rate or coefficient P (of the geometric distribution in the GSM) drawn from a given prior and individual loci parameter values drawn from a gamma distribution around the mean.</p><p>Available summary statistics are usual population genetic statistics averaged over loci: e.g. mean number of alleles, mean genic diversity, <italic>F</italic>st, (&#x003b4;&#x003bc;)<sup>2</sup>, admixture rates, etc.</p><p>Regarding ABC computations, the program can (i) create a reference table or append values to an existing table, (ii) compute the posterior probability of different scenarios, (iii) estimate the posterior distributions of original and/or composite parameters for one or more scenarios and (iv) compute bias and precision for a given scenario and given values of parameters. Finally, the program can be used simply to simulate datasets in the popular <italic>Genepop</italic> format (Raymond and Rousset, <xref ref-type="bibr" rid="B29">1995</xref>).</p></sec><sec id="SEC3.2"><title>3.2 Two examples of analysis with <italic>DIY ABC</italic></title><sec id="SEC3.2.1"><title>3.2.1 Illustration on a simulated dataset</title><p>In order to illustrate the capabilities of <italic>DIYABC</italic>, we take first an example based on a dataset simulated according to a complex scenario including three splits and two admixture events (scenario 1 in <xref ref-type="fig" rid="F1">Figure 1</xref>). The scenario includes six populations: two of them have been sampled at time 0, the third one at time 2 and the fourth one at time 4, the last two have not been sampled. Each population sample includes 30 diploid individuals and data are simulated at 10 microsatellite loci. This scenario is not purely theoretical as it could be applied for instance to European populations of honeybees in which the Italian populations (<italic>Apis mellifera ligustica</italic>) result from an ancient admixture between two evolutionary branches (Franck <italic>et al.</italic>, <xref ref-type="bibr" rid="B12">2000</xref>) that would correspond here to population samples 1 and 4. Furthermore, in the last 50 years, Italian bees have been widely exported and sample 2 could well correspond to a population of a parental branch that has been recently introgressed by Italian queens. This example also stresses the ability of <italic>DIYABC</italic> to distinguish two events that are confounded in the usual admixture scheme: the admixture event itself and the time at which the real parental populations in the admixture diverged from the population taken as &#x02018;parental&#x02019;.</p><p>Our ABC analysis will address the following questions: (i) Suppose that we are not sure that the scenario having produced our example dataset does include a double admixture and that we want to challenge this double admixture scenario with two simpler scenarios, one with a single admixture (scenario 2 in <xref ref-type="fig" rid="F1">Figure 1</xref>) and the other with no admixture at all (scenario 3). The questions addressed are: (i) What is the posterior probability of these three scenarios, given identical prior probabilities ? (ii) What are the posterior distributions of parameters, given that the right scenario is known ? and (iii) What confidence can we have in the posterior probabilities of scenarios and posterior distributions of parameters?</p><p>First, a reference table is built up. Using different screens of <italic>DIYABC</italic>, (i) the three scenarios are coded and prior distributions of parameters are defined (Figure S3), (ii) based on previous studies (e.g. Dib <italic>et al.</italic>, <xref ref-type="bibr" rid="B8">1996</xref>), the GSM model is selected and prior distributions of mutation parameters are defined (Figure S4), (iii) motif sizes and allele ranges of loci are set (Figure S5) and (iv) summary statistics are selected (Figure S6). After some hours, a reference table with 6 million simulated datasets (i.e. 2 million per scenario) is produced.</p><p>To answer the first question, the <italic>n</italic><sub>&#x003b4;</sub>&#x02009;=&#x02009;60 000 (1%) simulated datasets closest to the pseudo-observed dataset are selected for the logistic regression and <italic>n</italic><sub>&#x003b4;</sub>&#x02009;=&#x02009;600 (0.01%) for the direct approach. The answer appears in two graphs (upper row in Figure S7). Both approaches are congruent and show that scenario 1 is significantly better supported by data than any other scenarios.</p><p>To answer the second question, scenario 1 is chosen and posterior distributions of parameters are estimated taking the 20 000 (1%) closest simulated datasets, after applying a <italic>logit</italic> transformation of parameter values. Here again, the output is mostly graphical. Each graph provides the prior and posterior distributions of the corresponding parameter (Figure S8). Below each graph are given the mean, median and mode as well as four quantiles (0.025, 0.05, 0.95 and 0.975) of the posterior distribution (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btn514/DC1">Table S1 in Supplementary Material</ext-link>). Since the true values are known, we can remark that some parameters are rather well estimated with peaked posteriors such as the common effective population size and the two admixture rates, whilst other including all time parameters suggest that data are not very informative for them. Very similar results (data not shown) have been obtained with 5000 and 40 000 simulated datasets selected for the local linear regression, as well as when using a smaller reference table (1 million datasets).</p><p>To evaluate the confidence that can be put into the posterior probability of scenarios, 500 test datasets were simulated with each scenario and known parameter values (i.e. the same values as those used to produce the original dataset). Posterior probabilities of the three scenarios were estimated as above and used to compute type I and II errors in the choice of scenario. Results show that scenario 3 is always rightly chosen or excluded. Consequently type I error for scenario 1 is identical to type II error for scenario 2 and vice versa. For scenario 1, type I errors amount to 0.414 and 0.3 for the direct approach and the logistic regression, respectively, whereas type II errors amount to 0.014 and 0.020 (cf. Fig S9, S10 and S11 for detailed distributions of scenario probabilities). The 500 test datasets simulated with scenario 1 have also been used to estimate posterior distributions of parameters, taking the same proportion (1%) of closest simulated datasets as above. Relative biases and dispersion measures are given in Table S2 (upper part). It is clear that several parameters are biased and/or dispersed, the worst case being that of parameter <italic>t</italic><sub>1</sub>. The bias is undoubtedly related to the lack of information in the data, so that point estimates are drawn towards the mean values of prior distributions. The effect of prior distribution is also illustrated in the lower part of Table S2 that provides the same measures, but obtained with different prior distributions for effective size and time of event parameters.</p></sec><sec id="SEC3.2.2"><title>3.2.2 Illustration on a real dataset</title><p>Our second example concerns populations of the Silvereye, <italic>Zosterops lateralis lateralis</italic> (Estoup and Clegg, <xref ref-type="bibr" rid="B10">2003</xref>). During the 19th and 20th century, this bird colonized Southwest Pacific islands from Tasmania. The importance of serial founder events in the microevolution of this species has been questioned in a study based on a six microsatellite loci dataset (Clegg <italic>et al</italic>, <xref ref-type="bibr" rid="B6">2002</xref>).</p><p>Our analysis with <italic>DIYABC</italic> differs by at least four aspects from the initial ABC analysis processed from the same dataset by Estoup and Clegg (<xref ref-type="bibr" rid="B10">2003</xref>). First, all island populations are treated here in the same analysis whereas, for tractability reasons, independent analyses were made using all pairs of populations. Second, the initial treatment was based on the algorithm of Pritchard <italic>et al.</italic> (<xref ref-type="bibr" rid="B28">1999</xref>), whereas <italic>DIYABC</italic> uses the local linear regression method of Beaumont <italic>et al.</italic> (<xref ref-type="bibr" rid="B4">2002</xref>), which allows a larger number of statistics (see below) and hence makes a better use of data. Third, we have chosen here non-informative flat priors for all demographic parameters. Fourth, because <italic>DIYABC</italic> is able to treat samples collected at different times, we did not have to pool samples collected at different years from the same island and average sample year collection over islands. We hence end up with a colonization scenario involving five populations and seven samples, two samples having been collected at different times in two different islands (<xref ref-type="fig" rid="F2">Fig. 2</xref>). The sequence and dates of colonization by silvereyes to New Zealand (South and North Island) and Chatham and Norfolk Islands have been historically documented. This allows the times for the putative population size fluctuation events in the coalescent gene trees to be fixed, thus limiting the number of parameters. Our scenario was specified by six unknown demographic parameters: the stable effective population size (<italic>N</italic><sub><italic>S</italic></sub>) and the duration of the initial bottleneck (<italic>D</italic><sub><italic>B</italic></sub>), both assumed to be the same in all Islands and potentially different effective number of founders in Norfolk, Chatham and South and North Island of New Zealand (<italic>N</italic><sub><italic>F</italic>1</sub>, <italic>N</italic><sub><italic>F</italic>2</sub>, <italic>N</italic><sub><italic>F</italic>3</sub> and <italic>N</italic><sub><italic>F</italic>4</sub>, respectively). As in Estoup and Clegg (<xref ref-type="bibr" rid="B10">2003</xref>), we also assumed that all populations evolved as totally isolated demes after the date of colonization.<fig id="F2" position="float"><label>Fig. 2.</label><caption><p>Second example: screenshot of the scenario used in the analysis of the <italic>Z. lateralis lateralis</italic> dataset. In 1830, <italic>Z. l. lateralis</italic> colonized the South Island of New Zealand (Pop 2) from Tasmania (Pop 1). In the following years, the population began expanding and dispersing, and reached the North Island by 1856 (Pop 3). Chatham Island (Pop 4) was colonized in 1856 from the South Island, and Norfolk Island (Pop 5) was colonized in 1904 from the North Island (historical information reviewed in Estoup and Clegg <xref ref-type="bibr" rid="B10">2003</xref>). Sample collection times are 1997 for Tasmania (<italic>Sa</italic> 1), South and North Island of New Zealand (<italic>Sa</italic> 2 and <italic>Sa</italic> 3, respectively), Chatham Island (<italic>Sa</italic> 4) and Norfolk Island (<italic>Sa</italic> 5), 1994 for the second sample from Norfolk (<italic>Sa</italic> 6), and 1992 for the second sample from the North Island of New Zealand (<italic>Sa</italic> 7). Splitting events and sampling dates in years were translated in number of generations since the most recent sampling date by assuming a generation time of 3 years (Estoup and Clegg, <xref ref-type="bibr" rid="B10">2003</xref>). We hence fixed t1, t2, t3 and t4 to 31, 47, 47 and 56 generations, respectively.</p></caption><graphic xlink:href="btn514f2"/></fig></p><p>We chose uniform priors <italic>U</italic>[300, 30 000] for <italic>N</italic><sub><italic>S</italic></sub>, <italic>U</italic>[2, 500] for all <italic>N</italic><sub><italic>Fi</italic></sub> and <italic>U</italic>[1, 5] for <italic>D</italic><sub><italic>B</italic></sub>. Prior information regarding the mutation rate and model for microsatellites was the same as in the previous example. Summary statistics included the mean number of alleles, the mean genic diversity (Nei, <xref ref-type="bibr" rid="B24">1987</xref>), the mean coefficient <italic>M</italic> (Garza and Williamson, <xref ref-type="bibr" rid="B15">2001</xref>), <italic>F</italic>st between pairs of population samples (Weir and Cockerham, <xref ref-type="bibr" rid="B33">1984</xref>), and the <italic>mean classification index</italic>, also called <italic>mean individual assignment likelihood</italic> (Pascual <italic>et al.</italic>, <xref ref-type="bibr" rid="B27">2007</xref>). We produced a reference table with 1 million simulated datasets and estimated parameter posterior distributions taking the 10 000 (1%) simulated datasets closest to the observed dataset for the local linear regression, after applying a <italic>logit</italic> transformation to parameter values. Similar results were obtained when taking the 2000 to 20 000 closest simulated datasets and when using a log or log-tangent transformation of parameters as proposed in Estoup <italic>et al.</italic> (<xref ref-type="bibr" rid="B11">2004</xref>) and Hamilton <italic>et al.</italic> (<xref ref-type="bibr" rid="B17">2005</xref>) (options available in <italic>DIYABC</italic>).</p><p>Results for the main demographic parameters are presented in <xref ref-type="table" rid="T1">Table 1</xref>. They indicate the colonization by a small number of founders and/or a slow demographic recovery after foundation for Norfolk island only (median <italic>N</italic><sub><italic>F</italic>1</sub> value of 18 individuals). Other island populations appear to have been founded by silvereye flocks of larger size and/or have recovered quickly after foundation. In agreement with this, the bottleneck severity (computed as <italic>BS</italic><sub><italic>i</italic></sub>&#x02009;=&#x02009;<italic>D</italic><sub><italic>B</italic></sub>&#x02009;&#x000d7;&#x02009;<italic>N</italic><sub><italic>S</italic></sub>/<italic>N</italic><sub><italic>Fi</italic></sub>) was more than one order of magnitude larger for the population from Norfolk than for other island populations (<xref ref-type="fig" rid="F3">Fig. 3</xref>). These results are in the same vein as those obtained by Estoup and Clegg (<xref ref-type="bibr" rid="B10">2003</xref>) and agree with their main conclusions. Discrepancies in parameter estimation are observed however (e.g. larger <italic>N</italic><sub><italic>S</italic></sub> values and more precise inferences for <italic>N</italic><sub><italic>F</italic>2</sub>, <italic>N</italic><sub><italic>F</italic>3</sub> and <italic>N</italic><sub><italic>F</italic>4</sub> in the present treatment). This was expected due to the differences in the methodological design underlined above. With the possibility of treating all population samples together, <italic>DIYABC</italic> allows a more elaborate and satisfactory treatment compared with previous analyses (Estoup and Clegg <xref ref-type="bibr" rid="B10">2003</xref>; Miller <italic>et al.</italic>, <xref ref-type="bibr" rid="B23">2005</xref>).<table-wrap id="T1" position="float"><label>Table 1.</label><caption><p>Second example: mean, median, mode, quantiles and SD of posterior distribution samples for effective population sizes (original parameters) for the <italic>Z.lateralis lateralis</italic> dataset.</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Parameter</th><th rowspan="1" colspan="1">mean</th><th rowspan="1" colspan="1">median</th><th rowspan="1" colspan="1">mode</th><th rowspan="1" colspan="1"><italic>Q</italic><sub>0.050</sub></th><th rowspan="1" colspan="1"><italic>Q</italic><sub>0.950</sub></th><th rowspan="1" colspan="1">SD</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1"><italic>N</italic><sub><italic>S</italic></sub></td><td rowspan="1" colspan="1">9399</td><td rowspan="1" colspan="1">7446</td><td rowspan="1" colspan="1">4107</td><td rowspan="1" colspan="1">2706</td><td rowspan="1" colspan="1">23 007</td><td rowspan="1" colspan="1">6273</td></tr><tr><td rowspan="1" colspan="1"><italic>N</italic><sub><italic>F</italic>1</sub></td><td rowspan="1" colspan="1">19</td><td rowspan="1" colspan="1">18</td><td rowspan="1" colspan="1">16</td><td rowspan="1" colspan="1">9</td><td rowspan="1" colspan="1">33</td><td rowspan="1" colspan="1">8.7</td></tr><tr><td rowspan="1" colspan="1"><italic>N</italic><sub><italic>F</italic>2</sub></td><td rowspan="1" colspan="1">202</td><td rowspan="1" colspan="1">173</td><td rowspan="1" colspan="1">108</td><td rowspan="1" colspan="1">55</td><td rowspan="1" colspan="1">435</td><td rowspan="1" colspan="1">118</td></tr><tr><td rowspan="1" colspan="1"><italic>N</italic><sub><italic>F</italic>3</sub></td><td rowspan="1" colspan="1">197</td><td rowspan="1" colspan="1">168</td><td rowspan="1" colspan="1">112</td><td rowspan="1" colspan="1">55</td><td rowspan="1" colspan="1">430</td><td rowspan="1" colspan="1">116</td></tr><tr><td rowspan="1" colspan="1"><italic>N</italic><sub><italic>F</italic>4</sub></td><td rowspan="1" colspan="1">293</td><td rowspan="1" colspan="1">288</td><td rowspan="1" colspan="1">278</td><td rowspan="1" colspan="1">129</td><td rowspan="1" colspan="1">470</td><td rowspan="1" colspan="1">105</td></tr></tbody></table></table-wrap><fig id="F3" position="float"><label>Fig. 3.</label><caption><p>Second example: posterior distributions of the bottleneck severity (see definition in text) for the invasions of four Pacific Islands by <italic>Z.lateralis lateralis</italic>. The four discontinuous lines with small dashes, dots, dash-dots and long dashes correspond to Norfolk, Chatham, North Island and South Island of New Zealand, respectively. The continuous line corresponds to the prior distribution, which is identical for each island. This graph has been made with the <italic>locfit</italic> function of the R statistical package (Ihaka and Gentleman, <xref ref-type="bibr" rid="B20">1996</xref>), using an option of <italic>DIYABC</italic> which saves the sample of the parameter values adjusted by the local linear regression (Beaumont <italic>et al.</italic>, <xref ref-type="bibr" rid="B4">2002</xref>).</p></caption><graphic xlink:href="btn514f3"/></fig></p></sec></sec></sec><sec sec-type="conclusions" id="SEC4"><title>4 CONCLUSIONS</title><p>So far, the ABC approach has remained inaccessible to most biologists because of the complex computations involved. With <italic>DIYABC</italic>, non-specialists can now perform ABC-based inference on various and complex population evolutionary scenarios, without reducing them to simple standard situations, and hence making a better use of their data. In addition, this programs also allows them to compare competing scenarios and quantify their relative support by the data. Eventually, it provides a way to evaluate the amount of confidence that can be put into the various estimations. The main limitations of the current version of <italic>DIYABC</italic> are the assumed absence of migration among populations after they have diverged and the mutation models which mostly refer to microsatellite loci. Next developments will aim at progressively removing these limitations.</p></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material id="PMC_1" content-type="local-data"><caption><title>[Supplementary Data]</title></caption><media mimetype="text" mime-subtype="html" xlink:href="btn514_index.html"/><media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="btn514_1.pdf"/></supplementary-material></sec></body><back><ack><title>ACKNOWLEDGEMENTS</title><p>We are most grateful to Sonya Clegg for authorizing the use of Silvereye microsatellite data in our second example.</p><p><italic>Funding</italic>: The development of <italic>DIYABC</italic> has been supported by a grant from the French Research National Agency (project <italic>MISGEPOP</italic>) and an EU grant awarded to JMC as an EIF Marie-Curie Fellowship (project <italic>StatInfPopGen</italic>) that allowed him to spend two years in D.J.B.'s Epidemiology and Public Health department at Imperial College (London, UK) where he wrote a major part of this program.</p><p><italic>Conflict of Interest</italic>: none declared.</p></ack><ref-list><title>REFERENCES</title><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Beaumont</surname><given-names>MA</given-names></name></person-group><article-title>Detecting population expansion and decline using microsatellites</article-title><source>Genetics</source><year>1999</year><volume>153</volume><fpage>2013</fpage><lpage>2029</lpage><pub-id pub-id-type="pmid">10581303</pub-id></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Beaumont</surname><given-names>MA</given-names></name></person-group><article-title>Estimation of population growth or decline in genetically monitored populations</article-title><source>Genetics</source><year>2003</year><volume>164</volume><fpage>1139</fpage><lpage>1160</lpage><pub-id pub-id-type="pmid">12871921</pub-id></citation></ref><ref id="B3"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Beaumont</surname><given-names>MA</given-names></name></person-group><person-group person-group-type="editor"><name><surname>Matsumura</surname><given-names>S</given-names></name><name><surname>Forster</surname><given-names>P</given-names></name><name><surname>Renfrew</surname><given-names>C</given-names></name></person-group><article-title>Joint determination of topology, divergence time and immigration in population trees</article-title><source>Simulations, Genetics and Human Prehistory</source><year>2008</year><publisher-loc>Cambridge</publisher-loc><publisher-name>(McDonald Institute Monographs), McDonald Institute for Archaeological Research</publisher-name><fpage>134</fpage><lpage>154</lpage></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Beaumont</surname><given-names>MA</given-names></name><etal/></person-group><article-title>Approximate Bayesian computation in Population Genetics</article-title><source>Genetics</source><year>2002</year><volume>162</volume><fpage>2025</fpage><lpage>2035</lpage><pub-id pub-id-type="pmid">12524368</pub-id></citation></ref><ref id="B5"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Bertorelle</surname><given-names>G</given-names></name><name><surname>Excoffier</surname><given-names>L</given-names></name></person-group><article-title>Inferring admixture proportion from molecular data</article-title><source>Mol. Biol. Evol.</source><year>1998</year><volume>15</volume><fpage>1298</fpage><lpage>1311</lpage><pub-id pub-id-type="pmid">9787436</pub-id></citation></ref><ref id="B6"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Clegg</surname><given-names>SM</given-names></name><etal/></person-group><article-title>Genetic consequences of sequential founder events by an island colonising bird</article-title><source>Proc. Natl Acad. Sci.</source><year>2002</year><volume>99</volume><fpage>8127</fpage><lpage>8132</lpage><pub-id pub-id-type="pmid">12034870</pub-id></citation></ref><ref id="B7"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>De Iorio</surname><given-names>M</given-names></name><name><surname>Griffiths</surname><given-names>RC</given-names></name></person-group><article-title>Importance sampling on coalescence histories. ii: subdivided population models</article-title><source>Adv. Appl. Probab.</source><year>2004</year><volume>36</volume><fpage>434</fpage><lpage>454</lpage></citation></ref><ref id="B8"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Dib</surname><given-names>C</given-names></name><etal/></person-group><article-title>A comprehensive genetic map of the human genome based on 5,264 microsatellites</article-title><source>Nature</source><year>1996</year><volume>380</volume><fpage>152</fpage><lpage>154</lpage><pub-id pub-id-type="pmid">8600387</pub-id></citation></ref><ref id="B9"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Estoup</surname><given-names>A</given-names></name><etal/></person-group><article-title>Homoplasy and mutation model at microsatellite loci and their consequences for population genetics analysis</article-title><source>Mol. Ecol.</source><year>2002</year><volume>11</volume><fpage>1591</fpage><lpage>1604</lpage><pub-id pub-id-type="pmid">12207711</pub-id></citation></ref><ref id="B10"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Estoup</surname><given-names>A</given-names></name><name><surname>Clegg</surname><given-names>SM</given-names></name></person-group><article-title>Bayesian inferences on the recent island colonization history by the bird</article-title><source>Zosterops lateralis lateralis. Mol. Ecol.</source><year>2003</year><volume>12</volume><fpage>657</fpage><lpage>674</lpage></citation></ref><ref id="B11"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Estoup</surname><given-names>A</given-names></name><etal/></person-group><article-title>Genetic analysis of complex demographic scenarios: spatially expanding populations of the cane toad</article-title><source>Bufo marinus. Evolution</source><year>2004</year><volume>58</volume><fpage>2021</fpage><lpage>2036</lpage></citation></ref><ref id="B12"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Franck</surname><given-names>P</given-names></name><etal/></person-group><article-title>Hybrid origins of honeybees from Italy (<italic>Apis mellifera ligustica</italic>) and Sicily (<italic>A. m. sicula</italic>)</article-title><source>Mol. Ecol.</source><year>2000</year><volume>9</volume><fpage>907</fpage><lpage>992</lpage><pub-id pub-id-type="pmid">10886654</pub-id></citation></ref><ref id="B13"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Excoffier</surname><given-names>L</given-names></name><etal/></person-group><article-title>Bayesian analysis of an admixture model with mutations and arbitrarily linked markers</article-title><source>Genetics</source><year>2005</year><volume>169</volume><fpage>1727</fpage><lpage>1738</lpage><pub-id pub-id-type="pmid">15654099</pub-id></citation></ref><ref id="B14"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Fagundes</surname><given-names>N.JR</given-names></name><etal/></person-group><article-title>Statistical evaluation of alternative models of human evolution</article-title><source>Proc. Natl Acad. Sci.</source><year>2007</year><volume>104</volume><fpage>17614</fpage><lpage>17619</lpage><pub-id pub-id-type="pmid">17978179</pub-id></citation></ref><ref id="B15"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Garza</surname><given-names>JC</given-names></name><name><surname>Williamson</surname><given-names>E</given-names></name></person-group><article-title>Detection of reduction in population size using data from microsatellite DNA</article-title><source>Mol. Ecol.</source><year>2001</year><volume>10</volume><fpage>305</fpage><lpage>318</lpage><pub-id pub-id-type="pmid">11298947</pub-id></citation></ref><ref id="B16"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Griffiths</surname><given-names>RC</given-names></name><name><surname>Tavar&#x000e9;</surname><given-names>S</given-names></name></person-group><article-title>Simulating probability distributions in the coalescent</article-title><source>Theor. Popul. Biol.</source><year>1994</year><volume>46</volume><fpage>131</fpage><lpage>159</lpage></citation></ref><ref id="B17"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hamilton</surname><given-names>G</given-names></name><etal/></person-group><article-title>Molecular analysis reveals tighter social regulation of immigration in patrilocal populations than in matrilocal populations</article-title><source>Proc. Natl Acad. Sci. USA</source><year>2005</year><volume>102</volume><fpage>7476</fpage><lpage>7480</lpage><pub-id pub-id-type="pmid">15894624</pub-id></citation></ref><ref id="B18"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hey</surname><given-names>J</given-names></name><name><surname>Nielsen</surname><given-names>R</given-names></name></person-group><article-title>Multilocus methods for estimating population sizes, migration rates and divergence time, with applications to the divergence of<italic>Drosophila pseudoobscura</italic>and<italic>D. persimilis</italic></article-title><source>Genetics</source><year>2004</year><volume>167</volume><fpage>747</fpage><lpage>760</lpage><pub-id pub-id-type="pmid">15238526</pub-id></citation></ref><ref id="B19"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hickerson</surname><given-names>MJ</given-names></name><etal/></person-group><article-title>msBayes: Pipeline for testing comparative phylogeographic histories using hierarchical approximate Bayesian computation</article-title><source>BMC Bioinformatics</source><year>2007</year><volume>8</volume><fpage>268</fpage><lpage>274</lpage><pub-id pub-id-type="pmid">17655753</pub-id></citation></ref><ref id="B20"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ihaka</surname><given-names>R</given-names></name><name><surname>Gentleman</surname><given-names>R</given-names></name></person-group><article-title><italic>R</italic>: a language for data analysis and graphics</article-title><source>J. Comput. Graph. Stat.</source><year>1996</year><volume>5</volume><fpage>299</fpage><lpage>314</lpage></citation></ref><ref id="B21"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Laval</surname><given-names>G</given-names></name><name><surname>Excoffier</surname><given-names>L</given-names></name></person-group><article-title>SIMCOAL 2.0: a program to simulate genomic diversity over large recombining regions in a subdivided population with a complex history</article-title><source>Bioinformatics</source><year>2004</year><volume>20</volume><fpage>2485</fpage><lpage>2487</lpage><pub-id pub-id-type="pmid">15117750</pub-id></citation></ref><ref id="B22"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Marjoram</surname><given-names>P</given-names></name><etal/></person-group><article-title>Markov chain Monte Carlo without likelihood</article-title><source>Proc. Natl Acad. Sci.</source><year>2003</year><volume>100</volume><fpage>15324</fpage><lpage>15328</lpage><pub-id pub-id-type="pmid">14663152</pub-id></citation></ref><ref id="B23"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Miller</surname><given-names>N</given-names></name><etal/></person-group><article-title>Multiple transatlantic introductions of the western corn rootworm</article-title><source>Science</source><year>2005</year><volume>310</volume><fpage>992</fpage><pub-id pub-id-type="pmid">16284172</pub-id></citation></ref><ref id="B24"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Nei</surname><given-names>M</given-names></name></person-group><source>Molecular Evolutionary Genetics</source><year>1987</year><publisher-loc>New York</publisher-loc><publisher-name>Columbia University Press</publisher-name><fpage>512</fpage></citation></ref><ref id="B25"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Nordborg</surname><given-names>M</given-names></name></person-group><person-group person-group-type="editor"><name><surname>Balding</surname><given-names>DJ</given-names></name><etal/></person-group><article-title>Coalescent theory</article-title><source>Handbook of Statistical Genetics</source><year>2007</year><edition>3rd</edition><publisher-loc>Chichester, UK</publisher-loc><publisher-name>Wiley &#x00026; Sons</publisher-name><fpage>843</fpage><lpage>877</lpage></citation></ref><ref id="B26"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>O'Ryan</surname><given-names>C</given-names></name><etal/></person-group><article-title>Genetics of fragmented populations of African buffalo (<italic>Syncerus caffer</italic>) in South Africa</article-title><source>Anim. Conserv.</source><year>1998</year><volume>1</volume><fpage>85</fpage><lpage>94</lpage></citation></ref><ref id="B27"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Pascual</surname><given-names>M</given-names></name><etal/></person-group><article-title>Introduction history of<italic>Drosophila subobscura</italic>in the New World: a microsatellite based survey using ABC methods</article-title><source>Mol. Ecol.</source><year>2007</year><volume>16</volume><fpage>3069</fpage><lpage>3083</lpage><pub-id pub-id-type="pmid">17651188</pub-id></citation></ref><ref id="B28"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Pritchard</surname><given-names>J</given-names></name><etal/></person-group><article-title>Population growth of human Y chromosomes: a study of Y chromosome microsatellites</article-title><source>Mol. Biol. Evol.</source><year>1999</year><volume>16</volume><fpage>1791</fpage><lpage>1798</lpage><pub-id pub-id-type="pmid">10605120</pub-id></citation></ref><ref id="B29"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Raymond</surname><given-names>M</given-names></name><name><surname>Rousset</surname><given-names>F</given-names></name></person-group><article-title>Genepop (version 1.2), population genetics software for exact tests and ecumenicism</article-title><source>J. Hered.</source><year>1995</year><volume>86</volume><fpage>248</fpage><lpage>249</lpage></citation></ref><ref id="B30"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Stephens</surname><given-names>M</given-names></name><name><surname>Donnelly</surname><given-names>P</given-names></name></person-group><article-title>Inference in molecular population genetics (with discussion)</article-title><source>J. R. Stat. Soc. B</source><year>2000</year><volume>62</volume><fpage>605</fpage><lpage>655</lpage></citation></ref><ref id="B31"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Tavar&#x000e9;</surname><given-names>S</given-names></name><etal/></person-group><article-title>Inferring coalescence times from DNA sequences</article-title><source>Genetics</source><year>1997</year><volume>145</volume><fpage>505</fpage><lpage>518</lpage><pub-id pub-id-type="pmid">9071603</pub-id></citation></ref><ref id="B32"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>J</given-names></name></person-group><article-title>Maximum-likelihood estimation of admixture proportions from genetic data</article-title><source>Genetics</source><year>2003</year><volume>164</volume><fpage>747</fpage><lpage>765</lpage><pub-id pub-id-type="pmid">12807794</pub-id></citation></ref><ref id="B33"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Weir</surname><given-names>BS</given-names></name><name><surname>Cockerham</surname><given-names>CC</given-names></name></person-group><article-title>Estimating F-statistics for the analysis of population structure</article-title><source>Evolution</source><year>1984</year><volume>38</volume><fpage>1358</fpage><lpage>1370</lpage></citation></ref><ref id="B34"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Weis</surname><given-names>G</given-names></name><name><surname>von Haeseler</surname><given-names>A</given-names></name></person-group><article-title>Inference of population history using a likelihood approach</article-title><source>Genetics</source><year>1998</year><volume>149</volume><fpage>1539</fpage><lpage>1546</lpage><pub-id pub-id-type="pmid">9649540</pub-id></citation></ref><ref id="B35"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname><given-names>IJ</given-names></name><etal/></person-group><article-title>Inferences from DNA data: population histories,evolutionary processes, and forensic match probabilities</article-title><source>J. R. Stat. Soc. A</source><year>2003</year><volume>166</volume><fpage>155</fpage><lpage>187</lpage></citation></ref></ref-list></back></article>