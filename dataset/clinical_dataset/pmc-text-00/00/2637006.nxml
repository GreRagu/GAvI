<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.0 20120330//EN" "JATS-archivearticle1.dtd"><article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">J Neurophysiol</journal-id><journal-id journal-id-type="iso-abbrev">J. Neurophysiol</journal-id><journal-id journal-id-type="publisher-id">jn</journal-id><journal-title-group><journal-title>Journal of Neurophysiology</journal-title></journal-title-group><issn pub-type="ppub">0022-3077</issn><issn pub-type="epub">1522-1598</issn><publisher><publisher-name>American Physiological Society</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">19019976</article-id><article-id pub-id-type="pmc">2637006</article-id><article-id pub-id-type="publisher-id">J90767-8</article-id><article-id pub-id-type="doi">10.1152/jn.90767.2008</article-id><article-categories><subj-group subj-group-type="heading"><subject>Articles</subject></subj-group></article-categories><title-group><article-title>Quantifying Neural Coding of Event Timing</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Soteropoulos</surname><given-names>Demetris S.</given-names></name><xref ref-type="aff" rid="d33e48"/></contrib><contrib contrib-type="author"><name><surname>Baker</surname><given-names>Stuart N.</given-names></name><xref ref-type="aff" rid="d33e48"/></contrib></contrib-group><aff id="d33e48">Institute of Neuroscience, Medical School, Newcastle University, Newcastle upon Tyne, United Kingdom</aff><author-notes><corresp>Address for reprint requests and other correspondence: S. Baker, Institute of Neuroscience, Newcastle University, Henry Wellcome Building, Medical School, Framlington Place, Newcastle upon Tyne, NE2 4HH, UK (E-mail: <email>stuart.baker&#x00040;ncl.ac.uk</email>)</corresp></author-notes><pub-date pub-type="ppub"><month>1</month><year>2009</year></pub-date><pub-date pub-type="epub"><day>19</day><month>11</month><year>2008</year></pub-date><pub-date pub-type="pmc-release"><day>19</day><month>11</month><year>2008</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on 			/art/fm/epubdate/date downloaded from HW WWW Site. --><volume>101</volume><issue>1</issue><fpage>402</fpage><lpage>417</lpage><history><date date-type="received"><day>14</day><month>7</month><year>2008</year></date><date date-type="accepted"><day>8</day><month>11</month><year>2008</year></date></history><permissions><copyright-statement>Copyright &#x000a9; 2009, American Physiological Society</copyright-statement><copyright-year>2009</copyright-year><license license-type="open-access"><license-p>This document may be redistributed and reused, subject to <ext-link ext-link-type="uri" xlink:href="http://www.the-aps.org/publications/journals/funding_addendum_policy.htm">www.the-aps.org/publications/journals/funding_addendum_policy.htm</ext-link>.</license-p></license></permissions><self-uri xlink:title="pdf" xlink:href="z9k00109000402.pdf"/><abstract><p>Single-neuron firing is often analyzed relative to an external event, such as successful task performance or the delivery of a stimulus. The perievent time histogram (PETH) examines how, on average, neural firing modulates before and after the alignment event. However, the PETH contains no information about the single-trial reliability of the neural response, which is important from the perspective of a target neuron. In this study, we propose the concept of using the neural activity to predict the timing of the occurrence of an event, as opposed to using the event to predict the neural response. We first estimate the likelihood of an observed spike train, under the assumption that it was generated by an inhomogeneous gamma process with rate profile similar to the PETH shifted by a small time. This is used to generate a probability distribution of the event occurrence, using Bayes&#x02019; rule. By an information theoretic approach, this method yields a single value (in bits) that quantifies the reduction in uncertainty regarding the time of an external event following observation of the spike train. We show that the approach is sensitive to the amplitude of a response, to the level of baseline firing, and to the consistency of a response between trials, all of which are factors that will influence a neuron's ability to code for the time of the event. The technique can provide a useful means not only of determining which of several behavioral events a cell encodes best, but also of permitting objective comparison of different cell populations.</p></abstract></article-meta><notes><fn-group><fn><p>The costs of publication of this article were defrayed in part by the payment of page charges. The article must therefore be hereby marked &#x0201c;<italic>advertisement</italic>&#x0201d; in accordance with 18 U.S.C. Section 1734 solely to indicate this fact.</p></fn></fn-group></notes></front><body><sec><title>INTRODUCTION</title><p>Many studies align neuronal activity to different stimuli or behavioral events in an attempt to gauge the neuron's response. The basis of the perievent time histogram (PETH; <xref ref-type="bibr" rid="r14">Gerstein and Kiang 1960</xref>) is that the average across many trials will be a reasonable representation of the neural response because the averaging will reduce any activity not time-locked to the event. Subsequently, PETH features such as mean rate, peak rate, and time of peak response can then be compared for different stimuli.</p><p>More recent work has emphasized that neuronal activity can vary from trial to trial in many ways (<xref ref-type="bibr" rid="r2">Baker and Gerstein 2001</xref>; <xref ref-type="bibr" rid="r9">Croner et al. 1993</xref>; <xref ref-type="bibr" rid="r12">Fortier et al. 1993</xref>; <xref ref-type="bibr" rid="r16">Gur and Snodderly 2006</xref>; <xref ref-type="bibr" rid="r31">Tolhurst et al. 1983</xref>). Variation in <italic>latency, amplitude</italic>, and <italic>shape of response</italic> can all lead to erroneous interpretation of trial-averaged measures (<xref ref-type="bibr" rid="r7">Brody 1998</xref>, <xref ref-type="bibr" rid="r8">1999</xref>). Several reports have proposed methods that mitigate the effects of such trial-to-trial variability or allow measurements from single trials (<xref ref-type="bibr" rid="r2">Baker and Gerstein 2001</xref>; <xref ref-type="bibr" rid="r15">Grun et al. 2003</xref>; <xref ref-type="bibr" rid="r21">Nawrot et al. 1999</xref>, <xref ref-type="bibr" rid="r22">2003</xref>; <xref ref-type="bibr" rid="r24">Pauluis and Baker 1999</xref>). For the PETH, variability will tend to smear the response, making it appear smaller and broader than the actual single-trial response.</p><p>However, trial-to-trial variability is a physiological phenomenon that is interesting in its own right; several reports have attempted to measure this using the Fano factor (<xref ref-type="bibr" rid="r1">Andolina et al. 2007</xref>; <xref ref-type="bibr" rid="r12">Fortier et al. 1993</xref>; <xref ref-type="bibr" rid="r16">Gur and Snodderly 2006</xref>; <xref ref-type="bibr" rid="r17">Kara et al. 2000</xref>; <xref ref-type="bibr" rid="r33">Vogel et al. 2005</xref>). Variability in response latency and/or amplitude may provide important clues to what a cell is coding for (<xref ref-type="bibr" rid="r11">DiCarlo and Maunsell 2005</xref>). Highly reliable firing, time-locked to a behavioral event, may signal the coding of that event. Greater variability may simply be noise, but more likely represents the encoding of another variable; this may not be experimentally observable (an internal &#x0201c;hidden state&#x0201d;). It is possible that a neuron could fire reliably following one stimulus, but not for others. This would be important in distinguishing what the cell encodes; the most reliable response would not necessarily be the largest. Trial-averaged measures such as the PETH discard valuable information about the trial-to-trial response variability.</p><p>An important question is what impact this trial-to-trial variability has in the information that single neurons can convey to their targets regarding the timing of an external event?</p><p>We suggest here a method to measure this information. The method proceeds by comparing single-trial responses with the &#x0201c;archetypal&#x0201d; response, estimated by the trial-averaged response in the PETH. A cell is assigned an information value (in bits), representing how well it encodes the timing of a behavioral event or stimulus. This singular information value will be affected by a host of factors such as variability in response latency and response amplitude from trial to trial, as well as response size, baseline rate, and the intrinsic variability of neural spiking.</p><p>Reliable neurons, which have single-trial responses similar to the PETH, return high information values. Rather than attempting to account for any latency or amplitude changes from trial to trial, these are treated as genuine features of the cell's response because such variability degrades the cell's ability to represent the time of the alignment event and leads to smaller information values. The method permits a novel interpretation of cell firing and can reveal which of several events a neuron codes best.</p></sec><sec sec-type="methods"><title>METHODS</title><sec><title>General concept</title><p>In this approach, we invert the usual interpretation of the PETH. Rather than ask when spikes occur relative to a behavioral event, we consider what is the probability that the behavioral event occurred at a given time during the observation window defined by the PETH. Suppose &#x003b4;&#x003c4; is time within this observation window; typically, &#x003b4;&#x003c4; &#x0003d; 0 ms will be the actual time the event is known to occur by the experimenter. Solely from observing the spike train on a single trial <italic>SP</italic>, we seek to estimate the probability of event occurrence at time &#x003b4;&#x003c4;: <italic>P</italic>(&#x003b4;&#x003c4;&#x0007c;<italic>SP</italic>).</p><p>Direct estimation of this probability is difficult. Much easier is the problem of estimating <italic>P</italic>(<italic>SP</italic>&#x0007c;&#x003b4;&#x003c4;). To do this, we first shift the PETH by &#x003b4;&#x003c4; (<xref ref-type="fig" rid="f1">Fig. 1<italic>B</italic></xref>) and then assume that the observed single-trial spike train resulted from this underlying rate modulation. We use a model for the spike-generating process to estimate the likelihood of the observed spike train, given this rate (details of the model will be addressed in subsequent sections). This process is repeated for all possible values of &#x003b4;&#x003c4;, producing the likelihood plot <italic>P</italic>(<italic>SP</italic>&#x0007c;&#x003b4;&#x003c4;) of <xref ref-type="fig" rid="f1">Fig. 1<italic>C</italic></xref>.</p><p>Bayes&#x02019; rule can be applied to this situation, which states<disp-formula id="e1"><label>(1)</label><tex-math id="M1">\documentclass[10pt]{article}\usepackage{amsmath}\usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy}\usepackage{mathrsfs}\usepackage{pmc}\usepackage[Euler]{upgreek}\pagestyle{empty}\oddsidemargin -1.0in\begin{document}\begin{equation*}P({\delta}{\tau}\;{\vert}\;SP)=\frac{P(SP\;{\vert}\;{\delta}{\tau})P({\delta}{\tau})}{P(SP)}\end{equation*}\end{document}</tex-math></disp-formula> Assuming we have no prior information about either the expected shift or the observed data, <italic>P</italic>(&#x003b4;<italic>t</italic>) and <italic>P</italic>(<italic>SP</italic>) can both be assumed constant. <xref ref-type="disp-formula" rid="e1"><italic>Equation 1</italic></xref> then reduces to<disp-formula id="e2"><label>(2)</label><tex-math id="M2">\documentclass[10pt]{article}\usepackage{amsmath}\usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy}\usepackage{mathrsfs}\usepackage{pmc}\usepackage[Euler]{upgreek}\pagestyle{empty}\oddsidemargin -1.0in\begin{document}\begin{equation*}P({\delta}{\tau}\;{\vert}\;SP)\;{\propto}\;P(SP\;{\vert}\;{\delta}{\tau})\end{equation*}\end{document}</tex-math></disp-formula> The constant of proportionality can be determined by the requirement that a probability distribution encloses unit area.</p><p><xref ref-type="fig" rid="f1">Figure 1<italic>C</italic></xref> shows the shift likelihood distribution for a single trial. The whole procedure is repeated for all trials, producing a family of shift distributions (<xref ref-type="fig" rid="f1">Fig. 1<italic>D</italic></xref>, black). Averaging across trials yields an estimate of the mean shift likelihood distribution (<xref ref-type="fig" rid="f1">Fig. 1<italic>D</italic></xref>, gray line).</p><p>This averaged shift likelihood curve indicates how well the single neuron encodes the time of the behavioral event used to align the PETH. A sharply peaked curve indicates that an external observer could use the spiking to predict the event occurrence with high fidelity. A broad distribution indicates that this cell is of little use in determining the occurrence of the event. We can summarize this by calculating the entropy of the distribution<disp-formula id="e3"><label>(3)</label><tex-math id="M3">\documentclass[10pt]{article}\usepackage{amsmath}\usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy}\usepackage{mathrsfs}\usepackage{pmc}\usepackage[Euler]{upgreek}\pagestyle{empty}\oddsidemargin -1.0in\begin{document}\begin{equation*}S=-\;\begin{matrix}{\sum}\\ {\delta}t\end{matrix}\overline{P({\delta}t\;{\vert}\;SP)}{\mathrm{log}}_{2}\overline{P({\delta}t\;{\vert}\;SP)}\end{equation*}\end{document}</tex-math></disp-formula> The horizontal bars above <italic>P</italic>(&#x003b4;&#x003c4;&#x0007c;SP) indicate that the mean shift probability distribution is to be used. The information that the cell encodes about the behavioral event can be estimated from the difference between this entropy and that of the uniform prior on <italic>P</italic>(&#x003b4;<italic>t</italic>). Assuming a maximum shift of &#x000b1;300 ms and a 1-ms-shift resolution, the entropy of the prior is just log<sub>2</sub> (601).</p><p>In the following text we discuss possible methods for calculating <italic>P</italic>(<italic>SP</italic>&#x0007c;&#x003b4;&#x003c4;), the likelihood of the single-trial responses given the PETH. These are not presented as the only possibilities, but rather as reasonable options. If other estimates with better performance and fewer limitations are devised in future, they can easily be integrated with the general concept described earlier.</p><sec><title>SPIKE DENSITY LIKELIHOOD (POISSON PROCESS).</title><p>A simple way to estimate <italic>P</italic>(<italic>SP</italic>&#x0007c;&#x003b4;&#x003c4;) is to assume that the spike train results from an inhomogeneous Poisson process, with rate parameter equal to the shifted PETH. For the single trial under consideration, assume that &#x003bb;<sub>&#x003b4;t</sub>(<italic>i</italic>) represents the probability of spiking per bin estimated from the PETH shifted by &#x003b4;<italic>t</italic>. The ends of the shifted PETH were padded by a constant rate, equal to the mean rate of the 50-ms-long section of the PETH at the end being padded.</p><p>To improve the signal-to-noise ratio of the PETH, we calculated it using a modified procedure similar to that of previous work (<xref ref-type="bibr" rid="r24">Pauluis and Baker 1999</xref>; <xref ref-type="bibr" rid="r25">Richmond et al. 1987</xref>; <xref ref-type="bibr" rid="r26">Schwartz 1992</xref>). The instantaneous firing rate was calculated for each trial as the reciprocal of the ISI, using 1-ms bins; this was averaged across trials. The PETH was smoothed by convolution with a normalized Gaussian kernel (width parameter: 10 ms; the same methods were used to calculate the PETH for all the methods described in the following text).</p><p>If spikes occurred in bins <italic>i</italic> &#x02208; <italic>S</italic>, then the likelihood of that single trial can be estimated by<disp-formula id="e4"><label>(4)</label><tex-math id="M4">\documentclass[10pt]{article}\usepackage{amsmath}\usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy}\usepackage{mathrsfs}\usepackage{pmc}\usepackage[Euler]{upgreek}\pagestyle{empty}\oddsidemargin -1.0in\begin{document}\begin{equation*}P(SP\;{\vert}\;{\delta}t)=\;\begin{matrix}\prod\\ i{\in}S\end{matrix}{\lambda}_{{\delta}t}\;(i)\;\begin{matrix}\prod\\ j{\not\in}S\end{matrix}\;[1-{\lambda}_{{\delta}t}(j)]\end{equation*}\end{document}</tex-math></disp-formula> We note in passing that, like other methods relying on likelihood, this product can be problematic to calculate for large numbers of bins. The value can become so small as to be outside the floating point range of standard computers. This is easily solved by taking the logarithm of the individual terms, and then summing<disp-formula id="e5"><label>(5)</label><tex-math id="M5">\documentclass[10pt]{article}\usepackage{amsmath}\usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy}\usepackage{mathrsfs}\usepackage{pmc}\usepackage[Euler]{upgreek}\pagestyle{empty}\oddsidemargin -1.0in\begin{document}\begin{equation*}{\mathrm{log}}\;[P(SP\;{\vert}\;{\delta}t)]=\;\begin{matrix}{\sum}\\ i{\in}S\end{matrix}{\mathrm{log}}\;[{\lambda}_{{\delta}t}(i)]+\;\begin{matrix}{\sum}\\ j{\not\in}S\end{matrix}{\mathrm{log}}\;[1-{\lambda}_{{\delta}t}(j)]\end{equation*}\end{document}</tex-math></disp-formula> The scaling of <italic>P</italic>(<italic>SP</italic>&#x0007c;&#x003b4;<italic>t</italic>) is unimportant because these values will eventually be rescaled to enclose unit area forming <italic>P</italic>(&#x003b4;<italic>t</italic>&#x0007c;<italic>SP</italic>). Once log &#x0005b;<italic>P</italic>(<italic>SP</italic>&#x0007c;&#x003b4;<italic>t</italic>)&#x0005d; is found for all &#x003b4;<italic>t</italic>, we therefore add an arbitrary constant to all values, before taking antilogs. This ensures that the results remain inside the allowed floating point range.</p><p><xref ref-type="fig" rid="f2">Figure 2</xref> shows an example of the application of this method. From the shifted spiking probability curve &#x003bb;<sub>&#x003b4;t</sub>(<italic>i</italic>) (<xref ref-type="fig" rid="f2">Fig. 2<italic>A</italic></xref>), the per-bin probability is found (<xref ref-type="fig" rid="f2">Fig. 2<italic>B</italic></xref>). Forming the product of these probabilities yields the data likelihood for that shift. Compiling for all shifts and normalizing the curve to enclose unit area produce the shift likelihood distribution for that trial (<xref ref-type="fig" rid="f2">Fig. 2<italic>C</italic></xref>); averaging across trials yields the mean shift likelihood (<xref ref-type="fig" rid="f2">Fig. 2<italic>D</italic></xref>, gray).</p><p>The most attractive feature of this procedure is its simplicity and ease of calculation. However, it does not take into account the dependence of spike probability on the spiking history, such as the absolute refractory period. If a spike occurs in bin <italic>i</italic>, the probability of spiking in bin <italic>i</italic> &#x0002b; 1 assuming Poisson spiking is simply &#x003bb;(<italic>i</italic> &#x0002b; 1), whereas it is zero for real neuronal data.</p></sec><sec><title>INTERSPIKE INTERVAL LIKELIHOOD.</title><p>The following section describes a method for estimating <italic>P</italic>(<italic>SP</italic>&#x0007c;&#x003b4;<italic>t</italic>) based not on the timing of the spikes, but on the observed interspike intervals (ISIs). We assume that the underlying spiking process can be modeled as a gamma distribution (<xref ref-type="bibr" rid="r2">Baker and Gerstein 2001</xref>; <xref ref-type="bibr" rid="r3">Baker and Lemon 2000</xref>; <xref ref-type="bibr" rid="r30">Stein 1965</xref>). This is a more realistic representation of real neural firing than a Poisson process because it shows a refractory period and can be a better match for observed ISI distributions. The probability of observing an interval <italic>ISI</italic> given mean firing rate <italic>R</italic> and gamma order parameter <italic>a</italic> is<disp-formula id="e6"><label>(6)</label><tex-math id="M6">\documentclass[10pt]{article}\usepackage{amsmath}\usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy}\usepackage{mathrsfs}\usepackage{pmc}\usepackage[Euler]{upgreek}\pagestyle{empty}\oddsidemargin -1.0in\begin{document}\begin{equation*}{\gamma}(I)=(aR)^{a}\frac{1}{(a-1)!}\;ISI^{a-1}e^{-ISIaR}\end{equation*}\end{document}</tex-math></disp-formula> A gamma process with order <italic>a</italic> &#x0003d; 1 is a Poisson process. For a given experimental neuron, the most likely order can be estimated by using the method described briefly in the following text and in <xref ref-type="bibr" rid="r3">Baker and Lemon (2000)</xref>.</p><p>To calculate the likelihood of the spike train data from a single trial <italic>P</italic>(<italic>SP</italic>&#x0007c;&#x003b4;<italic>t</italic>), we first take the PETH and shift it by a time &#x003b4;<italic>t</italic> relative to the single-trial spike train. <xref ref-type="fig" rid="f3">Figure 3</xref>, <italic>A</italic>&#x02013;<italic>C</italic> shows an example PETH at three different latency shifts (<xref ref-type="fig" rid="f3">Fig. 3<italic>A</italic></xref>: &#x02212;100 ms; <xref ref-type="fig" rid="f3">Fig. 3<italic>B</italic></xref>: 0 ms; <xref ref-type="fig" rid="f3">Fig. 3<italic>C</italic></xref>: &#x0002b;100 ms). The PETH is then averaged over the period spanned by each ISI, yielding the mean rate pertaining to that interval <italic>R</italic><sub><italic>i</italic></sub> (thick lines in <xref ref-type="fig" rid="f3">Fig. 3</xref>, <italic>A</italic>&#x02013;<italic>C</italic>). The ISIs for trial 1 are shown in <xref ref-type="fig" rid="f3">Fig. 3</xref>, <italic>A</italic>&#x02013;<italic>C</italic> by the dashed vertical lines spanning the three plots and, within each ISI, the horizontal lines represent the mean PETH rate during that interval. Just by inspecting the plots the mismatch at the shifted latencies (&#x02212;100 ms, &#x0002b;100 ms) is obvious; in both cases short intervals are seen with low rates and large intervals with high rates. Considering the seventh ISI as an example (gray shading, <xref ref-type="fig" rid="f3">Fig. <italic>3C</italic></xref>), the corresponding mean PETH rate (<italic>R</italic><sub><italic>i</italic></sub>) is very different for the three latency shifts (&#x02212;100 and 100 ms) at 18, 58, and 20 Hz, respectively. <xref ref-type="fig" rid="f3">Figure 3</xref>, <italic>D</italic>&#x02013;<italic>F</italic> shows the three different ISI distributions (gamma order 4) calculated for these underlying rates. The observed interval (15 ms) is much less probable for mean rates of 18 or 20 Hz compared with the distribution for a mean rate of 58 Hz.</p><p>For each interval, the combination of a rate and order estimate defines a probability distribution of intervals, from which the observed interval is drawn. These can be used to quantify the likelihood of observing each interval; the product of these likelihoods yields the data likelihood for that trial, given a PETH shift of &#x003b4;<italic>t</italic><disp-formula id="e7"><label>(7)</label><tex-math id="M7">\documentclass[10pt]{article}\usepackage{amsmath}\usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy}\usepackage{mathrsfs}\usepackage{pmc}\usepackage[Euler]{upgreek}\pagestyle{empty}\oddsidemargin -1.0in\begin{document}\begin{equation*}P(SP\;{\vert}\;{\delta}t)=\;\begin{matrix}\prod\\ i\end{matrix}\;{\gamma}(ISI_{i},\;a,\;R_{i})\end{equation*}\end{document}</tex-math></disp-formula> This process was repeated for shifts &#x003b4;<italic>t</italic> from &#x02212;300 to 300 ms in steps of 1 ms. The shift likelihood distribution for trial 1 is shown in <xref ref-type="fig" rid="f3">Fig. 3<italic>G</italic></xref>. The entire procedure was repeated for all available trials (<xref ref-type="fig" rid="f3">Fig. 3<italic>H</italic></xref>). Because the method works on ISIs, it cannot be used when a trial has fewer than two spikes. The shift likelihood curve for such trials was assigned as a uniform distribution. The single-trial shift likelihood distributions were then averaged to give the mean shift likelihood distribution (light gray line in <xref ref-type="fig" rid="f3">Fig. 3<italic>H</italic></xref>).</p></sec><sec><title>SPIKE DENSITY LIKELIHOOD (GAMMA PROCESS).</title><p>The two methods described earlier are complementary. The Poisson spike density method is capable of responding to rapid changes in spike density; however, it cannot account for the dependence of spiking probability on spiking history. By contrast, the interval density method naturally accounts for the complexity of interval statistics, but it cannot take into account rate changes faster than the length of an interval.</p><p>The final method that we propose depends on spike density, but also takes account of spike history. We start by considering the <italic>death rate</italic> as a function of time since the last spike. This is the probability that a spike will occur at a particular ISI, given that no spike has occurred up until this time (<xref ref-type="bibr" rid="r20">Matthews 1996</xref>). The death rate (<xref ref-type="fig" rid="f4">Fig. 4<italic>C</italic></xref>) is calculated by dividing the ISI distribution (<xref ref-type="fig" rid="f4">Fig. 4<italic>A</italic></xref>: three gamma ISI distributions with mean ISIs of 25, 50, and 100 ms) by the inverse of the cumulative probability function of the ISI distribution (survival plot; <xref ref-type="fig" rid="f4">Fig. 4<italic>B</italic></xref>). The marks on each line in <xref ref-type="fig" rid="f4">Fig. 4<italic>C</italic></xref> show the probability of a spike occurring after a time equal to the mean ISI for each distribution has passed.</p><p>We are interested in using this method for nonhomogeneous gamma processes, where the rate will not necessarily be constant during the ISI. To accommodate changes in rate that fall between two spikes, we suggest expressing the death rate not as a function of time after the previous spike, but as a function of the integral of the spike density since the last spike<disp-formula id="e8"><label>(8)</label><tex-math id="M8">\documentclass[10pt]{article}\usepackage{amsmath}\usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy}\usepackage{mathrsfs}\usepackage{pmc}\usepackage[Euler]{upgreek}\pagestyle{empty}\oddsidemargin -1.0in\begin{document}\begin{equation*}P[spike(t+T)]=f\;\left[{\int _{t}^{t+T}}\;{\lambda}({\tau}){\mathrm{d}}{\tau}\;\right]\end{equation*}\end{document}</tex-math></disp-formula> where <italic>t</italic> is the time of the last spike (<xref ref-type="bibr" rid="r5">Barbieri et al. 2001</xref>; <xref ref-type="bibr" rid="r18">Kass and Ventura 2001</xref>). When the rate is constant, this is just a rescaling of the abscissa (<xref ref-type="fig" rid="f4">Fig. 4<italic>D</italic></xref>). However, if the rate changes, making the spiking probability a function of the accumulated density naturally incorporates the rate changes. Integrating the rate is analogous (in a very simplistic way) to the way the cell membrane integrates arriving potentials until a threshold is reached and the cell fires. Such a nonleaky integrate-and-fire neuron is an oversimplified model of neural firing, but can generate firing patterns matching that of a gamma process (<xref ref-type="bibr" rid="r32">Tuckwell 1988</xref>).</p><p>Processes with different rates will obviously have a different probability of a spike occurring after the rate integral reaches the same value (as indicated by the marks on the lines in <xref ref-type="fig" rid="f4">Fig. 4<italic>D</italic></xref>). However, for the same order of the gamma process, the functions plotted in <xref ref-type="fig" rid="f4">Fig. 4<italic>D</italic></xref> differ only by a scaling factor. If they are rescaled by dividing by the mean rate, they overlie perfectly (<xref ref-type="fig" rid="f4">Fig. 4<italic>E</italic></xref>). Gamma processes with different orders have functions with different shapes, some examples of which are shown in <xref ref-type="fig" rid="f4">Fig. 4<italic>F</italic></xref>.</p><p>We thus calculated the probability of spiking at time <italic>T</italic>, when the previous spike occurred at time <italic>t</italic>, as<disp-formula id="e9"><label>(9)</label><tex-math id="M9">\documentclass[10pt]{article}\usepackage{amsmath}\usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy}\usepackage{mathrsfs}\usepackage{pmc}\usepackage[Euler]{upgreek}\pagestyle{empty}\oddsidemargin -1.0in\begin{document}\begin{equation*}P[spike\;at\;(t+T)]=f\;\left[{\int _{t}^{t+T}}\;{\lambda}({\tau}){\mathrm{d}}{\tau}\;\right]{\lambda}(t+T)\end{equation*}\end{document}</tex-math></disp-formula> where <italic>f</italic> is calculated by the double-scaling of the death rate for a gamma process described earlier and &#x003bb;(<italic>t</italic>) is estimated from the shifted PETH. The likelihood <italic>P</italic>(<italic>SP</italic>&#x0007c;&#x003b4;<italic>t</italic>) can then be estimated by multiplying the probabilities of the observed data (analogous to <xref ref-type="disp-formula" rid="e4"><italic>Eq. 4</italic></xref>).</p><p><xref ref-type="fig" rid="f4">Figure 4</xref>, <italic>G</italic>&#x02013;<italic>I</italic> shows the performance of the spike density method for three different shifts &#x003b4;<italic>t</italic> for a single trial. <xref ref-type="fig" rid="f4">Figure 4</xref>, <italic>G1, H1</italic>, and <italic>I1</italic> shows the corresponding spike densities, whereas <xref ref-type="fig" rid="f4">Fig. 4</xref>, <italic>G2, H2</italic> and <italic>I2</italic> represents the accumulated spike density since the last spike. <xref ref-type="fig" rid="f4">Figure 4</xref>, <italic>G3, H3</italic>, and <italic>I3</italic> is a plot of the probability of observing a spike at every time point, whereas <xref ref-type="fig" rid="f4">Fig. 4</xref>, <italic>G4, H4</italic>, and <italic>I4</italic> is the probability of the observed data in each bin &#x0005b;i.e., <italic>P</italic>(<italic>spike</italic>) when a spike occurred and 1 &#x02212; <italic>P</italic>(<italic>spike</italic>) when no spike occurred&#x0005d;. The gray rectangles are to focus the attention for a region of increased rate for the three shifts. As can be seen in the case of the 100-ms shifts in either direction (<xref ref-type="fig" rid="f4">Fig. 4</xref>, <italic>G</italic> and <italic>I</italic>) the probability of spiking given the shifted spike density is low because the spikes are now over an area of low spike density. Because the likelihood of each &#x003b4;&#x003c4; is a product of the probabilities of the observed data, this will cause &#x003b4;&#x003c4; &#x0003d; &#x02212;100 ms and &#x003b4;&#x003c4; &#x0003d; 100 ms to have a much lower likelihood than when &#x003b4;&#x003c4; &#x0003d; 0 ms.</p></sec></sec><sec><title>Bias estimation and significance testing</title><p>To estimate a <italic>P</italic> &#x0003c; 0.05 significance level for the measured information about event timing, a shuffled data set (<xref ref-type="fig" rid="f5">Fig. 5<italic>B</italic></xref>) was generated from the original data (<xref ref-type="fig" rid="f5">Fig. 5<italic>A</italic></xref>). The ISIs of each trial were shuffled; the first spike was chosen randomly so that<disp-formula id="e10"><label>(10)</label><tex-math id="M10">\documentclass[10pt]{article}\usepackage{amsmath}\usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy}\usepackage{mathrsfs}\usepackage{pmc}\usepackage[Euler]{upgreek}\pagestyle{empty}\oddsidemargin -1.0in\begin{document}\begin{equation*}0{\leq}ISI_{0}^{\prime}{\leq}ISI_{0}+ISI_{last}\end{equation*}\end{document}</tex-math></disp-formula> where ISI&#x02032;<sub>0</sub> is the first incomplete interval of the <italic>shuffled</italic> trial and <italic>ISI</italic><sub>0</sub> and <italic>ISI</italic><sub><italic>last</italic></sub> are the first and last incomplete intervals of the real trial (&#x0201c;incomplete intervals&#x0201d; are the ISIs that fell only partially within the timeframe of the actual trial, i.e., the time period before the first spike and after the last).</p><p>The timing information for the shuffled data were calculated as described earlier (<xref ref-type="fig" rid="f5">Fig. 5<italic>C</italic></xref>). The entire process was repeated 100 times, yielding a distribution of the information that would be measured if the cell coded nothing above chance levels about the occurrence of the behavioral event (<xref ref-type="fig" rid="f5">Fig. 5<italic>D</italic></xref>). If the information value found from unshuffled data (dotted line, <xref ref-type="fig" rid="f5">Fig. 5<italic>D</italic></xref>) was greater than 95/100 of the values from shuffled data then the cell can be considered to convey significant information about the event.</p><p><italic>Information</italic> is defined as the difference in entropy before and after an observation is made. Our estimate of entropy before observation of the spike train is not biased, since we calculate it analytically as log<sub>2</sub> (number of bins). However, our estimate of entropy after observation is biased: due to finite sampling, the experimental estimate of shift likelihood will not be exactly equal to a uniform distribution, even if the cell codes nothing about the event timing. As a result, our information estimates will be biased upward (<xref ref-type="bibr" rid="r23">Panzeri and Treves 1996</xref>). To correct for this, the mean information derived from the shuffled data should be subtracted from the information determined from the original data. For the rest of the study, <italic>I</italic><sub>r</sub> will be used to refer to the information estimate <italic>without</italic> this bias subtraction. However, for the majority of the simulations presented here, because the number of trials was very large this correction would have made negligible difference. In experimental data with smaller numbers of trials, however, it could be necessary. A small number of shuffles for bias estimation (<italic>n</italic> &#x0223c; 10&#x02013;20) should be sufficient, whereas around 100 are required for significance estimation.</p><p>Another source of bias arises from the fact that the estimate of the underlying rate change comes from the PETH, which is calculated from summing the single-trial data. If only small numbers of trials are available, chance fluctuations in cell spiking will produce noise in the PETH, to which the spike trains will necessarily best align with zero-lag. This will lead to a shift-probability distribution with a weak central peak, even in the absence of task-related firing, producing an elevated information estimate. To avoid this effect, in all results reported here the PETH used to estimate the likelihood for the <italic>n</italic>th trial was calculated using all trials except the <italic>n</italic>th.</p></sec><sec><title>Optimal order estimation</title><p>Both the ISI method and the gamma process spike density method require an estimate to be made of the order of the gamma process used to model the spike train. For experimental data, here we have followed the procedure suggested by <xref ref-type="bibr" rid="r3">Baker and Lemon (2000)</xref> to do this. Briefly, the instantaneous firing rate was estimated by convolving the spike train with a Gaussian kernel with width parameter &#x003c3; equal to the modal ISI. Inhomogeneous gamma processes were then generated using this rate, but with different orders. The resulting ISI histograms were compared with the ISI distribution of the original data and the one giving the best fit was chosen as the optimal order to describe that cell. Some problems with this method have been identified (<xref ref-type="bibr" rid="r13">Gerstein 2004</xref>), which may lead to errors in order estimation. This is most likely when the firing rate is changing; to minimize such errors, data for order fitting should be taken from a period where the rate is relatively stationary.</p><p>It is known that the regularity of neural spiking can modulate during task performance; this can be quantified using the measure of irregularity developed by <xref ref-type="bibr" rid="r10">Davies et al. (2006)</xref>. Such regularity changes imply that estimates of order taken from one part of the task will not necessarily be valid for another. In the present study, we do not account for this&#x02014;which would be possible using the methods of <xref ref-type="bibr" rid="r10">Davies et al. (2006)</xref>&#x02014;although we do quantify the effect that errors in assumed order will produce.</p></sec><sec><title>Simulated data</title><p>Simulated data of known properties were generated to assess the behavior of the analysis method. In these simulations, the single-trial firing rate increased in a stepwise fashion from a baseline rate to a higher level for a defined time, before returning to the baseline. Using this rate profile, ISIs were generated from a gamma distribution of a particular order, following the decimation method described in <xref ref-type="bibr" rid="r2">Baker and Gerstein (2001)</xref>. The order of the gamma was fixed at <italic>a</italic> &#x0003d; 4 and 100 trials were generated, unless otherwise stated.</p></sec></sec><sec sec-type="results"><title>RESULTS</title><sec><title>Method comparison/limitations</title><p><xref ref-type="fig" rid="f6">Figure 6<italic>A</italic></xref> compares the information values obtained using the three methods to estimate <italic>P</italic>(<italic>SP</italic>&#x0007c;&#x003b4;<italic>t</italic>) described earlier. These have been applied to data simulated with step increases in rate (20 to 60 Hz; duration of step: 200 ms) and various values of the gamma order parameter. For gamma order 1 (corresponding to Poisson spike trains), all methods produced the same information value. However, as the gamma order increased, so did the information estimated using the two methods that took account of the non-Poisson nature of the firing. This increase is a desirable property: it reflects the increased information about event time that can be carried by a regular spike train compared with an irregular one. By contrast, the method that assumed Poisson statistics yielded the same information value throughout, underestimating the true value when the assumption of Poisson firing was violated. Since experimental spike trains are typically more regular than a Poisson process, this makes the Poisson spike density method inapplicable to experimental data. We will therefore not consider it any further.</p><p>The gamma spike density and gamma interval methods produced very similar results in most situations we have examined (<xref ref-type="fig" rid="f6">Fig. 6<italic>A</italic></xref> and other data not shown). Differences can occur, however, in situations where the rate modulates over a similar timescale to the ISI duration. An example of such a circumstance is shown in <xref ref-type="fig" rid="f6">Fig. 6<italic>B</italic></xref>, as a raster display with PETH superimposed. The rate modulates from 0 to 10 Hz in an oscillatory fashion, with a 4-Hz cycle time. In such cases, averaging the rate over an ISI fails to capture the time dependence of the spike density. <xref ref-type="fig" rid="f6">Figure 6<italic>C</italic></xref> shows the shift likelihood distributions for the gamma spike density likelihood method and <xref ref-type="fig" rid="f6">Fig. 6<italic>D</italic></xref> for the ISI likelihood method. The ISI method yielded a substantially lower information value (0.11 bit) compared with the gamma spike density method (1.85 bits). This occurred because the ISI method necessarily averages the spike density over each ISI. Rapid fluctuations in density are thus smoothed out and the cell is assigned an erroneously low value of information.</p><p>Because the ISI method averages the rate over the ISI duration, it is less sensitive to noise. This is illustrated in <xref ref-type="fig" rid="f6">Fig. 6<italic>E</italic></xref>, which plots the <italic>I</italic><sub>r</sub> values measured from simulated data with no modulation in rate; <italic>I</italic><sub>r</sub> values would ideally be zero in this case, although a small bias will be present, as described in <sc>methods</sc>. Although both methods produce small <italic>I</italic> values, they are consistently smaller for the ISI method. However, this difference is so small that it is unlikely to be of importance for experimental data.</p><p>The remainder of this study will focus on the performance of the gamma spike density method because it both takes account of the non-Poisson nature of neural firing and also can account for rapid changes in spike density.</p></sec><sec><title>Bias</title><p>With finite data, the method presented here will lead to a nonzero raw information estimate <italic>I</italic><sub>r</sub>, even if a cell does not modulate its activity systematically around a task event. Any noise fluctuations in the shift probability estimate will lower its entropy relative to a uniform distribution, leading to a positive bias in the information. We have used a shuffling method to estimate and correct for this. The dependence of the bias on various parameters is illustrated in <xref ref-type="fig" rid="f7">Fig. 7</xref>; these curves were calculated from simulated data with no actual modulation in rate.</p><p><xref ref-type="fig" rid="f7">Figure 7<italic>A</italic></xref> presents the effect of smoothing kernel width and firing rate (10, 20, and 40 Hz) on bias when the trial numbers are low (10 trials). Unsurprisingly, at little or no smoothing the bias is high and decreases as the smoothing increases. The arrowhead in <xref ref-type="fig" rid="f7">Fig. <italic>7A</italic></xref> is the maximum ordinate scale of <xref ref-type="fig" rid="f7">Fig. 7<italic>B</italic></xref>, which is based on PETHs with 50 trials. Similar curves as in <xref ref-type="fig" rid="f7">Fig. 7<italic>A</italic></xref> are seen, but with this larger number of trials even with little or no smoothing the bias is much smaller. The arrowhead in <xref ref-type="fig" rid="f7">Fig. 7<italic>B</italic></xref> shows the maximum ordinate scale of <xref ref-type="fig" rid="f7">Fig. 7<italic>C</italic></xref>, which is based on PETHs with 100 trials. The same trend is seen for bias versus smoothing as in <xref ref-type="fig" rid="f7">Fig. 7</xref>, <italic>A</italic> and <italic>B</italic>, but the value of the bias is now even smaller. The decrease in bias with increased smoothing/trial number is because random fluctuations in the PETH (arising from the stochastic nature of spiking) are decreased.</p><p>In the simulations of <xref ref-type="fig" rid="f7">Fig. 7</xref>, <italic>A</italic>&#x02013;<italic>C</italic>, the number of trials and the noise fluctuations in the PETH are interdependent. To explore the effect of noisy fluctuations in the PETH in more detail, we first simulated data with a constant rate. The known flat rate profile was then corrupted by the addition of different levels of Gaussian noise. <xref ref-type="fig" rid="f7">Figure 7<italic>D</italic></xref> shows how noise in the PETH affected the bias estimate for different baseline rates (data simulated as gamma process order 4, 50 trials, maximum value of &#x003b4;<italic>t</italic> &#x0003d; 100 ms). As the level of noise increased so did the bias, although for the same noise CV, the bias was greater for higher baseline rates. This can be explained by referring to <xref ref-type="fig" rid="f4">Fig. 4<italic>D</italic></xref>. For the same gamma order, as the mean rate increases, the death rate plot becomes steeper around the region of the unitary rate integral. This means that small changes in the rate integral will result in greater changes in the probability of observing a spike for higher rates at different &#x003b4;&#x003c4;. Random fluctuations in the PETH will thus result in greater modulation in the shift likelihood distribution for higher rates and thus a higher bias.</p><p>The regularity of a spike train will also affect the bias estimate. This is explored in <xref ref-type="fig" rid="f7">Fig. 7</xref>, <italic>E</italic>&#x02013;<italic>G</italic>, where regularity is systematically changed by altering the order of the gamma process used to simulate the data. As spiking regularity increases so does the bias, although for 100 trials the absolute size of these effects was small. This can be explained by referring to <xref ref-type="fig" rid="f4">Fig. 4<italic>F</italic></xref>. As gamma order increases, and firing becomes more regular, the death rate plot becomes steeper around the region of unitary rate integral. This means that for the same change in the rate integral, there will be a greater change in the probability of observing a spike as &#x003b3; increases. For a given PETH, a spike train of higher order will show greater changes in likelihood at different &#x003b4;&#x003c4;, thus having lower entropy and resulting in a higher bias. The arrowhead in <xref ref-type="fig" rid="f7">Fig. 7<italic>E</italic></xref> is the maximal ordinate scale of <xref ref-type="fig" rid="f7">Fig. 7<italic>F</italic></xref> and similarly the arrowhead in <xref ref-type="fig" rid="f7">Fig. 7<italic>F</italic></xref> is that for <xref ref-type="fig" rid="f7">Fig. 7<italic>G</italic></xref>.</p><p>At first sight, there may appear to be a contradiction between <xref ref-type="fig" rid="f7">Fig. 7</xref>, <italic>E</italic>&#x02013;<italic>G</italic> and <xref ref-type="fig" rid="f7">Fig. 7<italic>D</italic></xref>: in <xref ref-type="fig" rid="f7">Fig. 7<italic>D</italic></xref>, bias is largest for high baseline rates, whereas in <xref ref-type="fig" rid="f7">Fig. 7</xref>, <italic>E</italic>&#x02013;<italic>G</italic>, bias is greatest at low rates. The explanation for this is that, for the same number of trials, the noise fluctuations in the PETH (measured by CV of bin counts) are greater for lower baseline rates. This effect combines with that shown in <xref ref-type="fig" rid="f7">Fig. 7<italic>D</italic></xref> to produce the relationships seen in <xref ref-type="fig" rid="f7">Fig. 7</xref>, <italic>E</italic>&#x02013;<italic>G</italic>.</p><p>For the remainder of the <sc>results</sc> section we will show only the <italic>I</italic><sub>r</sub> values, based on estimates on 100 trials. Ignoring the bias correction substantially reduces the computation time and, as made clear by <xref ref-type="fig" rid="f7">Fig. 7<italic>C</italic></xref>, the bias is in fact negligible for this trial number.</p></sec><sec><title>Smoothing kernel</title><p>A key aspect of our method is that the PETH is used as an estimate of the underlying rate modulation. By smoothing the PETH, a better estimate can be produced. Increasing the width of the smoothing kernel is advantageous because it reduces spurious variability in the PETH. This reduces the bias in the information measures (<xref ref-type="fig" rid="f7">Fig. 7</xref>, <italic>A</italic>&#x02013;<italic>C</italic>). However, smoothing also blurs any genuine relationship between the cell's firing and the behavioral event, reducing the measured information. <xref ref-type="fig" rid="f8">Figure 8<italic>A</italic></xref> shows how increased smoothing alters the <italic>I</italic><sub>r</sub> value. In these simulations, the rate increased to double the baseline rate during a 200-ms-long step. The information value dropped with increasing kernel width; the effect was greatest for high rates. In practice, a value for smoothing will need to be chosen heuristically to compromise between oversmoothing (reducing information, <xref ref-type="fig" rid="f8">Fig. 8<italic>A</italic></xref>) and undersmoothing (increasing bias, <xref ref-type="fig" rid="f7">Fig. 7</xref>, <italic>A</italic>&#x02013;<italic>C</italic>).</p></sec><sec><title>Maximum shift (&#x003b4;&#x003c4;)</title><p>One arbitrary parameter of the present method is the maximum shift &#x003b4;&#x003c4; used. As the maximum shift is increased, so the entropy of the uniform prior will rise (top dotted line in <xref ref-type="fig" rid="f8">Fig. 8<italic>B</italic></xref>). If a cell codes for a behavioral event, then in most circumstances shifts above a certain duration will all have very low probability (there are some exceptions to this, however; e.g., oscillatory responses, <xref ref-type="fig" rid="f6">Fig. 6<italic>B</italic></xref>). The entropy of the mean shift probability distribution will therefore increase little with further increases in the maximum shift. This is shown by the other lines in <xref ref-type="fig" rid="f8">Fig. 8<italic>B</italic></xref> (200-ms step in rate, baseline rate, and rate during the step labeled on the curves), which rise less steeply at large shifts than the prior entropy. Since the information is the difference between the posterior shift distribution entropy and the entropy of the uniform prior, the measured information will rise with larger values of the maximum shift. For this reason, our method cannot give an assumption-free estimate of information, but depends on how uncertain event timing is initially assumed to be. Practically, comparison between different cell populations must use the same maximum shift to be valid.</p></sec><sec><title>Step magnitude</title><p>Intuitively, the more that a cell changes its firing rate associated with an event, the more reliably it encodes the event's timing. <xref ref-type="fig" rid="f8">Figure 8<italic>C</italic></xref> quantifies how the size of rate change alters the raw information measured using the present method. Each line shows results for a different baseline rate; the abscissa gives the ratio between the firing rate during a 200-ms event-locked step rate increase/decrease and this baseline. As expected, the information about the event increases with the size of the rate step for both rate increases and decreases. In the case of rate decreases, as the rate during the step approaches zero, the <italic>I</italic> value tends to level out. However, the absolute size of the rate step is not the only important factor. The points marked with circles in <xref ref-type="fig" rid="f8">Fig. 8<italic>C</italic></xref> both relate to rate increases of 30 Hz. However, a rise from 10 to 40 Hz provides 1.74-fold more information than when the rate changes from 20 to 50 Hz (1.31 vs. 0.75 bits, respectively). This is because a 25-ms ISI (relating to a 40-Hz response) is less likely to occur during a 10-Hz firing-rate epoch than a 20-ms interval (relating to a 50-Hz response) during a 20-Hz firing-rate epoch. The shift likelihood distributions for the 10- to 40-Hz step are thus narrower, raising the information measured.</p><p><xref ref-type="fig" rid="f8">Figure 8<italic>C</italic></xref> demonstrated that the information encoded about event time depends on the size of the unit's rate increase. In experimental data, the amplitude of rate modulation is often nonstationary from trial-to-trial (<xref ref-type="bibr" rid="r4">Baker et al. 2001</xref>). It is interesting to know how much such rate variation will affect the information estimates. This is examined in <xref ref-type="fig" rid="f8">Fig. 8<italic>D</italic></xref> for step rate increases. Data were simulated by choosing the amplitude of the rate step for each trial from a normal distribution. The mean rate corresponded to that given in the figure key; the SD of the normal distribution was chosen to yield a coefficient of variation (CV) from 0.1 to 0.5, which is plotted on the abscissa. Response amplitude variation reduced the measured information values; this decrease was more pronounced for higher firing rates.</p><p>If there were concern that response amplitude varies substantially between trials, it would be possible to extend our method by assuming that the spike density on a single trial is a scaled version of the PETH<disp-formula id="e11"><label>(11)</label><tex-math id="M11">\documentclass[10pt]{article}\usepackage{amsmath}\usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy}\usepackage{mathrsfs}\usepackage{pmc}\usepackage[Euler]{upgreek}\pagestyle{empty}\oddsidemargin -1.0in\begin{document}\begin{equation*}{\lambda}({\tau})={\alpha}{\cdot}PETH({\tau})\end{equation*}\end{document}</tex-math></disp-formula> The data likelihood could then be estimated as a two-dimensional function of both shift &#x003b4;<italic>t</italic> and response amplitude scaling &#x003b1;. The shift probability would then be given by the marginal, found by integrating the two-dimensional distribution over &#x003b1;. Whether this additional computational complexity is warranted will depend on the nature of the experimental data.</p></sec><sec><title>Step width</title><p>The duration of rate modulation also influences how well a cell codes the timing of an event; this is investigated by <xref ref-type="fig" rid="f8">Fig. 8<italic>E</italic></xref>. The raw information rises for the four rate profiles investigated as the duration of the rate step increases, whether it is a step increase (doubling of baseline rate) or decrease (rate drops to zero). However, information levels off for widths around 150 ms and there is then no further increase. So long as the response is wide enough unambiguously to include ISIs from the period of elevated rate (for rate increases), then increasing the number of these intervals does not substantially change the mean shift probability distributions. Similarly for rate step decreases, as long as the width of the response is comparable to ISIs from the baseline period further increases will have little effect. Essentially, our method is sensitive to rate changes and is scarcely affected by periods of constant rate in the PETH.</p><p>The effect of varying response duration from trial to trial is shown in <xref ref-type="fig" rid="f8">Fig. 8<italic>F</italic></xref>. Here, the mean response duration was 300 ms; the actual duration used for each trial was selected from a normal distribution, with CV between 0.1 and 0.5 (shown on the abscissa). Variability in the response duration decreased the information measured; data with higher firing rates were more greatly affected.</p></sec><sec><title>Spiking regularity</title><p><xref ref-type="fig" rid="f9">Figure 9</xref> shows a series of simulations carried out to assess the effect of spiking regularity of the information values, and also what happens when this regularity varies from trial to trial, and when miscalculated.</p><p>To determine the effect of spiking regularity on event encoding, we measured the information from spike trains simulated with the same rate profiles but different orders of gamma process. In all cases, increased regularity (higher gamma order) led to higher information (<xref ref-type="fig" rid="f9">Fig. 9<italic>A</italic></xref>). This is because, as the regularity of the process increases, the intervals within the response region become less likely to arise from the baseline period and vice versa.</p><p>An important assumption of the present method is that the ISIs follow a gamma distribution. The appropriate order of this distribution must be determined from the spike train before the analysis can be performed. <xref ref-type="fig" rid="f9">Figure 9<italic>B</italic></xref> shows how the measured event information is affected by incorrectly estimating the gamma order. Each line on this plot relates to simulations carried out using a certain order of gamma process; the abscissa shows the order assumed for the analysis. Information is normalized by the information measured when the assumed order coincides with the actual order used to simulate the data. Overestimating the order led to a corresponding overestimate of information; likewise, assuming an order below the true value underestimated the information.</p><p>For experimental data, it is most likely that order will be underestimated. If rate is nonstationary, this will lead to higher ISI irregularity than expected if the rate were constant. We recently published a method capable of estimating spiking regularity when the rate is nonstationary (<xref ref-type="bibr" rid="r10">Davies et al. 2006</xref>). Although generally effective, in the presence of very rapid rate changes, or serially correlated ISIs, this can also overestimate the irregularity of discharge. Errors in order determination for experimental data are thus always likely to err toward assuming the spike train is more irregular than it actually is, leading to a lower assigned gamma order than the actual underlying value. This would result in an underestimate of the information carried by an experimental spike train. Our method is thus likely to yield conservative information estimates in the face of errors in order estimation.</p><p>To examine the effects of trial-to-trial variability in the spike regularity, PETHs with a rate step were generated in which the spiking regularity, determined by the order of the gamma process used to simulate the data, was different for each trial (but constant within a trial). The gamma order <italic>a</italic> determines the CV of the ISIs, according to<disp-formula id="e12"><label>(12)</label><tex-math id="M12">\documentclass[10pt]{article}\usepackage{amsmath}\usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy}\usepackage{mathrsfs}\usepackage{pmc}\usepackage[Euler]{upgreek}\pagestyle{empty}\oddsidemargin -1.0in\begin{document}\begin{equation*}CV=\frac{1}{\sqrt{a}}\end{equation*}\end{document}</tex-math></disp-formula> A mean desired gamma order &#x00101; was selected, and the corresponding ISI coefficent of variation <tex-math id="M13">\documentclass[10pt]{article}\usepackage{amsmath}\usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy}\usepackage{mathrsfs}\usepackage{pmc}\usepackage[Euler]{upgreek}\pagestyle{empty}\oddsidemargin -1.0in\begin{document}\begin{equation*}\overline{CV}\end{equation*}\end{document}</tex-math> found. For a given trial, the ISI CV was selected from a normal distribution with mean <tex-math id="M14">\documentclass[10pt]{article}\usepackage{amsmath}\usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy}\usepackage{mathrsfs}\usepackage{pmc}\usepackage[Euler]{upgreek}\pagestyle{empty}\oddsidemargin -1.0in\begin{document}\begin{equation*}\overline{CV}\end{equation*}\end{document}</tex-math> and SD <italic>k</italic><tex-math id="M15">\documentclass[10pt]{article}\usepackage{amsmath}\usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy}\usepackage{mathrsfs}\usepackage{pmc}\usepackage[Euler]{upgreek}\pagestyle{empty}\oddsidemargin -1.0in\begin{document}\begin{equation*}\overline{CV}\end{equation*}\end{document}</tex-math>. This was then transformed back to a gamma process order, which was used to simulate data for that trial. The parameter <italic>k</italic> is the coefficient of variation of the ISI CV and was varied from 0.1 to 0.5.</p><p><xref ref-type="fig" rid="f9">Figure 9</xref>, <italic>C</italic> and <italic>D</italic> shows how the measured information is affected by trial-to-trial variability in regularity. Data are shown for simulations with either a low (order 2, <xref ref-type="fig" rid="f9">Fig. 9<italic>C</italic></xref>) or high (order 6, <xref ref-type="fig" rid="f9">Fig. 9<italic>D</italic></xref>) average regularity. Each line shows the results for a different rate profile; the abscissa of these plots is the parameter <italic>k</italic> referred to earlier. In all cases, the information estimate was robust to across-trial variation in spiking regularity.</p><p>So far, we have assumed that even if spiking regularity varies from trial to trial, it remains constant within a single trial. It has recently been shown, however, that regularity can modulate in a task-dependent manner (<xref ref-type="bibr" rid="r10">Davies et al. 2006</xref>). <xref ref-type="fig" rid="f9">Figure 9</xref>, <italic>E</italic> and <italic>F</italic> investigates the sensitivity of the method to regularity changes within the trial. In these simulations, the baseline period was generated with a gamma order of 2 (<xref ref-type="fig" rid="f9">Fig. 9<italic>E</italic></xref>) or 6 (<xref ref-type="fig" rid="f9">Fig. 9<italic>F</italic></xref>); the order during the rate step ranged from 1 to 16 in different simulations, but within a simulation did not vary from trial to trial. In all cases, information was estimated assuming that the order remained constant and equal to the baseline order throughout. Results for four rate profiles are shown. The measured information values increase monotonically as the response region becomes more regular.</p></sec><sec><title>Latency variability</title><p>To encode an event effectively, a cell must respond in a fixed way from trial to trial. <xref ref-type="fig" rid="f10">Figure 10</xref> examines how variability in the latency of response from trial to trial affects the information measure. Data were simulated with a 200-ms rate step, in which the response latency in each trial was chosen at random from a normal distribution. The different lines of <xref ref-type="fig" rid="f10">Fig. 10<italic>A</italic></xref> show results for different baseline and response rates; in all cases, the rate doubled in the response region. As expected, information decreases with increasing jitter; this is more pronounced for the high rate responses, which had higher information to begin with. The circle on each line represents the latency SD at which information had fallen to 50&#x00025; of the value with no latency jitter. A latency SD of 60 ms leads to at least a 50&#x00025; fall in information for all the rate steps tested.</p><p>One expectation of the method is that in cases with trial-to-trial latency variability, the peak in the single-trial shift probability distributions would be related to the response latency within the trial. <xref ref-type="fig" rid="f10">Figure 10<italic>B</italic></xref> shows a raster and PETH of a 20- to 40-Hz rate step with a latency SD of 50 ms.</p><p><xref ref-type="fig" rid="f10">Figure 10<italic>C</italic></xref> is a cluster plot of the actual response latency versus the maximum likelihood shift. There is substantial and significant (<italic>P</italic> &#x0003c; 0.01, shuffle test) correlation between the two. However, the variation in estimated shift was greater than that in actual response latency (SD 70 vs. 50 ms) and the slope of the regression line was smaller than unity (0.75). This is due to variations in spike timing, which means that spikes do not occur exactly at the moment of a rate change. Even with no trial-to-trial latency variation, maximum likelihood shifts show some dispersion (e.g., <xref ref-type="fig" rid="f4">Figs. 4<italic>H</italic></xref> and <xref ref-type="fig" rid="f12">12<italic>D</italic></xref>).</p><p>To explore this correlation further, rate steps of different amplitude (both increase and decrease) were simulated with a latency SD of 60 ms. The changes in correlation between estimated and actual response latencies are plotted versus the size of the response in <xref ref-type="fig" rid="f10">Fig. 10<italic>D</italic></xref>. As expected, if there is no response (value 1 on the abscissa) the <italic>r</italic><sup>2</sup> value is zero. As the difference between the baseline rate and the step rate increases, the <italic>r</italic><sup>2</sup> value increases.</p><p>One assumption made by our method in its current form is that the PETH is a reasonable estimate of the single-trial response of a neuron. Where there is considerable latency variability from trial to trial, the PETH will be smeared compared with the actual single-trial response. If the downstream decoder reading the neuron's discharge had knowledge of this single-trial response, it could obtain more information about event timing from the cell than would be estimated by our algorithm. Such differences, however, are likely to be small; for example, for the situation illustrated in <xref ref-type="fig" rid="f10">Fig. 10<italic>B</italic></xref>, the information estimate assuming the actual single-trial response is 1.14 bits, compared with 1.03 bits when using the PETH. Estimating the true single-trial response profile would be a complex procedure for a downstream decoder and it is by no means certain that the higher information value given by making this assumption is more valid than assuming that the trial-averaged response is representative.</p></sec><sec><title>Experimental data</title><p><xref ref-type="fig" rid="f11">Figure 11</xref> shows the results of the method applied to two real neurons recorded from the supplementary motor area (SMA) of a monkey performing a precision grip task with the hand contralateral to the recording site. Full details of the task are given in previous publications (<xref ref-type="bibr" rid="r28">Soteropoulos and Baker 2006</xref>, <xref ref-type="bibr" rid="r29">2007</xref>). Briefly, the animal held both hands on home pad switches. A &#x0201c;go cue&#x0201d; signaled that a movement should be made. The animal then lifted one hand from the home pad (the &#x0201c;reach&#x0201d; event) and gripped the levers of a precision grip manipulandum between finger and thumb (the &#x0201c;squeeze&#x0201d; event, indicating first lever movement). Following a hold period, the levers were released to obtain a reward.</p><p>This task is an interesting one in the present context because three very different events (go cue, reach, and squeeze) occur in close temporal proximity. This is illustrated in <xref ref-type="fig" rid="f11">Fig. 11<italic>A</italic></xref>, which presents histograms of two events compiled relative to the third. A neuron that modulates its firing relative to one of these events will necessarily also do so relative to the other two. It is therefore difficult to determine which event the cell is actually encoding.</p><p>The neuron shown in <xref ref-type="fig" rid="f11">Fig. 11<italic>B</italic></xref> had a robust modulation in activity around all three events, as judged from the PETH and raster displays. <xref ref-type="fig" rid="f11">Figure 11<italic>C</italic></xref> plots the single trial and mean shift probability distributions for each event. In each case, there was a clear peak at zero shift, although this was visibly narrower when aligned to the squeeze event. Calculation of the information yielded values of 1.8, 2.27, and 2.87 bits relative to go cue, reach, and squeeze events, respectively. This cell therefore seems best related to the lever squeeze. In this case, the baseline firing rate and response amplitude are the same for each response (they are compiled from the same spikes, but merely aligned to different events). The larger information value for the squeeze event can therefore be interpreted unambiguously as activity being better time-locked to that event than to the others.</p><p>The neuron illustrated in <xref ref-type="fig" rid="f11">Fig. 11<italic>D</italic></xref> was recorded simultaneously with that in <xref ref-type="fig" rid="f11">Fig. 11<italic>B</italic></xref>, but had a much smaller rate modulation. The greatest rate occurred in the PETH aligned to the squeeze event, although there was considerable variability. The event information analysis (<xref ref-type="fig" rid="f11">Fig. 11<italic>E</italic></xref>) produced low information values for all three events, indicating that this cell did not encode event occurrence with high fidelity.</p></sec><sec><title>Application to estimation of latency jitter</title><p>A further use for the present method is presented in <xref ref-type="fig" rid="f12">Fig. 12</xref>. A 200-ms-long rate step from 40 to 80 Hz was simulated, with latency jitter of 100 ms SD (normal distribution). Raster and PETH displays for these data are presented in <xref ref-type="fig" rid="f12">Fig. 12<italic>A</italic></xref>. Because of the latency jitter, the PETH no longer represented the step change in rate present on single trials, but was smeared. <xref ref-type="fig" rid="f12">Figure 12<italic>B</italic></xref> shows data simulated with no latency jitter, but with an underlying single-trial rate profile similar to the PETH of <xref ref-type="fig" rid="f12">Fig. 12<italic>A</italic></xref>. These data sets are indistinguishable on the basis of their PETHs. However, in one the PETH is an accurate representation of the single-trial response; in the other, the unit varies its response from trial to trial. The shift likelihood distribution was substantially more peaked for the cell with constant response than for the cell with jitter (<xref ref-type="fig" rid="f12">Fig. 12</xref>, <italic>C</italic> and <italic>D</italic>); this resulted in a larger information value for the reliable neuron. The simulation and analysis of <xref ref-type="fig" rid="f12">Fig. 12</xref>, <italic>B</italic> and <italic>D</italic> were repeated 50 times. <xref ref-type="fig" rid="f12">Figure 12<italic>E</italic></xref> presents a histogram of the information measured from these simulations (mean: 1.05 bits) where there was no latency jitter, allowing comparison of the information with that determined from the data of <xref ref-type="fig" rid="f12">Fig. 12</xref>, <italic>A</italic> and <italic>C</italic> (dotted line in <xref ref-type="fig" rid="f12">Fig. 12<italic>E</italic></xref>). The cell shown in <xref ref-type="fig" rid="f12">Fig. 12</xref>, <italic>A</italic> and <italic>C</italic> had consistently smaller information values and coded for 47&#x00025; of the information that could have been coded if there was not trial-to-trial variability.</p><p>The procedure followed in <xref ref-type="fig" rid="f12">Fig. 12</xref> could be applied to experimental data: the information obtained from a simulation based on the experimentally derived PETH can be compared with the information measured directly from the experimental spike train. Any mismatch will determine whether trial-by-trial response variability occurs and, if so, quantify how great this is. This is demonstrated in <xref ref-type="fig" rid="f13">Fig. 13</xref> for the example cell shown in <xref ref-type="fig" rid="f11">Fig. 11<italic>B</italic></xref>. <xref ref-type="fig" rid="f13">Figure 13<italic>A</italic></xref> is the raster and PETH plot of the cell aligned to squeeze, whereas <xref ref-type="fig" rid="f13">Fig. 13<italic>B</italic></xref> is a similar display for the neuron simulated to have the same PETH. <xref ref-type="fig" rid="f13">Figure 13</xref>, <italic>C</italic> and <italic>D</italic> shows the shift likelihood distributions for the real (<xref ref-type="fig" rid="f13">Fig. 13<italic>C</italic></xref>) and simulated spike trains (<xref ref-type="fig" rid="f13">Fig. 13<italic>D</italic></xref>). The shift likelihood distributions are much narrower and better aligned for the simulated neuron, giving it an <italic>I</italic><sub>r</sub> value of 3.97 bits, compared with 2.87 for the real cell. <xref ref-type="fig" rid="f13">Figure 13<italic>E</italic></xref> presents a histogram of the <italic>I</italic><sub>r</sub> values from 100 simulations, in which the mean <italic>I</italic><sub>r</sub> was 3.93 bits. We can therefore conclude that although the experimentally recorded cell did code the occurrence of the squeeze event well, trial-to-trial variability in its response meant that it coded for only 73&#x00025; of the information that could have been coded if its response had been consistent.</p></sec></sec><sec sec-type="discussion"><title>DISCUSSION</title><p>In this study, we have introduced a novel approach to spike train analysis. When recording from a single neuron, the experimenter has precise knowledge of the timing of external events such as stimulus delivery or task performance. These well-defined events are often used to align neural data such as in the PETH. The present work, by contrast, views the behavioral event as uncertain in its timing and quantifies how accurately its occurrence could be determined from the spike train. This probably matches better the perspective of downstream neurons, whose only information about external events comes from the spike trains they receive.</p><sec><title>Methodological considerations</title><p>As with any information-theoretic measure, the basic analysis of <xref ref-type="fig" rid="f1">Fig. 1</xref> yields information values that are upwardly biased (<xref ref-type="fig" rid="f7">Fig. 7</xref>). We propose a shuffle-based technique to correct for this bias and to determine whether the measured information is greater than that expected by chance (<xref ref-type="fig" rid="f5">Fig. 5</xref>). In more conventional stimulus&#x02013;response paradigms, shuffle correction has been shown to be an inappropriate means of correcting for bias due to limited data sampling (<xref ref-type="bibr" rid="r23">Treves and Panzeri 1996</xref>), since it alters the number of empty bins in response frequency histograms. However, in the present situation, the shift likelihood distribution is used to calculate the posterior entropy. Although limited data sampling can lead to spurious peaks in the shift likelihood distribution, this is effectively measured using a shuffle approach. The shuffle correction for information bias is thus likely to be accurate in this case.</p><p>The significance estimation consumes substantial processing time: for a peristimulus time histogram of 1,000-ms duration, 50 trials and max &#x003b4;&#x003c4; of 300 ms, the shuffling approach took on average 1.6 h (100 shuffles) on a PC with a 2-GHz Centrino Processor with 1-GB RAM, whereas for 20 trials the time taken was 0.7 h (100 shuffles). We expect that with increasing processor speeds, estimation of the significance using shuffling will become less time consuming and thus not be a substantial barrier to use of this technique.</p><p>To explore the behavior of this method, we have used simulated data whose properties are known. The simulations used a simple step change in rate throughout, since this was completely defined by two variables: the duration and amplitude of the step. Although real neuronal responses are far more complicated, the trends observed from rate steps should be generally applicable to more complex response profiles. If anything, responses with more complex profiles will penalize misalignment between a single-trial spike train and the PETH, resulting in a more sharply peaked shift likelihood distribution and a higher information value.</p><p>The method as presented herein represents neural spike generation as a gamma process. This is a better model than the simpler Poisson process because it allows for a refractory period and can match well the ISI histograms of real neurons (<xref ref-type="bibr" rid="r3">Baker and Lemon 2000</xref>; <xref ref-type="bibr" rid="r30">Stein 1965</xref>). An important assumption is that successive ISIs are independent (as with all stochastic point processes). Real neurons often exhibit serial correlation in their ISIs, but this is usually generated mainly by the effects of rate modulation. Thus short intervals are most likely to be followed by short intervals because they will probably be drawn from a region of high firing rate. It is unclear whether experimental data exhibit serial ISI correlations if the effects of rate modulation are corrected for (<xref ref-type="bibr" rid="r10">Davies et al. 2006</xref>).</p><p>There is no reason why the present method should be restricted to situations where a gamma distribution appropriately models experimentally observed ISIs. Other studies have made use of different distribution functions (e.g., Weibul distribution, Rayleigh, beta, lognormal) with success. A particular instance where a simple gamma distribution may be inappropriate is where experimental ISIs are bimodally distributed (<xref ref-type="bibr" rid="r6">Bhumbra and Dyball 2004</xref>). So long as an appropriate model can be formed that generates a likelihood of observing a given spike train at a particular underlying firing rate profile, information about event encoding can be calculated.</p><p><xref ref-type="fig" rid="f8">Figures 8</xref>, <xref ref-type="fig" rid="f9">9</xref>, and <xref ref-type="fig" rid="f10">10</xref> show that the information measured is affected by several variables such as response amplitude and order as well as by nonstationarities in the data. This is not necessarily a disadvantage. The method provides an estimate of information carried about event timing, on the assumption that the &#x0201c;decoder&#x0201d; believes the average neural response to match the observed PETH. Since the PETH is, by definition, that part of the neural response that occurs reliably relative to the event in question, this is a reasonable baseline assumption. If there is some a priori reason to assume a more complex decoding scheme, that could probably be incorporated into the method for information estimation. However, in the absence of this, it is not unreasonable that the method should return lower values of information, corresponding to less efficient coding of an event, if a cell varies its response from trial to trial.</p></sec><sec><title>Importance of trial-to-trial variability</title><p>Neuronal variability is an understudied topic, but it is important because the brain must carry out processing accurately on a single trial. A PETH gives only the mean response of a neuron; it does not represent how reliable that response is. An implicit assumption of many studies is that the brain averages over many neurons with similar responses in a single trial, in the same way that the PETH averages over one neuron across many trials. However, because response variation is often correlated between cells from trial to trial (<xref ref-type="bibr" rid="r4">Baker et al. 2001</xref>), these two situations are not comparable (<xref ref-type="bibr" rid="r19">Lee et al. 1998</xref>; <xref ref-type="bibr" rid="r27">Shadlen and Newsome 1998</xref>).</p><p>The method we describe has many possible applications. Most important, it conflates many different variables that might affect how well a cell can encode event timing into a single, principled summary measure, in defined units (bits). This can be used to determine which event is best encoded by a cell (<xref ref-type="fig" rid="f11">Fig. 11</xref>) or whether the fidelity of event encoding changes from one condition to another (e.g., as a result of learning). It also allows objective comparisons to be made between different units. Because it is expressed in bits, the information encoded about event timing can be directly compared with the information encoded about other possible features, such as the type of stimulus or the nature of the behavioral response. In a recent paper, <xref ref-type="bibr" rid="r1a">Arabzadeh et al. (2006)</xref> presented a method for estimating the information provided by the neural spike train regarding the type of stimulus at different times relative to stimulus onset. The authors also explored how uncertainty in the stimulus time would affect the information regarding stimulus identity; not surprisingly, as the temporal resolution of stimulus time decreases so does the information regarding stimulus identity. The method presented here allows an estimation of this uncertainty; using this estimate and using the method proposed by <xref ref-type="bibr" rid="r1a">Arabzadeh et al. (2006)</xref>, it might become feasible to estimate how much information is actually available about which stimulus (or event) occurred. This is just one example of where our paradigm could be integrated with previous formalism.</p><p>In most situations, the present method is not suited to extract specific parameters of the neural response from the spike trains. Response amplitude and latency are best measured from a PETH; response variability can be measured by other techniques (e.g., Fano factor). As such, our method forms a useful complement to existing techniques, not a substitute for them. However, using the technique described in <xref ref-type="fig" rid="f12">Figs. 12</xref> and <xref ref-type="fig" rid="f13">13</xref>, it is possible to estimate how much the encoded information was degraded by response latency variation. This could be a useful way of measuring response variability because it expresses the measurement on a functionally meaningful scale (i.e., the consequences of this variation for impaired downstream decoding).</p><p>As multiple neuron recordings are becoming more common, the method presented here could also allow probing of the impact of neuronal variability at the population level. A population of neurons would allow a better estimate for the occurrence time of an event than a single neuron. To apply this method to simultaneous recordings, the shift likelihood distributions for the same trial across neurons should first be multiplied and then averaged across trials to give the mean shift likelihood distribution. In some preliminary simulations, we found that as the number of neurons increases so does the information, but correlation between the neurons limits the information increase. Further discussion of this potential extension to the method, however, are beyond the scope of this study.</p></sec></sec><sec><title>GRANTS</title><p>This work was supported by The Wellcome Trust. D. Soteropoulos was also funded by the Wingate Foundation, the Leventis Foundation, the Cambridge Commonwealth Trust, and Christ's College, Cambridge.</p></sec></body><back><ref-list><title>REFERENCES</title><ref id="r1"><label>Andolina et al. 2007</label><mixed-citation publication-type="journal"><name><surname>Andolina</surname><given-names>IM</given-names></name>, Jones HE, Wang W, Sillito AM. Corticothalamic feedback enhances stimulus response precision in the visual system. <source>Proc Natl Acad Sci USA</source><volume>104</volume>: <fpage>1685</fpage>&#x02013;1690, <year>2007</year>.<pub-id pub-id-type="pmid">17237220</pub-id></mixed-citation></ref><ref id="r1a"><label>Arabzadeh et al. 2006</label><mixed-citation publication-type="journal"><name><surname>Arabzadeh</surname><given-names>E</given-names></name>, Panzeri S, Diamond ME. Deciphering the spike train of a sensory neuron counts and temporal patterns in the rat whisker pathway. <source>J Neurosci</source><volume>26</volume>: <fpage>9216</fpage>&#x02013;9226, <year>2006</year>.<pub-id pub-id-type="pmid">16957078</pub-id></mixed-citation></ref><ref id="r2"><label>Baker and Gerstein 2001</label><mixed-citation publication-type="journal"><name><surname>Baker</surname><given-names>SN</given-names></name>, Gerstein GL. Determination of response latency and its application to normalization of cross-correlation measures. <source>Neural Comput</source><volume>13</volume>: <fpage>1351</fpage>&#x02013;1377, <year>2001</year>.<pub-id pub-id-type="pmid">11387049</pub-id></mixed-citation></ref><ref id="r3"><label>Baker and Lemon 2000</label><mixed-citation publication-type="journal"><name><surname>Baker</surname><given-names>SN</given-names></name>, Lemon RN. Precise spatiotemporal repeating patterns in monkey primary and supplementary motor areas occur at chance levels. <source>J Neurophysiol</source><volume>84</volume>: <fpage>1770</fpage>&#x02013;1780, <year>2000</year>.<pub-id pub-id-type="pmid">11024069</pub-id></mixed-citation></ref><ref id="r4"><label>Baker et al. 2001</label><mixed-citation publication-type="journal"><name><surname>Baker</surname><given-names>SN</given-names></name>, Spinks R, Jackson A, Lemon RN. Synchronization in monkey motor cortex during a precision grip task. I. Task-dependent modulation in single-unit synchrony. <source>J Neurophysiol</source><volume>85</volume>: <fpage>869</fpage>&#x02013;885, <year>2001</year>.<pub-id pub-id-type="pmid">11160519</pub-id></mixed-citation></ref><ref id="r5"><label>Barbieri et al. 2001</label><mixed-citation publication-type="journal"><name><surname>Barbieri</surname><given-names>R</given-names></name>, Quirk MC, Frank LM, Wilson MA, Brown EN. Construction and analysis of non-Poisson stimulus-response models of neural spiking activity. <source>J Neurosci Methods</source><volume>105</volume>: <fpage>25</fpage>&#x02013;37, <year>2001</year>.<pub-id pub-id-type="pmid">11166363</pub-id></mixed-citation></ref><ref id="r6"><label>Bhumbra and Dyball 2004</label><mixed-citation publication-type="journal"><name><surname>Bhumbra</surname><given-names>GS</given-names></name>, Dyball RE. Measuring spike coding in the rat supraoptic nucleus. <source>J Physiol</source><volume>555</volume>: <fpage>281</fpage>&#x02013;296, <year>2004</year>.<pub-id pub-id-type="pmid">14608010</pub-id></mixed-citation></ref><ref id="r7"><label>Brody 1998</label><mixed-citation publication-type="journal"><name><surname>Brody</surname><given-names>CD</given-names></name> Slow covariations in neuronal resting potentials can lead to artefactually fast cross-correlations in their spike trains. <source>J Neurophysiol</source><volume>80</volume>: <fpage>3345</fpage>&#x02013;3351, <year>1998</year>.<pub-id pub-id-type="pmid">9862930</pub-id></mixed-citation></ref><ref id="r8"><label>Brody 1999</label><mixed-citation publication-type="journal"><name><surname>Brody</surname><given-names>CD</given-names></name> Correlations without synchrony. <source>Neural Comput</source><volume>11</volume>: <fpage>1537</fpage>&#x02013;1551, <year>1999</year>.<pub-id pub-id-type="pmid">10490937</pub-id></mixed-citation></ref><ref id="r9"><label>Croner et al. 1993</label><mixed-citation publication-type="journal"><name><surname>Croner</surname><given-names>LJ</given-names></name>, Purpura K, Kaplan E. Response variability in retinal ganglion cells of primates. <source>Proc Natl Acad Sci USA</source><volume>90</volume>: <fpage>8128</fpage>&#x02013;8130, <year>1993</year>.<pub-id pub-id-type="pmid">8367474</pub-id></mixed-citation></ref><ref id="r10"><label>Davies et al. 2006</label><mixed-citation publication-type="journal"><name><surname>Davies</surname><given-names>RM</given-names></name>, Gerstein GL, Baker SN. Measurement of time-dependent changes in the irregularity of neural spiking. <source>J Neurophysiol</source><volume>96</volume>: <fpage>906</fpage>&#x02013;918, <year>2006</year>.<pub-id pub-id-type="pmid">16554511</pub-id></mixed-citation></ref><ref id="r11"><label>DiCarlo and Maunsell 2005</label><mixed-citation publication-type="journal"><name><surname>DiCarlo</surname><given-names>JJ</given-names></name>, Maunsell JH. Using neuronal latency to determine sensory-motor processing pathways in reaction time tasks. <source>J Neurophysiol</source><volume>93</volume>: <fpage>2974</fpage>&#x02013;2986, <year>2005</year>.<pub-id pub-id-type="pmid">15548629</pub-id></mixed-citation></ref><ref id="r12"><label>Fortier et al. 1993</label><mixed-citation publication-type="journal"><name><surname>Fortier</surname><given-names>PA</given-names></name>, Smith AM, Kalaska JF. Comparison of cerebellar and motor cortex activity during reaching: directional tuning and response variability. <source>J Neurophysiol</source><volume>69</volume>: <fpage>1136</fpage>&#x02013;1149, <year>1993</year>.<pub-id pub-id-type="pmid">8492153</pub-id></mixed-citation></ref><ref id="r13"><label>Gerstein 2004</label><mixed-citation publication-type="journal"><name><surname>Gerstein</surname><given-names>GL</given-names></name> Searching for significance in spatio-temporal firing patterns. <source>Acta Neurobiol Exp (Warsz)</source><volume>64</volume>: <fpage>203</fpage>&#x02013;207, <year>2004</year>.<pub-id pub-id-type="pmid">15366253</pub-id></mixed-citation></ref><ref id="r14"><label>Gerstein and Kiang 1960</label><mixed-citation publication-type="journal"><name><surname>Gerstein</surname><given-names>GL</given-names></name>, Kiang NYS. An approach to the quantitative analysis of electrophysiological data from single neurons. <source>Biophys J</source><volume>1</volume>: <fpage>15</fpage>&#x02013;28, <year>1960</year>.<pub-id pub-id-type="pmid">13704760</pub-id></mixed-citation></ref><ref id="r15"><label>Grun et al. 2003</label><mixed-citation publication-type="journal"><name><surname>Grun</surname><given-names>S</given-names></name>, Riehle A, Diesmann M. Effect of cross-trial nonstationarity on joint-spike events. <source>Biol Cybern</source><volume>88</volume>: <fpage>335</fpage>&#x02013;351, <year>2003</year>.<pub-id pub-id-type="pmid">12750896</pub-id></mixed-citation></ref><ref id="r16"><label>Gur and Snodderly 2006</label><mixed-citation publication-type="journal"><name><surname>Gur</surname><given-names>M</given-names></name>, Snodderly DM. High response reliability of neurons in primary visual cortex (V1) of alert, trained monkeys. <source>Cereb Cortex</source><volume>16</volume>: <fpage>888</fpage>&#x02013;895, <year>2006</year>.<pub-id pub-id-type="pmid">16151177</pub-id></mixed-citation></ref><ref id="r17"><label>Kara et al. 2000</label><mixed-citation publication-type="journal"><name><surname>Kara</surname><given-names>P</given-names></name>, Reinagel P, Reid RC. Low response variability in simultaneously recorded retinal, thalamic, and cortical neurons. <source>Neuron</source><volume>27</volume>: <fpage>635</fpage>&#x02013;646, <year>2000</year>.<pub-id pub-id-type="pmid">11055444</pub-id></mixed-citation></ref><ref id="r18"><label>Kass and Ventura 2001</label><mixed-citation publication-type="journal"><name><surname>Kass</surname><given-names>RE</given-names></name>, Ventura V. A spike-train probability model. <source>Neural Comput</source><volume>13</volume>: <fpage>1713</fpage>&#x02013;1720, <year>2001</year>.<pub-id pub-id-type="pmid">11506667</pub-id></mixed-citation></ref><ref id="r19"><label>Lee et al. 1998</label><mixed-citation publication-type="journal"><name><surname>Lee</surname><given-names>D</given-names></name>, Port NL, Kruse W, Georgopoulos AP. Variability and correlated noise in the discharge of neurons in motor and parietal areas of the primate cortex. <source>J Neurosci</source><volume>18</volume>: <fpage>1161</fpage>&#x02013;1170, <year>1998</year>.<pub-id pub-id-type="pmid">9437036</pub-id></mixed-citation></ref><ref id="r20"><label>Matthews 1996</label><mixed-citation publication-type="journal"><name><surname>Matthews</surname><given-names>PBC</given-names></name> Relationship of firing intervals of human motor units to the trajectory of post-spike after-hyperpolarization and synaptic noise. <source>J Physiol</source><volume>492</volume>: <fpage>597</fpage>&#x02013;628, <year>1996</year>.<pub-id pub-id-type="pmid">9019553</pub-id></mixed-citation></ref><ref id="r21"><label>Nawrot et al. 1999</label><mixed-citation publication-type="journal"><name><surname>Nawrot</surname><given-names>M</given-names></name>, Aertsen A, Rotter S. Single-trial estimation of neuronal firing rates: from single-neuron spike trains to population activity. <source>J Neurosci Methods</source><volume>94</volume>: <fpage>81</fpage>&#x02013;92, <year>1999</year>.<pub-id pub-id-type="pmid">10638817</pub-id></mixed-citation></ref><ref id="r22"><label>Nawrot et al. 2003</label><mixed-citation publication-type="journal"><name><surname>Nawrot</surname><given-names>MP</given-names></name>, Aertsen A, Rotter S. Elimination of response latency variability in neuronal spike trains. <source>Biol Cybern</source><volume>88</volume>: <fpage>321</fpage>&#x02013;334, <year>2003</year>.<pub-id pub-id-type="pmid">12750895</pub-id></mixed-citation></ref><ref id="r23"><label>Panzeri and Treves 1996</label><mixed-citation publication-type="journal"><name><surname>Panzeri</surname><given-names>S</given-names></name>, Treves A. Analytical estimates of limited sampling biases in different information measures. <source>Network Comp Neural</source><volume>7</volume>: <fpage>87</fpage>&#x02013;107, <year>1996</year>.</mixed-citation></ref><ref id="r24"><label>Pauluis and Baker 1999</label><mixed-citation publication-type="journal"><name><surname>Pauluis</surname><given-names>Q</given-names></name>, Baker SN. An accurate measure of the instantaneous discharge probability, with application to unitary joint-event analysis. <source>Neural Comput</source><volume>12</volume>: <fpage>647</fpage>&#x02013;669, <year>1999</year>.<pub-id pub-id-type="pmid">10769325</pub-id></mixed-citation></ref><ref id="r25"><label>Richmond et al. 1987</label><mixed-citation publication-type="journal"><name><surname>Richmond</surname><given-names>BJ</given-names></name>, Optican LM, Podell M, Spitzer H. Temporal encoding of two-dimensional patterns by single units in primate inferior temporal cortex. I. Response characteristics. <source>J Neurophysiol</source><volume>57</volume>: <fpage>132</fpage>&#x02013;146, <year>1987</year>.<pub-id pub-id-type="pmid">3559668</pub-id></mixed-citation></ref><ref id="r26"><label>Schwartz 1992</label><mixed-citation publication-type="journal"><name><surname>Schwartz</surname><given-names>AB</given-names></name> Motor cortical activity during drawing movements: single-unit activity during sinusoid tracing. <source>J Neurophysiol</source><volume>68</volume>: <fpage>528</fpage>&#x02013;541, <year>1992</year>.<pub-id pub-id-type="pmid">1527573</pub-id></mixed-citation></ref><ref id="r27"><label>Shadlen and Newsome 1998</label><mixed-citation publication-type="journal"><name><surname>Shadlen</surname><given-names>MN</given-names></name>, Newsome WT. The variable discharge of cortical neurons: implications for connectivity, computation, and information coding. <source>J Neurosci</source><volume>18</volume>: <fpage>3870</fpage>&#x02013;3896, <year>1998</year>.<pub-id pub-id-type="pmid">9570816</pub-id></mixed-citation></ref><ref id="r28"><label>Soteropoulos and Baker 2006</label><mixed-citation publication-type="journal"><name><surname>Soteropoulos</surname><given-names>DS</given-names></name>, Baker SN. Cortico-cerebellar coherence during a precision grip task in the monkey. <source>J Neurophysiol</source><volume>95</volume>: <fpage>1194</fpage>&#x02013;1206, <year>2006</year>.<pub-id pub-id-type="pmid">16424458</pub-id></mixed-citation></ref><ref id="r29"><label>Soteropoulos and Baker 2007</label><mixed-citation publication-type="journal"><name><surname>Soteropoulos</surname><given-names>DS</given-names></name>, Baker SN. Different contributions of the corpus callosum and cerebellum to motor coordination in monkey. <source>J Neurophysiol</source><volume>98</volume>: <fpage>2962</fpage>&#x02013;2973, <year>2007</year>.<pub-id pub-id-type="pmid">17715202</pub-id></mixed-citation></ref><ref id="r30"><label>Stein 1965</label><mixed-citation publication-type="journal"><name><surname>Stein</surname><given-names>RB</given-names></name> A theoretical analysis of neuronal variability. <source>Biophys J</source><volume>5</volume>: <fpage>173</fpage>&#x02013;194, <year>1965</year>.<pub-id pub-id-type="pmid">14268952</pub-id></mixed-citation></ref><ref id="r31"><label>Tolhurst et al. 1983</label><mixed-citation publication-type="journal"><name><surname>Tolhurst</surname><given-names>DJ</given-names></name>, Movshon JA, Dean AF. The statistical reliability of signals in single neurons in cat and monkey visual cortex. <source>Vision Res</source><volume>23</volume>: <fpage>775</fpage>&#x02013;785, <year>1983</year>.<pub-id pub-id-type="pmid">6623937</pub-id></mixed-citation></ref><ref id="r32"><label>Tuckwell 1988</label><mixed-citation publication-type="other"><name><surname>Tuckwell</surname><given-names>HC</given-names></name><source>Introduction to Theoretical Neurobiology.</source> Cambridge, UK: Cambridge Univ. Press, vol. 2, <year>1988</year>.</mixed-citation></ref><ref id="r33"><label>Vogel et al. 2005</label><mixed-citation publication-type="journal"><name><surname>Vogel</surname><given-names>A</given-names></name>, Hennig RM, Ronacher B. Increase of neuronal response variability at higher processing levels as revealed by simultaneous recordings. <source>J Neurophysiol</source><volume>93</volume>: <fpage>3548</fpage>&#x02013;3559, <year>2005</year>.<pub-id pub-id-type="pmid">15716366</pub-id></mixed-citation></ref></ref-list></back><floats-group><fig position="float" id="f1"><label>FIG. 1.</label><caption><p>Schematic of analysis method concept. <italic>A</italic>: raster plot (100 trials) and perievent time histogram (PETH) of a simulated spike train. <italic>B</italic>: PETH for 3 different shifts relative to spike train of first trial. <italic>C</italic>: shift likelihood distribution for the spike train shown in <italic>B. D</italic>: superimposed shift likelihood distributions for all trials, with the averaged shift likelihood distribution (gray line).</p></caption><graphic xlink:href="z9k0010992710001"/></fig><fig position="float" id="f2"><label>FIG. 2.</label><caption><p>Schematic for spike density likelihood method (Poisson). <italic>A</italic>: smoothed PETH of simulated data with rate step from 20 to 60 Hz. The PETH is also the spike density function (right-hand ordinate axis). Vertical dashed gray lines indicate the time of spikes for the first trial. <italic>B</italic>: probability plot of spike train for trial 1, given spike density in <italic>A</italic> and &#x003b4;&#x003c4; of 0 ms. <italic>C</italic>: shift likelihood distribution for spike train in <italic>B. D</italic>: superimposed shift likelihood distributions for all trials, with the averaged shift likelihood distribution (gray line).</p></caption><graphic xlink:href="z9k0010992710002"/></fig><fig position="float" id="f3"><label>FIG. 3.</label><caption><p>Schematic for interspike interval (ISI) likelihood method. <italic>A</italic>: shifted PETH (&#x003b4;&#x003c4;: &#x02212;100 ms, rate step 20 to 60 Hz). Vertical dashed gray lines indicate the time of spikes for the first trial. Dark horizontal lines are the mean rate for the duration of the ISI. <italic>B</italic>: same as <italic>A</italic> but with no shift in the PETH. <italic>C</italic>: same as <italic>A</italic> but PETH shifted 100 ms in opposite direction (&#x003b4;&#x003c4;: 100 ms). Note that for shifted PETHs in <italic>A</italic> and <italic>B</italic> the mean rates corresponding to short ISIs are low. <italic>D</italic>: ISI distribution with a mean rate corresponding to the mean rate of ISI no.7 (18 Hz) for the PETH in <italic>A</italic>. Arrow indicated the probability of observing a 7-ms ISI from this distribution. <italic>E</italic>: same as <italic>D</italic> but distribution mean rate is that corresponding to ISI no. 7 from unshifted PETH shown in <italic>B. F</italic>: same as <italic>E</italic> but distribution mean rate is that corresponding to ISI no. 7 from shifted PETH shown in <italic>C</italic>. Under each distribution the probability of seeing a 7-ms ISI is shown. <italic>G</italic>: shift likelihood distribution for spike train in <italic>A</italic>&#x02013;<italic>C. H</italic>: superimposed shift likelihood distributions for all trials, with the averaged shift likelihood distribution (gray line).</p></caption><graphic xlink:href="z9k0010992710003"/></fig><fig position="float" id="f4"><label>FIG. 4.</label><caption><p>Schematic for spike density likelihood method (gamma). <italic>A</italic>: example ISI distributions for 3 different rates, with gamma order 4. <italic>B</italic>: inverse cumulative probability (survival) for ISI distributions shown in <italic>A. C</italic>: death rate for distributions shown in <italic>A</italic>. These are formed by dividing the distributions in <italic>A</italic> by those in <italic>B</italic>. The markers on each line show the mean ISI value in each case. <italic>D</italic>: death rate plots like those in <italic>C</italic>, with the abscissa rescaled as integral of the rate. <italic>E</italic>: like <italic>D</italic>, but death rates are rescaled by dividing by the mean spike density of the ISI distributions shown in <italic>A. F</italic>: scaled death rate plots for different orders of the gamma distribution. Key in <italic>A</italic> applies to <italic>A</italic>&#x02013;<italic>F. G1</italic>: spike density for shifted PETH (&#x003b4;&#x003c4;: 100 ms). <italic>G2</italic>: spike density integral for each time bin (1-ms width). <italic>G3</italic>: probability of spiking at each time bin. <italic>G4</italic>: probability of observation (spike or no spike) for each time bin. The product of all bins in <italic>G4</italic> will form the likelihood at the specific &#x003b4;&#x003c4; for this trial. <italic>H</italic>: like <italic>G</italic> but for &#x003b4;&#x003c4; &#x0003d; 0 ms. <italic>I</italic>: like <italic>G</italic> but &#x003b4;&#x003c4; &#x0003d; &#x02212;100 ms. The gray shading in <italic>G3, H3</italic>, and <italic>I3</italic> draws attention to the response region in the spike train. For the nonzero &#x003b4;&#x003c4;, the probability of spiking is much smaller during this region. The spike train for this trial is shown under <italic>G4, H4</italic>, and <italic>I4</italic>.</p></caption><graphic xlink:href="z9k0010992710004"/></fig><fig position="float" id="f5"><label>FIG. 5.</label><caption><p>Bias estimation. <italic>A</italic>: raster plot of neuron activity. <italic>B</italic>: raster plot of neuron shown in <italic>A</italic> after random shuffling of the ISIs. <italic>C</italic>: single trial and mean shift likelihood distributions for shuffled data. <italic>D</italic>: distribution of information values calculated from 100 random shuffles. The dotted line shows the information value calculated from the original raster plot in <italic>A</italic>.</p></caption><graphic xlink:href="z9k0010992710005"/></fig><fig position="float" id="f6"><label>FIG. 6.</label><caption><p>Comparison between methods. <italic>A</italic>: raw information values from the 3 different methods for estimating spike train likelihood, for different orders of gamma process. For each point on the abscissa the same spike train (20- to 60-Hz rate step) was used as input to each method. <italic>B</italic>: raster and PETH with oscillatory activity. <italic>C</italic>: shift likelihood distributions for <italic>B</italic> by using the spike density likelihood method (gamma). The mean of the distributions is shown in gray. <italic>D</italic>: same as <italic>C</italic> but using the ISI likelihood method. <italic>E</italic>: bias in the nonzero raw information estimate <italic>I</italic><sub>r</sub>, calculated using the spike density likelihood (gamma) method (black line) and the ISI method (dotted line) for PETHs with different baseline rates with no rate step. Value of <italic>n</italic> given in ordinate labels in <italic>A</italic> and <italic>E</italic> shows that values are the mean over this number of simulations. This convention will be maintained for all other figures.</p></caption><graphic xlink:href="z9k0010992710006"/></fig><fig position="float" id="f7"><label>FIG. 7.</label><caption><p>Effect of smoothing, order, trial number, and rate on bias. <italic>A</italic>: effect of smoothing on PETHs (with no rate step), measured at 3 different baseline firing rates, for 10 trials per simulation. The horizontal dotted line represents the maximum of the ordinate axis in <italic>B</italic>. A Gaussian kernel of unit area was used for smoothing with different SDs, shown on the abscissa. Each point is the average of 10 simulations. <italic>B</italic>: like <italic>A</italic> but 50 trials were used. The dotted line represents the size of the ordinate axis in <italic>C. C</italic>: like <italic>B</italic> but 100 trials were used. <italic>D</italic>: effect of noise, quantified by coefficient of variation (CV) on the bias, for 4 different basal rates. <italic>E</italic>: effect of spiking regularity on bias for different baseline rates. Ten trials per PETH used. <italic>F</italic>: like <italic>E</italic> but 50 trials per PETH used. <italic>G</italic>: like <italic>E</italic> but 100 trials per PETH used. Key for <italic>A</italic> applies to <italic>A</italic>&#x02013;<italic>C</italic> and <italic>E</italic>&#x02013;<italic>G</italic>.</p></caption><graphic xlink:href="z9k0010992710007"/></fig><fig position="float" id="f8"><label>FIG. 8.</label><caption><p>Influence of different response parameters on information values. <italic>A</italic>: effect of smoothing kernel width on the <italic>I</italic><sub>r</sub> value. Response rate was double baseline in all cases. <italic>B</italic>: effect of different maximum shifts on the entropy of the prior and posterior shift distributions, using simulated data with different rates in the baseline and response regions. <italic>C</italic>: effect of response size. Abscissa shows the ratio of the response rate to the baseline rate. Circles mark points corresponding to a rate increase of 30 Hz above baseline. <italic>D</italic>: effect of trial-to-trial variations in the response size for different rate steps. Spiking regularity was fixed with gamma order 4. <italic>E</italic>: effect of different response duration. <italic>F</italic>: effect of trial-to-trial variations in the response duration for different rate steps.</p></caption><graphic xlink:href="z9k0010992710008"/></fig><fig position="float" id="f9"><label>FIG. 9.</label><caption><p>Influence of spiking regularity on information values. <italic>A</italic>: effect of spiking regularity (gamma order) for different rate steps. <italic>B</italic>: effect of incorrect estimation of gamma order. Each line shows results for data simulated with a particular gamma order. Abscissa shows the gamma order assumed for the analysis. Information values are expressed as a fraction of that determined when the correct order was assumed. <italic>C</italic> and <italic>D</italic>: effect of trial-to-trial variation in spike regularity (measured by ISI CV). Results are shown for simulations with low mean regularity (gamma order 2, <italic>A</italic>) and high mean regularity (gamma order 6, <italic>B</italic>). <italic>E</italic> and <italic>F</italic>: effect of changes in spiking regularity in the response step. In all cases, the step width was 300 ms. Results are shown for simulations with low mean regularity (gamma order 2, gray shading, <italic>E</italic>) and high mean regularity (gamma order 6, gray shading, <italic>F</italic>), which was the order assumed by the analysis. The abscissa gives the order used to simulate the response step. Key for <italic>A</italic> applies to all other plots.</p></caption><graphic xlink:href="z9k0010992710009"/></fig><fig position="float" id="f10"><label>FIG. 10.</label><caption><p>Effect of latency variability from trial to trial. <italic>A</italic>: effect of latency variability from trial to trial for different rate step profiles. The abscissa shows the SD of the latency variability. The circles on each plot show the latency variability at which the <italic>I</italic><sub>r</sub> value had dropped to 50&#x00025; of its value with no latency variability. <italic>B</italic>: PETH and raster of simulated cell with a latency SD of 50 ms and rate step from 20 to 40 Hz. <italic>C</italic>: cluster plot of the actual latency vs. most likely shift. Each dot represents a single trial. <italic>D</italic>: effect of different rate profiles on the correlation coefficient. Latency variation was 60 ms.</p></caption><graphic xlink:href="z9k0010992710010"/></fig><fig position="float" id="f11"><label>FIG. 11.</label><caption><p>Implementation of analysis on experimental spike trains. For the entire figure, the <italic>left column</italic> represents data aligned to go-cue, <italic>middle column</italic> to reach, and <italic>right column</italic> to squeeze events. <italic>B</italic> and <italic>C</italic>: relate to discharge of one neuron; <italic>D</italic> and <italic>E</italic> to the discharge of a different cell that was simultaneously recorded. <italic>A</italic>: distribution of 3 different behavioral events relative to each other. <italic>B</italic> and <italic>D</italic>: PETH (<italic>top</italic>) and raster plot (<italic>bottom</italic>) of the activity of a single neuron recorded from supplementary motor area (SMA). <italic>C</italic> and <italic>E</italic>: single trial shift likelihood distributions (black) and averaged shift likelihood distributions (gray).</p></caption><graphic xlink:href="z9k0010992710011"/></fig><fig position="float" id="f12"><label>FIG. 12.</label><caption><p>Comparison of responses with and without latency variation. <italic>A</italic>: PETH and raster plot for trials with baseline rate of 40 Hz and a response rate of 80 Hz (duration 200 ms, gamma order 4). Response latency varied randomly from trial to trial (normal distribution, SD 100 ms). <italic>B</italic>: PETH and raster for data simulated to have a rate profile the same as the PETH in <italic>A</italic>, with no latency variation from trial to trial. <italic>C</italic> and <italic>D</italic>: shift likelihood distributions for single trials (black) and mean shift likelihood distribution (gray), corresponding to the data illustrated in <italic>A</italic> and <italic>B. E</italic>: distribution of information estimated from 50 simulations as in <italic>B</italic>. The information measured from <italic>A</italic> is shown as a dotted line.</p></caption><graphic xlink:href="z9k0010992710012"/></fig><fig position="float" id="f13"><label>FIG. 13.</label><caption><p>Comparison of simulated with experimental data. <italic>A</italic>: PETH and raster plot for experimentally recorded neuron shown in <xref ref-type="fig" rid="f11">Fig. 11<italic>B</italic></xref>, aligned to &#x0201c;squeeze&#x0201d; the event. <italic>B</italic>: PETH and raster for data simulated to have a single-trial rate profile the same as the PETH in <italic>A. C</italic> and <italic>D</italic>: shift likelihood distributions for single trials (black) and mean shift likelihood distribution (gray), corresponding to the data illustrated in <italic>A</italic> and <italic>B. E</italic>: distribution of information estimated from 100 simulations as in <italic>B</italic>. The information measured from <italic>A</italic> is shown as a dotted line.</p></caption><graphic xlink:href="z9k0010992710013"/></fig></floats-group></article>