<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd"><article xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id><journal-title>BMC Bioinformatics</journal-title><issn pub-type="epub">1471-2105</issn><publisher><publisher-name>BioMed Central</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">19208151</article-id><article-id pub-id-type="pmc">2648784</article-id><article-id pub-id-type="publisher-id">1471-2105-10-S1-S49</article-id><article-id pub-id-type="doi">10.1186/1471-2105-10-S1-S49</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research</subject></subj-group></article-categories><title-group><article-title>Quality assessment of tandem mass spectra using support vector machine (SVM)</article-title></title-group><contrib-group><contrib id="A1" contrib-type="author"><name><surname>Zou</surname><given-names>An-Min</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>anmin.zou@ia.ac.cn</email></contrib><contrib id="A2" corresp="yes" contrib-type="author"><name><surname>Wu</surname><given-names>Fang-Xiang</given-names></name><xref ref-type="aff" rid="I1">1</xref><xref ref-type="aff" rid="I2">2</xref><email>faw341@mail.usask.ca</email></contrib><contrib id="A3" contrib-type="author"><name><surname>Ding</surname><given-names>Jia-Rui</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>jid505@mail.usask.ca</email></contrib><contrib id="A4" contrib-type="author"><name><surname>Poirier</surname><given-names>Guy G</given-names></name><xref ref-type="aff" rid="I3">3</xref><email>Guy.poirier@crchul.ulaval.ca</email></contrib></contrib-group><aff id="I1"><label>1</label>Department of Mechanical Engineering, University of Saskatchewan, 57 Campus Dr., Saskatoon, SK, S7N 59A, Canada</aff><aff id="I2"><label>2</label>Division of Biomedical Engineering, University of Saskatchewan, 57 Campus Dr., Saskatoon, SK, S7N 59A, Canada</aff><aff id="I3"><label>3</label>Health and Environment Unit, Laval University Medical Research Center (CHUL), Faculty of Medicine, 2705 Boul. Laurier, Quebec, QC, GIV 4G2, Canada</aff><pub-date pub-type="collection"><year>2009</year></pub-date><pub-date pub-type="epub"><day>30</day><month>1</month><year>2009</year></pub-date><volume>10</volume><issue>Suppl 1</issue><supplement><named-content content-type="supplement-title">Selected papers from the Seventh Asia-Pacific Bioinformatics Conference (APBC 2009)</named-content><named-content content-type="supplement-editor">Michael Q Zhang, Michael S Waterman and Xuegong Zhang</named-content></supplement><fpage>S49</fpage><lpage>S49</lpage><ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/10/S1/S49"/><permissions><copyright-statement>Copyright &#x000a9; 2009 Zou et al; licensee BioMed Central Ltd.</copyright-statement><copyright-year>2009</copyright-year><copyright-holder>Zou et al; licensee BioMed Central Ltd.</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0"><p>This is an open access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p><!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>               Zou               An-Min                              anmin.zou@ia.ac.cn            </dc:author><dc:title>            Quality assessment of tandem mass spectra using support vector machine (SVM)         </dc:title><dc:date>2009</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 10(Suppl 1): S49-. (2009)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2009)10:Suppl 1&#x0003c;S49&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>--></license></permissions><abstract><sec><title>Background</title><p>Tandem mass spectrometry has become particularly useful for the rapid identification and characterization of protein components of complex biological mixtures. Powerful database search methods have been developed for the peptide identification, such as SEQUEST and MASCOT, which are implemented by comparing the mass spectra obtained from unknown proteins or peptides with theoretically predicted spectra derived from protein databases. However, the majority of spectra generated from a mass spectrometry experiment are of too poor quality to be interpreted while some of spectra with high quality cannot be interpreted by one method but perhaps by others. Hence a filtering algorithm that removes those spectra with poor quality prior to the database search is appealing.</p></sec><sec><title>Results</title><p>This paper proposes a support vector machine (SVM) based approach to assess the quality of tandem mass spectra. Each mass spectrum is mapping into the 16 proposed features to describe its quality. Based the results from SEQUEST, four SVM classifiers with the input of the 16 features are trained and tested on ISB data and TOV data, respectively. The superior performance of the proposed SVM classifiers is illustrated both by the comparison with the existing classifiers and by the validation in terms of MASCOT search results.</p></sec><sec><title>Conclusion</title><p>The proposed method can be employed to effectively remove the poor quality spectra before the spectral searching, and also to find the more peptides or post-translational peptides from spectra with high quality using different search engines or <italic>de novo </italic>method.</p></sec></abstract><conference><conf-date>13&#x02013;16 January 2009</conf-date><conf-name>The Seventh Asia Pacific Bioinformatics Conference (APBC 2009)</conf-name><conf-loc>Beijing, China</conf-loc></conference></article-meta></front><body><sec><title>Background</title><p>With the development of proteomics, tandem mass spectrometry (MS/MS) has been used for the rapid identification and characterization of protein components of complex biological mixtures. Several database search programs such as SEQUEST [<xref ref-type="bibr" rid="B1">1</xref>] and MASCOT [<xref ref-type="bibr" rid="B2">2</xref>] have been developed to identify peptides by comparing the mass spectra obtained from unknown proteins or peptides with theoretically predicted spectra derived from protein databases. However, it is well known that these search programs produce a significant number of incorrect peptide assignments and leave the majority of spectra uninterpreted. One of the reasons this happens is that the majority of spectra generated from a mass spectrometry experiment are of too poor quality to be interpreted. The process of evaluating peptide assignments often relies on time-consuming and experience-dependent manual verification. Hence a filtering algorithm that removes those spectra with poor quality prior to the database search is appealing.</p><p>During the past few years, there have been a number of studies concerning the evaluation of the results of various search programs. Moore <italic>et al</italic>. described a probabilistic scoring scheme called Qscore to evaluate SEQUEST database search results [<xref ref-type="bibr" rid="B3">3</xref>]. Keller <italic>et al</italic>. applied the expectation maximization algorithm to estimate the accuracy of peptide identifications [<xref ref-type="bibr" rid="B4">4</xref>]. Anderson <italic>et al</italic>. employed the support vector machine (SVM) to distinguish between correctly and incorrectly identified peptides obtained by SEQUEST search program [<xref ref-type="bibr" rid="B5">5</xref>]. Razumovskaya <italic>et al</italic>. developed a method by combining a neural network and a statistical model to normalize SEQUEST scores and to provide reliability estimation for SEQUEST hits [<xref ref-type="bibr" rid="B6">6</xref>]. More recently, Nesvizhskii <italic>et al</italic>. described a dynamic quality scoring approach for finding high quality unassigned spectra in large shotgun proteomic datasets [<xref ref-type="bibr" rid="B7">7</xref>].</p><p>The earliest work concerned with the quality assessment of tandem mass spectra prior to database search was reported by Tabb <italic>et al</italic>. [<xref ref-type="bibr" rid="B8">8</xref>]. They assessed the spectral quality by use of some simple rules such as minimum and maximum thresholds on the number of peaks and a minimum threshold on total peak intensity. They claimed that such rules could remove 40% or more of the poor quality spectra. Purvine <italic>et al</italic>. used a pre-filtering algorithm named SPEQUAL with three features for tandem mass spectral quality assessment [<xref ref-type="bibr" rid="B9">9</xref>]. These three features were charge state differentiation, total signal intensity, and signal-to-noise estimates. They claimed that 55% of the poor quality spectra could be safely eliminated from further analysis by employing the SPEQUAL algorithm. Bern <italic>et al</italic>. proposed two different classification schemes for the automatic spectral quality assessment [<xref ref-type="bibr" rid="B10">10</xref>]. One scheme used the linear Fisher analysis to construct a classifier based on seven features including Npeaks, Total Intensity, Good-Diff Fraction, Isotopes, Complements, Water Losses, and Intensity Balance. The other one employed the SVM classifier based on observed mass/charge (<italic>m</italic>/<italic>z</italic>) ratios. The best result reported by Bern <italic>et al</italic>. [<xref ref-type="bibr" rid="B10">10</xref>] is that their SVM based classifier could remove 75% of the poor quality spectra while losing 10% of the high quality ones.</p><p>More recently, Flikka <italic>et al</italic>. [<xref ref-type="bibr" rid="B11">11</xref>] presented a filtering algorithm to eliminate the poor quality spectra before the database search. They tested and compared several classifiers on various proteome datasets (Q-TOF, ESI IT, and MALDI-TOF) from different instruments, and the best results from the classification test using ESI IT dataset showed that 83% of the poor quality spectra could be removed while losing 10% of the high quality ones. Salmi <italic>et al</italic>. [<xref ref-type="bibr" rid="B12">12</xref>] proposed a pre-filtering scheme for evaluating the quality of spectra before the database search, and they obtained the minimum false positive rate (FPR) of 25% while fixing the true positive rate (TPR) at 90%. Na <italic>et al</italic>. [<xref ref-type="bibr" rid="B13">13</xref>] proposed a machine learning approach to assess spectral quality by use of three spectral features which were Xrea based on cumulative intensity normalization and Good-Diff Fraction proposed by Bern <italic>et al</italic>. [<xref ref-type="bibr" rid="B10">10</xref>] for singly charged and doubly charged fragment ions. Na <italic>et al</italic>. [<xref ref-type="bibr" rid="B13">13</xref>] claimed that their method could filter out 75% of poor quality spectra while losing 10% of high quality ones when evaluating it on the ISB dataset. In [<xref ref-type="bibr" rid="B14">14</xref>], a probability based approach called msmsEval was proposed to assess the quality of tandem mass spectra. Using the ISB dataset as the classification test data, the TNR was obtained at about 83% while the TPR was 90%. This paper investigates the quality assessment of tandem mass spectra. The spectra are classified into two groups: high quality and poor quality spectra. In general, a spectrum is called to be of high quality if it is able to be identified by some methods, and otherwise it is called to be of poor quality. Several spectral features are proposed for the classification, and the SVM is applied to solve this classification problem. The results of computational experiments on two different mass spectral datasets (ISB and TOV) show that the proposed method can remove the majority of the poor quality spectra while losing a small minority of the high quality ones.</p></sec><sec sec-type="materials|methods"><title>Materials and methods</title><sec><title>Spectral features</title><p>A mass spectrum usually contains tens to hundreds of <italic>m</italic>/<italic>z </italic>values on the <italic>x</italic>-axis, each with corresponding signal intensity on the <italic>y</italic>-axis. In this study, after removing the noisy peaks by use of the morphological reconstruction method [<xref ref-type="bibr" rid="B15">15</xref>], 16 spectral features are introduced as follows for a spectrum.</p><p><italic>F</italic><sub>1</sub>: The number of peaks in the spectrum, square root-transformed.</p><p><italic>F</italic><sub>2</sub>: The average raw intensity of the peaks in the spectrum, log-transformed.</p><p><italic>F</italic><sub>3</sub>: The number of peaks with relative intensity &#x0003e;0.1, square root-transformed. In this study, the relative intensity of each peak is defined as the peak's intensity divided by the intensity of the highest peak.</p><p><italic>F</italic><sub>4</sub>: The average raw intensity of the peaks with relative intensity &#x0003e;0.1, log-transformed.</p><p>The log or square root transformation of the above spectral features was employed to obtain a more symmetric shape of the distribution and to minimize the variance across spectra in a mass spectral dataset. The experiments also verified that such transformation improved the performance of the spectral quality assessment by using the proposed SVM method.</p><p>To develop the remaining 12 features, four variables for a given peptide mass spectrum <italic>S </italic>are defined as</p><p><disp-formula id="bmcM1"><label>(1)</label><italic>dif</italic><sub>1</sub>(<italic>m</italic>(<italic>x</italic>), <italic>m</italic>(<italic>y</italic>)) = <italic>m</italic>(<italic>x</italic>) - <italic>m</italic>(<italic>y</italic>)</disp-formula></p><p><disp-formula id="bmcM2"><label>(2)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" name="1471-2105-10-S1-S49-i1" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:mi>d</mml:mi>                           <mml:mi>i</mml:mi>                           <mml:msub>                              <mml:mi>f</mml:mi>                              <mml:mn>2</mml:mn>                           </mml:msub>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>m</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>x</mml:mi>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo>,</mml:mo>                           <mml:mi>m</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>y</mml:mi>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo>=</mml:mo>                           <mml:mi>m</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>x</mml:mi>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo>&#x02212;</mml:mo>                           <mml:mfrac>                              <mml:mrow>                                 <mml:mi>m</mml:mi>                                 <mml:mo stretchy="false">(</mml:mo>                                 <mml:mi>y</mml:mi>                                 <mml:mo stretchy="false">)</mml:mo>                                 <mml:mo>+</mml:mo>                                 <mml:mi>m</mml:mi>                                 <mml:mo stretchy="false">(</mml:mo>                                 <mml:mi>H</mml:mi>                                 <mml:mo stretchy="false">)</mml:mo>                              </mml:mrow>                              <mml:mn>2</mml:mn>                           </mml:mfrac>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p><disp-formula id="bmcM3"><label>(3)</label><italic>sum</italic><sub>1</sub>(<italic>m</italic>(<italic>x</italic>), <italic>m</italic>(<italic>y</italic>)) = <italic>m</italic>(<italic>x</italic>) + <italic>m</italic>(<italic>y</italic>)</disp-formula></p><p><disp-formula id="bmcM4"><label>(4)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2" name="1471-2105-10-S1-S49-i2" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:mi>s</mml:mi>                           <mml:mi>u</mml:mi>                           <mml:msub>                              <mml:mi>m</mml:mi>                              <mml:mn>2</mml:mn>                           </mml:msub>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>m</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>x</mml:mi>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo>,</mml:mo>                           <mml:mi>m</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>y</mml:mi>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo>=</mml:mo>                           <mml:mi>m</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>x</mml:mi>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo>+</mml:mo>                           <mml:mfrac>                              <mml:mrow>                                 <mml:mi>m</mml:mi>                                 <mml:mo stretchy="false">(</mml:mo>                                 <mml:mi>y</mml:mi>                                 <mml:mo stretchy="false">)</mml:mo>                                 <mml:mo>+</mml:mo>                                 <mml:mi>m</mml:mi>                                 <mml:mo stretchy="false">(</mml:mo>                                 <mml:mi>H</mml:mi>                                 <mml:mo stretchy="false">)</mml:mo>                              </mml:mrow>                              <mml:mn>2</mml:mn>                           </mml:mfrac>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>where <italic>m</italic>(<italic>x</italic>) and <italic>m</italic>(<italic>y</italic>) denote the <italic>m</italic>/<italic>z</italic>-values of peaks <italic>x </italic>and <italic>y </italic>in the spectrum <italic>S</italic>, respectively; <italic>m</italic>(<italic>H</italic>) is the mass of a hydrogen atom. A weighting factor is defined as</p><p><disp-formula id="bmcM5"><label>(5)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M3" name="1471-2105-10-S1-S49-i3" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:mi>W</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>x</mml:mi>                           <mml:mo>,</mml:mo>                           <mml:mi>y</mml:mi>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo>=</mml:mo>                           <mml:mfrac>                              <mml:mrow>                                 <mml:msub>                                    <mml:mi>I</mml:mi>                                    <mml:mi>r</mml:mi>                                 </mml:msub>                                 <mml:mo stretchy="false">(</mml:mo>                                 <mml:mi>x</mml:mi>                                 <mml:mo stretchy="false">)</mml:mo>                                 <mml:mo>+</mml:mo>                                 <mml:msub>                                    <mml:mi>I</mml:mi>                                    <mml:mi>r</mml:mi>                                 </mml:msub>                                 <mml:mo stretchy="false">(</mml:mo>                                 <mml:mi>y</mml:mi>                                 <mml:mo stretchy="false">)</mml:mo>                              </mml:mrow>                              <mml:mn>2</mml:mn>                           </mml:mfrac>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>where <italic>I</italic><sub><italic>r</italic></sub>(<italic>x</italic>) and <italic>I</italic><sub><italic>y</italic></sub>(<italic>x</italic>) represent the relative intensities of peaks <italic>x </italic>and <italic>y </italic>in the spectrum <italic>S</italic>, respectively.</p><p><italic>F</italic><sub>5 </sub>- <italic>F</italic><sub>7</sub>: Amino acid distances. These features measure how likely two peaks in a spectrum <italic>S </italic>differ by one of the twenty amino acids. Define</p><p><disp-formula id="bmcM6"><label>(6)</label><italic>F</italic><sub>5 </sub>= &#x02211;{<italic>W</italic>(<italic>x</italic>, <italic>y</italic>)|<italic>di f</italic><sub>1</sub>(<italic>m</italic>(<italic>x</italic>), <italic>m</italic>(<italic>y</italic>)) &#x02248; <italic>M</italic><sub><italic>i</italic></sub>, <italic>i </italic>= 1, 2,&#x022ef;,17}</disp-formula></p><p><disp-formula id="bmcM7"><label>(7)</label><italic>F</italic><sub>6 </sub>= &#x02211;{<italic>W</italic>(<italic>x</italic>, <italic>y</italic>)|<italic>di f</italic><sub>1</sub>(<italic>m</italic>(<italic>x</italic>), <italic>m</italic>(<italic>y</italic>)) &#x02248; <italic>M</italic><sub><italic>i</italic></sub>/2, <italic>i </italic>= 1, 2,&#x022ef;,17}</disp-formula></p><p><disp-formula id="bmcM8"><label>(8)</label><italic>F</italic><sub>7 </sub>= &#x02211;{<italic>W</italic>(<italic>x</italic>, <italic>y</italic>)|<italic>di f</italic><sub>2</sub>(<italic>m</italic>(<italic>x</italic>), <italic>m</italic>(<italic>y</italic>)) &#x02248; <italic>M</italic><sub><italic>i</italic></sub>/2, <italic>i </italic>= 1, 2,&#x022ef;,17}</disp-formula></p><p>where <italic>M</italic><sub><italic>i</italic></sub>(<italic>i </italic>= 1, 2,&#x022ef;,17) are the 17 different masses of all 20 amino acids. This study considers all Methionine amino acids to be sulfoxidized and does not distinguish three pairs of amino acids in their masses: Isoleucine vs. Leucine, Glutamine vs. Lysine, and sulfoxidized Methionine vs. Phenylalanine since the masses of each pair are very close. The comparison implied by &#x02248; employs a tolerance, which was set to &#x000b1; 0.5 Da for fragment ions and &#x000b1; 2 Da for parent mass in this paper. The feature <italic>F</italic><sub>5 </sub>measures the presence of peak pairs of singly charged ions corresponding to an amino acid mass difference in the spectrum <italic>S</italic>; the feature <italic>F</italic><sub>6 </sub>measures the presence of peak pairs of doubly charged ions corresponding to an amino acid mass difference in the spectrum <italic>S</italic>, and the feature <italic>F</italic><sub>7 </sub>measures the presence of peak pairs of one doubly charged and the other singly charged ions corresponding to an amino acid mass difference in the spectrum <italic>S</italic>. The use of the weighting factors in the features is to account the increased likelihood of more intense peaks being true fragment ions.</p><p><italic>F</italic><sub>8 </sub>- <italic>F</italic><sub>10</sub>: Complements. These features measure how likely an N-terminus ion and a C-terminus ion in the spectrum <italic>S </italic>are produced as the peptide fragments at the same peptide bond. Define</p><p><disp-formula id="bmcM9"><label>(9)</label><italic>F</italic><sub>8 </sub>= &#x02211;{<italic>W</italic>(<italic>x</italic>, <italic>y</italic>)|<italic>sum</italic><sub>1</sub>(<italic>m</italic>(<italic>x</italic>), <italic>m</italic>(<italic>y</italic>)) &#x02248; <italic>M</italic><sub><italic>p </italic></sub>+ 2<italic>m</italic>(<italic>H</italic>)}</disp-formula></p><p><disp-formula id="bmcM10"><label>(10)</label><italic>F</italic><sub>9 </sub>= &#x02211;{<italic>W</italic>(<italic>x</italic>, <italic>y</italic>)|<italic>sum</italic><sub>1</sub>(<italic>m</italic>(<italic>x</italic>), <italic>m</italic>(<italic>y</italic>)) &#x02248; <italic>M</italic><sub><italic>p</italic></sub>/2 + 2<italic>m</italic>(<italic>H</italic>)}</disp-formula></p><p><disp-formula id="bmcM11"><label>(11)</label><italic>F</italic><sub>10 </sub>= &#x02211;{<italic>W</italic>(<italic>x</italic>, <italic>y</italic>)|<italic>sum</italic><sub>2</sub>(<italic>m</italic>(<italic>x</italic>), <italic>m</italic>(<italic>y</italic>)) &#x02248; <italic>M</italic><sub><italic>p</italic></sub>/2 + 2<italic>m</italic>(<italic>H</italic>)}</disp-formula></p><p>where <italic>M</italic><sub><italic>p </italic></sub>is the mass of the precursor ion of the spectrum <italic>S</italic>. The feature <italic>F</italic><sub>8 </sub>measures the presence of complementary peak pairs of singly charged ions in the spectrum <italic>S</italic>; the feature <italic>F</italic><sub>9 </sub>measures the presence of complementary peak pairs of doubly charged ions in the spectrum <italic>S</italic>, and the feature <italic>F</italic><sub>10 </sub>measures the presence of complementary peak pairs of one doubly charged and the other singly charged ions in the spectrum <italic>S</italic>.</p><p><italic>F</italic><sub>11 </sub>- <italic>F</italic><sub>13</sub>: Water or ammonia losses. These features measure how likely one ion in the spectrum <italic>S </italic>is produced by losing a water or ammonia molecule from a b-ion or y-ion. Define</p><p><disp-formula id="bmcM12"><label>(12)</label><italic>F</italic><sub>11 </sub>= &#x02211;{<italic>W</italic>(<italic>x</italic>, <italic>y</italic>)|<italic>di f</italic><sub>1</sub>(<italic>m</italic>(<italic>x</italic>), <italic>m</italic>(<italic>y</italic>)) &#x02248; <italic>M</italic><sub><italic>w </italic></sub>or <italic>M</italic><sub><italic>a</italic></sub>}</disp-formula></p><p><disp-formula id="bmcM13"><label>(13)</label><italic>F</italic><sub>12 </sub>= &#x02211;{<italic>W</italic>(<italic>x</italic>, <italic>y</italic>)|<italic>di f</italic><sub>1</sub>(<italic>m</italic>(<italic>x</italic>), <italic>m</italic>(<italic>y</italic>)) &#x02248; <italic>M</italic><sub><italic>w</italic></sub>/2 or <italic>M</italic><sub><italic>a</italic></sub>/2}</disp-formula></p><p><disp-formula id="bmcM14"><label>(14)</label><italic>F</italic><sub>13 </sub>= &#x02211;{<italic>W</italic>(<italic>x</italic>, <italic>y</italic>)|<italic>di f</italic><sub>2</sub>(<italic>m</italic>(<italic>x</italic>), <italic>m</italic>(<italic>y</italic>)) &#x02248; <italic>M</italic><sub><italic>w</italic></sub>/2 or <italic>M</italic><sub><italic>a</italic></sub>/2}</disp-formula></p><p>where <italic>M</italic><sub><italic>w </italic></sub>and <italic>M</italic><sub><italic>a </italic></sub>are the masses of a water molecule and an ammonia molecule, respectively. The feature <italic>F</italic><sub>11 </sub>measures the presence of peak pairs of singly charged ions with a difference of a water or ammonia molecule in the spectrum <italic>S</italic>; the feature <italic>F</italic><sub>12 </sub>measures the presence of peak pairs of doubly charged ions with a difference of a water or ammonia molecule in the spectrum <italic>S</italic>, and the feature <italic>F</italic><sub>13 </sub>measures the presence of peak pairs of one doubly charged and the other singly charged ions with a difference of a water or ammonia molecule in the spectrum <italic>S</italic>.</p><p><italic>F</italic><sub>14 </sub>- <italic>F</italic><sub>16</sub>: Supportive ions. These features measure how likely one ion in the spectrum <italic>S </italic>is a supportive ion. This paper considers two kinds of supportive ions a-ions and z-ions. Define</p><p><disp-formula id="bmcM15"><label>(15)</label><italic>F</italic><sub>14 </sub>= &#x02211;{<italic>W</italic>(<italic>x</italic>, <italic>y</italic>)|<italic>di f</italic><sub>1</sub>(<italic>m</italic>(<italic>x</italic>), <italic>m</italic>(<italic>y</italic>)) &#x02248; <italic>M</italic><sub><italic>CO </italic></sub>or <italic>M</italic><sub><italic>NH</italic></sub>}</disp-formula></p><p><disp-formula id="bmcM16"><label>(16)</label><italic>F</italic><sub>15 </sub>= &#x02211;{<italic>W</italic>(<italic>x</italic>, <italic>y</italic>)|<italic>di f</italic><sub>1</sub>(<italic>m</italic>(<italic>x</italic>), <italic>m</italic>(<italic>y</italic>)) &#x02248; <italic>M</italic><sub><italic>CO</italic></sub>/2 or <italic>M</italic><sub><italic>NH</italic></sub>/2}</disp-formula></p><p><disp-formula id="bmcM17"><label>(17)</label><italic>F</italic><sub>16 </sub>= &#x02211;{<italic>W</italic>(<italic>x</italic>, <italic>y</italic>)|<italic>di f</italic><sub>2</sub>(<italic>m</italic>(<italic>x</italic>), <italic>m</italic>(<italic>y</italic>)) &#x02248; <italic>M</italic><sub><italic>CO</italic></sub>/2 or <italic>M</italic><sub><italic>NH</italic></sub>/2}</disp-formula></p><p>where <italic>M</italic><sub><italic>CO </italic></sub>and <italic>M</italic><sub><italic>NH </italic></sub>are the masses of a CO group and an NH group, respectively. The feature <italic>F</italic><sub>14 </sub>measures the presence of peak pairs of singly charged ions with a difference of a CO or NH group in the spectrum <italic>S</italic>; the feature <italic>F</italic><sub>15 </sub>measures the presence of peak pairs of doubly charged ions with a difference of a CO or NH group in the spectrum <italic>S</italic>, and the feature <italic>F</italic><sub>16 </sub>measures the presence of peak pairs of one doubly charged and the other singly charged ions with a difference of a CO or NH group in the spectrum <italic>S</italic>.</p><p>The four features <italic>F</italic><sub><italic>i</italic></sub>(<italic>i </italic>= 5, 8, 11, 14) represent the evidence of the existence of singly charged ions, and the eight features <italic>F</italic><sub><italic>i</italic>+1 </sub>and <italic>F</italic><sub><italic>i</italic>+2</sub>(<italic>i </italic>= 5, 8, 11, 14) represent the evidence of the existence of doubly charged ions.</p><p>These twelve features are developed according to the properties of the theoretical spectra proposed in our previous study [<xref ref-type="bibr" rid="B16">16</xref>] where the peak intensities have not been considered though. The experiments in this study showed that the use of the peak intensities improved the performance of the spectral quality assessment by using the SVM method. In general, the high quality spectra are expected to have larger values of these twelve features than those of the poor quality spectra. In addition, the more intense the peak pairs, the larger the values of these twelve spectral features are. At this point, 16 spectral features are introduced to describe the spectral quality. It is noted that the larger the number of the spectral peaks, the larger the values of the spectral features <italic>F</italic><sub>3 </sub>and <italic>F</italic><sub>5 </sub>- <italic>F</italic><sub>16 </sub>are. This likely leads to a low sensitivity of the classifier as the high quality spectra for a spectrum with smaller number of peaks that would have smaller values of spectral features <italic>F</italic><sub>3 </sub>and <italic>F</italic><sub>5 </sub>- <italic>F</italic><sub>16</sub>. To alleviate these effects, these spectral features are transformed as</p><p><disp-formula id="bmcM18"><label>(18)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M4" name="1471-2105-10-S1-S49-i4" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:mfrac>                              <mml:mrow>                                 <mml:mi>log</mml:mi>                                 <mml:mo>&#x02061;</mml:mo>                                 <mml:mo stretchy="false">(</mml:mo>                                 <mml:mn>1</mml:mn>                                 <mml:mo>+</mml:mo>                                 <mml:msub>                                    <mml:mi>F</mml:mi>                                    <mml:mi>i</mml:mi>                                 </mml:msub>                                 <mml:mo stretchy="false">)</mml:mo>                              </mml:mrow>                              <mml:mrow>                                 <mml:mi>&#x003b4;</mml:mi>                                 <mml:mo>+</mml:mo>                                 <mml:msub>                                    <mml:mi>F</mml:mi>                                    <mml:mn>1</mml:mn>                                 </mml:msub>                              </mml:mrow>                           </mml:mfrac>                           <mml:mo>,</mml:mo>                           <mml:mi>i</mml:mi>                           <mml:mo>=</mml:mo>                           <mml:mn>3</mml:mn>                           <mml:mo>,</mml:mo>                           <mml:mn>5</mml:mn>                           <mml:mo>,</mml:mo>                           <mml:mn>6</mml:mn>                           <mml:mo>,</mml:mo>                           <mml:mo>&#x022ef;</mml:mo>                           <mml:mo>,</mml:mo>                           <mml:mn>16</mml:mn>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>where <italic>&#x003b4; </italic>is a small positive constant, and is set <italic>&#x003b4; </italic>= 0.01 in this study. In a spectrum, a possible <italic>m</italic>/<italic>z </italic>range in which doubly charged ion peaks exist is less than a half of its peptide mass. Therefore, while we compute features <italic>F</italic><sub>6</sub>, <italic>F</italic><sub>12</sub>, and <italic>F</italic><sub>15</sub>, the following conditions should be satisfied</p><p><disp-formula id="bmcM19"><label>(19)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M5" name="1471-2105-10-S1-S49-i5" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:mi>m</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>x</mml:mi>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo>&#x0003c;</mml:mo>                           <mml:mfrac>                              <mml:mrow>                                 <mml:msub>                                    <mml:mi>M</mml:mi>                                    <mml:mi>p</mml:mi>                                 </mml:msub>                                 <mml:mo>+</mml:mo>                                 <mml:mi>m</mml:mi>                                 <mml:mo stretchy="false">(</mml:mo>                                 <mml:mi>H</mml:mi>                                 <mml:mo stretchy="false">)</mml:mo>                              </mml:mrow>                              <mml:mn>2</mml:mn>                           </mml:mfrac>                           <mml:mtext>&#x000a0;and&#x000a0;</mml:mtext>                           <mml:mi>m</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>y</mml:mi>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo>&#x0003c;</mml:mo>                           <mml:mfrac>                              <mml:mrow>                                 <mml:msub>                                    <mml:mi>M</mml:mi>                                    <mml:mi>p</mml:mi>                                 </mml:msub>                                 <mml:mo>+</mml:mo>                                 <mml:mi>m</mml:mi>                                 <mml:mo stretchy="false">(</mml:mo>                                 <mml:mi>H</mml:mi>                                 <mml:mo stretchy="false">)</mml:mo>                              </mml:mrow>                              <mml:mn>2</mml:mn>                           </mml:mfrac>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>Classification method</p><p>In this paper, the support vector machine is applied to assess the spectral quality because of its good generalization ability. The SVM was proposed by Vapnik based on the statistical learning theory [<xref ref-type="bibr" rid="B17">17</xref>]. An important characteristic of the SVM is that "while most classical neural network algorithms require an ad hoc choice of system's generalization ability, the SVM approach proposes a learning algorithm to control the generalization ability of the system automatically" [<xref ref-type="bibr" rid="B18">18</xref>]. The training of an SVM requires the solution of a quadric programming (QP) optimization problem, which is a large-scale system optimization problem. The sequential minimal optimization (SMO) decomposes the overall QP problem into fixed-size QP sub-problems (each involves only two Lagrange multipliers), and these sub-problems are solved analytically [<xref ref-type="bibr" rid="B19">19</xref>]. The SMO algorithm is one of the efficient algorithms for solving the large QP problem, which is employed to train the SVM in this work.</p><p>For an input vector <italic>x </italic>&#x02208; <italic>R</italic><sup><italic>n </italic></sup>(<italic>n </italic>= 16 in this paper), a decision can be made by a well-trained SVM as</p><p><disp-formula id="bmcM20"><label>(20)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M6" name="1471-2105-10-S1-S49-i6" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:mi>f</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>x</mml:mi>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo>=</mml:mo>                           <mml:mtext>sign</mml:mtext>                           <mml:mrow>                              <mml:mo>(</mml:mo>                              <mml:mrow>                                 <mml:mstyle displaystyle="true">                                    <mml:munderover>                                       <mml:mo>&#x02211;</mml:mo>                                       <mml:mrow>                                          <mml:mi>i</mml:mi>                                          <mml:mo>=</mml:mo>                                          <mml:mn>1</mml:mn>                                       </mml:mrow>                                       <mml:mi>l</mml:mi>                                    </mml:munderover>                                    <mml:mrow>                                       <mml:msub>                                          <mml:mi>&#x003b1;</mml:mi>                                          <mml:mi>i</mml:mi>                                       </mml:msub>                                       <mml:msub>                                          <mml:mi>y</mml:mi>                                          <mml:mi>i</mml:mi>                                       </mml:msub>                                       <mml:mi>K</mml:mi>                                       <mml:mo stretchy="false">(</mml:mo>                                       <mml:msub>                                          <mml:mi>x</mml:mi>                                          <mml:mi>i</mml:mi>                                       </mml:msub>                                       <mml:mo>,</mml:mo>                                       <mml:mi>x</mml:mi>                                       <mml:mo stretchy="false">)</mml:mo>                                       <mml:mo>+</mml:mo>                                       <mml:mi>b</mml:mi>                                    </mml:mrow>                                 </mml:mstyle>                              </mml:mrow>                              <mml:mo>)</mml:mo>                           </mml:mrow>                           <mml:mo>&#x02261;</mml:mo>                           <mml:mtext>sign</mml:mtext>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>g</mml:mi>                           <mml:mo stretchy="false">(</mml:mo>                           <mml:mi>x</mml:mi>                           <mml:mo stretchy="false">)</mml:mo>                           <mml:mo stretchy="false">)</mml:mo>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>where <italic>x</italic><sub><italic>i </italic></sub>&#x02208; <italic>R</italic><sup><italic>n</italic></sup>(<italic>i </italic>= 1, 2,&#x022ef;, <italic>l</italic>) are the support vectors; <italic>&#x003b1;</italic><sub><italic>i</italic></sub>(<italic>i </italic>= 1, 2,&#x022ef;, <italic>l</italic>)) are the Lagrange multipliers; <italic>y</italic><sub><italic>i </italic></sub>&#x02208; {-1, +1}(<italic>i </italic>= 1, 2,&#x022ef;, <italic>l</italic>)) are the corresponding class of pattern for the support vector <italic>x</italic><sub><italic>i</italic></sub>, and -1 for poor quality spectra and +1 for high quality spectra in this paper; <italic>K</italic>(<italic>x</italic><sub><italic>i</italic></sub>, <italic>x</italic>)(<italic>i </italic>= 1, 2,&#x022ef;, <italic>l</italic>)) are the kernel functions, and <italic>b </italic>is the threshold. In this paper, the non-thresholded output <italic>g</italic>(<italic>x</italic>) is employed to generate the receiver operating characteristics (ROC) curve by using the algorithm proposed by Fawcett [<xref ref-type="bibr" rid="B20">20</xref>]. To evaluate the performance of the SVM classifiers, two correct rates are calculated in this study: true positive rate (TPR) and true negative rate (TNR)</p><p><disp-formula id="bmcM21"><label>(21)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M7" name="1471-2105-10-S1-S49-i7" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:mtext>TPR</mml:mtext>                           <mml:mo>=</mml:mo>                           <mml:mfrac>                              <mml:mrow>                                 <mml:mtext>TP</mml:mtext>                              </mml:mrow>                              <mml:mrow>                                 <mml:mtext>TP</mml:mtext>                                 <mml:mo>+</mml:mo>                                 <mml:mtext>FN</mml:mtext>                              </mml:mrow>                           </mml:mfrac>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p><disp-formula id="bmcM22"><label>(22)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M8" name="1471-2105-10-S1-S49-i8" overflow="scroll">                     <mml:semantics>                        <mml:mrow>                           <mml:mtext>TNR</mml:mtext>                           <mml:mo>=</mml:mo>                           <mml:mfrac>                              <mml:mrow>                                 <mml:mtext>TN</mml:mtext>                              </mml:mrow>                              <mml:mrow>                                 <mml:mtext>TN</mml:mtext>                                 <mml:mo>+</mml:mo>                                 <mml:mtext>FP</mml:mtext>                              </mml:mrow>                           </mml:mfrac>                        </mml:mrow>                                             </mml:semantics>                  </mml:math></disp-formula></p><p>where TP is the number of true positives; FP is the number of false positives; TN is the number of true negatives, and FN is the number of false negatives.</p></sec><sec><title>Experimental data</title><p>This study used two different proteome datasets: the ISB dataset and the TOV dataset.</p><sec><title>ISB dataset</title><p>The ISB dataset used in this study was acquired on an ion trap and was provided by the Institute of Systems Biology (ISB, Seattle, USA). The ISB dataset consists of 37043 peptide collision-induced dissociation (CID) mass spectra, which were generated by the tryptic digestion of a control mixture of standard 18 proteins (not of human origin) [<xref ref-type="bibr" rid="B4">4</xref>]. These spectra were searched against a human protein database (extracted from [<xref ref-type="bibr" rid="B21">21</xref>]) appended with the sequences of the 18 standard proteins and other common contaminants (totally, 5395 protein sequences in the final database) using SEQUEST search program. The single charged spectra were excluded from this study as the number of the singly charged spectra (only 504 singly charged) is too small. The distribution of multiple charged spectra is shown in Table <xref ref-type="table" rid="T1">1</xref>. 'H' represents the number of the high quality spectra, and 'P' represents the number of the poor quality spectra. For the ISB dataset, this study has trained three SVM classifiers, one for doubly charged, one for triply charged, and the other for multiply charged spectra (not distinguishing between the doubly charged and triply charged ions).</p><table-wrap position="float" id="T1"><label>Table 1</label><caption><p>The distribution of multiply charged spectra in the ISB dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><td></td><td align="center">H*</td><td align="center">P*</td><td align="center">Total</td></tr></thead><tbody><tr><td align="center">Doubly charged</td><td align="center">1242</td><td align="center">17253</td><td align="center">18495</td></tr><tr><td colspan="4"><hr></hr></td></tr><tr><td align="center">Triply charged</td><td align="center">573</td><td align="center">17471</td><td align="center">18044</td></tr><tr><td colspan="4"><hr></hr></td></tr><tr><td align="center">Total</td><td align="center">1815</td><td align="center">34724</td><td align="center">36529</td></tr></tbody></table><table-wrap-foot><p>*A doubly charged spectrum is of high quality if its SQUEST Xcorr score is greater than 2.5, and otherwise it is of poor quality. A triply charged spectrum is of high quality if its SQUEST Xcorr score is greater than 3.5, and otherwise it is of poor quality.</p></table-wrap-foot></table-wrap></sec><sec><title>TOV dataset</title><p>This dataset consists of 13467 peptide CID mass spectra which were acquired on an LCQ DECA XP ion trap (Thermo Electron Corp.) in Eastern Quebec Proteomic Center in Laval University Medical Research Center in Canada. The samples analyzed were generated by the tryptic digestion of a whole-cell lysate from the human malignant epithelial ovarian tumor cell-line TOV-112D [<xref ref-type="bibr" rid="B22">22</xref>]. These spectra were searched against a subset of the Uniref100 database, release 1.2 [<xref ref-type="bibr" rid="B23">23</xref>] including 44278 human protein sequences using SEQUEST. The assignments of 866 spectra were verified to be correct by PeptideProphet with the cut-off score of 0.8 [<xref ref-type="bibr" rid="B4">4</xref>], and were labeled as "high" quality spectra. The other 12601 spectra in TOV were labeled as poor quality. The distribution of these is shown in Table <xref ref-type="table" rid="T2">2</xref>. For the TOV dataset, this study has only trained a classifier for the doubly charged spectra because the number of the high quality singly charged and triply charged spectra is too small to train a reasonable classifier.</p><table-wrap position="float" id="T2"><label>Table 2</label><caption><p>The distribution of spectra in the TOV dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><td></td><td align="center">H*</td><td align="center">P*</td><td align="center">Total</td></tr></thead><tbody><tr><td align="center">Singly charged</td><td align="center">10</td><td align="center">917</td><td align="center">927</td></tr><tr><td colspan="4"><hr></hr></td></tr><tr><td align="center">Doubly charged</td><td align="center">667</td><td align="center">5575</td><td align="center">6242</td></tr><tr><td colspan="4"><hr></hr></td></tr><tr><td align="center">Triply charged</td><td align="center">189</td><td align="center">6109</td><td align="center">6298</td></tr><tr><td colspan="4"><hr></hr></td></tr><tr><td align="center">Total</td><td align="center">866</td><td align="center">12601</td><td align="center">13467</td></tr></tbody></table><table-wrap-foot><p>*A spectrum is of high quality if its PeptideProphet score is greater than 0.8, and otherwise it is of poor quality.</p></table-wrap-foot></table-wrap></sec></sec></sec><sec><title>Results and discussion</title><p>Four separate SVM classifiers were trained in this study. The first SVM was trained for the doubly charged spectra; the second one was trained for the triply charged spectra; the third one was trained for the multiply (both doubly and triply) charged spectra. These three classifiers were trained based on the ISB dataset. The fourth one was trained for the doubly charged spectra of the TOV dataset. This study employed the radial basis functions (RBF) whose width parameter was set equal to 0.1 as the kernel functions of these four SVMs. The penalty term for the training set errors was set to 100.</p><p>It is noted that the class distribution of the tandem mass spectra is highly imbalanced, i.e., the number of the poor quality spectra is much larger than that of the high quality spectra. If one randomly chosen a certain number of spectra from the dataset to train an SVM, one would obtain a higher TNR and a lower TPR by the trained SVM classifier. To get a higher TPR, a larger number of high quality spectra are required to train an SVM classifier, which results in a significant increase of the number of the training samples. Therefore, much longer time will be taken to train the SVM. To overcome these problems and give an equal opportunity to the high quality and the poor quality spectra for the training of the SVM, this study employed the same number of high quality and poor quality spectra as the training samples. For example, in the ISB dataset only 860 (430 high quality and 430 poor quality) spectra were used to train the SVM classifiers for the doubly charged spectra while 600 (300 high quality and 300 poor quality) spectra were used to train the SVM classifier for triply charged spectra. The number of the samples in the training and test sets for all SVM classifiers is shown in Table <xref ref-type="table" rid="T3">3</xref>. 'SVM2ISB' stands for the SVM classifier for the doubly charged ISB spectra; 'SVM3ISB' stands for the SVM classifier for the triply charged ISB spectra; 'SVMMISB' stands for the SVM classifier for the multiply charged ISB spectra, and 'SVM2TOV' stands for the SVM classifier for the doubly charged TOV spectra.</p><table-wrap position="float" id="T3"><label>Table 3</label><caption><p>The number of the samples in the training and test sets</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="center">SVM classifier</td><td align="center">Training set<break/>(H:P)</td><td align="center">Test set<break/>(H:P)</td></tr></thead><tbody><tr><td align="center">SVM2ISB</td><td align="center">430:430</td><td align="center">812:16833</td></tr><tr><td colspan="3"><hr></hr></td></tr><tr><td align="center">SVM3ISB</td><td align="center">300:300</td><td align="center">273:17171</td></tr><tr><td colspan="3"><hr></hr></td></tr><tr><td align="center">SVMMISB</td><td align="center">605:605</td><td align="center">1210:34623</td></tr><tr><td colspan="3"><hr></hr></td></tr><tr><td align="center">SVM2TOV</td><td align="center">350:350</td><td align="center">317:5225</td></tr></tbody></table></table-wrap><p>In this study we repeated to train and test each SVM classifier on 20 randomly sampled datasets to investigate the performance of the proposed methods. The results are shown in Tables <xref ref-type="table" rid="T4">4</xref>, <xref ref-type="table" rid="T5">5</xref>, <xref ref-type="table" rid="T6">6</xref>, <xref ref-type="table" rid="T7">7</xref>. In these tables, 'Ave.' stands for the average and 'SD' for the standard deviation. For the doubly charged spectra of the ISB dataset, Table <xref ref-type="table" rid="T4">4</xref> shows that the proposed method can eliminate about 89% of the poor quality spectra while losing less than 6% of the high quality spectra at the best case. On average the SVM classifier can eliminate about 90% of the poor quality spectra while losing less than 8% of the high quality spectra. For the triply charged spectra of the ISB dataset, Table <xref ref-type="table" rid="T5">5</xref> shows that the proposed method can remove more than 87% of the poor quality spectra while losing about 4% of the high quality spectra at the best case. On average it can remove about 88% of the poor quality spectra while losing about 7% of the high quality spectra. Table <xref ref-type="table" rid="T6">6</xref> shows that the proposed method can remove over 87% of the poor quality multiply charged spectra (not distinguishing between doubly charged and triply charged ions) while losing less than 8% of the high quality ones by using the ISB dataset as the classification test at the best case. On average it can remove over 87% of the poor quality multiply charged spectra while losing about 9% of the high quality ones. For the TOV dataset, Table <xref ref-type="table" rid="T7">7</xref> shows that the developed SVM classifier can remove about 85% of the poor quality spectra while losing less than 5% of the high quality ones at the best case. On average about 84% of the poor quality spectra can be removed while losing less than 8% of the high quality spectra by using the TOV dataset as the classification test. In summary, the four SVM classifier developed in this study performs very well. In addition, comparing Table <xref ref-type="table" rid="T6">6</xref> with Tables <xref ref-type="table" rid="T4">4</xref> and <xref ref-type="table" rid="T5">5</xref>, it indicates that the information about the charge state of the precursor ions can be used to improve the performance of the SVM classifiers. Figures <xref ref-type="fig" rid="F1">1</xref> and <xref ref-type="fig" rid="F2">2</xref> show the ROC curves for the SVM classifier for multiply charged ISB dataset and the SVM classifier for doubly charged TOV dataset, respectively. Even if only 2% loss of high quality spectra is allowed, the proposed method can filter out about 70% of poor quality multiply charged ISB spectra and 65% of poor quality doubly charged TOV spectra, respectively.</p><table-wrap position="float" id="T4"><label>Table 4</label><caption><p>The results in the ISB test data with the SVM classifier for doubly charged spectra</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="center">Times</td><td align="center">FP</td><td align="center">FN</td><td align="center">TPR (%)</td><td align="center">TNR (%)</td></tr></thead><tbody><tr><td align="center">1</td><td align="center">1608</td><td align="center">64</td><td align="center">92.1</td><td align="center">90.4</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">2</td><td align="center">1631</td><td align="center">69</td><td align="center">91.5</td><td align="center">90.3</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">3</td><td align="center">1853</td><td align="center">52</td><td align="center">93.6</td><td align="center">89.0</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">4</td><td align="center">1879</td><td align="center">46</td><td align="center"><bold>94.3</bold></td><td align="center"><bold>88.8</bold></td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">5</td><td align="center">1719</td><td align="center">63</td><td align="center">92.2</td><td align="center">89.8</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">6</td><td align="center">1887</td><td align="center">55</td><td align="center">93.2</td><td align="center">88.8</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">7</td><td align="center">1633</td><td align="center">65</td><td align="center">92.0</td><td align="center">90.3</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">8</td><td align="center">1667</td><td align="center">74</td><td align="center">90.9</td><td align="center">90.1</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">9</td><td align="center">1643</td><td align="center">70</td><td align="center">91.4</td><td align="center">90.2</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">10</td><td align="center">1660</td><td align="center">80</td><td align="center">90.2</td><td align="center">90.1</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">11</td><td align="center">2070</td><td align="center">59</td><td align="center">92.7</td><td align="center">87.7</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">12</td><td align="center">1723</td><td align="center">58</td><td align="center">92.9</td><td align="center">89.8</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">13</td><td align="center">1739</td><td align="center">73</td><td align="center">91.0</td><td align="center">89.7</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">14</td><td align="center">1813</td><td align="center">74</td><td align="center">90.9</td><td align="center">89.2</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">15</td><td align="center">1667</td><td align="center">68</td><td align="center">91.6</td><td align="center">90.1</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">16</td><td align="center">1921</td><td align="center">57</td><td align="center">93.0</td><td align="center">88.6</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">17</td><td align="center">1793</td><td align="center">54</td><td align="center">93.4</td><td align="center">89.3</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">18</td><td align="center">1756</td><td align="center">77</td><td align="center">90.5</td><td align="center">89.6</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">19</td><td align="center">1767</td><td align="center">55</td><td align="center">93.2</td><td align="center">89.5</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">20</td><td align="center">1653</td><td align="center">73</td><td align="center">91.0</td><td align="center">90.2</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">Ave.</td><td align="center">1754</td><td align="center">64</td><td align="center">92.1</td><td align="center">89.6</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">SD</td><td align="center">120.5</td><td align="center">9.5</td><td align="center">1.17</td><td align="center">0.72</td></tr></tbody></table></table-wrap><table-wrap position="float" id="T5"><label>Table 5</label><caption><p>The results in the ISB test data with the SVM classifier for triply charged spectra</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="center">Times</td><td align="center">FP</td><td align="center">FN</td><td align="center">TPR (%)</td><td align="center">TNR (%)</td></tr></thead><tbody><tr><td align="center">1</td><td align="center">2120</td><td align="center">24</td><td align="center">91.2</td><td align="center">87.7</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">2</td><td align="center">2091</td><td align="center">15</td><td align="center">94.5</td><td align="center">87.8</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">3</td><td align="center">2195</td><td align="center">12</td><td align="center"><bold>95.6</bold></td><td align="center"><bold>87.2</bold></td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">4</td><td align="center">2324</td><td align="center">19</td><td align="center">93.0</td><td align="center">86.5</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">5</td><td align="center">2029</td><td align="center">26</td><td align="center">90.5</td><td align="center">88.2</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">6</td><td align="center">1952</td><td align="center">23</td><td align="center">91.6</td><td align="center">88.6</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">7</td><td align="center">2163</td><td align="center">12</td><td align="center">95.6</td><td align="center">87.4</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">8</td><td align="center">2350</td><td align="center">19</td><td align="center">93.0</td><td align="center">86.3</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">9</td><td align="center">1967</td><td align="center">20</td><td align="center">92.7</td><td align="center">88.5</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">10</td><td align="center">1994</td><td align="center">21</td><td align="center">92.3</td><td align="center">88.4</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">11</td><td align="center">2071</td><td align="center">17</td><td align="center">93.7</td><td align="center">87.9</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">12</td><td align="center">1948</td><td align="center">21</td><td align="center">92.3</td><td align="center">88.7</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">13</td><td align="center">2163</td><td align="center">26</td><td align="center">90.5</td><td align="center">87.4</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">14</td><td align="center">1998</td><td align="center">26</td><td align="center">90.5</td><td align="center">88.4</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">15</td><td align="center">2162</td><td align="center">23</td><td align="center">91.6</td><td align="center">87.4</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">16</td><td align="center">2101</td><td align="center">16</td><td align="center">94.1</td><td align="center">87.8</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">17</td><td align="center">2005</td><td align="center">21</td><td align="center">92.3</td><td align="center">88.3</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">18</td><td align="center">2161</td><td align="center">20</td><td align="center">92.7</td><td align="center">87.4</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">19</td><td align="center">1930</td><td align="center">28</td><td align="center">89.7</td><td align="center">88.7</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">20</td><td align="center">2134</td><td align="center">17</td><td align="center">93.8</td><td align="center">87.6</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">Ave.</td><td align="center">2093</td><td align="center">20</td><td align="center">92.7</td><td align="center">87.8</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">SD</td><td align="center">118.3</td><td align="center">4.6</td><td align="center">1.67</td><td align="center">0.69</td></tr></tbody></table></table-wrap><table-wrap position="float" id="T6"><label>Table 6</label><caption><p>The results in the ISB test data with the SVM classifier for multiply charged spectra</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="center">Times</td><td align="center">FP</td><td align="center">FN</td><td align="center">TPR (%)</td><td align="center">TNR (%)</td></tr></thead><tbody><tr><td align="center">1</td><td align="center">4412</td><td align="center">121</td><td align="center">90.8</td><td align="center">87.3</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">2</td><td align="center">4430</td><td align="center">101</td><td align="center">91.7</td><td align="center">87.2</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">3</td><td align="center">4663</td><td align="center">118</td><td align="center">90.3</td><td align="center">86.5</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">4</td><td align="center">4348</td><td align="center">106</td><td align="center">91.2</td><td align="center">87.4</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">5</td><td align="center">4337</td><td align="center">122</td><td align="center">89.9</td><td align="center">87.5</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">6</td><td align="center">4639</td><td align="center">106</td><td align="center">91.2</td><td align="center">86.6</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">7</td><td align="center">3944</td><td align="center">121</td><td align="center">90.0</td><td align="center">88.6</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">8</td><td align="center">4444</td><td align="center">103</td><td align="center">91.5</td><td align="center">87.2</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">9</td><td align="center">4684</td><td align="center">109</td><td align="center">91.0</td><td align="center">86.5</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">10</td><td align="center">4705</td><td align="center">92</td><td align="center">92.4</td><td align="center">86.4</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">11</td><td align="center">4296</td><td align="center">109</td><td align="center">91.0</td><td align="center">87.6</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">12</td><td align="center">4383</td><td align="center">114</td><td align="center">90.6</td><td align="center">87.3</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">13</td><td align="center">4342</td><td align="center">121</td><td align="center">90.0</td><td align="center">87.5</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">14</td><td align="center">4485</td><td align="center">94</td><td align="center"><bold>92.2</bold></td><td align="center"><bold>87.1</bold></td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">15</td><td align="center">4197</td><td align="center">114</td><td align="center">90.6</td><td align="center">87.9</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">16</td><td align="center">4604</td><td align="center">107</td><td align="center">91.2</td><td align="center">86.7</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">17</td><td align="center">4499</td><td align="center">110</td><td align="center">90.9</td><td align="center">87.0</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">18</td><td align="center">4007</td><td align="center">131</td><td align="center">89.2</td><td align="center">88.4</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">19</td><td align="center">4009</td><td align="center">138</td><td align="center">88.6</td><td align="center">88.4</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">20</td><td align="center">4275</td><td align="center">111</td><td align="center">90.8</td><td align="center">87.7</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">Ave.</td><td align="center">4385</td><td align="center">112</td><td align="center">90.7</td><td align="center">87.3</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">SD</td><td align="center">223.7</td><td align="center">11.4</td><td align="center">0.94</td><td align="center">0.65</td></tr></tbody></table></table-wrap><table-wrap position="float" id="T7"><label>Table 7</label><caption><p>The results in the TOV test data with the SVM classifier for doubly charged spectra</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="center">Times</td><td align="center">FP</td><td align="center">FN</td><td align="center">TPR (%)</td><td align="center">TNR (%)</td></tr></thead><tbody><tr><td align="center">1</td><td align="center">814</td><td align="center">31</td><td align="center">90.2</td><td align="center">84.4</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">2</td><td align="center">925</td><td align="center">23</td><td align="center">92.7</td><td align="center">82.3</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">3</td><td align="center">839</td><td align="center">29</td><td align="center">90.9</td><td align="center">83.9</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">4</td><td align="center">911</td><td align="center">29</td><td align="center">90.9</td><td align="center">82.6</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">5</td><td align="center">856</td><td align="center">24</td><td align="center">92.4</td><td align="center">83.6</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">6</td><td align="center">800</td><td align="center">22</td><td align="center">93.1</td><td align="center">84.7</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">7</td><td align="center">816</td><td align="center">30</td><td align="center">90.5</td><td align="center">84.4</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">8</td><td align="center">920</td><td align="center">15</td><td align="center">95.3</td><td align="center">82.4</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">9</td><td align="center">788</td><td align="center">27</td><td align="center">91.5</td><td align="center">84.9</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">10</td><td align="center">799</td><td align="center">27</td><td align="center">91.5</td><td align="center">84.7</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">11</td><td align="center">790</td><td align="center">30</td><td align="center">90.5</td><td align="center">84.9</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">12</td><td align="center">787</td><td align="center">15</td><td align="center"><bold>95.3</bold></td><td align="center"><bold>84.9</bold></td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">13</td><td align="center">922</td><td align="center">29</td><td align="center">90.9</td><td align="center">82.4</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">14</td><td align="center">766</td><td align="center">27</td><td align="center">91.5</td><td align="center">85.3</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">15</td><td align="center">957</td><td align="center">18</td><td align="center">89.9</td><td align="center">81.7</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">16</td><td align="center">819</td><td align="center">28</td><td align="center">91.2</td><td align="center">84.93</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">17</td><td align="center">871</td><td align="center">22</td><td align="center">93.1</td><td align="center">83.3</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">18</td><td align="center">885</td><td align="center">25</td><td align="center">92.1</td><td align="center">83.1</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">19</td><td align="center">830</td><td align="center">27</td><td align="center">91.5</td><td align="center">84.1</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">20</td><td align="center">823</td><td align="center">23</td><td align="center">92.7</td><td align="center">83.8</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">Ave.</td><td align="center">846</td><td align="center">25</td><td align="center">92.1</td><td align="center">83.8</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">SD</td><td align="center">56.4</td><td align="center">4.8</td><td align="center">1.51</td><td align="center">1.08</td></tr></tbody></table></table-wrap><fig position="float" id="F1"><label>Figure 1</label><caption><p><bold>ROC curve for the SVM classifier for multiply charged ISB spectra</bold>. Even if only 2% loss of high quality multiply charged spectra is allowed, the proposed method can filter out about 70% of the poor quality ones.</p></caption><graphic xlink:href="1471-2105-10-S1-S49-1"/></fig><fig position="float" id="F2"><label>Figure 2</label><caption><p><bold>ROC curve for SVM classifier for doubly charged TOV spectra</bold>. Even if only 2% loss of high quality doubly charged spectra is allowed, the proposed mrthod can filter out over 65% of the poor quality ones.</p></caption><graphic xlink:href="1471-2105-10-S1-S49-2"/></fig><p>Table <xref ref-type="table" rid="T8">8</xref> gives the correct rates of the proposed method and some of the existing methods. From Table <xref ref-type="table" rid="T8">8</xref>, it can be seen that the performances of the methods early proposed by Tabb <italic>et al</italic>. [<xref ref-type="bibr" rid="B8">8</xref>] and Purvine <italic>et al</italic>. [<xref ref-type="bibr" rid="B9">9</xref>] are not good and do not give the values of TPRs. While the TPR is fixed at 90% (i.e., the percentage of losing high quality spectra is fixed at 10%), the best results reported by the existing methods from [<xref ref-type="bibr" rid="B11">11</xref>] and [<xref ref-type="bibr" rid="B14">14</xref>] are that the TNR is about 83%. For the ISB dataset, the TNRs in [<xref ref-type="bibr" rid="B13">13</xref>] and [<xref ref-type="bibr" rid="B14">14</xref>] are obtained at 75% and 83%, respectively. However, for the multiply charged spectra of ISB dataset, on average the proposed method can remove more than 87% of the poor quality spectra while losing about 9% of the high quality ones. This illustrates that the proposed method outperforms these existing methods.</p><table-wrap position="float" id="T8"><label>Table 8</label><caption><p>Correct rates of the proposed method and some existing methods</p></caption><table frame="hsides" rules="groups"><thead><tr><td></td><td align="center">TPR (%)</td><td align="center">TNR (%)</td></tr></thead><tbody><tr><td align="center">SVM2ISB</td><td align="center">92.1</td><td align="center">89.6</td></tr><tr><td align="center">SVM3ISB</td><td align="center">92.7</td><td align="center">87.8</td></tr><tr><td align="center">SVMMISB</td><td align="center">90.7</td><td align="center">87.3</td></tr><tr><td align="center">SVM2TOV</td><td align="center">92.1</td><td align="center">83.8</td></tr><tr><td align="center">Flikka <italic>et al</italic>. [<xref ref-type="bibr" rid="B11">11</xref>]</td><td align="center">90.0</td><td align="center">83.0</td></tr><tr><td align="center">Wong <italic>et al</italic>. [<xref ref-type="bibr" rid="B14">14</xref>]</td><td align="center">90.0</td><td align="center">83.0</td></tr><tr><td align="center">Bern <italic>et al</italic>. [<xref ref-type="bibr" rid="B10">10</xref>]</td><td align="center">90.0</td><td align="center">75.1</td></tr><tr><td align="center">Salmi <italic>et al</italic>. [<xref ref-type="bibr" rid="B12">12</xref>]</td><td align="center">90.0</td><td align="center">75.0</td></tr><tr><td align="center">Na <italic>et al</italic>. [<xref ref-type="bibr" rid="B13">13</xref>]</td><td align="center">90.0</td><td align="center">75.0</td></tr><tr><td align="center">Purvine <italic>et al</italic>. [<xref ref-type="bibr" rid="B9">9</xref>]</td><td align="center">-</td><td align="center">55.0</td></tr><tr><td align="center">Tabb <italic>et al</italic>. [<xref ref-type="bibr" rid="B8">8</xref>]</td><td align="center">-</td><td align="center">40.0</td></tr></tbody></table></table-wrap><p>In addition, Wong <italic>et al</italic>. [<xref ref-type="bibr" rid="B14">14</xref>] did not report the performance of their proposed method for randomly sampled datasets. Bern <italic>et al</italic>. [<xref ref-type="bibr" rid="B10">10</xref>] just reported the best results from their methods. In [<xref ref-type="bibr" rid="B11">11</xref>] and [<xref ref-type="bibr" rid="B13">13</xref>], the 5-fold cross validation was employed to test their proposed approaches. However, they did not report the entire results across per test fold. In [<xref ref-type="bibr" rid="B12">12</xref>], the 10-fold cross-validation was applied to assess the performance of their proposed method. While the TPR is fixed about 90%, the TNR is varied between 43% and 75%, which means that their proposed method is highly sensitive to the variations of the training and test sets in the same dataset. However, the last row in each of Tables <xref ref-type="table" rid="T4">4</xref>, <xref ref-type="table" rid="T5">5</xref>, <xref ref-type="table" rid="T6">6</xref>, <xref ref-type="table" rid="T7">7</xref> gives the standard deviation of our proposed methods over twenty randomly sampled datasets. All the standard deviations for TPR and TNR are very small (from 0.65%&#x02013;1.67%). This indicates that the proposed method is insensitive to the variations of the training and test sets in the same dataset.</p><p>The SVM classifiers are trained with the results of SEQUEST which may also have false positive or false negative. To further illustrate the bias raised from the SEQUEST results, we have investigated the spectra in the false positive set and the false negative set, respectively. For this purpose, we randomly selected 100 false positive spectra (50 doubly charged and 50 triply charged) from the ISB dataset, which are classified as high quality by the proposed method, yet were unidentified by the SEQUEST search program. These 100 spectra were re-searched by on-line MASCOT [<xref ref-type="bibr" rid="B24">24</xref>] against the SwissProt database. The parent mass tolerance was set at &#x000b1; 2 Da, and the fragment ion mass tolerance was set at &#x000b1; 0.5 Da. The enzyme parameter was set as tryptic sequences, and the maximum of missed cleavage site was 1. We found that 14 doubly charged and 8 triply charged spectra had peptide-spectrum matching scores over the cut-off for peptides with significant homology. This indicates that 22% of false positives may be true positive, thus the TNR of our method should be higher. In addition, the 15 spectra out of these 22 spectra are interpreted as the same peptides by SEQUEST (below the cut-off score) and MASCOT (above the cut-off score).</p><p>We also randomly selected 10 false negative spectra, which have high matching scores from SEQUEST method, yet are classified as poor quality by the proposed method. These 10 spectra were also re-searched by on-line MASCOT [<xref ref-type="bibr" rid="B24">24</xref>] against the SwissProt database. We found that the MASCOT ion scores of all these ten spectra were less than 15. This indicates that these 10 spectra may be true negative. To confirm this indication, manual verification by a mass spectrometry expert is required. Figure <xref ref-type="fig" rid="F3">3</xref> shows one of these spectra, which was interpreted as doubly charged ion with peptide 'VAGTWYSLAMAASDI SLLDAQSAPLR' by SEQUEST with a high Xcorr score 3.4848. However, its MASCOT ion score is as low as 2. From Figure <xref ref-type="fig" rid="F3">3</xref>, it is obvious that this spectrum is poor quality because noisy and signal peaks are undistinguishable.</p><fig position="float" id="F3"><label>Figure 3</label><caption><p>A false negative spectrum from the ISB dataset.</p></caption><graphic xlink:href="1471-2105-10-S1-S49-3"/></fig></sec><sec><title>Conclusion</title><p>In this paper, an SVM-based method is proposed for assessing the quality of tandem mass spectra from ion trap mass spectrometers. 16 spectral features are introduced to describe the quality of peptide mass spectra. Each spectrum is mapped into a 16-dimensional feature vector. The SVM is applied to construct the classifier in the feature space that distinguishes the high quality from the poor quality of peptide mass spectra. Four separate SVM classifiers are trained and tested on two different mass spectral datasets: ISB and TOV datasets. Computational experimental results have demonstrated the effectiveness of the proposed method and indicated that the proposed method outperforms the existing methods.</p><p>The significance of the proposed method is three-fold. First, the proposed method provides a reliable evaluation of the spectral quality. Therefore, the poor quality spectra can be filtered out before database search, which significantly reduces the computational time on spectral searching. Second, the proposed method can be employed to evaluate the database search results from one search engine while incorporating with different identification methods. For example, by both re-searching false negative spectra with MASCOT and manual verification, we can confirm that assignments of these spectra by SEQUEST are actually false. Third, the proposed method can be used to identify more significant peptide-spectrum assignments. For example, in this study by searching the false positive spectra (which are determined to be of high quality by the proposed method) with MASCOT, about 22% of these spectra are identified. Although all database searching assignments and our proposed method did not take the post-translationally modified amino acids except for sufloxidized Methionine in this study, our method still can be beneficial in identifying post-translationally modified peptide/proteins. Actually each protein has only a few modified amino acids and each peptide has much fewer modified amino acids. The values of our proposed features may be affected little by only a few modified amino acids. Because of the robustness of our methods, the spectra with modified amino acids are likely determined as high quality. Note that the number of high quality spectra determined by the proposed method is much less than the original spectral dataset. Therefore, it would save a significant amount of time to find post-translationally modified peptides/proteins by just searching those high quality spectra.</p></sec><sec><title>Competing interests</title><p>The authors declare that they have no competing interests.</p></sec><sec><title>Authors' contributions</title><p>AMZ developed the algorithm, designed and conducted all experimental work, and wrote the first draft. JRD participated in the software development, discussion and proofreading of the manuscript. FXW supervised and coordinated this project. FXW and GGP initiated this project and substantially revised the manuscript. All authors read and approved the manuscript.</p></sec></body><back><ack><sec><title>Acknowledgements</title><p>This research was supported by the Natural Sciences and Engineering Research Council of Canada (NSERC). The authors would like to thank Dr. Andrew Keller from Institute for Systems Biology for generously providing spectral data and protein databases for the ISB dataset in this paper.</p><p>This article has been published as part of <italic>BMC Bioinformatics </italic>Volume 10 Supplement 1, 2009: Proceedings of The Seventh Asia Pacific Bioinformatics Conference (APBC) 2009. The full contents of the supplement are available online at <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/10?issue=S1"/></p></sec></ack><ref-list><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Eng</surname><given-names>JK</given-names></name><name><surname>McCormack</surname><given-names>AL</given-names></name><name><surname>Yates</surname><given-names>JR</given-names><suffix>III</suffix></name></person-group><article-title>An approach to correlate tandem mass spectral data of peptides with amino acid sequences in a protein database</article-title><source>Journal of American Society for Mass Spectrometry</source><year>1994</year><volume>5</volume><fpage>976</fpage><lpage>989</lpage><pub-id pub-id-type="doi">10.1016/1044-0305(94)80016-2</pub-id></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Perkins</surname><given-names>DN</given-names></name><name><surname>Pappin</surname><given-names>DJC</given-names></name><name><surname>Creasy</surname><given-names>DM</given-names></name><name><surname>Cottrell</surname><given-names>JS</given-names></name></person-group><article-title>Probability-based protein identification by searching sequence database using mass spectrometry data</article-title><source>Electrophoresis</source><year>1999</year><volume>20</volume><fpage>3551</fpage><lpage>3567</lpage><pub-id pub-id-type="pmid">10612281</pub-id><pub-id pub-id-type="doi">10.1002/(SICI)1522-2683(19991201)20:18&#x0003c;3551::AID-ELPS3551&#x0003e;3.0.CO;2-2</pub-id></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Moore</surname><given-names>RE</given-names></name><name><surname>Young</surname><given-names>MK</given-names></name><name><surname>Lee</surname><given-names>TD</given-names></name></person-group><article-title>Qscore: an algorithm for evaluating SEQUEST database search results</article-title><source>Journal of American Society for Mass Spectrometry</source><year>2002</year><volume>13</volume><fpage>378</fpage><lpage>386</lpage><pub-id pub-id-type="doi">10.1016/S1044-0305(02)00352-5</pub-id></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Keller</surname><given-names>A</given-names></name><name><surname>Nesvizhskii</surname><given-names>AI</given-names></name><name><surname>Kolker</surname><given-names>E</given-names></name><name><surname>Aebersold</surname><given-names>R</given-names></name></person-group><article-title>Empirical statistical model to estimate the accuracy of peptide identifications made by MS/MS and database search</article-title><source>Analytical Chemistry</source><year>2002</year><volume>74</volume><fpage>5383</fpage><lpage>5392</lpage><pub-id pub-id-type="pmid">12403597</pub-id><pub-id pub-id-type="doi">10.1021/ac025747h</pub-id></citation></ref><ref id="B5"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Anderson</surname><given-names>DC</given-names></name><name><surname>Li</surname><given-names>W</given-names></name><name><surname>Payan</surname><given-names>DG</given-names></name><name><surname>Noble</surname><given-names>WS</given-names></name></person-group><article-title>A new algorithm for the evaluation of shotgun peptide sequencing in proteomics: support vector machine classification of peptide MS/MS spectra and SEQUEST scores</article-title><source>Journal of Proteome Research</source><year>2003</year><volume>2</volume><fpage>137</fpage><lpage>146</lpage><pub-id pub-id-type="pmid">12716127</pub-id><pub-id pub-id-type="doi">10.1021/pr0255654</pub-id></citation></ref><ref id="B6"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Razumovskaya</surname><given-names>J</given-names></name><name><surname>Olman</surname><given-names>V</given-names></name><name><surname>Xu</surname><given-names>D</given-names></name><name><surname>Uberbacher</surname><given-names>EC</given-names></name><name><surname>VerBerkmoes</surname><given-names>NC</given-names></name><name><surname>Hettich</surname><given-names>RL</given-names></name><name><surname>Xu</surname><given-names>Y</given-names></name></person-group><article-title>A computational method for assessing peptide-identification reliability in tandem mass spectrometry analysis with SEQUEST</article-title><source>Proteomics</source><year>2004</year><volume>4</volume><fpage>961</fpage><lpage>969</lpage><pub-id pub-id-type="pmid">15048978</pub-id><pub-id pub-id-type="doi">10.1002/pmic.200300656</pub-id></citation></ref><ref id="B7"><citation citation-type="other"><person-group person-group-type="author"><name><surname>Nesvizhskii</surname><given-names>AI</given-names></name><name><surname>Roos</surname><given-names>FF</given-names></name><name><surname>Grossmann</surname><given-names>J</given-names></name><name><surname>Vogelzang</surname><given-names>M</given-names></name><name><surname>Eddes</surname><given-names>JS</given-names></name><name><surname>Gruissem</surname><given-names>W</given-names></name><name><surname>Baginsky</surname><given-names>S</given-names></name><name><surname>Aebersold</surname><given-names>R</given-names></name></person-group><article-title>Dynamic spectrum quality assessment and iterative computational analysis of shotgun proteomic data</article-title><source>Molecular &#x00026; Cellular Proteomics</source><year>2006</year><fpage>652</fpage><lpage>670</lpage><pub-id pub-id-type="pmid">16352522</pub-id></citation></ref><ref id="B8"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Tabb</surname><given-names>DL</given-names></name><name><surname>Eng</surname><given-names>JK</given-names></name><name><surname>Yates</surname><given-names>JR</given-names><suffix>III</suffix></name></person-group><person-group person-group-type="editor"><name><surname>James P</surname></name></person-group><article-title>Protein idebtification by SEQUEST</article-title><source>Proteome Research: Mass Spectrometry</source><year>2001</year><publisher-name>Berlin: Springer</publisher-name></citation></ref><ref id="B9"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Purvine</surname><given-names>S</given-names></name><name><surname>Kolker</surname><given-names>N</given-names></name><name><surname>Kolker</surname><given-names>E</given-names></name></person-group><article-title>Spectral quality assessment for high-throughput tandem mass spectrometry proteomics</article-title><source>OMICS</source><year>2004</year><volume>8</volume><fpage>255</fpage><lpage>265</lpage><pub-id pub-id-type="pmid">15669717</pub-id><pub-id pub-id-type="doi">10.1089/omi.2004.8.255</pub-id></citation></ref><ref id="B10"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Bern</surname><given-names>M</given-names></name><name><surname>Goldberg</surname><given-names>D</given-names></name><name><surname>McDonald</surname><given-names>WH</given-names></name><name><surname>Yates</surname><given-names>JR</given-names><suffix>III</suffix></name></person-group><article-title>Automatic quality assessment of peptide tandem mass spectra</article-title><source>Bioinformatics</source><year>2004</year><volume>20</volume><fpage>i49</fpage><lpage>54</lpage><pub-id pub-id-type="pmid">15262780</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/bth947</pub-id></citation></ref><ref id="B11"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Flikka</surname><given-names>K</given-names></name><name><surname>Martens</surname><given-names>L</given-names></name><name><surname>Vandekerckhove</surname><given-names>J</given-names></name><name><surname>Gevaert</surname><given-names>K</given-names></name><name><surname>Eidhammer</surname><given-names>I</given-names></name></person-group><article-title>Improving the reliability and throughput of mass spectrometry-based proteomics by spectrum quality filtering</article-title><source>Proteomics</source><year>2006</year><volume>6</volume><fpage>2086</fpage><lpage>2094</lpage><pub-id pub-id-type="pmid">16518876</pub-id><pub-id pub-id-type="doi">10.1002/pmic.200500309</pub-id></citation></ref><ref id="B12"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Salmi</surname><given-names>J</given-names></name><name><surname>Moulder</surname><given-names>R</given-names></name><name><surname>Filen</surname><given-names>JJ</given-names></name><name><surname>Nevalainen</surname><given-names>OS</given-names></name><name><surname>Nyman</surname><given-names>TA</given-names></name><name><surname>Lahesmaa</surname><given-names>R</given-names></name><name><surname>Aittokallio</surname><given-names>T</given-names></name></person-group><article-title>Quality classification of tandem mass spectrometry data</article-title><source>Bioinformatics</source><year>2006</year><volume>22</volume><fpage>400</fpage><lpage>406</lpage><pub-id pub-id-type="pmid">16352652</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/bti829</pub-id></citation></ref><ref id="B13"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Na</surname><given-names>S</given-names></name><name><surname>Paek</surname><given-names>E</given-names></name></person-group><article-title>Quality assessment of tandem mass spectra based on cumulative intensity normalization</article-title><source>Journal of Proteome Research</source><year>2006</year><volume>5</volume><fpage>3241</fpage><lpage>3248</lpage><pub-id pub-id-type="pmid">17137325</pub-id><pub-id pub-id-type="doi">10.1021/pr0603248</pub-id></citation></ref><ref id="B14"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wong</surname><given-names>JWH</given-names></name><name><surname>Sullivan</surname><given-names>MJ</given-names></name><name><surname>Cartwright</surname><given-names>HM</given-names></name><name><surname>Cagney</surname><given-names>G</given-names></name></person-group><article-title>msmsEval: tandem mass spectral quality assignment for high-throughput proteomics</article-title><source>BMC Bioinformatics</source><year>2007</year><volume>8</volume><fpage>51</fpage><pub-id pub-id-type="pmid">17291342</pub-id><pub-id pub-id-type="doi">10.1186/1471-2105-8-51</pub-id></citation></ref><ref id="B15"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Vincent</surname><given-names>L</given-names></name></person-group><article-title>Morphological grayscale reconstruction in image analysis: application and efficient algorithm</article-title><source>IEEE Transaction on Image Processing</source><year>1993</year><volume>2</volume><fpage>176</fpage><lpage>201</lpage><pub-id pub-id-type="doi">10.1109/83.217222</pub-id></citation></ref><ref id="B16"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>FX</given-names></name><name><surname>Gagne</surname><given-names>P</given-names></name><name><surname>Droit</surname><given-names>A</given-names></name><name><surname>Poirier</surname><given-names>GG</given-names></name></person-group><article-title>Quality assessment of peptide tandem mass spectra</article-title><source>BMC Bioinformatics</source><year>2008</year><volume>9</volume><fpage>S13</fpage><pub-id pub-id-type="pmid">18541048</pub-id><pub-id pub-id-type="doi">10.1186/1471-2105-9-S6-S13</pub-id></citation></ref><ref id="B17"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Vapnik</surname><given-names>V</given-names></name></person-group><source>Statistical Learning Theory</source><year>1998</year><publisher-name>John Willey &#x00026; Sons</publisher-name></citation></ref><ref id="B18"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Pontil</surname><given-names>M</given-names></name><name><surname>Verri</surname><given-names>A</given-names></name></person-group><source>Properties of support vector machines</source><year>1997</year><publisher-name>Artificial Intelligence Laboratory, C.B.C.L., MIT Press</publisher-name></citation></ref><ref id="B19"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Platt</surname><given-names>J</given-names></name></person-group><article-title>Fast training of support vector machines using sequential minimal optimization</article-title><source>Advances in Kernel Methods &#x02013; Support Vector Learning</source><year>1999</year><publisher-name>MIT Press</publisher-name><fpage>42</fpage><lpage>65</lpage></citation></ref><ref id="B20"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Fawcett</surname><given-names>T</given-names></name></person-group><article-title>An introduction to ROC analysis</article-title><source>Pattern Recognition Letters</source><year>2006</year><volume>27</volume><fpage>861</fpage><lpage>874</lpage><pub-id pub-id-type="doi">10.1016/j.patrec.2005.10.010</pub-id></citation></ref><ref id="B21"><citation citation-type="other"><ext-link ext-link-type="uri" xlink:href="ftp://ftp.ncicfr.gov/pub/nonredun/protein.nrdb.Z"/></citation></ref><ref id="B22"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Gagne</surname><given-names>JP</given-names></name><name><surname>Gagne</surname><given-names>P</given-names></name><name><surname>Hunter</surname><given-names>JM</given-names></name><name><surname>Bonicalzi</surname><given-names>ME</given-names></name><name><surname>Lemay</surname><given-names>JF</given-names></name><name><surname>Kelly</surname><given-names>I</given-names></name><name><surname>Le Page</surname><given-names>C</given-names></name><name><surname>Provencher</surname><given-names>D</given-names></name><name><surname>Mes-Masson</surname><given-names>AM</given-names></name><name><surname>Droit</surname><given-names>A</given-names></name><name><surname>Bourgais</surname><given-names>D</given-names></name><name><surname>Poirier</surname><given-names>GG</given-names></name></person-group><article-title>Proteome profiling of human epithelial ovarian cancer cell line TOV-112D</article-title><source>Molecular &#x00026; Cellular Biochemistry</source><year>2005</year><volume>275</volume><fpage>25</fpage><lpage>55</lpage><pub-id pub-id-type="pmid">16335783</pub-id><pub-id pub-id-type="doi">10.1007/s11010-005-7556-1</pub-id></citation></ref><ref id="B23"><citation citation-type="other"><article-title>Uniref100 Database</article-title><ext-link ext-link-type="uri" xlink:href="http://www.uniprot.org"/></citation></ref><ref id="B24"><citation citation-type="other"><article-title>MASCOT</article-title><ext-link ext-link-type="uri" xlink:href="http://www.matrixscience.com"/></citation></ref></ref-list></back></article>