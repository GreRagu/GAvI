<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd"><article xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Genome Biol</journal-id><journal-title>Genome Biology</journal-title><issn pub-type="ppub">1465-6906</issn><issn pub-type="epub">1465-6914</issn><publisher><publisher-name>BioMed Central</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">18387188</article-id><article-id pub-id-type="pmc">2643934</article-id><article-id pub-id-type="publisher-id">gb-2008-9-4-r63</article-id><article-id pub-id-type="doi">10.1186/gb-2008-9-4-r63</article-id><article-categories><subj-group subj-group-type="heading"><subject>Method</subject></subj-group></article-categories><title-group><article-title>Validation and extension of an empirical Bayes method for SNP calling on Affymetrix microarrays</article-title></title-group><contrib-group><contrib id="A1" contrib-type="author"><name><surname>Lin</surname><given-names>Shin</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>Shin.Lin@uphs.upenn.edu</email></contrib><contrib id="A2" contrib-type="author"><name><surname>Carvalho</surname><given-names>Benilton</given-names></name><xref ref-type="aff" rid="I2">2</xref><email>bcarvalh@jhsph.edu</email></contrib><contrib id="A3" contrib-type="author"><name><surname>Cutler</surname><given-names>David J</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>dcutler@genetics.emory.edu</email></contrib><contrib id="A4" contrib-type="author"><name><surname>Arking</surname><given-names>Dan E</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>arking@jhmi.edu</email></contrib><contrib id="A5" contrib-type="author"><name><surname>Chakravarti</surname><given-names>Aravinda</given-names></name><xref ref-type="aff" rid="I1">1</xref><xref ref-type="aff" rid="I2">2</xref><email>aravinda@jhmi.edu</email></contrib><contrib id="A6" corresp="yes" contrib-type="author"><name><surname>Irizarry</surname><given-names>Rafael A</given-names></name><xref ref-type="aff" rid="I2">2</xref><email>rafa@jhu.edu</email></contrib></contrib-group><aff id="I1"><label>1</label>McKusick-Nathans Institute of Genetic Medicine, Johns Hopkins University School of Medicine, N. Broadway, Baltimore, MD 21205, USA</aff><aff id="I2"><label>2</label>Department of Biostatistics, Johns Hopkins Bloomberg School of Public Health, North Wolfe St. E3035, Baltimore, MD 21205, USA</aff><pub-date pub-type="ppub"><year>2008</year></pub-date><pub-date pub-type="epub"><day>3</day><month>4</month><year>2008</year></pub-date><volume>9</volume><issue>4</issue><fpage>R63</fpage><lpage>R63</lpage><ext-link ext-link-type="uri" xlink:href="http://genomebiology.com/2008/9/4/R63"/><history><date date-type="received"><day>26</day><month>8</month><year>2007</year></date><date date-type="rev-recd"><day>20</day><month>2</month><year>2008</year></date><date date-type="accepted"><day>3</day><month>4</month><year>2008</year></date></history><permissions><copyright-statement>Copyright &#x000a9; 2008 Lin et al.; licensee BioMed Central Ltd.</copyright-statement><copyright-year>2008</copyright-year><copyright-holder>Lin et al.; licensee BioMed Central Ltd.</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0"><p>This is an open access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p><!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>               Lin               Shin                              Shin.Lin@uphs.upenn.edu            </dc:author><dc:title>            Validation and extension of an empirical Bayes method for SNP calling on Affymetrix microarrays         </dc:title><dc:date>2008</dc:date><dcterms:bibliographicCitation>Genome Biology 9(4): R63-. (2008)</dcterms:bibliographicCitation><dc:identifier type="sici">1465-6906(2008)9:4&#x0003c;R63&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1465-6906</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>--></license></permissions><abstract abstract-type="short"><p>Extended and validated CRLMM is shown to be more accurate than the Affymetrix default programs, and datasets and methods for validation are presented that can serve as standard benchmarks by which future SNP chip calling algorithms can be measured.</p></abstract><abstract><p>Multiple algorithms have been developed for the purpose of calling single nucleotide polymorphisms (SNPs) from Affymetrix microarrays. We extend and validate the algorithm CRLMM, which incorporates HapMap information within an empirical Bayes framework. We find CRLMM to be more accurate than the Affymetrix default programs (BRLMM and Birdseed). Also, we tie our call confidence metric to percent accuracy. We intend that our validation datasets and methods, refered to as SNPaffycomp, serve as standard benchmarks for future SNP calling algorithms.</p></abstract></article-meta></front><body><sec><title>Background</title><p>Genome-wide association studies hold great promise in discovering genes underlying complex, heritable disorders for which less powerful study designs have failed in the past [<xref ref-type="bibr" rid="B1">1</xref>-<xref ref-type="bibr" rid="B3">3</xref>]. Much effort spanning academia and industry and across multiple disciplines has already been invested in making this type of study a reality, with the most recent and largest effort being the Human HapMap Project [<xref ref-type="bibr" rid="B4">4</xref>].</p><p>Single nucleotide polymorphism (SNP) microarrays represent a key technology allowing for the high throughput genotyping necessary to assess genome-wide variation and conduct association studies [<xref ref-type="bibr" rid="B5">5</xref>-<xref ref-type="bibr" rid="B9">9</xref>]. Over the years, Affymetrix has introduced SNP microarrays of ever increasing density. The GeneChip<sup>&#x000ae; </sup>Human Mapping 100K and 500K arrays are beginning to be widely used in association studies, and the 6.0 array with &#x0003e;900,000 SNPs has recently been introduced. At these genotype densities, association studies are theoretically well-powered to detect variants of small phenotypic effect in samples involving hundreds to thousands of subjects [<xref ref-type="bibr" rid="B10">10</xref>], and indeed, a number of such successes have recently been reported [<xref ref-type="bibr" rid="B11">11</xref>-<xref ref-type="bibr" rid="B16">16</xref>].</p><p>Practically though, the use of SNP microarrays in association studies has not been entirely straightforward. Genotyping errors, even at a low rate, are known to produce large numbers of putative disease loci, which upon further investigation are found to be false positives. Work by Mitchell and colleagues [<xref ref-type="bibr" rid="B17">17</xref>] suggests a per single SNP rate of 0.5% as a maximal threshold for error, particularly for family-based tests. Arriving short of a dataset with such a low rate of error is not so much a failure of the microarray platform <italic>per se </italic>but rather the inadequacy of current SNP calling programs to extract the greatest information from the raw data and, more importantly, to quantify SNP quality, so that unreliable SNPs may be eliminated from further analysis.</p><p>In general, genotyping algorithms make a call (AA, AB, or BB) for a SNP of each sample assuming diploids. Typically, a confidence measure is also attached to each genotype call. The user can then choose a level of confidence required for a call to be dropped. One of the first algorithms designed for calling SNPs was Adaptive Background genotype Calling Scheme (ABACUS) [<xref ref-type="bibr" rid="B18">18</xref>]. Originally developed for use with the Variation Detection Array (a prototype of current SNP arrays), the method fits Gaussian models using probe intensities associated with a particular SNP of a single chip. A shortcoming of the program is that it has a propensity to drop heterozygous calls. Later, Affymetrix developed Modified Partitioning Around Medoids (MPAM) [<xref ref-type="bibr" rid="B19">19</xref>] as the default algorithm for analysis of the 10K chip. The program aggregates the probe intensities across all chips of a SNP, clusters the result, and assigns a genotype call to each cluster. The method does not perform well when the number of chips input into the program is of moderate size and for SNPs with a low minor allele frequency. The latter became a more serious problem when a larger number of such SNPs appeared on the 100K and 500K arrays. As a result, Affymetrix developed the Dynamic Model (DM) [<xref ref-type="bibr" rid="B20">20</xref>], a method principally based upon ABACUS. Though unaffected by small sample size and low minor allele frequency, DM, like ABACUS, is prone to drop heterozygous calls.</p><p>Recently, Rabbee and Speed [<xref ref-type="bibr" rid="B21">21</xref>] developed a method, the Robust Linear Model with Mahalanobis Distance Classifier (RLMM), along the lines of MPAM's basic framework of assigning calls based on clusters but with several novel features. A large proportion of SNPs on Affymetrix chips (&#x0003e;95%) were genotyped in Centre d'Etude du Polymorphisme Humain samples as part of the HapMap Project [<xref ref-type="bibr" rid="B4">4</xref>], and these data are used as a training set to pre-define the clusters in RLMM. For SNPs in which certain clusters remain ill defined due to low minor allele frequency, a regression strategy is used to infer cluster characteristics. Though this new algorithm makes calls with markedly greater accuracy than DM, it is not robust to variability in procedures used by different laboratories [<xref ref-type="bibr" rid="B21">21</xref>].</p><p>Affymetrix has recently introduced a new algorithm, Bayesian Robust Linear Model with Mahalanobis Distance Classifier (BRLMM) [<xref ref-type="bibr" rid="B22">22</xref>], which is the default program for Affymetrix 100K and 500K SNP chip arrays. It employs DM to make initial guesses and to form a prior for cluster characteristics. Clusters for each SNP are then re-calibrated in an <italic>ad hoc </italic>Bayesian manner; clusters populated with few data points, because of low minor allele frequency say, draw more influence from the prior. Because the laboratory effect resulted in too much across-study-variability, Affymetrix did not use HapMap as training. With their most recent product, the 6.0 array, Affymetrix provides yet another algorithm: Birdseed [<xref ref-type="bibr" rid="B23">23</xref>].</p><p>In the last year, Carvalho and colleagues [<xref ref-type="bibr" rid="B24">24</xref>] developed a pre-processing algorithm designed to remove the bulk of the lab effect. This treatment of the input permitted the use of HapMap as training data. As with BRLMM, an empirical Bayesian method is used to inform lowly populated clusters. The resulting algorithm is referred to as the Corrected Robust Linear Model with Maximum Likelihood Classification (CRLMM).</p><p>The goal in SNP calling algorithm design, thus far, has centred solely on increasing the number of SNPs that can be called with high confidence of accuracy. Little attention has been paid to developing measures of confidence. Each method provides its own metric with no standardization across algorithms. Worse, none of the metrics are explicitly linked to per-SNP accuracy. Questions as to whether metrics from the same algorithm translate to different accuracies based on the quality of the chip experiment remain open. Geneticists hoping to set an accuracy threshold to take SNPs forward for further genetic analysis are left in the dark.</p><p>The first goal of this paper is to describe and validate new features of our algorithm for SNP calling. Treatment of the input data with SNP Robust Multiarray Average (RMA) does not completely eliminate laboratory specific effects; we extend CRLMM to include a recalibration step using the original Bayesian framework to adjust clusters to account for these residual effects. We have also added a procedure that explicitly ties metrics of call confidence to per-SNP accuracy in a manner robust to chip-run quality. Details of both novel features can be found in the Materials and methods section. Because we are the developers of CRLMM, and have no plans of maintaining the original version, we avoid the use of yet another acronym and refer to our new algorithm as CRLMM as well. A software implementation of CRLMM is freely available through the oligo package at Bioconductor [<xref ref-type="bibr" rid="B25">25</xref>,<xref ref-type="bibr" rid="B26">26</xref>], an open development software project running under the statistical computing program R [<xref ref-type="bibr" rid="B27">27</xref>,<xref ref-type="bibr" rid="B28">28</xref>].</p><p>Our second goal is to describe validation benchmarks to be used in the future by other software developers for comparison purposes, as has been done for expression array algorithms with <italic>affycomp </italic>[<xref ref-type="bibr" rid="B29">29</xref>]. Beyond improving the genotype calling of existing chip arrays, this work lays down objectives and conventions to guide the development of future algorithms for calling emerging arrays of ever-increasing SNP density. The importance of sound assessment protocols is underscored by the recent formation of an NIH led effort to compare algorithms: the Genetic Association Information Network (GAIN) Alternative Calling Algorithms Working Group.</p><p>In the Results section we use our validation benchmarks to compare our new method (CRLMM) to the most widely used algorithm to date (BRLMM). We find that CRLMM provides more accurate genotype calls across datasets; at a high per-call accuracy, the drop rate of BRLMM is substantially higher than that of CRLMM across multiple datasets. Furthermore, CRLMM offers substantially improved estimates of accuracy. A less comprehensive comparison between CRLMM and Birdseed is included in the Discussion. Note that as more 6.0 data becomes publicly available, we will readily perform all our assessments on the new data and publish results on our SNPaffycomp website [<xref ref-type="bibr" rid="B30">30</xref>].</p></sec><sec><title>Results</title><p>The development of CRLMM involved training on the high quality Affymetrix HapMap array sets using HapMap Project genotypes as the correct calls [<xref ref-type="bibr" rid="B4">4</xref>]. CRLMM and BRLMM were then applied to high quality published Affymetrix HapMap data and newer first pass HapMap array data from the Broad Institute and Affymetrix. To compare the two algorithms, we generated accuracy versus drop rate plots (ADPs). Specifically, each point in the graph represents the proportion of calls above a given quality threshold in agreement with the HapMap Project. The quality threshold, which is based on the program-specific confidence metrics, is set such that the fraction of calls beneath it is the drop rate (of note, we use '1 - distance ratio' as the BRLMM confidence metric). CRLMM outperforms BRLMM in accuracy over a wide range of dropped call rates using the gold standard from the HapMap Project genotypes (Figure <xref ref-type="fig" rid="F1">1a,b</xref>). This result holds not only for the high quality Affymetrix set (Figure <xref ref-type="fig" rid="F1">1a</xref>; Figure S1 in Additional data file 1), which is expected since CRLMM was trained on it, but also for the first pass data (Figure <xref ref-type="fig" rid="F1">1b</xref>) and for data stratified into homozygote and heterozygote calls (Figure S1 in Additional data file 1).</p><fig position="float" id="F1"><label>Figure 1</label><caption><p>Accuracy versus ADPs for CRLMM (orange) and BRLMM (purple). Drop rates between 0 and 10% are examined. <bold>(a) </bold>ADPs are plotted for 269 HapMap samples hybridized by Affymetrix on 100K chips (XBA and HIND). Only high-quality hybridization data, as defined by Affymetrix, are used in this plot. The gold standard is HapMap calls. <bold>(b) </bold>ADPs are plotted for first-pass data from 152 and 95 samples hybridized on the 500K chips (Nsp and Sty) from the Broad Institute and Affymetrix, respectively. Again, the gold standard is HapMap calls. <bold>(c) </bold>ADPs are plotted for the 32 and 16 high quality replicates hybridized on XBA and Nsp chips. The consensus of the 32 and 16 high quality replicate chips is considered the gold standard for each chip type. Separate gold standards are derived from each calling algorithm result. These data were generated from the Chakravarti Lab. <bold>(d) </bold>ADPs are plotted for the 30 high quality trios hybridized on XBA and Nsp chips. Accuracy for trios is defined as percent of SNP trios that are Mendelian consistent. The trios may not have any dropped calls. The data were generated from the Chakravarti Lab.</p></caption><graphic xlink:href="gb-2008-9-4-r63-1"/></fig><p>One may critique the above result by pointing out CRLMM has an unfair advantage over BRLMM for the datasets used; CRLMM was trained on data generated from HapMap individuals. Moreover, the calls from the HapMap Project are known to have an error rate of their own. To examine whether CRLMM outperforms BRLMM for array data from other individuals, the two algorithms were applied to a set including both multiple replicate and trio samples on the Xba and Nsp chips of the 100K and 500K arrays, respectively. The replicate and trio files were run together because running the former files exclusively would be highly artificial, making results ungeneralizable. The gold standards for the replicate data were the majority call among high quality chips. Accuracy was then defined as agreement with these consensus sets, which were generated separately for each dataset and calling method. The trio data were scored by tabulating the fraction of SNP trios (mother, father, and child) not violating Mendelian inheritance among those without any dropped calls. As with the HapMap validation, the accuracy for these two types of files was examined at different drop rates. The ADPs of both the replicates and trios demonstrate that CRLMM makes calls more accurately than BRLMM on non-HapMap sets (Figure <xref ref-type="fig" rid="F1">1c,d</xref>). These data afford alternative ways of comparing algorithms since large datasets with independent verification by multiple genotyping modalities do not exist other than those relating to the HapMap Project.</p><p>An alternative, quantitative presentation of the same data above can be found in Table <xref ref-type="table" rid="T1">1</xref>. For the Affymetrix first-pass Sty set, we eliminated all SNPs with a predicted per-call accuracy less than 0.995 and calculated the average accuracy of the remaining data to be 0.99915. Applying this average accuracy to other datasets as a rough approximation to a per-call accuracy of 0.995, CRLMM achieves a drop rate of 0.6 to 24% in the datasets examined. The datasets incurring high drop rates for CRLMM include poor quality chips; these same sets yield drop rates of greater than 50% for BRLMM. Setting aside these datasets, CRLMM's drop rate was 2 to 7 times lower than for BRLMM (4.46 to 2.28% and 42 to 5.65%, respectively).</p><table-wrap position="float" id="T1"><label>Table 1</label><caption><p>Drop rate at an average accuracy of 0.99915</p></caption><table frame="hsides" rules="groups"><thead><tr><td></td><td align="center" colspan="2">Drop rate</td><td></td></tr><tr><td></td><td colspan="2"><hr></hr></td><td></td></tr><tr><td align="left">Dataset</td><td align="center">BRLMM</td><td align="center">CRLMM</td><td align="center">Relative rate</td></tr></thead><tbody><tr><td align="left">Affymetrix high-quality XBA arrays</td><td align="center">0.0115</td><td align="center">0.00575</td><td align="center">2.00</td></tr><tr><td align="left">Affymetrix high-quality HIND arrays</td><td align="center">0.0446</td><td align="center">0.0228</td><td align="center">1.95</td></tr><tr><td align="left">Affymetrix high-quality STY arrays</td><td align="center">0.0873</td><td align="center">0.0171</td><td align="center">5.10</td></tr><tr><td align="left">Broad Institute first-pass STY arrays</td><td align="center">-</td><td align="center">0.241</td><td align="center">-</td></tr><tr><td align="left">Affymetrix first-pass STY arrays</td><td align="center">-</td><td align="center">0.110</td><td align="center">-</td></tr><tr><td align="left">Affymetrix high-quality NSP arrays</td><td align="center">0.086</td><td align="center">0.0347</td><td align="center">2.48</td></tr><tr><td align="left">Broad Institute first-pass NSP arrays</td><td align="center">-</td><td align="center">0.180</td><td align="center">-</td></tr><tr><td align="left">Affymetrix first-pass NSP arrays</td><td align="center">-</td><td align="center">0.231</td><td align="center">-</td></tr><tr><td align="left">Chakravarti XBA replicate arrays</td><td align="center">-</td><td align="center">0.110</td><td align="center">-</td></tr><tr><td align="left">Chakravarti NSP replicate arrays</td><td align="center">0.42</td><td align="center">0.0565</td><td align="center">7.43</td></tr></tbody></table><table-wrap-foot><p>Drop rates greater than 0.50 to reach the desired average accuracy are not considered.</p></table-wrap-foot></table-wrap><p>CRLMM allows for the identification of these poor quality chips. It is well known that the inclusion of poor quality chips in a dataset may distort calling algorithms to such a degree that mistaken calls are made even on high quality chips. Therefore the identification and exclusion of poor quality chips is vital in any analysis. In this regard, BRLMM proves to be inadequate; using a summary statistic based on BRLMM confidence metrics will not accurately reflect the chip quality. As an example, consider one of the samples in the Affymetrix first pass Sty data; measured against the HapMap as the gold standard, it has an average accuracy less than 33% whether it is called by BRLMM or CRLMM. This degree of accuracy can be achieved by guessing, which implies that no information is provided by the array. Yet, Figure <xref ref-type="fig" rid="F2">2a</xref> demonstrates that BRLMM calls 10,000 SNPs at a very high confidence level (confidence measure &#x0003e;0.95). The implication is that the BRLMM confidence measure cannot be used to gauge the overall quality of a chip, because its meaning is distorted for poor quality chips; in fact, Affymetrix suggests the use of DM to exclude poor quality chips before applying BRLMM. On the other hand, the signal to noise ratio (SNR) measure we have developed (see Materials and methods) is an excellent predictor of chip-specific accuracy (Figure <xref ref-type="fig" rid="F2">2b</xref>).</p><fig position="float" id="F2"><label>Figure 2</label><caption><p>Accuracy prediction plots for Affymetrix first pass Sty HapMap samples. <bold>(a) </bold>A histogram of the BRLMM confidence measure is plotted for a sample chip with an average accuracy lower than 33% called by either BRLMM or CRLMM. <bold>(b) </bold>The graph shows a scatter plot of average accuracy of chips as called by BRLMM versus SNR. The y-axis is in the logit scale; the x-axis, the log scale.</p></caption><graphic xlink:href="gb-2008-9-4-r63-2"/></fig><p>Not only is the BRLMM confidence metric invalid for poor quality chips, it corresponds to different accuracies from dataset to dataset. Figure <xref ref-type="fig" rid="F3">3a,b</xref> show plots similar to the ADPs as before for datasets of different quality and from different labs; however, the drop rate is replaced with confidence metric thresholds on the abscissa. The plot for BRLMM (Figure <xref ref-type="fig" rid="F3">3a</xref>) shows a wide variation in accuracy across different datasets for any given confidence threshold. The implication of this finding is that a BRLMM confidence threshold found to give an acceptable accuracy rate in distal analyses for one dataset may not apply to another set. In contrast, the plot for CRLMM (Figure <xref ref-type="fig" rid="F3">3b</xref>) demonstrates that its confidence measure has greater robustness to laboratory and chip quality effects.</p><fig position="float" id="F3"><label>Figure 3</label><caption><p>Robustness to bad quality chips. Accuracy is plotted against confidence thresholds for various datasets. In other words, the data in Figure 1 are plotted again except that the confidence measures used previously to achieve specified drop rates are now placed on the x-axis. Results of all HapMap datasets are shown from <bold>(a) </bold>BRLMM and <bold>(b) </bold>CRLMM. <bold>(c) </bold>Accuracy versus confidence plots (ACPs) are made for BRLMM (purple) and CRLMM (orange). The points are further stratified by call type according to the HapMap gold standard. The STY and NSP are the array types described in the text. Hmz and Htz are abbreviations for homozygous and heterozygous, respectively.</p></caption><graphic xlink:href="gb-2008-9-4-r63-3"/></fig><p>Ultimately, the end-user must have a per-call measure of accuracy to identify which SNPs to exclude from further analysis. Labs using BRLMM are left to their own devices to connect the program's confidence metric to accuracy. In Figure <xref ref-type="fig" rid="F3">3c</xref>, we divide the data by quantiles with respect to the confidence metric and make average accuracy versus average confidence plots (ACPs). The ACPs for BRLMM derived data show that connecting the confidence metric to accuracy is not straightforward, because the metric appears to correspond to different accuracies depending on whether the call is heterozygous or homozygous. The ACPs for CRLMM on the other hand do not show this difference. In fact, that the plot closely follows the diagonal demonstrates the CRLMM confidence metric may be treated as the predicted per-call accuracy. ACPs comparing BRLMM and CRLMM results for other datasets are shown in Figure S2 in Additional data file 1.</p></sec><sec><title>Discussion</title><p>The first step in a useful genotyping algorithm is transforming raw data into genotype calls. As we have demonstrated, the quality of these calls can vary. A second step in a useful genotyping algorithm is to quantify how certain we are about our calls. We have improved our previous algorithm [<xref ref-type="bibr" rid="B24">24</xref>] as a solution to step one. A naive approach for step 2 was described in that work as well, but our comparison tool demonstrated that it did not perform well (data not shown). In this paper we additionally develop a more sophisticated version of the second step and demonstrate important practical implications.</p><p>Across datasets from multiple laboratories and by different methods of validation, CRLMM is just as, and in many cases more, accurate than BRLMM in calling genotypes from Affymetrix SNP chips. This result is due in large part to the utilization of HapMap information in making calls. Figure <xref ref-type="fig" rid="F4">4</xref> shows a SNP for which the intensities in BRLMM's Contrast Center Stretch space [<xref ref-type="bibr" rid="B22">22</xref>] clusters poorly in comparison to the CRLMM cluster regions formed from training on HapMap data. The HapMap influence is built into the CRLMM algorithm; calls are informed by the high-quality HapMap data without users having to seed their input data with files generated from the project. In addition, the greater accuracy at higher dropped call rates, as observed in Figure <xref ref-type="fig" rid="F1">1a</xref>, is due to the greater discriminating power of the CRLMM confidence metric to predict which calls are more likely to be correct.</p><fig position="float" id="F4"><label>Figure 4</label><caption><p>Genotype regions. These plots display the space on which clusters are assigned genotypes. Colors represent HapMap gold standard calls; numbers represent the calls made by the array algorithms. For SNP SNP_A-1676170, <bold>(a) </bold>BRLMM genotype regions are shown in the Contrast Center Stretch (CCS) space. The x-axis is a contrast measure that captures the relative intensity difference of allele A with B. The y-axis is related to the average intensity from the A and B alleles. See the BRLMM white paper for more details [22]. For the same SNP, <bold>(b) </bold>CRLMM regions are plotted. The log ratios of allele A to allele B from intensities derived from probesets of the sense (y-axis) and antisense (x-axis) orientation are shown (that is, <italic>M</italic><sub>+ </sub>versus <italic>M</italic><sub>- </sub>plot). The ellipses represent the cluster regions obtained from the HapMap training set.</p></caption><graphic xlink:href="gb-2008-9-4-r63-4"/></fig><p>An apparent improvement of BRLMM over DM is that the former no longer has a propensity to drop heterozygous calls at a given confidence threshold. To assure equal drop rates for homozygous and heterozygous calls, we found that Affymetrix altered the confidence metric. The end result is that the metric corresponds to different accuracies for homozygous as compared to heterozygous calls (Figure <xref ref-type="fig" rid="F3">3c</xref>). We also believe this feature results in artefact that explain the slight reduction in accuracy with increased drop-rates seen for BRLMM in Figure <xref ref-type="fig" rid="F1">1d</xref>: for higher accuracy calls, errors are more confounded with call types (heterozygous or homozygous), resulting in more Mendelian inconsistencies. We do not implement such an approach because the greater difficulty in calling a heterozygous genotype is an intrinsic characteristic of the array technology. Our approach is to report an accurate confidence measure rather than one that assures equal drop rates.</p><p>It is true that the use of a single cut-off for CRLMM derived data will incur more heterozygous drop-out (Figure S3 from Additional data file 1), a result that may bias distal analyses. Nevertheless, uniform drop rates can still be easily achieved by choosing a more stringent confidence cut-off for homozygotes; in this way, calls can be both above a pre-specified accuracy threshold and have equivalent drop rates between homozygotes and heterozygotes. One may wonder whether these steps can be legitimately applied to results from an algorithm, since calls and confidence metrics are not made with absolute certainty. Figure S4 from Additional data file 1 demonstrates this concern to be largely unfounded. Figure S5 from Additional data file 1 shows that even after forcing drop rates to be the same between heterozygotes and homozygotes, CRLMM results at different accuracy thresholds are still more accurate than BRLMM. In the end, we do not view the equalization of drop rates to be a definitive solution to this problem; rather, modifications to statistical methodologies for association and linkage studies are required to account for this factor.</p><p>Just as important as accuracy are assessments of quality for both chips and calls. We have shown that the BRLMM confidence metric is inadequate for chip quality determination, corresponds to different accuracies from dataset to dataset, and even has different meanings for homozygotes and heterozygotes on the same chip. Regarding the assessment of chip quality, it should be noted that Affymetrix recommends running DM to eliminate poor quality chips prior to using BRLMM [<xref ref-type="bibr" rid="B22">22</xref>]. For CRLMM, this step is trivial; chips with SNRs below 4.5 and 2.36 for the 100K and 500K chips, respectively, should be excluded from further analysis.</p><p>In theory, a confidence metric may be defined over any space. One may believe that so long as it proves to be stable over datasets and call types, it will be of optimal utility. All an end-user needs to do is consult an ADP plot to set an accuracy threshold over which SNPs can be taken forward for further analysis. This notion is false. The reason is that the accuracy so calculated is an average of individual SNPs with corresponding variable accuracy. Within this range, there will be a significant portion of individual SNPs of lower accuracy than the average value. To address this problem, we made CRLMM's confidence metric per-call accuracy. We feel methodologies developed in the future will be of greater utility if this convention is followed.</p><p>It is not inconceivable that new methods of genotype calling that surpass CRLMM will be devised. Moreover, Affymetrix will continue to design new SNP arrays; adaptations of old algorithms for these chips will require additional validation. Algorithms of the future may prove to be more accurate, as demonstrated by ADPs, and have confidence metrics even more reflective of true accuracy, as exhibited by ACPs. In fact, the most important aspect of this work is laying the ground work for a standard set of assessments by which different methodologies may be measured against each other. Indeed, we already have included comparisons of CRLMM to Birdseed (Affymetrix default algorithm for 6.0 array). Figure <xref ref-type="fig" rid="F5">5</xref> shows two of our assessments performed on HapMap samples analyzed with the 6.0 array. CRLMM continues to perform better and, in particular, demonstrates better performance across laboratories.</p><fig position="float" id="F5"><label>Figure 5</label><caption><p>Comparison to Birdseed. <bold>(a) </bold>As Figure 1 but for 6.0 data and Birdseed instead of BRLMM. <bold>(b) </bold>As Figure 3 but for 6.0 data and Birdseed instead of BRLMM.</p></caption><graphic xlink:href="gb-2008-9-4-r63-5"/></fig><p>The datasets used in this study is freely available at our SNPaffycomp website [<xref ref-type="bibr" rid="B31">31</xref>] at which one will also be able to review results of different algorithms. The establishment of standard benchmarks for Affymetrix SNP chip analysis is analogous to that already done for the sister technology of Affymetrix expression arrays, the so-called Affycomp [<xref ref-type="bibr" rid="B29">29</xref>].</p></sec><sec sec-type="materials|methods"><title>Materials and methods</title><sec><title>Datasets</title><p>We used several HapMap datasets representing runs of varying quality, different labs, and different times. The publicly available high quality HapMap Project data are on 269 individuals genotyped on 100K arrays [<xref ref-type="bibr" rid="B32">32</xref>] by Affymetrix [<xref ref-type="bibr" rid="B4">4</xref>]. High quality 500K [<xref ref-type="bibr" rid="B33">33</xref>] and 6.0 chip data run by Affymetrix are also available on all 270 HapMap samples [<xref ref-type="bibr" rid="B30">30</xref>].</p><p>Another two sets of 500K chip results from 95 and 152 HapMap individuals were provided to us by Affymetrix and the Broad Institute, respectively; these data differed from the aforementioned sets principally in that they were derived from first pass runs of variable albeit typical quality. Two 6.0 array datasets, from 44 and 96 HapMap samples, were run at the Chakravarti laboratory for testing purposes.</p><p>The other Chakravarti laboratrory datasets were generated from non-HapMap individuals. A replicate dataset composed of 40 50K Xba chips (part of the 100K chipset) run on a single DNA sample were used as well as 30 trios. Eight of the 40 replicates were of low quality as assessed by SNR. Similarly for the 250K Nsp chip (part of the 500K chipset), the Chakravarti lab provided a replicate dataset of 16 chips and 30 trios. All 16 replicates were of high quality. All trio data for both the Xba and Nsp chips were of high quality. Replicates were performed with the same DNA prep but all subsequent steps - ligation, amplification, fragmentation and hybridization - were repeated on different chips.</p></sec><sec><title>Measures of accuracy</title><p>The HapMap sample gold standard against which outputs from either BRLMM or CRLMM are compared is derived from the final HapMap Project genotype calls (data release 22) made on a number of platforms other than Affymetrix arrays [<xref ref-type="bibr" rid="B4">4</xref>]. Only a small fraction of SNPs represented on Affymetrix arrays are not typed in the HapMap Project. Though highly accurate in total, HapMap Project calls are by no means perfect. Nevertheless, there is no expectation that mistakes in HapMap should favor one genotype calling method over another. There are several SNPs for which the allele names are obviously reversed between HapMap and Affymetrix and, thus, these SNPs were corrected by hand.</p><p>For the replicate data, high quality chips (operationally defined as having an SNR greater than 4.5 and 2.36 for the 100K and 500K chips, respectively, as explained above) are used in deriving the gold standard. For each SNP, calls for the three genotypes are tallied across the replicates. The genotype comprising greater than 50% of the calls is designated the gold standard call. SNPs not meeting this criterion are excluded from validation. Distinct gold standards are generated for each chip and method.</p><p>In both the HapMap and replicate data validation, accuracy versus dropped rate curves are plotted. Each point on the plots represents the mean number of SNPs correctly called ignoring a specified percent of the lowest quality SNPs. Quality is assessed by program specific metrics of confidence, that is, 1 - ratio distance and percent accuracy for BRLMM and CRLMM, respectively.</p><p>For trio data, family structures are exploited to measure the accuracy of genotype calling. The number of Mendelian errors is tabulated at a given dropped call rate. The resulting value is subtracted from and divided by the number of SNP trios that have no dropped calls to give an accuracy rate.</p></sec><sec><title>Pre-processing and genotyping algorithm</title><p>A brief summary of the pre-processing and genotyping algorithms is presented here; for a more technical treatment, see Carvalho <italic>et al</italic>. [<xref ref-type="bibr" rid="B24">24</xref>]. Starting with the feature level data available in the CEL files provided by Affymetrix, we summarize the probes associated with each SNP in a manner similar to RMA [<xref ref-type="bibr" rid="B34">34</xref>]. The resultant values are proportional to the log<sub>2 </sub>of the quantity of DNA in the target sample associated with alleles <italic>A </italic>and <italic>B</italic>. Sense and antisense information are kept separately to allow the correct calling of the genotype by one strand when the other is non-informative [<xref ref-type="bibr" rid="B24">24</xref>]. We denote these values as &#x003b8;<sub>A,-</sub>, &#x003b8;<sub>B,-</sub>, &#x003b8;<sub>A,+</sub>, &#x003b8;<sub>B,+</sub>, and transform them into the log ratio <italic>M</italic><sub>- </sub>= &#x003b8;<sub>A,- </sub>- &#x003b8;<sub>B,- </sub>and <italic>M</italic><sub>+ </sub>= &#x003b8;<sub>A,+ </sub>- &#x003b8;<sub>B,+ </sub>and average log intensities <italic>S</italic><sub>- </sub>= (&#x003b8;<sub>A,- </sub>+ &#x003b8;<sub>B,-</sub>)/2 and <italic>S</italic><sub>+ </sub>= (&#x003b8;<sub>A,+ </sub>+ &#x003b8;<sub>B,+</sub>)/2.</p><p>We denote the log-ratio of SNP <italic>i </italic>from sample <italic>j </italic>by <italic>M</italic><sub><italic>i</italic>,<italic>j </italic></sub>with sense and antisense orientation denoted by <italic>s </italic>= +,-. We code the genotypes by <italic>k </italic>= 1, 2, 3 for AA, AB, and BB, respectively. In general, <italic>M </italic>values impart strong discriminatory power (Figure <xref ref-type="fig" rid="F4">4</xref>), though there is SNP to SNP variation (Figure <xref ref-type="fig" rid="F6">6</xref>). Also, SNPs with inferior separability are associated with long target fragment lengths or extreme values of <italic>S</italic>, which is demonstrated in Figure <xref ref-type="fig" rid="F7">7a</xref>. We describe these effects with a simple mixture model. To simplify the fitting procedure we estimate the model separately on each array and treat the sense and antisense features as exchangeable. We therefore drop the <italic>j </italic>and <italic>s </italic>notation and write:</p><fig position="float" id="F6"><label>Figure 6</label><caption><p>Comparison of SNP quality. CRLMM regions are plotted in log ratio space for <bold>(a) </bold>a high quality SNP (SNP_A-1750453) and <bold>(b) </bold>a low quality SNP (SNP_A-1709733). Hmz and Htz are abbreviations for homozygous and heterozygous, respectively.</p></caption><graphic xlink:href="gb-2008-9-4-r63-6"/></fig><fig position="float" id="F7"><label>Figure 7</label><caption><p>Log intensity ratios (allele A versus B), denoted with <italic>M</italic>, for all SNPs on one chip plotted against average log intensity <italic>S </italic>values. Both sense and antisense values are shown in all plots. A scatter-plot of these data would include 500,000 points and thus would be hard to interpret. We therefore show two-dimensional histograms with dark and light shades of blue indicating the existence of many and few points, respectively. <bold>(a) </bold>High quality array. <bold>(b) </bold>Low quality array.</p></caption><graphic xlink:href="gb-2008-9-4-r63-7"/></fig><p><disp-formula>[<italic>M</italic><sub><italic>j </italic></sub>| <italic>Z</italic><sub><italic>i </italic></sub>= <italic>k</italic>] = <italic>f</italic><sub><italic>k</italic></sub>(<italic>X</italic><sub><italic>i</italic></sub>) + <italic>e</italic><sub><italic>i</italic>,<italic>k</italic></sub></disp-formula></p><p>where the <italic>X</italic><sub><italic>i </italic></sub>represents covariates known to cause bias, <italic>f</italic><sub><italic>k </italic></sub>describes the effect associated with these covariates, and <italic>e</italic><sub><italic>i</italic>,<italic>k </italic></sub>captures the error term, which we assume to be a random normal variable with mean 0 and constant variance. Further, we assume <italic>f</italic><sub><italic>1</italic></sub> = <italic>f</italic><sub><italic>3</italic></sub> and <italic>f</italic><sub><italic>2</italic></sub> = <italic>0</italic>.</p><p>Motivated by Figure <xref ref-type="fig" rid="F7">7a</xref>, we include fragment length <italic>L </italic>and the average intensity <italic>S </italic>as covariates and model:</p><p><disp-formula><italic>f</italic><sub>1</sub>(<italic>L</italic><sub><italic>i</italic></sub>;<italic>S</italic><sub><italic>i</italic></sub>) = <italic>f</italic><sub><italic>L</italic></sub>(<italic>L</italic><sub><italic>i</italic></sub>) + <italic>f</italic><sub><italic>S</italic></sub>(<italic>S</italic><sub><italic>i</italic></sub>)</disp-formula></p><p>with <italic>f</italic><sub><italic>L</italic>,</sub> as a cubic spline having three degrees of freedom and <italic>f</italic><sub><italic>S</italic></sub> as a cubic spline having five degrees of freedom. We fit the model using the Expectation-Maximization (EM) algorithm. Examples of the estimated <italic>f</italic><sub><italic>L</italic></sub> and <italic>f</italic><sub><italic>S</italic></sub> are included in Figure <xref ref-type="fig" rid="F7">7a</xref>. A high quality hybridization will separate genotypes, that is, the signal <italic>f</italic><sub><italic>1</italic></sub> will be larger than the standard deviation of errors <italic>e</italic>.</p><p>The fitted models can also be used to obtain genotype calls by estimating and maximizing the probability of each class for each SNP. However, for all SNPs for which we have HapMap calls (available for about 96% of SNPs on the arrays), we use a supervised learning approach, which yields more accurate genotype calls. We use these calls to define 'known' genotypes, which in turn permits us to define a training set. For SNPs with no HapMap calls we use the estimates from the model described above to define the 'known' classes. With the training data in place we use a two-stage hierarchical model and give likelihood-based closed-form definitions of the genotype regions. For each SNP, we define two-dimensional genotype regions based on the sense and antisense <italic>M </italic>values. The utility of the hierarchical model is most apparent for SNP regions for which there are few observations in the training step. Using empirically derived priors for the centers and scales of the genotype regions, we give a closed form empirical Bayes solution to predict centers and scales for cases with few or no observations.</p><p>Let <italic>Z</italic><sub><italic>i</italic>,<italic>j </italic></sub>be the unknown genotype for SNP <italic>i </italic>on sample <italic>j</italic>. Figures <xref ref-type="fig" rid="F4">4b</xref> and <xref ref-type="fig" rid="F6">6</xref> demonstrate that the locations of these genotype regions are SNP specific. Furthermore, these pictures suggest that the behavior of the log-ratio pairs can be modeled by bivariate normal distributions. We use a two-level hierarchical multi-chip model with the first level describing the variation seen in the location of genotype regions across SNPs and the second, the variation seen across samples within each SNP. The model can be written out as:</p><p><disp-formula>[<italic>M</italic><sub><italic>i</italic>,<italic>j</italic>,<italic>s </italic></sub>| <italic>Z</italic><sub><italic>i</italic>,<italic>j </italic></sub>= <italic>k</italic>;<italic>m</italic><sub><italic>i</italic>,<italic>k</italic>,<italic>s</italic></sub>] = <italic>f</italic><sub><italic>j</italic>,<italic>k</italic></sub>(<italic>X</italic><sub><italic>i</italic>,<italic>j</italic>,<italic>s</italic></sub>) + <italic>m</italic><sub><italic>i</italic>,<italic>k</italic>,<italic>s </italic></sub>+ <italic>e</italic><sub><italic>i</italic>,<italic>j</italic>,<italic>k</italic>,<italic>s</italic></sub></disp-formula></p><p>Here, <italic>X</italic><sub><italic>i</italic>,<italic>j</italic>,<italic>s </italic></sub>and <italic>f</italic><sub><italic>j</italic>,<italic>k </italic></sub>are as above but with the <italic>j </italic>and <italic>s </italic>notation re-introduced, <italic>m</italic><sub><italic>i</italic>,<italic>k</italic>,<italic>s </italic></sub>is the SNP-specific shift from the typical genotype region centers, and <italic>e</italic><sub><italic>i</italic>,<italic>j</italic>,<italic>k</italic>,<italic>s </italic></sub>represents measurement error. We expect different samples to have different biases; thus, the effects function <italic>f </italic>now depends on <italic>j</italic>. Notice that the SNP-specific covariates <italic>X </italic>also depend on the sample because the average signal <italic>S </italic>may vary from sample to sample. The '<italic>m</italic>'s represent the cluster center shifts not accounted for by the covariates included in <italic>X</italic>. To define the first level of our model, we denote the vector of SNP-specific region centers with m<sub><italic>i</italic></sub><italic> = </italic>(<italic>m</italic><sub><italic>i</italic>,<italic>1</italic>,+</sub>, <italic>m</italic><sub><italic>i</italic>,<italic>2</italic>,+</sub>, <italic>m</italic><sub><italic>i</italic>,<italic>3</italic>,+</sub>, <italic>m</italic><sub><italic>i</italic>,<italic>1</italic>,-</sub>, <italic>m</italic><sub><italic>i</italic>,<italic>2</italic>,-</sub>, <italic>m</italic><sub><italic>i</italic>,<italic>3</italic>,-</sub>). We model the distribution of this vector with a multivariate normal distribution. Notice that, by definition, m is centered at 0, since the mean levels of the three genotypes are absorbed into <italic>f</italic>. The second level of the model, the variability seen within the genotypes for each SNP, is described by the '<italic>e</italic>'s. We assume these to be independent (conditioned on genotype <italic>Z</italic>) normally distributed random variables across samples and SNPs. We use an inverse chi-squared prior to improve estimates of the variance structure when not enough data are available. Because the large number of SNPs permit us to estimate the <italic>f</italic><sub><italic>j</italic></sub>s precisely, for simplicity, we treat them as known. With this estimate of <italic>f</italic><sub><italic>j </italic></sub>in place for each sample, all we need to make our likelihood-based genotype calls are estimates of the centers and scales. The key idea is to consider the HapMap calls as known genotypes and use this information to obtain maximum likelihood estimates. A second step is to update these estimates with posterior means derived from the hierarchical model. The mathematical details are described in Carvalho <italic>et al</italic>. [<xref ref-type="bibr" rid="B24">24</xref>].</p><p>The next step is to make a genotype call and calculate a confidence measure for any given pair (sense and antisense) of observed log-ratios: <italic>M</italic><sub><italic>i</italic>,<italic>j</italic>,+ </sub>and <italic>M</italic><sub><italic>i</italic>,<italic>j</italic>,-. </sub>Notice that these <italic>M </italic>values can come from any study, and we will use the centers and scales, estimated from the HapMap data. We do this by forming a likelihood based distance function based on the mixture model described above. Our prediction is the genotype <italic>k </italic>that minimizes the negative log-likelihood. Furthermore, the log likelihood ratio test serves as a predictor of confidence accuracy.</p><p>Although our pre-processing procedure greatly improves comparability across lab/studies, some slight differences in cluster centers appear to persist. For this reason we add an extra step to the algorithm described in Carvalho <italic>et al</italic>. [<xref ref-type="bibr" rid="B24">24</xref>]. After obtaining genotype calls, we use those achieving log-likelihood ratios associated with 99% concordance rates and repeat the previously described steps to recalculate the centers and scales. We then compute calls and log-likelihood ratios using these new parameters.</p></sec><sec><title>Measure of chip quality</title><p>As a measure of chip quality we define a SNR that captures the difference of the intensity values among the genotype clusters across all SNPs of a given chip. The fitted models described in the previous section are used to define our metric:</p><p><disp-formula>SNR = median<sub>i</sub>{ f<sub>1</sub>(X<sub>i</sub>) }<sup>2</sup>/{ average<sub>k</sub> [ var(<italic>e</italic><sub><italic>i</italic>,<italic>k</italic></sub>) ] }</disp-formula></p><p>Figure <xref ref-type="fig" rid="F7">7a,b</xref> show data for high and low quality arrays, respectively. In the low quality array (Figure <xref ref-type="fig" rid="F7">7b</xref>), the fact that the variability of the errors <italic>e </italic>overshadow the signal <italic>f</italic><sub><italic>1</italic></sub> can be appreciated by noticing the loss of three distinct horizontal bands, corresponding to the three genotypes as seen in Figure <xref ref-type="fig" rid="F7">7a</xref>. In the low quality array, information about genotypes is lost. Figure <xref ref-type="fig" rid="F2">2b</xref> shows that this value correlates well with sample specific accuracy. Moreover, chips with substantial fractions of dropped calls by DM (&#x0003e;10%) yield lower SNRs (data not shown). By empirical methods, we arrived at a high-quality chip SNR threshold of 4.5 for 100K chips and 2.36 for 500K chips.</p></sec><sec><title>Confidence measures</title><p>The measures of confidence of existing calling algorithms are, by and large, all based on a similar approach. Specifically, once genotype regions are defined for a given SNP, the measure of confidence for a given call is derived from the distance between: the point related to the call; and the region centers. This is the basis of the distance ratio used in BRLMM [<xref ref-type="bibr" rid="B22">22</xref>] as well as the likelihood based function described by [<xref ref-type="bibr" rid="B24">24</xref>]. However, this measure ignores other important predictors of accuracy such as chip quality, SNP quality, and the genotype.</p><p>For chip quality, we use the aforementioned metric SNR. To capture SNP quality, we quantify the distance between the regions for the three genotypes. A variety of factors can affect the efficacy of the feature probes in determining the genotype for a given SNP. Clearly, SNPs with greater separation of regions can be called more accurately (Figure <xref ref-type="fig" rid="F6">6a,b</xref>). We capture this notion by calculating the following value for each SNP: minimum distance between the center of region AA and AB and the center of AB and BB.</p><p>Finally, we noted that accuracy is slightly different for homozygous and heterozygous genotypes. Heterozygous genotypes appear to be more difficult to call because their corresponding regions are more liable to be abutting the two homozygous regions. Therefore, a greater proportion of heterozygous points are close to the periphery of homozygous regions, where they are incorrectly called.</p><p>To provide a useful prediction of accuracy that takes all these measures into account, we perform a logistic regression:</p><p><disp-formula><italic>Logit</italic>{ <italic>Pr</italic>(Correct Call | Covariates) } = <italic>f</italic><sub><italic>1</italic></sub>(Distance, SNP Quality) + <italic>f</italic><sub><italic>2</italic></sub>(SNR)</disp-formula></p><p>We assume the <italic>fs </italic>are smooth and model them with cubic splines. We fit this model on the high quality HapMap dataset to obtain estimates of <italic>f</italic><sub><italic>1</italic></sub> and <italic>f</italic><sub><italic>2</italic></sub>. The model was fit to heterozygous and homozygous calls separately. The resultant covariates are used in new datasets to calculate per-SNP accuracy.</p></sec><sec><title>Validation of the confidence metric</title><p>To ascertain the robustness of the confidence metric from datasets generated from different labs and of different quality, we plot accuracy versus confidence threshold. The thresholds correspond to values used to achieve the specified dropped rates in the ADPs. Confidence metrics that are more robust will produce plots with less outward fanning.</p><p>Another method of validating confidence metrics is to divide calls among quantiles according to the metric and plot average accuracy against the confidence metric for each quantile (the so-called ACP). Ideally, curves stratified by homozygote and heterzygote calls should not deviate from one another. Confidence metrics that accurately predicted per-call accuracy produce curves that lie on the diagonal.</p></sec></sec><sec><title>Abbreviations</title><p>ABACUS, Adaptive Background genotype Calling Scheme; ACP, average accuracy versus quantile confidence metric plot; ADP, accuracy versus drop rate plot; BRLMM, Bayesian Robust Linear Model with Mahalanobis Distance Classifier; CRLMM, Corrected Robust Linear Model with Mahalanobis Distance Classifier; DM, Dynamic Model; MPAM, Modified Partitioning Around Medoids; RLMM, Robust Linear Model with Mahalanobis Distance Classifier; RMA, Robust Multiarray Average; SNP, single nucleotide polymorphism; SNR, signal to noise ratio.</p></sec><sec><title>Authors' contributions</title><p>SL and RAI conceived the study, developed the software, and drafted the manuscript. AC conceived the study, provided the data, and revised the manuscript. BC conceived the study, developed the software, and revised the manuscript. DEA conceived the design and revised the manuscript. DJC revised the manuscript.</p></sec><sec><title>Additional data files</title><p>The following additional data are available. Additional data file <xref ref-type="supplementary-material" rid="S1">1</xref> contains the supplemental figures.</p></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="S1"><caption><title>Additional data file 1</title><p>Supplemental figures</p></caption><media xlink:href="gb-2008-9-4-r63-S1.pdf" mimetype="application" mime-subtype="pdf"><caption><p>Click here for file</p></caption></media></supplementary-material></sec></body><back><ack><sec><title>Acknowledgements</title><p>We would like to thank the Broad Institute and Affymetix for providing genotype data; Simon Cawley, Terry Speed, Earl Hubbell and Chuck Sugnet for helpful discussions; and finally, Ben Bolstad, James MacDonald, Seth Falcon, Marvin Newhouse, Robert Gentleman, Jiong Yang, and Fernando Pineda for help with hardware and software. The work of Rafael A Irizarry was partially funded by NIH grants 1R01GM083084-01, 1P41HG004059 and P50 HL73994 (Core E); Benilton Carvalho was funded by NIH grant 1R01RR021967-01A2 and Coordena&#x000e7;&#x000e3;o de Aperfei&#x000e7;oamento de Pessoal de N&#x000ed;vel Superior (CAPES/Brazil); Shin Lin, David J Cutler, Dan E Arking, and Aravinda Chakravarti were supported by NIH grants HG02757, MH60007, and the DW Reynolds Foundation. Note: Aravinda Chakravarti is a member of the Scientific Advisory Board of Affymetrix, Inc., a potential conflict of interest managed by the policies of Johns Hopkins University.</p></sec></ack><ref-list><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lander</surname><given-names>ES</given-names></name><name><surname>Schork</surname><given-names>NJ</given-names></name></person-group><article-title>Genetic dissection of complex traits.</article-title><source>Science</source><year>1994</year><volume>265</volume><fpage>2037</fpage><lpage>2048</lpage><pub-id pub-id-type="pmid">8091226</pub-id><pub-id pub-id-type="doi">10.1126/science.8091226</pub-id></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Risch</surname><given-names>N</given-names></name><name><surname>Merikangas</surname><given-names>K</given-names></name></person-group><article-title>The future of genetic studies of complex human diseases.</article-title><source>Science</source><year>1996</year><volume>273</volume><fpage>1516</fpage><lpage>1517</lpage><pub-id pub-id-type="pmid">8801636</pub-id><pub-id pub-id-type="doi">10.1126/science.273.5281.1516</pub-id></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Collins</surname><given-names>FS</given-names></name><name><surname>Guyer</surname><given-names>MS</given-names></name><name><surname>Charkravarti</surname><given-names>A</given-names></name></person-group><article-title>Variations on a theme: cataloging human DNA sequence variation.</article-title><source>Science</source><year>1997</year><volume>278</volume><fpage>1580</fpage><lpage>1581</lpage><pub-id pub-id-type="pmid">9411782</pub-id><pub-id pub-id-type="doi">10.1126/science.278.5343.1580</pub-id></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><collab>International HapMap Consortium</collab><name><surname>Frazer</surname><given-names>KA</given-names></name><name><surname>Ballinger</surname><given-names>DG</given-names></name><name><surname>Cox</surname><given-names>DR</given-names></name><name><surname>Hinds</surname><given-names>DA</given-names></name><name><surname>Stuve</surname><given-names>LL</given-names></name><name><surname>Gibbs</surname><given-names>RA</given-names></name><name><surname>Belmont</surname><given-names>JW</given-names></name><name><surname>Boudreau</surname><given-names>A</given-names></name><name><surname>Hardenbol</surname><given-names>P</given-names></name><name><surname>Leal</surname><given-names>SM</given-names></name><name><surname>Pasternak</surname><given-names>S</given-names></name><name><surname>Wheeler</surname><given-names>DA</given-names></name><name><surname>Willis</surname><given-names>TD</given-names></name><name><surname>Yu</surname><given-names>F</given-names></name><name><surname>Yang</surname><given-names>H</given-names></name><name><surname>Zeng</surname><given-names>C</given-names></name><name><surname>Gao</surname><given-names>Y</given-names></name><name><surname>Hu</surname><given-names>H</given-names></name><name><surname>Hu</surname><given-names>W</given-names></name><name><surname>Li</surname><given-names>C</given-names></name><name><surname>Lin</surname><given-names>W</given-names></name><name><surname>Liu</surname><given-names>S</given-names></name><name><surname>Pan</surname><given-names>H</given-names></name><name><surname>Tang</surname><given-names>X</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name><name><surname>Wang</surname><given-names>W</given-names></name><name><surname>Yu</surname><given-names>J</given-names></name><name><surname>Zhang</surname><given-names>B</given-names></name><name><surname>Zhang</surname><given-names>Q</given-names></name><name><surname>Zhao</surname><given-names>H</given-names></name><etal></etal></person-group><article-title>A second generation human haplotype map of over 3.1 million SNPs.</article-title><source>Nature</source><year>2007</year><volume>449</volume><fpage>851</fpage><lpage>861</lpage><pub-id pub-id-type="pmid">17943122</pub-id><pub-id pub-id-type="doi">10.1038/nature06258</pub-id></citation></ref><ref id="B5"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Fodor</surname><given-names>SP</given-names></name><name><surname>Read</surname><given-names>JL</given-names></name><name><surname>Pirrung</surname><given-names>MC</given-names></name><name><surname>Stryer</surname><given-names>L</given-names></name><name><surname>Lu</surname><given-names>AT</given-names></name><name><surname>Solas</surname><given-names>D</given-names></name></person-group><article-title>Light-directed, spatially addressable parallel chemical synthesis.</article-title><source>Science</source><year>1991</year><volume>251</volume><fpage>767</fpage><lpage>773</lpage><pub-id pub-id-type="pmid">1990438</pub-id><pub-id pub-id-type="doi">10.1126/science.1990438</pub-id></citation></ref><ref id="B6"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Pease</surname><given-names>AC</given-names></name><name><surname>Solas</surname><given-names>D</given-names></name><name><surname>Sullivan</surname><given-names>EJ</given-names></name><name><surname>Cronin</surname><given-names>MT</given-names></name><name><surname>Holmes</surname><given-names>CP</given-names></name><name><surname>Fodor</surname><given-names>SP</given-names></name></person-group><article-title>Light-generated oligonucleotide arrays for rapid DNA sequence analysis.</article-title><source>Proc Natl Acad Sci USA</source><year>1994</year><volume>91</volume><fpage>5022</fpage><lpage>5026</lpage><pub-id pub-id-type="pmid">8197176</pub-id><pub-id pub-id-type="doi">10.1073/pnas.91.11.5022</pub-id></citation></ref><ref id="B7"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Fan</surname><given-names>JB</given-names></name><name><surname>Chen</surname><given-names>X</given-names></name><name><surname>Halushka</surname><given-names>MK</given-names></name><name><surname>Berno</surname><given-names>A</given-names></name><name><surname>Huang</surname><given-names>X</given-names></name><name><surname>Ryder</surname><given-names>T</given-names></name><name><surname>Lipshutz</surname><given-names>RJ</given-names></name><name><surname>Lockhart</surname><given-names>DJ</given-names></name><name><surname>Chakravarti</surname><given-names>A</given-names></name></person-group><article-title>Parallel genotyping of human SNPs using generic high-density oligonucleotide tag arrays.</article-title><source>Genome Res</source><year>2000</year><volume>10</volume><fpage>853</fpage><lpage>860</lpage><pub-id pub-id-type="pmid">10854416</pub-id><pub-id pub-id-type="doi">10.1101/gr.10.6.853</pub-id></citation></ref><ref id="B8"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Dong</surname><given-names>S</given-names></name><name><surname>Wang</surname><given-names>E</given-names></name><name><surname>Hsie</surname><given-names>L</given-names></name><name><surname>Cao</surname><given-names>Y</given-names></name><name><surname>Chen</surname><given-names>X</given-names></name><name><surname>Gingeras</surname><given-names>TR</given-names></name></person-group><article-title>Flexible use of high-density oligonucleotide arrays for single-nucleotide polymorphism discovery and validation.</article-title><source>Genome Res</source><year>2001</year><volume>11</volume><fpage>1418</fpage><lpage>1424</lpage><pub-id pub-id-type="pmid">11483583</pub-id><pub-id pub-id-type="doi">10.1101/gr.171101</pub-id></citation></ref><ref id="B9"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kennedy</surname><given-names>GC</given-names></name><name><surname>Matsuzaki</surname><given-names>H</given-names></name><name><surname>Dong</surname><given-names>S</given-names></name><name><surname>Liu</surname><given-names>WM</given-names></name><name><surname>Huang</surname><given-names>J</given-names></name><name><surname>Liu</surname><given-names>G</given-names></name><name><surname>Su</surname><given-names>X</given-names></name><name><surname>Cao</surname><given-names>M</given-names></name><name><surname>Chen</surname><given-names>W</given-names></name><name><surname>Zhang</surname><given-names>J</given-names></name><name><surname>Liu</surname><given-names>W</given-names></name><name><surname>Yang</surname><given-names>G</given-names></name><name><surname>Di</surname><given-names>X</given-names></name><name><surname>Ryder</surname><given-names>T</given-names></name><name><surname>He</surname><given-names>Z</given-names></name><name><surname>Surti</surname><given-names>U</given-names></name><name><surname>Phillips</surname><given-names>MS</given-names></name><name><surname>Boyce-Jacino</surname><given-names>MT</given-names></name><name><surname>Fodor</surname><given-names>SP</given-names></name><name><surname>Jones</surname><given-names>KW</given-names></name></person-group><article-title>Large-scale genotyping of complex DNA.</article-title><source>Nat Biotechnol</source><year>2003</year><volume>21</volume><fpage>1233</fpage><lpage>1237</lpage><pub-id pub-id-type="pmid">12960966</pub-id><pub-id pub-id-type="doi">10.1038/nbt869</pub-id></citation></ref><ref id="B10"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lin</surname><given-names>S</given-names></name><name><surname>Chakravarti</surname><given-names>A</given-names></name><name><surname>Cutler</surname><given-names>DJ</given-names></name></person-group><article-title>Exhaustive allelic transmission disequilibrium tests as a new approach to genome-wide association studies.</article-title><source>Nat Genet</source><year>2004</year><volume>36</volume><fpage>1181</fpage><lpage>1188</lpage><pub-id pub-id-type="pmid">15502828</pub-id><pub-id pub-id-type="doi">10.1038/ng1457</pub-id></citation></ref><ref id="B11"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Klein</surname><given-names>RJ</given-names></name><name><surname>Zeiss</surname><given-names>C</given-names></name><name><surname>Chew</surname><given-names>EY</given-names></name><name><surname>Tsai</surname><given-names>JY</given-names></name><name><surname>Sackler</surname><given-names>RS</given-names></name><name><surname>Haynes</surname><given-names>C</given-names></name><name><surname>Henning</surname><given-names>AK</given-names></name><name><surname>SanGiovanni</surname><given-names>JP</given-names></name><name><surname>Mane</surname><given-names>SM</given-names></name><name><surname>Mayne</surname><given-names>ST</given-names></name><name><surname>Bracken</surname><given-names>MB</given-names></name><name><surname>Ferris</surname><given-names>FL</given-names></name><name><surname>Ott</surname><given-names>J</given-names></name><name><surname>Barnstable</surname><given-names>C</given-names></name><name><surname>Hoh</surname><given-names>J</given-names></name></person-group><article-title>Complement factor H polymorphism in age-related macular degeneration.</article-title><source>Science</source><year>2005</year><volume>308</volume><fpage>385</fpage><lpage>389</lpage><pub-id pub-id-type="pmid">15761122</pub-id><pub-id pub-id-type="doi">10.1126/science.1109557</pub-id></citation></ref><ref id="B12"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Arking</surname><given-names>DE</given-names></name><name><surname>Pfeufer</surname><given-names>A</given-names></name><name><surname>Post</surname><given-names>W</given-names></name><name><surname>Kao</surname><given-names>WH</given-names></name><name><surname>Newton-Cheh</surname><given-names>C</given-names></name><name><surname>Ikeda</surname><given-names>M</given-names></name><name><surname>West</surname><given-names>K</given-names></name><name><surname>Kashuk</surname><given-names>C</given-names></name><name><surname>Akyol</surname><given-names>M</given-names></name><name><surname>Perz</surname><given-names>S</given-names></name><name><surname>Jalilzadeh</surname><given-names>S</given-names></name><name><surname>Illig</surname><given-names>T</given-names></name><name><surname>Gieger</surname><given-names>C</given-names></name><name><surname>Guo</surname><given-names>CY</given-names></name><name><surname>Larson</surname><given-names>MG</given-names></name><name><surname>Wichmann</surname><given-names>HE</given-names></name><name><surname>Marban</surname><given-names>E</given-names></name><name><surname>O'Donnell</surname><given-names>CJ</given-names></name><name><surname>Hirschhorn</surname><given-names>JN</given-names></name><name><surname>Kaab</surname><given-names>S</given-names></name><name><surname>Spooner</surname><given-names>PM</given-names></name><name><surname>Meitinger</surname><given-names>T</given-names></name><name><surname>Chakravarti</surname><given-names>A</given-names></name></person-group><article-title>A common genetic variant in the NOS1 regulator NOS1AP modulates cardiac repolarization.</article-title><source>Nat Genet</source><year>2006</year><volume>38</volume><fpage>644</fpage><lpage>651</lpage><pub-id pub-id-type="pmid">16648850</pub-id><pub-id pub-id-type="doi">10.1038/ng1790</pub-id></citation></ref><ref id="B13"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Scott</surname><given-names>LJ</given-names></name><name><surname>Mohlke</surname><given-names>KL</given-names></name><name><surname>Bonnycastle</surname><given-names>LL</given-names></name><name><surname>Willer</surname><given-names>CJ</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Duren</surname><given-names>WL</given-names></name><name><surname>Erdos</surname><given-names>MR</given-names></name><name><surname>Stringham</surname><given-names>HM</given-names></name><name><surname>Chines</surname><given-names>PS</given-names></name><name><surname>Jackson</surname><given-names>AU</given-names></name><name><surname>Prokunina-Olsson</surname><given-names>L</given-names></name><name><surname>Ding</surname><given-names>CJ</given-names></name><name><surname>Swift</surname><given-names>AJ</given-names></name><name><surname>Narisu</surname><given-names>N</given-names></name><name><surname>Hu</surname><given-names>T</given-names></name><name><surname>Pruim</surname><given-names>R</given-names></name><name><surname>Xiao</surname><given-names>R</given-names></name><name><surname>Li</surname><given-names>XY</given-names></name><name><surname>Conneely</surname><given-names>KN</given-names></name><name><surname>Riebow</surname><given-names>NL</given-names></name><name><surname>Sprau</surname><given-names>AG</given-names></name><name><surname>Tong</surname><given-names>M</given-names></name><name><surname>White</surname><given-names>PP</given-names></name><name><surname>Hetrick</surname><given-names>KN</given-names></name><name><surname>Barnhart</surname><given-names>MW</given-names></name><name><surname>Bark</surname><given-names>CW</given-names></name><name><surname>Goldstein</surname><given-names>JL</given-names></name><name><surname>Watkins</surname><given-names>L</given-names></name><name><surname>Xiang</surname><given-names>F</given-names></name><name><surname>Saramies</surname><given-names>J</given-names></name><etal></etal></person-group><article-title>A genome-wide association study of type 2 diabetes in Finns detects multiple susceptibility variants.</article-title><source>Science</source><year>2007</year><volume>316</volume><fpage>1341</fpage><lpage>1345</lpage><pub-id pub-id-type="pmid">17463248</pub-id><pub-id pub-id-type="doi">10.1126/science.1142382</pub-id></citation></ref><ref id="B14"><citation citation-type="journal"><person-group person-group-type="author"><collab>Wellcome Trust Case Control Consortium</collab></person-group><article-title>Genome-wide association study of 14,000 cases of seven common diseases and 3,000 shared controls.</article-title><source>Nature</source><year>2007</year><volume>447</volume><fpage>661</fpage><lpage>678</lpage><pub-id pub-id-type="pmid">17554300</pub-id><pub-id pub-id-type="doi">10.1038/nature05911</pub-id></citation></ref><ref id="B15"><citation citation-type="journal"><person-group person-group-type="author"><collab>Diabetes Genetics Initiative of Broad Institute of Harvard and MIT, Lund University, and Novartis Institutes of BioMedical Research</collab><name><surname>Saxena</surname><given-names>R</given-names></name><name><surname>Voight</surname><given-names>BF</given-names></name><name><surname>Lyssenko</surname><given-names>V</given-names></name><name><surname>Burtt</surname><given-names>NP</given-names></name><name><surname>de Bakker</surname><given-names>PI</given-names></name><name><surname>Chen</surname><given-names>H</given-names></name><name><surname>Roix</surname><given-names>JJ</given-names></name><name><surname>Kathiresan</surname><given-names>S</given-names></name><name><surname>Hirschhorn</surname><given-names>JN</given-names></name><name><surname>Daly</surname><given-names>MJ</given-names></name><name><surname>Hughes</surname><given-names>TE</given-names></name><name><surname>Groop</surname><given-names>L</given-names></name><name><surname>Altshuler</surname><given-names>D</given-names></name><name><surname>Almgren</surname><given-names>P</given-names></name><name><surname>Florez</surname><given-names>JC</given-names></name><name><surname>Meyer</surname><given-names>J</given-names></name><name><surname>Ardlie</surname><given-names>K</given-names></name><name><surname>Bengtsson Bostr&#x000f6;m</surname><given-names>K</given-names></name><name><surname>Isomaa</surname><given-names>B</given-names></name><name><surname>Lettre</surname><given-names>G</given-names></name><name><surname>Lindblad</surname><given-names>U</given-names></name><name><surname>Lyon</surname><given-names>HN</given-names></name><name><surname>Melander</surname><given-names>O</given-names></name><name><surname>Newton-Cheh</surname><given-names>C</given-names></name><name><surname>Nilsson</surname><given-names>P</given-names></name><name><surname>Orho-Melander</surname><given-names>M</given-names></name><name><surname>R&#x000e5;stam</surname><given-names>L</given-names></name><name><surname>Speliotes</surname><given-names>EK</given-names></name><name><surname>Taskinen</surname><given-names>MR</given-names></name><name><surname>Tuomi</surname><given-names>T</given-names></name><etal></etal></person-group><article-title>Genome-wide association analysis identifies loci for type 2 diabetes and triglyceride levels.</article-title><source>Science</source><year>2007</year><volume>316</volume><fpage>1331</fpage><lpage>1336</lpage><pub-id pub-id-type="pmid">17463246</pub-id><pub-id pub-id-type="doi">10.1126/science.1142358</pub-id></citation></ref><ref id="B16"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Zeggini</surname><given-names>E</given-names></name><name><surname>Weedon</surname><given-names>MN</given-names></name><name><surname>Lindgren</surname><given-names>CM</given-names></name><name><surname>Frayling</surname><given-names>TM</given-names></name><name><surname>Elliott</surname><given-names>KS</given-names></name><name><surname>Lango</surname><given-names>H</given-names></name><name><surname>Timpson</surname><given-names>NJ</given-names></name><name><surname>Perry</surname><given-names>JR</given-names></name><name><surname>Rayner</surname><given-names>NW</given-names></name><name><surname>Freathy</surname><given-names>RM</given-names></name><name><surname>Barrett</surname><given-names>JC</given-names></name><name><surname>Shields</surname><given-names>B</given-names></name><name><surname>Morris</surname><given-names>AP</given-names></name><name><surname>Ellard</surname><given-names>S</given-names></name><name><surname>Groves</surname><given-names>CJ</given-names></name><name><surname>Harries</surname><given-names>LW</given-names></name><name><surname>Marchini</surname><given-names>JL</given-names></name><name><surname>Owen</surname><given-names>KR</given-names></name><name><surname>Knight</surname><given-names>B</given-names></name><name><surname>Cardon</surname><given-names>LR</given-names></name><name><surname>Walker</surname><given-names>M</given-names></name><name><surname>Hitman</surname><given-names>GA</given-names></name><name><surname>Morris</surname><given-names>AD</given-names></name><name><surname>Doney</surname><given-names>AS</given-names></name><collab>Wellcome Trust Case Control Consortium (WTCCC)</collab><name><surname>McCarthy</surname><given-names>MI</given-names></name><name><surname>Hattersley</surname><given-names>AT</given-names></name></person-group><article-title>Replication of genome-wide association signals in UK samples reveals risk loci for type 2 diabetes.</article-title><source>Science</source><year>2007</year><volume>316</volume><fpage>1336</fpage><lpage>1341</lpage><pub-id pub-id-type="pmid">17463249</pub-id><pub-id pub-id-type="doi">10.1126/science.1142364</pub-id></citation></ref><ref id="B17"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Mitchell</surname><given-names>AA</given-names></name><name><surname>Cutler</surname><given-names>DJ</given-names></name><name><surname>Chakravarti</surname><given-names>A</given-names></name></person-group><article-title>Undetected genotyping errors cause apparent overtransmission of common alleles in the transmission/disequilibrium test.</article-title><source>Am J Hum Genet</source><year>2003</year><volume>72</volume><fpage>598</fpage><lpage>610</lpage><pub-id pub-id-type="pmid">12587097</pub-id><pub-id pub-id-type="doi">10.1086/368203</pub-id></citation></ref><ref id="B18"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Cutler</surname><given-names>DJ</given-names></name><name><surname>Zwick</surname><given-names>ME</given-names></name><name><surname>Carrasquillo</surname><given-names>MM</given-names></name><name><surname>Yohn</surname><given-names>CT</given-names></name><name><surname>Tobin</surname><given-names>KP</given-names></name><name><surname>Kashuk</surname><given-names>C</given-names></name><name><surname>Mathews</surname><given-names>DJ</given-names></name><name><surname>Shah</surname><given-names>NA</given-names></name><name><surname>Eichler</surname><given-names>EE</given-names></name><name><surname>Warrington</surname><given-names>JA</given-names></name><name><surname>Chakravarti</surname><given-names>A</given-names></name></person-group><article-title>High-throughput variation detection and genotyping using microarrays.</article-title><source>Genome Res</source><year>2001</year><volume>11</volume><fpage>1913</fpage><lpage>1925</lpage><pub-id pub-id-type="pmid">11691856</pub-id></citation></ref><ref id="B19"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>WM</given-names></name><name><surname>Di</surname><given-names>X</given-names></name><name><surname>Yang</surname><given-names>G</given-names></name><name><surname>Matsuzaki</surname><given-names>H</given-names></name><name><surname>Huang</surname><given-names>J</given-names></name><name><surname>Mei</surname><given-names>R</given-names></name><name><surname>Ryder</surname><given-names>TB</given-names></name><name><surname>Webster</surname><given-names>TA</given-names></name><name><surname>Dong</surname><given-names>S</given-names></name><name><surname>Liu</surname><given-names>G</given-names></name><name><surname>Jones</surname><given-names>KW</given-names></name><name><surname>Kennedy</surname><given-names>GC</given-names></name><name><surname>Kulp</surname><given-names>D</given-names></name></person-group><article-title>Algorithms for large-scale genotyping microarrays.</article-title><source>Bioinformatics</source><year>2003</year><volume>19</volume><fpage>2397</fpage><lpage>2403</lpage><pub-id pub-id-type="pmid">14668223</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btg332</pub-id></citation></ref><ref id="B20"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Di</surname><given-names>X</given-names></name><name><surname>Matsuzaki</surname><given-names>H</given-names></name><name><surname>Webster</surname><given-names>TA</given-names></name><name><surname>Hubbell</surname><given-names>E</given-names></name><name><surname>Liu</surname><given-names>G</given-names></name><name><surname>Dong</surname><given-names>S</given-names></name><name><surname>Bartell</surname><given-names>D</given-names></name><name><surname>Huang</surname><given-names>J</given-names></name><name><surname>Chiles</surname><given-names>R</given-names></name><name><surname>Yang</surname><given-names>G</given-names></name><name><surname>Shen</surname><given-names>MM</given-names></name><name><surname>Kulp</surname><given-names>D</given-names></name><name><surname>Kennedy</surname><given-names>GC</given-names></name><name><surname>Mei</surname><given-names>R</given-names></name><name><surname>Jones</surname><given-names>KW</given-names></name><name><surname>Cawley</surname><given-names>S</given-names></name></person-group><article-title>Dynamic model based algorithms for screening and genotyping over 100K SNPs on oligonucleotide microarrays.</article-title><source>Bioinformatics</source><year>2005</year><volume>21</volume><fpage>1958</fpage><lpage>1963</lpage><pub-id pub-id-type="pmid">15657097</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/bti275</pub-id></citation></ref><ref id="B21"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Rabbee</surname><given-names>N</given-names></name><name><surname>Speed</surname><given-names>TP</given-names></name></person-group><article-title>A genotype calling algorithm for affymetrix SNP arrays.</article-title><source>Bioinformatics</source><year>2006</year><volume>22</volume><fpage>7</fpage><lpage>12</lpage><pub-id pub-id-type="pmid">16267090</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/bti741</pub-id></citation></ref><ref id="B22"><citation citation-type="other"><article-title>BRLMM: an Improved Genotype Calling Method for the GeneChip Human Mappking 500K Array Set</article-title><ext-link ext-link-type="uri" xlink:href="http://www.affymetrix.com/support/technical/whitepapers/brlmm_whitepaper.pdf"/></citation></ref><ref id="B23"><citation citation-type="other"><article-title>Birdseed</article-title><ext-link ext-link-type="uri" xlink:href="http://www.affymetrix.com/products/software/specific/birdseed_algorithm.affx"/></citation></ref><ref id="B24"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Carvalho</surname><given-names>B</given-names></name><name><surname>Bengtsson</surname><given-names>H</given-names></name><name><surname>Speed</surname><given-names>TP</given-names></name><name><surname>Irizarry</surname><given-names>RA</given-names></name></person-group><article-title>Exploration, normalization, and genotype calls of high-density oligonucleotide SNP array data.</article-title><source>Biostatistics</source><year>2007</year><volume>8</volume><fpage>485</fpage><lpage>499</lpage><pub-id pub-id-type="pmid">17189563</pub-id><pub-id pub-id-type="doi">10.1093/biostatistics/kxl042</pub-id></citation></ref><ref id="B25"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Gentleman</surname><given-names>RC</given-names></name><name><surname>Carey</surname><given-names>VJ</given-names></name><name><surname>Bates</surname><given-names>DM</given-names></name><name><surname>Bolstad</surname><given-names>B</given-names></name><name><surname>Dettling</surname><given-names>M</given-names></name><name><surname>Dudoit</surname><given-names>S</given-names></name><name><surname>Ellis</surname><given-names>B</given-names></name><name><surname>Gautier</surname><given-names>L</given-names></name><name><surname>Ge</surname><given-names>Y</given-names></name><name><surname>Gentry</surname><given-names>J</given-names></name><name><surname>Hornik</surname><given-names>K</given-names></name><name><surname>Hothorn</surname><given-names>T</given-names></name><name><surname>Huber</surname><given-names>W</given-names></name><name><surname>Iacus</surname><given-names>S</given-names></name><name><surname>Irizarry</surname><given-names>R</given-names></name><name><surname>Leisch</surname><given-names>F</given-names></name><name><surname>Li</surname><given-names>C</given-names></name><name><surname>Maechler</surname><given-names>M</given-names></name><name><surname>Rossini</surname><given-names>AJ</given-names></name><name><surname>Sawitzki</surname><given-names>G</given-names></name><name><surname>Smith</surname><given-names>C</given-names></name><name><surname>Smyth</surname><given-names>G</given-names></name><name><surname>Tierney</surname><given-names>L</given-names></name><name><surname>Yang</surname><given-names>JY</given-names></name><name><surname>Zhang</surname><given-names>J</given-names></name></person-group><article-title>Bioconductor: open software development for computational biology and bioinformatics.</article-title><source>Genome Biol</source><year>2004</year><volume>5</volume><fpage>R80</fpage><pub-id pub-id-type="pmid">15461798</pub-id><pub-id pub-id-type="doi">10.1186/gb-2004-5-10-r80</pub-id></citation></ref><ref id="B26"><citation citation-type="other"><article-title>Bioconductor</article-title><ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org/"/></citation></ref><ref id="B27"><citation citation-type="other"><article-title>The R Project for Statistical Computing</article-title><ext-link ext-link-type="uri" xlink:href="http://www.r-project.org/"/></citation></ref><ref id="B28"><citation citation-type="book"><person-group person-group-type="author"><collab>Team RDC</collab></person-group><source>R: a Language and Environment for Statistical Computing</source><year>2007</year><publisher-name>Vienna, Austria: R Foundation for Statistical Computing</publisher-name></citation></ref><ref id="B29"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Irizarry</surname><given-names>RA</given-names></name><name><surname>Wu</surname><given-names>Z</given-names></name><name><surname>Jaffee</surname><given-names>HA</given-names></name></person-group><article-title>Comparison of Affymetrix GeneChip expression measures.</article-title><source>Bioinformatics</source><year>2006</year><volume>22</volume><fpage>789</fpage><lpage>794</lpage><pub-id pub-id-type="pmid">16410320</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btk046</pub-id></citation></ref><ref id="B30"><citation citation-type="other"><article-title>A Benchmark for Affymetrix SNP Chip Measures</article-title><ext-link ext-link-type="uri" xlink:href="http://rafalab.jhsph.edu/snpaffycomp/"/></citation></ref><ref id="B31"><citation citation-type="other"><article-title>A Benchmark for Affymetrix GeneChip Expression Measures</article-title><ext-link ext-link-type="uri" xlink:href="http://affycomp.biostat.jhsph.edu/"/></citation></ref><ref id="B32"><citation citation-type="other"><article-title>Affymetrix HapMap 100K data</article-title><ext-link ext-link-type="uri" xlink:href="http://www.hapmap.org/downloads/raw_data/affy100k/"/></citation></ref><ref id="B33"><citation citation-type="other"><article-title>Affymetrix HapMap 500K data</article-title><ext-link ext-link-type="uri" xlink:href="http://www.hapmap.org/downloads/raw_data/affy500k/"/></citation></ref><ref id="B34"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Irizarry</surname><given-names>RA</given-names></name><name><surname>Hobbs</surname><given-names>B</given-names></name><name><surname>Collin</surname><given-names>F</given-names></name><name><surname>Beazer-Barclay</surname><given-names>YD</given-names></name><name><surname>Antonellis</surname><given-names>KJ</given-names></name><name><surname>Scherf</surname><given-names>U</given-names></name><name><surname>Speed</surname><given-names>TP</given-names></name></person-group><article-title>Exploration, normalization, and summaries of high density oligonucleotide array probe level data.</article-title><source>Biostatistics</source><year>2003</year><volume>4</volume><fpage>249</fpage><lpage>264</lpage><pub-id pub-id-type="pmid">12925520</pub-id><pub-id pub-id-type="doi">10.1093/biostatistics/4.2.249</pub-id></citation></ref></ref-list></back></article>