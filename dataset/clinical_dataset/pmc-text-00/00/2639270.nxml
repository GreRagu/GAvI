<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd"><article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article" xml:lang="EN"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id><journal-id journal-id-type="publisher-id">bioinformatics</journal-id><journal-id journal-id-type="hwp">bioinfo</journal-id><journal-title>Bioinformatics</journal-title><issn pub-type="ppub">1367-4803</issn><issn pub-type="epub">1460-2059</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">18818215</article-id><article-id pub-id-type="pmc">2639270</article-id><article-id pub-id-type="doi">10.1093/bioinformatics/btn507</article-id><article-id pub-id-type="publisher-id">btn507</article-id><article-categories><subj-group subj-group-type="heading"><subject>Applications Note</subject><subj-group><subject>Structural Bioinformatics</subject></subj-group></subj-group></article-categories><title-group><article-title>Searching protein structure databases with DaliLite v.3</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Holm</surname><given-names>L.</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref><xref ref-type="aff" rid="AFF1"><sup>2</sup></xref><xref ref-type="corresp" rid="COR1">*</xref></contrib><contrib contrib-type="author"><name><surname>K&#x000e4;&#x000e4;ri&#x000e4;inen</surname><given-names>S.</given-names></name><xref ref-type="aff" rid="AFF1"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Rosenstr&#x000f6;m</surname><given-names>P.</given-names></name><xref ref-type="aff" rid="AFF1"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Schenkel</surname><given-names>A.</given-names></name><xref ref-type="aff" rid="AFF1"><sup>2</sup></xref></contrib></contrib-group><aff id="AFF1"><sup>1</sup>Department of Biological and Environmental Sciences, and <sup>2</sup>Institute of Biotechnology, P.O.Box 56 (Viikinkaari 5), 00014 University of Helsinki, Finland</aff><author-notes><corresp id="COR1">*To whom correspondence should be addressed.</corresp><fn><p>Associate Editor: Thomas Lengauer</p></fn></author-notes><pub-date pub-type="ppub"><day>1</day><month>12</month><year>2008</year></pub-date><pub-date pub-type="epub"><day>25</day><month>9</month><year>2008</year></pub-date><pub-date pub-type="pmc-release"><day>25</day><month>9</month><year>2008</year></pub-date><volume>24</volume><issue>23</issue><fpage>2780</fpage><lpage>2781</lpage><history><date date-type="received"><day>10</day><month>6</month><year>2008</year></date><date date-type="rev-recd"><day>14</day><month>8</month><year>2008</year></date><date date-type="accepted"><day>22</day><month>9</month><year>2008</year></date></history><permissions><copyright-statement>&#x000a9; 2008 The Author(s)</copyright-statement><copyright-year>2008</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/"><p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">http://creativecommons.org/licenses/by-nc/2.0/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</p></license></permissions><abstract><p>The Red Queen said, &#x02018;It takes all the running you can do, to keep in the same place.&#x02019; Lewis Carrol</p><p><bold>Motivation:</bold> Newly solved protein structures are routinely scanned against structures already in the Protein Data Bank (PDB) using Internet servers. In favourable cases, comparing 3D structures may reveal biologically interesting similarities that are not detectable by comparing sequences. The number of known structures continues to grow exponentially. Sensitive&#x02014;thorough but slow&#x02014;search algorithms are challenged to deliver results in a reasonable time, as there are now more structures in the PDB than seconds in a day. The brute-force solution would be to distribute the individual comparisons on a massively parallel computer. A frugal solution, as implemented in the Dali server, is to reduce the total computational cost by pruning search space using prior knowledge about the distribution of structures in fold space. This note reports paradigm revisions that enable maintaining such a knowledge base up-to-date on a PC.</p><p><bold>Availability:</bold> The Dali server for protein structure database searching at <ext-link ext-link-type="uri" xlink:href="http://ekhidna.biocenter.helsinki.fi/dali_server">http://ekhidna.biocenter.helsinki.fi/dali_server</ext-link> is running DaliLite v.3. The software can be downloaded for academic use from <ext-link ext-link-type="uri" xlink:href="http://ekhidna.biocenter.helsinki.fi/dali_lite/downloads/v3">http://ekhidna.biocenter.helsinki.fi/dali_lite/downloads/v3</ext-link>.</p><p><bold>Contact:</bold> <email>liisa.holm@helsinki.fi</email></p></abstract></article-meta></front><body><sec sec-type="intro" id="SEC1"><title>1 INTRODUCTION</title><p>Comparative analyses of protein sequences and structures are a cornerstone of bioinformatics. When sequence and structure similarities have an evolutionary origin, it is often possible to infer similarities in the biological functions of the proteins, which would be difficult to predict directly. Structure comparisons have a longer look-back time than sequence comparison and have led to the identification of many &#x02018;super-families&#x02019; of distantly related proteins.</p><p>Many measures have been proposed to quantify structural similarity. The Dali method uses a weighted sum of similarities of intra-molecular distances, which correlates with expert classifications in the sense that the structures of homologous proteins typically get higher similarity scores than the structures of evolutionarily unrelated proteins (Sierk and Pearson, <xref ref-type="bibr" rid="B7">2004</xref>). This property is useful to a biologist using structure comparison to learn more about her query protein: the biologically informative neighbours are found at the top of the match list with relatively few false leads.</p><p>The Dali method has been used to systematically scan new structures against the Protein Data Bank (PDB) for some 15 years (Holm and Sander, <xref ref-type="bibr" rid="B3">1994</xref>). The overall strategy is to screen the structure database with many different methods, starting with fast but unreliable ones and ending with the most sensitive but slow methods. This ensures that no significant similarity is missed. The search space is pruned between methods; if a strong match has been found, then subsequent methods only compare the query structure to the neighbours of the strong match. This strategy requires that all the neighbours of the known structures are precomputed in all versus all fashion within a representative subset of structures. The size of the structure set has grown by two decades since the system was introduced, and all versus all comparison is a quadratic problem in the number of structures. Recently, the paradigm of all versus all comparisons became untenable when the weekly PDB updates began to take more than a week to process.</p><p>DaliLite is a standalone package of the Dali algorithm. The first release of DaliLite (Holm and Park, <xref ref-type="bibr" rid="B2">2000</xref>) contained all the functionality of the Dali server at EBI except the site-specific, complicated database update protocol. The main DaliLite program is a wrapper that calls a variety of methods for protein structure comparison. New workflows can thus be easily implemented by &#x02018;rewiring the regulatory logic&#x02019; but keeping the basic algorithms unchanged. In DaliLite v.3, we introduce new options for database searching (DaliLite &#x02013;quick) and database updates (DaliLite &#x02013;update). The new protocols improve server throughput and vastly simplify the updates, making the complete system portable.</p><p>The key change from earlier is that we abandon the all versus all matrix of similarities in favour of a connected graph of similarities. The nodes of the graph represent protein structures and edges represent structural alignments. Whereas before each representative structure was directly linked to all its structurally similar neighbours, we now require only that there is a path of continuous structural similarity through the graph. The structural neighbours of a query structure are collected by walks through the graph. Not only need the graph be less densely connected than the all versus all matrix, thus saving computational effort, but also there is the added benefit that the incremental updates of the structural similarity graph and the choice of structural representatives are completely decoupled.</p></sec><sec sec-type="methods" id="SEC2"><title>2 METHODS</title><sec id="SEC2.1"><title>2.1 PDB clustering</title><p>The PDB is highly redundant. The structures of some proteins and their mutants have been determined in various conditions, though the structures remain the &#x02018;same&#x02019; for classification purposes. We use a representative subset at 90% sequence identity level (PDB90), derived from the current set of PDB sequences using CD-HIT (Li and Godzik, <xref ref-type="bibr" rid="B4">2006</xref>). The PDB contains over 100 000 structures (chains), which is reduced to about 20 000 PDB90 representatives. Further clustering of similar folds at lower levels of sequence identity was not cost effective.</p></sec><sec id="SEC2.2"><title>2.2 Structural similarity graph</title><p>The structural similarity graph and alignment data are stored in a relational database (MySQL). The graph is updated incrementally. If a new structure has strong similarity to structures already in the graph, one edge is sufficient to connect the new structure to the graph in the proper neighbourhood. If there is no strong match, we compare the new structure to all existing structures and add edges for all significant similarities.</p><p>Similarity is measured by Dali <italic>Z</italic>-scores. &#x02018;Significant similarities&#x02019; have a <italic>Z</italic>-score above 2; they usually correspond to similar folds. &#x02018;Strong matches&#x02019; have sequence identity above 20% or a <italic>Z</italic>-score above a cutoff that depends on the size of the query protein. The <italic>Z</italic>-score cutoff was empirically set to <italic>n</italic>/10 &#x02212; 4, where <italic>n</italic> is the number of residues in the query structure. We additionally require that the complete structure is covered by structural alignments; a segment of the query structure longer than 80 residues without any structural matches always disqualifies a strong match.</p></sec><sec id="SEC2.3"><title>2.3 Database searching</title><p>The database search option DaliLite &#x02013;quick compares a query structure to all structures in the PDB, as organized in the structural similarity graph. To initiate a transitive search of structures in the graph, the query structure must be attached to <italic>some</italic> structural neighbours. Fast feature filters are often successful in finding near neighbours. We currently use sequence comparison by Blast, GTG sequence motifs (Heger <italic>et al.</italic>, <xref ref-type="bibr" rid="B1">2007</xref>) and secondary structure triplets to rank the structures in PDB90. We convert the feature filter scores to <italic>Z</italic>-scores in order to combine the ranked lists. The top 100 structures are compared using the normal Dali procedures. If a strong match is found, we move to the next step (transitive alignment). Otherwise, the query structure is compared against all 20 000 structures in PDB90.</p><p>The entry points connect the query structure to one or more structures in the structural similarity graph. These are direct (first shell) neighbours of the query. Structures in the second shell are compared in batches of 100, selecting those with the strongest connections first. Connection strength is the lesser <italic>Z</italic>-score along the path from query to the first neighbour to the second neighbour. The transitive alignment (via first neighbour) between the query structure and second neighbour is used as starting point for refinement, skipping the costly alignment optimization from scratch. The expansion is repeated until the connection strength drops below a <italic>Z</italic>-score cutoff of 2, or a maximum number of matches have been reported (default: MAX_HITS&#x02009;=&#x02009;500).</p></sec></sec><sec sec-type="results" id="SEC3"><title>3 RESULTS</title><p>The utility of a protein structure database search method (i.e. similarity measure and optimization algorithm) must depend on its ability to report back &#x02018;interesting&#x02019; matches. As an illustration, we chose query and target structures representing diverse super-families from the four main structural classes in SCOP: cytochromes c and winged helix DNA-binding domains from the all-alpha class, cupredoxins and PUA-like domains from the all-beta class, metallo-dependent hydrolases and alpha/beta hydrolases from the alpha/beta class, and lysozyme-likes and nucleotidyltransferases from the alpha+beta class (<xref ref-type="table" rid="T1">Table 1</xref>). Match lists were evaluated using the AUC, where the maximum value of one indicates perfect sensitivity and selectivity. Compared to optimizing the alignment from scratch (DaliLite &#x02013;list), the new transitive search mode (DaliLite &#x02013;quick) is about 30 times faster, without affecting AUC much (we removed all pre-existing edges from the query structures to the structural similarity graph). Compared to the SSM server's <italic>Q</italic>-score, the higher AUC values in Table 1 indicate superior discrimination of homologous proteins from unrelated proteins by Dali's <italic>Z</italic>-score.<table-wrap id="T1" position="float"><label>Table 1.</label><caption><p>Comparison of DaliLite v.3, the SSM server and SCOP</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Query</th><th rowspan="1" colspan="1">Dali &#x02212;q time (min)</th><th rowspan="1" colspan="1">Dali &#x02212;q P</th><th rowspan="1" colspan="1">Dali &#x02212;q Z AUC</th><th rowspan="1" colspan="1">Dali &#x02212;l time (min)</th><th rowspan="1" colspan="1">Dali &#x02212;l Z AUC</th><th rowspan="1" colspan="1">SSM Q AUC</th><th rowspan="1" colspan="1">SCOP T</th><th rowspan="1" colspan="1">SCOP class</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">1c52</td><td rowspan="1" colspan="1">14</td><td rowspan="1" colspan="1">241</td><td rowspan="1" colspan="1"><bold>0.885</bold></td><td rowspan="1" colspan="1">297</td><td rowspan="1" colspan="1">0.822</td><td rowspan="1" colspan="1">0.674</td><td rowspan="1" colspan="1">219</td><td rowspan="1" colspan="1">a.3.1.</td></tr><tr><td rowspan="1" colspan="1">1sfxA</td><td rowspan="1" colspan="1">12</td><td rowspan="1" colspan="1">401</td><td rowspan="1" colspan="1"><bold>0.757</bold></td><td rowspan="1" colspan="1">357</td><td rowspan="1" colspan="1">0.733</td><td rowspan="1" colspan="1">0.386</td><td rowspan="1" colspan="1">331</td><td rowspan="1" colspan="1">a.4.5.</td></tr><tr><td rowspan="1" colspan="1">1azu</td><td rowspan="1" colspan="1">14</td><td rowspan="1" colspan="1">529</td><td rowspan="1" colspan="1">0.967</td><td rowspan="1" colspan="1">369</td><td rowspan="1" colspan="1"><bold>0.969</bold></td><td rowspan="1" colspan="1">0.516</td><td rowspan="1" colspan="1">289</td><td rowspan="1" colspan="1">b.6.1.</td></tr><tr><td rowspan="1" colspan="1">1wk2A</td><td rowspan="1" colspan="1">7</td><td rowspan="1" colspan="1">49</td><td rowspan="1" colspan="1">0.800</td><td rowspan="1" colspan="1">201</td><td rowspan="1" colspan="1"><bold>0.966</bold></td><td rowspan="1" colspan="1">0.197</td><td rowspan="1" colspan="1">60</td><td rowspan="1" colspan="1">b.122.1</td></tr><tr><td rowspan="1" colspan="1">3be7A</td><td rowspan="1" colspan="1">51</td><td rowspan="1" colspan="1">542</td><td rowspan="1" colspan="1"><bold>0.990</bold></td><td rowspan="1" colspan="1">1861</td><td rowspan="1" colspan="1">0.968</td><td rowspan="1" colspan="1">0.843</td><td rowspan="1" colspan="1">135</td><td rowspan="1" colspan="1">c.1.9.</td></tr><tr><td rowspan="1" colspan="1">1qlwA</td><td rowspan="1" colspan="1">30</td><td rowspan="1" colspan="1">414</td><td rowspan="1" colspan="1"><bold>0.908</bold></td><td rowspan="1" colspan="1">1211</td><td rowspan="1" colspan="1">0.897</td><td rowspan="1" colspan="1">0.576</td><td rowspan="1" colspan="1">456</td><td rowspan="1" colspan="1">c.69.1.</td></tr><tr><td rowspan="1" colspan="1">2baa</td><td rowspan="1" colspan="1">18</td><td rowspan="1" colspan="1">726</td><td rowspan="1" colspan="1"><bold>0.693</bold></td><td rowspan="1" colspan="1">486</td><td rowspan="1" colspan="1">0.354</td><td rowspan="1" colspan="1">0.025</td><td rowspan="1" colspan="1">979</td><td rowspan="1" colspan="1">d.2.1</td></tr><tr><td rowspan="1" colspan="1">1wotA</td><td rowspan="1" colspan="1">13</td><td rowspan="1" colspan="1">500</td><td rowspan="1" colspan="1">0.558</td><td rowspan="1" colspan="1">251</td><td rowspan="1" colspan="1"><bold>0.642</bold></td><td rowspan="1" colspan="1">0.009</td><td rowspan="1" colspan="1">179</td><td rowspan="1" colspan="1">d.218.1</td></tr></tbody></table><table-wrap-foot><fn><p>AUC, area under the curve of reliability (TP/P) versus coverage (TP/T), where Ts (&#x02018;true&#x02019;) are members of the same SCOP (Murzin <italic>et al.</italic><xref ref-type="bibr" rid="B5">1995</xref>) superfamily as the query structure, Ps (&#x02018;positive&#x02019;) are the top <italic>n</italic> matches from the ranked list for varying <italic>n</italic> and TPs (&#x02018;true positive&#x02019;) are the intersection of sets T and P. Only PDB entries classified in SCOP v.1.73 were evaluated and each PDB entry was counted once. SSM server <ext-link ext-link-type="uri" xlink:href="http://www.ebi.ac.uk/msd-srv/ssm/cgi-bin/ssmserver">http://www.ebi.ac.uk/msd-srv/ssm/cgi-bin/ssmserver</ext-link>; (Krissinel and Henrick, <xref ref-type="bibr" rid="B6">2004</xref>) parameters were set to 10 : 10 and highest precision. The DaliLite search was performed using the &#x02013;list (Dali &#x02013;l) or &#x02013;quick option (Dali &#x02013;q with MAX_HITS=1000) and reporting matches with <italic>Z</italic>&#x0003e;2.</p></fn></table-wrap-foot></table-wrap></p><p>In conclusion, Dali remains a useful tool for structural bioinformatics. The Dali server has been running DaliLite &#x02013;quick for a number of months now, with a throughput of 50 user queries&#x02014;a mixture of redundant and unique structures&#x02014;per day per CPU.</p><p><italic>Funding</italic>: Academy of Finland (grants #109849 and #1105210).</p><p><italic>Conflict of Interest</italic>: none declared.</p></sec></body><back><ref-list><title>REFERENCES</title><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Heger</surname><given-names>A</given-names></name><etal/></person-group><article-title>The global trace graph, a novel paradigm for searching protein sequence databases</article-title><source>Bioinformatics</source><year>2007</year><volume>23</volume><fpage>2361</fpage><lpage>2367</lpage><pub-id pub-id-type="pmid">17823134</pub-id></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Holm</surname><given-names>L</given-names></name><name><surname>Park</surname><given-names>J</given-names></name></person-group><article-title>DaliLite workbench for protein structure comparison</article-title><source>Bioinformatics</source><year>2000</year><volume>16</volume><fpage>566</fpage><lpage>567</lpage><pub-id pub-id-type="pmid">10980157</pub-id></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Holm</surname><given-names>L</given-names></name><name><surname>Sander</surname><given-names>C</given-names></name></person-group><article-title>Searching protein structure databases has come of age</article-title><source>Proteins</source><year>1994</year><volume>19</volume><fpage>165</fpage><lpage>173</lpage><pub-id pub-id-type="pmid">7937731</pub-id></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>W</given-names></name><name><surname>Godzik</surname><given-names>A</given-names></name></person-group><article-title>Cd-hit: a fast program for clustering and comparing large sets of protein or nucleotide sequences</article-title><source>Bioinformatics</source><year>2006</year><volume>22</volume><fpage>1658</fpage><lpage>1659</lpage><pub-id pub-id-type="pmid">16731699</pub-id></citation></ref><ref id="B5"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Murzin</surname><given-names>AG</given-names></name><etal/></person-group><article-title>SCOP: a structural classification of proteins database for the investigation of sequences and structures</article-title><source>J. Mol. Biol.</source><year>1995</year><volume>247</volume><fpage>536</fpage><lpage>540</lpage><pub-id pub-id-type="pmid">7723011</pub-id></citation></ref><ref id="B6"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Krissinel</surname><given-names>E</given-names></name><name><surname>Henrick</surname><given-names>K</given-names></name></person-group><article-title>Secondary-structure matching (SSM), a new tool for fast protein structure alignment in three dimensions</article-title><source>Acta Cryst.</source><year>2004</year><volume>D60</volume><fpage>2256</fpage><lpage>2268</lpage></citation></ref><ref id="B7"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Sierk</surname><given-names>ML</given-names></name><name><surname>Pearson</surname><given-names>WR</given-names></name></person-group><article-title>Sensitivity and selectivity in protein structure comparison</article-title><source>Protein Sci.</source><year>2004</year><volume>13</volume><fpage>773</fpage><lpage>785</lpage><pub-id pub-id-type="pmid">14978311</pub-id></citation></ref></ref-list></back></article>