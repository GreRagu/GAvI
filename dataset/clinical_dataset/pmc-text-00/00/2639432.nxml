<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd"><article xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id><journal-title>BMC Bioinformatics</journal-title><issn pub-type="epub">1471-2105</issn><publisher><publisher-name>BioMed Central</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">19040729</article-id><article-id pub-id-type="pmc">2639432</article-id><article-id pub-id-type="publisher-id">1471-2105-9-504</article-id><article-id pub-id-type="doi">10.1186/1471-2105-9-504</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group></article-categories><title-group><article-title>Highly sensitive feature detection for high resolution LC/MS</article-title></title-group><contrib-group><contrib id="A1" corresp="yes" contrib-type="author"><name><surname>Tautenhahn</surname><given-names>Ralf</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>rtautenh@ipb-halle.de</email></contrib><contrib id="A2" contrib-type="author"><name><surname>B&#x000f6;ttcher</surname><given-names>Christoph</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>cboettch@ipb-halle.de</email></contrib><contrib id="A3" contrib-type="author"><name><surname>Neumann</surname><given-names>Steffen</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>sneumann@ipb-halle.de</email></contrib></contrib-group><aff id="I1"><label>1</label>Leibniz Institute of Plant Biochemistry, Department of Stress and Developmental Biology, Weinberg 3, 06120 Halle, Germany</aff><pub-date pub-type="collection"><year>2008</year></pub-date><pub-date pub-type="epub"><day>28</day><month>11</month><year>2008</year></pub-date><volume>9</volume><fpage>504</fpage><lpage>504</lpage><ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/9/504"/><history><date date-type="received"><day>9</day><month>7</month><year>2008</year></date><date date-type="accepted"><day>28</day><month>11</month><year>2008</year></date></history><permissions><copyright-statement>Copyright &#x000a9; 2008 Tautenhahn et al; licensee BioMed Central Ltd.</copyright-statement><copyright-year>2008</copyright-year><copyright-holder>Tautenhahn et al; licensee BioMed Central Ltd.</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0"><p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p><!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>               Tautenhahn               Ralf                              rtautenh@ipb-halle.de            </dc:author><dc:title>            Highly sensitive feature detection for high resolution LC/MS         </dc:title><dc:date>2008</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 9(1): 504-. (2008)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2008)9:1&#x0003c;504&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>--></license></permissions><abstract><sec><title>Background</title><p>Liquid chromatography coupled to mass spectrometry (LC/MS) is an important analytical technology for e.g. metabolomics experiments. Determining the boundaries, centres and intensities of the two-dimensional signals in the LC/MS raw data is called feature detection. For the subsequent analysis of complex samples such as plant extracts, which may contain hundreds of compounds, corresponding to thousands of features &#x02013; a reliable feature detection is mandatory.</p></sec><sec><title>Results</title><p>We developed a new feature detection algorithm <italic>centWave </italic>for high-resolution LC/MS data sets, which collects regions of interest (partial mass traces) in the raw-data, and applies continuous wavelet transformation and optionally Gauss-fitting in the chromatographic domain. We evaluated our feature detection algorithm on dilution series and mixtures of seed and leaf extracts, and estimated recall, precision and F-score of seed and leaf specific features in two experiments of different complexity.</p></sec><sec><title>Conclusion</title><p>The new feature detection algorithm meets the requirements of current metabolomics experiments. <italic>centWave </italic>can detect close-by and partially overlapping features and has the highest overall recall and precision values compared to the other algorithms, <italic>matchedFilter </italic>(the original algorithm of <italic>XCMS</italic>) and the centroidPicker from <italic>MZmine</italic>. The <italic>centWave </italic>algorithm was integrated into the Bioconductor R-package <italic>XCMS </italic>and is available from <ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org/"/></p></sec></abstract></article-meta></front><body><sec><title>Background</title><p>Metabolomics aims at the unbiased and comprehensive quantification of metabolite concentrations in organisms, tissues, or cells [<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B2">2</xref>]. The combination of chromatographic separation with subsequent mass spectrometric detection has emerged as a key technology for multiparallel analysis of low molecular weight compounds in biological systems. Gas chromatography-mass spectrometry (GC/MS) based techniques are mature and well-established, but restricted to volatile compounds, often requiring chemical derivatisation. High-performance liquid chromatography-mass spectrometry (HPLC/MS) facilitates the analysis of compounds of higher polarity and lower volatility in a much wider mass range without derivatisation [<xref ref-type="bibr" rid="B3">3</xref>-<xref ref-type="bibr" rid="B5">5</xref>]. With LC/MS the injected sample is separated on the chromatographic column, resulting in the consecutive elution of different compounds. The mass spectrometer acquires mass spectra from the column output at a specified scan rate, so each compound can be measured in several consecutive scans. Due to the fact that each eluting compound gives rise to a number of mass signals (adducts, fragments and isotopic peaks), a metabolite induces several two-dimensional features.</p><p>In the following, we use the term "feature" for a bounded, two-dimensional (<italic>m/z </italic>and retention time) LC/MS signal. The term "peak" is used for one-dimensional signals: both <italic>m/z </italic>peaks (centroids) in the mass spectrum and chromatographic peaks.</p><p>For complex metabolomics samples, the LC/MS data contains hundreds to thousands of metabolites. For the statistical analysis of biological experiments the feature intensity is of interest and has to be calculated from the raw data. Spectra can be acquired in profile mode or centroid mode. Vendor supplied centroidisation algorithms usually employs machine-specific models, which are superior to generic approaches. In addition, the centroid mode results in considerable size reduction of the LC/MS data set.</p><p>The processing pipeline for LC/MS based metabolomics can be divided into the following steps:</p><p>1. Signal preprocessing and centroidization in <italic>m/z</italic>,</p><p>2. Two-dimensional feature detection and integration</p><p>3. Alignment of corresponding features in multiple samples</p><p>4. Statistical analysis, chemical and biological interpretation.</p><p>Feature detection is a crucial step in the LC/MS data processing pipeline &#x02013; it should be reliable, i.e. report as many as possible "real" features, while keeping the false positive rate low. The challenge for the algorithms is to detect features of low intensity induced by compounds with low abundance on the one hand, and to avoid feature-like signals caused by e.g. chemical noise on the other hand.</p><p>Several frameworks for feature detection (and alignment) of metabolomics LC/MS data have been developed in the last years, both commercial products such as MarkerLynx (Waters), the closed-source (but freely-available) MetAlign [<xref ref-type="bibr" rid="B6">6</xref>], or XCMS [<xref ref-type="bibr" rid="B7">7</xref>] and <italic>MZmine </italic>[<xref ref-type="bibr" rid="B8">8</xref>] which have open-source licenses. Other packages, some of them specific for LC/MS-based proteomics, have been reviewed in [<xref ref-type="bibr" rid="B9">9</xref>].</p><p>A widely used approach for the processing of LC/MS data is to transform the raw data into a matrix representation with the dimensions <italic>m/z</italic>, retention time and intensity. To convert high resolution mass spectra into this representation, it is necessary to divide the <italic>m/z </italic>axis into equidistant chunks depending on the resolution of the mass spectrometer, e. g. 0.1 <italic>m/z </italic>wide. This procedure is usually referred to as binning. Some drawbacks of this method were already mentioned in [<xref ref-type="bibr" rid="B7">7</xref>,<xref ref-type="bibr" rid="B10">10</xref>,<xref ref-type="bibr" rid="B11">11</xref>]. In particular, specifying the optimal bin size for the particular data set can be difficult. If the bin size is chosen too small, chromatographic peaks are alternating between bins and cannot be detected due to the loss of the chromatographic shape. If the bin size is too large, peaks can overlay each other and small features are rather buried by the increased chromatographic noise level. On the positive side it should be mentioned that the binning approach is all-purpose and allows for a fast data processing.</p><p>A density based LC/MS feature detection approach &#x02013; an alternative to the common binning technique &#x02013; was introduced by Stolt et al. [<xref ref-type="bibr" rid="B10">10</xref>]. The authors consider the emerging analyte as a region of data points with high density anked by a specific "data void". Based on these properties, they calculate a potential field which is then used to create a matrix of mass traces (runtime ~2 h/sample). Recently, the extraction of "pure ion chromatograms" using Kalman tracking was demonstrated in [<xref ref-type="bibr" rid="B11">11</xref>]. The applicability of Wavelet based techniques for peak picking in MALDI- and SELDI-TOF mass spectra was shown by e.g. [<xref ref-type="bibr" rid="B12">12</xref>-<xref ref-type="bibr" rid="B15">15</xref>]. Here we will discuss a new method for the reliable detection and integration of two-dimensional LC/MS signals, referred to as features. By using a combination of a density based technique to detect regions of interest in the <italic>m/z </italic>domain, and a Wavelet based approach to resolve chromatographic peaks, we achieve a high sensitivity even in very complex mixtures compared to two other algorithms, <italic>matchedFilter </italic>(the original algorithm of <italic>XCMS</italic>) and the <italic>centroidPicker </italic>from <italic>MZmine</italic>.</p><p>So far, there is no common method for evaluating the performance of feature detection algorithms. Even for the same feature detection algorithm, different parametrisation can lead to (vastly) different results, if e.g. many false positive noise signals are detected as features. Therefore the absolute number of detected features per sample is not suitable to characterise a feature detection algorithm. More elaborate approaches consider mixtures of known compounds spiked into complex samples [<xref ref-type="bibr" rid="B16">16</xref>]. To the best of our knowledge, no evaluation has been performed to assess recall and precision of feature detection algorithms for multiple complex samples.</p><p>The remainder of this paper is structured as follows: In section 2 we give a detailed description of the <italic>centWave </italic>algorithm, followed by the description of the experimental comparison between several feature detection algorithms. In section 3 we present the evaluation results and discuss the benefits of <italic>centWave</italic>, followed by a conclusion and outlook of expected future developments in section 4.</p></sec><sec sec-type="methods"><title>Methods</title><p>This section describes the <italic>centWave </italic>method which combines density based detection of regions of interest in the <italic>m/z </italic>domain, and a Continuous Wavelet Transform (CWT) based approach for chromatographic peak resolution. The experimental setup is depicted as well as the layout of the evaluation procedure.</p><sec><title>2.1 The centWave algorithm</title><sec><title>2.1.1 Detecting regions of interest (ROI) in the m/z domain</title><p>To circumvent the mentioned problems of the binning technique, an alternative, fast computing approach was used which directly detects regions of interesting mass traces. Figure <xref ref-type="fig" rid="F1">1</xref> shows the extracted ion chromatogram and the corresponding <italic>m/z </italic>centroids in the consecutive mass spectra for a typical LC/MS feature, recorded in centroid mode. With the chromatographic peak emerging, the consecutive centroids form a compact mass trace bounded in <italic>m/z </italic>and retention time. The <italic>m/z </italic>deviation is determined by the mass accuracy of the mass spectrometer and typically increases with lower signal intensities.</p><fig position="float" id="F1"><label>Figure 1</label><caption><p><bold>Mass trace and chromatographic peak of Biochanin A [<italic>M </italic>+ <italic>H</italic>]<sup>+ </sup>mass signal</bold>. The upper panel shows the mass trace of the biochanin A [<italic>M </italic>+ <italic>H</italic>]<sup>+ </sup>mass signal across 10 seconds with colour-coded intensities. The corresponding chromatographic peak is shown below.</p></caption><graphic xlink:href="1471-2105-9-504-1"/></fig><p>Due to the fact that the mass accuracy (<italic>&#x003bc;</italic>, given in ppm) of the mass spectrometer and the minimum chromatographic peak width is known or can easily be assessed, it is possible to directly scan for regions where at least p<sub>min </sub>centroids with a deviation less than <italic>&#x003bc; </italic>ppm occur. This task is achieved by the following algorithm for samples in centroid mode, with scans numbered <italic>s </italic>= 1,...,<italic>S</italic>:</p><p>1. Initialisation:</p><p>(a) Initialise a list ROI using all <italic>m/z </italic>values <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" name="1471-2105-9-504-i1" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mrow><mml:mtext>mz</mml:mtext></mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula> from the first scan:</p><p>&#x02200; <italic>i </italic>= 1,..., <italic>N</italic>, <italic>N </italic>= |mz<sup><italic>s </italic>= 1</sup>|: ROI(<italic>i</italic>).values(1) = <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2" name="1471-2105-9-504-i2" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mrow><mml:mtext>mz</mml:mtext></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula></p><p>(b) Initialise the <italic>m/z </italic>mean value for each actually processed region :</p><p>ROI(<italic>i</italic>).mzmean = <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M3" name="1471-2105-9-504-i2" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mrow><mml:mtext>mz</mml:mtext></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula>, <italic>i </italic>= 1,..., <italic>N, N </italic>= |mz<sup><italic>s </italic>= 1</sup>|</p><p>2. For each scan <italic>s </italic>= 2,..., <italic>S </italic>:</p><p>(a) For each <italic>m/z </italic>value <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M4" name="1471-2105-9-504-i1" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mrow><mml:mtext>mz</mml:mtext></mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula>, <italic>i </italic>= 1,..., <italic>N, N </italic>= |mz<sup><italic>s</italic></sup>| in the current scan <italic>s</italic>:</p><p>Exists <italic>j, j </italic>= 1,..., <italic>J, J </italic>= |ROI| such that |ROI(<italic>j</italic>).mzmean - <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M5" name="1471-2105-9-504-i1" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mrow><mml:mtext>mz</mml:mtext></mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula>| &#x0003c; = <italic>&#x003bc; </italic>?</p><p>&#x02022; <bold>Yes</bold>: Append <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M6" name="1471-2105-9-504-i1" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mrow><mml:mtext>mz</mml:mtext></mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula> to ROI(<italic>j</italic>) and update the <italic>m/z </italic>mean value</p><p><italic>K </italic>= |ROI(<italic>j</italic>).values| + 1, ROI(<italic>j</italic>).values(<italic>K</italic>) = <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M7" name="1471-2105-9-504-i1" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mrow><mml:mtext>mz</mml:mtext></mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula></p><p>ROI(<italic>j</italic>).mzmean = <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M8" name="1471-2105-9-504-i3" overflow="scroll"><mml:semantics><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>K</mml:mi></mml:mfrac><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:mrow><mml:mi>R</mml:mi><mml:mi>O</mml:mi><mml:mi>I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:semantics></mml:math></inline-formula>.values(<italic>k</italic>)</p><p>&#x02022; <bold>No</bold>: Initialise a new ROI and append it to the list</p><p><italic>J </italic>= |ROI| + 1, ROI(<italic>J</italic>).values(1) = <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M9" name="1471-2105-9-504-i1" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mrow><mml:mtext>mz</mml:mtext></mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula>, ROI(<italic>J</italic>).mzmean = <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M10" name="1471-2105-9-504-i1" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mrow><mml:mtext>mz</mml:mtext></mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula></p><p>(b) Check &#x00026; Cleanup:</p><p>&#x02022; Remove all ROI which were not extended in step 2a <italic>and </italic>contain less than p<sub>min </sub>centroids</p><p>&#x02022; Mark ROI that were not extended, but contain at least p<sub>min </sub>centroids as completed</p><p>Optionally an intensity filter (<italic>prefilter </italic>= (<italic>k</italic>, <italic>I</italic>), e. g. <italic>prefilter </italic>= (2, 100)) can be set to early discard regions of small intensity. Then only those ROI are retained (in step 2b) that contain at least <italic>k </italic>consecutive values with intensity &#x02265; <italic>I</italic>. This prefilter vastly speeds up the overall processing time.</p><p>Each <italic>m/z </italic>value needs to be considered only once, so the ROI algorithm is fast (approximately 10&#x02013;20 seconds on a 2.5 GHz CPU for a measurement with 3000 scans). Figure <xref ref-type="fig" rid="F2">2</xref> shows the result of the ROI detection algorithm for a small region of a complex LC/MS sample.</p><fig position="float" id="F2"><label>Figure 2</label><caption><p><bold>Region Of Interest (ROI) detection</bold>. Raw data in the chromatographic and <italic>m/z </italic>region around the [<italic>M </italic>+ <italic>H</italic>]<sup>+ </sup>mass signal (1) of biochanin A. In addition to the three isotopic peaks (2&#x02013;4) other mass signals are marked as ROIs.</p></caption><graphic xlink:href="1471-2105-9-504-2"/></fig><p>In some rare cases "gaps" are observed in the mass trace of features with low intensity. Due to the fact that each ROI is laterally extended for the following chromatographic peak detection, only a small contiguous region needs to be found for the successful detection of such features. To a certain extent, the algorithm is therefore able to detect features with such gaps. Otherwise, in case of samples which might show this phenomenon more often, the algorithm can easily be modified to be even more "gap-tolerant". In contrast to binning, this approach has the advantage that no fixed bin size has to be chosen. Each ROI is detected separately and the drawbacks of binning can be circumvented. Unlike binning the result is not a matrix but a list of mass traces with different lengths. Depending on the chromatography and the mass accuracy of the mass spectrometer, each ROI may contain none, exactly one or more than one distinct chromatographic peaks. Therefore it is necessary to subject each ROI to an extensive analysis in the chromatographic domain.</p></sec><sec><title>2.1.2 Detecting chromatographic peaks</title><p>Depending on the separation technique (e. g. HPLC/UPLC/CE) features can show considerable variations in their chromatographic width and shape. The matched filter approach makes use of a filter based on a model peak with defined shape and fixed width. This technique gives good results in most cases and was shown to work in principle also for peaks of differing width and shape (see [<xref ref-type="bibr" rid="B17">17</xref>,<xref ref-type="bibr" rid="B18">18</xref>]) but nevertheless some problems occur if the model peak width is not chosen appropriately. Figure <xref ref-type="fig" rid="F3">3</xref> shows a mass trace from a HPLC/MS sample, containing three peaks of different width. The application of three independent matched filters with different width of the model peak (second derivative Gaussian) reveals the problem of assessing the perfect model peak width. Narrow peaks are found perfectly with a small model peak width (e. g. <italic>&#x003c3; </italic>= 5&#x02013;10 s) while broad peaks can only be properly detected with an increased model peak width (e. g. <italic>&#x003c3; </italic>= 20 s).</p><fig position="float" id="F3"><label>Figure 3</label><caption><p><bold>Matched filter effects, example region 1</bold>. HPLC/ESI-QTOF-MS of a <italic>A. thaliana </italic>leaf extract. Extracted ion chromatogram (277.213 &#x02013; 277.221 <italic>m/z</italic>) and matched filter results using second derivative Gaussian with different filter widths. Negative filter values were omitted.</p></caption><graphic xlink:href="1471-2105-9-504-3"/></fig><p>Another aspect of this optimisation problem are chromatographic close-by peaks. Figure <xref ref-type="fig" rid="F4">4</xref> shows the response of three independent matched filters with different <italic>&#x003c3; </italic>on a chromatogram with many narrow, close-by peaks. It can be seen that only a matched filter with a very small model peak width (e. g. <italic>&#x003c3; </italic>= 5 s) gives reasonable results in this case. Figure <xref ref-type="fig" rid="F3">3</xref> and <xref ref-type="fig" rid="F4">4</xref> are examples from the same LC/MS measurement. In this case, none of the three chosen model peak widths yields satisfying results for all occuring peaks. The enhancement of the matched filter approach is the peak detection on multiple scales using Continuous Wavelet Transform (CWT), which reliably detects chromatographic peaks of differing width. The CWT is widely used in signal processing and pattern recognition. The mathematical representation [<xref ref-type="bibr" rid="B19">19</xref>] is as follows:</p><fig position="float" id="F4"><label>Figure 4</label><caption><p><bold>Matched filter effects, example region 2</bold>. HPLC/ESI-QTOF-MS of a <italic>A. thaliana </italic>leaf extract. Extracted ion chromatogram (967.53&#x02013;967.56 <italic>m/z</italic>, same sample that was used for Figure 3) and matched filter results using second derivative Gaussian with different filter widths. Negative filter values were clipped.</p></caption><graphic xlink:href="1471-2105-9-504-4"/></fig><p><disp-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M11" name="1471-2105-9-504-i4" overflow="scroll">                        <mml:semantics>                           <mml:mrow>                              <mml:mtable>                                 <mml:mtr>                                    <mml:mtd>                                       <mml:mrow>                                          <mml:mo stretchy="false">(</mml:mo>                                          <mml:msup>                                             <mml:mi>T</mml:mi>                                             <mml:mrow>                                                <mml:mtext>wav</mml:mtext>                                             </mml:mrow>                                          </mml:msup>                                          <mml:mi>f</mml:mi>                                          <mml:mo stretchy="false">)</mml:mo>                                          <mml:mo stretchy="false">(</mml:mo>                                          <mml:mi>s</mml:mi>                                          <mml:mo>,</mml:mo>                                          <mml:mi>&#x003c4;</mml:mi>                                          <mml:mo stretchy="false">)</mml:mo>                                          <mml:mo>=</mml:mo>                                          <mml:mstyle displaystyle="true">                                             <mml:mrow>                                                <mml:munderover>                                                   <mml:mo>&#x0222b;</mml:mo>                                                   <mml:mrow>                                                      <mml:mo>&#x02212;</mml:mo>                                                      <mml:mi>&#x0221e;</mml:mi>                                                   </mml:mrow>                                                   <mml:mi>&#x0221e;</mml:mi>                                                </mml:munderover>                                                <mml:mrow>                                                   <mml:mi>f</mml:mi>                                                   <mml:mo stretchy="false">(</mml:mo>                                                   <mml:mi>t</mml:mi>                                                   <mml:mo stretchy="false">)</mml:mo>                                                   <mml:msub>                                                      <mml:mi>&#x003c8;</mml:mi>                                                      <mml:mrow>                                                         <mml:mi>s</mml:mi>                                                         <mml:mo>,</mml:mo>                                                         <mml:mi>&#x003c4;</mml:mi>                                                      </mml:mrow>                                                   </mml:msub>                                                   <mml:mo stretchy="false">(</mml:mo>                                                   <mml:mi>t</mml:mi>                                                   <mml:mo stretchy="false">)</mml:mo>                                                   <mml:mi>d</mml:mi>                                                   <mml:mi>t</mml:mi>                                                </mml:mrow>                                             </mml:mrow>                                          </mml:mstyle>                                       </mml:mrow>                                    </mml:mtd>                                 </mml:mtr>                                 <mml:mtr>                                    <mml:mtd>                                       <mml:mrow>                                          <mml:mtable>                                             <mml:mtr>                                                <mml:mtd>                                                   <mml:mrow>                                                      <mml:msub>                                                         <mml:mi>&#x003c8;</mml:mi>                                                         <mml:mrow>                                                            <mml:mi>s</mml:mi>                                                            <mml:mo>,</mml:mo>                                                            <mml:mi>&#x003c4;</mml:mi>                                                         </mml:mrow>                                                      </mml:msub>                                                      <mml:mo stretchy="false">(</mml:mo>                                                      <mml:mi>t</mml:mi>                                                      <mml:mo stretchy="false">)</mml:mo>                                                      <mml:mo>=</mml:mo>                                                      <mml:mfrac>                                                         <mml:mn>1</mml:mn>                                                         <mml:mrow>                                                            <mml:msqrt>                                                               <mml:mi>s</mml:mi>                                                            </mml:msqrt>                                                         </mml:mrow>                                                      </mml:mfrac>                                                      <mml:mi>&#x003c8;</mml:mi>                                                      <mml:mrow>                                                         <mml:mo>(</mml:mo>                                                         <mml:mrow>                                                            <mml:mfrac>                                                               <mml:mrow>                                                                  <mml:mi>t</mml:mi>                                                                  <mml:mo>&#x02212;</mml:mo>                                                                  <mml:mi>&#x003c4;</mml:mi>                                                               </mml:mrow>                                                               <mml:mi>s</mml:mi>                                                            </mml:mfrac>                                                         </mml:mrow>                                                         <mml:mo>)</mml:mo>                                                      </mml:mrow>                                                      <mml:mo>,</mml:mo>                                                   </mml:mrow>                                                </mml:mtd>                                                <mml:mtd>                                                   <mml:mrow>                                                      <mml:mtable>                                                         <mml:mtr>                                                            <mml:mtd>                                                               <mml:mrow>                                                                  <mml:mi>s</mml:mi>                                                                  <mml:mo>&#x02208;</mml:mo>                                                                  <mml:msup>                                                                     <mml:mi>&#x0211d;</mml:mi>                                                                     <mml:mo>+</mml:mo>                                                                  </mml:msup>                                                                  <mml:mo>&#x02212;</mml:mo>                                                                  <mml:mo>{</mml:mo>                                                                  <mml:mn>0</mml:mn>                                                                  <mml:mo>}</mml:mo>                                                                  <mml:mo>,</mml:mo>                                                               </mml:mrow>                                                            </mml:mtd>                                                            <mml:mtd>                                                               <mml:mrow>                                                                  <mml:mi>&#x003c4;</mml:mi>                                                                  <mml:mo>&#x02208;</mml:mo>                                                                  <mml:mi>&#x0211d;</mml:mi>                                                               </mml:mrow>                                                            </mml:mtd>                                                         </mml:mtr>                                                      </mml:mtable>                                                   </mml:mrow>                                                </mml:mtd>                                             </mml:mtr>                                          </mml:mtable>                                       </mml:mrow>                                    </mml:mtd>                                 </mml:mtr>                              </mml:mtable>                           </mml:mrow>                                                   </mml:semantics>                     </mml:math></disp-formula></p><p>where <italic>f</italic>(<italic>t</italic>) is the signal, <italic>&#x003c8; </italic>the mother wavelet, <italic>s </italic>the scale and <italic>&#x003c4; </italic>the translation. The result of the CWT is a two-dimensional matrix of wavelet coefficients <italic>T</italic><sup>wav</sup>. Since the "Mexican Hat" wavelet (normalised second derivative of Gaussian <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M12" name="1471-2105-9-504-i5" overflow="scroll"><mml:semantics><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:semantics></mml:math></inline-formula>, Figure <xref ref-type="fig" rid="F5">5</xref>) is used as the mother wavelet, the result of the CWT is comparable to the combined application of the matched filter technique with the second derivative Gaussian of different widths as model peak. The algorithms for CWT and CWT-coefficient analysis described and implemented in [<xref ref-type="bibr" rid="B13">13</xref>] for the peak detection in SELDI/TOF spectra were adapted for peak detection in the chromatographic domain.</p><fig position="float" id="F5"><label>Figure 5</label><caption><p><bold>Mexican Hat Wavelet</bold>. Mexican hat wavelet at different scales.</p></caption><graphic xlink:href="1471-2105-9-504-5"/></fig></sec><sec><title>2.1.3 The centWave workflow</title><p>The three relevant input parameters for the <italic>centWave </italic>algorithm are</p><p>1. Mass deviation <italic>&#x003bc; </italic>in ppm, typically set to a generous multiple of the mass accuracy of the mass spectrometer. We use <italic>&#x003bc; </italic>= 30 ppm for the Bruker MicrOTOF-Q, which is advertised with a mass accuracy of 3&#x02013;5 ppm.</p><p>2. Chromatographic peak width range w<sub>min</sub>, w<sub>max </sub>in seconds, e. g. w<sub>min</sub>, w<sub>max </sub>= (5, 10) for UPLC separation as described in the experimental setup.</p><p>3. Signal to noise ratio threshold SNR<sub>Thr</sub>, e.g. SNR<sub>Thr </sub>= 10</p><p>The following is the description of the most important steps of the <italic>centWave </italic>workflow:</p><p>&#x02022; The scale range s<sub>min</sub>, s<sub>max </sub>for the CWT and the p<sub>min </sub>parameter for the ROI detection are calculated from the input parameters w<sub>min</sub>, w<sub>max </sub>and the average inter-scan distance.</p><p>&#x02022; ROI detection (see section 2.1.1) is performed using the parameters <italic>&#x003bc; </italic>and p<sub>min</sub></p><p>&#x02022; Chromatographic analysis of each detected ROI:</p><p>- To accommodate noise and baseline estimation, each ROI is laterally extended by a multiple of the expected chromatographic peak width</p><p>- Local noise and baseline estimation: Let <italic>x </italic>be the vector of intensity values of the actual (extended) ROI, and <italic>x</italic><sub><italic>t </italic></sub>the 10% trimmed <italic>x </italic>(5% of the smallest and 5% of the largest intensity values are discarded). Then the baseline BL is assessed as the mean value of <italic>x</italic><sub><italic>t </italic></sub>and the noise level NL as the standard devation of <italic>x</italic><sub><italic>t</italic></sub>.</p><p>- The Continuous Wavelet Transform (see 2.1.2) is applied to the intensity values of the ROI (the extracted ion chromatogram), using the scale range s<sub>min</sub>,..., s<sub>max</sub>.</p><p>- Local maxima of the CWT coefficients at each scale are detected.</p><p>- "Ridges" can be identified by linking the detected local maxima (described in [<xref ref-type="bibr" rid="B13">13</xref>]). The ridges describe the scale range where the chromatographic peak was located. If more than one chromatographic peak was detected, the following steps are applied for each peak separately.</p><p>- Locate the chromatographic peak boundaries rt<sub>min </sub>and rt<sub>max </sub>by descent on the filtered peak data, i.e. the CWT coefficients of the scale where the peak was optimally located.</p><p>- Calculate the feature intensity I using the intensity values within rt<sub>min </sub>and rt<sub>max</sub>. I<sub>max </sub>is defined as the maximal intensity value within this range.</p><p>- Compute the <italic>m/z </italic>centroid of the feature as the weighted mean of the <italic>m/z </italic>values within rt<sub>min </sub>and rt<sub>max</sub>.</p><p>- Calculate the signal to noise ratio SNR = (I<sub>max </sub>&#x02013; BL)/NL of the feature. Discard the feature if SNR &#x0003c; SNR<sub>Thr</sub>.</p><p>- The deviation <italic>&#x003bc;</italic>* of <italic>m/z </italic>values within rt<sub>min </sub>and rt<sub>max </sub>is calculated in ppm. The value <italic>&#x003bc;</italic>* can be interpreted as the mass deviation value which would have been sufficient for the detection of this feature.</p><p>- Optionally, a Gaussian curve is fitted to the feature, using the Nonlinear Least Squares (NLS) implementation of R.</p><p>The result of the <italic>centWave </italic>algorithm for the regions shown in Figure <xref ref-type="fig" rid="F3">3</xref> and <xref ref-type="fig" rid="F4">4</xref> is depicted in Figure <xref ref-type="fig" rid="F6">6</xref> and <xref ref-type="fig" rid="F7">7</xref>, respectively. The following experiments were designed to pose challenges with increasing complexity to the feature detection algorithms. We used complex mixtures with <italic>Arabidopsis thaliana </italic>leaf and seed extracts.</p><fig position="float" id="F6"><label>Figure 6</label><caption><p><bold>centWave results for example region 1</bold>. <italic>centWave </italic>results for example region 1. The lower part shows the same extracted ion chromatogram (277.213&#x02013;277.221 <italic>m/z</italic>) as in Figure 3 and the detected chromatographic peaks from the <italic>centWave </italic>algorithm as Gaussian fits. The upper part shows the CWT coefficients on the different scales. A cross marks the scale where the peak was optimally localised. The vertical grey lines show the peak borders which were estimated from the coefficients of this scale.</p></caption><graphic xlink:href="1471-2105-9-504-6"/></fig><fig position="float" id="F7"><label>Figure 7</label><caption><p><bold>centWave results for example region 2</bold>. <italic>centWave </italic>results for example region 2. The lower part shows the same extracted ion chromatogram (967.53&#x02013;967.56 <italic>m/z</italic>) as in Figure 4 and the detected chromatographic peaks from the <italic>centWave </italic>algorithm as Gaussian fits. The upper part shows the CWT coefficients on the different scales. A cross marks the scale where the peak was optimally localised. The vertical grey lines show the peak borders which were estimated from the coefficients of this scale.</p></caption><graphic xlink:href="1471-2105-9-504-7"/></fig></sec></sec><sec><title>2.2 Experimental setup and Sample description</title><p><italic>Arabidopsis thaliana </italic>(ecotype Col-0) was grown under controlled conditions and pooled after harvest. Methanolic extracts were prepared from ground seed and leaf tissue. o-Anisic acid, biochanin A, p-coumaric acid, ferulic acid, <italic>N</italic>-(3-indolylacetyl)-L-valine, kinetin, indole-3-acetonitrile, indole-3-carbaldehyde, kaempferol, phloretin, phlorizin and phenylglycine, rutin, and phenylalanine-d5 were used as marker compounds. The chromatographic separations were performed on an Acquity UPLC system (Waters) equipped with a modified <italic>C</italic><sub>18 </sub>column with a 20 min water/acetonitrile gradient. The eluted compounds were detected by a Bruker MicrOTOF-Q in positive ion mode at a scan rate of 3 Hz. Mass calibration was performed against lithium formiate. The detailed experimental setup is available as Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>.</p><p><bold>Sample 1 </bold>A mixture containing each of the fourteen marker compounds (referred to as MM14) at a concentration of 20 <italic>&#x003bc;</italic>M was prepared and analysed by UPLC/ESI-QTOF-MS.</p><p><bold>Sample set 2 </bold>Mixtures containing solvent and seed or leaf extracts were prepared with following volume portions (solvent/seed/leaf, v/v/v): 0/100/0, 25/75/0, 50/50/0, 75/25/0, 0/0/100, 25/0/75, 50/0/50, 75/0/25. The sample set (8 samples) was analysed by UPLC/ESI-QTOF-MS in ten technical replications.</p><p><bold>Sample set 3 </bold>Mixtures containing solvent, seed, and leaf extracts were prepared with following volume portions (solvent/seed/leaf, v/v/v): 75/0/25, 0/75/25, 0/50/50. The sample set (3 samples) was analysed by UPLC/ESI-QTOF-MS in ten technical replications.</p><p>All files were acquired in centroid mode and converted to mzData file format using Bruker CompassXport software. The data sets are available at <ext-link ext-link-type="uri" xlink:href="http://msbi.ipb-halle.de/msbi/centwave/"/>.</p></sec><sec><title>2.3 Parameter optimisation</title><p>Beside <italic>centWave</italic>, there are currently only two other feature detection algorithms available [<xref ref-type="bibr" rid="B9">9</xref>], which meet the following criteria: freely available, open source, and suited for feature detection in metabolomic LC/MS samples measured in centroid mode: <italic>matchedFilter</italic>- the originally implemented algorithm from XCMS and the <italic>centroidPicker </italic>from <italic>MZmine </italic>(Table <xref ref-type="table" rid="T1">1</xref>).</p><table-wrap position="float" id="T1"><label>Table 1</label><caption><p>Overview of the evaluated feature detection algorithms</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="left">Algorithm</td><td align="center">Framework</td><td align="center">Version</td><td align="left">Programming Language</td><td align="left">Availability</td></tr></thead><tbody><tr><td align="left">centroidPicker</td><td align="center">MZmine</td><td align="center">0.60</td><td align="left">Java</td><td align="left"><ext-link ext-link-type="uri" xlink:href="http://mzmine.sourceforge.net/"/></td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="left">centWave matchedFilter</td><td align="center">XCMS</td><td align="center">1.12.1</td><td align="left">C, R</td><td align="left"><ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/release/bioc/html/xcms.html"/></td></tr></tbody></table><table-wrap-foot><p>Overview of the compared feature detection algorithms for metabolomics data. MZmine has three feature detection algorithms implemented, but only the centroidPicker is suitable for centroided data and therefore was used for the evaluation.</p></table-wrap-foot></table-wrap><p>The three algorithms tested have a number of parameters each, which have to be tuned to deliver good performance on the analytical setup. The <italic>centWave </italic>algorithm uses the <italic>peakwidth </italic>(= w<sub>min</sub>, w<sub>max</sub>) parameter to specify the chromatographic peak width range, the <italic>ppm </italic>parameter to set the tolerated mass deviation and <italic>snthresh</italic>, which defines the chromatographic signal-to-noise threshold. The <italic>matchedFilter </italic>algorithm has a similar parameter <italic>snthresh</italic>, the chromatographic peak width is specified by the <italic>fwhm </italic>parameter, which defines the width of the model peak for matched filtering. The mass accuracy is indirectly defined by the bin size (parameter <italic>step</italic>).</p><p>The centroidPicker from <italic>MZmine </italic>also needs a bin size to be specified (<italic>bin size</italic>), and additionally the tolerated mass deviation (<italic>m/z tolerance</italic>). Moreover, there are five parameters that affect the chromatographic domain: <italic>chromatographic threshold level</italic>, <italic>intensity tolerance</italic>, <italic>minimum peak duration</italic>, <italic>minimum peak height </italic>and <italic>noise level</italic>. The first two of those are specified as a relative value, while the last three are set using absolute values.</p><p>The parameters of the three algorithms were tuned to detect as many of the real features, without allowing too many false positives. Based on known "good working" settings, we performed parameter sweeps and evaluated the number of real features and the number of other ("false") features for each setting. After initial optimisation of the other parameters, we found that for <italic>centWave </italic>and <italic>matchedFilter </italic>the <italic>snthresh </italic>parameter shows the highest influence on this ratio.</p><p>The centroidPicker from <italic>MZmine </italic>was more complex to optimise, due to its many parameters. Using settings from the authors as a starting point, a sweep was performed over a wide parameter range. Approximately 500 parameter settings were tried for <italic>MZmine</italic>, and about 50 for <italic>matchedFilter </italic>and <italic>centWave</italic>.</p><p>For the parameter optimisation we used the mixture of 14 compounds (MM14). Due to the electrospray ionisation, each compound gives rise to a number of features. A data set of known features was created using the separately measured substances. We annotated features that can be explained as adducts and fragments of the compound as well as their isotopic peaks. For all 14 compounds this results in a set of 296 features, about 21 features per compound. We observed up to eight in-source fragments per compound and also various cluster ions like [2M+H]<sup>+ </sup>oder [3M+Na]<sup>+</sup>. The annotations are available as Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>. Manual verification shows, that 122 of the 296 known features are clearly visible in the MM14 mixture, while the other 174 features are hard to detect by the human eye. The 122 verified features are considered as required features, which should be detected by the algorithms.</p><p>All other features (beyond the 296) which were reported by the programs, but cannot be explained as features originating from the marker mixture, are considered as "false" features, e.g. (usually small) signals from solvents or chemical impurities, background noise etc.</p><p>As one result from the optimisation, we found that all algorithms are able to detect more than 100 from the 122 selected real features, but only if approximately 450 "false" features are tolerated. The total number of 122 real features are detected only with settings that give more false positives (see section 3.4). Therefore, as a trade-off between real and "false" features, we chose those parameter settings which detect a maximal number of real features, but return less than 450 "false" features.</p><p>Since the algorithms detect around 200&#x02013;300 features in the separately measured blank solvent, these 450 "false" features can be explained as a "background", consisting of features originating from the solvents, tubes, vials, or impurities of the used marker compounds.</p><p>The result of the optimisation process can be seen in Table <xref ref-type="table" rid="T2">2</xref>. These parameter settings were used for the following experiments.</p><table-wrap position="float" id="T2"><label>Table 2</label><caption><p>Parameter optimisation using the MM14 marker mixture</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="left">Algorithm</td><td align="left">Number of detected MM14 features</td><td align="left">Number of other reported features</td><td align="left">Parameters</td></tr></thead><tbody><tr><td align="left">centWave</td><td align="left">115</td><td align="left">443</td><td align="left">peakwidth = (5,10), ppm = 30, snthresh = 5, prefilter = (2,400)</td></tr><tr><td align="left">matchedFilter</td><td align="left">114</td><td align="left">425</td><td align="left">fwhm = 4, snthresh = 12, step = 0.02, mzdiff = 0, max = 50</td></tr><tr><td align="left">MZmine</td><td align="left">107</td><td align="left">442</td><td align="left">bin size = 0.05, chromatographic threshold level = 0.8, intensity tolerance = 0.7, minimum peak duration = 3, minimum peak height = 500, m/z tolerance = 0.03, noise level = 20</td></tr></tbody></table><table-wrap-foot><p>Number of features detected in the MM14 marker mixture and the parameter values that were chosen after the parameter optimisation step.</p></table-wrap-foot></table-wrap></sec><sec><title>2.4 Evaluation</title><p>Since feature detection can be seen as an information retrieval task, the performance can be assessed using the <italic>precision </italic>and <italic>recall </italic>values. The recall value (also referred to as <italic>sensitivity</italic>) measures the fraction of relevant items that are found by a query, while the precision value quantifies the relation of relevant items to the false positives. Denoting the total number of features that were detected by an algorithm by <italic>N</italic>, the number of real features that were found by <italic>TP</italic>, and the total number of real features by <italic>NP</italic>, we can measure Recall = <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M13" name="1471-2105-9-504-i6" overflow="scroll"><mml:semantics><mml:mrow><mml:mfrac><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:semantics></mml:math></inline-formula> and Precision = <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M14" name="1471-2105-9-504-i7" overflow="scroll"><mml:semantics><mml:mrow><mml:mfrac><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:mfrac></mml:mrow></mml:semantics></mml:math></inline-formula> of a feature detection algorithm. A perfect feature detection algorithm will have both measures equal to 100%. False positives features lower the precision; false negatives (undetected real features) lower the recall.</p><p>For a compact representation of the results we used the <italic>F-score </italic>as a combined measure of precision and recall, which is defined as F-score = <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M15" name="1471-2105-9-504-i8" overflow="scroll"><mml:semantics><mml:mrow><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>&#x022c5;</mml:mo><mml:mi>R</mml:mi><mml:mo>&#x022c5;</mml:mo><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mo>+</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:semantics></mml:math></inline-formula>[<xref ref-type="bibr" rid="B20">20</xref>]. A perfect feature detection will achieve a F-score of 100%, and both false positives and false negatives features lower its value. The F-score can be interpreted as a measure of the overall performance of a feature detection algorithm.</p></sec></sec><sec><title>Results and discussion</title><p>We performed two experiments to assess the performance of the three algorithms. The experiments were designed to evaluate the sensitivity of the algorithms using complex biological samples at different concentrations.</p><p>First, the feature set representing the ground truth had to be created. For this purpose we used ten technical replicates of undiluted <italic>Arabidopsis thaliana </italic>seed and leaf extracts from Sample set 2 (solvent/seed/leaf): (0/100/0) and (0/0/100).</p><p>Since a manual annotation of the features was out of scope, we applied the following procedure to create a list of reliably detected features:</p><p>1. Feature detection on the 2 &#x000d7; 10 samples was performed using the three algorithms</p><p>2. We investigated the number of features which are found reproducibly in repeated measurements. The features detected in the ten technical replicates of undiluted seed and leaf extracts were separately aligned using XCMS <italic>group </italic>function (<italic>mzwid </italic>= 0.05, <italic>bw </italic>= 2). After the alignment only those features which were detected in at least seven out of the ten samples were retained. The resulting numbers of features are shown in Table <xref ref-type="table" rid="T3">3</xref>.</p><table-wrap position="float" id="T3"><label>Table 3</label><caption><p>Aligned features</p></caption><table frame="hsides" rules="groups"><thead><tr><td></td><td align="left" colspan="2">Number of aligned features</td></tr><tr><td align="left">Algorithm</td><td align="left">Seed</td><td align="left">Leaf</td></tr></thead><tbody><tr><td align="left">centWave</td><td align="left">2634</td><td align="left">2423</td></tr><tr><td align="left">matchedFilter</td><td align="left">1568</td><td align="left">1919</td></tr><tr><td align="left">MZmine</td><td align="left">2529</td><td align="left">2699</td></tr></tbody></table><table-wrap-foot><p>Number of features that have been reliably detected in at least seven out of ten technical replicates from LC/MS analyses of seed and leaf extracts (Experiment 1).</p></table-wrap-foot></table-wrap><p>3. We matched the aligned feature lists of all three algorithms (using 0.015 <italic>m/z </italic>and 5 s tolerance) and removed those features which had been found by only a single algorithm.</p><p>The resulting feature list contains 2281 features for the leaf- and 2345 features for the seed extract. 4076 features are unique, 550 features appear in both extracts. The filtering (step 2. &#x00026; 3.) retained only the reliable features both across the replicates and detected by the majority of feature detection algorithms, see Figure <xref ref-type="fig" rid="F8">8</xref>. This data set was considered as ground truth feature data and used for the further evaluation.</p><fig position="float" id="F8"><label>Figure 8</label><caption><p><bold>Venn Diagrams of Detected Features</bold>. Venn Diagrams showing the number of features in seed and leaf extracts that were found by the three different algorithms. Only the overlapping (green coloured) subsets were used as ground truth.</p></caption><graphic xlink:href="1471-2105-9-504-8"/></fig><sec><title>3.1 Experiment 1</title><p>We evaluated the F-score (calculated from recall and precision values) for dilution series of the seed extract (Sample set 2 (solvent/seed/leaf): (25/75/0), (50/50/0), (75/25/0)). Feature detection was performed on the 3 &#x000d7; 10 samples with the three algorithms using the optimised parameters. Detected features that match the seed specific ground truth features were marked als true positives, while all other returned features were considered as false positives. The results are shown in the the left-most part of Figure <xref ref-type="fig" rid="F9">9</xref>. The same was done for the leaf specific features and different concentrations of the leaf extract (Sample set 2 (solvent/seed/leaf): (25/0/75), (50/0/50), (75/0/25)). The middle part of Figure <xref ref-type="fig" rid="F9">9</xref> depicts the results. The <italic>centWave </italic>algorithm achieved up to 6% higher F-score values than <italic>MZmine </italic>and up to 14% more than <italic>matchedFilter </italic>in this experiment.</p><fig position="float" id="F9"><label>Figure 9</label><caption><p><bold>F-score values for Experiment 1 &#x00026; 2</bold>. F-score (combined measure of recall and precision, calculated from the ground truth features) for dilution series of the seed and leaf extract (left-most and middle part) and for mixtures of the seed and leaf extract (right-most part of the figure). Detected features that match the respective ground truth features were counted als true positives, while all other features returned were considered as false positives. Higher F-score values represent better feature detection performance.</p></caption><graphic xlink:href="1471-2105-9-504-9"/></fig></sec><sec><title>3.2 Experiment 2</title><p>For the second experiment we created mixtures of the seed and leaf extract at different concentrations (Sample set 3) and evaluated the F-score of the ground truth features. Again, feature detection was performed with the three algorithms. The ground truth seed and leaf specific features were considered together as true positives for this measurement. Thereby, the features which appear in both, seed and leaf extracts, were considered only once. All other features that were returned by the algorithms were considered as false positives. The right-most part of Figure <xref ref-type="fig" rid="F9">9</xref> shows the result.</p><p>The detailed F-score, recall, and precision values of both experiments are available as Additional file <xref ref-type="supplementary-material" rid="S3">3</xref>. By manual inspection of the "true" features that were detected by <italic>centWave</italic>, but not by <italic>MZmine </italic>or <italic>matchedFilter</italic>, we found that these features were often close to other &#x02013; in many cases larger &#x02013; chromatographic peaks. This can be interpreted as a masking effect caused by noise level computation on the full chromatogram. The <italic>centWave </italic>algorithm uses local baseline and noise estimation to circumvent this problem.</p><p>Looking at the false positive features, we observed that <italic>matchedFilter </italic>frequently reports spikes (very narrow chromatographic peaks, consisting of 1&#x02013;3 points) while <italic>MZmine </italic>tends to detect features in regions where only a high level noise can be seen.</p></sec><sec><title>3.3 Runtime</title><p>All three algorithms perform the feature detection for one sample in less than two minutes. <italic>centWave </italic>was the fastest algorithm in the test, with on average only one minute runtime per sample. The runtimes shown in Table <xref ref-type="table" rid="T4">4</xref> were measured as wall-clock time including all file input without other programs running. All measurements were done on an AMD Athlon 64 X2 Dual Core Processor 4200+ with 4GB RAM, running Linux (Ubuntu 6.06). Both frameworks can distribute the processing tasks, <italic>MZmine </italic>using Java RMI and XCMS using the Message Passing Interface (MPI) via Rmpi [<xref ref-type="bibr" rid="B21">21</xref>] on multicore architectures (and even cluster setups) to speed up the processing of many samples. This option was not used for the runtime measurements.</p><table-wrap position="float" id="T4"><label>Table 4</label><caption><p>Runtimes</p></caption><table frame="hsides" rules="groups"><thead><tr><td></td><td align="center">centWave</td><td align="center">matchedFilter</td><td align="center">MZmine</td></tr></thead><tbody><tr><td align="left">Runtime in minutes</td><td align="center">1.02</td><td align="center">1.85</td><td align="center">1.54</td></tr></tbody></table><table-wrap-foot><p>Average wall-clock runtime in minutes for feature detection in one sample averaged across ten samples containing a 50/50 leaf/seed extract mixture.</p></table-wrap-foot></table-wrap></sec><sec><title>3.4 Alternative parameter settings</title><p>The optimisation strategy outlined in section 2.3 tried to balance the recall and precision, using a rough estimate of the potential chemical background signals. The settings in typical metabolomics profiling experiments of e.g. plant extracts usually will be tuned more aggressively towards higher sensitivity. The resulting false positive features are often filtered by the downstream analysis, such as the alignment of replicate measurements and statistical tests for differential features.</p><p>We repeated the parameter optimisation, this time allowing up to 1000 background features. Essentially, the respective chromatographic threshold parameters were lowered, to achieve higher sensitivity. With these parameters we recreated the ground truth, and repeated both experiments. The results are depicted in Figure <xref ref-type="fig" rid="F10">10</xref>. The parameter settings and the number of features in the ground truth, as well as the detailed F-score, recall, and precision values are available as Additional file <xref ref-type="supplementary-material" rid="S4">4</xref>.</p><fig position="float" id="F10"><label>Figure 10</label><caption><p><bold>F-score values for Experiment 1 &#x00026; 2 (alternative parameter settings)</bold>. F-score (combined measure of recall and precision, calculated from the ground truth features) for dilution series of the seed and leaf extract (left-most and middle part) and for mixtures of the seed and leaf extract (right-most part of the figure). Detected features that match the respective ground truth features were counted als true positives, while all other features returned were considered as false positives. Higher F-score values represent better feature detection performance. Alternative parameter settings were used (see Additional file <xref ref-type="supplementary-material" rid="S4">4</xref>).</p></caption><graphic xlink:href="1471-2105-9-504-10"/></fig><p>With the second parameter set, we observed higher sensitivity for all algorithms. The number of aligned features almost doubled, the resulting ground truth contains 6649 unique features. The recall values of <italic>matchedFilter </italic>improved notably with the alternative parameter settings.</p><p>The results based on the second parameter set confirm the general trend shown above. The <italic>centWave </italic>algorithm achieved up to 6% and 15% higher F-score values than <italic>MZmine </italic>and <italic>matchedFilter</italic>, respectively.</p></sec></sec><sec><title>Conclusion</title><p>We presented a new feature detection algorithm for high resolution LC/MS data called <italic>centWave</italic>. With the increasing deployment of high-resolution mass spectrometers such as QTOF or Orbitrap instruments, and high-throughput applications such as metabolomics experiments of highly complex samples, a reliable and sensitive feature detection is essential. <italic>centWave </italic>shows a high sensitivity, while trying to keep the false positive features low.</p><p>In the past, the Bioconductor project has attracted more and more development related to mass spectrometry and metabolite pathways. The implementation of <italic>centWave </italic>is available in the R-package XCMS and can be obtained from <ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/release/bioc/html/xcms.html"/>. Integration with Bioconductor provides good support for the common file formats (netCDF, mzData and mzXML, with mzML currently under development) and allows for powerful downstream statistical analysis. The user feedback on the XCMS mailing list showed, that the <italic>centWave </italic>algorithm (introduced in 2007) is successfully used for LC-QTOF, LC-Orbitrap and even CE-MS or GC-MS data. For a more objective comparison we have evaluated <italic>centWave </italic>against two other open source algorithms. We performed two experiments to assess the performance of the algorithms, using complex chemical mixtures at different concentrations. The F-score, as a combined measure of recall and precision, was calculated using the ground truth data. The result was for <italic>centWave </italic>always higher than for <italic>matchedFilter </italic>and <italic>MZmine</italic>. The <italic>centWave </italic>algorithm is based on a sensitive detection of potentially interesting mass traces (ROIs), followed by an extensive chromatographic analysis, that reliably detects chromatographic peaks with different width via CWT. To allow for high sensitivity, baseline and noise are estimated locally. Some efforts are made to locate the exact chromatographic peak boundaries to provide accurate peak intensities. Feature quality can be assessed using numerous metrics, including signal to noise ratio, m/z fluctuation, and the residual of the Gaussian fit. Further development of the <italic>centWave </italic>algorithm will include an automatic estimation of the processing parameters.</p><p>In addition to <italic>centWave </italic>and the LC/MS data sets we have released the manual annotation of an LC/MS measurement of several pure compounds as a benchmark data set for both machine and software comparisons. The data sets are available at <ext-link ext-link-type="uri" xlink:href="http://msbi.ipb-halle.de/msbi/centwave/"/>.</p></sec><sec><title>Authors contributions</title><p>CB performed the LC/MS measurements and was involved in the development of the <italic>centWave</italic>. RT designed and implemented the <italic>centWave </italic>algorithm. RT and SN performed the evaluation of the algorithms. All authors contributed to, read and approved the fnal manuscript.</p></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="S1"><caption><title>Additional file 1</title><p><bold>Experimental setup</bold>. Detailed description of materials, chemicals, and protocols.</p></caption><media xlink:href="1471-2105-9-504-S1.pdf" mimetype="application" mime-subtype="pdf"><caption><p>Click here for file</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="S2"><caption><title>Additional file 2</title><p><bold>MM14 annotations</bold>. Feature annotations for the mixture of 14 compounds (MM14).</p></caption><media xlink:href="1471-2105-9-504-S2.pdf" mimetype="application" mime-subtype="pdf"><caption><p>Click here for file</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="S3"><caption><title>Additional file 3</title><p><bold>Detailed recall, precision, and F-score values</bold>. Tables containing the detailed F-score, recall, and precision values of both experiments.</p></caption><media xlink:href="1471-2105-9-504-S3.pdf" mimetype="application" mime-subtype="pdf"><caption><p>Click here for file</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="S4"><caption><title>Additional file 4</title><p><bold>Results for the alternative parameter settings</bold>. Venn diagrams of the ground truth data as well as the detailed F-score, recall, and precision values of both experiments using alternative parameter settings.</p></caption><media xlink:href="1471-2105-9-504-S4.pdf" mimetype="application" mime-subtype="pdf"><caption><p>Click here for file</p></caption></media></supplementary-material></sec></body><back><ack><sec><title>Acknowledgements</title><p>Thanks to Colin Smith, who started the Bioconductor package XCMS and to Pan Du who wrote the MassSpecWavelet package for some of the CWT code.</p></sec></ack><ref-list><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Oliver</surname><given-names>S</given-names></name><name><surname>Winson</surname><given-names>M</given-names></name><name><surname>Kell</surname><given-names>D</given-names></name><name><surname>Baganz</surname><given-names>F</given-names></name></person-group><article-title>Systematic functional analysis of the yeast genome</article-title><source>Trends Biotechnol</source><year>1998</year><volume>16</volume><fpage>373</fpage><lpage>378</lpage><pub-id pub-id-type="pmid">9744112</pub-id></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Fiehn</surname><given-names>O</given-names></name><name><surname>Kopka</surname><given-names>J</given-names></name><name><surname>D&#x000f6;rmann</surname><given-names>P</given-names></name><name><surname>Altmann</surname><given-names>T</given-names></name><name><surname>Trethewey</surname><given-names>R</given-names></name><name><surname>Willmitzer</surname><given-names>L</given-names></name></person-group><article-title>Metabolite profiling for plant functional genomics</article-title><source>Nature Biotechnology</source><year>2000</year><volume>18</volume><fpage>115</fpage></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Dunn</surname><given-names>WB</given-names></name></person-group><article-title>Current trends and future requirements for the mass spectrometric investigation of microbial, mammalian and plant metabolomes</article-title><source>Physical Biology</source><year>2008</year><volume>5</volume><fpage>24</fpage><ext-link ext-link-type="uri" xlink:href="http://stacks.iop.org/1478-3975/5/011001"/></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Roepenack-Lahaye</surname><given-names>Ev</given-names></name><name><surname>Degenkolb</surname><given-names>T</given-names></name><name><surname>Zerjeski</surname><given-names>M</given-names></name><name><surname>Franz</surname><given-names>M</given-names></name><name><surname>Roth</surname><given-names>U</given-names></name><name><surname>Wessjohann</surname><given-names>L</given-names></name><name><surname>Schmidt</surname><given-names>J</given-names></name><name><surname>Scheel</surname><given-names>D</given-names></name><name><surname>Clemens</surname><given-names>S</given-names></name></person-group><article-title>Profiling of Arabidopsis Secondary Metabolites by Capillary Liquid Chromatography Coupled to Electrospray Ionization Quadrupole Time-of-Flight Mass Spectrometry</article-title><source>Plant Physiology</source><year>2004</year><volume>134</volume><fpage>548</fpage><lpage>559</lpage><pub-id pub-id-type="pmid">14966245</pub-id></citation></ref><ref id="B5"><citation citation-type="other"><person-group person-group-type="author"><name><surname>B&#x000f6;ttcher</surname><given-names>C</given-names></name><name><surname>Roepenack-Lahaye</surname><given-names>Ev</given-names></name><name><surname>Schmidt</surname><given-names>J</given-names></name><name><surname>Schmotz</surname><given-names>C</given-names></name><name><surname>Neumann</surname><given-names>S</given-names></name><name><surname>Scheel</surname><given-names>D</given-names></name><name><surname>Clemens</surname><given-names>S</given-names></name></person-group><article-title>Metabolome Analysis of Biosynthetic Mutants Reveals Diversity of Metabolic Changes and Allows Identification of a Large Number of New Compounds in Arabidopsis thaliana</article-title><source>Plant Physiol</source><year>2008</year><fpage>108.117754</fpage><ext-link ext-link-type="uri" xlink:href="http://www.plantphysiol.org/cgi/content/abstract/pp.108.117754v1"/></citation></ref><ref id="B6"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Tikunov</surname><given-names>Y</given-names></name><name><surname>Lommen</surname><given-names>A</given-names></name><name><surname>Vos</surname><given-names>Cd</given-names></name><name><surname>Verhoeven</surname><given-names>H</given-names></name><name><surname>Bino</surname><given-names>R</given-names></name><name><surname>Hall</surname><given-names>R</given-names></name><name><surname>Bovy</surname><given-names>A</given-names></name></person-group><article-title>A novel approach for nontargeted data analysis for metabolomics. Large-scale profiling of tomato fruit volatiles</article-title><source>Plant Physiol</source><year>2005</year><volume>139</volume><fpage>1125</fpage><lpage>37</lpage><pub-id pub-id-type="pmid">16286451</pub-id></citation></ref><ref id="B7"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>C</given-names></name><name><surname>Want</surname><given-names>E</given-names></name><name><surname>O'Maille</surname><given-names>G</given-names></name><name><surname>Abagyan</surname><given-names>R</given-names></name><name><surname>Siuzdak</surname><given-names>G</given-names></name></person-group><article-title>XCMS: Processing mass spectrometry data for metabolite profiling using nonlinear peak alignment, matching and identification</article-title><source>Analytical Chemistry</source><year>2006</year><volume>78</volume><fpage>779</fpage><lpage>787</lpage><pub-id pub-id-type="pmid">16448051</pub-id></citation></ref><ref id="B8"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Katajamaa</surname><given-names>M</given-names></name><name><surname>Oresic</surname><given-names>M</given-names></name></person-group><article-title>Processing methods for differential analysis of LC/MS profile data</article-title><source>BMC Bioinformatics</source><year>2005</year><volume>6</volume><fpage>179</fpage><pub-id pub-id-type="pmid">16026613</pub-id></citation></ref><ref id="B9"><citation citation-type="other"><person-group person-group-type="author"><name><surname>Katajamaa</surname><given-names>M</given-names></name><name><surname>Oresic</surname><given-names>M</given-names></name></person-group><article-title>Data processing for mass spectrometry-based metabolomics</article-title><year>2007</year></citation></ref><ref id="B10"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Stolt</surname><given-names>R</given-names></name><name><surname>Torgrip</surname><given-names>R</given-names></name><name><surname>Lindberg</surname><given-names>J</given-names></name><name><surname>Csenki</surname><given-names>L</given-names></name><name><surname>Kolmert</surname><given-names>J</given-names></name><name><surname>Schuppe-Koistinen</surname><given-names>I</given-names></name><name><surname>Jacobsson</surname><given-names>S</given-names></name></person-group><article-title>Second-Order Peak Detection for Multicomponent High-Resolution LC/MS Data</article-title><source>Analytical Chemistry</source><year>2006</year><volume>78</volume><fpage>975</fpage><lpage>983</lpage><pub-id pub-id-type="pmid">16478086</pub-id></citation></ref><ref id="B11"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Aberg</surname><given-names>K</given-names></name><name><surname>Torgrip</surname><given-names>R</given-names></name><name><surname>Kolmert</surname><given-names>J</given-names></name><name><surname>Schuppe-Koistinen</surname><given-names>I</given-names></name><name><surname>Lindberg</surname><given-names>J</given-names></name></person-group><article-title>Feature detection and alignment of hyphenated chromatographic-mass spectrometric data Extraction of pure ion chromatograms using Kalman tracking</article-title><source>J Chromatogr A</source><year>2008</year><volume>1192</volume><fpage>139</fpage><lpage>146</lpage><pub-id pub-id-type="pmid">18378252</pub-id></citation></ref><ref id="B12"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lange</surname><given-names>E</given-names></name><name><surname>Gr&#x000f6;pl</surname><given-names>C</given-names></name><name><surname>Reinert</surname><given-names>K</given-names></name><name><surname>Kohlbacher</surname><given-names>O</given-names></name><name><surname>Hildebrandt</surname><given-names>A</given-names></name></person-group><article-title>High-accuracy peak picking of proteomics data using wavelet techniques</article-title><source>Pacific Symposium on Biocomputing Pacific Symposium on Biocomputing</source><year>2006</year><fpage>243</fpage><lpage>254</lpage><pub-id pub-id-type="pmid">17094243</pub-id></citation></ref><ref id="B13"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Du</surname><given-names>P</given-names></name><name><surname>Kibbe</surname><given-names>WA</given-names></name><name><surname>Lin</surname><given-names>SM</given-names></name></person-group><article-title>Improved peak detection in mass spectrum by incorporating continuous wavelet transform-based pattern matching</article-title><source>Bioinformatics</source><year>2006</year><volume>22</volume><fpage>2059</fpage><lpage>2065</lpage><pub-id pub-id-type="pmid">16820428</pub-id></citation></ref><ref id="B14"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Conrad</surname><given-names>TOF</given-names></name><name><surname>Leichtle</surname><given-names>A</given-names></name><name><surname>Hagehulsmann</surname><given-names>A</given-names></name><name><surname>Diederichs</surname><given-names>E</given-names></name><name><surname>Baumann</surname><given-names>S</given-names></name><name><surname>Thiery</surname><given-names>J</given-names></name><name><surname>Sch&#x000fc;tte</surname><given-names>C</given-names></name></person-group><person-group person-group-type="editor"><name><surname>Berthold MR, Glen RC, Fischer I</surname></name></person-group><article-title>Beating the Noise: New Statistical Methods for Detecting Signals in MALDI-TOF Spectra Below Noise Level</article-title><source>CompLife</source><year>2006</year><volume>4216</volume><publisher-name>Lecture Notes in Computer Science Springer</publisher-name><fpage>119</fpage><lpage>128</lpage><ext-link ext-link-type="uri" xlink:href="http://dblp.uni-trier.de/db/conf/complife/complife2006.html#ConradLHDBTS06"/></citation></ref><ref id="B15"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>McLerran</surname><given-names>DF</given-names></name><name><surname>Feng</surname><given-names>Z</given-names></name><name><surname>Semmes</surname><given-names>OJ</given-names></name><name><surname>Cazares</surname><given-names>L</given-names></name><name><surname>Randolph</surname><given-names>TW</given-names></name></person-group><article-title>Signal Detection in High-Resolution Mass Spectrometry Data</article-title><source>Journal of Proteome Research</source><year>2008</year><volume>7</volume><fpage>276</fpage><lpage>285</lpage><pub-id pub-id-type="pmid">18173224</pub-id></citation></ref><ref id="B16"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Nordstr&#x000f6;m</surname><given-names>A</given-names></name><name><surname>O'Maille</surname><given-names>G</given-names></name><name><surname>Qin</surname><given-names>C</given-names></name><name><surname>Siuzdak</surname><given-names>G</given-names></name></person-group><article-title>Nonlinear data alignment for UPLC-MS and HPLC-MS based metabolomics: quantitative analysis of endogenous and exogenous metabolites in human serum</article-title><source>Anal Chem</source><year>2006</year><volume>78</volume><fpage>3289</fpage><lpage>3295</lpage><pub-id pub-id-type="pmid">16689529</pub-id></citation></ref><ref id="B17"><citation citation-type="other"><person-group person-group-type="author"><name><surname>Danielsson</surname><given-names>R</given-names></name><name><surname>Bylund</surname><given-names>D</given-names></name><name><surname>Markides</surname><given-names>K</given-names></name></person-group><article-title>Matched filtering with background suppression for improved quality of base peak chromatograms and mass spectra in liquid chromatography &#x02013; mass spectrometry</article-title><source>Analytica Chimica Acta</source><year>2002</year><fpage>167</fpage><lpage>184</lpage></citation></ref><ref id="B18"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Andreev</surname><given-names>V</given-names></name><name><surname>Rejtar</surname><given-names>T</given-names></name><name><surname>Chen</surname><given-names>HS</given-names></name><name><surname>Moskovets</surname><given-names>E</given-names></name><name><surname>Ivanov</surname><given-names>A</given-names></name><name><surname>Karger</surname><given-names>B</given-names></name></person-group><article-title>A Universal Denoising and Peak Picking Algorithm for LC-MS Based on Matched Filtration in the Chromatographic Time Domain</article-title><source>Analytical Chemistry</source><year>2003</year><volume>75</volume><fpage>6314</fpage><lpage>6326</lpage><pub-id pub-id-type="pmid">14616016</pub-id></citation></ref><ref id="B19"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Daubechies</surname><given-names>I</given-names></name></person-group><source>Ten lectures on wavelets</source><year>1992</year><publisher-name>Philadelphia, PA, USA: Society for Industrial and Applied Mathematics</publisher-name></citation></ref><ref id="B20"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Rijsbergen</surname><given-names>CJV</given-names></name></person-group><source>Information Retrieval</source><year>1979</year><publisher-name>Newton, MA, USA: Butterworth-Heinemann</publisher-name></citation></ref><ref id="B21"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Yu</surname><given-names>H</given-names></name></person-group><article-title>Rmpi: Parallel Statistical Computing in R</article-title><source>R News</source><year>2002</year><volume>2</volume><fpage>10</fpage><lpage>14</lpage><ext-link ext-link-type="uri" xlink:href="http://CRAN.R-project.org/doc/Rnews/"/></citation></ref></ref-list></back></article>