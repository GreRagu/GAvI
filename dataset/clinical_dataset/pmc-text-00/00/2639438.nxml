<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd"><article xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id><journal-title>BMC Bioinformatics</journal-title><issn pub-type="epub">1471-2105</issn><publisher><publisher-name>BioMed Central</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">19099591</article-id><article-id pub-id-type="pmc">2639438</article-id><article-id pub-id-type="publisher-id">1471-2105-9-550</article-id><article-id pub-id-type="doi">10.1186/1471-2105-9-550</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group></article-categories><title-group><article-title>Pathological rate matrices: from primates to pathogens</article-title></title-group><contrib-group><contrib id="A1" contrib-type="author"><name><surname>Schranz</surname><given-names>Harold W</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>harold.schranz@anu.edu.au</email></contrib><contrib id="A2" contrib-type="author"><name><surname>Yap</surname><given-names>Von Bing</given-names></name><xref ref-type="aff" rid="I2">2</xref><email>stayapvb@nus.edu.sg</email></contrib><contrib id="A3" contrib-type="author"><name><surname>Easteal</surname><given-names>Simon</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>Simon.Easteal@anu.edu.au</email></contrib><contrib id="A4" contrib-type="author"><name><surname>Knight</surname><given-names>Rob</given-names></name><xref ref-type="aff" rid="I3">3</xref><email>rob@spot.colorado.edu</email></contrib><contrib id="A5" corresp="yes" contrib-type="author"><name><surname>Huttley</surname><given-names>Gavin A</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>Gavin.Huttley@anu.edu.au</email></contrib></contrib-group><aff id="I1"><label>1</label>John Curtin School of Medical Research, The Australian National University, Canberra, ACT 0200, Australia</aff><aff id="I2"><label>2</label>Department of Statistics and Applied Probability National University of Singapore, Kent Ridge, Singapore</aff><aff id="I3"><label>3</label>Department of Chemistry &#x00026; Biochemistry, University of Colorado, Boulder, CO, USA</aff><pub-date pub-type="collection"><year>2008</year></pub-date><pub-date pub-type="epub"><day>19</day><month>12</month><year>2008</year></pub-date><volume>9</volume><fpage>550</fpage><lpage>550</lpage><ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/9/550"/><history><date date-type="received"><day>30</day><month>6</month><year>2008</year></date><date date-type="accepted"><day>19</day><month>12</month><year>2008</year></date></history><permissions><copyright-statement>Copyright &#x000a9; 2008 Schranz et al; licensee BioMed Central Ltd.</copyright-statement><copyright-year>2008</copyright-year><copyright-holder>Schranz et al; licensee BioMed Central Ltd.</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0"><p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p><!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>               Schranz               W               Harold                              harold.schranz@anu.edu.au            </dc:author><dc:title>            Pathological rate matrices: from primates to pathogens         </dc:title><dc:date>2008</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 9(1): 550-. (2008)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2008)9:1&#x0003c;550&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>--></license></permissions><abstract><sec><title>Background</title><p>Continuous-time Markov models allow flexible, parametrically succinct descriptions of sequence divergence. Non-reversible forms of these models are more biologically realistic but are challenging to develop. The instantaneous rate matrices defined for these models are typically transformed into substitution probability matrices using a matrix exponentiation algorithm that employs eigendecomposition, but this algorithm has characteristic vulnerabilities that lead to significant errors when a rate matrix possesses certain 'pathological' properties. Here we tested whether pathological rate matrices exist in nature, and consider the suitability of different algorithms to their computation.</p></sec><sec><title>Results</title><p>We used concatenated protein coding gene alignments from microbial genomes, primate genomes and independent intron alignments from primate genomes. The Taylor series expansion and eigendecomposition matrix exponentiation algorithms were compared to the less widely employed, but more robust, Pad&#x000e9; with scaling and squaring algorithm for nucleotide, dinucleotide, codon and trinucleotide rate matrices. Pathological dinucleotide and trinucleotide matrices were evident in the microbial data set, affecting the eigendecomposition and Taylor algorithms respectively. Even using a conservative estimate of matrix error (occurrence of an invalid probability), both Taylor and eigendecomposition algorithms exhibited substantial error rates: ~100% of all exonic trinucleotide matrices were pathological to the Taylor algorithm while ~10% of codon positions 1 and 2 dinucleotide matrices and intronic trinucleotide matrices, and ~30% of codon matrices were pathological to eigendecomposition. The majority of Taylor algorithm errors derived from occurrence of multiple unobserved states. A small number of negative probabilities were detected from the Pad&#x000e9; algorithm on trinucleotide matrices that were attributable to machine precision. Although the Pad&#x000e9; algorithm does not facilitate caching of intermediate results, it was up to 3&#x000d7; faster than eigendecomposition on the same matrices.</p></sec><sec><title>Conclusion</title><p>Development of robust software for computing non-reversible dinucleotide, codon and higher evolutionary models requires implementation of the Pad&#x000e9; with scaling and squaring algorithm.</p></sec></abstract></article-meta></front><body><sec><title>Background</title><p>The dynamics of genetic divergence are typically modelled as a Markov process where the rates of exchange between discrete sequence states are described by rate matrices. Discrete- or continuous-time Markov processes employ different, but related, rate matrices. The former involve a substitution matrix that specifies the probabilities of substitution between sequence states in a discrete period of time (<bold>P</bold>(<italic>t</italic>), [<xref ref-type="bibr" rid="B1">1</xref>]). The continuous-time Markov process employs an instantaneous rate matrix (<bold>Q</bold>), which defines the instantaneous relative rates of interchange between sequence states from which the substitution probabilities for a specified time period are obtained by <bold>P</bold>(<italic>t</italic>) = exp(<bold>Q</bold><italic>t</italic>) where <italic>t </italic>represents time and exp is the matrix exponential. The most commonly employed rate matrices impose the restriction that evolutionary processes are time-reversible (e.g. [<xref ref-type="bibr" rid="B1">1</xref>]). The inaccuracy of this restriction is shown by the specificity of particular mutagens and repair enzymes [<xref ref-type="bibr" rid="B2">2</xref>], and by the apparent directionality of amelioration of horizontally transferred genes to the background genome composition [<xref ref-type="bibr" rid="B3">3</xref>].</p><p>Relaxing the assumption of time-reversibility requires consideration of non-reversible matrices. Assessments of time-reversibility, which have largely been restricted to nucleotide rate matrices, show that non-reversible models can provide better estimation of important evolutionary parameters including rates of evolution and, when employed with the maximum-likelihood phylogenetic inference framework, phylogenetic tree support [<xref ref-type="bibr" rid="B4">4</xref>]. The development of approaches to identifying both biologically accurate and parametrically succinct models is therefore of considerable interest. Non-reversible forms of codon substitution models would allow, for instance, consideration of temporal changes in mutation pressure on natural selection. However, limitations of matrix exponentiation algorithms have been cited as motivation for continued development of reversible models (for example, [<xref ref-type="bibr" rid="B5">5</xref>]). Exploration of statistically efficient (parametrically reduced) forms might be most readily achieved using continuous time processes, but the accuracy of these approaches hinges on the properties of exponentiation of matrices from real biological data.</p><p>The most obvious method for computing a matrix exponential is the generalisation of the Taylor series expansion of a scalar exponential [<xref ref-type="bibr" rid="B6">6</xref>]. Instead of a series of scalar terms, the matrix exponential is expressed as a Taylor series over terms involving matrix products. The series is truncated at a sufficiently large finite number of terms (<italic>M</italic>).</p><p><disp-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" name="1471-2105-9-550-i1" overflow="scroll"><mml:semantics><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>exp</mml:mi><mml:mo>&#x02061;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Q</mml:mi></mml:mstyle><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>I</mml:mi></mml:mstyle><mml:mo>+</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Q</mml:mi></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Q</mml:mi></mml:mstyle><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Q</mml:mi></mml:mstyle><mml:mn>3</mml:mn></mml:msup><mml:msup><mml:mi>t</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mo>&#x02026;</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>&#x02248;</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Q</mml:mi></mml:mstyle><mml:mi>i</mml:mi></mml:msup><mml:msup><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>Convergence of the series expansion depends on the magnitude of the matrix norm ||<bold>Q</bold>|| (a measure of the size of the elements in <bold>Q</bold>, see Methods equation 1) [<xref ref-type="bibr" rid="B7">7</xref>]. An important property of the Taylor series is a reduced rate of convergence for matrices with large ||<bold>Q</bold>|| such that achieving a required accuracy involves increasingly larger <italic>M</italic>. A further problem is that the impact of roundoff error increases with term order so the method becomes impractical and inaccurate for matrices with large ||<bold>Q</bold>||. Although some efficiency improvements can be made to reduce the number of matrix products required [<xref ref-type="bibr" rid="B7">7</xref>], the essential defect remains. Accordingly, the Taylor series expansion performs worst on potentially the most biologically relevant matrices and thus sets a lower bound on both accuracy and computational performance. We will subsequently refer to the Taylor series matrices exponentiation algorithm as exp<sub>TAYL</sub>.</p><p>Several other algorithms compute the matrix exponential, but differ substantially in their computational behaviour, performance, and vulnerability to so called pathological matrices. For the purposes of this paper, we define a pathological matrix as one that results in a substantial discrepancy between the 'true' value of <bold>P </bold>and the value computed as exp(<bold>Q</bold><italic>t</italic>) by a given algorithm. It is important to note that a matrix property responsible for a discrepancy affecting one particular algorithm may not necessarily affect another algorithm to the same extent.</p><p>Of the collection of algorithms, that proposed as most robust (described below) is seldom adopted in the field of molecular evolution: instead, the method of matrix exponentiation by eigendecomposition is most widely used by existing software packages but is far less robust [<xref ref-type="bibr" rid="B6">6</xref>]. This latter algorithm is based on a matrix decomposition approach involving similarity transformations of the form <bold>Q </bold>= <bold>SBS</bold><sup>-1 </sup>so that</p><p><disp-formula>exp(<bold>Q</bold>) = <bold>S </bold>exp(<bold>B</bold>)<bold>S</bold><sup>-1</sup></disp-formula></p><p>where the aim is to find an <bold>S </bold>for which exp(<bold>B</bold>) is easy to compute. In the case of eigendecomposition, if <bold>Q </bold>= <bold>UDU</bold><sup>-1 </sup>where <bold>U </bold>are the eigenvectors, <bold>D </bold>is a diagonal matrix containing the eigenvalues of <bold>Q </bold>and <bold>P</bold>(<italic>t</italic>) the matrix of substitution probabilities for time <italic>t</italic>, then</p><p><disp-formula><bold>P</bold>(<italic>t</italic>) = <bold>U </bold>exp(<bold>D</bold><italic>t</italic>)<bold>U</bold><sup>-1</sup>.</disp-formula></p><p>The eigendecomposition approach has an important practical advantage for molecular evolutionary applications &#x02013; the spectral theorem allows the calculation of arbitrary many values of exp(<bold>Q</bold><italic>t</italic>) from a single decomposition [<xref ref-type="bibr" rid="B7">7</xref>]. For a phylogenetic model that assumes a single (global) <bold>Q </bold>across the entire tree, for instance, this property means the decomposition need be performed only once per model evaluation. The <italic>O</italic>(<italic>n</italic><sup>3</sup>) complexity of the decomposition is thus outweighed by its suitability for caching intermediate results. Eigendecomposition works well for normal matrices (where a normal matrix is defined as one that commutes with its conjugate transpose [<xref ref-type="bibr" rid="B7">7</xref>]) but breaks down when <bold>Q </bold>does not have a complete set of linearly independent eigenvectors (an invertible <bold>U </bold>does not exist) or when <bold>U </bold>is close to singular, i.e. when the condition number of the matrix of eigenvectors cond(<bold>U</bold>) = cond<sub>EV</sub>(<bold>Q</bold>) is large. (We illustrate the analytical conditions under which the eigendecomposition approach can fail with an example in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>.) We will subsequently refer to the eigendecomposition matrix exponentiation algorithm as exp<sub>EIG</sub>.</p><p>The algorithm advocated by Moler and van Loan [<xref ref-type="bibr" rid="B6">6</xref>] computes the matrix exponential using the Pad&#x000e9; approximation in combination with scaling and squaring [<xref ref-type="bibr" rid="B8">8</xref>]. Pad&#x000e9; approximants converge if the matrix norm ||<bold>Q</bold>|| is not too large. Thus, the idea is to reduce the matrix norm by scaling the matrix and then use Pad&#x000e9; approximation (a ratio of series) to compute the scaled matrix exponential and then the full matrix exponential by squaring operations. The scaling and squaring operation reduces the norm of the matrix ||<bold>Q</bold>|| to that of a matrix ||<bold>Q</bold><italic>'</italic>||</p><p><disp-formula><bold>P</bold>(<italic>t</italic>) = [exp(<bold>Q</bold><italic>t</italic>/<italic>m</italic>)]<sup><italic>m </italic></sup>= [exp(<bold>Q</bold><italic>'t</italic>)]<sup><italic>m</italic></sup></disp-formula></p><p>The Pad&#x000e9; approximation is a ratio of series where, typically, the series (denoted <italic>p </italic>and <italic>q</italic>) are constrained to be equal as diagonal Pad&#x000e9; approximants are preferred for numerical efficiency [<xref ref-type="bibr" rid="B6">6</xref>]. The Pad&#x000e9; approximation with scaling and squaring is then</p><p><disp-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2" name="1471-2105-9-550-i2" overflow="scroll"><mml:semantics><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>exp</mml:mi><mml:mo>&#x02061;</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:msup><mml:mi>Q</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:msubsup><mml:mrow><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mi>q</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>!</mml:mo><mml:mi>p</mml:mi><mml:mo>!</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>!</mml:mo><mml:mi>j</mml:mi><mml:mo>!</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:msup><mml:mi>Q</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mstyle><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msup></mml:mrow></mml:mstyle></mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>q</mml:mi></mml:msubsup><mml:mrow><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mi>q</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>!</mml:mo><mml:mi>q</mml:mi><mml:mo>!</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>!</mml:mo><mml:mi>j</mml:mi><mml:mo>!</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:msup><mml:mi>Q</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mstyle><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msup></mml:mrow></mml:mstyle></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>m</mml:mi></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>The diagonal Pad&#x000e9; method with scaling and squaring requires of the order of <italic>O</italic>((<italic>q </italic>+ <italic>m </italic>+ 1/3)<italic>n</italic><sup>3</sup>) operations but is, in general, more efficient than the Taylor series. To compute single values of exp(<bold>Q</bold><italic>t</italic>) therefore also takes of the order of <italic>O</italic>(<italic>n</italic><sup>3</sup>) operations, but does not have intermediate results that can be cached. Thus, each tree branch (and unique value of <italic>t</italic>) requires an independent exp(<bold>Q</bold><italic>t</italic>). The robust computational performance of Pad&#x000e9; therefore comes at the cost of requiring an independent exp(<bold>Q</bold><italic>t</italic>) computation for each value of <italic>t</italic>. We will subsequently refer to the diagonal Pad&#x000e9; with scaling and squaring matrix exponentiation algorithm as exp<sub>PAD&#x000c9; </sub>.</p><p>Given the evidence that the algorithms commonly employed by molecular evolutionary software can significantly err in their computation of the exponential [<xref ref-type="bibr" rid="B6">6</xref>], a survey of whether matrices pathological to these algorithms exist in nature is essential for the development of biologically realistic models of sequence evolution that are computationally robust. Here we report the results of a survey for matrices pathological to the exp algorithms in both protein coding and non-protein coding sequences from lineages as diverse as microbes and primates.</p></sec><sec><title>Results</title><p><bold>P </bold>matrices were derived from species triads composed of two ingroups and an outgroup. Knowledge of the outgroup allows determination of the sequence states ancestral to the ingroup lineages, thereby enabling a simple counting procedure for generating the <bold>P </bold>matrices (described in the Methods). The outgroup further allows the resulting matrices to be non-reversible. For the current comparisons we arbitrarily set the time <italic>t </italic>to 1.</p><p>For each <bold>P</bold>, the corresponding <bold>Q </bold>was estimated using a constrained optimisation procedure. While the relationship between <bold>P </bold>and <bold>Q </bold>suggested using the matrix logarithm to estimate <bold>Q</bold>, doing so resulted in nearly all dinucleotide and higher matrices having negative off-diagonal elements. In preliminary analyses, we determined that this property arose from sampling error (results not shown). Importantly, because matrices with negative off-diagonals cannot be readily interpreted we developed a constrained optimisation procedure for estimation of <bold>Q </bold>from <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M3" name="1471-2105-9-550-i3" overflow="scroll"><mml:semantics><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle></mml:semantics></mml:math></inline-formula>. This procedure, which we describe in more detail in the Methods, used a numerical optimisation algorithm to minimise the value of ||<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M4" name="1471-2105-9-550-i3" overflow="scroll"><mml:semantics><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle></mml:semantics></mml:math></inline-formula>- exp(<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M5" name="1471-2105-9-550-i4" overflow="scroll"><mml:semantics><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>Q</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle></mml:semantics></mml:math></inline-formula>)|| subject to the constraint <italic>q</italic><sub><italic>ij</italic>, <italic>i </italic>&#x02260; <italic>j </italic></sub>&#x02265; 0. By default, this procedure employed the exp<sub>PAD&#x000c9; </sub>algorithm, resulting in a bias towards this algorithm which we address in detail later. We note here that as the results were not substantively different when we used the matrix logarithm for estimating <bold>Q </bold>and the constrained optimisation approach produces matrices more likely to be representative of naturally occurring rate matrices, we only report results from the latter procedure.</p><p>To measure the magnitude of a matrix we employ the Frobenius norm [<xref ref-type="bibr" rid="B6">6</xref>], the square root of the sum of the absolute squared elements of a matrix (see Methods equation 1). The matrix norm is also used as a measurement of the error, or discrepancy, between <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M6" name="1471-2105-9-550-i3" overflow="scroll"><mml:semantics><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle></mml:semantics></mml:math></inline-formula> and the results of exp<sub>TAYL</sub>, exp<sub>EIG </sub>and exp<sub>PAD&#x000c9; </sub>algorithms and we denote these error statistics as &#x003f5;<sub><italic>TAYL</italic></sub>, &#x003f5;<sub><italic>EIG </italic></sub>and &#x003f5;<sub><italic>PAD&#x000c9; </italic></sub>(see Methods equations 2&#x02013;4). The additional matrix property of eigenvector matrix condition number, the product of the spectral matrix norms of the eigenvector matrix and inverted eigenvector matrix of <bold>Q </bold>(Methods equation 5), is also used as it indicates the suitability for digital computation of a matrix for eigendecomposition [<xref ref-type="bibr" rid="B9">9</xref>-<xref ref-type="bibr" rid="B11">11</xref>]. Finally, because the elements of <bold>P </bold>are probabilities, we also defined a matrix as pathological to an algorithm if it contained an invalid probability value (&#x0003c; 0, &#x0003e; 1).</p><sec><title>Pathological matrices in microbes</title><p>Orthologous protein coding gene sequences were sampled from all species triples in KEGG where neighbours were 0&#x02013;2% distant by 16 S rRNA and outgroups were 2&#x02013;10% divergent. This procedure resulted in 136 valid species triples. Given the large number of genes, and that preliminary work indicated estimating a single trinucleotide <bold>Q </bold>required nearly 1 day, we concatenated all alignments from a triad and estimated separate <bold>Q </bold>matrices for each ingroup lineage from these concatenated alignments. As described in the Methods, aligned codon columns with non-nucleotide characters (such as indels or ambiguous bases) were deleted. Nucleotide and trinucleotide samples were obtained from the unmodified resulting alignments. Two distinct dinucleotide samples were considered. The patterns of mutation are typically distinct between the three different codon positions due to their differing influence of variation in the encoded amino acid sequence. We therefore consider dinucleotides sampled from both the first and second or second and third codon positions. We refer to these as the dinucleotide 1+2 or 2+3 matrices respectively. The minimum, median and maximum filtered, concatenated alignment lengths were ~31 Kbp, ~1.5 Mbp and ~3.7 Mbp respectively.</p><p>Measures of exponentiation error for nucleotide matrices were low across all algorithms (Table <xref ref-type="table" rid="T1">1</xref>). There were no exponentiation failures by any algorithm for the nucleotide matrices. A small fraction (&#x0003c; 1%) of exp<sub>EIG </sub>failed, however, for the dinucleotide matrices derived from codon positions 1+2 or 2+3, with one significant failure resulting from a large number of zero elements that lead to a singular eigenvector matrix, and four failures where the maximum element size resulted in an invalid probability. Almost all <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M7" name="1471-2105-9-550-i5" overflow="scroll"><mml:semantics><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mn>255</mml:mn></mml:mrow><mml:mrow><mml:mn>257</mml:mn></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:semantics></mml:math></inline-formula> the trinucleotide matrices were pathological to exp<sub>TAYL</sub>, but none of these matrices were pathological to either the exp<sub>EIG </sub>or exp<sub>PAD&#x000c9; </sub>algorithms. The other descriptive statistics increased with the dimension of the matrices: matrix norm and eigenvector matrix condition numbers systematically increased from the nucleotide to trinucleotide matrices. The distinct dinucleotide positions were predominantly consistent with each other, with median matrix statistics and error values of similar order.</p><table-wrap position="float" id="T1"><label>Table 1</label><caption><p>Exponentiation of matrices from microbes.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="right"><bold>Data</bold></td><td align="right"><bold>Norm<sup>1</sup></bold></td><td align="right"><bold>Cond<sup>1</sup></bold></td><td align="right"><bold>&#x003f5;<sub>TAYL</sub><sup>1</sup></bold></td><td align="right"><bold>&#x003f5;<sub>EIG</sub><sup>1</sup></bold></td><td align="right"><bold>&#x003f5;<sub>PAD&#x000c9;</sub><sup>1</sup></bold></td><td align="right"><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M8" name="1471-2105-9-550-i6" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>E</mml:mi></mml:mstyle><mml:mrow><mml:mi>T</mml:mi><mml:mi>A</mml:mi><mml:mi>Y</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula></td><td align="right"><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M9" name="1471-2105-9-550-i7" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>E</mml:mi></mml:mstyle><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>E</mml:mi><mml:mi>I</mml:mi><mml:mi>G</mml:mi></mml:mstyle></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula></td><td align="right"><bold>N<sup>3</sup></bold></td></tr></thead><tbody><tr><td align="right">Nuc</td><td align="right">(0.062, 0.59)</td><td align="right">(1.4, 4.6)</td><td align="right">(7.1e-06, 2e-05)</td><td align="right">(7.1e-06, 2e-05)</td><td align="right">(7.1e-06, 2e-05)</td><td align="right">0</td><td align="right">0</td><td align="right">272</td></tr><tr><td align="right">Dinuc 1+2</td><td align="right">(0.082, 1.9)</td><td align="right">(4.7, inf)</td><td align="right">(0.00012, 0.0032)</td><td align="right">(0.00012, inf)</td><td align="right">(0.00012, 0.0032)</td><td align="right">0</td><td align="right">3</td><td align="right">272</td></tr><tr><td align="right">Dinuc 2+3</td><td align="right">(0.19, 3.1)</td><td align="right">(3, 1e+02)</td><td align="right">(0.00015, 0.0079)</td><td align="right">(0.00015, 0.0079)</td><td align="right">(0.00015, 0.0079)</td><td align="right">0</td><td align="right">1</td><td align="right">272</td></tr><tr><td align="right">Trinuc</td><td align="right">(3.2e+02, 4.4e+02)</td><td align="right">(19, 3.5e+02)</td><td align="right">(3.7e+84, 1.5e+136)</td><td align="right">(0.22, 0.23)</td><td align="right">(0.22, 0.23)</td><td align="right">256</td><td align="right">0</td><td align="right">257</td></tr></tbody></table><table-wrap-foot><p><sup>1 </sup>&#x02013; median and maximum values; <sup>2 </sup>&#x02013; Number of <bold>P </bold>matrices for the indicated algorithm with an invalid probability; <sup>3 </sup>&#x02013; total number of matrices; inf &#x02013; an infinite difference, typically arising from an exponentiation error.</p></table-wrap-foot></table-wrap></sec><sec><title>Pathological matrices in primates</title><p>Intronic alignments were sampled from Ensembl release 46 for 3 primate lineages &#x02013; human, chimpanzee and macaque &#x02013; where the outgroup status of macaque relative to the great apes is well established [<xref ref-type="bibr" rid="B12">12</xref>]. Intronic sequences were sampled due to increased confidence in their orthology arising from the relationships between exonic sequences. Sequences unlikely to evolve by a point mutation process (such as simple repeat sequence) were masked and all alignment columns containing non-nucleotide characters were removed (see Methods). There were a total of 1079 alignments with minimum, median and maximum filtered alignment lengths of ~30 Kbp, ~59 Kbp and ~438 Kbp respectively.</p><p>As for the microbial exonic sequences, no nucleotide matrices pathological to any of the algorithms were evident (Table <xref ref-type="table" rid="T2">2</xref>). The results from dinucleotide matrices 1+2 and 2+3 were similar &#x02013; low errors across all algorithms and no matrices pathological to any algorithm. This result is distinct from that evident from the microbial exonic data. Also different to the microbial data were an appreciable frequency (~10%) of trinucleotide matrices pathological to exp<sub>EIG </sub>while no matrices were pathological to exp<sub>TAYL</sub>. A moderate number of matrices were also pathological to exp<sub>PAD&#x000c9;</sub>, but inspection of these revealed a maximum negative element size of -1.2e-33, indicating these as likely deriving from rounding errors. Also consistent with the results from the microbial analyses, the eigenvector matrix condition numbers increased from the nucleotide to trinucleotide matrices (see Figure <xref ref-type="fig" rid="F1">1</xref>).</p><table-wrap position="float" id="T2"><label>Table 2</label><caption><p>Exponentiation of matrices from primate intron sequences.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="right"><bold>Data</bold></td><td align="right"><bold>Norm<sup>1</sup></bold></td><td align="right"><bold>Cond<sup>1</sup></bold></td><td align="right"><bold>&#x003f5;<sub>TAYL</sub><sup>1</sup></bold></td><td align="right"><bold>&#x003f5;<sub>EIG</sub><sup>1</sup></bold></td><td align="right"><bold>&#x003f5;<sub>PAD&#x000c9;</sub><sup>1</sup></bold></td><td align="right"><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M10" name="1471-2105-9-550-i6" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>E</mml:mi></mml:mstyle><mml:mrow><mml:mi>T</mml:mi><mml:mi>A</mml:mi><mml:mi>Y</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula></td><td align="right"><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M11" name="1471-2105-9-550-i7" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>E</mml:mi></mml:mstyle><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>E</mml:mi><mml:mi>I</mml:mi><mml:mi>G</mml:mi></mml:mstyle></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula></td><td align="right"><bold>N<sup>3</sup></bold></td></tr></thead><tbody><tr><td align="right">Nuc</td><td align="right">(0.015, 0.047)</td><td align="right">(1.5, 56)</td><td align="right">(6.8e-06, 1.7e-05)</td><td align="right">(6.8e-06, 1.7e-05)</td><td align="right">(6.8e-06, 1.7e-05)</td><td align="right">0</td><td align="right">0</td><td align="right">2158</td></tr><tr><td align="right">Dinuc 1+2</td><td align="right">(0.074, 0.21)</td><td align="right">(10, 3.3e+02)</td><td align="right">(0.00016, 0.00058)</td><td align="right">(0.00016, 0.00058)</td><td align="right">(0.00016, 0.00058)</td><td align="right">0</td><td align="right">0</td><td align="right">2158</td></tr><tr><td align="right">Dinuc 2+3</td><td align="right">(0.074, 0.2)</td><td align="right">(11, 1.2e+03)</td><td align="right">(0.00016, 0.00085)</td><td align="right">(0.00016, 0.00085)</td><td align="right">(0.00016, 0.00085)</td><td align="right">0</td><td align="right">0</td><td align="right">2158</td></tr><tr><td align="right">Trinuc</td><td align="right">(0.24, 0.95)</td><td align="right">(1.8e+02, 1.1e+07)</td><td align="right">(0.001, 0.017)</td><td align="right">(0.001, 7.5)</td><td align="right">(0.001, 0.017)</td><td align="right">0</td><td align="right">188</td><td align="right">2080</td></tr></tbody></table><table-wrap-foot><p><sup>1 </sup>&#x02013; median and maximum values; <sup>2 </sup>&#x02013; Number of <bold>P </bold>matrices for the indicated algorithm with an invalid probability; <sup>3 </sup>&#x02013; total number of matrices.</p></table-wrap-foot></table-wrap><fig position="float" id="F1"><label>Figure 1</label><caption><p><bold>Eigenvector matrix condition number increases with the dimension of the substitution model</bold>. Data are from primate introns.</p></caption><graphic xlink:href="1471-2105-9-550-1"/></fig><p>Motivated by the differing frequency of pathological matrices between microbial exonic and primate intronic data, we sampled a collection of primate protein coding gene exons. Specifically, we used exonic sequence from a subset of the genes from which the introns were obtained. Given the restriction of pathological matrices to dinucleotide or higher alphabets, and high computational demands of fitting trinucleotide models, we sampled 1028 CDS alignments and combined these into 103 concatenated (10 loci each) alignments (see Methods). The minimum, median and maximum filtered, concatenated alignment lengths were ~12 Kbp, ~24 Kbp and ~40 Kbp respectively.</p><p>The matrix properties for these data, shown in Table <xref ref-type="table" rid="T3">3</xref>, showed more consistency with those of the microbial exonic data than primate intronic data. As observed in the microbial analyses, an appreciable frequency (~8%) of dinucleotide matrices from codon positions 1+2 were pathological to exp<sub>EIG </sub>but not to exp<sub>TAYL</sub>. A smaller proportion (~1%) of matrices from codon positions 2+3 were pathological to exp<sub>EIG</sub>. Also consistent with the microbial exon analysis results, all trinucleotide matrices were pathological to exp<sub>TAYL</sub>. These results establish that the frequency of matrices pathological to exp<sub>TAYL </sub>and exp<sub>EIG </sub>depends on the class of sequence being sampled.</p><table-wrap position="float" id="T3"><label>Table 3</label><caption><p>Exponentiation of matrices from primate protein coding exons.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="right"><bold>Data</bold></td><td align="right"><bold>Norm<sup>1</sup></bold></td><td align="right"><bold>Cond<sup>1</sup></bold></td><td align="right"><bold>&#x003f5;<sub>TAYL</sub><sup>1</sup></bold></td><td align="right"><bold>&#x003f5;<sub>EIG</sub><sup>1</sup></bold></td><td align="right"><bold>&#x003f5;<sub>PAD&#x000c9;</sub><sup>1</sup></bold></td><td align="right"><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M12" name="1471-2105-9-550-i6" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>E</mml:mi></mml:mstyle><mml:mrow><mml:mi>T</mml:mi><mml:mi>A</mml:mi><mml:mi>Y</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula></td><td align="right"><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M13" name="1471-2105-9-550-i7" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>E</mml:mi></mml:mstyle><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>E</mml:mi><mml:mi>I</mml:mi><mml:mi>G</mml:mi></mml:mstyle></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula></td><td align="right"><bold>N<sup>3</sup></bold></td></tr></thead><tbody><tr><td align="right">Dinuc 1+2</td><td align="right">(0.021, 0.16)</td><td align="right">(42, 1.4e+04)</td><td align="right">(3.1e-05, 0.00044)</td><td align="right">(3.1e-05, 0.00044)</td><td align="right">(3.1e-05, 0.00044)</td><td align="right">0</td><td align="right">17</td><td align="right">206</td></tr><tr><td align="right">Dinuc 2+3</td><td align="right">(0.051, 0.18)</td><td align="right">(23, 1.1e+04)</td><td align="right">(7.1e-05, 0.00041)</td><td align="right">(7.1e-05, 0.00041)</td><td align="right">(7.1e-05, 0.00041)</td><td align="right">0</td><td align="right">3</td><td align="right">206</td></tr><tr><td align="right">Trinuc</td><td align="right">(2.7e+02, 3.4e+02)</td><td align="right">(2.9e+02, 2.3e+04)</td><td align="right">(6.4e+65, 3.6e+89)</td><td align="right">(0.22, 0.22)</td><td align="right">(0.22, 0.22)</td><td align="right">206</td><td align="right">0</td><td align="right">206</td></tr><tr><td align="right">Codon</td><td align="right">(0.15, 0.42)</td><td align="right">(4.7e+02, inf)</td><td align="right">(0.00049, 0.0029)</td><td align="right">(0.0005, 0.087)</td><td align="right">(0.00049, 0.0029)</td><td align="right">0</td><td align="right">62</td><td align="right">206</td></tr></tbody></table><table-wrap-foot><p><sup>1 </sup>&#x02013; median and maximum values; <sup>2 </sup>&#x02013; Number of <bold>P </bold>matrices for the indicated algorithm with an invalid probability; <sup>3 </sup>&#x02013; total number of matrices.</p></table-wrap-foot></table-wrap><p>An important difference between the trinucleotide matrices from the intronic and exonic sequences is the presence of the trinucleotides encoding stop codons. We assessed whether inclusion of these states, which are absent from the in frame exons, contributed to the exponentiation errors by excluding unobserved states from the trinucleotide count matrices. This therefore generates 61 &#x000d7; 61 matrices, as employed by codon substitution models. As shown in the last row of Table <xref ref-type="table" rid="T3">3</xref>, with the removal of unobserved states the errors from exp<sub>TAYL </sub>were completely eliminated. We further confirmed that the presence of unobserved states was responsible for the exp<sub>TAYL </sub>failures by taking a dinucleotide counts matrix and selecting two states to be missing (setting the corresponding row/column counts to all zeros). Exponentiation of this constructed matrix also proved pathological to exp<sub>TAYL</sub>. Interestingly, the frequency of errors from exp<sub>EIG </sub>was significantly increased with ~30% of codon matrices proving pathological (Table <xref ref-type="table" rid="T3">3</xref>).</p></sec></sec><sec><title>Discussion</title><p>Our analyses confirm the numerical qualities of the three matrix exponentiation algorithms are distinct and that matrices pathological to both exp<sub>EIG </sub>and exp<sub>TAYL </sub>exist in nature. The magnitude of errors ranged from the subtle, <bold>P </bold>had probabilities close to but outside the interval 0&#x02013;1, to extreme cases of algorithmic failure or extremely large elements. The range of these errors, and the data-type dependent frequency of matrices pathological to an algorithm indicate that exp<sub>TAYL </sub>and exp<sub>EIG </sub>are ill-suited to evaluation of non-reversible evolutionary models or to data where more than one sequence state is not observed.</p><p>An important impact of our study design is a bias towards exp<sub>PAD&#x000c9; </sub>which we now partly redress. This bias was inevitable because estimates of <bold>Q </bold>had to be obtained from estimates of <bold>P </bold>and the prohibitive computational time required for estimation of trinucleotide <bold>Q </bold>necessitated a choice of a single exp algorithm. For the microbial lineages in particular, fitting a single trinucleotide <bold>Q </bold>frequently took ~1 day. We therefore elected to fit the trinucleotide matrices using the exp<sub>PAD&#x000c9; </sub>since it was supported as most robust [<xref ref-type="bibr" rid="B6">6</xref>]. Nonetheless, we considered the bias introduced by estimating <bold>Q </bold>using one algorithm and computing exp(<bold>Q</bold>) with another. The dinucleotide model failures of exp<sub>EIG </sub>provided an opportunity to efficiently (with regards to compute time) assess whether constrained optimisation of <bold>Q </bold>using exp<sub>EIG</sub>, instead of exp<sub>PAD&#x000c9;</sub>, might eliminate the matrices pathological to exp<sub>EIG</sub>. We therefore modified the constrained fitting of <bold>Q </bold>to use exp<sub>EIG </sub>instead of exp<sub>PAD&#x000c9;</sub>, and applied the algorithm to the primate dinucleotide matrices derived from codon positions 1+2 of the concatenated protein coding sequences and exponentiated the resulting <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M14" name="1471-2105-9-550-i4" overflow="scroll"><mml:semantics><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>Q</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle></mml:semantics></mml:math></inline-formula> also using exp<sub>EIG</sub>. From the resulting matrices there was 1 failure during optimisation and 6 matrices remained pathological to exp<sub>EIG </sub>after this procedure. This number is smaller than the 17 failures (Table <xref ref-type="table" rid="T3">3</xref>) for exp<sub>EIG </sub>when applied to <bold>Q </bold>estimated using exp<sub>PAD&#x000c9; </sub>. These results indicate that although using a different algorithm for estimating <bold>Q </bold>introduces some bias, exp<sub>EIG </sub>still fails at an appreciable frequency. We note that for the <bold>Q </bold>matrices estimated using exp<sub>EIG</sub>, neither exp<sub>PAD&#x000c9; </sub>nor exp<sub>TAYL </sub>exhibited high &#x003f5;. However, the exp<sub>PAD&#x000c9; </sub>of <bold>Q </bold>estimated by exp<sub>EIG </sub>returned invalid probabilities from <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M15" name="1471-2105-9-550-i8" overflow="scroll"><mml:semantics><mml:mrow><mml:mfrac><mml:mrow><mml:mn>21</mml:mn></mml:mrow><mml:mrow><mml:mn>4701</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:semantics></mml:math></inline-formula> of the matrices examined in this study (all matrices considered in Tables <xref ref-type="table" rid="T1">1</xref>, <xref ref-type="table" rid="T2">2</xref>, <xref ref-type="table" rid="T3">3</xref> and those estimated using exp<sub>EIG</sub>). These failures were all extremely small negative values, the largest absolute value being ~10<sup>-34</sup>, likely reflecting rounding errors and thus their infrequent occurrence and extremely small size support the robustness of exp<sub>PAD&#x000c9; </sub>.</p><p>The failure on both sequence classes of the eigendecomposition algorithm can originate from properties of the eigenvectors and/or eigenvalues. If the eigenvector matrix of a given <bold>Q </bold>is near-singular, then spectral expansion of the matrix exponential exp<sub>EIG</sub>(<bold>Q</bold>) is ill-defined. The eigenvalues influence on the computations occurs when a <bold>Q </bold>has very many almost degenerate (in the examples in the present study, near zero) elements. In these cases, though the numerically determined eigenvector matrix has an inverse, the set of numerically determined eigenvalues and eigenvectors do not accurately satisfy the eigenvalue equation [<xref ref-type="bibr" rid="B13">13</xref>] that can lead to failure of the spectral representation of the matrix exponential exp<sub>EIG </sub>of <bold>Q</bold>.</p><p>There appears to be a connection between these two types of failures: matrices with ill-conditioned eigenvector matrices lie close to ones with multiple eigenvalues [<xref ref-type="bibr" rid="B14">14</xref>]. Thus, the eigendecomposition can fail (or become inaccurate) due to ill-conditioning of the eigenvectors (becoming parallel) or of the eigenvalues (many degenerate near zero values) or both [<xref ref-type="bibr" rid="B13">13</xref>,<xref ref-type="bibr" rid="B15">15</xref>].</p><p>The influence of sequence type on the frequency of pathological matrices originated in part from absence of some sequence states and potentially also from the reduced divergence of protein-coding DNA sequences. The exp<sub>TAYL </sub>algorithm exhibited the most striking difference between exonic and intronic sequences. As demonstrated by our artificial dinucleotide example, where we set multiple states to being unobserved, these failures arose from multiple unobserved sequence exchanges. The exp<sub>TAYL </sub>algorithm should therefore not be used on data sets where this may arise. The exp<sub>EIG </sub>algorithm also exhibited a difference in failure rates between the two sequence classes &#x02013; ~10% trinucleotide matrices on intronic data, ~5% dinucleotide matrices and ~30% codon matrices on primate exonic data. Combined with the difference in error rates of dinucleotide matrices for positions 1+2 and 2+3 on exonic data, these results suggest that the ultimate biological cause of these failures is the suppressing influence of natural selection on substitution rates. Of the three codon positions, positions 1+2 are subjected to greater scrutiny by natural selection than positions 2+3. The result is that many of the dinucleotides exhibit similarly reduced substitutions in a matrix such that some of the eigenvectors may be almost parallel, resulting in a near-singular matrix. The fact that there is little difference in the matrix norm statistics between dinucleotide 1+2 and 2+3, yet the maximum eigenvector matrix condition numbers exhibit a similar order of magnitude to that observed for the trinucleotide cases (Tables <xref ref-type="table" rid="T1">1</xref> and <xref ref-type="table" rid="T3">3</xref>), is consistent with this hypothesis [<xref ref-type="bibr" rid="B16">16</xref>]. The absence of such errors from the primate intron dinucleotide matrices (Table <xref ref-type="table" rid="T2">2</xref>) follows, because the putative absence of selective constraint on intronic sequence would allow greater differentiation between the dinucleotide substitutions and thus result in matrices that were not close to singular. This argument also applies to the increased frequency of errors affecting codon matrices compared with the trinucleotide counterparts (Table <xref ref-type="table" rid="T3">3</xref>). These results indicate that combinations of divergence and natural selection, such as those considered here, exist to which the exp<sub>EIG </sub>algorithm is not well suited.</p><p>We considered an alternate, but less likely, explanation for the distinct frequency of pathological matrices between the protein coding and intronic sequence classes &#x02013; that they represent an artefact of the concatenation of protein coding sequences. Concatenation of sequences from protein coding genes subjected to distinct evolutionary and mutagenic processes could generate (or obscure) pathological matrices. We evaluated this possibility for dinucleotide matrices on individual protein coding sequence alignments for just one of the species triples (<italic>Anabaena variabilis, Anabaena sp. </italic>PCC 7120 and <italic>Thermosynechococcus elongatus</italic>). The results were consistent with those reported above regarding the occurrence of errors for exp<sub>EIG </sub>(Table <xref ref-type="table" rid="T4">4</xref>). In contrast to the results from the concatenated alignments, there was a substantial error rate from exp<sub>TAYL</sub>. Consistent with our assessment from trinucleotide matrices from protein coding sequences, the failures were predominantly caused by the absence of some states, a case that was increased due to the much shorter length of the individual alignments. These properties were robust to whether exp<sub>PAD&#x000c9; </sub>or exp<sub>EIG </sub>were used in the constrained optimisation step (Table <xref ref-type="table" rid="T4">4</xref>). That all algorithms exhibited a consistently lower median error rate on the <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M16" name="1471-2105-9-550-i4" overflow="scroll"><mml:semantics><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>Q</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle></mml:semantics></mml:math></inline-formula> estimated using exp<sub>PAD&#x000c9; </sub>(~0.0017) compared with those estimated using exp<sub>EIG </sub>(~0.0026) further supports the robustness of exp<sub>PAD&#x000c9; </sub>.</p><table-wrap position="float" id="T4"><label>Table 4</label><caption><p>Exponentiation of individual matrices from protein coding exons from a triad of microbial species.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="center"><bold>Fit<sup>1</sup></bold></td><td align="right"><bold>Data</bold></td><td align="left"><bold>Norm<sup>2</sup></bold></td><td align="right"><bold>Cond<sup>2</sup></bold></td><td align="right"><bold>&#x003f5;<sub>TAYL</sub><sup>2</sup></bold></td><td align="right"><bold>&#x003f5;<sub>EIG</sub><sup>2</sup></bold></td><td align="right"><bold>&#x003f5;<sub>PAD&#x000c9;</sub><sup>2</sup></bold></td><td align="right"><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M17" name="1471-2105-9-550-i9" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>E</mml:mi></mml:mstyle><mml:mrow><mml:mi>T</mml:mi><mml:mi>A</mml:mi><mml:mi>Y</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula></td><td align="right"><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M18" name="1471-2105-9-550-i10" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>E</mml:mi></mml:mstyle><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>E</mml:mi><mml:mi>I</mml:mi><mml:mi>G</mml:mi></mml:mstyle></mml:mrow><mml:mn>3</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula></td><td align="right"><bold>E<sub>PAD&#x000c9;</sub><sup>3</sup></bold></td><td align="right"><bold>N<sup>4</sup></bold></td></tr></thead><tbody><tr><td align="right">exp<sub>PAD&#x000c9;</sub></td><td align="left">Dinuc 1+2</td><td align="left">(0.13, 3.7e+02)</td><td align="right">(10, 1.3e+18)</td><td align="right">(6.2e-06, 1.2e+137)</td><td align="right">(6.2e-06, 86)</td><td align="right">(6.2e-06, 0.96)</td><td align="right">85</td><td align="right">141</td><td align="right">0</td><td align="right">5580</td></tr><tr><td></td><td align="left">Dinuc 2+3</td><td align="left">(0.35, 5.8e+02)</td><td align="right">(15, 9.4e+16)</td><td align="right">(0.0017, 5.2e+141)</td><td align="right">(0.0017, inf)</td><td align="right">(0.0017, 0.97)</td><td align="right">89</td><td align="right">140</td><td align="right">0</td><td align="right">5580</td></tr><tr><td align="right">exp<sub>EIG</sub></td><td align="left">Dinuc 1+2</td><td align="left">(0.13, 2.6e+02)</td><td align="right">(15, inf)</td><td align="right">(1.4e-05, 1.5e+70)</td><td align="right">(1.4e-05, 0.96)</td><td align="right">(1.4e-05, 0.96)</td><td align="right">86</td><td align="right">137</td><td align="right">0</td><td align="right">5580</td></tr><tr><td></td><td align="left">Dinuc 2+3</td><td align="left">(0.36, 5.4e+02)</td><td align="right">(17, 2e+17)</td><td align="right">(0.0026, 1.6e+133)</td><td align="right">(0.0025, 1)</td><td align="right">(0.0026, 1)</td><td align="right">99</td><td align="right">56</td><td align="right">0</td><td align="right">5580</td></tr></tbody></table><table-wrap-foot><p>The species were <italic>Anabaena variabilis</italic>, <italic>Anabaena sp</italic>. PCC 7120 and <italic>Thermosynechococcus elongatus</italic>.</p><p><sup>1 </sup>Fit &#x02013; the algorithm used for the constrained estimation of <bold>Q</bold>; <sup>2 </sup>&#x02013; median and maximum values; <sup>3 </sup>&#x02013; Number of <bold>P </bold>matrices for the indicated algorithm with an invalid probability; <sup>4 </sup>&#x02013; total number of matrices; inf &#x02013; an infinite difference, typically arising from an exponentiation error.</p></table-wrap-foot></table-wrap><p>Matrices pathological to an algorithm can also occur during numerical optimisation. What defines the frequency of such matrices is unclear but they do arise during optimisation. For ~1% of the primate intron trinucleotide <bold>P </bold>matrices, the Taylor series to the second element (which we used as the initial estimate for optimisation) were pathological to exp<sub>EIG</sub>. Whether occurrence of such matrices during an optimisation would affect the resulting solution is unclear.</p><p>Although exp<sub>EIG </sub>lends itself to caching, the utility of a global <bold>Q</bold>, and thus the importance of caching, diminishes when considering non-reversible models. Non-stationarity is implicitly a part of non-reversible phylogenetic models; this, by definition necessitates non-global <bold>Q</bold>. As evidenced by the computational speed summaries in Table <xref ref-type="table" rid="T5">5</xref>, if numerous exponentiations are required then exp<sub>PAD&#x000c9; </sub>has a clear performance advantage in addition to its numerical robustness.</p><table-wrap position="float" id="T5"><label>Table 5</label><caption><p>Exponentiation algorithm compute times.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="right"><bold>Alphabet</bold></td><td align="right"><bold>Algorithm</bold></td><td align="right"><bold>Time</bold></td></tr></thead><tbody><tr><td align="right">Nucleotide</td><td align="right">exp<sub>EIG</sub></td><td align="right">0.2</td></tr><tr><td></td><td align="right">exp<sub>TAYL</sub></td><td align="right">0.4</td></tr><tr><td></td><td align="right">exp<sub>PAD&#x000c9;</sub></td><td align="right">0.2</td></tr><tr><td align="right">Dinucleotide</td><td align="right">exp<sub>EIG</sub></td><td align="right">0.8</td></tr><tr><td></td><td align="right">exp<sub>TAYL</sub></td><td align="right">0.6</td></tr><tr><td></td><td align="right">exp<sub>PAD&#x000c9;</sub></td><td align="right">0.4</td></tr><tr><td align="right">Trinucleotide</td><td align="right">exp<sub>EIG</sub></td><td align="right">11.2</td></tr><tr><td></td><td align="right">exp<sub>TAYL</sub></td><td align="right">7.6</td></tr><tr><td></td><td align="right">exp<sub>PAD&#x000c9;</sub></td><td align="right">3.7</td></tr></tbody></table><table-wrap-foot><p>Mean compute time (milliseconds) from 100 different matrices.</p></table-wrap-foot></table-wrap></sec><sec><title>Conclusion</title><p>We have determined that matrices pathological to the most commonly applied matrix exponentiation algorithms exist in nature. The robust behaviour of the Pad&#x000e9; with scaling and squaring algorithm, combined with its performance advantage for larger sequence alphabets, establishes this as the algorithm most suited to non-reversible models.</p></sec><sec sec-type="methods"><title>Methods</title><sec><title>Sampling Sequences from Microbes</title><p>Most methods for inferring rate matrices perform best when the diagonal of the probability matrix is strongly dominant, i.e. when there are relatively few changes. Incorrect choices of the outgroup are also problematic, because such choices reverse the directionality of the evolutionary process. We therefore chose species triples where the sister taxa are substantially more related to one another than they are to the outgroup. Specifically, we required sister taxa to be at least 98% identical in their 16 S rRNA genes, and required the outgroup to be 90&#x02013;98% identical, thus ensuring that all but the fastest-evolving proteins would have dominant diagonals in their <bold>P </bold>matrices and that the outgroup would be more different than the remainder. For each of these species triples, for each protein in one of the two sister taxa, its best BLAST hit in each of the other two taxa was recovered (blastp e-value 10<sup>-10</sup>). The best hits were then aligned using MUSCLE with default parameters and the nucleotide sequences from KEGG threaded back through the protein alignment to generate a nucleotide alignment.</p></sec><sec><title>Sampling Sequences from Primates</title><p>We sampled primate sequence alignments from the Ensembl release 46 multiple-sequence alignments of <italic>Homo sapiens </italic>(human), <italic>Pan troglodytes </italic>(chimpanzee) and <italic>Macacca mulatta (</italic>macaque) genomes. Genomic coordinates for human protein coding genes were determined and Ensembl's PECAN genomic multiple alignments corresponding to the human coordinates selected for the species-set. Only genes for which sequence alignments were available for all three lineages were retained. Exonic sequence, indels and the simple repeat sequences were masked. Alignments were split into trinucleotide columns and any column containing characters other than ACGT were excluded and of the resulting filtered alignments those &#x02265; 50000 base pairs long were kept. This procedure resulted in ~1100 alignments of primate intron sequences.</p><p>Orthologous protein coding sequence (CDS) for the sampled human genes was extracted and aligned using the PyCogent progressive HMM alignment algorithm, with a codon substitution model [<xref ref-type="bibr" rid="B17">17</xref>]. All aligned codon columns containing non-nucleotide characters were removed. Due to the computational demands of fitting trinucleotide models, we concatenated 10 aligned genes in an arbitrary order (determined by the sort order of the Ensembl identifier of the human gene) resulting in ~100 alignments of concatenated primate protein coding genes.</p><p>All alignments were in trinucleotide frame, meaning that (starting from the first nucleotide) each triplet of nucleotide columns contained only 'real' trinucleotides. Due to the elimination of masked sequences, spanning between trinucleotides could create sequence elements not present in the original genome sequence. To avoid sampling artificial dinucleotides, alignments were split into trinucleotide columns first and either all first and second, or second and third positions were selected and concatenated to construct dinucleotide alignments. Nucleotide and trinucleotide alignments were derived without any modification.</p></sec><sec><title>Estimating Q</title><p>For each alignment for a species triad, we used the known outgroup lineage to determine the direction of substitutions between sequence states for each ingroup lineage. Alignments were split into columns of non-overlapping motifs of either nucleotide, dinucleotide or trinucleotides with the trinucleotide based sampling of sequences taken into account for the dinucleotide sampling (see above). Columns in which all three sequences were different were excluded since the ancestral state of the ingroups cannot be determined. If the ingroups were identical to each other, but different from the outgroup, the ancestral state is taken as the ingroup state. If one of the ingroup lineages was identical to the outgroup, their state was taken as the ancestral state. These assignments of ancestral state were used to count the number of times motif <italic>i </italic>changed to motif <italic>j </italic>for each ingroup lineage separately. This procedure generated a 'counts' matrix for each lineage, for each alignment which can be converted into a <bold>P </bold>matrix by dividing the elements of each row by the row sum. The resulting <bold>P </bold>matrices can be non-reversible.</p><p>Estimation of <bold>Q </bold>from <bold>P </bold>matrices was done using a constrained optimisation procedure. All off-diagonal elements of <bold>Q </bold>(<italic>q</italic><sub><italic>ij</italic>, <italic>i </italic>&#x02260; <italic>j</italic></sub>) are free parameters while the diagonal elements are constrained to be <italic>q</italic><sub><italic>ii </italic></sub>= -&#x02211;<sub><italic>j</italic>, <italic>j </italic>&#x02260; <italic>i </italic></sub><italic>q</italic><sub><italic>ij </italic></sub>to ensure the row sums of the instantaneous rate matrix are 0. Constraining the <italic>q</italic><sub><italic>ij</italic>, <italic>i </italic>&#x02260; <italic>j </italic></sub>&#x02265; 0, we minimised ||<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M19" name="1471-2105-9-550-i3" overflow="scroll"><mml:semantics><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle></mml:semantics></mml:math></inline-formula> - exp(<bold>Q</bold>)|| where the matrix exponential was computed by Pad&#x000e9; (unless stated otherwise). This function was minimised using the PyCogent [<xref ref-type="bibr" rid="B18">18</xref>] Powell optimiser with tolerance of 10<sup>-6 </sup>and a maximum of 5 restarts. We used the Taylor series to the second element, computed as <bold>P </bold>minus the identity matrix, as the starting values for the numerical optimisation. The number of free parameters for <bold>Q </bold>were <italic>N </italic>&#x000d7; (<italic>N </italic>- 1) (<italic>N </italic>is the number of motifs in the alphabet): 12 for nucleotides; 240 for dinucleotides; and 4032 for trinucleotide matrices. Due to the very large number of free parameters in the trinucleotide models, and computational times required to estimate some <bold>Q </bold>of ~24 hours (for the microbial samples), not all alignments were used. Codon matrices were derived for the protein coding sequences by removing the unobserved states which corresponded to the trinucleotides encoding stop codons.</p></sec><sec><title>Measuring matrix exponentiation error</title><p>In order to quantify the accuracy of the matrix exponentiation methods a number of measures are introduced. Firstly, there is the concept of a matrix norm. The matrix norm ||<bold>Q</bold>|| is a generalisation of the vector norm (length of a vector) and yields a measure of the effective size of a matrix <bold>Q </bold>in terms of the size of its elements [<xref ref-type="bibr" rid="B7">7</xref>]. We employed the Frobenius norm (often easier to compute than the induced norms) [<xref ref-type="bibr" rid="B7">7</xref>], which for the matrix <bold>Q </bold>is</p><p><disp-formula id="bmcM1"><label>(1)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M20" name="1471-2105-9-550-i11" overflow="scroll"><mml:semantics><mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Q</mml:mi></mml:mstyle><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:mo>|</mml:mo><mml:msubsup><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>|</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:mrow></mml:msqrt></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>where the <italic>q</italic><sub><italic>ij </italic></sub>are the elements of <bold>Q</bold>. The distance between two matrices can therefore be computed as the norm of the difference between the matrices and equates to the square root of the sum of absolute squared differences. We define relative measures of exponentiation error as</p><p><disp-formula id="bmcM2"><label>(2)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M21" name="1471-2105-9-550-i12" overflow="scroll"><mml:semantics><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>&#x003f5;</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>A</mml:mi><mml:mi>Y</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mi>exp</mml:mi><mml:mo>&#x02061;</mml:mo></mml:mrow><mml:mrow><mml:mtext>TAYL</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>Q</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:mo>|</mml:mo><mml:mo>|</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:semantics></mml:math></disp-formula></p><p><disp-formula id="bmcM3"><label>(3)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M22" name="1471-2105-9-550-i13" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>&#x003f5;</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>I</mml:mi><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mi>exp</mml:mi><mml:mo>&#x02061;</mml:mo></mml:mrow><mml:mrow><mml:mtext>EIG</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>Q</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:mo>|</mml:mo><mml:mo>|</mml:mo></mml:mrow></mml:semantics></mml:math></disp-formula></p><p><disp-formula id="bmcM4"><label>(4)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M23" name="1471-2105-9-550-i14" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>&#x003f5;</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>A</mml:mi><mml:mi>D</mml:mi><mml:mi>&#x000c9;</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mi>exp</mml:mi><mml:mo>&#x02061;</mml:mo></mml:mrow><mml:mrow><mml:mtext>PAD&#x000c9;</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>Q</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:mo>|</mml:mo><mml:mo>|</mml:mo></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>where <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M24" name="1471-2105-9-550-i3" overflow="scroll"><mml:semantics><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle></mml:semantics></mml:math></inline-formula> is the probability matrix estimated from the counts matrix and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M25" name="1471-2105-9-550-i4" overflow="scroll"><mml:semantics><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>Q</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle></mml:semantics></mml:math></inline-formula> is the instantaneous rate matrix estimated from this <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M26" name="1471-2105-9-550-i3" overflow="scroll"><mml:semantics><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle></mml:semantics></mml:math></inline-formula> as described above.</p><p>In addition to the norm of the rate matrix, the performance of some of the matrix exponentiation methods may depend on the condition number cond<sub>EV</sub>(<bold>Q</bold>) of the eigenvector matrix of <bold>Q </bold>[<xref ref-type="bibr" rid="B6">6</xref>,<xref ref-type="bibr" rid="B7">7</xref>]. The eigenvector matrix condition number cond<sub>EV</sub>(<bold>Q</bold>) can be defined within the spectral matrix norm (2-norm) [<xref ref-type="bibr" rid="B19">19</xref>] as [<xref ref-type="bibr" rid="B7">7</xref>]</p><p><disp-formula id="bmcM5"><label>(5)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M27" name="1471-2105-9-550-i15" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mrow><mml:mtext>cond</mml:mtext></mml:mrow><mml:mrow><mml:mtext>EV</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Q</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>U</mml:mi></mml:mstyle><mml:mo>|</mml:mo><mml:msub><mml:mo>|</mml:mo><mml:mn>2</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>U</mml:mi></mml:mstyle><mml:mo>|</mml:mo><mml:msubsup><mml:mo>|</mml:mo><mml:mn>2</mml:mn><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>&#x003c3;</mml:mi><mml:mrow><mml:mi>max</mml:mi><mml:mo>&#x02061;</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Q</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:msub><mml:mi>&#x003c3;</mml:mi><mml:mrow><mml:mi>min</mml:mi><mml:mo>&#x02061;</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Q</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>where <bold>U </bold>is the matrix of eigenvectors and <italic>&#x003c3;</italic><sub>max</sub>(<bold>Q</bold>) and <italic>&#x003c3;</italic><sub>min</sub>(<bold>Q</bold>) are the maximal and minimal singular values [<xref ref-type="bibr" rid="B7">7</xref>] of <bold>Q </bold>respectively.</p></sec><sec><title>Software implementation</title><p>The PyCogent [<xref ref-type="bibr" rid="B18">18</xref>,<xref ref-type="bibr" rid="B20">20</xref>] built-in routines for determining counts matrices and matrix exponentiation routines were used, while the matrix statistics were computed using the python numerical library, Numpy version 1.0.4 [<xref ref-type="bibr" rid="B21">21</xref>]. All scripts used to undertake this study are available on request.</p></sec></sec><sec><title>Authors' contributions</title><p>HS contributed to implementation of the matrix error measurements and interpretation; VBY contributed to implementation of constrained optimisation method, study design and interpretation; SE contributed to study design; RDK contributed to study design, microbial genome data sampling and interpretation; GAH contributed to study design, implementation of constrained optimisation, data sampling and interpretation.</p></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="S1"><caption><title>Additional File 1</title><p>A pathological rate matrix example. An analytical example of a matrix pathological to eigendecomposition.</p></caption><media xlink:href="1471-2105-9-550-S1.pdf" mimetype="application" mime-subtype="pdf"><caption><p>Click here for file</p></caption></media></supplementary-material></sec></body><back><ack><sec><title>Acknowledgements</title><p>This study was supported by funding from the ARC and NHMRC awarded to GAH and SE; from NIH (P01DK078669), and a time allocation on the Keck RNA Bioinformatics Facility at UC Boulder, awarded to RK; and, from the Singapore Ministry of Education AcRF R-155-050-054-133/R-155-050-054-101, awarded to VB Yap. We thank Micah Hamady for maintaining mirrors of the genome databases on the Keck RNA Bioinformatics Facility.</p></sec></ack><ref-list><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lio</surname><given-names>P</given-names></name><name><surname>Goldman</surname><given-names>N</given-names></name></person-group><article-title>Models of molecular evolution and phylogeny</article-title><source>Genome Res</source><year>1998</year><volume>8</volume><fpage>1233</fpage><lpage>44</lpage><pub-id pub-id-type="pmid">9872979</pub-id></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ames</surname><given-names>B</given-names></name></person-group><article-title>The detection of environmental mutagens and potential carcinogens</article-title><source>Cancer</source><year>1984</year><volume>53</volume><fpage>2034</fpage><lpage>40</lpage><pub-id pub-id-type="pmid">6367933</pub-id><pub-id pub-id-type="doi">10.1002/1097-0142(19840515)53:10&#x0003c;2034::AID-CNCR2820531005&#x0003e;3.0.CO;2-S</pub-id></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lawrence</surname><given-names>JG</given-names></name><name><surname>Ochman</surname><given-names>H</given-names></name></person-group><article-title>Amelioration of Bacterial Genomes: Rates of Change and Exchange</article-title><source>Journal of Molecular Evolution</source><year>1997</year><volume>44</volume><fpage>383</fpage><lpage>397</lpage><pub-id pub-id-type="pmid">9089078</pub-id><pub-id pub-id-type="doi">10.1007/PL00006158</pub-id></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Foster</surname><given-names>PG</given-names></name></person-group><article-title>Modeling compositional heterogeneity</article-title><source>Syst Biol</source><year>2004</year><volume>53</volume><fpage>485</fpage><lpage>95</lpage><pub-id pub-id-type="pmid">15503675</pub-id><pub-id pub-id-type="doi">10.1080/10635150490445779</pub-id></citation></ref><ref id="B5"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Schadt</surname><given-names>E</given-names></name><name><surname>Lange</surname><given-names>K</given-names></name></person-group><article-title>Codon and rate variation models in molecular phylogeny</article-title><source>Mol Biol Evol</source><year>2002</year><volume>19</volume><fpage>1534</fpage><lpage>1549</lpage><pub-id pub-id-type="pmid">12200481</pub-id></citation></ref><ref id="B6"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Moler</surname><given-names>CB</given-names></name><name><surname>Van Loan</surname><given-names>CF</given-names></name></person-group><article-title>Nineteen dubious ways to compute the exponential of a matrix, twenty-five years later</article-title><source>SIAM Review</source><year>2003</year><volume>45</volume><fpage>3</fpage><lpage>49</lpage><pub-id pub-id-type="doi">10.1137/S00361445024180</pub-id></citation></ref><ref id="B7"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Golub</surname><given-names>GH</given-names></name><name><surname>Loan</surname><given-names>CFV</given-names></name></person-group><source>Matrix computations</source><year>1996</year><edition>3</edition><publisher-name>Baltimore, MD, USA: Johns Hopkins University Press</publisher-name></citation></ref><ref id="B8"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ward</surname><given-names>RC</given-names></name></person-group><article-title>Numerical Computation of the Matrix Exponential with Accuracy Estimate</article-title><source>SIAM Journal on Numerical Analysis</source><year>1977</year><volume>14</volume><fpage>600</fpage><lpage>610</lpage><pub-id pub-id-type="doi">10.1137/0714039</pub-id></citation></ref><ref id="B9"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>R</given-names></name></person-group><article-title>The condition numbers of the matrix eigenvalue problem</article-title><source>Numerische Mathematik</source><year>1967</year><volume>10</volume><fpage>232</fpage><lpage>240</lpage><pub-id pub-id-type="doi">10.1007/BF02162166</pub-id></citation></ref><ref id="B10"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Demmel</surname><given-names>J</given-names></name></person-group><article-title>On condition numbers and the distance to the nearest ill-posed problem</article-title><source>Numerische Mathematik</source><year>1987</year><volume>51</volume><fpage>251</fpage><lpage>289</lpage><pub-id pub-id-type="doi">10.1007/BF01400115</pub-id></citation></ref><ref id="B11"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Bai</surname><given-names>Z</given-names></name><name><surname>Demmel</surname><given-names>J</given-names></name><name><surname>McKenney</surname><given-names>A</given-names></name></person-group><article-title>On computing condition numbers for the nonsymmetric eigenproblem</article-title><source>ACM Trans Math Softw</source><year>1993</year><volume>19</volume><fpage>202</fpage><lpage>223</lpage><pub-id pub-id-type="doi">10.1145/152613.152617</pub-id></citation></ref><ref id="B12"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Gibbs</surname><given-names>RA</given-names></name><name><surname>Rogers</surname><given-names>J</given-names></name><name><surname>Katze</surname><given-names>MG</given-names></name><name><surname>Bumgarner</surname><given-names>R</given-names></name><name><surname>Weinstock</surname><given-names>GM</given-names></name><name><surname>Mardis</surname><given-names>ER</given-names></name><name><surname>Remington</surname><given-names>KA</given-names></name><name><surname>Strausberg</surname><given-names>RL</given-names></name><name><surname>Venter</surname><given-names>JC</given-names></name><name><surname>Wilson</surname><given-names>RK</given-names></name><name><surname>Batzer</surname><given-names>MA</given-names></name><name><surname>Bustamante</surname><given-names>CD</given-names></name><name><surname>Eichler</surname><given-names>EE</given-names></name><name><surname>Hahn</surname><given-names>MW</given-names></name><name><surname>Hardison</surname><given-names>RC</given-names></name><name><surname>Makova</surname><given-names>KD</given-names></name><name><surname>Miller</surname><given-names>W</given-names></name><name><surname>Milosavljevic</surname><given-names>A</given-names></name><name><surname>Palermo</surname><given-names>RE</given-names></name><name><surname>Siepel</surname><given-names>A</given-names></name><name><surname>Sikela</surname><given-names>JM</given-names></name><name><surname>Attaway</surname><given-names>T</given-names></name><name><surname>Bell</surname><given-names>S</given-names></name><name><surname>Bernard</surname><given-names>KE</given-names></name><name><surname>Buhay</surname><given-names>CJ</given-names></name><name><surname>Chandrabose</surname><given-names>MN</given-names></name><name><surname>Dao</surname><given-names>M</given-names></name><name><surname>Davis</surname><given-names>C</given-names></name><name><surname>Delehaunty</surname><given-names>KD</given-names></name><name><surname>Ding</surname><given-names>Y</given-names></name><name><surname>Dinh</surname><given-names>HH</given-names></name><name><surname>Dugan-Rocha</surname><given-names>S</given-names></name><name><surname>Fulton</surname><given-names>LA</given-names></name><name><surname>Gabisi</surname><given-names>RA</given-names></name><name><surname>Garner</surname><given-names>TT</given-names></name><name><surname>Godfrey</surname><given-names>J</given-names></name><name><surname>Hawes</surname><given-names>AC</given-names></name><name><surname>Hernandez</surname><given-names>J</given-names></name><name><surname>Hines</surname><given-names>S</given-names></name><name><surname>Holder</surname><given-names>M</given-names></name><name><surname>Hume</surname><given-names>J</given-names></name><name><surname>Jhangiani</surname><given-names>SN</given-names></name><name><surname>Joshi</surname><given-names>V</given-names></name><name><surname>Khan</surname><given-names>ZM</given-names></name><name><surname>Kirkness</surname><given-names>EF</given-names></name><name><surname>Cree</surname><given-names>A</given-names></name><name><surname>Fowler</surname><given-names>RG</given-names></name><name><surname>Lee</surname><given-names>S</given-names></name><name><surname>Lewis</surname><given-names>LR</given-names></name><name><surname>Li</surname><given-names>Z</given-names></name><name><surname>Liu</surname><given-names>YS</given-names></name><name><surname>Moore</surname><given-names>SM</given-names></name><name><surname>Muzny</surname><given-names>D</given-names></name><name><surname>Nazareth</surname><given-names>LV</given-names></name><name><surname>Ngo</surname><given-names>DN</given-names></name><name><surname>Okwuonu</surname><given-names>GO</given-names></name><name><surname>Pai</surname><given-names>G</given-names></name><name><surname>Parker</surname><given-names>D</given-names></name><name><surname>Paul</surname><given-names>HA</given-names></name><name><surname>Pfannkoch</surname><given-names>C</given-names></name><name><surname>Pohl</surname><given-names>CS</given-names></name><name><surname>Rogers</surname><given-names>YH</given-names></name><name><surname>Ruiz</surname><given-names>SJ</given-names></name><name><surname>Sabo</surname><given-names>A</given-names></name><name><surname>Santibanez</surname><given-names>J</given-names></name><name><surname>Schneider</surname><given-names>BW</given-names></name><name><surname>Smith</surname><given-names>SM</given-names></name><name><surname>Sodergren</surname><given-names>E</given-names></name><name><surname>Svatek</surname><given-names>AF</given-names></name><name><surname>Utterback</surname><given-names>TR</given-names></name><name><surname>Vattathil</surname><given-names>S</given-names></name><name><surname>Warren</surname><given-names>W</given-names></name><name><surname>White</surname><given-names>CS</given-names></name><name><surname>Chinwalla</surname><given-names>AT</given-names></name><name><surname>Feng</surname><given-names>Y</given-names></name><name><surname>Halpern</surname><given-names>AL</given-names></name><name><surname>Hillier</surname><given-names>LW</given-names></name><name><surname>Huang</surname><given-names>X</given-names></name><name><surname>Minx</surname><given-names>P</given-names></name><name><surname>Nelson</surname><given-names>JO</given-names></name><name><surname>Pepin</surname><given-names>KH</given-names></name><name><surname>Qin</surname><given-names>X</given-names></name><name><surname>Sutton</surname><given-names>GG</given-names></name><name><surname>Venter</surname><given-names>E</given-names></name><name><surname>Walenz</surname><given-names>BP</given-names></name><name><surname>Wallis</surname><given-names>JW</given-names></name><name><surname>Worley</surname><given-names>KC</given-names></name><name><surname>Yang</surname><given-names>SP</given-names></name><name><surname>Jones</surname><given-names>SM</given-names></name><name><surname>Marra</surname><given-names>MA</given-names></name><name><surname>Rocchi</surname><given-names>M</given-names></name><name><surname>Schein</surname><given-names>JE</given-names></name><name><surname>Baertsch</surname><given-names>R</given-names></name><name><surname>Clarke</surname><given-names>L</given-names></name><name><surname>Csuros</surname><given-names>M</given-names></name><name><surname>Glasscock</surname><given-names>J</given-names></name><name><surname>Harris</surname><given-names>RA</given-names></name><name><surname>Havlak</surname><given-names>P</given-names></name><name><surname>Jackson</surname><given-names>AR</given-names></name><name><surname>Jiang</surname><given-names>H</given-names></name><name><surname>Liu</surname><given-names>Y</given-names></name><name><surname>Messina</surname><given-names>DN</given-names></name><name><surname>Shen</surname><given-names>Y</given-names></name><name><surname>Song</surname><given-names>HXZ</given-names></name><name><surname>Wylie</surname><given-names>T</given-names></name><name><surname>Zhang</surname><given-names>L</given-names></name><name><surname>Birney</surname><given-names>E</given-names></name><name><surname>Han</surname><given-names>K</given-names></name><name><surname>Konkel</surname><given-names>MK</given-names></name><name><surname>Lee</surname><given-names>J</given-names></name><name><surname>Smit</surname><given-names>AFA</given-names></name><name><surname>Ullmer</surname><given-names>B</given-names></name><name><surname>Wang</surname><given-names>H</given-names></name><name><surname>Xing</surname><given-names>J</given-names></name><name><surname>Burhans</surname><given-names>R</given-names></name><name><surname>Cheng</surname><given-names>Z</given-names></name><name><surname>Karro</surname><given-names>JE</given-names></name><name><surname>Ma</surname><given-names>J</given-names></name><name><surname>Raney</surname><given-names>B</given-names></name><name><surname>She</surname><given-names>X</given-names></name><name><surname>Cox</surname><given-names>MJ</given-names></name><name><surname>Demuth</surname><given-names>JP</given-names></name><name><surname>Dumas</surname><given-names>LJ</given-names></name><name><surname>Han</surname><given-names>SG</given-names></name><name><surname>Hopkins</surname><given-names>J</given-names></name><name><surname>Karimpour-Fard</surname><given-names>A</given-names></name><name><surname>Kim</surname><given-names>YH</given-names></name><name><surname>Pollack</surname><given-names>JR</given-names></name><name><surname>Vinar</surname><given-names>T</given-names></name><name><surname>Addo-Quaye</surname><given-names>C</given-names></name><name><surname>Degenhardt</surname><given-names>J</given-names></name><name><surname>Denby</surname><given-names>A</given-names></name><name><surname>Hubisz</surname><given-names>MJ</given-names></name><name><surname>Indap</surname><given-names>A</given-names></name><name><surname>Kosiol</surname><given-names>C</given-names></name><name><surname>Lahn</surname><given-names>BT</given-names></name><name><surname>Lawson</surname><given-names>HA</given-names></name><name><surname>Marklein</surname><given-names>A</given-names></name><name><surname>Nielsen</surname><given-names>R</given-names></name><name><surname>Vallender</surname><given-names>EJ</given-names></name><name><surname>Clark</surname><given-names>AG</given-names></name><name><surname>Ferguson</surname><given-names>B</given-names></name><name><surname>Hernandez</surname><given-names>RD</given-names></name><name><surname>Hirani</surname><given-names>K</given-names></name><name><surname>Kehrer-Sawatzki</surname><given-names>H</given-names></name><name><surname>Kolb</surname><given-names>J</given-names></name><name><surname>Patil</surname><given-names>S</given-names></name><name><surname>Pu</surname><given-names>LL</given-names></name><name><surname>Ren</surname><given-names>Y</given-names></name><name><surname>Smith</surname><given-names>DG</given-names></name><name><surname>Wheeler</surname><given-names>DA</given-names></name><name><surname>Schenck</surname><given-names>I</given-names></name><name><surname>Ball</surname><given-names>EV</given-names></name><name><surname>Chen</surname><given-names>R</given-names></name><name><surname>Cooper</surname><given-names>DN</given-names></name><name><surname>Giardine</surname><given-names>B</given-names></name><name><surname>Hsu</surname><given-names>F</given-names></name><name><surname>Kent</surname><given-names>WJ</given-names></name><name><surname>Lesk</surname><given-names>A</given-names></name><name><surname>Nelson</surname><given-names>DL</given-names></name><name><surname>O'brien</surname><given-names>WE</given-names></name><name><surname>Prufer</surname><given-names>K</given-names></name><name><surname>Stenson</surname><given-names>PD</given-names></name><name><surname>Wallace</surname><given-names>JC</given-names></name><name><surname>Ke</surname><given-names>H</given-names></name><name><surname>Liu</surname><given-names>XM</given-names></name><name><surname>Wang</surname><given-names>P</given-names></name><name><surname>Xiang</surname><given-names>AP</given-names></name><name><surname>Yang</surname><given-names>F</given-names></name><name><surname>Barber</surname><given-names>GP</given-names></name><name><surname>Haussler</surname><given-names>D</given-names></name><name><surname>Karolchik</surname><given-names>D</given-names></name><name><surname>Kern</surname><given-names>AD</given-names></name><name><surname>Kuhn</surname><given-names>RM</given-names></name><name><surname>Smith</surname><given-names>KE</given-names></name><name><surname>Zwieg</surname><given-names>AS</given-names></name></person-group><article-title>Evolutionary and biomedical insights from the rhesus macaque genome</article-title><source>Science</source><year>2007</year><volume>316</volume><fpage>222</fpage><lpage>234</lpage><pub-id pub-id-type="pmid">17431167</pub-id><pub-id pub-id-type="doi">10.1126/science.1139247</pub-id></citation></ref><ref id="B13"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Golub</surname><given-names>GH</given-names></name><name><surname>Wilkinson</surname><given-names>JH</given-names></name></person-group><article-title>Ill-Conditioned Eigensystems and the Computation of the Jordan Canonical Form</article-title><source>SIAM Review</source><year>1976</year><volume>18</volume><fpage>578</fpage><lpage>619</lpage><pub-id pub-id-type="doi">10.1137/1018113</pub-id></citation></ref><ref id="B14"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ruhe</surname><given-names>A</given-names></name></person-group><article-title>Properties of a matrix with a very ill-conditioned eigenproblem</article-title><source>Numerische Mathematik</source><year>1970</year><volume>15</volume><fpage>57</fpage><lpage>60</lpage><pub-id pub-id-type="doi">10.1007/BF02165660</pub-id></citation></ref><ref id="B15"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Alam</surname><given-names>R</given-names></name></person-group><article-title>On the construction of nearest defective matrices to a normal matrix</article-title><source>Linear Algebra and Its Applications</source><year>2005</year><volume>395</volume><fpage>367</fpage><lpage>370</lpage><pub-id pub-id-type="doi">10.1016/j.laa.2004.09.008</pub-id></citation></ref><ref id="B16"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Chaitin-Chatelin</surname><given-names>F</given-names></name><name><surname>Frayss&#x000e9;</surname><given-names>V</given-names></name></person-group><source>Lectures on Finite Precision Computations</source><year>1996</year><publisher-name>Philadelphia: SIAM</publisher-name></citation></ref><ref id="B17"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>Z</given-names></name></person-group><article-title>Likelihood ratio tests for detecting positive selection and application to primate lysozyme evolution</article-title><source>Mol Biol Evol</source><year>1998</year><volume>15</volume><fpage>568</fpage><lpage>73</lpage><pub-id pub-id-type="pmid">9580986</pub-id></citation></ref><ref id="B18"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Knight</surname><given-names>R</given-names></name><name><surname>Maxwell</surname><given-names>P</given-names></name><name><surname>Birmingham</surname><given-names>A</given-names></name><name><surname>Carnes</surname><given-names>J</given-names></name><name><surname>Caporaso</surname><given-names>J</given-names></name><name><surname>Easton</surname><given-names>B</given-names></name><name><surname>Eaton</surname><given-names>M</given-names></name><name><surname>Hamady</surname><given-names>M</given-names></name><name><surname>Lindsay</surname><given-names>H</given-names></name><name><surname>Liu</surname><given-names>Z</given-names></name><name><surname>Lozupone</surname><given-names>C</given-names></name><name><surname>McDonald</surname><given-names>D</given-names></name><name><surname>Robeson</surname><given-names>M</given-names></name><name><surname>Sammut</surname><given-names>R</given-names></name><name><surname>Smit</surname><given-names>S</given-names></name><name><surname>Wakefield</surname><given-names>M</given-names></name><name><surname>Widmann</surname><given-names>J</given-names></name><name><surname>Wikman</surname><given-names>S</given-names></name><name><surname>Wilson</surname><given-names>S</given-names></name><name><surname>Ying</surname><given-names>H</given-names></name><name><surname>Huttley</surname><given-names>G</given-names></name></person-group><article-title>PyCogent: a toolkit for making sense from sequence</article-title><source>Genome Biol</source><year>2007</year><volume>8</volume><fpage>R171</fpage><pub-id pub-id-type="pmid">17708774</pub-id><pub-id pub-id-type="doi">10.1186/gb-2007-8-8-r171</pub-id></citation></ref><ref id="B19"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Meyer</surname><given-names>C</given-names></name></person-group><source>Matrix Analysis and Applied Linear Algebra</source><year>2000</year><publisher-name>Society for Industrial Mathematics</publisher-name></citation></ref><ref id="B20"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Butterfield</surname><given-names>A</given-names></name><name><surname>Vedagiri</surname><given-names>V</given-names></name><name><surname>Lang</surname><given-names>E</given-names></name><name><surname>Lawrence</surname><given-names>C</given-names></name><name><surname>Wakefield</surname><given-names>MJ</given-names></name><name><surname>Isaev</surname><given-names>A</given-names></name><name><surname>Huttley</surname><given-names>GA</given-names></name></person-group><article-title>PyEvolve: a toolkit for statistical modelling of molecular evolution</article-title><source>BMC Bioinformatics</source><year>2004</year><volume>5</volume><fpage>1</fpage><pub-id pub-id-type="pmid">14706121</pub-id><pub-id pub-id-type="doi">10.1186/1471-2105-5-1</pub-id></citation></ref><ref id="B21"><citation citation-type="other"><article-title>Numeric python</article-title><ext-link ext-link-type="uri" xlink:href="http://numpy.scipy.org"/></citation></ref></ref-list></back></article>