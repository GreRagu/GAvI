<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd"><article xmlns:xlink="http://www.w3.org/1999/xlink" article-type="product-review"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Syst Biol</journal-id><journal-title>BMC Systems Biology</journal-title><issn pub-type="epub">1752-0509</issn><publisher><publisher-name>BioMed Central</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">18973705</article-id><article-id pub-id-type="pmc">2636783</article-id><article-id pub-id-type="publisher-id">1752-0509-2-91</article-id><article-id pub-id-type="doi">10.1186/1752-0509-2-91</article-id><article-categories><subj-group subj-group-type="heading"><subject>Software</subject></subj-group></article-categories><title-group><article-title>ALC: automated reduction of rule-based models</article-title></title-group><contrib-group><contrib id="A1" corresp="yes" contrib-type="author"><name><surname>Koschorreck</surname><given-names>Markus</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>koschorreck@mpi-magdeburg.mpg.de</email></contrib><contrib id="A2" contrib-type="author"><name><surname>Gilles</surname><given-names>Ernst Dieter</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>gilles@mpi-magdeburg.mpg.de</email></contrib></contrib-group><aff id="I1"><label>1</label>Max Planck Institute for Dynamics of Complex Technical Systems, Sandtorstr. 1, 39106 Magdeburg, Germany</aff><pub-date pub-type="collection"><year>2008</year></pub-date><pub-date pub-type="epub"><day>31</day><month>10</month><year>2008</year></pub-date><volume>2</volume><fpage>91</fpage><lpage>91</lpage><ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1752-0509/2/91"/><history><date date-type="received"><day>20</day><month>6</month><year>2008</year></date><date date-type="accepted"><day>31</day><month>10</month><year>2008</year></date></history><permissions><copyright-statement>Copyright &#x000a9; 2008 Koschorreck and Gilles; licensee BioMed Central Ltd.</copyright-statement><copyright-year>2008</copyright-year><copyright-holder>Koschorreck and Gilles; licensee BioMed Central Ltd.</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0"><p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p><!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>               Koschorreck               Markus                              koschorreck@mpi-magdeburg.mpg.de            </dc:author><dc:title>            ALC: automated reduction of rule-based models         </dc:title><dc:date>2008</dc:date><dcterms:bibliographicCitation>BMC Systems Biology 2(1): 91-. (2008)</dcterms:bibliographicCitation><dc:identifier type="sici">1752-0509(2008)2:1&#x0003c;91&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1752-0509</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>--></license></permissions><abstract><sec><title>Background</title><p>Combinatorial complexity is a challenging problem for the modeling of cellular signal transduction since the association of a few proteins can give rise to an enormous amount of feasible protein complexes. The layer-based approach is an approximative, but accurate method for the mathematical modeling of signaling systems with inherent combinatorial complexity. The number of variables in the simulation equations is highly reduced and the resulting dynamic models show a pronounced modularity. Layer-based modeling allows for the modeling of systems not accessible previously.</p></sec><sec><title>Results</title><p>ALC (Automated Layer Construction) is a computer program that highly simplifies the building of reduced modular models, according to the layer-based approach. The model is defined using a simple but powerful rule-based syntax that supports the concepts of modularity and macrostates. ALC performs consistency checks on the model definition and provides the model output in different formats (C MEX, MATLAB, <italic>Mathematica </italic>and SBML) as ready-to-run simulation files. ALC also provides additional documentation files that simplify the publication or presentation of the models. The tool can be used offline or via a form on the ALC website.</p></sec><sec><title>Conclusion</title><p>ALC allows for a simple rule-based generation of layer-based reduced models. The model files are given in different formats as ready-to-run simulation files.</p></sec></abstract></article-meta></front><body><sec><title>Background</title><sec><title>Combinatorial complexity</title><p>The association of a few proteins can result in an enormous amount of possible protein complexes [<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B2">2</xref>]. This phenomenon is referred to as combinatorial complexity. A general observation is that there are four possible sources of combinatorial complexity in signaling systems that can also occur in combination with each other:</p><p>&#x02022; Binding events at scaffold proteins with more than one binding site</p><p>&#x02022; Modification (e.g. phosphorylation) of proteins with several sites</p><p>&#x02022; Oligomerization (as a special case: dimerization)</p><p>&#x02022; Chain formation</p><p>In a simplified form, we previously used the insulin signaling system as a demonstration object for combinatorial complexity [<xref ref-type="bibr" rid="B3">3</xref>]. The complexity (145,156,469 possible species) results from a combination of the first three items listed above. Many other signaling systems also show combinatorial complexity [<xref ref-type="bibr" rid="B1">1</xref>]. As outlined below, one ODE (ordinary differential equation) is required for the balance of each possible complex. This leads to enormous problems in the modeling of systems with inherent combinatorial complexity.</p></sec><sec><title>Structure of the introduction</title><p>In the following sections, we introduce general modeling concepts which are characterized by significant differences in their ability to cope with combinatorial complexity. We outline the conventional approach to model biochemical systems, discuss its limitations and review recent techniques that allow for the modeling of systems with inherent combinatorial complexity. A very promising approach is that of layer-based modeling [<xref ref-type="bibr" rid="B3">3</xref>], for which we present ALC (Automated Layer Construction), a tool for rule-based automated modeling. The main motivation of this comprehensive introduction is to provide simplified but accurate information regarding layer-based modeling for those who are not familiar with the method. More involved discussions and several examples can be found in our previous publication introducing layer-based modeling [<xref ref-type="bibr" rid="B3">3</xref>]. Readers who are already familiar with rules and layer-based modeling should read the "general concepts and definitions" section but may skip the remainder of the introduction and directly proceed to the "implementation" chapter where we introduce the software tool ALC.</p></sec><sec><title>General concepts and definitions</title><p>In this section, we introduce the notation for the variables and their dependencies that we use later on. Proceeding in such a formal way may not be necessary for conventional modeling, however, introducing the layer-based approach and ALC benefits from a precise terminology.</p><sec><title>Modules</title><p>Systems can often be decomposed into self-contained subsystems that interact with other subsystems in a well-defined way. Such subsystems are called modules. The process of defining the modules and their connections is called modularization.</p></sec><sec><title>Molecule definitions</title><p>The molecule definition introduced here is not equivalent to the strict chemical understanding of molecules where all atoms have to be linked by covalent bonds. A molecule definition represents the class of possible modifications of a protein (or another molecule). It consists of the molecule name that is optionally followed by the successive definition of all sites (if there are any). A site definition consists of a comma-separated sequence of all possible modifications of this site, enclosed by curly brackets. As an example for a molecule definition, <monospace>R{0, L}{0, P}</monospace> defines the molecule <italic>R</italic>. The possible modifications (or configurations) of <italic>R </italic>are '0' and 'L' at the first site as well as '0' and 'P' at the second site. Note that we allow for the consideration of a bound ligand (e.g. <italic>L</italic>) as a site configuration of the receptor molecule. There can also be molecules that exist in only one configuration. The modification of them results in new molecules.</p></sec><sec><title>Species and concentrations</title><p>Species correspond to a specific configuration of a molecule and can be considered as instances of the corresponding molecule definitions. Notations for species consist of the molecule name followed by the comma-separated sequence of site configurations within one pair of squared brackets. As an example, the species <italic>R</italic>[<italic>L</italic>, <italic>P</italic>] is a specified configuration of the molecule <italic>R</italic>. The ligand <italic>L </italic>is bound to the first site, the second site is phosphorylated. The species <italic>R</italic>[0, 0] defines the unphosphorylated receptor without ligand. If a molecule <italic>A </italic>can occur in just one state (i.e. the molecule definition is A), this single species is also denoted as <italic>A</italic>. For the sake of simplicity, we use the same notation for species and their concentrations.</p></sec><sec><title>Macroscopic variables</title><p>In exact model reduction [<xref ref-type="bibr" rid="B4">4</xref>,<xref ref-type="bibr" rid="B5">5</xref>] and layer-based modeling [<xref ref-type="bibr" rid="B3">3</xref>] there exist variables that correspond to sums of species of a corresponding conventional model. We call these variables macroscopic variables (or lumped states). Note that species can be macroscopic variables.</p></sec><sec><title>Microscopic species</title><p>All species that are not macroscopic variables are microscopic species (or microstates). Microscopic species correspond to a distinct modification of a molecule and do not represent a pool of chemical molecules or complexes with common properties. Microscopic species are species that could also occur in a conventional model. Therefore, in the conventional modeling approach, microscopic species are equivalent to species.</p></sec><sec><title>Macrostates and patterns</title><p>Macrostates describe macroscopic variables, e.g. degrees of phosphorylation or occupancy which correspond to sums of species. Their notation is analogous to that for species, with the sole difference being that the modification 'X' at a specific site indicates that all distinct modifications at this site are included. Therefore, a site modification 'X' of a molecule indicates the sum of all possible modifications of this site. Macrostates in rules are interpreted as patterns. Each species of the class defined by the pattern occurs in a separate reaction when the rule is evaluated. Therefore, patterns do not represent sums of species (as macrostates do) but each of the corresponding species individually (see section "rule-based modeling"). Like species, macrostates can also be considered as instances of the corresponding molecule definitions. Note that not all macroscopic variables are macrostates. The hallmark of macrostates and patterns is that they must contain at least one site modification 'X'.</p><p>As an example, the macrostate <italic>ERB</italic>[<italic>L</italic>, <italic>X</italic>, <italic>X</italic>] defines the sum of all species of the molecule <italic>ERB </italic>that have a bound ligand at the first site, regardless of the state of the other sites.</p><p>Note that the term macrostate is used with a slightly different meaning in other contributions [<xref ref-type="bibr" rid="B4">4</xref>,<xref ref-type="bibr" rid="B5">5</xref>], where it represents what we call a macroscopic variable (or macroscopic species). We reserve the term macrostate for sums of species that are defined by at least one site modification 'X'. The so defined macrostates are also macrostates or mesoscopic states as defined by Borisov et al. [<xref ref-type="bibr" rid="B4">4</xref>] and Conzelmann et al. [<xref ref-type="bibr" rid="B5">5</xref>].</p></sec><sec><title>Complexes</title><p>A complex is represented by a list of comma-separated species within curly brackets where the binding partner is indicated at each occupied binding site. Indices have to be used if it is required to achieve uniqueness.</p><p>As an example, consider the binding of a molecule <italic>R </italic>with <italic>n </italic>sites and a molecule <italic>S </italic>with <italic>k </italic>sites. The complex of <italic>R </italic>and <italic>S </italic>is {<italic>R</italic>[<italic>m</italic><sub>1</sub>,..,<italic>S</italic>,...,<italic>m</italic><sub><italic>n</italic></sub>], <italic>S</italic>[<italic>m</italic><sub>1</sub>,...,<italic>R</italic>,...,<italic>m</italic><sub><italic>k</italic></sub>]}, where <italic>m</italic><sub><italic>i </italic></sub>denotes the modification at the site position <italic>i</italic>. If we also consider another molecule <italic>T </italic>that has <italic>q </italic>sites, the complex of <italic>R</italic>, <italic>S </italic>and <italic>T</italic>, where <italic>S </italic>and <italic>T </italic>bind to <italic>R </italic>is denoted as {<italic>R</italic>[<italic>m</italic><sub>1</sub>,..,<italic>S</italic>,...,<italic>T</italic>,...,<italic>m</italic><sub><italic>n</italic></sub>], <italic>S</italic>[<italic>m</italic><sub>1</sub>,...,<italic>R</italic>,...,<italic>m</italic><sub><italic>k</italic></sub>], <italic>T</italic>[<italic>m</italic><sub>1</sub>,...,<italic>R</italic>,...,<italic>m</italic><sub><italic>q</italic></sub>]}. This definition of complex notation is very general but cumbersome in many cases.</p><p>We introduce a simplified notation that will be used from now on and is supported by ALC. In many cases, this notation is less cumbersome and more intuitive than the general one. Consider the case that the molecules <italic>S </italic>and <italic>T </italic>both have only one site which is a binding site for <italic>R</italic>. The complex of <italic>R</italic>, <italic>S </italic>and <italic>T </italic>then is <italic>R</italic>[<italic>m</italic><sub>1</sub>,..,<italic>S</italic>,...,<italic>T</italic>,...,<italic>m</italic><sub><italic>n</italic></sub>] and can be treated as a species of the molecule <italic>R</italic>. If <italic>S </italic>and <italic>T </italic>have more sites, the configuration of <italic>S </italic>and <italic>T </italic>in the complex with <italic>R </italic>can be indicated by introducing additional site modifications of the corresponding site on <italic>R</italic>. If two of the associating molecules have several sites, the class of possible complexes can be defined by a new molecule definition which consists of a new molecule name and the sequence of site definitions of the corresponding molecule definitions for the monomers. We exemplify this for the general case where <italic>R </italic>has a binding site for <italic>S </italic>and <italic>n </italic>other sites, while <italic>S </italic>has a binding site for <italic>R </italic>and <italic>k </italic>other sites. A species representing a complex of <italic>R </italic>and <italic>S </italic>is <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" name="1752-0509-2-91-i1" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>R</mml:mi><mml:mi>S</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>m</mml:mi><mml:mn>1</mml:mn><mml:mi>R</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mn>...</mml:mn><mml:msubsup><mml:mi>m</mml:mi><mml:mi>n</mml:mi><mml:mi>R</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>m</mml:mi><mml:mn>1</mml:mn><mml:mi>S</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mn>...</mml:mn><mml:msubsup><mml:mi>m</mml:mi><mml:mi>k</mml:mi><mml:mi>S</mml:mi></mml:msubsup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:semantics></mml:math></inline-formula>, where the superscripts indicate the origin of the sites. Dimerization can be treated analogously.</p><p>Due to the modular structure of layer-based models, this simplified notation is usually more convenient than the general one, even if the signaling network is highly branched and contains many scaffold proteins.</p></sec><sec><title>Summary</title><p>Modules are self-contained subsystems of a system that interact with other subsystems in a well-defined way. Species and macrostates are instances of molecule definitions which in turn define classes of species. Species can be microscopic species that correspond to a distinct modification of a chemical molecule or a complex. Species can also be macroscopic variables that correspond to sums of microscopic species. Macrostates are macroscopic variables that correspond to sums of species and whose hallmark is that they must contain at least one site modification 'X'. Patterns occurring in rules have the same notation as macrostates and define classes of species. Each species of such a class occurs in a separate reaction when the rule is evaluated. Following the simple notation of complexes, they are treated as species of one of the participating molecules or as species of newly defined molecules.</p></sec></sec><sec><title>Reactions and kinetics</title><sec><title>Mass action kinetics</title><p>If chemical systems are modeled at the molecular level, mass action kinetics are often a good description of the chemical processes [<xref ref-type="bibr" rid="B6">6</xref>] and are therefore frequently used. We use a representation of reaction equations which includes the dynamic information by adding the kinetic parameters of the reaction. In a reaction such as</p><p><disp-formula id="bmcM1"><label>(1)</label><italic>aA </italic>+ <italic>bB</italic>... &#x021cb; <italic>cC </italic>+ <italic>dD</italic>... &#x000a0;&#x000a0;&#x000a0;<italic>k</italic>1<italic>&#x000a0;&#x000a0;&#x000a0;k</italic>1<italic>d</italic></disp-formula></p><p><italic>A</italic>, <italic>B</italic>, <italic>C </italic>and <italic>D </italic>are the participating species and <italic>a</italic>, <italic>b</italic>, <italic>c </italic>and <italic>d </italic>are their stoichiometric coefficients. The kinetic parameters of the forward and backward reactions are <italic>k</italic>1 and <italic>k</italic>1<italic>d</italic>, respectively. According to the law of mass action [<xref ref-type="bibr" rid="B6">6</xref>], the reaction rate <italic>r </italic>for this reaction (Equation 1) is given as</p><p><disp-formula id="bmcM2"><label>(2)</label><italic>r </italic>= <italic>k</italic>1&#x000b7;<italic>A</italic><sup><italic>a</italic></sup>&#x000b7;<italic>B</italic><sup><italic>b</italic></sup>... - <italic>k</italic>1<italic>d</italic>&#x000b7;<italic>C</italic><sup><italic>c</italic></sup>&#x000b7;<italic>D</italic><sup><italic>d</italic></sup>...</disp-formula></p><p>where <italic>A</italic>, <italic>B</italic>, <italic>C </italic>and <italic>D </italic>are the concentrations of the corresponding species. Taking the stoichiometric coefficients as the exponents in the rate law is only justified if the system is homogeneous and if the mixture is ideal [<xref ref-type="bibr" rid="B6">6</xref>,<xref ref-type="bibr" rid="B7">7</xref>]. We will always assume that these assumptions are fulfilled.</p><p>Reactions may be irreversible which can be indicated by a reaction parameter that equals zero or a reaction symbol that indicates the direction of the reaction ('&#x02192;' or '&#x02190;' instead of '&#x021cb;'). In the latter case, only one kinetic parameter has to be given.</p></sec><sec><title>Generalized mass action kinetics</title><p>In the classical law of mass action for ideal mixtures, <italic>k</italic>1 and <italic>k</italic>1<italic>d </italic>are constants [<xref ref-type="bibr" rid="B6">6</xref>] which only depend on the temperature and on the pressure [<xref ref-type="bibr" rid="B7">7</xref>]. In the generalized law of mass action presented in [<xref ref-type="bibr" rid="B6">6</xref>], the constants <italic>k</italic>1 and <italic>k</italic>1<italic>d </italic>are multiplied by a common positive nonlinear function (that may also depend on concentrations of species). We use a generalized law of mass action that is more general where both reaction parameters may be general nonlinear functions.</p></sec><sec><title>Enzyme kinetics</title><p>Michaelis-Menten kinetics are a simplified formal description of enzyme activity that assumes an irreversible conversion of the substrate <italic>S </italic>to the product <italic>P </italic>[<xref ref-type="bibr" rid="B6">6</xref>,<xref ref-type="bibr" rid="B7">7</xref>]. A reaction following Michaelis-Menten kinetics can be formulated according to the generalized law of mass action</p><p><disp-formula id="bmcM3"><label>(3)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2" name="1752-0509-2-91-i2" overflow="scroll"><mml:semantics><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>S</mml:mi><mml:mo>&#x02192;</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>which leads to the reaction rate</p><p><disp-formula id="bmcM4"><label>(4)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M3" name="1752-0509-2-91-i3" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>&#x022c5;</mml:mo><mml:mfrac><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>Note that the power of <italic>S </italic>that is 'missing' in the numerator of the parameter expression in Equation 3 is re-introduced by building the rate law according to the generalized law of mass action (Equation 4). There exist several extension of Michaelis-Menten kinetics that can also be formulated by the generalized law of mass action [<xref ref-type="bibr" rid="B6">6</xref>].</p></sec></sec></sec><sec><title>Conventional modeling and its limitations</title><p>The conventional (mechanistic) modeling approach for biochemical networks is to define each chemical reaction by a reaction equation. A rate law has to be assigned for each reaction and one ODE is required for the balance of each microscopic species [<xref ref-type="bibr" rid="B6">6</xref>]. This approach is frequently applied in systems biology [<xref ref-type="bibr" rid="B8">8</xref>-<xref ref-type="bibr" rid="B17">17</xref>].</p><p>Conventional modeling is very powerful for small reaction systems however its limitations become clearly visible when considering systems with inherent combinatorial complexity. For these systems, the numbers of necessary reactions and ODEs are very high [<xref ref-type="bibr" rid="B2">2</xref>]. As an example, 1.5&#x000b7;10<sup>8 </sup>ODEs would be necessary to get a conventional model of the insulin signaling system [<xref ref-type="bibr" rid="B3">3</xref>]. Therefore, the modeling of systems with inherent combinatorial complexity is very difficult, or even impossible using the conventional modeling approach. A frequently used solution of this problem is to simplify the combinatorial variety by focusing on small subsets of the possible reactions and complexes. This method can work well and is often applied [<xref ref-type="bibr" rid="B8">8</xref>-<xref ref-type="bibr" rid="B15">15</xref>], but there are also cases in which the resulting models show poor accuracy when compared to a model which considers all possible complexes and reactions.</p><p>The reason for these differences in approximation quality is that it is very difficult to decide which reactions and complexes can be neglected and which cannot. Apparently well-founded assumptions may result in large approximation errors [<xref ref-type="bibr" rid="B5">5</xref>]. The structure of the reduced model (i.e. the decision of which species and reactions can be neglected; the assumed temporal order of the processes) depends on the parameter values of the reaction network [<xref ref-type="bibr" rid="B18">18</xref>]. However, these parameters are often not known and can only be estimated after the set-up of the model equations.</p><p>A few systematic approaches for the modeling of systems with inherent combinatorial complexity exist. In the following sections, first of all we outline the exact modeling techniques and then give an introduction to layer-based modeling; a recent approximative technique.</p></sec><sec><title>Rule-based modeling</title><p>A single molecular event, e.g the binding of an effector, is often described by a long list of reactions. Large subsets of these reactions or even all reactions are usually parameterized by the same kinetic constants. Such subsets can be represented using generalized reactions with patterns instead of species [<xref ref-type="bibr" rid="B2">2</xref>,<xref ref-type="bibr" rid="B19">19</xref>,<xref ref-type="bibr" rid="B20">20</xref>]. These generalized reactions are called rules and each of them represents a class of reactions that are parameterized by the same kinetic constants. In many cases, a relatively short list of rules is sufficient to describe the reactions of a signaling system. Software tools exist [<xref ref-type="bibr" rid="B20">20</xref>-<xref ref-type="bibr" rid="B26">26</xref>] which automatically generate the simulation files from a rule-based model definition.</p><p>We exemplify the usage of rules using a simple example. The following reactions represent ligand binding to a receptor that has an additional site which can be phosphorylated.</p><p><disp-formula id="bmcM5"><label>(5)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M4" name="1752-0509-2-91-i4" overflow="scroll"><mml:semantics><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>R</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:mi>L</mml:mi><mml:mo>&#x021cb;</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>k</mml:mi><mml:mn>1</mml:mn><mml:mi>d</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>R</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:mi>L</mml:mi><mml:mo>&#x021cb;</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>k</mml:mi><mml:mn>1</mml:mn><mml:mi>d</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>These reactions can be expressed by a single rule containing patterns on both sides.</p><p><disp-formula id="bmcM6"><label>(6)</label><italic>R</italic>[0, <italic>X</italic>] + <italic>L </italic>&#x021cb; <italic>R</italic>[<italic>L</italic>, <italic>X</italic>] <italic>k</italic>1 <italic>k</italic>1<italic>d</italic></disp-formula></p><p>Sites with a modification 'X' at the same position on both sides of the reaction equation correspond to each other. When rules are evaluated, the species in each reaction have the same modification at this site on both sides of the reaction equation.</p><p>Rules can also be parameterized by generalized mass actions kinetics in the same way as reactions. We give an example for enzyme kinetics of rules in the ALC user guide (Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>).</p><p>Altogether, rules highly simplify the model representation and the generation of the model equations. A major drawback of rule-based modeling is that the resulting model may be very large as one ODE is required for each feasible species. The concept of rules however, is very powerful and is also used in stochastic simulation, exact model reduction and layer-based modeling, all of which are introduced below.</p></sec><sec><title>Stochastic simulation</title><p>Chemical processes at the molecular level show a stochastic behavior which is described by the chemical master equation [<xref ref-type="bibr" rid="B27">27</xref>]. Approaches directly reflecting the stochasticity describe integer populations of distinct species and assign to each reaction a probability for its occurrence in a certain time interval. Software tools exist that allow for the stochastic simulation of a rule-based model [<xref ref-type="bibr" rid="B21">21</xref>-<xref ref-type="bibr" rid="B26">26</xref>].</p><p>There are two major approaches for the stochastic simulation; namely on-the-fly and generate-first [<xref ref-type="bibr" rid="B28">28</xref>]. The generate-first approach uses rules to define the total reaction network of the system which is used for the stochastic simulation. The on-the-fly approach allows for the reduction of the model size. During the simulation, all complexes are only balanced if they are populated. The reactions of the complexes are also only generated if their occurrence is possible, i.e. if the complexes that act as reactants are populated. The advantage of the reduced model size comes at the price of a high computational effort if many simulation runs are necessary, e.g. for parameter estimation.</p><p>We do not discuss the stochastic approaches in detail and focus on deterministic modeling using ODEs. This approach describes chemical processes well, if the number of molecules and the volume are large enough [<xref ref-type="bibr" rid="B27">27</xref>].</p></sec><sec><title>Exact model reduction</title><p>Exact model reduction aims to achieve a macroscopic description of biochemical systems. This is motivated by the view that domains (functional components of proteins) and not species are the fundamental elements of signal transduction [<xref ref-type="bibr" rid="B29">29</xref>]. State variables in exactly reduced models are macroscopic quantities, such as levels of occupancy or degrees of phosphorylation that represent the state of the domains. These macroscopic quantities are preserved in exactly reduced models. Information about all single species is usually not of interest and is no longer explicitly contained in the models. In the last few years, two exact techniques for the reduction of deterministic models have been developed [<xref ref-type="bibr" rid="B4">4</xref>,<xref ref-type="bibr" rid="B5">5</xref>].</p><p>Borisov et al. proposed the first exact approach to reduce the enormous amount of possible model equations [<xref ref-type="bibr" rid="B4">4</xref>]. The starting point is a rule-based model definition from which the reduced model is directly generated. However, the method only considers modularity within a single molecule with many sites. A major deficiency of this method is that the modularity of the entire reaction network cannot be considered. Therefore, this method is very valuable for describing complex formation at one large scaffold protein, however, it cannot be applied to many real signaling systems.</p><p>Conzelmann et al. [<xref ref-type="bibr" rid="B5">5</xref>] extended and generalized the approach by proposing an exact domain-oriented lumping technique which can be applied to a large class of systems. However, for the application of this method it is necessary to evaluate the rule-based model definition and to use a conventional ODE model as the starting point. The conventional ODE model (that can be very large) is subjected to a state space transformation which results in the exactly reduced model if the unobservable states are omitted. The formal reduction method presented by Conzelmann et al. [<xref ref-type="bibr" rid="B5">5</xref>] has recently been extended and improved [<xref ref-type="bibr" rid="B30">30</xref>,<xref ref-type="bibr" rid="B31">31</xref>]. The modified approach facilitates the generation of the exactly reduced model equations and does not require the former generation of a complete conventional model any more.</p><p>As in the approach of Borisov et al. [<xref ref-type="bibr" rid="B4">4</xref>], the performance of domain-oriented lumping [<xref ref-type="bibr" rid="B5">5</xref>,<xref ref-type="bibr" rid="B31">31</xref>] strongly depends on the interactions in the network. Enormous reduction is possible in some cases. In other cases no reduction is possible [<xref ref-type="bibr" rid="B3">3</xref>]. In many cases, the resulting reduced models still consist of too many ODEs for efficient simulation or analysis.</p></sec><sec><title>Layer-based modeling</title><p>Layer-based modeling allows for a macroscopic and highly reduced description of signaling systems [<xref ref-type="bibr" rid="B3">3</xref>]. A very convenient feature of layer-based modeling is that the reduced model can be directly obtained, which means in particular that the preceding generation of a conventional model is not necessary. The number of necessary ODEs in layer-based models is dramatically reduced. As an example, modeling of the insulin signaling system is possible with only 214 ODEs, instead of the 1.5&#x000b7;10<sup>8 </sup>needed when using conventional mechanistic modeling [<xref ref-type="bibr" rid="B3">3</xref>].</p><p>A graph of all processes and their interactions serves to define the modules that are called layers. The different layers are connected in a highly standardized way. They either exchange signals that correspond to macroscopic quantities, or they are not connected. No reaction proceeds across layer boundaries, therefore it is possible to model the layers separately from each other once their connections are defined. In special cases, a layer-based model exactly describes the dynamics of macroscopic quantities. In typical biochemical scenarios, it provides an approximative, but highly accurate description.</p><p>In this section, we give a detailed introduction to layer-based modeling. We start by introducing the concepts of processes and interactions necessary for the building of interaction graphs, which define the modularity of layer-based models. Afterwards we describe how the layers can be modeled and how their connections are defined. At the end of the introduction we discuss the mathematical background and the approximation quality of layer-based modeling.</p><sec><title>Processes</title><p>In combinatorial reaction networks, the same molecular event often occurs in many different reactions. The high number of reactions results from the high amount of different species that participate in the reactions. All reactions that describe the same molecular event define the corresponding process. As an example, all reactions that change a certain level of occupancy or degree of phosphorylation belong to the same process. Note that the inverse molecular event also belongs to the same process (e.g. the process effector binding also contains all reactions describing effector dissociation).</p><p>The reactions of a process may either be parameterized by the same or by different kinetic constants depending on the presence of process interactions.</p></sec><sec><title>Interactions</title><p>Interactions between processes result in different parameter values for different reactions of the same process. This means that the reactions of a process that is influenced by other processes are not parameterized by the same kinetic constants. If the reaction parameters of a process depend on a modification that is performed by another process, these two processes interact with each other. If reaction parameters of two processes do not depend on the other process, these two processes do not interact.</p><p>There exist three structurally different types of interactions between processes. They can interact via <italic>graded interactions</italic>, <italic>all-or-none interactions </italic>or they do <italic>not interact </italic>[<xref ref-type="bibr" rid="B3">3</xref>].</p><sec><title>Graded interaction</title><p>Processes that undergo graded interactions can influence each other in arbitrary ways. A typical case is the binding of a ligand that influences the kinetic parameters for receptor phosphorylation (Figure <xref ref-type="fig" rid="F1">1A</xref>). Graded interactions can be unidirectional or mutual. Therefore, receptor phosphorylation may, but does not have to influence the kinetic parameters for ligand binding. If each process is defined by two reactions, these four reactions can be arranged as a reaction cycle. If the processes are defined by more reactions, there are also more cycles.</p><fig position="float" id="F1"><label>Figure 1</label><caption><p><bold>Types of interactions between processes</bold>. Reactions are indicated by arrows. The reaction rate for each reaction is denoted as <italic>d</italic><sub><italic>i </italic></sub>and parameterized by <italic>k</italic><sub><italic>i </italic></sub>and <italic>k</italic><sub>-<italic>i</italic></sub>. A) Visualization of a graded interaction between the processes of <italic>L </italic>binding and <italic>D </italic>phosphorylation. The same scheme can be taken to demonstrate non-interacting processes. For non-interacting processes the parameter restrictions <italic>k</italic><sub>1 </sub>= <italic>k</italic><sub>3</sub>, <italic>k</italic><sub>-1 </sub>= <italic>k</italic><sub>-3</sub>, <italic>k</italic><sub>2 </sub>= <italic>k</italic><sub>4 </sub>and <italic>k</italic><sub>-2 </sub>= <italic>k</italic><sub>-4 </sub>hold. B) Visualization of an all-or-none interaction between the processes of binding site phosphorylation and <italic>E </italic>binding. <italic>E </italic>can only bind to phosphorylated sites, while the dephosphorylation of <italic>D </italic>is only possible in the absence of a bound effector. C) The cyclic reaction scheme degenerates to a reaction chain, as the species <italic>D</italic>[0, 0, <italic>E</italic>] does not exist. In this case, the notation can be simplified by describing binding site phosphorylation and <italic>E </italic>binding as modifications of the same site.</p></caption><graphic xlink:href="1752-0509-2-91-1"/></fig></sec><sec><title>All-or-none interaction</title><p>All-or-none interactions are a limiting case of graded interactions, where both processes can only occur under certain preconditions, provided by the other process. A typical case is the interaction of the processes of binding site phosphorylation and effector binding (Figure <xref ref-type="fig" rid="F1">1B</xref>). The effector can only bind if the binding site is phosphorylated. Additionally, the dephosphorylation of the binding site is only possible if the site is not occupied. A hallmark of all-or-none interactions is the degeneration of reaction cycles to reaction chains (Figure <xref ref-type="fig" rid="F1">1C</xref>).</p><p>Phosphorylation and effector binding are the most common examples of processes that undergo an all-or-none interaction. Such an interaction is also possible for other pairs of processes, e.g ligand binding and receptor dimerization (dimerization occurs only if the ligand is bound, ligand dissociation is only possible for monomers), or receptor dimerization and receptor phosphorylation (phosphorylation is only possible if the receptor is dimerized, dissociation is only possible if the receptor is unphosphorylated). To simplify the discussion, and without loss of generality, we will always assume that the processes that undergo all-or-none interactions are phosphorylations and effector bindings.</p></sec><sec><title>No interaction</title><p>The third type of interaction, also a limiting case of graded interactions, is that the processes do not interact. Kinetic parameters of each process are not influenced by the other process (Figure <xref ref-type="fig" rid="F1">1A</xref>).</p></sec></sec><sec><title>The interaction graph and layers</title><p>The interaction graph is a systematic visualization of the processes and their interactions. After identifying the processes and their interactions, building the interaction graph is the second step in layer-based modeling. In the interaction graph, the processes (represented by boxes) are connected by lines indicating their interactions. All-or-none interactions are represented by green lines, graded interactions are represented by red lines. A small example system (Figure <xref ref-type="fig" rid="F2">2</xref>) that is discussed below contains the following processes: ligand binding, binding site phosphorylation and effector binding. The interaction graph of this system is shown in Figure <xref ref-type="fig" rid="F3">3</xref>.</p><fig position="float" id="F2"><label>Figure 2</label><caption><p><bold>A conventional mechanistic representation of the example system</bold>. A receptor <italic>D </italic>has two sites and is defined as <monospace>D{0, L}{0, p, E}</monospace>. The first site is a binding site for the ligand <italic>L</italic>, the second is a binding site for the effector <italic>E </italic>that has to be phosphorylated before <italic>E </italic>can bind. Reactions are indicated by arrows. The reaction rate for each reaction is denoted as <italic>d</italic><sub><italic>i</italic></sub>.</p></caption><graphic xlink:href="1752-0509-2-91-2"/></fig><fig position="float" id="F3"><label>Figure 3</label><caption><p><bold>Interaction graph and modularization of the small example system</bold>. All processes (white boxes) that are coupled by graded interactions (red lines) are described in the same layer (blue boxes). Processes of different layers are only connected by all-or-none interactions (green lines) or do not interact.</p></caption><graphic xlink:href="1752-0509-2-91-3"/></fig><p>The third step in layer-based modeling consists of determining the modularity of the model from the interaction graph. All processes that are directly or indirectly connected by graded interactions form a module that is called layer. The set of these processes can be directly obtained from the interaction graph, as all processes that are connected by red lines (representing graded interactions) are to be described within the same layer. Note that layers may only contain a single process, and that there may be many layers. The connectivity of the layers is defined by all-or-none interactions between the processes of the different layers. After the definition of the connections, the layers are modeled independently from each other, as if all processes belonging to other layers do not exist.</p><p>In contrast to other modularization techniques [<xref ref-type="bibr" rid="B32">32</xref>-<xref ref-type="bibr" rid="B35">35</xref>] where the modularity is deduced from the entire model, layers can be modeled independently from each other once their connections are defined. This may give the impression that the user defines the modularity, however, the modularity is uniquely defined by the interaction pattern of the processes. Once the modeler has defined which processes interact in which way, they have only one way of influencing the modularity, which is to merge two or more layers into a larger one.</p></sec><sec><title>Mass flow and signal flow</title><p>In this subsection, we discuss the characteristics of mass flows and signal flows, and their occurrence in layer-based modeling. This helps in the understanding of basic principles of layer-based modeling, as the flows within layers and between layers are qualitatively different.</p><sec><title>Mass flow</title><p>Each reaction defines a transition between species whose quantity is given by the reaction rate. We refer to these transitions as mass flows. Mass flows occur within layers and do not cross layer boundaries. Note that fluxes without spatial direction (e.g. within a compartment) are also considered as mass flows.</p></sec><sec><title>Signal flow</title><p>Signal flows define information transfers. In contrast to mass flow, signal flow is not associated to reactions. In layer-based modeling, signal flows occur between layers and can be represented by macroscopic variables, usually sums of species with phosphorylated binding sites <italic>x</italic><sub><italic>i </italic></sub>and corresponding sums of species with occupied binding sites <italic>x</italic><sub><italic>i</italic></sub><italic>b</italic>. These signals are exchanged between layers containing processes that interact via all-or-none interactions. This will be discussed in detail below.</p></sec><sec><title>Flows and layers</title><p>Layers are either only connected by signal flows or are not connected at all. No mass flows cross layer boundaries as no reactions transport substance from one layer to the other. Within layers there are mass flows defined by reaction equations and the corresponding rates as in conventional modeling. The connections between layers show retroactivity [<xref ref-type="bibr" rid="B34">34</xref>] because the signal flow is bidirectional. However, changes in a layer (e.g. the introduction of an additional regulatory site) that do not affect the notation of <italic>x</italic><sub><italic>i </italic></sub>and <italic>x</italic><sub><italic>i</italic></sub><italic>b </italic>are usually not followed by changes in another layer. Therefore, the layers can be modeled separately from each other as long as the notations of the signal flows between the layers are defined.</p></sec></sec><sec><title>Modeling of layers</title><p>In the fourth step of layer-based modeling, the signal flows between the layers are defined and the layers are modeled separately from each other. Modeling within layers shows remarkable similarities to conventional modeling, however, there are differences that mainly result from the presence of all-or-none interactions between processes of different layers.</p><sec><title>Phosphorylation of binding sites</title><p>All-or-none interactions between binding site phosphorylations and the corresponding effector bindings bring much of the reduction potential of layer-based modeling. An all-or-none interaction implies that a phosphorylated binding site remains phosphorylated while the effector is bound, and that the effector binds only to phosphorylated binding sites. The phosphorylation of a binding site is often described in a different layer than the layer in which effector binding to the phosphorylated binding site is described. However, if there are graded interactions that connect the binding site phosphorylation and effector binding processes indirectly, these two processes have to be described in the same layer. It is obvious that the phosphorylation of binding sites to which effector binding is described in another layer has to be treated differently than the phosphorylation of regulatory sites or the phosphorylation of binding sites to which the effectors bind in the same layer.</p><p>To indicate the phosphorylation of a binding site to which the effector binds in another layer, the site notation (uppercase) 'P' is used. The phosphorylation of other sites can be indicated by other notations, e.g. (lowercase) 'p'. Species with a site modification (uppercase) 'P' comprise microscopic species with a phosphorylated but unoccupied binding site as well as microscopic species with a phosphorylated and occupied binding site.</p><p>Effector binding to phosphorylated binding sites in other layers does not directly change the concentration of species with a site modification 'P'. Therefore, layers only exchange signal flows and not mass flows across layer boundaries. The signal flows between the layers are used to guarantee that only unoccupied binding sites can be dephosphorylated (see below).</p></sec><sec><title>Reactions</title><p>The processes of each layer are described by reactions as if there were no other layers. Note that this also holds for the phosphorylation of binding sites to which effector binding is described in another layer. The sole difference is that the phosphorylation of binding sites to which the effectors bind in other layers has to be indicated by a site modification (uppercase) 'P'.</p><p>Effectors can only bind to a subset of phosphorylated binding sites, namely those that are not occupied. Effector binding to such a binding site in another layer is performed by introducing a new species that represents the sum of all microscopic species with phosphorylated but unoccupied binding sites. This new species acts as a binding partner for the effector and is defined by an algebraic equation. It is defined as the difference of the sum of species with phosphorylated binding sites <italic>x</italic><sub><italic>i </italic></sub>and the corresponding sum of species with occupied binding sites <italic>x</italic><sub><italic>i</italic></sub><italic>b</italic>. These sums define the signal flows between the layers and are discussed in the next paragraph.</p></sec><sec><title>Layer connections</title><p>For the realization of all-or-none interactions between two processes of different layers, signal flows have to be exchanged between the layers. These signal flows are typically defined by the sums of species with phosphorylated binding sites <italic>x</italic><sub><italic>i </italic></sub>and the corresponding sums of species with occupied binding sites <italic>x</italic><sub><italic>i</italic></sub><italic>b</italic>. Note that the signal flows <italic>x</italic><sub><italic>i </italic></sub>and <italic>x</italic><sub><italic>i</italic></sub><italic>b </italic>often correspond to experimental readouts. These signals are used to compute correction terms assuring that only unoccupied binding sites are dephosphorylated (see below, e.g. Equation 7). Their differences define the concentrations of binding partners for effectors whose binding site phosphorylations are described in different layers.</p></sec><sec><title>Rates and ODEs</title><p>Reaction rates are assigned to reactions as in conventional modeling. In most cases generalized mass action kinetics are used, however, the layer-based approach also allows for other kinetics. The sole exception from this analogy is the dephosphorylation of binding sites with a site modification 'P'. Without a special treatment of these dephosphorylation reactions, generalized mass action kinetics result in an overestimation of the rates for the dephosphorylation, as occupied binding sites are also dephosphorylated. Remember that the site modification 'P' represents the phosphorylation of a binding site without distinguishing if an effector is bound or not. Therefore, a correction term <italic>c</italic><sub><italic>i </italic></sub>has to be introduced for the dephosphorylation of each binding site with a modification 'P'.</p><p><disp-formula id="bmcM7"><label>(7)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M5" name="1752-0509-2-91-i5" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>It represents the fraction of species with phosphorylated binding sites that are not occupied. The need for these correction terms results from the loss of information and the corresponding reduction of the model size that is due to the modularization of the network. The correction terms always have the same structure, however, different <italic>x</italic><sub><italic>i </italic></sub>and the corresponding <italic>x</italic><sub><italic>i</italic></sub><italic>b </italic>are taken for each binding site.</p><p>The rate for each dephosphorylation reaction of a binding site with a site modification 'P' is multiplied by the appropriate <italic>c</italic><sub><italic>i </italic></sub>which guarantees that only unoccupied binding sites are dephosphorylated.</p><p>All dephosphorylation rates for a specific site with a modification 'P' are multiplied by the same <italic>c</italic><sub><italic>i</italic></sub>. The implicit assumption behind this is that all species with this phosphorylated binding site (that all count to the same <italic>x</italic><sub><italic>i</italic></sub>) have the same fraction of unoccupied phosphorylated binding sites. This is the core of the approximation and the reduction and results from the rapid equilibrium assumptions that are discussed in the mathematical background.</p><p>The ODEs are generated as they would be in conventional modeling. Note that no ODE is necessary for the binding partners in binding reactions that are defined by algebraic equations as differences of <italic>x</italic><sub><italic>i </italic></sub>and <italic>x</italic><sub><italic>i</italic></sub><italic>b</italic>. The sums <italic>x</italic><sub><italic>i </italic></sub>and <italic>x</italic><sub><italic>i</italic></sub><italic>b </italic>are also defined by algebraic equations.</p></sec><sec><title>A small example system</title><p>In a small example system that has already been intensively discussed [<xref ref-type="bibr" rid="B3">3</xref>], it is assumed that a receptor <italic>R </italic>has two sites. The first is a binding site for the ligand <italic>L</italic>, the second is a binding site for the effector <italic>E</italic>. This binding site has to be phosphorylated before <italic>E </italic>can bind. A conventional representation of this system is shown in Figure <xref ref-type="fig" rid="F2">2</xref>. To simplify the discussion, the receptor is denoted as <italic>D </italic>in the conventional <italic>detailed </italic>model and is denoted as <italic>R </italic>in the layer-based <italic>reduced </italic>model.</p><p>The processes of ligand binding and autophosphorylation perform a graded interaction (Figure <xref ref-type="fig" rid="F1">1A</xref>). In this special case, ligand binding stimulates the autophosphorylation, whereas the autophosphorylation does not influence ligand binding. The processes of autophosphorylation and effector binding undergo an all-or-none interaction (Figure <xref ref-type="fig" rid="F1">1B</xref>). Note that another reaction chain that is analogous to the one in Figure <xref ref-type="fig" rid="F1">1C</xref> and includes microscopic receptor species with a bound <italic>L </italic>exists.</p><p>The interaction graph of this system is shown in Figure <xref ref-type="fig" rid="F3">3</xref>. As all processes that are coupled by graded interactions belong to the same layer, the reduced model of the example system consists of two layers. The receptor layer describes the processes of ligand binding and receptor phosphorylation, the effector layer describes the process of effector binding. The reaction scheme of the reduced model is shown in Figure <xref ref-type="fig" rid="F4">4</xref>. The model equations of the receptor layer are</p><fig position="float" id="F4"><label>Figure 4</label><caption><p><bold>Layer-based reaction network of the example system</bold>. The receptor layer (left) describes the processes of ligand binding and receptor phosphorylation by two reactions each. The effector layer (right) describes the effector binding process by one reaction. The signals between the layers are the sum of species with a phosphorylated binding site <italic>x </italic>and the sum of species with an occupied binding site <italic>xb </italic>(which in this case is only the species RXE). Black arrows indicate reactions, green arrows indicate signal flows.</p></caption><graphic xlink:href="1752-0509-2-91-4"/></fig><p><disp-formula id="bmcM8a"><label>(8a)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M6" name="1752-0509-2-91-i6" overflow="scroll"><mml:semantics><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x022c5;</mml:mo><mml:mi>L</mml:mi><mml:mo>&#x022c5;</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mi>k</mml:mi><mml:mn>1</mml:mn><mml:mi>d</mml:mi><mml:mo>&#x022c5;</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x022c5;</mml:mo><mml:mi>L</mml:mi><mml:mo>&#x022c5;</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mi>k</mml:mi><mml:mn>1</mml:mn><mml:mi>d</mml:mi><mml:mo>&#x022c5;</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mn>2</mml:mn><mml:mo>&#x022c5;</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mi>k</mml:mi><mml:mn>2</mml:mn><mml:mi>d</mml:mi><mml:mo>&#x022c5;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x022c5;</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mn>3</mml:mn><mml:mo>&#x022c5;</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mi>k</mml:mi><mml:mn>3</mml:mn><mml:mi>d</mml:mi><mml:mo>&#x022c5;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>x</mml:mi><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x022c5;</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:semantics></mml:math></disp-formula></p><p><disp-formula id="bmcM8b"><label>(8b)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M7" name="1752-0509-2-91-i7" overflow="scroll"><mml:semantics><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:maligngroup/><mml:mrow><mml:mfrac><mml:mi>d</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mi>R</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:malignmark/><mml:mo>=</mml:mo><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:mrow><mml:mfrac><mml:mi>d</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mi>R</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:malignmark/><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:mrow><mml:mfrac><mml:mi>d</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mi>R</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:malignmark/><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:mrow><mml:mi>R</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:malignmark/><mml:mo>=</mml:mo><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>R</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:mrow><mml:mi>L</mml:mi><mml:malignmark/><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>where <italic>totR </italic>is the total concentration of the receptor. In this example, the concentration of the (extracellular) ligand <italic>L </italic>is set to the constant value 10.</p><p>Consider the correction term in the expression for dephosphorylation in the rates <italic>r</italic><sub>2 </sub>and <italic>r</italic><sub>3</sub>. The microscopic receptor species <italic>D</italic>[0, <italic>p</italic>] and <italic>D</italic>[<italic>L</italic>, <italic>p</italic>] (see Figure <xref ref-type="fig" rid="F2">2</xref>) are approximated from the species <italic>R</italic>[0, <italic>P</italic>] and <italic>R</italic>[<italic>L</italic>, <italic>P</italic>] using the correction term <italic>c </italic>= (<italic>x </italic>- <italic>xb</italic>)/<italic>x </italic>to guarantee that only unoccupied binding sites are dephosphorylated.</p><p><disp-formula id="bmcM9"><label>(9)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M8" name="1752-0509-2-91-i8" overflow="scroll"><mml:semantics><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>&#x02248;</mml:mo><mml:mfrac><mml:mrow><mml:mi>x</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>x</mml:mi><mml:mi>b</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:mfrac><mml:mo>&#x022c5;</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>&#x02248;</mml:mo><mml:mfrac><mml:mrow><mml:mi>x</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>x</mml:mi><mml:mi>b</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:mfrac><mml:mo>&#x022c5;</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>The model equations of the effector layer are</p><p><disp-formula id="bmcM10a"><label>(10a)</label><italic>r</italic><sub>4 </sub>= <italic>k</italic>4&#x000b7;<italic>RXp</italic>&#x000b7;<italic>E </italic>- <italic>k</italic>4<italic>d</italic>&#x000b7;<italic>RXE</italic></disp-formula></p><p><disp-formula id="bmcM10b"><label>(10b)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M9" name="1752-0509-2-91-i9" overflow="scroll"><mml:semantics><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:maligngroup/><mml:mrow><mml:mfrac><mml:mi>d</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mi>R</mml:mi><mml:mi>X</mml:mi><mml:mi>E</mml:mi><mml:malignmark/><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:mrow><mml:mi>R</mml:mi><mml:mi>X</mml:mi><mml:mi>p</mml:mi><mml:malignmark/><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>x</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:mrow><mml:mi>E</mml:mi><mml:malignmark/><mml:mo>=</mml:mo><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>E</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>R</mml:mi><mml:mi>X</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>where <italic>totE </italic>is the total concentration of the effector and <italic>RXp </italic>is a species that represents the sum of all microscopic receptor species with phosphorylated but unoccupied binding sites. The analogy to conventional modeling can be clearly seen in this layer as the reaction rate, the ODE and the conservation relation for the effector could also occur in a conventional model describing the association of two species. The signal flow between the layers is defined by <italic>x </italic>and <italic>xb</italic>, where x is the sum of species with phosphorylated binding sites and <italic>xb </italic>is the sum of species with occupied binding sites.</p><p><disp-formula id="bmcM11"><label>(11)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M10" name="1752-0509-2-91-i10" overflow="scroll"><mml:semantics><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>x</mml:mi><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mi>X</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>Equations 8 and 10 show that the layers can be modeled independently from each other as long as the connections between the layers (Equation 11) are defined.</p><p>Note that the letter 'X' only indicates a macrostate if it is a site configuration. In the species <italic>RXE </italic>and <italic>RXp</italic>, the 'X' is a part of the molecule name. Therefore, <italic>RXE </italic>and <italic>RXp </italic>are not macrostates. However, <italic>RXE </italic>represents the sum of all microscopic species where <italic>E </italic>is bound to the receptor, and <italic>RXp </italic>represents the sum of all microscopic species where the binding site is phosphorylated and not occupied. Therefore, both are macroscopic species.</p></sec><sec><title>Advanced strategies</title><p>Using the descriptions that have been provided above, it is possible to model a large class of systems by applying the step by step procedure below. Here we introduce advanced strategies that allow for an additional reduction of layer-based models. All strategies are exemplified by model definitions for ALC resulting in executable models (Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>).</p><sec><title>Equivalent binding sites</title><p>If <italic>n </italic>binding sites on a molecule are exactly equivalent and do not influence each other (and if this molecule is not an oligomer that can dissociate) it is sufficient to model only one binding site. Note that this holds only if the initial conditions of the degrees of phosphorylation are also identical.</p><p>In this case, the <italic>x</italic><sub><italic>i </italic></sub>for this binding site results from multiplying the sum of species with phosphorylated binding sites by <italic>n</italic>, e.g. <italic>x</italic><sub><italic>i </italic></sub>= <italic>n</italic>&#x000b7;<italic>R</italic>[<italic>P</italic>]. For linear phosphorylation or dephosphorylation kinetics, the rate law is equivalent to the case where each site is modeled separately. If the factor <italic>n </italic>is considered in the definition of <italic>x</italic><sub><italic>i </italic></sub>one needs not to consider this factor in any reaction. For nonlinear phosphorylation or dephosphorylation kinetics, e.g. Michaelis-Menten kinetics, <italic>n </italic>times the concentration of the corresponding species has to be used as the substrate concentration in the rate laws.</p><p><disp-formula id="bmcM12"><label>(12)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M11" name="1752-0509-2-91-i11" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>&#x022c5;</mml:mo><mml:mi>n</mml:mi><mml:mo>&#x022c5;</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#x022c5;</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>In addition, the total rate <italic>r</italic><sub><italic>tot </italic></sub>has to be divided by <italic>n </italic>because <italic>r</italic><sub><italic>tot </italic></sub>is the sum of the rates for all <italic>n </italic>sites and we only consider one of them.</p><p><disp-formula id="bmcM13"><label>(13)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M12" name="1752-0509-2-91-i12" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mi>n</mml:mi></mml:mfrac></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>The rate <italic>r </italic>describes the kinetics of the phosphorylation of <italic>R</italic>[0] to <italic>R</italic>[<italic>P</italic>]. According to the generalized law of mass action, the reaction and its parameterization is given as</p><p><disp-formula id="bmcM14"><label>(14)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M13" name="1752-0509-2-91-i13" overflow="scroll"><mml:semantics><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>R</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>&#x02192;</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#x022c5;</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>If it is desired to have a model output representing the sum of all phosphorylated binding sites (for both linear and nonlinear kinetics), the factor <italic>n </italic>has to be considered and the output is <italic>n</italic>&#x000b7;<italic>R</italic>[<italic>P</italic>].</p><p>Equivalent sites that are not binding sites and that do not influence each other can be treated in an analogous way. The reduction potential resulting from equivalent binding sites can be exploited to exactly reduce the model of insulin signaling with 214 ODEs [<xref ref-type="bibr" rid="B3">3</xref>] to 51 ODEs (Additional file <xref ref-type="supplementary-material" rid="S3">3</xref>).</p></sec><sec><title>One effector binding to different binding sites</title><p>This is highly related to the case above, but now <italic>m </italic>different binding sites (not necessarily belonging to the same molecule) are equivalent with respect to effector binding and may have different phosphorylation characteristics. A common <italic>x</italic><sub><italic>i </italic></sub>for all <italic>m </italic>binding sites can be used. This <italic>x</italic><sub><italic>i </italic></sub>equals the sum of all sums of species with phosphorylated binding sites for the effector, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M14" name="1752-0509-2-91-i14" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>. Note that species with <italic>j </italic>phosphorylated binding sites for the effector count <italic>j </italic>times in <italic>x</italic><sub><italic>i</italic></sub>. A frequent application of this is effector binding to a receptor <italic>R</italic><sub>1 </sub>that can dimerize to <italic>R</italic><sub>2</sub>. If the binding of <italic>E </italic>only depends on binding site phosphorylation, a common <italic>x</italic><sub><italic>i </italic></sub>can be used in the layer connections.</p><p><disp-formula id="bmcM15"><label>(15)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M15" name="1752-0509-2-91-i15" overflow="scroll"><mml:semantics><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:maligngroup/><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:malignmark/><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mn>1</mml:mn><mml:mo stretchy="false">[</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mn>2</mml:mn><mml:mo stretchy="false">[</mml:mo><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mn>2</mml:mn><mml:mo stretchy="false">[</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mi>b</mml:mi><mml:malignmark/><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:mrow><mml:mi>R</mml:mi><mml:mi>X</mml:mi><mml:mi>p</mml:mi><mml:malignmark/><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mi>b</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:semantics></mml:math></disp-formula></p><p><italic>RXp </italic>represents the sum of all phosphorylated but unoccupied binding sites on the dimers and monomers of the receptor. The Binding of <italic>E</italic>[0] to <italic>RXp </italic>leads to <italic>E</italic>[<italic>R</italic>].</p><p>The correction term <italic>c</italic><sub><italic>R </italic></sub>for the dephosphorylation of all these binding sites is the same and equals <italic>c</italic><sub><italic>R </italic></sub>= (<italic>x</italic><sub><italic>R </italic></sub>- <italic>x</italic><sub><italic>R</italic></sub><italic>b</italic>)/<italic>x</italic><sub><italic>R</italic></sub>. This corresponds to the assumption that the same fraction <italic>c</italic><sub><italic>R </italic></sub>of phosphorylated binding sites is occupied for all those sites with a site modification 'P'.</p><p>This strategy also prevents the danger of negative concentrations in the effector layers that may occur if e.g. receptor dimerization is faster than effector dissociation and <italic>R</italic><sub>1</sub>[<italic>P</italic>] rapidly 'vanishes' due to dimerization. In an example (where the actual advanced strategy is not applied) <italic>x</italic><sub><italic>R</italic>1 </sub>= <italic>R</italic>[<italic>P</italic>, <italic>X</italic>,...] is the sum of monomers with phosphorylated binding sites and the associated <italic>x</italic><sub><italic>R</italic>1</sub><italic>b </italic>represents all effectors that are bound to receptor monomers. Let the system be in a state where a large fraction of the binding sites is occupied, i.e. <italic>x</italic><sub><italic>R</italic>1 </sub>- <italic>x</italic><sub><italic>R</italic>1</sub><italic>b </italic>&#x02248; 0. Assume that an external stimulus induces the rapid dimerization of the receptor which rapidly lowers the value of <italic>x</italic><sub><italic>R</italic>1 </sub>because the dimers are not included in <italic>x</italic><sub><italic>R</italic>1</sub>. Note that the dimerization has no direct influence on <italic>x</italic><sub><italic>R</italic>1</sub><italic>b</italic>. Therefore, it is possible that the concentration of the species <italic>R</italic>1<italic>Xp </italic>= <italic>x</italic><sub><italic>R</italic>1 </sub>- <italic>x</italic><sub><italic>R</italic>1</sub><italic>b </italic>representing the concentration of the sum of unoccupied binding sites of the monomer becomes smaller than zero. As mentioned above, this problem can and should be avoided by using a common <italic>x</italic><sub><italic>i </italic></sub>for corresponding sites on the monomers and dimers.</p></sec><sec><title>Additional signals between layers</title><p>Additional signals between layers are allowed as long as no graded interactions are introduced by them. In a typical example, the processes of receptor activation and receptor phosphorylation are described in the receptor layer, whereas the binding and phosphorylation of effectors is described in different layers. The phosphorylation of effectors that are bound to receptors is performed by activated receptors. It is important that one specific activated receptor does not selectively phosphorylate effector molecules that are bound to it. This would introduce a graded interaction between the processes of receptor activation and effector phosphorylation and therefore destroy the modular structure of the model. Instead of this, it is advantageous to assume that the pool of activated receptors acts as an enzyme and phosphorylates receptor-bound effectors. In this case, the signal representing receptor activity can be transferred to the effector layers as an additional signal.</p><p>In general, the additional coupling between processes of different layers must occur in the form of a mean-field assumption. This means that the rate of an event in a downstream layer (e.g. effector phosphorylation) is proportional to the average value of some property computed from the upstream layer (e.g. receptor activation).</p></sec></sec><sec><title>Step by step procedure: layer-based modeling</title><p>This step by step procedure can be used for efficient and standardized layer-based modeling.</p><p>1. Identify all processes and their interactions.</p><p>2. Draw the interaction graph.</p><p>3. Deduce from the interaction graph how many layers are in the model and which processes form part of which layer. All processes that are coupled by graded interactions are part of the same layer. Processes of different layers are coupled by all-or-none interactions or do not interact.</p><p>4. Model each layer separately as if the processes of all other layers do not exist.</p><p>(a) Define rules and reactions, as in conventional modeling. The site modification (uppercase) 'P' is reserved for indicating the phosphorylation of binding sites to which effectors bind in other layers. A different notation (e.g. lowercase 'p') has to be used to indicate the phosphorylation of other sites.</p><p>(b) Define all sums of species with phosphorylated binding sites <italic>x</italic><sub><italic>i </italic></sub>and all sums of species with occupied binding sites <italic>x</italic><sub><italic>i</italic></sub><italic>b</italic>. This only has to be done for binding sites with a site modification 'P'. Note that <italic>x</italic><sub><italic>i</italic></sub><italic>b </italic>has the same notation as the corresponding <italic>x</italic><sub><italic>i</italic></sub>, followed by (lowercase) 'b'.</p><p>(c) Use algebraic equations to define the concentrations of the species that act as binding partners in effector binding to binding sites whose phosphorylation is described in other layers. These species are defined as differences of <italic>x</italic><sub><italic>i </italic></sub>and <italic>x</italic><sub><italic>i</italic></sub><italic>b</italic>.</p><p>(d) Assign a rate to each reaction, as in conventional modeling. A special case is the dephosphorylation of binding sites with a site modification (uppercase) 'P'. The rate expressions for these dephosphorylation reactions have to be multiplied by the appropriate correction term <italic>c</italic><sub><italic>i </italic></sub>= (<italic>x</italic><sub><italic>i </italic></sub>- <italic>x</italic><sub><italic>i</italic></sub><italic>b</italic>)/<italic>x</italic><sub><italic>i</italic></sub>. Using the correction terms <italic>c</italic><sub><italic>i </italic></sub>guarantees that the dephosphorylation is only possible for unoccupied binding sites.</p><p>(e) Conservation relations can be used to replace one ODE for each conserved moiety (e.g. a protein that is not degraded or synthesized).</p><p>(f) Use reactions and rates, as in conventional modeling, to build the ODEs for all species that are not defined by an algebraic equation.</p><p>(g) Assign initial conditions guaranteeing <italic>x</italic><sub><italic>i </italic></sub>&#x0003e; 0 (prevents division by zero) and <italic>x</italic><sub><italic>i </italic></sub>&#x02265; <italic>x</italic><sub><italic>i</italic></sub><italic>b </italic>&#x02200; <italic>i </italic>(prevents negative concentrations of binding partners).</p></sec><sec><title>Mathematical background</title><p>In the following subsection, we give an overview about the mathematical background of layer-based modeling. We do not recapitulate the detailed discussions provided elsewhere [<xref ref-type="bibr" rid="B3">3</xref>], but give the main results and some additional descriptive interpretations. Understanding the mathematical background is not necessary for layer-based modeling. Therefore, this subsection may be skipped if the reader is not interested in mathematical details.</p><p>We start the discussion by describing the rapid equilibrium assumption, which is an important part of the theoretical basis for the reduction potential of layer-based modeling.</p></sec><sec><title>Rapid equilibrium assumption</title><p>If in a reaction network</p><p><disp-formula id="bmcM16"><label>(16)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M16" name="1752-0509-2-91-i16" overflow="scroll"><mml:semantics><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>&#x02026;</mml:mo><mml:mo>&#x021cb;</mml:mo><mml:mi>S</mml:mi><mml:munderover><mml:mo>&#x021cb;</mml:mo><mml:mrow/><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mi>P</mml:mi><mml:mo>&#x021cb;</mml:mo><mml:mo>&#x02026;</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x022c5;</mml:mo><mml:mi>S</mml:mi><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#x022c5;</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>the parameters <italic>ki </italic>and <italic>k</italic><sub>-<italic>i </italic></sub>are much larger than the parameters of the remaining reactions, the quotient <italic>P</italic>/<italic>S </italic>will, initially after a short period of time, approximately equal the equilibrium constant [<xref ref-type="bibr" rid="B6">6</xref>].</p><p><disp-formula id="bmcM17"><label>(17)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M17" name="1752-0509-2-91-i17" overflow="scroll"><mml:semantics><mml:mrow><mml:mfrac><mml:mi>P</mml:mi><mml:mi>S</mml:mi></mml:mfrac><mml:mo>&#x02248;</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>This reaction is almost in equilibrium though a nonzero flux <italic>r</italic><sub><italic>i </italic></sub>goes through it. Equation 17 can be used to replace one ODE of the system. The resulting reduced model provides a good approximation of the dynamics after a short initial time span (or for all times if the initial conditions already fulfill Equation 17) [<xref ref-type="bibr" rid="B6">6</xref>].</p></sec><sec><title>Diagonal reactions</title><p>Layer-based modeling makes wide use of the rapid equilibrium assumption for processes of different layers that do not interact directly. We demonstrate this for the small example system (Figures <xref ref-type="fig" rid="F2">2</xref> and <xref ref-type="fig" rid="F4">4</xref>) where a reaction cycle is formed by the reactions describing the bindings of <italic>L </italic>and <italic>E </italic>to the phosphorylated receptor (Figure <xref ref-type="fig" rid="F5">5</xref>). There are four equilibrium conditions for this reaction cycle.</p><fig position="float" id="F5"><label>Figure 5</label><caption><p><bold>Equilibrium assumption and diagonal reaction</bold>. The diagonal reaction (Equation 21) whose equilibrium assumption is the basis for model reduction of the example system is symbolized in the middle of the reaction cycle.</p></caption><graphic xlink:href="1752-0509-2-91-5"/></fig><p><disp-formula id="bmcM18"><label>(18)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M18" name="1752-0509-2-91-i18" overflow="scroll"><mml:semantics><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>&#x022c5;</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>&#x022c5;</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>&#x022c5;</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>&#x022c5;</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>As the bindings of <italic>E </italic>and <italic>L </italic>do not interact directly (Figure <xref ref-type="fig" rid="F3">3</xref>), it holds that <italic>K</italic><sub>1 </sub>= <italic>K</italic><sub>2 </sub>and <italic>K</italic><sub>3 </sub>= <italic>K</italic><sub>4 </sub>which reduces the number of independent equations to three. One of these three independent equations which results from the division of the first equation by the second or from the division of the third equation by the fourth is</p><p><disp-formula id="bmcM19"><label>(19)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M19" name="1752-0509-2-91-i19" overflow="scroll"><mml:semantics><mml:mrow><mml:mfrac><mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>which implies that the processes of <italic>L </italic>binding and <italic>E </italic>binding are completely independent. However, this is an approximation as there is an indirect interaction between these processes (Figure <xref ref-type="fig" rid="F3">3</xref>) that results in (dynamic) deviations from Equation 19.</p><p>Equation 19 can be rewritten as</p><p><disp-formula id="bmcM20"><label>(20)</label><italic>D</italic>[0, <italic>p</italic>]&#x000b7;<italic>D</italic>[<italic>L</italic>, <italic>E</italic>] - <italic>D</italic>[<italic>L</italic>, <italic>p</italic>]&#x000b7;<italic>D</italic>[0, <italic>E</italic>] = 0.</disp-formula></p><p>This corresponds to a rapid equilibrium assumption for the reaction</p><p><disp-formula id="bmcM21"><label>(21)</label><italic>D</italic>[0, <italic>p</italic>] + <italic>D</italic>[<italic>L</italic>, <italic>E</italic>] &#x021cb; <italic>D</italic>[<italic>L</italic>, <italic>p</italic>] + <italic>D</italic>[0,<italic>E</italic>]</disp-formula></p><p>which is not part of the reaction scheme (Figure <xref ref-type="fig" rid="F2">2</xref>) and where the equilibrium constant equals one. This reaction fills the diagonals of the square representing the reaction cycle (Figure <xref ref-type="fig" rid="F5">5</xref>). Therefore, we refer to this kind of fast virtual reaction as a diagonal reaction.</p><p>Assuming that the two processes are indeed independent, the equations following from the calculus of probability as discussed by Borisov et al. [<xref ref-type="bibr" rid="B4">4</xref>] can be transformed to Equation 20 which leads to a different interpretation of the same equations [<xref ref-type="bibr" rid="B3">3</xref>].</p><p>As Equation 20 is only one of three equilibrium conditions, assuming equilibrium for the diagonal reaction is a weaker assumption than assuming equilibrium for the whole reaction cycle.</p><p>The approximation in layer-based modeling is based on the (implicit) equilibrium assumption for diagonal reactions connecting processes of different layers that do not interact directly. Note that such diagonal reactions can connect more than two processes (for an example see Additional file <xref ref-type="supplementary-material" rid="S4">4</xref>, p.3 in [<xref ref-type="bibr" rid="B3">3</xref>]). Each such equilibrium assumption reduces the number of necessary ODEs by one.</p></sec><sec><title>Non-uniqueness of diagonal reactions</title><p>The list of diagonal reactions is not unique. In almost all larger models there are several conditions such as Equation 19, which leads to</p><p><disp-formula id="bmcM22"><label>(22)</label><italic>q</italic><sub>1 </sub>= <italic>q</italic><sub>2 </sub>= ... = <italic>q</italic><sub><italic>n</italic></sub></disp-formula></p><p>where <italic>q</italic><sub><italic>i </italic></sub>are quotients of microscopic species of the conventional model (see again Additional file <xref ref-type="supplementary-material" rid="S4">4</xref>, p.3 in [<xref ref-type="bibr" rid="B3">3</xref>]). Equation 22 provides <italic>n </italic>- 1 independent equations. It can be easily seen that the list of the corresponding diagonal reactions depends on the choice of the <italic>n </italic>- 1 independent equations that result from Equation 22. However, the set of microscopic species connected by the diagonal reactions is unique.</p></sec><sec><title>Approximation quality</title><p>We introduce a measure for the approximation error <italic>g </italic>as the deviation from Equation 20.</p><p><disp-formula id="bmcM23"><label>(23)</label><italic>D</italic>[0, <italic>p</italic>]&#x000b7;<italic>D</italic>[<italic>L</italic>, <italic>E</italic>] - <italic>D</italic>[<italic>L</italic>, <italic>p</italic>]&#x000b7;<italic>D</italic>[0, <italic>E</italic>] = <italic>g</italic></disp-formula></p><p>The error <italic>g</italic>(<italic>t</italic>) quantifies the distance of the diagonal reaction (Equation 21, Figure <xref ref-type="fig" rid="F5">5</xref>) from equilibrium. It follows a first order ODE</p><p><disp-formula id="bmcM24"><label>(24)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M20" name="1752-0509-2-91-i20" overflow="scroll"><mml:semantics><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x022c5;</mml:mo><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>with <italic>a</italic>(<italic>t</italic>) = <italic>k</italic>1&#x000b7;<italic>L </italic>+ <italic>k</italic>1<italic>d </italic>+ <italic>k</italic>4&#x000b7;<italic>E </italic>+ <italic>k</italic>4<italic>d </italic>and <italic>u</italic>(<italic>t</italic>) = <italic>d</italic><sub>2</sub>&#x000b7;<italic>D</italic>[<italic>L</italic>, <italic>E</italic>] - <italic>d</italic><sub>4</sub>&#x000b7;<italic>D</italic>[0, <italic>E</italic>], that gives the analytical solution</p><p><disp-formula id="bmcM25"><label>(25)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M21" name="1752-0509-2-91-i21" overflow="scroll"><mml:semantics><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:maligngroup/><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:malignmark/><mml:mo>=</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:munderover><mml:mo>&#x0222b;</mml:mo><mml:mn>0</mml:mn><mml:mi>t</mml:mi></mml:munderover><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mi>u</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>&#x003c4;</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:mrow><mml:mi>A</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:malignmark/><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:munderover><mml:mo>&#x0222b;</mml:mo><mml:mn>0</mml:mn><mml:mi>t</mml:mi></mml:munderover><mml:mrow><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>&#x003c4;</mml:mi></mml:mrow></mml:mrow></mml:mstyle><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>Note that <italic>A</italic>(<italic>t</italic>) = <italic>a</italic>&#x000b7;<italic>t </italic>if <italic>a</italic>(<italic>t</italic>) &#x02261; <italic>a</italic>. For <italic>u</italic>(<italic>t</italic>) &#x02265; 0, <italic>a</italic>(<italic>t</italic>) &#x0003e; 0 &#x02200; <italic>t </italic>and <italic>g</italic><sub>0 </sub>&#x02265; 0, an upper bound for the dynamical error is given by</p><p><disp-formula id="bmcM26"><label>(26)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M22" name="1752-0509-2-91-i22" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02264;</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>&#x022c5;</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>&#x022c5;</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>&#x022c5;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>&#x022c5;</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>Where</p><p><disp-formula id="bmcM27"><label>(27)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M23" name="1752-0509-2-91-i23" overflow="scroll"><mml:semantics><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:maligngroup/><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:malignmark/><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi>max</mml:mi><mml:mo>&#x02061;</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:munder><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:malignmark/><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x022c5;</mml:mo><mml:munder><mml:mrow><mml:mi>min</mml:mi><mml:mo>&#x02061;</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:munder><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mn>1</mml:mn><mml:mi>d</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mn>4</mml:mn><mml:mo>&#x022c5;</mml:mo><mml:munder><mml:mrow><mml:mi>min</mml:mi><mml:mo>&#x02061;</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:munder><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mn>4</mml:mn><mml:mi>d</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:malignmark/><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x022c5;</mml:mo><mml:munder><mml:mrow><mml:mi>max</mml:mi><mml:mo>&#x02061;</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:munder><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mn>1</mml:mn><mml:mi>d</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mn>4</mml:mn><mml:mo>&#x022c5;</mml:mo><mml:munder><mml:mrow><mml:mi>max</mml:mi><mml:mo>&#x02061;</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:munder><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mn>4</mml:mn><mml:mi>d</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>A very important result from Equation 26 is that the approximation error declines and is bounded because <italic>u</italic>(<italic>t</italic>) is bounded from above and <italic>a</italic>(<italic>t</italic>) is bounded from both below and above. Similar expressions to Equation 26 can be given for <italic>u</italic>(<italic>t</italic>) &#x02264; 0 and <italic>g</italic><sub>0 </sub>&#x02264; 0.</p><p>There is one error equation (with <italic>g</italic><sub><italic>i</italic></sub>, <italic>a</italic><sub><italic>i </italic></sub>and <italic>u</italic><sub><italic>i</italic></sub>) as Equation 24 for each diagonal reaction. In the most simple case, <italic>a</italic><sub><italic>i </italic></sub>equals the sum of the four kinetic parameters of the reaction cycle. In each case, <italic>a</italic><sub><italic>i </italic></sub>is large if the reaction parameters in the corresponding cycle are large and <italic>u</italic><sub><italic>i </italic></sub>is a weighted sum of external fluxes (that can be positive or negative) entering the reaction cycle. When unbalanced (<italic>u</italic><sub><italic>i</italic></sub>(<italic>t</italic>) &#x02260; 0), these incoming fluxes can lead to fluxes through the diagonal reaction that lower the approximation quality.</p><p>All <italic>u</italic><sub><italic>i</italic></sub>(<italic>t</italic>) vanish in thermodynamic equilibrium or in the absence of graded interactions. Therefore, layer-based modeling provides an <italic>exactly reduced model </italic>if there are no graded interactions (i.e. if all processes are connected by all-or-none interactions or do not interact) or if the layers containing graded interactions are not coupled to the other layers. In both cases, the initial conditions of the corresponding conventional model have to fulfill the equilibrium conditions for the diagonal reactions (e.g. Equation 20). If they do not, the approximation is only <italic>stationarily exact</italic>.</p><p>The approximation is also stationarily exact if all fluxes vanish in the stationary case, i.e. if the system reaches thermodynamic equilibrium. Note that a system is able to reach thermodynamic equilibrium if the Wegscheider condition [<xref ref-type="bibr" rid="B6">6</xref>] is fulfilled for the entire reaction network and if no species or fluxes are set to a constant value (or follow an externally imposed trajectory). Another possibility for stationary exactness is the presence of a stationary flux distribution, characterized by <italic>u</italic><sub><italic>i</italic></sub>(<italic>t</italic>) &#x02261; 0 &#x02200; <italic>i </italic>even if the system does not reach equilibrium.</p><p>In all other cases, layer-based modeling is a purely <italic>approximative </italic>method. However, for typical scenarios the approximation error is very low. We showed this for an example system where parameter variations of four orders of magnitude around values from literature were not able to cause a low approximation quality [<xref ref-type="bibr" rid="B3">3</xref>].</p></sec><sec><title>Evaluation of the approximation quality</title><p>Up until now there has been no easy method to quantify the approximation error of large layer-based models. A very laborious method (which is not applicable for very large systems) is to build the conventional model and compare typical simulation results for macroscopic variables. Another method which also needs to simulate the corresponding conventional model is to check all errors <italic>g</italic><sub><italic>i</italic></sub>. If all <italic>g</italic><sub><italic>i </italic></sub>decline rapidly, the approximation quality is high. However, a large error for some <italic>g</italic><sub><italic>i </italic></sub>(e.g. Equation 23) is not a direct evidence for poor approximation quality. If a state variable that is approximated by an equilibrium assumption for a diagonal reaction (as Equation 20) has only little influence on the state variables of the layer-based model, even a large error <italic>g</italic><sub><italic>i </italic></sub>will not result in a large approximation error. This depends on the observability of this state variable, which is difficult to quantify and discussed elsewhere [<xref ref-type="bibr" rid="B36">36</xref>]. We recommend that more qualitative checks, described below, be performed in order to assess the approximation quality.</p><p>In the typical case, effector binding and the corresponding binding site phosphorylation are described in different layers. If the binding of the effector is relatively fast (as the binding of most effectors is) the approximation quality is usually high. If there are fast processes in the layer describing the binding site phosphorylation that connect all or most of the different phosphorylated species, the approximation quality is usually high as well. High parameter values for these fast processes result in high values of the exponents <italic>a</italic><sub><italic>i </italic></sub>and therefore in a high approximation quality (Equation 26). The process of ligand binding is a candidate for such a fast process in the example system (Figure <xref ref-type="fig" rid="F4">4</xref>).</p><p>If the binding of an effector is slow, it should be considered to merge the layers describing this effector binding and the corresponding binding site phosphorylation to a single one. In this case, the erroneous equilibrium assumptions for the slow process are not introduced and do not lead to an approximation error (but do also not contribute to the model reduction).</p><p>If one is not sure about the approximation quality resulting from certain parameter combinations, one could build a conventional model of a subsystem comprising the processes belonging to the considered parameters and all processes that directly or indirectly interact with them via graded interactions. The approximation error can be analyzed quantitatively for the comparison of simulation results for macroscopic quantities of the conventional subsystem with those of a corresponding layer-based model.</p><p>This can be done for different constant input signals <italic>x</italic><sub><italic>i </italic></sub>and all <italic>x</italic><sub><italic>j</italic></sub><italic>b </italic>(<italic>i </italic>&#x02260; <italic>j</italic>) entering the model from the environment set to zero. The initial conditions of the conventional model have to be set such that the effect of the external (constant) <italic>x</italic><sub><italic>i </italic></sub>entering the system is mirrored adequately. If the approximation quality is high, the analysis can be extended to time-variant input signals</p><p><disp-formula id="bmcM28"><label>(28)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M24" name="1752-0509-2-91-i24" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:munderover><mml:mo>&#x0222b;</mml:mo><mml:mn>0</mml:mn><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>guaranteeing <italic>x</italic><sub><italic>i </italic></sub>&#x02265; <italic>x</italic><sub><italic>i</italic></sub><italic>b </italic>&#x02200; <italic>i</italic>. External fluxes <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M25" name="1752-0509-2-91-i25" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> that reflect the changes in <italic>x</italic><sub><italic>i </italic></sub>have to be included in the conventional model. These fluxes <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M26" name="1752-0509-2-91-i25" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> add or remove the corresponding species with phosphorylated and unoccupied binding sites from the conventional model. Note that this species is defined by <italic>x</italic><sub><italic>i </italic></sub>- <italic>x</italic><sub><italic>i</italic></sub><italic>b </italic>in the layer-based model. The velocity with which a certain <italic>x</italic><sub><italic>i </italic></sub>may change depends on the kinetic parameters for phosphorylation and dephosphorylation of the corresponding binding site.</p></sec><sec><title>Reduction of the model size</title><p>A typical situation in cellular signaling is that there are multiple sites within the same protein. In this case, the size of the conventional model is a product of the number of states of each site, where each possible state of a binding partner must be considered as a separate state of the site. In the layer-based model, however, each binding site that is phosphorylated has only two states (unphosphorylated and phosphorylated). The states of the binding partner are modeled in a separate module (layer) and do not increase the number of states of the original protein. Another typical case is that binding partners are phosphorylated on binding sites and bind other effectors. In this case, the argumentation above can be applied to each additional effector in such an association chain.</p><p>The exponential growth of the number of state variables with the number of binding sites and binding partners in conventional models is partly replaced by linear growth with the number of layers. Within the layers there is still exponential growth with respect to the number of molecular sites included in the layer. Both scenarios mentioned above lead to implicitly assumed equilibrium conditions for diagonal reactions in layer-based models. Each such equilibrium condition reduces the number of ODEs by one. In the small example system, one diagonal reaction (Equation 21) is assumed to be in equilibrium (Equation 20), which reduces the number of ODEs by one compared to a conventional model.</p></sec><sec><title>Stochastic simulation of layer-based models</title><p>Layer-based modeling has been introduced as a technique for deterministic modeling [<xref ref-type="bibr" rid="B3">3</xref>]. However, stochastic simulation of layer-based models is in principle possible.</p><p>A general problem in using stochastic simulation tools for layer-based models is that there are species that are defined by algebraic assignments. Additionally, it is crucial that the reaction parameters are allowed to be functions of species which becomes apparent when considering the correction terms. Therefore, only simulators can be used that support algebraic assignments and flexible parameter formats. Note that correcting the reaction parameters by the molecular weight of complexes (as is proposed for Moleculizer [<xref ref-type="bibr" rid="B24">24</xref>]) is not applicable for layer-based models as this information is not contained in layer-based models, due to the modularization.</p></sec></sec></sec><sec><title>Implementation</title><p>ALC is a computer program that converts model definitions for layer-based models into model files in different formats as well as into documentation files. Its intuitive syntax is simple but powerful and supports the concepts of rules, macrostates and modularity.</p><p>ALC can be used offline or via a form on the ALC website [<xref ref-type="bibr" rid="B37">37</xref>]. ALC performs detailed consistency checks on the model definition. These checks result in informative error messages and warnings ensuring that most errors are easy to find and easy to correct. The output files of ALC are ready-to-run simulation files in the formats C MEX, MATLAB (The MathWorks), <italic>Mathematica </italic>(Wolfram Research) and SBML [<xref ref-type="bibr" rid="B38">38</xref>]. ALC also provides the model in LATEX [<xref ref-type="bibr" rid="B39">39</xref>,<xref ref-type="bibr" rid="B40">40</xref>] and plain text format to simplify its publication or presentation.</p><sec><title>Architecture</title><p>ALC is written in the programming language Perl [<xref ref-type="bibr" rid="B41">41</xref>,<xref ref-type="bibr" rid="B42">42</xref>]. When used offline, the model definition is read in by the script file <monospace>ALC.pl</monospace> which also starts the modeling procedure. The source code necessary for the generation of output files is organized in three separate Perl modules. The Perl module <monospace>Procedures.pm</monospace> contains procedures that guide the application through the general steps of the model generation process. The Perl module <monospace>Functions.pm</monospace> contains functions that are called by the procedures from the module <monospace>Procedures.pm</monospace> and functions that are called by other functions from the same module. The Perl module <monospace>Output.pm</monospace> contains procedures that generate all output files after the model generation process is finished. The form on the ALC website [<xref ref-type="bibr" rid="B37">37</xref>] is linked to a Perl CGI script that is running on an Apache web server [<xref ref-type="bibr" rid="B43">43</xref>]. This CGI script extracts the model definition from the uploaded model definition file or from the text field in which the model definition was pasted and starts the model generation. It also displays the results and provides the download links for the output files. The model generation and the generation of the output files is performed by the same Perl modules that are used offline.</p><p>The most important steps in the generation of the output files from the model definition and the assignment of these steps to procedures of the Perl module <monospace>Procedures.pm</monospace> are shown in more detail as a flow diagram in Figure <xref ref-type="fig" rid="F6">6</xref>.</p><fig position="float" id="F6"><label>Figure 6</label><caption><p><bold>Flow diagram of ALC</bold>. The green boxes represent the different possibilities when starting ALC. The gold boxes represent procedures of ALC (stored in the Perl module <monospace>Procedures.pm</monospace>) that initiate the general processes from reading in the model definition to generating the finished model files. The red arrows represent the input and the output of the procedures. A short description of the processes that are initiated by the procedures is given in the cyan boxes. The white boxes define the principle class of the output files, while the magenta boxes define the format of the output files.</p></caption><graphic xlink:href="1752-0509-2-91-6"/></fig></sec><sec><title>Constructing the model definition</title><p>The model definition is constructed in plain text and consists of distinct sections that are encapsulated by <monospace>#name</monospace> and <monospace>#end name</monospace>, where 'name' is the name of the section. All sections may occur as often as desired in the model definition. Therefore, each layer can be defined separately, supporting the modular structure of layer-based models (see e.g. Equations 8 and 10).</p><p>The layer-based model definition for the example system (Figure <xref ref-type="fig" rid="F4">4</xref>) is shown in Figure <xref ref-type="fig" rid="F7">7</xref>. Model definitions for other example systems, including the model definition for the layer-based model of insulin signaling with 214 ODEs [<xref ref-type="bibr" rid="B3">3</xref>] and its exact reduction to 51 ODEs (which is possible if some binding sites are equivalent) can be found in Additional file <xref ref-type="supplementary-material" rid="S3">3</xref>.</p><fig position="float" id="F7"><label>Figure 7</label><caption><p><bold>Model definition for the example system</bold>. Default values are assigned for all initial conditions and parameters that are not given. These default values can be freely chosen. Note that <italic>x </italic>&#x02265; <italic>xb </italic>and <italic>x </italic>&#x0003e; 0 hold for the initial conditions of the example system when using the standard default values (see ALC user guide). When running the C MEX, MATLAB and <italic>Mathematica </italic>models, the simulation results for <italic>R</italic>[<italic>L</italic>, <italic>X</italic>] and <italic>RXE </italic>are visualized as they are defined as outputs. <italic>RXp</italic>, <italic>x </italic>and <italic>xb </italic>are also visualized as this is automatically done for all variables that are defined in the section <monospace>#layer connections</monospace>.</p></caption><graphic xlink:href="1752-0509-2-91-7"/></fig><p>The syntax of ALC and the distinct sections are briefly introduced below. Detailed descriptions can be found in the ALC user guide (Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). A tutorial demonstrates the generation of the model definition for an example system in detail (Additional file <xref ref-type="supplementary-material" rid="S4">4</xref>).</p><sec><title>The section '#molecules'</title><p>All molecule definitions are given in the section <monospace>#molecules</monospace> (Figure <xref ref-type="fig" rid="F7">7</xref>). A molecule definition consists of the molecule name that is optionally followed by the successive definition of all sites. The molecule name has to start with a capital letter which is optionally followed by an arbitrary sequence of alphanumeric symbols (letters, digits and underscores are allowed). Each site definition consists of a comma-separated sequence of all possible modifications which is encapsulated by curly brackets. A site modification is defined by a sequence of alphanumeric symbols. The definition of a site modification 'X' is forbidden, since 'X' is reserved for indicating macrostates and patterns. A site modification 'P' has a predefined meaning. It marks the site as a binding site to which effector binding is described in another layer. In this case, 'P' indicates the phosphorylated state.</p><p>As an example, a molecule definition <monospace>R{0, L}{0, P}</monospace> defines the molecule <italic>R </italic>that can have the modifications '0' and 'L' at the first site and the modifications '0' and 'P' at the second site. If a molecule is defined, its instances (e.g. species like <italic>R</italic>[<italic>L</italic>, 0] or macrostates like <italic>R</italic>[<italic>X</italic>, <italic>P</italic>]) can be used in other sections of the model definition.</p></sec><sec><title>Complexes</title><p>ALC only supports the simple notation of complexes introduced above. Complexes of species can be treated as species of one of the corresponding molecule definitions, or as species of new molecules that are defined for complexes of the molecules. As an example, the species <italic>R</italic>[<italic>L</italic>, 0] is the complex of the species <italic>L </italic>and <italic>R</italic>[0, 0] as this is already contained in the molecule definition <monospace>R{0, L}{0, P}</monospace>, whereas the dimer of <monospace>R{0, L}{0, P}</monospace> has to be explicitly defined, e.g. as <monospace>R2{0, L}{0, P}{0, L}{0, P}</monospace>.</p></sec><sec><title>The section '#reactions'</title><p>All rules and reactions are defined in the section <monospace>#reactions</monospace> (Figure <xref ref-type="fig" rid="F7">7</xref>). The standard format of a rule or reaction is: chemical reaction equation, tab, parameter of the forward reaction, tab, parameter of the backward reaction.</p><p><disp-formula id="bmcM29"><label>(29)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M27" name="1752-0509-2-91-i26" overflow="scroll"><mml:semantics><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;</mml:mo><mml:mover><mml:mover><mml:mrow/><mml:mo stretchy="true">&#x0fe37;</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:mover></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;</mml:mo><mml:mover><mml:mover><mml:mrow/><mml:mo stretchy="true">&#x0fe37;</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:mover></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:munder><mml:munder><mml:mrow><mml:mtext>aA</mml:mtext><mml:mo>+</mml:mo><mml:mtext>bB</mml:mtext><mml:mo>&#x0003c;</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mo>&#x0003e;</mml:mo><mml:mtext>cC</mml:mtext><mml:mo>+</mml:mo><mml:mtext>dD</mml:mtext></mml:mrow><mml:mo stretchy="true">&#x0fe38;</mml:mo></mml:munder><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mtext>&#x000a0;</mml:mtext><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mi>u</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:munder></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:munder><mml:munder><mml:mrow><mml:mtext>parameter</mml:mtext></mml:mrow><mml:mo stretchy="true">&#x0fe38;</mml:mo></mml:munder><mml:mrow><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>w</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:munder></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:munder><mml:munder><mml:mrow><mml:mtext>parameter</mml:mtext></mml:mrow><mml:mo stretchy="true">&#x0fe38;</mml:mo></mml:munder><mml:mrow><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>k</mml:mi><mml:mi>w</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:munder></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:semantics></mml:math></disp-formula></p><p>The reaction symbol is '&#x0003c;-&#x0003e;' for reversible reactions and '-&#x0003e;' or '&#x0003c;-' for irreversible reactions. For irreversible reactions only one parameter has to be given. ALC builds the corresponding rates following the generalized law of mass action where the parameters can be general nonlinear functions.</p><p>If a reaction describes the transition of a site modification 'P' to anything but 'P' (i.e. the dephosphorylation of a binding site to which effector binding is described in another layer), the reaction rate has to be modified using a correction term <italic>c</italic><sub><italic>i</italic></sub>.</p><p>To guarantee that only the unoccupied fraction of binding sites with a site modification 'P' becomes dephosphorylated, ALC automatically searches the corresponding <italic>x</italic><sub><italic>i </italic></sub>and <italic>x</italic><sub><italic>i</italic></sub><italic>b </italic>in the model definition, builds the appropriate <italic>c</italic><sub><italic>i </italic></sub>= (<italic>x</italic><sub><italic>i </italic></sub>- <italic>x</italic><sub><italic>i</italic></sub><italic>b</italic>)/<italic>x</italic><sub><italic>i </italic></sub>and considers <italic>c</italic><sub><italic>i </italic></sub>in the rate laws for dephosphorylation. As the correction terms <italic>c</italic><sub><italic>i </italic></sub>in the reaction rates are automatically assigned by ALC, one need not include them in the reaction parameters. The algorithm for this assignment is described below.</p></sec><sec><title>The section '#layer connections'</title><p>The signal flow between the layers is defined in the section <monospace>#layer connections</monospace> (Figure <xref ref-type="fig" rid="F7">7</xref>). Notations of the sums of species with a phosphorylated binding site <italic>x</italic><sub><italic>i </italic></sub>have to start with a lowercase 'x' and are optionally followed by a sequence of letters and digits. Notations of the sums of species with occupied binding sites <italic>x</italic><sub><italic>i</italic></sub><italic>b </italic>start with the notation of the corresponding <italic>x</italic><sub><italic>i </italic></sub>and end with a lowercase 'b'. Note that notations of <italic>x</italic><sub><italic>i </italic></sub>are not allowed to end with a lowercase 'b'.</p><p>The phosphorylation of binding sites (site modification 'P') and the corresponding effector bindings are described in different layers. In this case, the binding partners for the effectors are defined by algebraic equations, typically as differences of <italic>x</italic><sub><italic>i </italic></sub>and <italic>x</italic><sub><italic>i</italic></sub><italic>b</italic>. This is also done in the section <monospace>#layer connections</monospace>. The notation of these binding partners is analogous to the notation of species, however, the binding partners do not have to be defined in the section <monospace>#molecules</monospace>.</p></sec><sec><title>The sections '#parameters' and '#initial conditions'</title><p>The sections <monospace>#parameters</monospace> and <monospace>#initial conditions</monospace> are used to define parameters and initial conditions, respectively (Figure <xref ref-type="fig" rid="F7">7</xref>). In contrast to species notation, parameter notations have to start with a lowercase letter (which may not be 'r' or 'x', as these letters are reserved for the notation of reaction rates and layer connections, respectively). Parameters can also be functions of other parameters (e.g. k1 = k2/k3).</p><p>Each species that is not defined by an algebraic equation requires an initial condition. An initial condition for a species is defined by an equation that assigns a value to the species. Note that initial conditions can be functions of parameters (e.g. R[0, P] = a/b+1).</p><p>Initial conditions and parameters for which no value is assigned, are set to the corresponding default values. The default values can be arbitrarily chosen (see below) and a warning is given for each omitted parameter definition or initial condition.</p><p>Setting the default value for initial conditions to zero may result in division by zero in the correction terms <italic>c</italic><sub><italic>i </italic></sub>if no initial condition for phosphorylated species is set manually to a non-zero value. One could use a default value very close to zero (e.g. 10<sup>-20</sup>) to avoid this problem. During the assignment of initial conditions, one has to assure that <italic>x</italic><sub><italic>i </italic></sub>&#x02265; <italic>x</italic><sub><italic>i</italic></sub><italic>b </italic>and <italic>x</italic><sub><italic>i </italic></sub>&#x0003e; 0 hold for all <italic>i</italic>. It is not possible that more binding sites are occupied than are phosphorylated, as in these cases the phosphorylation is a precondition for effector binding. Therefore, it is obvious that the condition <italic>x</italic><sub><italic>i </italic></sub>&#x02265; <italic>x</italic><sub><italic>i</italic></sub><italic>b </italic>&#x02200; <italic>i </italic>has to be fulfilled for the initial conditions.</p></sec><sec><title>Optional sections</title><p>Conserved moieties are chemical entities that participate in a reaction system without loss of integrity and always remain in the system [<xref ref-type="bibr" rid="B6">6</xref>]. As an example, the sum of all species of a protein that is not degraded or synthesized is a conserved moiety. Conservation relations (molecular balances) allow for the replacement of the ODE of one species for each conserved moiety by an algebraic equation, and can be defined in the section <monospace>#molecular balances</monospace>. Concentrations of species can be set to a constant value (which can be a function of parameters) in the section <monospace>#clamped concentrations</monospace>. The section <monospace>#algebraic relations</monospace> allows for the assignment of arbitrary algebraic expressions (that may contain species, macrostates, numerical values and parameters) to variables whose notation is analogous to that for species. The section <monospace>#remove</monospace> allows for the complete removal of defined species from the reaction network and from all macrostates. This simplifies the use of rules for association reactions and is discussed in the user guide. The section <monospace>#output</monospace> allows for the declaration of species, macrostates, variables from the section <monospace>#algebraic relations</monospace>, or arbitrary algebraic expressions as outputs. All outputs are visualized in the resulting <italic>Mathematica</italic>, C MEX and MATLAB models and defined as <italic>Output</italic><sub><italic>i </italic></sub>in the SBML model.</p></sec></sec><sec><title>Assignment of correction terms</title><p>In the following section, we describe the conditions that are checked in order to decide whether a correction term <italic>c</italic><sub><italic>i </italic></sub>is necessary and if so, the algorithm to find the appropriate correction term. ALC detects the need for a correction term in the rate law of a reaction if the following two conditions are simultaneously fulfilled:</p><p>&#x02022; A molecule <italic>M </italic>occurs on both sides of the reaction equation.</p><p>&#x02022; The site modification of the molecule <italic>M </italic>is '<italic>P</italic>' on the <italic>j</italic>th site on one side of the reaction equation and not 'P' on the other side of the reaction equation.</p><p>As an example, these conditions are fulfilled for the second and for the third reaction in Figure <xref ref-type="fig" rid="F7">7</xref>, whereas they are not fulfilled simultaneously in the remaining reactions.</p><p>ALC uses the following algorithm to find the appropriate correction term:</p><p>1. Replace macrostates by the corresponding sums in each definition of <italic>x</italic><sub><italic>i</italic></sub>.</p><p>2. Count for all <italic>x</italic><sub><italic>i </italic></sub>how often the molecule <italic>M </italic>occurs with a site modification 'P' on the <italic>j</italic>th site (factors before the species are considered).</p><p>3. Take the <italic>x</italic><sub><italic>i </italic></sub>with the highest score and use <italic>c</italic><sub><italic>i </italic></sub>= (<italic>x</italic><sub><italic>i </italic></sub>- <italic>x</italic><sub><italic>i</italic></sub><italic>b</italic>)/<italic>x</italic><sub><italic>i </italic></sub>as the correction term.</p><p>The choice of the correction term is described in the ALC user guide for an example system. This algorithm is implemented much faster than described above. The first step is only performed once. The second step is performed for all molecules and positions with the site modification 'P' that occur in at least one <italic>x</italic><sub><italic>i </italic></sub>simultaneously. This is done by building a hash (an associative array, a major data type in Perl) [<xref ref-type="bibr" rid="B41">41</xref>] that has the keys: molecule name and position. The values are the corresponding <italic>x</italic><sub><italic>i </italic></sub>that have the highest score. Using this hash, the third step is trivial.</p></sec><sec><title>Running ALC</title><p>There are two possible ways of running ALC. The first is to use the form on the ALC website [<xref ref-type="bibr" rid="B37">37</xref>], where ALC can be accessed using a browser without any additional software.</p><p>The second possibility is to download the latest release of ALC from the same website [<xref ref-type="bibr" rid="B37">37</xref>], from SourceForge.net [<xref ref-type="bibr" rid="B44">44</xref>], or to use the first release that is given in Additional file <xref ref-type="supplementary-material" rid="S5">5</xref>. Perl (freely available, e.g. [<xref ref-type="bibr" rid="B42">42</xref>]) is required for the offline use. For the installation of ALC it is only necessary to unpack the file 'download_ALC.zip' (or Additional file <xref ref-type="supplementary-material" rid="S5">5</xref>) in the directory where the model definition files will be stored. If ALC is installed, store the model definition in the file 'layer.alc', open a command line interface, go to the ALC directory and type</p><p>ALC.pl</p><p>followed by the return key. Another, equivalent possibility is to use</p><p>perl ALC.pl</p><p>to perform the generation of the output files. These commands execute ALC with default values, e.g. for undefined parameters or initial conditions and for the filenames of the model definition file and the resulting model files. Without changing the default values, the model definition has to be stored in the file 'layer.alc' and the notation of the resulting output files starts with 'model'. All default values can be changed in the file <monospace>Config_ALC.txt</monospace> or via the command line for each call of ALC separately. A detailed description of default values and command line parameters is given in the ALC user guide. Note that all options have their equivalent as text fields or select elements in the form on the ALC website [<xref ref-type="bibr" rid="B37">37</xref>].</p></sec><sec><title>Step by step procedure: using ALC</title><p>This step by step procedure is a modification of the step by step procedure for layer-based modeling that can be applied when using ALC.</p><p>1. Identify all processes and their interactions.</p><p>2. Draw the interaction graph.</p><p>3. Deduce from the interaction graph how many layers are in the model and which processes form part of which layer. All processes that are coupled by graded interactions are part of the same layer. Processes of different layers are coupled by all-or-none interactions or do not interact.</p><p>4. Model each layer separately as if the processes of all other layers do not exist.</p><p>(a) Define all molecules in the section <monospace>#molecules</monospace> (e.g. <monospace>R{0, L}{0, P}</monospace>). The site modification (uppercase) 'P' is reserved for indicating the phosphorylation of binding sites to which the effectors bind in other layers. A different notation (e.g. lowercase 'p') has to be used to indicate the phosphorylation of other sites.</p><p>(b) Define rules and reactions, as in conventional modeling, in the section <monospace>#reactions</monospace> (e.g. R[0, X]+L&#x0003c;-&#x0003e;R[L, X] k1 k2). Define variables in the section <monospace>#algebraic relations</monospace> that represent frequently used expressions in the parameter part of the reactions.</p><p>(c) Define all sums of species with phosphorylated binding sites <italic>x</italic><sub><italic>i </italic></sub>(e.g. x = R[X, P]) and all sums of species with occupied binding sites <italic>x</italic><sub><italic>i</italic></sub><italic>b </italic>(e.g. xb = RXE) in the section <monospace>#layer connections</monospace>. Note that <italic>x</italic><sub><italic>i</italic></sub><italic>b </italic>has the same notation as the corresponding <italic>x</italic><sub><italic>i</italic></sub>, followed by (lowercase) 'b'.</p><p>(d) Define the binding partners for effectors whose binding sites are phosphorylated in other layers in the section <monospace>#layer connections</monospace> (e.g. RXp = x-xb).</p><p>(e) Assign values to parameters in the section <monospace>#parameters</monospace> (e.g. k1 = 3). Undefined parameters are set to the default value (the value of the option Param) which can be defined in the file <monospace>Config_ALC.txt</monospace> or via the command line.</p><p>(f) Assign initial conditions in the section <monospace>#initial conditions</monospace> (e.g. R[0,0] = 2). Undefined initial conditions are set to the default value (the value of the option InCond) which can be defined in the file <monospace>Config_ALC.txt</monospace> or via the command line. The initial conditions have to guarantee <italic>x</italic><sub><italic>i </italic></sub>&#x0003e; 0 and <italic>x</italic><sub><italic>i </italic></sub>&#x02265; <italic>x<sub>i</sub>b </italic>&#x02200; <italic>i</italic>.</p><p>(g) Concentrations of species can be set to a constant value in the section <monospace>#clamped concentrations</monospace> (e.g. L = 10).</p><p>(h) Conservation relations (e.g. R[0,0] = totR-R[X, X]+R[0,0]) can be defined in the section <monospace>#molecular balances</monospace>. Using macrostates and the species whose ODE is to be replaced highly simplifies this step.</p><p>5. Define outputs (observables) to be visualized in the C MEX, MATLAB and <italic>Mathematica </italic>models in the section <monospace>#output</monospace>. All variables defined in the section <monospace>#layer connections</monospace> are visualized in the C MEX, MATLAB and <italic>Mathematica </italic>models without declaring them as outputs. This can be disabled by changing the default value (the value of the option OutLC) which can be defined in the file <monospace>Config_ALC.txt</monospace> or via the command line.</p><p>6. Store the model definition in a file, e.g. 'layer.alc', which is the default file name for the model definition file.</p><p>7. Run ALC offline or use the form on the ALC website.</p></sec><sec><title>Output files</title><p>The resulting model is given in MATLAB (default: modelM call.m and modelM.m), C MEX (default: modelC call.m, modelC mdl.mdl and modelC.c), <italic>Mathematica </italic>notebook (default: model.nb) and <italic>Mathematica </italic>input file (default: model.mma.m) formats as directly executable files. They include the visualization of user-defined output variables and &#x02013; in the default case &#x02013; all variables defined in the section <monospace>#layer connections</monospace>.</p><p>The core of the C MEX model is a MATLAB S-function written in C, which results in a much faster simulation of the model compared to the standard MATLAB format. A recent release of MATLAB (earliest version successfully tested: 7.0.4.352) is required for using the C MEX models. The <italic>Mathematica </italic>input file contains the same code as the notebook file but simplifies the integration of layer-based models into existing mathematica code.</p><p>The model is also given in SBML (default: model.xml), LATEX (default: model.tex) and plain text (default: model.txt) formats, which allows for the direct usage of model equations for presentations or publications. Additionally, the model definition is converted to the LATEX format (default: model.input.tex).</p><p>Note that the SBML standard [<xref ref-type="bibr" rid="B38">38</xref>] allows for explicit algebraic assignments, which are used in layer-based models. However, some SBML-supporting tools will not work with layer-based SBML models as these tools do not support algebraic assignments. An important tool that works with layer-based SBML models is MathSBML [<xref ref-type="bibr" rid="B45">45</xref>] (release 2.7.0.3 or higher).</p></sec></sec><sec><title>Results and discussion</title><sec><title>ALC: Functionality and performance</title><sec><title>Simplification of the model generation</title><p>ALC converts model definitions given in a simple but powerful rule-based syntax to computational models in different formats, as well as documentation files. The main benefit of ALC is that it dramatically simplifies layer-based modeling and reduces the risk of creating erroneous model equations.</p><p>The assignment of the correction terms <italic>c</italic><sub><italic>i </italic></sub>to dephosphorylation rates is one of the more difficult and error-prone steps in manual layer-based modeling. ALC performs these assignments automatically, such that errors in this step are avoided. This strengthens the analogy of layer-based modeling to conventional modeling and rule-based modeling as the reaction network within layers can now be defined using rules without considering correction terms.</p><p>ALC also supports the usage of macrostates. This highly simplifies the definition of the signals between the layers (<italic>x</italic><sub><italic>i </italic></sub>and <italic>x</italic><sub><italic>i</italic></sub><italic>b</italic>) as well as the definition of conservation relations and the use of enzyme kinetics for rules and reactions.</p></sec><sec><title>Portability of models</title><p>In many cases, it is comfortable to have the model in different formats. As an example, SBML [<xref ref-type="bibr" rid="B38">38</xref>] is becoming the <italic>de facto </italic>standard for model representation in systems biology. Though by far not all modeling and simulation projects use SBML, it is often desired to provide SBML models for publications. In many cases, the model equations in plain text are part of the manuscript or are provided as supplementary material. ALC automatically exports the model to several formats including SBML and provides the model equations in LATEX format as well as in plain text format.</p><p>The manual format conversion of models is probably the major reason for errors in published model descriptions. Automation of this step, as provided by ALC, is not only convenient but also lowers the probability of errors in the provided models.</p></sec><sec><title>Application range of ALC</title><p>ALC is optimized for building layer-based models. It supports features of layer-based modeling that are not present in conventional or rule-based modeling, and that are not supported by other tools. ALC is also well suited for conventional modeling of reaction networks. Although the functionality of ALC is related to other tools that also allow for rule-based modeling [<xref ref-type="bibr" rid="B20">20</xref>-<xref ref-type="bibr" rid="B26">26</xref>], the application range is different. Note that rule-based conventional models can be built using ALC. However, due to limitations in the description of complexes, ALC is not as well suited for this task as e.g. BioNetGen [<xref ref-type="bibr" rid="B20">20</xref>-<xref ref-type="bibr" rid="B22">22</xref>]. ALC shows its optimal performance when building reduced modular models according to the layer-based approach.</p></sec><sec><title>Computational aspects</title><p>The output files for small layer-based models are generated in less than one second on a desktop PC. The generation of larger layer-based models that can correspond to extremely large conventional models is also very rapid. As an example, the output files for the layer-based model of insulin signaling (214 ODEs) that replaces a conventional model with 1.5&#x000b7;10<sup>8</sup> ODEs [<xref ref-type="bibr" rid="B3">3</xref>] are generated in about one second on a desktop PC. A few thousand ODEs are usually generated within seconds.</p><p>The model size in the offline version of ALC is only restricted by CPU time, disk space and memory capacity. The online version of ALC which is accessible via a form on the ALC website [<xref ref-type="bibr" rid="B37">37</xref>] provides full functionality, but is restricted to model definitions that define no more than 500 species. This is done to keep the traffic and the processor load on the server at a reasonable size.</p></sec></sec><sec><title>The choice of the modeling method</title><p>An important question one has to answer at the beginning of the modeling process is that of which modeling method is the most suited for the considered system. A principle decision is necessary between stochastic and deterministic simulation.</p><p>If stochastic simulation is chosen, it depends on the model size, as well as on the branching of the network and on the number of simulation runs as to whether on-the-fly or generate-first modeling is more suited. Note that layer-based modeling is also suited for stochastic simulation. In the following paragraph, we give a rule of thumb for choosing the appropriate deterministic modeling technique.</p><p>The exact techniques should be used if it is possible and applicable. Whether one should use conventional modeling, rule-based modeling or exact model reduction simply depends on the size of the resulting model and on the number of necessary simulations. Additional assumptions (e.g. assuming a temporal order of processes) that are only made to keep the numbers of species and reactions low but have no physiological justification should be avoided. Such assumptions may lead to a nearly unpredictable approximation error [<xref ref-type="bibr" rid="B5">5</xref>,<xref ref-type="bibr" rid="B18">18</xref>].</p><p>If the conventional model (which may be the result of rule-base modeling) is too large for efficient simulation or parameter estimation, and if the exactly reduced model is also too large or is difficult to generate, layer-based modeling is a powerful possibility. In addition, the layer-based formalism is especially suited for comparing many model variants, as in many cases only a few equations in a single layer have to be changed. Note that rule-based modeling is also possible for layer-based models when using ALC. If the layer-based model is still too large for efficient simulation or parameter estimation, the layer-based model should be subjected to exact model reduction. In this case, the exact model reduction is performed on each layer separately. This combination of layer-based modeling and exact model reduction results in the fewest ODEs without the introduction of an additional approximation error as introduced by layer-based modeling.</p></sec></sec><sec><title>Conclusion</title><p>The layer-based approach allows for a highly reduced macroscopic description of signaling systems with inherent combinatorial complexity. It is an approximative, but accurate modeling technique that results in a reduced model with a pronounced modular structure. An interaction graph which represents the interactions between the processes defines the modularity of the model. The resulting modules, called layers, are connected in a standardized way and can be modeled separately from each other once their connections are defined.</p><p>ALC highly simplifies the generation of layer-based models. The tool can be used offline or via a form on the ALC website. The simple but powerful syntax of the model definition supports the concepts of modularity, rules and macrostates. The model definition is divided into distinct sections and can be structured to mirror the modularity of the model. ALC provides the resulting dynamic models in different formats (C MEX, MATLAB, <italic>Mathematica </italic>and SBML) as ready-to-run simulation files, and provides documentation files that simplify the presentation and publication of the models.</p></sec><sec><title>Availability and requirements</title><p>Project name: ALC</p><p>Project home page: <ext-link ext-link-type="uri" xlink:href="http://layer.mpi-magdeburg.mpg.de"/></p><p>ALC on SourceForge.net: <ext-link ext-link-type="uri" xlink:href="http://sourceforge.net/projects/alc/"/></p><p>Operating system(s): Platform independent</p><p>Programming language: Perl</p><p>License: GNU Lesser General Public License</p><p>Any restrictions for use by non-academics: None</p></sec><sec><title>Authors' contributions</title><p>MK wrote the Perl scripts and drafted the manuscript, EDG initiated and supervised the study.</p></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="S1"><caption><title>Additional file 1</title><p><bold>ALC user guide.</bold> The ALC user guide describes the syntax and the usage of ALC in detail. There is also a section describing frequently occurring problems and their solutions.</p></caption><media xlink:href="1752-0509-2-91-S1.pdf" mimetype="application" mime-subtype="pdf"><caption><p>Click here for file</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="S2"><caption><title>Additional file 2</title><p><bold>Model definitions to illustrate the advanced strategies.</bold> Several layer-based model definitions illustrating the concepts discussed in the "advanced strategies" section are given in this file.</p></caption><media xlink:href="1752-0509-2-91-S2.zip" mimetype="application" mime-subtype="x-zip-compressed"><caption><p>Click here for file</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="S3"><caption><title>Additional file 3</title><p><bold>Example models.</bold> Several layer-based model definitions for example systems are given in this file.</p></caption><media xlink:href="1752-0509-2-91-S3.zip" mimetype="application" mime-subtype="x-zip-compressed"><caption><p>Click here for file</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="S4"><caption><title>Additional file 4</title><p><bold>ALC tutorial.</bold> The ALC tutorial extensively describes the modeling of an example system.</p></caption><media xlink:href="1752-0509-2-91-S4.pdf" mimetype="application" mime-subtype="pdf"><caption><p>Click here for file</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="S5"><caption><title>Additional file 5</title><p><bold>ALC for offline use.</bold> The first release of ALC is given in this file.</p></caption><media xlink:href="1752-0509-2-91-S5.zip" mimetype="application" mime-subtype="x-zip-compressed"><caption><p>Click here for file</p></caption></media></supplementary-material></sec></body><back><ack><sec><title>Acknowledgements</title><p>This work was supported by the German Federal Ministry of Education and Research (BMBF) and the Network Systems Biology HepatoSys. We thank Michael Ederer, Johannes Witt, Holger Conzelmann and Duncan Payne for proofreading the manuscript and beta-testing.</p></sec></ack><ref-list><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hlavacek</surname><given-names>WS</given-names></name><name><surname>Faeder</surname><given-names>JR</given-names></name><name><surname>Blinov</surname><given-names>ML</given-names></name><name><surname>Perelson</surname><given-names>AS</given-names></name><name><surname>Goldstein</surname><given-names>B</given-names></name></person-group><article-title>The complexity of complexes in signal transduction</article-title><source>Biotechnol Bioeng</source><year>2003</year><volume>84</volume><fpage>783</fpage><lpage>94</lpage><pub-id pub-id-type="pmid">14708119</pub-id></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hlavacek</surname><given-names>WS</given-names></name><name><surname>Faeder</surname><given-names>JR</given-names></name><name><surname>Blinov</surname><given-names>ML</given-names></name><name><surname>Posner</surname><given-names>RG</given-names></name><name><surname>Hucka</surname><given-names>M</given-names></name><name><surname>Fontana</surname><given-names>W</given-names></name></person-group><article-title>Rules for modeling signal-transduction systems</article-title><source>Sci STKE</source><year>2006</year><volume>2006</volume><fpage>re6</fpage><pub-id pub-id-type="pmid">16849649</pub-id></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Koschorreck</surname><given-names>M</given-names></name><name><surname>Conzelmann</surname><given-names>H</given-names></name><name><surname>Ebert</surname><given-names>S</given-names></name><name><surname>Ederer</surname><given-names>M</given-names></name><name><surname>Gilles</surname><given-names>ED</given-names></name></person-group><article-title>Reduced modeling of signal transduction &#x02013; a modular approach</article-title><source>BMC Bioinformatics</source><year>2007</year><volume>8</volume><fpage>336</fpage><pub-id pub-id-type="pmid">17854494</pub-id></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Borisov</surname><given-names>NM</given-names></name><name><surname>Markevich</surname><given-names>NI</given-names></name><name><surname>Hoek</surname><given-names>JB</given-names></name><name><surname>Kholodenko</surname><given-names>BN</given-names></name></person-group><article-title>Signaling through receptors and scaffolds: independent interactions reduce combinatorial complexity</article-title><source>Biophys J</source><year>2005</year><volume>89</volume><fpage>951</fpage><lpage>966</lpage><pub-id pub-id-type="pmid">15923229</pub-id></citation></ref><ref id="B5"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Conzelmann</surname><given-names>H</given-names></name><name><surname>Saez-Rodriguez</surname><given-names>J</given-names></name><name><surname>Sauter</surname><given-names>T</given-names></name><name><surname>Kholodenko</surname><given-names>B</given-names></name><name><surname>Gilles</surname><given-names>E</given-names></name></person-group><article-title>A domain-oriented approach to the reduction of combinatorial complexity in signal transduction networks</article-title><source>BMC Bioinformatics</source><year>2006</year><volume>7</volume><fpage>34</fpage><pub-id pub-id-type="pmid">16430778</pub-id></citation></ref><ref id="B6"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Heinrich</surname><given-names>R</given-names></name><name><surname>Schuster</surname><given-names>S</given-names></name></person-group><source>The Regulation of Cellular Systems</source><year>1996</year><publisher-name>Chapman &#x00026; Hall</publisher-name></citation></ref><ref id="B7"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Atkins</surname><given-names>P</given-names></name><name><surname>Paula</surname><given-names>Jd</given-names></name></person-group><source>Physical Chemistry</source><year>2006</year><publisher-name>Oxford University Press</publisher-name></citation></ref><ref id="B8"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Asthagiri</surname><given-names>A</given-names></name><name><surname>Lauffenburger</surname><given-names>D</given-names></name></person-group><article-title>A computational study of feedback effects on signal dynamics in a mitogen-activated protein kinase (MAPK) pathway model</article-title><source>Biotechnol Prog</source><year>2001</year><volume>17</volume><fpage>227</fpage><lpage>239</lpage><pub-id pub-id-type="pmid">11312698</pub-id></citation></ref><ref id="B9"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Sedaghat</surname><given-names>AR</given-names></name><name><surname>Sherman</surname><given-names>A</given-names></name><name><surname>Quon</surname><given-names>MJ</given-names></name></person-group><article-title>A mathematical model of metabolic insulin signaling pathways</article-title><source>Am J Physiol Endocrinol Metab</source><year>2002</year><volume>283</volume><fpage>E1084</fpage><lpage>101</lpage><pub-id pub-id-type="pmid">12376338</pub-id></citation></ref><ref id="B10"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hatakeyama</surname><given-names>M</given-names></name><name><surname>Kimura</surname><given-names>S</given-names></name><name><surname>Naka</surname><given-names>T</given-names></name><name><surname>Kawasaki</surname><given-names>T</given-names></name><name><surname>Yumoto</surname><given-names>N</given-names></name><name><surname>Ichikawa</surname><given-names>M</given-names></name><name><surname>Kim</surname><given-names>JH</given-names></name><name><surname>Saito</surname><given-names>K</given-names></name><name><surname>Saeki</surname><given-names>M</given-names></name><name><surname>Shirouzu</surname><given-names>M</given-names></name><name><surname>Yokoyama</surname><given-names>S</given-names></name><name><surname>Konagaya</surname><given-names>A</given-names></name></person-group><article-title>A computational model on the modulation of mitogen-activated protein kinase (MAPK) and Akt pathways in heregulin-induced ErbB signalling</article-title><source>Biochem J</source><year>2003</year><volume>373</volume><fpage>451</fpage><lpage>463</lpage><pub-id pub-id-type="pmid">12691603</pub-id></citation></ref><ref id="B11"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Haugh</surname><given-names>J</given-names></name><name><surname>Schooler</surname><given-names>K</given-names></name><name><surname>Well</surname><given-names>A</given-names></name><name><surname>Wiley</surname><given-names>H</given-names></name><name><surname>Lauffenburger</surname><given-names>D</given-names></name></person-group><article-title>Effect of epidermal growth factor receptor internalization on regulation of the phosphoslipase C-gamma1 signaling pathway</article-title><source>J Biol Chem</source><year>1999</year><volume>274</volume><fpage>8958</fpage><lpage>8965</lpage><pub-id pub-id-type="pmid">10085141</pub-id></citation></ref><ref id="B12"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Haugh</surname><given-names>J</given-names></name><name><surname>Well</surname><given-names>A</given-names></name><name><surname>Lauffenburger</surname><given-names>D</given-names></name></person-group><article-title>Mathematical modeling of epidermal growth factor receptor signaling through the phospholipase C pathway: mechanistic insights and predictions for molecular interventions</article-title><source>Biotechnol Bioeng</source><year>2000</year><volume>70</volume><fpage>225</fpage><lpage>238</lpage><pub-id pub-id-type="pmid">10972934</pub-id></citation></ref><ref id="B13"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kholodenko</surname><given-names>BN</given-names></name><name><surname>Demin</surname><given-names>OV</given-names></name><name><surname>Moehren</surname><given-names>G</given-names></name><name><surname>Hoek</surname><given-names>JB</given-names></name></person-group><article-title>Quantification of Short Term Signaling by the Epidermal Growth Factor Receptor</article-title><source>J Biol Chem</source><year>1999</year><volume>274</volume><fpage>30169</fpage><lpage>30181</lpage><pub-id pub-id-type="pmid">10514507</pub-id></citation></ref><ref id="B14"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Moehren</surname><given-names>G</given-names></name><name><surname>Markevich</surname><given-names>N</given-names></name><name><surname>Demin</surname><given-names>O</given-names></name><name><surname>Kiyatkin</surname><given-names>A</given-names></name><name><surname>Goryanin</surname><given-names>I</given-names></name><name><surname>Hoek</surname><given-names>JB</given-names></name><name><surname>Kholodenko</surname><given-names>BN</given-names></name></person-group><article-title>Temperature dependence of the epidermal growth factor receptor signaling network can be accounted for by a kinetic model</article-title><source>Biochemistry</source><year>2002</year><volume>41</volume><fpage>306</fpage><lpage>20</lpage><pub-id pub-id-type="pmid">11772030</pub-id></citation></ref><ref id="B15"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Schoeberl</surname><given-names>B</given-names></name><name><surname>Eichler-Jonsson</surname><given-names>C</given-names></name><name><surname>Gilles</surname><given-names>ED</given-names></name><name><surname>M&#x000fc;ller</surname><given-names>G</given-names></name></person-group><article-title>Computational modeling of the dynamics of the MAP kinase cascade activated by surface and internalized EGF receptors</article-title><source>Nat Biotechnol</source><year>2002</year><volume>20</volume><fpage>370</fpage><lpage>375</lpage><pub-id pub-id-type="pmid">11923843</pub-id></citation></ref><ref id="B16"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>G</given-names></name><name><surname>Swihart</surname><given-names>MT</given-names></name><name><surname>Neelamegham</surname><given-names>S</given-names></name></person-group><article-title>Sensitivity, principal component and flux analysis applied to signal transduction: the case of epidermal growth factor mediated signaling</article-title><source>Bioinformatics</source><year>2005</year><volume>21</volume><fpage>1194</fpage><lpage>202</lpage><pub-id pub-id-type="pmid">15531606</pub-id></citation></ref><ref id="B17"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Koschorreck</surname><given-names>M</given-names></name><name><surname>Gilles</surname><given-names>ED</given-names></name></person-group><article-title>Mathematical modeling and analysis of insulin clearance in vivo</article-title><source>BMC Systems Biology</source><year>2008</year><volume>2</volume><fpage>43</fpage><pub-id pub-id-type="pmid">18477391</pub-id></citation></ref><ref id="B18"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Faeder</surname><given-names>J</given-names></name><name><surname>Blinov</surname><given-names>M</given-names></name><name><surname>Goldstein</surname><given-names>B</given-names></name><name><surname>Hlavacek</surname><given-names>W</given-names></name></person-group><article-title>Combinatorial complexity and dynamical restriction of network flows in signal transduction</article-title><source>Syst Biol (Stevenage)</source><year>2005</year><volume>2</volume><fpage>5</fpage><lpage>15</lpage><pub-id pub-id-type="pmid">17091578</pub-id></citation></ref><ref id="B19"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Faeder</surname><given-names>JR</given-names></name><name><surname>Blinov</surname><given-names>ML</given-names></name><name><surname>Goldstein</surname><given-names>B</given-names></name><name><surname>Hlavacek</surname><given-names>WS</given-names></name></person-group><article-title>Rule-based modeling of biochemical networks</article-title><source>Complexity</source><year>2005</year><volume>10</volume><fpage>22</fpage><lpage>41</lpage></citation></ref><ref id="B20"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Blinov</surname><given-names>ML</given-names></name><name><surname>Faeder</surname><given-names>JR</given-names></name><name><surname>Goldstein</surname><given-names>B</given-names></name><name><surname>Hlavacek</surname><given-names>WS</given-names></name></person-group><article-title>BioNetGen: software for rule-based modeling of signal transduction based on the interactions of molecular domains</article-title><source>Bioinformatics</source><year>2004</year><volume>20</volume><fpage>3289</fpage><lpage>91</lpage><pub-id pub-id-type="pmid">15217809</pub-id></citation></ref><ref id="B21"><citation citation-type="other"><person-group person-group-type="author"><name><surname>Faeder</surname><given-names>JR</given-names></name><name><surname>Blinov</surname><given-names>ML</given-names></name><name><surname>Hlavacek</surname><given-names>WS</given-names></name></person-group><article-title>Graphical rule-based representation of signal transduction networks</article-title><source>Proc ACM Symp Appl Computing</source><year>2005</year><fpage>133</fpage><lpage>140</lpage></citation></ref><ref id="B22"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Blinov</surname><given-names>ML</given-names></name><name><surname>Yang</surname><given-names>J</given-names></name><name><surname>Faeder</surname><given-names>JR</given-names></name><name><surname>Hlavacek</surname><given-names>WS</given-names></name></person-group><article-title>Graph theory for rule-based modeling of biochemical networks</article-title><source>Lect Notes Comput Sci</source><year>2006</year><volume>4230</volume><fpage>89</fpage><lpage>106</lpage></citation></ref><ref id="B23"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Nov&#x000e8;re</surname><given-names>NL</given-names></name><name><surname>Shimizu</surname><given-names>T</given-names></name></person-group><article-title>STOCHSIM: modelling of stochastic biomolecular processes</article-title><source>Bioinformatics</source><year>2001</year><volume>17</volume><fpage>575</fpage><lpage>6</lpage><pub-id pub-id-type="pmid">11395441</pub-id></citation></ref><ref id="B24"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lok</surname><given-names>L</given-names></name><name><surname>Brent</surname><given-names>R</given-names></name></person-group><article-title>Automatic generation of cellular reaction networks with Moleculizer 1.0</article-title><source>Nat Biotechnol</source><year>2005</year><volume>23</volume><fpage>131</fpage><lpage>6</lpage><pub-id pub-id-type="pmid">15637632</pub-id></citation></ref><ref id="B25"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Calzone</surname><given-names>L</given-names></name><name><surname>Fages</surname><given-names>F</given-names></name><name><surname>Soliman</surname><given-names>S</given-names></name></person-group><article-title>BIOCHAM: an environment for modeling biological systems and formalizing experimental knowledge</article-title><source>Bioinformatics</source><year>2006</year><volume>22</volume><fpage>1805</fpage><lpage>7</lpage><pub-id pub-id-type="pmid">16672256</pub-id></citation></ref><ref id="B26"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Sedwards</surname><given-names>S</given-names></name><name><surname>Mazza</surname><given-names>T</given-names></name></person-group><article-title>Cyto-Sim: a formal language model and stochastic simulator of membrane-enclosed biochemical processes</article-title><source>Bioinformatics</source><year>2007</year><volume>23</volume><fpage>2800</fpage><lpage>2</lpage><pub-id pub-id-type="pmid">17855418</pub-id></citation></ref><ref id="B27"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Gillespie</surname><given-names>DT</given-names></name></person-group><article-title>A rigorous derivation of the chemical master equation</article-title><source>Physica A</source><year>1992</year><volume>188</volume><fpage>404</fpage><lpage>425</lpage></citation></ref><ref id="B28"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Blinov</surname><given-names>ML</given-names></name><name><surname>Faeder</surname><given-names>JR</given-names></name><name><surname>Yang</surname><given-names>J</given-names></name><name><surname>Goldstein</surname><given-names>B</given-names></name><name><surname>Hlavacek</surname><given-names>WS</given-names></name></person-group><article-title>'On-the-fly' or 'generate-first' modeling?</article-title><source>Nat Biotechnol</source><year>2005</year><volume>23</volume><fpage>1344</fpage><lpage>5</lpage><pub-id pub-id-type="pmid">16273053</pub-id></citation></ref><ref id="B29"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Pawson</surname><given-names>T</given-names></name><name><surname>Nash</surname><given-names>P</given-names></name></person-group><article-title>Assembly of cell regulatory systems through protein interaction domains</article-title><source>Science</source><year>2003</year><volume>300</volume><fpage>445</fpage><lpage>452</lpage><pub-id pub-id-type="pmid">12702867</pub-id></citation></ref><ref id="B30"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Conzelmann</surname><given-names>H</given-names></name><name><surname>Gilles</surname><given-names>ED</given-names></name></person-group><source>Functional Proteomics: Methods and Protocols</source><publisher-name>Humana Press 2008 chap. Dynamic pathway modeling of signal transduction networks &#x02013; A domain-oriented approach</publisher-name><fpage>557</fpage><lpage>576</lpage></citation></ref><ref id="B31"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Conzelmann</surname><given-names>H</given-names></name><name><surname>Fey</surname><given-names>D</given-names></name><name><surname>Gilles</surname><given-names>E</given-names></name></person-group><article-title>Exact model reduction of combinatorial reaction networks</article-title><source>BMC Syst Biol</source><year>2008</year><volume>2</volume><fpage>78</fpage><pub-id pub-id-type="pmid">18755034</pub-id></citation></ref><ref id="B32"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hartwell</surname><given-names>L</given-names></name><name><surname>Hopfield</surname><given-names>J</given-names></name><name><surname>Leibler</surname><given-names>S</given-names></name><name><surname>Murray</surname><given-names>A</given-names></name></person-group><article-title>From molecular to modular cell biology</article-title><source>Nature</source><year>1999</year><volume>402</volume><fpage>C47</fpage><lpage>52</lpage><pub-id pub-id-type="pmid">10591225</pub-id></citation></ref><ref id="B33"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Saez-Rodriguez</surname><given-names>J</given-names></name><name><surname>Kremling</surname><given-names>A</given-names></name><name><surname>Conzelmann</surname><given-names>H</given-names></name><name><surname>Bettenbrock</surname><given-names>K</given-names></name><name><surname>Gilles</surname><given-names>ED</given-names></name></person-group><article-title>Modular Analysis of Signal Transduction Networks. IEEE Contr</article-title><source>Syst Mag</source><year>2004</year><volume>24</volume><fpage>35</fpage><lpage>52</lpage></citation></ref><ref id="B34"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Saez-Rodriguez</surname><given-names>J</given-names></name><name><surname>Kremling</surname><given-names>A</given-names></name><name><surname>Gilles</surname><given-names>ED</given-names></name></person-group><article-title>Dissecting the puzzle of life: Modularization of signal transduction networks</article-title><source>Comput Chem Eng</source><year>2005</year><volume>29</volume><fpage>619</fpage><lpage>629</lpage></citation></ref><ref id="B35"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ederer</surname><given-names>M</given-names></name><name><surname>Sauter</surname><given-names>T</given-names></name><name><surname>Bullinger</surname><given-names>E</given-names></name><name><surname>Gilles</surname><given-names>ED</given-names></name><name><surname>Allg&#x000f6;wer</surname><given-names>F</given-names></name></person-group><article-title>An Approach for Dividing Models of Biological Reaction Networks into Functional Units</article-title><source>Simulation</source><year>2003</year><volume>79</volume><fpage>703</fpage><lpage>716</lpage></citation></ref><ref id="B36"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Isidori</surname><given-names>A</given-names></name></person-group><source>Nonlinear control systems</source><publisher-name>Springer 1995 chap. Global decomposition of control systems</publisher-name><fpage>77</fpage><lpage>105</lpage></citation></ref><ref id="B37"><citation citation-type="other"><article-title>ALC website</article-title><ext-link ext-link-type="uri" xlink:href="http://layer.mpi-magdeburg.mpg.de"/></citation></ref><ref id="B38"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hucka</surname><given-names>M</given-names></name><name><surname>Finney</surname><given-names>A</given-names></name><name><surname>Sauro</surname><given-names>H</given-names></name><name><surname>Bolouri</surname><given-names>H</given-names></name><name><surname>Doyle</surname><given-names>J</given-names></name><name><surname>Kitano</surname><given-names>H</given-names></name><name><surname>Arkin</surname><given-names>A</given-names></name><name><surname>Bornstein</surname><given-names>B</given-names></name><name><surname>Bray</surname><given-names>D</given-names></name><name><surname>Cornish-Bowden</surname><given-names>A</given-names></name><name><surname>Cuellar</surname><given-names>A</given-names></name><name><surname>Dronov</surname><given-names>S</given-names></name><name><surname>Gilles</surname><given-names>E</given-names></name><name><surname>Ginkel</surname><given-names>M</given-names></name><name><surname>Gor</surname><given-names>V</given-names></name><name><surname>Goryanin</surname><given-names>I</given-names></name><name><surname>Hedley</surname><given-names>W</given-names></name><name><surname>Hodgman</surname><given-names>T</given-names></name><name><surname>Hofmeyr</surname><given-names>JH</given-names></name><name><surname>Hunter</surname><given-names>P</given-names></name><name><surname>Juty</surname><given-names>N</given-names></name><name><surname>Kasberger</surname><given-names>J</given-names></name><name><surname>Kremling</surname><given-names>A</given-names></name><name><surname>Kummer</surname><given-names>U</given-names></name><name><surname>Nov&#x000e8;re</surname><given-names>NL</given-names></name><name><surname>Loew</surname><given-names>L</given-names></name><name><surname>Lucio</surname><given-names>D</given-names></name><name><surname>Mendes</surname><given-names>P</given-names></name><name><surname>Minch</surname><given-names>E</given-names></name><name><surname>Mjolsness</surname><given-names>E</given-names></name><name><surname>Nakayama</surname><given-names>Y</given-names></name><name><surname>Nelson</surname><given-names>M</given-names></name><name><surname>Nielsen</surname><given-names>P</given-names></name><name><surname>Sakurada</surname><given-names>T</given-names></name><name><surname>Schaff</surname><given-names>J</given-names></name><name><surname>Shapiro</surname><given-names>B</given-names></name><name><surname>Shimizu</surname><given-names>T</given-names></name><name><surname>Spence</surname><given-names>H</given-names></name><name><surname>Stelling</surname><given-names>J</given-names></name><name><surname>Takahashi</surname><given-names>K</given-names></name><name><surname>Tomita</surname><given-names>M</given-names></name><name><surname>Wagner</surname><given-names>J</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name><name><surname>Forum</surname><given-names>S</given-names></name></person-group><article-title>The systems biology markup language (SBML): a medium for representation and exchange of biochemical network models</article-title><source>Bioinformatics</source><year>2003</year><volume>19</volume><fpage>524</fpage><lpage>31</lpage><pub-id pub-id-type="pmid">12611808</pub-id></citation></ref><ref id="B39"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Lamport</surname><given-names>L</given-names></name></person-group><source>LaTeX: A Document Preparation System: User's Guide and Reference Manual</source><year>1994</year><publisher-name>Addison-Wesley Longman, Amsterdam</publisher-name></citation></ref><ref id="B40"><citation citation-type="other"><article-title>Comprehensive TeX Archive Network</article-title><ext-link ext-link-type="uri" xlink:href="http://www.ctan.org"/></citation></ref><ref id="B41"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Wall</surname><given-names>L</given-names></name><name><surname>Christiansen</surname><given-names>T</given-names></name><name><surname>Orwant</surname><given-names>J</given-names></name></person-group><source>Programming Perl There's More Than One Way To Do It</source><year>2000</year><publisher-name>O'Reilly Media</publisher-name></citation></ref><ref id="B42"><citation citation-type="other"><article-title>Comprehensive Perl Archive Network</article-title><ext-link ext-link-type="uri" xlink:href="http://www.cpan.org"/></citation></ref><ref id="B43"><citation citation-type="other"><article-title>Apache HTTP Server Project</article-title><ext-link ext-link-type="uri" xlink:href="http://httpd.apache.org"/></citation></ref><ref id="B44"><citation citation-type="other"><article-title>ALC on SourceForge.net</article-title><ext-link ext-link-type="uri" xlink:href="http://sourceforge.net/projects/alc/"/></citation></ref><ref id="B45"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Shapiro</surname><given-names>BE</given-names></name><name><surname>Hucka</surname><given-names>M</given-names></name><name><surname>Finney</surname><given-names>A</given-names></name><name><surname>Doyle</surname><given-names>J</given-names></name></person-group><article-title>MathSBML: a package for manipulating SBML-based biological models</article-title><source>Bioinformatics</source><year>2004</year><volume>20</volume><fpage>2829</fpage><lpage>31</lpage><pub-id pub-id-type="pmid">15087311</pub-id></citation></ref></ref-list></back></article>