<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.0 20120330//EN" "JATS-archivearticle1.dtd"><article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id><journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id><journal-id journal-id-type="publisher-id">nar</journal-id><journal-id journal-id-type="hwp">nar</journal-id><journal-title-group><journal-title>Nucleic Acids Research</journal-title></journal-title-group><issn pub-type="ppub">0305-1048</issn><issn pub-type="epub">1362-4962</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">19106141</article-id><article-id pub-id-type="pmc">2647310</article-id><article-id pub-id-type="doi">10.1093/nar/gkn1019</article-id><article-id pub-id-type="publisher-id">gkn1019</article-id><article-categories><subj-group subj-group-type="heading"><subject>Computational Biology</subject></subj-group></article-categories><title-group><article-title>Pseudocounts for transcription factor binding sites</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Nishida</surname><given-names>Keishin</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Frith</surname><given-names>Martin C.</given-names></name><xref ref-type="aff" rid="AFF1"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Nakai</surname><given-names>Kenta</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref><xref ref-type="aff" rid="AFF1"><sup>3</sup></xref><xref ref-type="aff" rid="AFF1"><sup>4</sup></xref><xref ref-type="corresp" rid="COR1">*</xref></contrib></contrib-group><aff id="AFF1"><sup>1</sup>Department of Medical Genome Sciences, Graduate School of Frontier Sciences, University of Tokyo, 5-1-5 Kashiwanoha, Kashiwa, Chiba 277-8562, <sup>2</sup>Computational Biology Research Center, Institute for Advanced Industrial Science and Technology, Tokyo 135-0064, <sup>3</sup>Human Genome Center, Institute of Medical Science, University of Tokyo, 4-6-1 Shirokanedai, Minato-ku, Tokyo 108-8639 and <sup>4</sup>Institute for Bioinformatics Research and Development (BIRD), Japan Science and Technology Agency (JST), 5-3 Yonbancho, Chiyoda-ku, Tokyo 1002-0081, Japan</aff><author-notes><corresp id="COR1">*To whom correspondence should be addressed. Tel: <phone>+81 3 5449 5131</phone>; Fax: <fax>+81 3 5449 5133</fax>; Email: <email>knakai@ims.u-tokyo.ac.jp</email></corresp></author-notes><pub-date pub-type="ppub"><month>2</month><year>2009</year></pub-date><pub-date pub-type="epub"><day>23</day><month>12</month><year>2008</year></pub-date><pub-date pub-type="pmc-release"><day>23</day><month>12</month><year>2008</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on the							<pub-date pub-type="epub"/>. --><volume>37</volume><issue>3</issue><fpage>939</fpage><lpage>944</lpage><history><date date-type="received"><day>24</day><month>9</month><year>2008</year></date><date date-type="rev-recd"><day>12</day><month>11</month><year>2008</year></date><date date-type="accepted"><day>5</day><month>12</month><year>2008</year></date></history><permissions><copyright-statement>&#x000a9; 2008 The Author(s)</copyright-statement><copyright-year>2008</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/"><license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">http://creativecommons.org/licenses/by-nc/2.0/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p></license></permissions><abstract><p>To represent the sequence specificity of transcription factors, the position weight matrix (PWM) is widely used. In most cases, each element is defined as a log likelihood ratio of a base appearing at a certain position, which is estimated from a finite number of known binding sites. To avoid bias due to this small sample size, a certain numeric value, called a pseudocount, is usually allocated for each position, and its fraction according to the background base composition is added to each element. So far, there has been no consensus on the optimal pseudocount value. In this study, we simulated the sampling process by artificially generating binding sites based on observed nucleotide frequencies in a public PWM database, and then the generated matrix with an added pseudocount value was compared to the original frequency matrix using various measures. Although the results were somewhat different between measures, in many cases, we could find an optimal pseudocount value for each matrix. These optimal values are independent of the sample size and are clearly correlated with the entropy of the original matrices, meaning that larger pseudocount vales are preferable for less conserved binding sites. As a simple representative, we suggest the value of 0.8 for practical uses.</p></abstract></article-meta></front><body><sec><title>INTRODUCTION</title><p>Transcription factors regulate gene expression by binding to <italic>cis</italic>-regulatory elements in DNA. These binding sites typically exhibit characteristic sequence patterns, called &#x02018;motifs&#x02019;. Experimental discovery of binding sites, however, remains non-trivial. So, although not all motifs are known and motif models are immature, motif matching is widely used to predict binding sites in DNA sequences.</p><p>The position weight matrix (PWM) is a common way of representing a motif (<xref ref-type="bibr" rid="B1">1</xref>). A PWM has a numeric score for each of the four nucleotide types (rows) at each position in the motif (columns). It can be scanned across a DNA sequence to predict binding sites, as follows. If the PWM has width <italic>w</italic>, each <italic>w</italic>-long window of DNA (<italic>w</italic>-mer) receives a score obtained by summing the scores of the nucleotides at each position. If the <italic>w</italic>-mer score exceeds some threshold, it is predicted as a binding site.</p><p>A PWM is usually created from a position frequency matrix (PFM) via a position probability matrix (PPM). The PFM is constructed from a sample of binding sites, by counting the number of nucleotides of each type (row) at each position (column). The PPM is just a probabilistically normalized form of the PFM, so that each column sums to 1. Finally, the PWM is obtained by logarithmic transformation of the PPM divided by the nucleotides&#x02019; background probabilities. Thus, PWM scores are log likelihood ratios. Motif matrices are often visualized as sequence logos (e.g. <xref ref-type="fig" rid="F1">Figure 1</xref>A) (<xref ref-type="bibr" rid="B2">2</xref>).<fig id="F1" position="float"><label>Figure 1.</label><caption><p>Pseudocount evaluations for JASPAR matrix &#x02018;MA0001&#x02019; with a sample size of 30. (<bold>A</bold>) Sequence Logo for MA0001. (<bold>B</bold>) Normalized values of the matrix based comparison methods: ED = Euclidean Distance; COS = Cosine distance; TVD = Total Variation Distance. Each line represents the average of 100 sampling replicates. Error bars show standard deviations of replicates. The comparison values are normalized to the range 0&#x02013;1. (C) Normalized values of the sequence-based comparison methods: SRC = Spearman's Rank Correlation.</p></caption><graphic xlink:href="gkn1019f1"/></fig></p><p>Starting from a small sample of binding sites, we will often get zeros in the PFM, leading to zeros in the PPM and negative infinities in the PWM: this is frequently regarded as undesirable (<xref ref-type="bibr" rid="B3">3</xref>). The reasoning is that nucleotides that can occur in the motif will often be absent from a small sample by chance, and assigning them a probability of zero is too harsh. It is important to distinguish this motivation from the merely technical issue that it can be troublesome to deal with negative infinity using computers. In any case, it is common practice to add so-called pseudocounts to the PFM, in order to avoid zero probabilities. Pseudocounts can also be motivated by a Bayesian approach: if we assume a Dirichlet prior distribution for nucleotide frequencies, then the posterior mean estimator is equivalent to adding pseudocounts to the observed counts (<xref ref-type="bibr" rid="B3">3</xref>).</p><p>In spite of the ubiquity of pseudocounts, there is no standard way of choosing them. Many types of pseudocounts are used, 0.01 (<xref ref-type="bibr" rid="B4">4</xref>), 1 (<xref ref-type="bibr" rid="B5">5</xref>), 1.5 (<xref ref-type="bibr" rid="B6">6</xref>), 2 (<xref ref-type="bibr" rid="B7">7</xref>), 4 (<xref ref-type="bibr" rid="B8">8</xref>) and the square root of the number of binding sites in the sample (<xref ref-type="bibr" rid="B9">9</xref>). (In this article, when we speak of a pseudocount of, e.g. 1.5, we mean that 1.5/4 is added to each of the four counts in a column.) Frith <italic>et al.</italic> chose pseudocounts by fitting a Dirichlet prior to motifs in the TRANSFAC database (<xref ref-type="bibr" rid="B6">6</xref>). However, the actual effect of changing pseudocount values has not been studied systematically: detailed evaluations have been made only for protein motifs (<xref ref-type="bibr" rid="B10 B11 B12">10&#x02013;12</xref>). Therefore, more practical analysis is required for DNA motifs.</p><p>Here, we evaluate pseudocount choices using known transcription factor binding sites. The main approach in this study is comparison between an original PPM, which we regard as representing the real sequence specificity of each transcription factor, and a sampled PPM with pseudocounts. The sampled motif matrix is created by stochastic generation from the original PPM. The results show how different pseudocount choices affect the similarity of the original and sampled PPMs. Our results provide guidance on choosing pseudocounts for motif matching.</p></sec><sec sec-type="materials|methods"><title>MATERIALS AND METHODS</title><sec><title>JASPAR dataset</title><p>We obtained PFMs from the JASPAR database (<xref ref-type="bibr" rid="B13">13</xref>). JASPAR provides non-redundant experimentally defined transcription factor binding site motifs for multicellular eukaryotes. JASPAR CORE 2008 has 138 motifs, and provides the original sample of binding sites for 124 of these. We removed matrices that have no binding sites. Additionally, the samples &#x02018;MA0030.sites&#x02019; and &#x02018;MA0031.sites&#x02019; are identical. Therefore we removed these two. Finally we obtained 122 PFMs.</p></sec><sec><title>Sampled PFM from original PFM</title><p>To generate sequences from a JASPAR motif, we made a PPM from the PFM using the formula: <italic>p<sub>a,i</sub></italic> = <italic>c<sub>a,i/</sub>m</italic>. <italic>p<sub>a,i</sub></italic> is the probability of nucleotide <italic>a</italic> in position <italic>i</italic>; <italic>c<sub>a,i</sub></italic> is the observed count of nucleotide <italic>a</italic> in position <italic>i</italic>; and <italic>m</italic> is the number of sequences. Using these probabilities, we generated sequences randomly as virtual transcription factor binding sites. In this study, we generated sets of 10, 20, 30, 40 and 50 sequences.</p></sec><sec><title>Pseudocount addition</title><p>For each sampled PFM, we made a sampled PPM by adding pseudocounts:<disp-formula><graphic xlink:href="gkn1019um1"/></disp-formula><italic>B</italic> is the pseudocount; <italic>c&#x02019;<sub>a,i</sub></italic> is an element of the sampled PFM; <italic>p&#x02019;<sub>a,i</sub></italic> is an element of the sampled PPM. We tried exponentially stepped pseudocounts between 0.01 and 10.0 in this study. This range includes most pseudocounts used previously, such as the one derived by Dirichlet fitting (<xref ref-type="bibr" rid="B6">6</xref>). The comparison of original PPMs to sampled PPMs indicates which pseudocount is optimal. We tried seven types of comparison function in this study: see below. To obtain more accurate results, we performed 100 replicates for each combination of motif, comparison method, pseudocount and number of generated sequences.</p></sec><sec><title>Comparison procedures</title><p>For comparing original PPMs and sampled PPMs, we used seven methods, in two categories. One category is matrix-based comparison: comparison of corresponding elements of matrices. The other category is sequence-based comparison, which involves enumeration of all possible <italic>w</italic>-mers. The probability <italic>s</italic> that a PPM generates a <italic>w</italic>-mer is<disp-formula><graphic xlink:href="gkn1019um2"/></disp-formula></p><p>The probabilities of generating each <italic>w</italic>-mer from both the original and generated PPMs were used in the comparison function. Thus, matrix-based comparison tests how accurately the original matrix is recovered, whereas sequence-based comparison tests how accurately the matrix's function is recovered.</p><p>Enumeration of all <italic>w</italic>-mers for large motifs requires prohibitive calculation time. Therefore we removed motif positions with higher entropy. The upper limit for motif length is 10. If the original motif was longer than 10, we used only the 10 consecutive positions with minimum entropy. The formula for entropy <italic>h</italic> is<disp-formula><graphic xlink:href="gkn1019um3"/></disp-formula>52 motifs were trimmed in our dataset, for sequence-based comparisons. Omitting high-entropy positions introduces a bias (for sequence-based comparisons only), but the alternative&#x02014;omitting large motifs&#x02014;may also introduce a bias, so there is no ideal solution.</p></sec><sec><title>Comparison functions</title><p>Euclidean distance (ED) was used to compare motifs. The formula for matrix-based comparison is<disp-formula><graphic xlink:href="gkn1019um4"/></disp-formula>The formula for sequence-based comparison is<disp-formula><graphic xlink:href="gkn1019um5"/></disp-formula><italic>s<sub>j</sub></italic> is the generation probability of sequence <italic>j</italic> from the original PPM; <italic>s&#x02019;<sub>j</sub></italic> is generation probability of the same sequence from the sampled PPM.</p><p>Cosine distance (COS) was also used to compare motifs. The formula for matrix-based comparison is<disp-formula><graphic xlink:href="gkn1019um6"/></disp-formula>The formula for sequence-based comparison is<disp-formula><graphic xlink:href="gkn1019um7"/></disp-formula>Total variation distance (TVD) is another comparison function for probabilities. For matrix-based comparison, we averaged the TVD for each column:<disp-formula><graphic xlink:href="gkn1019um8"/></disp-formula>The formula for sequence-based comparison is<disp-formula><graphic xlink:href="gkn1019um9"/></disp-formula>Finally, Spearman's Rank Correlation (SRC) was also used for sequence-based comparison of motifs. Thus, the probabilities of each <italic>w</italic>-mer were converted to ranks. We calculated SRC using R (a free software environment for statistical computing and graphics). In many cases, the original PPMs contain several zero elements, creating many tied ranks corresponding to zero sequence probabilities. In order to break some of these ties, we added a tiny pseudocount of 1.0 &#x000d7; 10<sup>&#x02013;10</sup> to the original PFM. This causes <italic>w</italic>-mers with one &#x02018;zero&#x02019; nucleotide to rank higher than <italic>w</italic>-mers with two &#x02018;zero&#x02019; nucleotides, and gives more sensible results in practice (not shown). The correlation value calculated by <italic>R</italic> was transformed to 1 &#x02013; correlation.</p><p>We tried 61 pseudocounts for ED, COS and TVD. Due to heavy calculation time, we tried only 10 pseudocount values between 0.01 and 10.0 for SRC.<disp-formula><graphic xlink:href="gkn1019um10"/></disp-formula>For ED, COS and TVD, <italic>x</italic> is {0, 1, 2, &#x02026; , 60} and <italic>y</italic> is 20. For SRC, <italic>x</italic> is {0, 1, 2, &#x02026; , 9} and <italic>y</italic> is 3.</p></sec></sec><sec><title>RESULTS AND DISCUSSION</title><sec><title>Differences between the seven comparison methods</title><p>As an example, we show the results for a typical matrix, MA0001 (transcription factor AGL3 in <italic>Arabidopsis thaliana</italic>), with 30 generated sequences (<xref ref-type="fig" rid="F1">Figure 1</xref>). Interestingly, most of the comparison methods exhibit minimum distances at pseudocount values close to 1. The distances increase rapidly for pseudocounts greater than 1, and only slightly, if at all, for values less than 1. The SRC, however, has a different behavior: it clearly favors pseudocounts much less than 1.</p></sec><sec><title>Effect of sample size</title><p><xref ref-type="fig" rid="F2">Figure 2</xref> indicates the results for matrix MA0001 for various sample sizes, using three comparison methods: matrix-based ED (A), sequence-based ED (B) and SRC (C). Pseudocount values close to 1 tend to minimize ED for all sample sizes, but this effect is more marked for small samples. In particular, pseudocounts much less than 1 give almost equal distances for large samples, but clearly greater distances for small samples. (Sequence-based EDs vary more than matrix-based EDs, because they are distances in a space of much higher dimensionality.) The SRC, however, is always optimized with pseudocount values much below 1, and this effect becomes more marked with larger sample sizes. Similar behavior is observed in results averaged over all motifs (<ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkn1019/DC1">Supplementary Figure 1</ext-link>).<fig id="F2" position="float"><label>Figure 2.</label><caption><p>Pseudocount evaluations for JASPAR matrix &#x02018;MA0001&#x02019;: all sample sizes. For easier visualization, each line has been shifted vertically by subtracting its minimum value. Sample sizes are indicated on the right of each graph. (<bold>A</bold>) Matrix-based ED. (<bold>B</bold>) Sequence-based ED. (<bold>C</bold>) SRC.</p></caption><graphic xlink:href="gkn1019f2"/></fig></p></sec><sec><title>Existence of an optimal pseudocount</title><p><xref ref-type="table" rid="T1">Table 1</xref> indicates how often there is an optimal pseudocount value (giving minimum distance) other than 0.01 or 10.0, for each comparison method and sample size. These are pooled results for all 122 JASPAR motifs. When using SRC or TVD, the smallest distance is usually achieved with a pseudocount of 0.01 (the lowest that we tested), so smaller pseudocounts are better, and there is no optimum within the range that we examined. When using ED or COS, on the other hand, there is nearly always an optimal pseudocount within this range.<table-wrap id="T1" position="float"><label>Table 1.</label><caption><p>Percentage of optimal pseudocount existence</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Sample size</th><th colspan="3" rowspan="1">Matrix-based<hr/></th><th colspan="4" rowspan="1">Sequence-based<hr/></th></tr><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">ED (%)</th><th rowspan="1" colspan="1">COS (%)</th><th rowspan="1" colspan="1">TVD (%)</th><th rowspan="1" colspan="1">ED (%)</th><th rowspan="1" colspan="1">COS (%)</th><th rowspan="1" colspan="1">TVD (%)</th><th rowspan="1" colspan="1">SRC (%)</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">10</td><td rowspan="1" colspan="1">99.2</td><td rowspan="1" colspan="1">100.0</td><td rowspan="1" colspan="1">28.7</td><td rowspan="1" colspan="1">100.0</td><td rowspan="1" colspan="1">95.9</td><td rowspan="1" colspan="1">54.1</td><td rowspan="1" colspan="1">45.9</td></tr><tr><td rowspan="1" colspan="1">20</td><td rowspan="1" colspan="1">99.2</td><td rowspan="1" colspan="1">100.0</td><td rowspan="1" colspan="1">16.4</td><td rowspan="1" colspan="1">99.2</td><td rowspan="1" colspan="1">95.9</td><td rowspan="1" colspan="1">26.2</td><td rowspan="1" colspan="1">34.4</td></tr><tr><td rowspan="1" colspan="1">30</td><td rowspan="1" colspan="1">100.0</td><td rowspan="1" colspan="1">100.0</td><td rowspan="1" colspan="1">13.1</td><td rowspan="1" colspan="1">100.0</td><td rowspan="1" colspan="1">94.3</td><td rowspan="1" colspan="1">13.1</td><td rowspan="1" colspan="1">20.5</td></tr><tr><td rowspan="1" colspan="1">40</td><td rowspan="1" colspan="1">100.0</td><td rowspan="1" colspan="1">100.0</td><td rowspan="1" colspan="1">9.0</td><td rowspan="1" colspan="1">99.2</td><td rowspan="1" colspan="1">95.1</td><td rowspan="1" colspan="1">11.5</td><td rowspan="1" colspan="1">14.8</td></tr><tr><td rowspan="1" colspan="1">50</td><td rowspan="1" colspan="1">100.0</td><td rowspan="1" colspan="1">99.2</td><td rowspan="1" colspan="1">10.7</td><td rowspan="1" colspan="1">99.2</td><td rowspan="1" colspan="1">95.1</td><td rowspan="1" colspan="1">9.0</td><td rowspan="1" colspan="1">5.7</td></tr></tbody></table></table-wrap></p></sec><sec><title>Dependence of optimal pseudocount on sample size and entropy</title><p><xref ref-type="fig" rid="F3">Figure 3</xref> shows how the optimal pseudocount values vary with sample size. In panels A and B, each line indicates one motif, and the color represents the average entropy of the original PPM: red indicates higher entropy; blue indicates lower entropy. Perhaps surprisingly, optimal pseudocount values are not strongly influenced by sample size in most cases. Increasing sample size leads to more accurate motifs, so pseudocounts should be less necessary. On the other hand, increasing sample size reduces the impact of pseudocounts. We infer that these two effects cancel each other, when using ED. In any case, the average optimal pseudocount over all motifs lies between 0.8 and 1.3 (<xref ref-type="fig" rid="F3">Figure 3</xref>C). Similar behavior is observed when we use 15 well-characterized motifs, which are derived from at least 50 sequences (<ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkn1019/DC1">Supplementary Figure 2</ext-link>).<fig id="F3" position="float"><label>Figure 3.</label><caption><p>(In)dependence of optimal pseudocounts on sample size. (<bold>A</bold>) Optimal pseudocounts using matrix-based ED. One line indicates one motif, colored by the column-wise average entropy of the original matrix. (<bold>B</bold>) Optimal pseudocounts using sequence-based ED. (<bold>C</bold>) Average optimal pseudocount over all motifs. The comparison methods are noted on the right: Mat ED = Matrix-based ED; Mat COS = Matrix-based COS; Seq ED = Sequence-based ED; Seq COS = Sequence-based COS.</p></caption><graphic xlink:href="gkn1019f3"/></fig></p><p><xref ref-type="fig" rid="F3">Figure 3</xref>A and B also show that motifs with higher entropy have larger optimal pseudocounts, and vice versa. <xref ref-type="fig" rid="F4">Figure 4</xref> shows this more clearly: the optimal pseudocount is tightly correlated with the average entropy of the original matrix. Unfortunately, in practical applications we only have the sample, and we do not know the entropy of the &#x02018;original&#x02019; motif. On the other hand, it is also possible to regard the entropy of the original matrix as that of an observed one and to further optimize the pseudocount value by regression for each matrix or even for each column of the matrix. We confirmed that these methods decreased the average distance but the effect was not drastic (data not shown). For practical use, considering that optimal pseudocounts are usually close to 1 (<ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkn1019/DC1">Supplementary Figure 3</ext-link>) and that too-small pseudocounts are preferable to too-large ones for all our measures, we suggest a uniform value of 0.8, for example.<fig id="F4" position="float"><label>Figure 4.</label><caption><p>Dependence of optimal pseudocounts on average entropy. (<bold>A</bold>) Optimal pseudocounts using matrix-based ED. The correlation coefficient is 0.93, the correlation <italic>P</italic>-value is less than 2.2 &#x000d7; 10<sup>&#x02013;16</sup>, and the <italic>R</italic><sup>2</sup> value is 0.95. (<bold>B</bold>) Optimal pseudocounts using sequence-based ED. The correlation coefficient is 0.93, the correlation <italic>P</italic>-value is less than 2.2 &#x000d7; 10<sup>&#x02013;16</sup> and the <italic>R</italic><sup>2</sup> value is 0.85.</p></caption><graphic xlink:href="gkn1019f4"/></fig></p></sec><sec><title>Confirmation using real sequences</title><p>The results described above were obtained using virtual binding site samples generated from an original PPM. We repeated our tests by, instead, sampling with replacement from the real binding site sequences upon which the JASPAR matrices are based. These results are essentially the same as those above (not shown).</p></sec></sec><sec sec-type="conclusions"><title>CONCLUSIONS</title><p>Although optimal pseudocount values depend on the comparison method, we can draw some general conclusions. First, all comparison methods indicate that pseudocounts much above 1 are a poor choice. This argues against using the square root of the sample size (<xref ref-type="bibr" rid="B9">9</xref>). It also argues for using values below 4, corresponding to Dirichlet priors with an anti-peaked shape, as suggested previously (<xref ref-type="bibr" rid="B6">6</xref>). (The value 4&#x02014;more generally, the alphabet size&#x02014;is special because it corresponds to an uninformed prior.) The results using ED and COS suggest that values close to 1 are optimal, although the optimal pseudocount depends on the entropy of the original motif (which is unknown in practice). This supports the choice of Hughes <italic>et al.</italic> to use a pseudocount of 1 (<xref ref-type="bibr" rid="B5">5</xref>). For large sample sizes, however, pseudocounts much less than one are only marginally worse. Several previous studies have examined methods to compare motif matrices, although not with the aim of optimizing pseudocounts (<xref ref-type="bibr" rid="B14 B15 B16">14&#x02013;16</xref>): they have generally concluded that ED is a good measure for their purposes.</p><p>On the other hand, the results using SRC and TVD support the use of pseudocounts much less than 1, e.g. Ref. (4). It could be argued that SRC is the most relevant measure for motif scanning, since one typically makes predictions for all <italic>w</italic>-mers that score above some threshold, i.e. all <italic>w</italic>-mers above some rank. To maximize the correlation between the predicted ranks and the true ranks, it seems best to use a very low pseudocount. Thus, the widespread belief that zeros should be avoided in motif matrices may be incorrect, at least for DNA motifs. In summary, depending on the comparison method, optimal pseudocounts for transcription factor binding motifs are either around 1, or very low.</p><p>It is noteworthy that our main conclusions (data size independency and correlation with entropy) for the cases when optimal values exist have been obtained by a totally different approach on a different system also (<xref ref-type="bibr" rid="B17">17</xref>). This agreement between our relatively empirical and intuitive approach and their theoretical approach should strengthen the validity of our conclusions.</p></sec><sec><title>Supplementary Data</title><p><ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gkn1019/DC1">Supplementary Data</ext-link> are available at NAR Online.</p></sec><sec><title>FUNDING</title><p>This work was supported in part by Global COE Program (Center of Education and Research for Advanced Genome-Based Medicine), MEXT, Japan. Funding for open access charge: Japan Science and Technology Agency (JST).</p><p><italic>Conflict of interest statement</italic>. None declared.</p></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material id="PMC_1" content-type="local-data"><caption><title>[Supplementary Data]</title></caption><media mimetype="text" mime-subtype="html" xlink:href="gkn1019_index.html"/><media xlink:role="associated-file" mimetype="application" mime-subtype="msword" xlink:href="gkn1019_nar-01993-s-2008-File013.doc"/><media xlink:role="associated-file" mimetype="application" mime-subtype="vnd.ms-powerpoint" xlink:href="gkn1019_nar-01993-s-2008-File014.ppt"/><media xlink:role="associated-file" mimetype="application" mime-subtype="vnd.ms-excel" xlink:href="gkn1019_nar-01993-s-2008-File015.xls"/></supplementary-material></sec></body><back><ack><title>ACKNOWLEDGEMENTS</title><p>The authors would like to thank Riu Yamashita and Nicolas Sierro for helpful discussion and critical remarks. They also thank Stephen F. Altschul for letting us read their manuscript before submission. Computational time was provided by the Super Computer System, Human Genome Center, Institute of Medical Science, The University of Tokyo.</p></ack><ref-list><title>REFERENCES</title><ref id="B1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wasserman</surname><given-names>WW</given-names></name><name><surname>Sandelin</surname><given-names>A</given-names></name></person-group><article-title>Applied bioinformatics for the identification of regulatory elements</article-title><source>Nat. Rev. Genet.</source><year>2004</year><volume>5</volume><fpage>276</fpage><lpage>287</lpage><pub-id pub-id-type="pmid">15131651</pub-id></element-citation></ref><ref id="B2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schneider</surname><given-names>TD</given-names></name><name><surname>Stephens</surname><given-names>RM</given-names></name></person-group><article-title>Sequence logos: a new way to display consensus sequences</article-title><source>Nucleic Acids Res.</source><year>1990</year><volume>18</volume><fpage>6097</fpage><lpage>6100</lpage><pub-id pub-id-type="pmid">2172928</pub-id></element-citation></ref><ref id="B3"><label>3</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Durbin</surname><given-names>R</given-names></name><name><surname>Eddy</surname><given-names>SR</given-names></name><name><surname>Krogh</surname><given-names>A</given-names></name><name><surname>Mitchison</surname><given-names>G</given-names></name></person-group><source>Biological Sequence Analysis: Probabilistic Models of Proteins and Nucleic Acids.</source><year>1998</year><publisher-loc>Cambridge, UK</publisher-loc><publisher-name>Cambridge University Press</publisher-name></element-citation></ref><ref id="B4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>QK</given-names></name><name><surname>Hertz</surname><given-names>GZ</given-names></name><name><surname>Stormo</surname><given-names>GD</given-names></name></person-group><article-title>MATRIX SEARCH 1.0: a computer program that scans DNA sequences for transcriptional elements using a database of weight matrices</article-title><source>Comput. Appl. Biosci.</source><year>1995</year><volume>11</volume><fpage>563</fpage><lpage>566</lpage><pub-id pub-id-type="pmid">8590181</pub-id></element-citation></ref><ref id="B5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hughes</surname><given-names>JD</given-names></name><name><surname>Estep</surname><given-names>PW</given-names></name><name><surname>Tavazoie</surname><given-names>S</given-names></name><name><surname>Church</surname><given-names>GM</given-names></name></person-group><article-title>Computational identification of cis-regulatory elements associated with groups of functionally related genes in Saccharomyces cerevisiae</article-title><source>J. Mol. Biol.</source><year>2000</year><volume>296</volume><fpage>1205</fpage><lpage>1214</lpage><pub-id pub-id-type="pmid">10698627</pub-id></element-citation></ref><ref id="B6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frith</surname><given-names>MC</given-names></name><name><surname>Fu</surname><given-names>Y</given-names></name><name><surname>Yu</surname><given-names>L</given-names></name><name><surname>Chen</surname><given-names>JF</given-names></name><name><surname>Hansen</surname><given-names>U</given-names></name><name><surname>Weng</surname><given-names>Z</given-names></name></person-group><article-title>Detection of functional DNA motifs via statistical over-representation</article-title><source>Nucleic Acids Res.</source><year>2004</year><volume>32</volume><fpage>1372</fpage><lpage>1381</lpage><pub-id pub-id-type="pmid">14988425</pub-id></element-citation></ref><ref id="B7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mironov</surname><given-names>AA</given-names></name><name><surname>Koonin</surname><given-names>EV</given-names></name><name><surname>Roytberg</surname><given-names>MA</given-names></name><name><surname>Gelfand</surname><given-names>MS</given-names></name></person-group><article-title>Computer analysis of transcription regulatory patterns in completely sequenced bacterial genomes</article-title><source>Nucleic Acids Res.</source><year>1999</year><volume>27</volume><fpage>2981</fpage><lpage>2989</lpage><pub-id pub-id-type="pmid">10390542</pub-id></element-citation></ref><ref id="B8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berg</surname><given-names>OG</given-names></name><name><surname>von Hippel</surname><given-names>PH</given-names></name></person-group><article-title>Selection of DNA binding sites by regulatory proteins. Statistical-mechanical theory and application to operators and promoters</article-title><source>J. Mol. Biol.</source><year>1987</year><volume>193</volume><fpage>723</fpage><lpage>750</lpage><pub-id pub-id-type="pmid">3612791</pub-id></element-citation></ref><ref id="B9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lawrence</surname><given-names>CE</given-names></name><name><surname>Altschul</surname><given-names>SF</given-names></name><name><surname>Boguski</surname><given-names>MS</given-names></name><name><surname>Liu</surname><given-names>JS</given-names></name><name><surname>Neuwald</surname><given-names>AF</given-names></name><name><surname>Wootton</surname><given-names>JC</given-names></name></person-group><article-title>Detecting subtle sequence signals: a Gibbs sampling strategy for multiple alignment</article-title><source>Science</source><year>1993</year><volume>262</volume><fpage>208</fpage><lpage>214</lpage><pub-id pub-id-type="pmid">8211139</pub-id></element-citation></ref><ref id="B10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tatusov</surname><given-names>RL</given-names></name><name><surname>Altschul</surname><given-names>SF</given-names></name><name><surname>Koonin</surname><given-names>EV</given-names></name></person-group><article-title>Detection of conserved segments in proteins: iterative scanning of sequence databases with alignment blocks</article-title><source>Proc. Natl Acad. Sci. USA</source><year>1994</year><volume>91</volume><fpage>12091</fpage><lpage>12095</lpage><pub-id pub-id-type="pmid">7991589</pub-id></element-citation></ref><ref id="B11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Karplus</surname><given-names>M</given-names></name><name><surname>Sali</surname><given-names>A</given-names></name></person-group><article-title>Theoretical studies of protein folding and unfolding</article-title><source>Curr. Opin. Struct. Biol.</source><year>1995</year><volume>5</volume><fpage>58</fpage><lpage>73</lpage><pub-id pub-id-type="pmid">7773748</pub-id></element-citation></ref><ref id="B12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Henikoff</surname><given-names>JG</given-names></name><name><surname>Henikoff</surname><given-names>S</given-names></name></person-group><article-title>Using substitution probabilities to improve position-specific scoring matrices</article-title><source>Comput. Appl. Biosci.</source><year>1996</year><volume>12</volume><fpage>135</fpage><lpage>143</lpage><pub-id pub-id-type="pmid">8744776</pub-id></element-citation></ref><ref id="B13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sandelin</surname><given-names>A</given-names></name><name><surname>Alkema</surname><given-names>W</given-names></name><name><surname>Engstrom</surname><given-names>P</given-names></name><name><surname>Wasserman</surname><given-names>WW</given-names></name><name><surname>Lenhard</surname><given-names>B</given-names></name></person-group><article-title>JASPAR: an open-access database for eukaryotic transcription factor binding profiles</article-title><source>Nucleic Acids Res.</source><year>2004</year><volume>32</volume><fpage>D91</fpage><lpage>D94</lpage><pub-id pub-id-type="pmid">14681366</pub-id></element-citation></ref><ref id="B14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gupta</surname><given-names>S</given-names></name><name><surname>Stamatoyannopoulos</surname><given-names>JA</given-names></name><name><surname>Bailey</surname><given-names>TL</given-names></name><name><surname>Noble</surname><given-names>WS</given-names></name></person-group><article-title>Quantifying similarity between motifs</article-title><source>Genome Biol.</source><year>2007</year><volume>8</volume><fpage>R24</fpage><pub-id pub-id-type="pmid">17324271</pub-id></element-citation></ref><ref id="B15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mahony</surname><given-names>S</given-names></name><name><surname>Auron</surname><given-names>PE</given-names></name><name><surname>Benos</surname><given-names>PV</given-names></name></person-group><article-title>DNA familial binding profiles made easy: comparison of various motif alignment and clustering strategies</article-title><source>PLoS Comput. Biol.</source><year>2007</year><volume>3</volume><fpage>e61</fpage><pub-id pub-id-type="pmid">17397256</pub-id></element-citation></ref><ref id="B16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pape</surname><given-names>UJ</given-names></name><name><surname>Rahmann</surname><given-names>S</given-names></name><name><surname>Vingron</surname><given-names>M</given-names></name></person-group><article-title>Natural similarity measures between position frequency matrices with an application to clustering</article-title><source>Bioinformatics</source><year>2008</year><volume>24</volume><fpage>350</fpage><lpage>357</lpage><pub-id pub-id-type="pmid">18174183</pub-id></element-citation></ref><ref id="B17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Altschul</surname><given-names>SF</given-names></name><name><surname>Gertz</surname><given-names>EM</given-names></name><name><surname>Agarwala</surname><given-names>R</given-names></name><name><surname>Schaffer</surname><given-names>AA</given-names></name><name><surname>Yu</surname><given-names>Yi-K</given-names></name></person-group><article-title>PSI-BLAST pseudocounts and the minimum description length principle</article-title><source>Nucleic Acids Res.</source><year>2009</year><comment>doi:10.1093/nar/gkn981</comment></element-citation></ref></ref-list></back></article>