<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd"><article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article" xml:lang="EN"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id><journal-id journal-id-type="publisher-id">bioinformatics</journal-id><journal-id journal-id-type="hwp">bioinfo</journal-id><journal-title>Bioinformatics</journal-title><issn pub-type="ppub">1367-4803</issn><issn pub-type="epub">1460-2059</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">18990723</article-id><article-id pub-id-type="pmc">2638939</article-id><article-id pub-id-type="doi">10.1093/bioinformatics/btn567</article-id><article-id pub-id-type="publisher-id">btn567</article-id><article-categories><subj-group subj-group-type="heading"><subject>Applications Note</subject><subj-group><subject>Sequence Analysis</subject></subj-group></subj-group></article-categories><title-group><article-title>R<sc>ankprop</sc>: a web server for protein remote homology detection</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Melvin</surname><given-names>Iain</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref><xref ref-type="corresp" rid="COR1">*</xref></contrib><contrib contrib-type="author"><name><surname>Weston</surname><given-names>Jason</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Leslie</surname><given-names>Christina</given-names></name><xref ref-type="aff" rid="AFF1"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Noble</surname><given-names>William Stafford</given-names></name><xref ref-type="aff" rid="AFF1"><sup>3</sup></xref><xref ref-type="aff" rid="AFF1"><sup>4</sup></xref><xref ref-type="corresp" rid="COR1">*</xref></contrib></contrib-group><aff id="AFF1"><sup>1</sup>NEC Laboratories of America, Princeton, NJ, <sup>2</sup>Computational Biology Program, Sloan-Kettering Institute, Memorial Sloan-Kettering Cancer Center, New York, NY, <sup>3</sup>Department of Genome Sciences and <sup>4</sup>Department of Computer Science and Engineering, University of Washington, Seattle, WA, USA</aff><author-notes><corresp id="COR1">*To whom correspondence should be addressed.</corresp><fn><p>Associate Editor: Burkhard Rost</p></fn></author-notes><pub-date pub-type="ppub"><day>1</day><month>1</month><year>2009</year></pub-date><pub-date pub-type="epub"><day>6</day><month>11</month><year>2008</year></pub-date><pub-date pub-type="pmc-release"><day>6</day><month>11</month><year>2008</year></pub-date><volume>25</volume><issue>1</issue><fpage>121</fpage><lpage>122</lpage><history><date date-type="received"><day>26</day><month>6</month><year>2008</year></date><date date-type="rev-recd"><day>29</day><month>10</month><year>2008</year></date><date date-type="accepted"><day>29</day><month>10</month><year>2008</year></date></history><permissions><copyright-statement>&#x000a9; 2008 The Author(s)</copyright-statement><copyright-year>2008</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/"><p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">http://creativecommons.org/licenses/by-nc/2.0/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</p></license></permissions><abstract><p><bold>Summary:</bold> We present a large-scale implementation of the R<sc>ankprop</sc> protein homology ranking algorithm in the form of an openly accessible web server. We use the NRDB40 PSI-BLAST all-versus-all protein similarity network of 1.1 million proteins to construct the graph for the R<sc>ankprop</sc> algorithm, whereas previously, results were only reported for a database of 108 000 proteins. We also describe two algorithmic improvements to the original algorithm, including propagation from multiple homologs of the query and better normalization of ranking scores, that lead to higher accuracy and to scores with a probabilistic interpretation.</p><p><bold>Availability:</bold> The R<sc>ankprop</sc> web server and source code are available at <ext-link ext-link-type="uri" xlink:href="http://rankprop.gs.washington.edu">http://rankprop.gs.washington.edu</ext-link></p><p><bold>Contact:</bold> <email>iain@nec-labs.com</email>; <email>noble@gs.washington.edu</email></p></abstract></article-meta></front><body><sec sec-type="intro" id="SEC1"><title>1 INTRODUCTION</title><p>R<sc>ankprop</sc> (Weston <italic>et al.</italic>, <xref ref-type="bibr" rid="B4">2004</xref>) is a network-based inference algorithm for identifying subtle protein sequence similarities, corresponding to remote homology relationships or to structural similarities. The algorithm operates on a <italic>protein similarity network</italic>, a graph in which each node is a protein and each weighted edge connecting two proteins indicates their similarity. Such a network can be built using existing tools, such as PSI-BLAST (Altschul <italic>et al.</italic>, <xref ref-type="bibr" rid="B1">1997</xref>).</p><p>The key idea of the R<sc>ankprop</sc> algorithm is to extract global information from a protein similarity network by propagating outward from a user-specified query protein. Effectively, the algorithm sums over all possible paths from the query to each target protein. Thus, after propagation, the resulting activation score for each node includes global information about that protein's relationship to the query. Ranking proteins by these scores is analogous to performing a database search using a tool such as PSI-BLAST, except that the ranking induced by R<sc>ankprop</sc> reflects the global topology of the protein similarity network.</p><p>In (Weston <italic>et al.</italic>, <xref ref-type="bibr" rid="B4">2004</xref>), PSI-BLAST is used to measure sequence similarity, and the unnormalized weight for the edge from node <italic>i</italic> to node <italic>j</italic> is <italic>W</italic><sub><italic>ij</italic></sub>=exp(&#x02212;<italic>S</italic><sub><italic>j</italic></sub>(<italic>i</italic>)/&#x003c3;), where <italic>S</italic><sub><italic>j</italic></sub>(<italic>i</italic>) is the PSI-BLAST <italic>E</italic>-value assigned to protein <italic>i</italic> given query <italic>j</italic>, and the parameter &#x003c3; is a positive constant. Edges are only included in the network for <italic>E</italic>-values smaller than a fixed threshold. We obtain a stochastic connectivity matrix <italic>M</italic> for the protein similarity network by row-normalizing edge weights <italic>W</italic><sub><italic>ij</italic></sub> to obtain transition probabilities: <italic>M</italic><sub><italic>ij</italic></sub> = <italic>W</italic><sub><italic>ij</italic></sub> / &#x02211;<sub><italic>j</italic></sub> <italic>W</italic><sub><italic>ij</italic></sub>.</p><p>Given such a network and a query sequence <italic>q</italic>, the R<sc>ankprop</sc> algorithm is simple to describe. First, all nodes are assigned initial <italic>activation scores</italic> that reflect each target protein's similarity to <italic>q</italic>. Like the edge weights, these scores are computed from PSI-BLAST <italic>E</italic>-values using the same equation. At each iteration of the algorithm, the activation score at a given node is replaced by the weighted sum of the scores from all of its incoming edges. The update rule includes a diffusion constant &#x003b1; that controls the rate of diffusion through the network. Formally, we define the initial activation scores as <italic>P</italic><sup>0</sup><sub><italic>i</italic></sub>= exp(&#x02212;<italic>S</italic><sub><italic>q</italic></sub>(<italic>i</italic>)/&#x003c3;). Viewing <italic>P</italic><sup><italic>t</italic></sup> as the column vector of activation levels at iteration <italic>t</italic>, the algorithm is given by <italic>P</italic><sub><italic>i</italic></sub><sup><italic>t</italic>+1</sup>= &#x003b1;<italic>MP</italic><sub><italic>i</italic></sub><sup><italic>t</italic></sup>+<italic>P</italic><sub><italic>i</italic></sub><sup>0</sup> if <italic>P</italic><sub><italic>i</italic></sub>&#x02260;<italic>q</italic> and <italic>P</italic><sub><italic>i</italic></sub><sup><italic>t</italic>+1</sup> = 1 otherwise, where &#x003b1; &#x02208;(0,1). One can show that this iterative procedure converges to a fixed point, which in practice happens in a small number of iterations. The output of the R<sc>ankprop</sc> algorithm is a ranking of the nodes in the network according to their final activation values. Proteins that receive a high activation score are linked to the query via many strongly weighted paths and vice versa. A multidomain query protein will produce strong matches to any target protein that contains one or more of the query domains. A single domain query <italic>A</italic> may connect through a multidomain protein <italic>AB</italic> to infer a false relationship with <italic>B</italic>. However, previous work (Weston <italic>et al.</italic>, <xref ref-type="bibr" rid="B4">2004</xref>) has found that as long as the query sequence is connected to many other proteins, then the true homologs will be mutually reinforcing and receive a higher rank.</p><p>In this work, we extend the original R<sc>ankprop</sc> algorithm in two ways: (1) improving accuracy by propagating simultaneously from proteins that are very closely related to the query, and (2) improving the interpretability of the scores produced by R<sc>ankprop</sc> by empirically mapping them to probabilities. The mapped score can be interpreted as the probability that the target protein is a member of the same SCOP superfamily as the query. We also announce the availability of a free web server that allows individual queries against a protein similarity network derived from the NRDB40, comprising 1.1 million targets.</p></sec><sec sec-type="methods" id="SEC2"><title>2 METHODS</title><p>The R<sc>ankprop</sc> server uses the PSI-BLAST all-versus-all similarity matrix for NRDB40 provided by the PairsDB website (Heger <italic>et al.</italic>, <xref ref-type="bibr" rid="B2">2008</xref>). NRDB40 is a subset of the non-redundant sequence database, filtered so that no pairs exhibit &#x0003e;40% sequence identity.</p><p>We generalize the R<sc>ankprop</sc> algorithm to accept a set <italic>Q</italic> of query proteins, rather than a single query protein. To use this extra information we perform propagation as usual, but we constrain the activation scores for all the query points such that they are highly ranked. In particular, we choose the set <italic>Q</italic> to be all the proteins that have a match with the initial query <italic>q</italic> with a PSI-BLAST <italic>E</italic>-value&#x0003c;0.001. We then constrain our algorithm to have <italic>P</italic><sub><italic>j</italic></sub> = 1&#x02212;<italic>S</italic><sub><italic>q</italic></sub>(<italic>j</italic>), &#x02200; <italic>j</italic>&#x02208;<italic>Q</italic>. This modification is useful because, instead of propagating from a single query source node in the graph, we can propagate from several source nodes that all belong to the same family or superfamily that we are searching for.</p><p>The original R<sc>ankprop</sc> algorithm outputs scalar values that are not directly interpretable. In the new version of the algorithm, we map each R<sc>ankprop</sc> score to an estimate of the probability that the corresponding query and target proteins belong to the same structural superfamily. We employ the SCOP database (Murzin <italic>et al.</italic>, <xref ref-type="bibr" rid="B3">1995</xref>) to compute a histogram of empirical frequencies of the activation levels <italic>P</italic><sub><italic>i</italic></sub> for each protein <italic>i</italic>. More specifically, we choose bin centers <italic>v</italic><sub><italic>k</italic></sub> and compute the following quantities: <italic>n</italic><sub><italic>k</italic></sub>, the number of times <italic>P</italic><sub><italic>i</italic></sub> falls into bin <italic>v</italic><sub><italic>k</italic></sub>, and <italic>s</italic><sub><italic>n</italic></sub>, the number of times that the latter occurs and <italic>i</italic> is in the same superfamily as the query. We are interested in the value <italic>s</italic><sub><italic>k</italic></sub> / <italic>n</italic><sub><italic>k</italic></sub>, which can be interpreted as the probability for each activation value bin of the target being in the same superfamily as the query. We choose the bin centers <italic>v</italic>= (0,0.01,0.02,&#x02026;, 0.2 , 0.3 ,&#x02026;, 1), and we enforce monotonicity in the final output by setting <italic>p</italic><sub><italic>i</italic></sub>/<italic>n</italic><sub><italic>i</italic></sub> = <italic>p</italic><sub><italic>i&#x02212;1</italic></sub>/<italic>n</italic><sub><italic>i&#x02212;1</italic></sub> if <italic>p</italic><sub><italic>i</italic></sub>/<italic>n</italic><sub><italic>i</italic></sub>&#x0003c;<italic>p</italic><sub><italic>i</italic>&#x02212;1</sub>/<italic>n</italic><sub><italic>i&#x02212;1</italic></sub>.</p></sec><sec sec-type="results" id="SEC3"><title>3 RESULTS</title><p><xref ref-type="table" rid="T1">Table 1</xref> compares our large-scale R<sc>ankprop</sc> results with PSI-BLAST (using NRDB40 and the same blastpgp parameters as PairsDB: <monospace>&#x02212;j 10 &#x02212;e 1 &#x02212;h 0.001 &#x02212;b 10000 &#x02212;v 10000</monospace>) and the previously published version of R<sc>ankprop</sc> (using the SWISSPROT database, 108k proteins). R<sc>ankprop</sc> NRDB40 is a straightforward scaling up of the previous R<sc>ankprop</sc> algorithm to NRDB40. In addition, R<sc>ankprop</sc>+homologs NRDB40 employs the extensions described in <xref ref-type="sec" rid="SEC2">Section 2</xref>. Accuracy is measured following the methodology given in (Weston <italic>et al.</italic>, <xref ref-type="bibr" rid="B4">2004</xref>): SCOP version 1.59 is split into train and test portions, and hyperparameters are chosen by using the training set. Then, each test protein is treated as a query, and the quality of a method's protein ranking is measured by using the area under the receiver operating characteristic (ROC) curve, up to the first (ROC<sub>1</sub>) or 50th (ROC<sub>50</sub>) false positive. We report results as average ROC<sub>1</sub> and ROC<sub>50</sub> scores across all 3083 test proteins. Using a larger network yields improvements across all four performance metrics, and propagating from multiple queries improves the performance still further. A Wilcoxon signed rank test, corrected for multiple tests, shows that all differences in <xref ref-type="table" rid="T1">Table 1</xref> are significant at 0.01, except for the three pairs of methods marked with asterisks.</p><table-wrap id="T1" position="float"><label>Table 1.</label><caption><p>Ranking accuracy</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">Family</th><th rowspan="1" colspan="1">Family</th><th rowspan="1" colspan="1">S-Fam</th><th rowspan="1" colspan="1">S-Fam</th></tr><tr><th rowspan="1" colspan="1"/><th colspan="4" rowspan="1"><hr/></th></tr><tr><th rowspan="1" colspan="1">Method</th><th rowspan="1" colspan="1">ROC<sub>1</sub></th><th rowspan="1" colspan="1">ROC<sub>50</sub></th><th rowspan="1" colspan="1">ROC<sub>1</sub></th><th rowspan="1" colspan="1">ROC<sub>50</sub></th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">PSI-BLAST</td><td rowspan="1" colspan="1">0.833<xref ref-type="table-fn" rid="TF1">*</xref></td><td rowspan="1" colspan="1">0.851</td><td rowspan="1" colspan="1">0.609<xref ref-type="table-fn" rid="TF1">*</xref></td><td rowspan="1" colspan="1">0.628</td></tr><tr><td rowspan="1" colspan="1">RankProp SWISSPROT</td><td rowspan="1" colspan="1">0.816<xref ref-type="table-fn" rid="TF1">*</xref></td><td rowspan="1" colspan="1">0.906</td><td rowspan="1" colspan="1">0.592<xref ref-type="table-fn" rid="TF1">*</xref></td><td rowspan="1" colspan="1">0.725</td></tr><tr><td rowspan="1" colspan="1">RankProp NRDB40</td><td rowspan="1" colspan="1">0.872</td><td rowspan="1" colspan="1">0.923</td><td rowspan="1" colspan="1">0.696</td><td rowspan="1" colspan="1">0.779<xref ref-type="table-fn" rid="TF1">*</xref></td></tr><tr><td rowspan="1" colspan="1">RankProp+homologs NRDB40</td><td rowspan="1" colspan="1">0.884</td><td rowspan="1" colspan="1">0.928</td><td rowspan="1" colspan="1">0.710</td><td rowspan="1" colspan="1">0.775<xref ref-type="table-fn" rid="TF1">*</xref></td></tr></tbody></table><table-wrap-foot><fn id="TF1"><p>*Indicate pairs of values that are not different at P &#x0003c; 0.01 (Wilcoxon signed rank).</p></fn></table-wrap-foot></table-wrap><p>We also evaluate the performance of R<sc>ankprop</sc> using a combined ROC curve across all the queries in our test set, following the protocol of (Altschul <italic>et al.</italic>, <xref ref-type="bibr" rid="B1">1997</xref>). <xref ref-type="fig" rid="F1">Figure 1</xref> shows the combined ROC curves for R<sc>ankprop</sc> NRDB40 (ranked by activation value), R<sc>ankprop</sc>+homologs NRDB40 (ranked by probability) and PSI-BLAST (ranked by <italic>E</italic>-value). Compared with average per-query ROC scores, the combined ROC curve requires that scores are well calibrated from one query to the next. The figure shows that the mapping of R<sc>ankprop</sc> scores to probabilities significantly improves the calibration, yielding better performance than PSI-BLAST for all but the first few false positives (across 3083 queries).<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>Combined ROC curve across multiple queries. For each method, search results from 3083 queries were sorted into a single list. The figure plots, for varying thresholds in the ranked list, the fraction of all known homologs (SCOP superfamily members) that fall above the threshold, as a function of the number of non-superfamily members above the threshold.</p></caption><graphic xlink:href="btn567f1"/></fig></p><p>The R<sc>ankprop</sc> web server first looks for an exact match of the query sequence against the sequences in NRDB40. If such a match is found, the server will retrieve the precomputed PSI-BLAST results from the database and then apply the R<sc>ankprop</sc> algorithm. In this case the server takes around 90 s to process a query. If the sequence is not found in the database, then the server will run PSI-BLAST first, which on average takes an additional 15 min.</p></sec><sec><title>Funding</title><p><grant-sponsor>National Institutes of Health</grant-sponsor><!-- oupReleaseDelayRemoved from OA Article (12|0) --> award (<grant-num>R01 GM074257</grant-num>).</p><p><italic>Conflict of Interest</italic>: none declared.</p></sec></body><back><ref-list><title>References</title><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Altschul</surname><given-names>SF</given-names></name><etal/></person-group><article-title>Gapped BLAST and PSI-BLAST: a new generation of protein database search programs</article-title><source>Nucleic Acids Res.</source><year>1997</year><volume>25</volume><fpage>3389</fpage><lpage>3402</lpage><pub-id pub-id-type="pmid">9254694</pub-id></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Heger</surname><given-names>A</given-names></name><etal/></person-group><article-title>Pairsdb atlas of protein sequence space</article-title><source>Nucleic Acids Res.</source><year>2008</year><volume>36</volume><fpage>D276</fpage><lpage>D280</lpage><pub-id pub-id-type="pmid">17986464</pub-id></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Murzin</surname><given-names>AG</given-names></name><etal/></person-group><article-title>SCOP: a structural classification of proteins database for the investigation of sequences and structures</article-title><source>J. Mol. Biol.</source><year>1995</year><volume>247</volume><fpage>536</fpage><lpage>540</lpage><pub-id pub-id-type="pmid">7723011</pub-id></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Weston</surname><given-names>J</given-names></name><etal/></person-group><article-title>Protein ranking: from local to global structure in the protein similarity network</article-title><source>Proc. Natl Acad. Sci.</source><year>2004</year><volume>101</volume><fpage>6559</fpage><lpage>6563</lpage><pub-id pub-id-type="pmid">15087500</pub-id></citation></ref></ref-list></back></article>