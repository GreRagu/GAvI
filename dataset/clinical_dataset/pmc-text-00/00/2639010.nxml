<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd"><article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article" xml:lang="EN"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id><journal-id journal-id-type="publisher-id">bioinformatics</journal-id><journal-id journal-id-type="hwp">bioinfo</journal-id><journal-title>Bioinformatics</journal-title><issn pub-type="ppub">1367-4803</issn><issn pub-type="epub">1460-2059</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">19008252</article-id><article-id pub-id-type="pmc">2639010</article-id><article-id pub-id-type="doi">10.1093/bioinformatics/btn587</article-id><article-id pub-id-type="publisher-id">btn587</article-id><article-categories><subj-group subj-group-type="heading"><subject>Applications Note</subject><subj-group><subject>Genetics and Population Analysis</subject></subj-group></subj-group></article-categories><title-group><article-title>The SNPMaP package for R: a framework for genome-wide association using DNA pooling on microarrays</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Davis</surname><given-names>Oliver S. P.</given-names></name><xref ref-type="corresp" rid="COR1">*</xref></contrib><contrib contrib-type="author"><name><surname>Plomin</surname><given-names>Robert</given-names></name></contrib><contrib contrib-type="author"><name><surname>Schalkwyk</surname><given-names>Leonard C.</given-names></name></contrib></contrib-group><aff>Social, Genetic &#x00026; Developmental Psychiatry Centre, Institute of Psychiatry, King's College London, De Crespigny Park, London SE5 8AF, UK</aff><author-notes><fn><p>Associate Editor: Martin Bishop</p></fn><corresp id="COR1">*To whom correspondence should be addressed.</corresp></author-notes><pub-date pub-type="ppub"><day>15</day><month>1</month><year>2009</year></pub-date><pub-date pub-type="epub"><day>30</day><month>9</month><year>2008</year></pub-date><pub-date pub-type="pmc-release"><day>30</day><month>9</month><year>2008</year></pub-date><volume>25</volume><issue>2</issue><fpage>281</fpage><lpage>283</lpage><history><date date-type="received"><day>14</day><month>7</month><year>2008</year></date><date date-type="rev-recd"><day>7</day><month>10</month><year>2008</year></date><date date-type="accepted"><day>10</day><month>11</month><year>2008</year></date></history><permissions><copyright-statement>&#x000a9; 2008 The Author(s)</copyright-statement><copyright-year>2008</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/"><p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">http://creativecommons.org/licenses/by-nc/2.0/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</p></license></permissions><abstract><p><bold>Summary:</bold> Large-scale genome-wide association (GWA) studies using thousands of high-density SNP microarrays are becoming an essential tool in the search for loci related to heritable variation in many phenotypes. However, the cost of GWA remains beyond the reach of many researchers. Fortunately, the majority of statistical power can still be obtained by estimating allele frequencies from DNA pools, reducing the cost to that of tens, rather than thousands of arrays. We present a set of software tools for processing SNPMaP (SNP microarrays and pooling) data from CEL files to Relative Allele Scores in the rich R statistical computing environment.</p><p><bold>Availability:</bold> The SNPMaP package is available from <ext-link ext-link-type="uri" xlink:href="http://cran.r-project.org/">http://cran.r-project.org/</ext-link> under the GNU General Public License version 3 or later.</p><p><bold>Contact:</bold> <email>snpmap@iop.kcl.ac.uk</email></p><p><bold>Supplementary information:</bold> Additional resources and test datasets are available at <ext-link ext-link-type="uri" xlink:href="http://sgdp.iop.kcl.ac.uk/snpmap/">http://sgdp.iop.kcl.ac.uk/snpmap/</ext-link></p></abstract></article-meta></front><body><sec sec-type="intro" id="SEC1"><title>1 INTRODUCTION</title><p>Genetic variation has been an important factor in nearly every aspect of human health and disease. This takes forms ranging from single-locus (Mendelian) traits to small effects from numerous loci. The early triumphs of human genetics and positional cloning involved rare, drastic, single mutations. These were amenable to recombination mapping techniques using large multi-generation pedigrees, and allowed the genome to be scanned for linkage using just a few hundred DNA markers. The extension of these techniques to quantitative traits offered the same systematic genome coverage but poor statistical power for detecting loci of small effect (Balding, <xref ref-type="bibr" rid="B1">2006</xref>).</p><p>Unrelated individuals from a population are much easier to recruit in large numbers than are families, and individual candidate mutations can be tested for association with a phenotypic trait with good statistical power. This association generally extends to nearby sequences as well, because of the relative rarity of new mutations and historical recombination in the population, giving rise to linkage disequilibrium (Slatkin, <xref ref-type="bibr" rid="B16">2008</xref>). This indirect association allows scanning of candidate loci or regions. Given enough polymorphic markers, association scanning can be extended genome wide (McCarthy <italic>et al</italic>., <xref ref-type="bibr" rid="B10">2008</xref>). The number of markers required for a truly comprehensive scan of the human genome is thought to be in the order of a million (Barrett and Cardon, <xref ref-type="bibr" rid="B3">2006</xref>). SNP genotyping microarrays have made it possible to genotype individuals at a million loci quickly, and genome-wide association (GWA) studies are now being used to scan the human genome for loci related to heritable variation in many phenotypes (Wellcome Trust Case Control Consortium, <xref ref-type="bibr" rid="B17">2007</xref>).</p><p>Many population samples with associated phenotypic information could yield valuable insights through GWA analysis, but the funding and industrial-scale infrastructure required for comprehensive genotyping of thousands of individuals will not be available; nor will funding be available to genotype samples again as new microarrays emerge. Additionally, given the extreme degree of multiple testing, the current generation of GWA experiments is far from definitive, and many more studies will be needed to fully confirm findings.</p><p>Fortunately, the majority of statistical power can be obtained by estimation of allele frequencies from DNA pools, in which small amounts of DNA from individuals in a group (e.g. cases or controls) are combined on the same microarray. This in effect averages allele frequencies biologically (rather than genotyping each individual and averaging their allele frequencies statistically). Importantly, the cost in time and effort for GWA studies using pooled DNA is well within the scope of a PhD project or post-doctoral contract even when several (usually 10 or more) independent pools are created to represent each group (Butcher <italic>et al</italic>., <xref ref-type="bibr" rid="B4">2004</xref>; Kirov <italic>et al</italic>., <xref ref-type="bibr" rid="B6">2006</xref>; Pearson <italic>et al</italic>., <xref ref-type="bibr" rid="B13">2007</xref>). We present a set of software tools for processing SNPMaP (SNP microarrays and pooling) data in the increasingly popular R environment for statistical computing (R Development Core Team, 2008; <ext-link ext-link-type="uri" xlink:href="http://www.r-project.org">http://www.r-project.org</ext-link>).</p></sec><sec id="SEC2"><title>2 SOFTWARE OVERVIEW</title><p>The SNPMaP package has been designed to handle the processing of SNPMaP data from the CEL files generated by the Affymetrix GeneChip Command Console (AGCC) or GeneChip Operating Software (GCOS), through to the RAS (Relative Allele Scores&#x02014;the pooling equivalent of a relative allele frequency; Butcher <italic>et al</italic>., <xref ref-type="bibr" rid="B5">2008</xref>) used in most analyses. This can be as simple as typing<disp-formula><graphic xlink:href="btn587um1.jpg" position="float"/></disp-formula>at the R prompt. The package will identify and read in the CEL files from the current directory, extract the relevant probe intensities and calculate a mean RAS for each SNP on each chip, returning a SNPMaP S4 object containing the scores.</p><p>Given the large amount of data generated by current SNP arrays, even with the relatively modest numbers of arrays (tens) typical of SNPMaP experiments, we have provided a <monospace>lowMemory</monospace> option that uses memory-mapping (with the R.huge package) to allow analysis to be done on a 32-bit desktop PC with 1GB of memory (naturally there is a speed penalty). If memory limits are exceeded in the course of the analysis, SNPMaP attempts to automatically switch from storing objects in memory to storing objects on disk. Most SNPMaP analyses use 20 to 30 arrays, so, as a severe test, we generated RAS summaries from 50 Affymetrix 6.0 arrays simultaneously on a 2.4GHz Pentium 4 system with 1GB of RAM, running Windows XP and reading and writing the data to a remote server. This took 7h using the <monospace>lowMemory</monospace> option.</p><p>S4 methods for generic R functions such as <monospace>summary()</monospace>, <monospace>plot()</monospace> and <monospace>boxplot()</monospace> make it easy to query the SNPMaP object and visualize the data it contains. Accessors provide convenient access to the data. All functions are documented through the R help system. For example, typing <monospace>?snpmap</monospace> will bring up a page describing the <monospace>snpmap()</monospace> function and its usage. Similarly, <monospace>package?SNPMaP</monospace> and <monospace>class?SNPMaP</monospace> will bring up help pages for the SNPMaP package and the SNPMaP class, respectively.</p><p>Although the SNPMaP object is intended to be useable for further analyses, the data can also easily be extracted to a matrix using<disp-formula><graphic xlink:href="btn587um2.jpg" position="float"/></disp-formula>A user who wants CEL files transformed into a spreadsheet of RAS in the simplest possible way need not use R interactively at all; example scripts that can be invoked from various shells are available from the web site, including a point-and-click front end for Windows. These steps comprise the simplest route from CEL files to the RAS used for association analysis.</p><p>On the other hand, a user who wants to examine all steps of the analysis and experiment with new methods has access to the data in a straightforward and convenient form. This flexibility is one of the major strengths of an implementation in R because of the impressive array of cutting-edge statistical techniques already available in the R environment.</p><p>A more involved approach might begin by extracting the raw probe intensities from the CEL files (running the workflow function <monospace>cel2raw</monospace> rather than the default <monospace>cel2rasS</monospace>):<disp-formula><graphic xlink:href="btn587um3.jpg" position="float"/></disp-formula></p><p>This allows the user to plot the raw probe intensities and generate pseudoimages of the processed chips using the <monospace>image()</monospace> method, so the user can check for scanning artifacts, such as dust or fingerprints. The raw intensities can then be further processed to individual probe quartet RAS by a workflow function:<disp-formula><graphic xlink:href="btn587um4.jpg" position="float"/></disp-formula>Other options available at the <monospace>snpmap()</monospace> or workflow stage include <monospace>normalize</monospace>, which quantile normalizes the raw probe intensities across chips; <monospace>log.intensities</monospace>, which causes SNPMaP to use the natural logarithm of the probe intensities; and <monospace>useMM</monospace>, which causes SNPMaP to subtract mismatch probe intensities (where available) before calculating RAS.</p><p>To calculate RAS, the package uses the method most commonly described in the literature; that is dividing the (possibly modified) intensity of allele A by the sum of the intensities of alleles A and B. If summary RAS scores for each array are required, this is calculated by a user-defined function (defaulting to the mean) of the RAS scores for each pair of probes. However, there are other ways of calculating summary RAS, such as taking the mean of allele A intensities across an array and dividing that by the summed means of allele A and B. Should users wish to use this alternative method of calculating RAS scores, a modified version of the SNPMaP package is available from the authors.</p><p>On recent Affymetrix arrays mismatch probes have been discarded in favor of greater perfect match probe density, so that mismatch intensities can no longer be subtracted before calculating RAS. Although this means that RAS scores based on the new arrays are no longer necessarily a good estimate of the absolute allele frequency in the pool, the critical comparison for an association analysis is the difference in allele frequencies between case and control pools. For this reason, the loss of the mismatch probes has relatively little effect on the resulting association analysis (Pearson <italic>et al</italic>., <xref ref-type="bibr" rid="B13">2007</xref>). For a discussion of the value of mismatch probes, see Millenaar <italic>et al</italic>. (<xref ref-type="bibr" rid="B9">2006</xref>).</p><p>Some authors have discussed the possibility of correcting pooled SNP assays for differential hybridization of the allele-specific probes, a process known as <italic>k</italic>-correction (Le Hellard <italic>et al</italic>., <xref ref-type="bibr" rid="B7">2002</xref>; Simpson <italic>et al</italic>., <xref ref-type="bibr" rid="B15">2005</xref>). The intention here is to produce more accurate estimates of absolute allele frequency in the pools. However, others have noted that again, since the critical comparison is between cases and controls rather than between absolute allele frequencies and a reference population, such correction has little effect on the results of the analysis (Macgregor <italic>et al</italic>., <xref ref-type="bibr" rid="B8">2006</xref>). Nevertheless, because of the way SNPMaP is implemented, for those users with access to a large reference sample of individuals typed on individual arrays, it is straightforward to apply the correction.</p></sec><sec sec-type="discussion" id="SEC3"><title>3 DISCUSSION</title><p>The SNPMaP package represents an evolution of R scripts that have been used by us (e.g. Meaburn <italic>et al</italic>., <xref ref-type="bibr" rid="B11">2006</xref>, <xref ref-type="bibr" rid="B12">2008</xref>) and others (e.g. Wilkening <italic>et al</italic>., <xref ref-type="bibr" rid="B18">2007</xref>) for processing SNPMaP data. Although a few other software applications are available, such as GenePool (Pearson <italic>et al</italic>., <xref ref-type="bibr" rid="B13">2007</xref>) or MPDA (Yang <italic>et al</italic>., <xref ref-type="bibr" rid="B19">2008</xref>), the strength of the SNPMaP package is in making the data readily available in the rich R environment, allowing easy access to the early stages of the analysis, effective visualization using R's powerful graphics system and great flexibility in constructing association tests, comparing methods and making modifications (Barratt <italic>et al</italic>., <xref ref-type="bibr" rid="B2">2002</xref>; Sham <italic>et al</italic>., <xref ref-type="bibr" rid="B14">2002</xref>): a hands-on, rather than a hands-off approach. The package currently supports the most recent Affymetrix arrays: both Mapping250K arrays and the 5.0 and 6.0 GenomeWideSNP arrays. Support for other arrays will be added in future versions. We also have plans for a supporting package aimed at providing implementations of common association analyses described in the literature, along with some novel methods and further visualization tools. We have kept the data structures straightforward to facilitate further development of analysis methods by users; although the current version is specifically aimed at SNPMaP using Affymetrix SNP arrays, it is readily extended for other platforms. For example, our tests have included using the package to normalize the raw intensities across 265 Affymetrix Mouse Exon (gene expression) arrays. Above all, the SNPMaP package affords users the flexibility to make best use of the sophisticated tools already available in the R environment to analyze their SNP microarrays and pooling studies.</p></sec></body><back><ack><title>ACKNOWLEDGEMENTS</title><p>Thanks to Henrik Bengtsson, James Bullard and Kasper Daniel Hansen for the affxparser and R.huge packages.</p><p><italic>Funding</italic>: The Wellcome Trust (GR75492); the US National Institute of Child Health and Human Development (HD49861); the UK Medical Research Council (G9424799, G0500079).</p><p><italic>Conflict of Interest</italic>: none declared.</p></ack><ref-list><title>REFERENCES</title><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Balding</surname><given-names>DJ</given-names></name></person-group><article-title>A tutorial on statistical methods for population association studies</article-title><source>Nat. Rev. Genet</source><year>2006</year><volume>7</volume><fpage>781</fpage><lpage>791</lpage><pub-id pub-id-type="pmid">16983374</pub-id></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Barratt</surname><given-names>BJ</given-names></name><etal/></person-group><article-title>Identification of the sources of error in allele frequency estimations from pooled DNA indicates an optimal experimental design</article-title><source>Ann. Hum. Genet</source><year>2002</year><volume>66</volume><fpage>393</fpage><lpage>405</lpage><pub-id pub-id-type="pmid">12485472</pub-id></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Barrett</surname><given-names>JC</given-names></name><name><surname>Cardon</surname><given-names>LR</given-names></name></person-group><article-title>Evaluating coverage of genome-wide association studies</article-title><source>Nat. Genet</source><year>2006</year><volume>38</volume><fpage>659</fpage><lpage>662</lpage><pub-id pub-id-type="pmid">16715099</pub-id></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Butcher</surname><given-names>LM</given-names></name><etal/></person-group><article-title>Genotyping pooled DNA on microarrays: a systematic genome screen of thousands of SNPs in large samples to detect QTLs for complex traits</article-title><source>Behav. Genet</source><year>2004</year><volume>34</volume><fpage>549</fpage><lpage>55</lpage><pub-id pub-id-type="pmid">15319578</pub-id></citation></ref><ref id="B5"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Butcher</surname><given-names>LM</given-names></name><etal/></person-group><article-title>Genome-wide quantitative trait locus association scan of general cognitive ability using pooled DNA and 500K single nucleotide polymorphism microarrays</article-title><source>Genes Brain Behav</source><year>2008</year><volume>7</volume><fpage>435</fpage><lpage>446</lpage><pub-id pub-id-type="pmid">18067574</pub-id></citation></ref><ref id="B6"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kirov</surname><given-names>G</given-names></name><etal/></person-group><article-title>Pooled DNA genotyping on Affymetrix SNP genotyping arrays</article-title><source>BMC Genomics</source><year>2006</year><volume>7</volume><fpage>27</fpage><pub-id pub-id-type="pmid">16480507</pub-id></citation></ref><ref id="B7"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Le Hellard</surname><given-names>S</given-names></name><etal/></person-group><article-title>SNP genotyping on pooled DNAs: comparison of genotyping technologies and a semi automated method for data storage and analysis</article-title><source>Nucleic Acids Res</source><year>2002</year><volume>30</volume><fpage>e74</fpage><pub-id pub-id-type="pmid">12140336</pub-id></citation></ref><ref id="B8"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Macgregor</surname><given-names>S</given-names></name><etal/></person-group><article-title>Analysis of pooled DNA samples on high density arrays without prior knowledge of differential hybridization rates</article-title><source>Nucleic Acids Res</source><year>2006</year><volume>34</volume><fpage>e55</fpage><pub-id pub-id-type="pmid">16627870</pub-id></citation></ref><ref id="B9"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Millenaar</surname><given-names>FF</given-names></name><etal/></person-group><article-title>How to decide? Different methods of calculating gene expression from short oligonucleotide array data will give different results</article-title><source>BMC Bioinformatics</source><year>2006</year><volume>7</volume><fpage>137</fpage><pub-id pub-id-type="pmid">16539732</pub-id></citation></ref><ref id="B10"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>McCarthy</surname><given-names>MI</given-names></name><etal/></person-group><article-title>Genome-wide association studies for complex traits: consensus, uncertainty and challenges</article-title><source>Nat. Rev. Genet</source><year>2008</year><volume>9</volume><fpage>356</fpage><lpage>369</lpage><pub-id pub-id-type="pmid">18398418</pub-id></citation></ref><ref id="B11"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Meaburn</surname><given-names>E</given-names></name><etal/></person-group><article-title>Genotyping pooled DNA using 100K SNP microarrays: a step towards genomewide association scans</article-title><source>Nucleic Acids Res</source><year>2006</year><volume>34</volume><fpage>e28</fpage></citation></ref><ref id="B12"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Meaburn</surname><given-names>EL</given-names></name><etal/></person-group><article-title>Quantitative trait locus association scan of early reading disability and ability using pooled DNA and 100K SNP microarrays in a sample of 5760 children</article-title><source>Mol. Psych</source><year>2008</year><volume>13</volume><fpage>729</fpage><lpage>740</lpage></citation></ref><ref id="B13"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Pearson</surname><given-names>JV</given-names></name><etal/></person-group><article-title>Identification of the genetic basis for complex disorders by use of pooling-based genome-wide single-nucleotide-polymorphism association studies</article-title><source>Am. J. Hum. Genet</source><year>2007</year><volume>80</volume><fpage>126</fpage><lpage>139</lpage><pub-id pub-id-type="pmid">17160900</pub-id></citation></ref><ref id="B14"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Sham</surname><given-names>P</given-names></name><etal/></person-group><article-title>DNA pooling: a tool for large-scale association studies</article-title><source>Nat. Rev. Genet</source><year>2002</year><volume>3</volume><fpage>862</fpage><lpage>871</lpage><pub-id pub-id-type="pmid">12415316</pub-id></citation></ref><ref id="B15"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Simpson</surname><given-names>CL</given-names></name><etal/></person-group><article-title>A central resource for accurate allele frequency estimation from pooled DNA genotyped on DNA microarrays</article-title><source>Nucleic Acids Res</source><year>2005</year><volume>33</volume><fpage>e25</fpage><pub-id pub-id-type="pmid">15701753</pub-id></citation></ref><ref id="B16"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Slatkin</surname><given-names>M</given-names></name></person-group><article-title>Linkage disequilibrium&#x02013;understanding the evolutionary past and mapping the medical future</article-title><source>Nat. Rev. Genet</source><year>2008</year><volume>9</volume><fpage>477</fpage><lpage>485</lpage><pub-id pub-id-type="pmid">18427557</pub-id></citation></ref><ref id="B17"><citation citation-type="journal"><collab>Wellcome Trust Case Control Consortium</collab><article-title>Genome-wide association study of 14 000 cases of seven common diseases and 3000 shared controls</article-title><source>Nature</source><year>2007</year><volume>447</volume><fpage>661</fpage><lpage>678</lpage><pub-id pub-id-type="pmid">17554300</pub-id></citation></ref><ref id="B18"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wilkening</surname><given-names>S</given-names></name><etal/></person-group><article-title>Allelotyping of pooled DNA with 250K SNP microarrays</article-title><source>BMC Genomics</source><year>2007</year><volume>8</volume><fpage>77</fpage><pub-id pub-id-type="pmid">17367522</pub-id></citation></ref><ref id="B19"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>HC</given-names></name><etal/></person-group><article-title>MPDA: Microarray pooled DNA analyzer</article-title><source>BMC Bioinformatics</source><year>2008</year><volume>9</volume><fpage>196</fpage><pub-id pub-id-type="pmid">18412951</pub-id></citation></ref></ref-list></back></article>