<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd"><article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article" xml:lang="EN"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id><journal-id journal-id-type="publisher-id">bioinformatics</journal-id><journal-id journal-id-type="hwp">bioinfo</journal-id><journal-title>Bioinformatics</journal-title><issn pub-type="ppub">1367-4803</issn><issn pub-type="epub">1460-2059</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">18953045</article-id><article-id pub-id-type="pmc">2639298</article-id><article-id pub-id-type="doi">10.1093/bioinformatics/btn556</article-id><article-id pub-id-type="publisher-id">btn556</article-id><article-categories><subj-group subj-group-type="heading"><subject>Applications Note</subject><subj-group><subject>Phylogenetics</subject></subj-group></subj-group></article-categories><title-group><article-title>AUGIST: inferring species trees while accommodating gene tree uncertainty</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Oliver</surname><given-names>Jeffrey C.</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref><xref ref-type="aff" rid="AFF1"><sup>2</sup></xref></contrib></contrib-group><aff id="AFF1"><sup>1</sup>Interdisciplinary Program in Insect Science, University of Arizona, Tucson, AZ 85721 and <sup>2</sup>Department of Ecology and Evolutionary Biology, Yale University, New Haven, CT 06511, USA</aff><author-notes><fn><p>Associate Editor: Martin Bishop</p></fn></author-notes><pub-date pub-type="ppub"><day>15</day><month>12</month><year>2008</year></pub-date><pub-date pub-type="epub"><day>25</day><month>10</month><year>2008</year></pub-date><pub-date pub-type="pmc-release"><day>25</day><month>10</month><year>2008</year></pub-date><volume>24</volume><issue>24</issue><fpage>2932</fpage><lpage>2933</lpage><history><date date-type="received"><day>3</day><month>9</month><year>2008</year></date><date date-type="rev-recd"><day>23</day><month>10</month><year>2008</year></date><date date-type="accepted"><day>23</day><month>10</month><year>2008</year></date></history><permissions><copyright-statement>&#x000a9; 2008 The Author(s)</copyright-statement><copyright-year>2008</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/"><p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">http://creativecommons.org/licenses/by-nc/2.0/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</p></license></permissions><abstract><p><bold>Summary:</bold> AUGIST (accomodating uncertainty in genealogies while inferring species tress) is a new software package for inferring species trees while accommodating uncertainty in gene genealogies. It is written for the Mesquite software system and provides sampling procedures to incorporate uncertainty in gene tree reconstruction while providing confidence estimates for inferred species trees.</p><p><bold>Availability:</bold> <ext-link ext-link-type="uri" xlink:href="http://www.lycaenid.org/augist/">http://www.lycaenid.org/augist/</ext-link></p><p><bold>Contact:</bold> <email>jeffrey.oliver@yale.edu</email></p></abstract></article-meta></front><body><sec sec-type="intro" id="SEC1"><title>1 INTRODUCTION</title><p>As gene sequence data for more loci become available, it is becoming increasingly easier to base estimates of phylogeny on multiple gene genealogies. Because a single gene tree does not necessarily reflect the evolutionary relationships of the species being investigated (Maddison, <xref ref-type="bibr" rid="B8">1997</xref>; Pamilo and Nei, <xref ref-type="bibr" rid="B12">1988</xref>), it is essential to base phylogenetic inferences on multiple, unlinked loci. Incorporating data from multiple loci has been implemented in a variety of methods. One widely used approach concatenates the sequences from the different loci, to form a single, &#x02018;super&#x02019; sequence for phylogenetic analyses; however, this may lead to erroneous inferences (Kubatko and Degnan, <xref ref-type="bibr" rid="B6">2007</xref>) and unnecessarily constrains, sometimes unreasonably, all gene genealogies to share the same topology and branch lengths. Ideally, unlinked loci should be analyzed independently, to accommodate the potentially different histories and rates of change among loci (Maddison, <xref ref-type="bibr" rid="B8">1997</xref>; Takahata, <xref ref-type="bibr" rid="B15">1989</xref>).</p><p>There are increasingly more methods to incorporate independent loci in phylogenetic inference, allowing each locus a unique evolutionary history. One approach is to analyze each locus separately, then generate a consensus tree as a best estimate; however, the utility of approach is limited, given the low probability of reciprocal monophyly in gene genealogies for recently diverged taxa (Hudson and Coyne, <xref ref-type="bibr" rid="B4">2002</xref>; Rosenberg, <xref ref-type="bibr" rid="B13">2003</xref>). That gene genealogies do not always reflect species&#x02019; histories is a product of the population genetic processes underlying the transmission of genes through time (Tajima, <xref ref-type="bibr" rid="B14">1983</xref>). Methods accommodating those population genetic processes responsible for the discordance between gene trees and species trees would allow more informed inferences of species phylogenies (Carstens and Knowles, <xref ref-type="bibr" rid="B2">2007</xref>; Liu and Pearl, <xref ref-type="bibr" rid="B7">2007</xref>; Maddison, <xref ref-type="bibr" rid="B8">1997</xref>).</p><p>One general tree inference approach that has recently been applied to species tree estimation uses gene genealogies to evaluate species trees based on some objective function. These include minimizing the number of deep coalescence events (MDC; Maddison, <xref ref-type="bibr" rid="B8">1997</xref>; Maddison and Knowles, <xref ref-type="bibr" rid="B9">2006</xref>) and maximizing the coalescence probabilities of gene trees for a given species tree (ESP-COAL; Carstens and Knowles, <xref ref-type="bibr" rid="B2">2007</xref>). These approaches are useful for inferring species trees from gene genealogies (e.g. Carling and Brumfield, <xref ref-type="bibr" rid="B1">2008</xref>), but currently treat the underlying gene genealogies as known. Methods of phylogenetic inference should accommodate the uncertainty inherent in gene genealogies in estimates of species phylogeny (Maddison and Knowles, <xref ref-type="bibr" rid="B9">2006</xref>).</p><p>Here, I present a method extending the objective function approach of species tree inference, simultaneously accommodating uncertainty in gene genealogies and providing measures of confidence in species tree estimates. AUGIST (accommodating uncertainty in genealogies while inferring species trees), a new package for the Mesquite software system (Maddison and Maddison, <xref ref-type="bibr" rid="B10">2008</xref>), is available for implementation of the method described here.</p></sec><sec id="SEC2"><title>2 DESCRIPTION</title><sec id="SEC2.1"><title>2.1 Method</title><p>I first present an informal description of the method, followed by an explicit description of implementation using the deep coalescences criterion.<xref ref-type="fig" rid="F1">Figure 1</xref> provides a schematic illustration of the method.<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>Illustration of species tree interface methods. Gene genealogy distributions for <italic>n</italic> loci are generated by MCMC sampling. A single gene genealogy is drawn from these distributions for each locus, and the set of <italic>n</italic> genealogies is then used to infer species tree(s) based on some optimality criterion. This process is repeated <italic>m</italic> times, and summarized in a consensus species tree, shown in black, with node values reflecting frequency at which a partition is recovered. See text for explicit implementation details of gene genealogy distribution generation and species tree inference.</p></caption><graphic xlink:href="btn556f1"/></fig></p><sec id="SEC2.1.1"><title>2.1.1 Informal description</title><p>Multiple, unlinked loci are sampled to generate gene sequence data for specimens. These data are analyzed separately to create a distribution of gene genealogies for each locus. Each distribution of gene genealogies will ideally reflect the confidence in individual partitions by frequency of their occurrence in the distribution (Holder and Lewis, <xref ref-type="bibr" rid="B3">2003</xref>). To estimate a species tree, a single gene genealogy for each locus is drawn, at random with replacement, and used to infer the species tree based on an optimality criterion. Topological variation among gene genealogies represents uncertainty in the gene tree, and is incorporated into analyses by resampling these gene genealogies to generate a distribution of species trees. The distribution of species trees can be summarized, for example, as a consensus of all &#x02018;optimal&#x02019; species trees recovered in the resampling procedure. The consensus should reflect the frequency at which partitions in the species tree were encountered during the re-sampling procedure, and thus the uncertainty of species tree topology.</p></sec><sec id="SEC2.1.2"><title>2.1.2 Explicit example</title><p>Multiple loci are sequenced for multiple individuals and species. In independent Bayesian MCMC analyses in MrBayes (Huelsenbeck and Ronquist, <xref ref-type="bibr" rid="B5">2001</xref>), these DNA sequences are used to generate posterior distributions of gene genealogies. Those genealogies sampled before log likelihood scores stabilize and runs converge are discarded. A single gene genealogy for each locus is selected from the posterior distributions of gene genealogies, and a species tree is inferred using the Tree Search procedure in Mesquite (Maddison and Maddison, <xref ref-type="bibr" rid="B10">2008</xref>), minimizing the number of deep coalescences for multiple loci. This species tree inference step is repeated multiple times, drawing a new gene genealogy for each locus during each species tree search. All inferred species trees are summarized in a single tree, using the Majority Rule Consensus Tree function in Mesquite; the frequency of a partition recovered in the species tree inference step is used as a measure of uncertainty for the relationships in the consensus species tree.</p></sec></sec><sec id="SEC2.2"><title>2.2 Implementation details</title><p>AUGIST is available as a package for the Mesquite software system (Maddison and Maddison, <xref ref-type="bibr" rid="B10">2008</xref>), and runs on Linux, Windows and Mac OS X. It requires at least version 2.5 build j55 of Mesquite to run properly. The package, instructions, and recommendations for use are available at <ext-link ext-link-type="uri" xlink:href="http://www.lycaenid.org/augist/">http://www.lycaenid.org/augist/</ext-link> or by request from the author. Results of a simulation study demonstrating the accuracy of the AUGIST approach are contained in (Oliver, <xref ref-type="bibr" rid="B11">2007</xref>), and can be obtained by request from the author.</p></sec></sec><sec id="SEC3"><title>3 EXENTIONS</title><p>The method described here could be used for any tree inference method employing an optimality criterion based on the relationship between gene trees and species trees. For example, instead of deep coalescent events, the number of gene duplication and extinction events could be minimized to infer a species tree (Maddison, <xref ref-type="bibr" rid="B8">1997</xref>). A likelihood approach, using gene tree likelihood based on coalescent probabilities (e.g. ESP-COAL,Carstens and Knowles, <xref ref-type="bibr" rid="B2">2007</xref>) could also be used, although the current version of Mesquite does not calculate this statistic. The flexibility of Mesquite and the AUGIST package will accommodate other optimality criteria as additional Mesquite modules become available. Finally, this method could easily be extended to test phylogenetic hypotheses by comparing constrained versus unconstrained tree searches for a given set of gene genealogies. Phylogenetic hypotheses, represented by a constraint tree, could be rejected if constrained tree searches consistently infer species trees with more deep coalescences than unconstrained tree searches.</p></sec></body><back><ack><title>ACKNOWLEDGEMENTS</title><p>David Maddison provided invaluable insight and assistance in Mesquite programming. Four anonymous reviewers also provided useful comments on this article and AUGIST implementation.</p><p><italic>Funding</italic>: Center for Insect Science at the University of Arizona and an NSF DDIG (#0412447).</p><p><italic>Conflict of Interest</italic>: none declared.</p></ack><ref-list><title>REFERENCES</title><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Carling</surname><given-names>MD</given-names></name><name><surname>Brumfield</surname><given-names>RT</given-names></name></person-group><article-title>Integrating phylogenetic and population genetic analyses of multiple loci to test species divergence hypotheses in<italic>Passerina</italic>buntings</article-title><source>Genetics</source><year>2008</year><volume>178</volume><fpage>363</fpage><lpage>377</lpage><pub-id pub-id-type="pmid">18202379</pub-id></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Carstens</surname><given-names>BC</given-names></name><name><surname>Knowles</surname><given-names>LL</given-names></name></person-group><article-title>Estimating species phylogeny from gene-tree probabilities despite incomplete lineage sorting: and example from<italic>Melanoplus</italic>grasshoppers</article-title><source>Syst. Biol.</source><year>2007</year><volume>56</volume><fpage>400</fpage><lpage>411</lpage><pub-id pub-id-type="pmid">17520504</pub-id></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Holder</surname><given-names>M</given-names></name><name><surname>Lewis</surname><given-names>PO</given-names></name></person-group><article-title>Phylogeny estimation: traditional and Bayesian approaches</article-title><source>Nat. Rev. Genet.</source><year>2003</year><volume>4</volume><fpage>275</fpage><lpage>284</lpage><pub-id pub-id-type="pmid">12671658</pub-id></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hudson</surname><given-names>RR</given-names></name><name><surname>Coyne</surname><given-names>JA</given-names></name></person-group><article-title>Mathematical consequences of the genealogical species concept</article-title><source>Evolution</source><year>2002</year><volume>56</volume><fpage>1557</fpage><lpage>1565</lpage><pub-id pub-id-type="pmid">12353748</pub-id></citation></ref><ref id="B5"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Huelsenbeck</surname><given-names>JP</given-names></name><name><surname>Ronquist</surname><given-names>F</given-names></name></person-group><article-title>MrBayes: Bayesian inference of phylogeny</article-title><source>Bioinformatics</source><year>2001</year><volume>17</volume><fpage>754</fpage><lpage>755</lpage><pub-id pub-id-type="pmid">11524383</pub-id></citation></ref><ref id="B6"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kubatko</surname><given-names>LS</given-names></name><name><surname>Degnan</surname><given-names>JH</given-names></name></person-group><article-title>Inconsistency of phylogenetic estimates from concatenated data under coalescence</article-title><source>Syst. Biol.</source><year>2007</year><volume>56</volume><fpage>17</fpage><lpage>24</lpage><pub-id pub-id-type="pmid">17366134</pub-id></citation></ref><ref id="B7"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>L</given-names></name><name><surname>Pearl</surname><given-names>DK</given-names></name></person-group><article-title>Species trees from gene trees: reconstructing Bayesian posterior distribution of a species phylogeny using estimated gene tree distributions</article-title><source>Syst. Biol.</source><year>2007</year><volume>56</volume><fpage>504</fpage><lpage>514</lpage><pub-id pub-id-type="pmid">17562474</pub-id></citation></ref><ref id="B8"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Maddison</surname><given-names>WP</given-names></name></person-group><article-title>Gene trees in species trees</article-title><source>Syst. Biol.</source><year>1997</year><volume>46</volume><fpage>523</fpage><lpage>536</lpage></citation></ref><ref id="B9"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Maddison</surname><given-names>WP</given-names></name><name><surname>Knowles</surname><given-names>LL</given-names></name></person-group><article-title>Inferring phylogeny despite incomplete lineage sorting</article-title><source>Syst. Biol.</source><year>2006</year><volume>55</volume><fpage>21</fpage><lpage>30</lpage><pub-id pub-id-type="pmid">16507521</pub-id></citation></ref><ref id="B10"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Maddison</surname><given-names>WP</given-names></name><name><surname>Maddison</surname><given-names>DR</given-names></name></person-group><article-title>Mesquite: a modular system for evolutionary analysis. Version 2.5, build j55.</article-title><year>2008</year><comment>Available at <ext-link ext-link-type="uri" xlink:href="http://mesquiteproject.org">http://mesquiteproject.org</ext-link></comment></citation></ref><ref id="B11"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Oliver</surname><given-names>JC</given-names></name></person-group><article-title>Inferring species trees from deep coalescences while accommodating gene tree uncertainty</article-title><source>PhD Thesis.</source><year>2007</year><publisher-loc>Tucson</publisher-loc><publisher-name>University of Arizona</publisher-name></citation></ref><ref id="B12"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Pamilo</surname><given-names>P</given-names></name><name><surname>Nei</surname><given-names>M</given-names></name></person-group><article-title>Relationships between gene trees and species trees</article-title><source>Mol. Biol. Evol.</source><year>1988</year><volume>5</volume><fpage>568</fpage><lpage>583</lpage><pub-id pub-id-type="pmid">3193878</pub-id></citation></ref><ref id="B13"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Rosenberg</surname><given-names>NA</given-names></name></person-group><article-title>The shapes of neutral gene genealogies in two species: probabilities of monophyly, paraphyly, and polyphyly in a coalescent model</article-title><source>Evolution</source><year>2003</year><volume>57</volume><fpage>1465</fpage><lpage>1477</lpage><pub-id pub-id-type="pmid">12940352</pub-id></citation></ref><ref id="B14"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Tajima</surname><given-names>F</given-names></name></person-group><article-title>Evolutionary relationship of DNA sequences in finite populations</article-title><source>Genetics</source><year>1983</year><volume>105</volume><fpage>437</fpage><lpage>460</lpage><pub-id pub-id-type="pmid">6628982</pub-id></citation></ref><ref id="B15"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Takahata</surname><given-names>N</given-names></name></person-group><article-title>Gene genealogy in three related populations: consistency probability between gene and population trees</article-title><source>Genetics</source><year>1989</year><volume>122</volume><fpage>957</fpage><lpage>966</lpage><pub-id pub-id-type="pmid">2759432</pub-id></citation></ref></ref-list></back></article>